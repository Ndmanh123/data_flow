{"ast":null,"code":"export default {\n  name: \"DataFlow\",\n  props: {\n    width: {\n      type: [String, Number],\n      default: 800\n    },\n    height: {\n      type: [String, Number],\n      default: 650\n    },\n    gridSize: {\n      type: Number,\n      default: 10\n    },\n    drawGrid: {\n      type: [Object, Boolean],\n      default: true\n    },\n    highLightLinks: {\n      type: Array,\n\n      default() {\n        return [];\n      }\n\n    },\n    nodes: {\n      type: [Object, Boolean],\n      default: [{\n        id: \"fd9c3b76-efea-436f-9bd5-ac2ba665d512\",\n        name: \"load\",\n        position: {\n          x: 250,\n          y: 250\n        },\n        type: \"Rectangle\"\n      }, {\n        id: \"4b20a9c1-bdbf-44fa-a64c-3ac11c377f84\",\n        name: \"filter\",\n        position: {\n          x: 550,\n          y: 250\n        },\n        type: \"Rectangle\"\n      }, {\n        id: \"fd45s2v9-bdbf-44fa-a64c-3ac11c377f84\",\n        name: \"filter\",\n        position: {\n          x: 250,\n          y: 450\n        },\n        type: \"Rectangle\"\n      }]\n    },\n    links: {\n      type: [Object, Boolean],\n      default: // false,\n      [{\n        source: \"fd9c3b76-efea-436f-9bd5-ac2ba665d512\",\n        target: \"4b20a9c1-bdbf-44fa-a64c-3ac11c377f84\"\n      }, {\n        source: \"fd45s2v9-bdbf-44fa-a64c-3ac11c377f84\",\n        target: \"4b20a9c1-bdbf-44fa-a64c-3ac11c377f84\"\n      }]\n    }\n  },\n\n  data() {\n    return {\n      stencilShapes: [],\n      selectionNode: null,\n      selectedElement: null,\n      selectedLink: null,\n      //check ctrl shift\n      ctrlDown: false,\n      shiftDown: false,\n      color: \"rgb(255 136 0)\",\n      arr: [\"filter\", \"formula\", \"join\", \"load\", \"pivot\", \"sample\", \"script\", \"select\", \"sort\", \"summarize\", \"transposeTable\", \"union\", \"weightAvg\"]\n    };\n  },\n\n  created() {\n    this.graph = new joint.dia.Graph();\n  },\n\n  mounted() {\n    this.initPaper(); // this.center()\n  },\n\n  methods: {\n    // center() {\n    //   _.bind(self.paperScroller.centerContent, self.paperScroller);\n    // },\n    initPaper() {\n      let graph = this.graph;\n      this.commandManager = new joint.dia.CommandManager({\n        graph: graph,\n        cmdBeforeAdd: (cmdName, cell, graph, options = {}) => {\n          return !options.ignoreCommandManager;\n        }\n      });\n      this.paper = new joint.dia.Paper({\n        width: this.width,\n        height: this.height,\n        model: this.graph,\n        async: true,\n        sorting: joint.dia.Paper.sorting.APPROX,\n        gridSize: this.gridSize,\n        drawGrid: this.drawGrid,\n        restrictTranslate: true,\n        stopDelegation: false,\n        interactive: {\n          vertexAdd: false\n        },\n        // background: { color: '#F3F7F6' },\n        // defaultConnectionPoint: { name: 'boundary' },\n        // defaultConnector: {\n        //     name: \"rounded\"\n        //   },\n        //   defaultRouter: {\n        //     name: \"manhattan\",\n        //     args: {\n        //       step: 10,\n        //       endDirections: [\"bottom\"],\n        //       startDirections: [\"top\"],\n        //       padding: { bottom: 20 }\n        //     }\n        //   },\n        snapLinks: {\n          radius: 75\n        },\n        linkPinning: false,\n        multiLinks: false,\n        defaultRouter: {\n          name: \"manhattan\",\n          args: {\n            padding: 10\n          }\n        },\n        defaultConnector: {\n          name: \"rounded\"\n        },\n        validateConnection: function (cellViewS, magnetS, cellViewT, magnetT, end, linkView) {\n          // Prevent linking from input ports.\n          if (magnetS && magnetS.getAttribute(\"port-group\") === \"in\") return false; // Prevent linking from output ports to input ports within one element.\n\n          if (cellViewS === cellViewT) return false; // Prevent linking to input ports.\n\n          return magnetT && magnetT.getAttribute(\"port-group\") === \"in\" || cellViewS.model.get(\"type\") === \"qad.Question\" && cellViewT.model.get(\"type\") === \"qad.Answer\";\n        },\n        // validateConnection: function (view1, _magnet1, view2, _magnet2) {\n        //     // Do not allow loop links (Element to Link, Element A to Element B is valid).\n        //     return view1 !== view2;\n        // },\n        interactive: {\n          linkMove: true,\n          labelMove: true,\n          arrowheadMove: true,\n          vertexMove: false,\n          vertexAdd: false,\n          vertexRemove: false,\n          useLinkTools: false\n        },\n        defaultLink: function () {\n          return new joint.shapes.standard.Link({\n            attrs: {\n              z: 1,\n              line: {\n                connection: true,\n                stroke: \"#707070\",\n                strokeWidth: 2,\n                strokeLinejoin: \"round\"\n              },\n              wrapper: {\n                connection: true,\n                strokeWidth: 10,\n                strokeLinejoin: \"round\"\n              }\n            },\n            markup: [{\n              tagName: \"path\",\n              selector: \"wrapper\",\n              attributes: {\n                fill: \"none\",\n                stroke: \"transparent\"\n              }\n            }, {\n              tagName: \"path\",\n              selector: \"line\",\n              attributes: {\n                fill: \"none\"\n              }\n            }]\n          });\n        }\n      });\n      var targetArrowheadTool = new joint.linkTools.TargetArrowhead();\n      this.toolsView = new joint.dia.ToolsView({\n        tools: [// verticesTool, segmentsTool,\n        // sourceArrowheadTool,\n        targetArrowheadTool // sourceAnchorTool, targetAnchorTool,\n        // boundaryTool, removeButton\n        ]\n      }); // var elementView = element.findView(this.paper);\n      // elementView.addTools(this.toolsView);\n      // var linkView = this.link.findView(this.paper);\n      // linkView.addTools(this.toolsView);\n\n      this.paperScroller = new joint.ui.PaperScroller({\n        paper: this.paper,\n        autoResizePaper: true,\n        scrollWhileDragging: true,\n        cursor: \"grab\"\n      });\n      this.selection = new joint.ui.Selection({\n        theme: \"material\",\n        paper: this.paper,\n        useModelGeometry: true,\n        allowTranslate: true\n      });\n      this.selection.removeHandle(\"rotate\");\n      this.selection.removeHandle(\"resize\");\n      this.toolbar = new joint.ui.Toolbar({\n        // initialize tools with default settings\n        tools: [\"zoomIn\", \"zoomOut\", \"zoomToFit\", \"zoomSlider\", \"undo\", \"redo\"],\n        references: {\n          paperScroller: this.paperScroller,\n          commandManager: this.commandManager\n        }\n      });\n      document.getElementById(\"Toolbar\").appendChild(this.toolbar.render().el);\n      this.snaplines = new joint.ui.Snaplines({\n        paper: this.paper\n      });\n      this.snaplines.startListening(); //render paper\n\n      document.getElementById(\"paper\").appendChild(this.paperScroller.render().el); //render paperScroller\n\n      this.highlighters = joint.highlighters;\n      this.paperScroller.$el.css({\n        width: 800,\n        height: 600\n      }).appendTo(\"#paper\");\n      this.addStencil();\n      this.handlePaperEvents();\n      this.btnHandler();\n      this.selection.collection.reset(graph.getElements());\n      this.render();\n      this.paperScroller.center(); // _.bind(this.paperScroller.centerContent, this.paperScroller)\n      // this.paperScroller.centerContent();\n      // this.paperScroller.adjustPaper();\n      // this.paperScroller.zoomToFit({ padding: 200 });\n    },\n\n    jsUcfirst(string) {\n      return string.charAt(0).toUpperCase() + string.slice(1);\n    },\n\n    stencilRenderHandler(positionX, positionY, arr, elNoInPorts = \"\", spaceBetweenElToX = 0, spaceBetweenElToY = 0) {\n      this.customEl = joint.dia.Element.define(\"standard.Rectangle\", {\n        z: 1,\n        size: {\n          width: 44,\n          height: 35\n        },\n        removable: false,\n        attrs: {\n          image: {\n            x: 5,\n            y: 5,\n            width: \"calc(w-10)\",\n            height: \"calc(h-10 )\"\n          },\n          root: {\n            magnet: false\n          },\n          body: {\n            fill: \"#FFFFFF\",\n            stroke: \"#A0A0A0\",\n            width: \"calc(w)\",\n            height: \"calc(h)\",\n            strokeWidth: 2,\n            rx: 5,\n            ry: 5\n          }\n        },\n        ports: {\n          items: [{\n            id: \"out-port\",\n            group: \"out\"\n          }, {\n            id: \"in-port\",\n            group: \"in\"\n          }],\n          groups: {\n            out: {\n              markup: [{\n                tagName: \"circle\",\n                selector: \"portBody\"\n              }],\n              position: {\n                name: \"right\"\n              },\n              attrs: {\n                portBody: {\n                  r: 5,\n                  magnet: \"active\",\n                  fill: \"#187BD3\",\n                  stroke: \"#187BD3\"\n                }\n              }\n            },\n            in: {\n              markup: [{\n                tagName: \"circle\",\n                selector: \"portBody\"\n              }],\n              position: {\n                name: \"left\"\n              },\n              attrs: {\n                portBody: {\n                  r: 5,\n                  magnet: \"passive\",\n                  fill: \"#FFFFFF\",\n                  stroke: \"#187BD3\"\n                }\n              }\n            }\n          }\n        },\n        markup: [{\n          tagName: \"rect\",\n          selector: \"body\"\n        }, {\n          tagName: \"image\",\n          selector: \"image\"\n        }, {\n          tagName: \"ports\",\n          selector: \"ports\"\n        }]\n      });\n      this.customElNoInPorts = joint.dia.Element.define(\"standard.Rectangle\", {\n        z: 1,\n        theme: \"material\",\n        size: {\n          width: 44,\n          height: 35\n        },\n        removable: false,\n        attrs: {\n          image: {\n            x: 5,\n            y: 5,\n            width: \"calc(w-10)\",\n            height: \"calc(h-10 )\"\n          },\n          root: {\n            magnet: false\n          },\n          body: {\n            fill: \"#FFFFFF\",\n            stroke: \"#A0A0A0\",\n            width: \"calc(w)\",\n            height: \"calc(h)\",\n            strokeWidth: 2\n          },\n          line: {\n            connection: true,\n            stroke: \"#333333\",\n            strokeWidth: 2,\n            strokeLinejoin: \"round\",\n            targetMarker: {\n              type: \"path\",\n              d: \"M 10 -5 0 0 10 5 z\"\n            }\n          }\n        },\n        ports: {\n          items: [{\n            id: \"out-port\",\n            group: \"out\"\n          }],\n          groups: {\n            out: {\n              markup: [{\n                tagName: \"circle\",\n                selector: \"portBody\"\n              }],\n              position: {\n                name: \"right\"\n              },\n              attrs: {\n                portBody: {\n                  r: 5,\n                  magnet: \"active\",\n                  fill: \"#187BD3\",\n                  stroke: \"#187BD3\"\n                }\n              }\n            }\n          }\n        },\n        markup: [{\n          tagName: \"rect\",\n          selector: \"body\"\n        }, {\n          tagName: \"image\",\n          selector: \"image\"\n        }, {\n          tagName: \"ports\",\n          selector: \"ports\"\n        }]\n      });\n      arr.forEach(element => {\n        //chuyển thành hoa chữ đầu cho đúng định dạng file ảnh lưu\n        let elementName = this.jsUcfirst(element);\n\n        if (elementName === this.jsUcfirst(elNoInPorts)) {\n          element = new this.customElNoInPorts();\n        } else {\n          element = new this.customEl();\n        }\n\n        element.prop(\"attrs/image/xlinkHref\", require(`../assets/${elementName}.svg`));\n        this.stencilShapes.push(element.position(positionX, positionY));\n\n        if (spaceBetweenElToX > 0) {\n          positionX += element.attributes.size.width + spaceBetweenElToX;\n        }\n\n        if (spaceBetweenElToY > 0) {\n          positionY += element.attributes.size.height + spaceBetweenElToY;\n        }\n      });\n    },\n\n    addStencil() {\n      let graph = this.graph;\n      let paper = this.paper;\n      var stencil = new joint.ui.Stencil({\n        paper: this.paperScroller,\n        width: 900,\n        height: 60,\n        dropAnimation: {\n          duration: 200,\n          easing: \"swing\"\n        }\n      });\n      this.stencilRenderHandler(20, 20, this.arr, \"load\", 16);\n      document.getElementById(\"stencil\").appendChild(stencil.render().el);\n      stencil.load(this.stencilShapes);\n    },\n\n    getElementPredecessorLinks(el) {\n      let graph = this.graph;\n      return graph.getSubgraph([el, ...graph.getPredecessors(el)]).filter(cell => cell.isLink());\n    },\n\n    highlightCell(cell) {\n      let self = this;\n\n      if (cell) {\n        self.highlighters.addClass.add(cell.findView(self.paper), cell.isElement() ? \"body\" : \"line\", \"selection\", {\n          className: \"selection\"\n        });\n      } else {\n        return;\n      }\n    },\n\n    unhighlightCell(cell) {\n      let self = this;\n\n      if (cell) {\n        self.highlighters.addClass.remove(cell.findView(self.paper), \"selection\");\n      } else {\n        return;\n      }\n    },\n\n    selectElement(el) {\n      let self = this;\n      let graph = self.graph;\n      if (self.selectionNode === el) return;\n\n      if (self.selectionNode) {\n        self.unhighlightCell(self.selectionNode);\n        graph.getLinks().forEach(link => self.unhighlightCell(link));\n      }\n\n      if (el) {\n        self.highlightCell(el);\n        self.getElementPredecessorLinks(el).forEach(link => {\n          self.highlightCell(link);\n          link.toFront({\n            ignoreCommandManager: true\n          });\n        });\n        self.selectionNode = el;\n      } else {\n        self.selectionNode = null;\n      }\n    },\n\n    addHaloAndTooltip(cellView) {\n      if (cellView.model instanceof joint.dia.Link && cellView.model.attributes.target.id === undefined) return; // {\n      //   console.log(cellView.model.attributes.target.id=== undefined)\n      //   if(cellView.model.attributes.target.id){\n      //       console.log(1)\n      //   }\n      // }\n      // if (cellView.model instanceof joint.dia.Link &&cellView.model.attributes.target.id ==\"undefined\") return;\n\n      this.halo = new joint.ui.Halo({\n        cellView: cellView,\n        type: \"toolbar\",\n        boxContent: false // bang phia duoi cell cho biet tọa độ height width và angle\n\n      });\n      this.halo.changeHandle(\"remove\", {\n        position: \"se\"\n      });\n      this.halo.changeHandle(\"remove\", {\n        attrs: {\n          \".handle\": {\n            \"data-tooltip-class-name\": \"small\",\n            \"data-tooltip\": \"Click to remove the object\",\n            \"data-tooltip-position\": \"bottom\"\n          }\n        }\n      });\n      this.halo.changeHandle(\"fork\", {\n        attrs: {\n          \".handle\": {\n            \"data-tooltip-class-name\": \"small\",\n            \"data-tooltip\": \"Click and drag to clone and connect the object in one go\",\n            \"data-tooltip-position\": \"bottom\"\n          }\n        }\n      });\n      this.halo.changeHandle(\"clone\", {\n        attrs: {\n          \".handle\": {\n            \"data-tooltip-class-name\": \"small\",\n            \"data-tooltip\": \"Click and drag to clone the object\",\n            \"data-tooltip-position\": \"bottom\"\n          }\n        }\n      });\n      this.halo.changeHandle(\"unlink\", {\n        attrs: {\n          \".handle\": {\n            \"data-tooltip-class-name\": \"small\",\n            \"data-tooltip\": \"Click to break all connections to other objects\",\n            \"data-tooltip-position\": \"bottom\"\n          }\n        }\n      });\n      this.halo.changeHandle(\"link\", {\n        attrs: {\n          \".handle\": {\n            \"data-tooltip-class-name\": \"small\",\n            \"data-tooltip\": \"Click and drag to connect the object\",\n            \"data-tooltip-position\": \"bottom\"\n          }\n        }\n      });\n      new joint.ui.Tooltip({\n        rootTarget: document.body,\n        target: \"[data-tooltip]\",\n        padding: 15\n      });\n      this.halo.removeHandle(\"resize\");\n      this.halo.removeHandle(\"rotate\");\n      this.halo.removeHandle(\"direction\");\n      this.halo.render();\n    },\n\n    handlePaperEvents() {\n      let self = this;\n      let paper = self.paper;\n      let graph = self.graph; //nếu bấm thì =true\n\n      document.addEventListener(\"keydown\", function (evt) {\n        if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\n          self.ctrlDown = true;\n        }\n\n        if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\n          self.shiftDown = true;\n        }\n      });\n      document.addEventListener(\"keyup\", function (evt) {\n        if (!self.selectedElement && !self.selection) return;\n\n        if (evt.code === \"Backspace\" || evt.code === \"Delete\") {\n          //xóa 1 el\n          //xóa toàn bộ  el đã chọn\n          if (self.selection.model.length > 0) {\n            // chuyeent selection.collection thành mảng hảm remove cell nhận vào 1 mảng và xóa khỏi graph\n            let deleteArrId = [];\n            self.selection.model.models.forEach(element => {\n              // console.log(element.id);\n              // console.log(self.getNodeAttr(element.id));\n              deleteArrId.push(element.id);\n              self.getNodeAttr(element.id);\n            });\n            self.$emit(\"arr-node-delete\", deleteArrId);\n            evt.preventDefault();\n            graph.removeCells(self.selection.collection.toArray());\n            self.selection.collection.reset([]);\n            self.selectionNode = null;\n          } else if (self.selectedElement) {\n            if (self.selectedElement.attributes.type === \"standard.Link\") {\n              self.$emit(\"link-delete\", {\n                id: self.selectedElement.id\n              });\n            } else {\n              self.$emit(\"node-delete\", {\n                id: self.selectedElement.id\n              });\n            } // console.log(self.selectedElement);\n\n\n            self.selectedElement.remove(); // console.log(self.selectedElement);\n\n            self.selectionNode.attributes = null; // console.log(self.selectedElement);\n\n            self.selectionNode = null;\n          }\n        }\n      }, false); //   document.addEventListener('keyup', function (evt) {\n      //     if (!self.selectedElement && !self.selection) return;\n      //     if (evt.code === 'Backspace' || evt.code === 'Delete') {\n      //         //xóa 1 el\n      //         console.log(self.selectedElement)\n      //         if (self.selectedElement) {\n      //             self.selectedElement.remove();\n      //             self.selectedElement = null;\n      //             self.selectionNode=null;\n      //         }\n      //         //xóa toàn bộ  el đã chọn\n      //         else if (self.selection) {\n      //             // chuyeent selection.collection thành mảng hảm remove cell nhận vào 1 mảng và xóa khỏi graph\n      //             evt.preventDefault();\n      //             graph.removeCells(self.selection.collection.toArray())\n      //             self.selectionNode=null;\n      //         }\n      //     }\n      // });\n      //nếu thả nút thì =false\n\n      window.addEventListener(\"scroll\", event => {\n        console.log(window.scrollY);\n        console.log(window.scrollX);\n      });\n      document.addEventListener(\"keyup\", function (evt) {\n        if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\n          self.shiftDown = false;\n        }\n\n        if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\n          self.ctrlDown = false;\n        }\n      });\n      paper.on(\"cell:pointerup\", function (cellView) {\n        self.addHaloAndTooltip(cellView);\n\n        if (cellView.model.attributes[\"type\"] === \"standard.Link\") {\n          self.$emit(\"select-link\", {\n            id: cellView.model.id\n          });\n        } else {\n          self.$emit(\"select-cell\", {\n            id: cellView.model.id\n          });\n        }\n\n        self.selectedElement = cellView.model;\n        self.selectedElement.toFront({\n          ignoreCommandManager: true\n        }); // cellView.$el[0].parentElement.appendChild(cellView.$el[0])\n        // console.log(graph.getLinks())\n      });\n      paper.on({\n        //xử lý khi các sự kiện\n        \"cell:mouseenter\": cellView => {\n          cellView.model.toFront({\n            ignoreCommandManager: true\n          });\n        },\n        \"cell:mouseleave\": cellView => {\n          cellView.model.toBack({\n            ignoreCommandManager: true\n          });\n\n          if (self.selectionNode) {\n            self.getElementPredecessorLinks(self.selectionNode).forEach(link => {\n              link.toFront({\n                ignoreCommandManager: true\n              });\n            });\n          }\n        },\n        \"element:pointerclick\": cellView => {\n          //chỉ đổi màu khi ko bấm ctrl\n          if (self.ctrlDown === false) {\n            self.selectElement(cellView.model);\n          }\n        },\n        \"link:mouseenter\": cellView => {\n          cellView.addTools(this.toolsView);\n        },\n        \"link:mouseleave\": cellView => {\n          cellView.hideTools();\n        },\n        \"link:pointerclick\": cellView => {\n          self.selectElement(cellView.model); //chon vao link thi mo cho phep doi node\n\n          cellView.addTools(this.toolsView);\n        },\n        //chuyển lại màu cũ khi bấm ra ngoài\n        \"blank:pointerclick\": () => {\n          self.selectElement(null);\n          paper.removeTools({\n            ignoreCommandManager: true\n          });\n        },\n        \"element:pointerup\": function (cellView, evt) {\n          if (evt.ctrlKey || evt.metaKey) {\n            console.log(self.selection);\n            self.selection.collection.add(cellView.model); //loop to all the element in selection and set it to front\n\n            self.selection.collection.models.forEach(element => {\n              element.toFront({\n                ignoreCommandManager: true\n              });\n            });\n          }\n        },\n        //chuyển màu khi bấm vào link và cho nó lên trc\n        \"link:pointerup\": function (cellView) {\n          self.selectedLink = cellView.model;\n          self.selectedLink.toFront({\n            ignoreCommandManager: true\n          });\n        },\n        // lắng nghe sự kiện bấm ở ngoài khoange trống check shift để active select\n        \"blank:pointerdown\": function (evt, x, y) {\n          if (self.shiftDown === true) {\n            self.selectElement(null);\n            self.paperScroller.setCursor(\"crosshair\");\n            self.selection.startSelecting(evt);\n          } else {\n            self.selection.collection.reset([]);\n            self.paperScroller.startPanning(evt, x, y);\n            paper.removeTools();\n            self.paperScroller.setCursor(\"grab\");\n          }\n        }\n      });\n      var main = document.getElementById(\"main\");\n      main.addEventListener(\"scroll\", evt => {\n        if (view.scrollTop > 0) {\n          alert(\"up\");\n          console.log('up');\n        }\n\n        if (view.scrollTop <= 0) {\n          alert(\"down\");\n          console.log('down');\n        }\n      });\n      graph.on(\"add\", (cell, collection, opt) => {\n        let type = cell.attributes.type; // console.log(type.split('.')[1])\n\n        if (type == \"standard.Link\") {\n          // self.addLinkTools(cell, paper);\n          // console.log(cell.attributes.source)\n          self.$emit(\"link-added\", {\n            source: cell.attributes.source,\n            target: cell.attributes.target\n          });\n        } else {\n          type = type.split(\".\")[1];\n          self.$emit(\"node-added\", {\n            id: cell.id,\n            type: type,\n            prosition: cell.attributes.position\n          });\n        }\n      });\n      graph.on(\"change:target\", function (link) {\n        if (link.get(\"target\").id) {\n          self.$emit(\"change-link-target\", {\n            id: link.get(\"target\").id\n          });\n        }\n      }); //xóa el nếu chọn lại lần 2 khi bấm ctrl\n\n      self.selection.on(\"selection-box:pointerdown\", function (cellView, evt) {\n        if (evt.ctrlKey || evt.metaKey) {\n          self.selection.collection.remove(cellView.model);\n        }\n      }); //kết hợp bấm ctrl để check các tổ hợp phím ctrl + C,V,Z,Y,A...\n\n      document.addEventListener(\"keydown\", function (evt) {\n        self.clipboard = new joint.ui.Clipboard();\n\n        if (evt.code === \"NumpadAdd\" && self.shiftDown === true) {\n          // console.log(evt.code)\n          self.paperScroller.zoom(0.2, {\n            max: 4\n          });\n        }\n\n        if (evt.code === \"NumpadSubtract\" && self.shiftDown === true) {\n          self.paperScroller.zoom(-0.2, {\n            min: 0.2\n          }); // console.log(evt.code)\n        } //check+ A\n\n\n        if (evt.code === \"KeyA\" && self.ctrlDown === true) {\n          self.selection.collection.reset(graph.getElements());\n          evt.preventDefault();\n        } //check ctrl + Z\n\n\n        if (evt.code === \"KeyZ\" && self.ctrlDown === true) {\n          self.commandManager.undo();\n\n          if (self.selectionNode) {\n            self.unhighlightCell(self.selectionNode);\n            graph.getLinks().forEach(link => self.unhighlightCell(link)); // console.log(selectionNode)\n\n            self.selectionNode = null;\n          }\n        } //check ctrl + Y\n\n\n        if (evt.code === \"KeyY\" && self.ctrlDown === true) {\n          self.commandManager.redo();\n          self.selectElement(null);\n        } //check ctrl + V ,ctrl + C, ctrl+X\n\n\n        if (evt.code === \"KeyX\" && self.ctrlDown === true) {\n          self.clipboard.cutElements(self.selection.collection, paper.model);\n        }\n\n        if (evt.code === \"KeyC\" && self.ctrlDown === true) {\n          self.clipboard.copyElements(self.selection.collection, graph);\n        }\n\n        if (evt.code === \"KeyV\" && self.ctrlDown === true) {\n          var pastedCells = self.clipboard.pasteCells(graph, {\n            translate: {\n              dx: 40,\n              dy: 40\n            },\n            useLocalStorage: true\n          });\n\n          var elements = _.filter(pastedCells, function (cell) {\n            return cell.isElement();\n          }); // Make sure pasted elements get selected immediately. This makes the UX better as\n          // the user can immediately manipulate the pasted elements.\n\n\n          self.selection.collection.reset(elements);\n        }\n      });\n    },\n\n    btnHandler() {\n      let self = this;\n      $(\"#btn-zoomin\").on(\"click\", function () {\n        self.paperScroller.zoom(0.2, {\n          max: 4\n        });\n      });\n      $(\"#btn-zoomout\").on(\"click\", function () {\n        self.paperScroller.zoom(-0.2, {\n          min: 0.2\n        });\n      });\n      $(\"#btn-center\").on(\"click\", _.bind(self.paperScroller.center, self.paperScroller));\n      $(\"#btn-center-content\").on(\"click\", _.bind(self.paperScroller.centerContent, self.paperScroller));\n    },\n\n    getAllLinks() {\n      return this.graph.getLinks();\n    },\n\n    getAllNodes() {\n      return this.graph.getCells();\n    },\n\n    clearAll() {\n      return this.graph.clear();\n    },\n\n    getNodeAttr(id) {\n      let node = this.graph.getCell(id);\n\n      if (node) {\n        return node.attributes;\n      } else {\n        return {};\n      }\n    },\n\n    render() {\n      let nodeInfos = this.nodes;\n      let linkInfos = this.links;\n      nodeInfos.forEach(nodeInfo => {\n        let nodeType = nodeInfo.type;\n        let elementName = this.jsUcfirst(nodeInfo.name); //checknode\n\n        if (nodeType === \"Rectangle\") {\n          if (elementName === \"Load\") {\n            let cell = new this.customElNoInPorts({\n              position: nodeInfo.position,\n              id: nodeInfo.id\n            });\n            cell.prop(\"attrs/image/xlinkHref\", require(`../assets/${elementName}.svg`));\n            this.graph.addCell(cell); // console.log(cell)\n            // linkInfo.source=cell\n          } else {\n            let cell = new this.customEl({\n              position: nodeInfo.position,\n              id: nodeInfo.id\n            });\n            cell.prop(\"attrs/image/xlinkHref\", require(`../assets/${elementName}.svg`));\n            this.graph.addCell(cell); //   linkInfo.target=cell\n            // console.log(cell)\n          }\n        } else {\n          console.error(\"Node type '\" + nodeType + \"' is not defined\");\n        }\n      });\n\n      if (linkInfos) {\n        linkInfos.forEach(linkInfo => {\n          let link = new joint.shapes.standard.Link({\n            attrs: {\n              z: 1,\n              line: {\n                connection: true,\n                stroke: \"#707070\",\n                strokeWidth: 3,\n                strokeLinejoin: \"round\",\n                targetMarker: {\n                  type: \"path\",\n                  d: \"M 10 -5 0 0 10 5 Z\"\n                }\n              },\n              wrapper: {\n                connection: true,\n                strokeWidth: 6,\n                strokeLinejoin: \"round\"\n              }\n            },\n            markup: [{\n              tagName: \"path\",\n              selector: \"wrapper\",\n              attributes: {\n                fill: \"none\",\n                stroke: \"transparent\"\n              }\n            }, {\n              tagName: \"path\",\n              selector: \"line\",\n              attributes: {\n                fill: \"none\"\n              }\n            }]\n          });\n          link.source(this.getNodeAttr(linkInfo.source));\n          link.target(this.getNodeAttr(linkInfo.target));\n          link.addTo(this.graph);\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["name","props","width","type","String","Number","default","height","gridSize","drawGrid","Object","Boolean","highLightLinks","Array","nodes","id","position","x","y","links","source","target","data","stencilShapes","selectionNode","selectedElement","selectedLink","ctrlDown","shiftDown","color","arr","created","graph","joint","dia","Graph","mounted","initPaper","methods","commandManager","CommandManager","cmdBeforeAdd","cmdName","cell","options","ignoreCommandManager","paper","Paper","model","async","sorting","APPROX","restrictTranslate","stopDelegation","interactive","vertexAdd","snapLinks","radius","linkPinning","multiLinks","defaultRouter","args","padding","defaultConnector","validateConnection","cellViewS","magnetS","cellViewT","magnetT","end","linkView","getAttribute","get","linkMove","labelMove","arrowheadMove","vertexMove","vertexRemove","useLinkTools","defaultLink","shapes","standard","Link","attrs","z","line","connection","stroke","strokeWidth","strokeLinejoin","wrapper","markup","tagName","selector","attributes","fill","targetArrowheadTool","linkTools","TargetArrowhead","toolsView","ToolsView","tools","paperScroller","ui","PaperScroller","autoResizePaper","scrollWhileDragging","cursor","selection","Selection","theme","useModelGeometry","allowTranslate","removeHandle","toolbar","Toolbar","references","document","getElementById","appendChild","render","el","snaplines","Snaplines","startListening","highlighters","$el","css","appendTo","addStencil","handlePaperEvents","btnHandler","collection","reset","getElements","center","jsUcfirst","string","charAt","toUpperCase","slice","stencilRenderHandler","positionX","positionY","elNoInPorts","spaceBetweenElToX","spaceBetweenElToY","customEl","Element","define","size","removable","image","root","magnet","body","rx","ry","ports","items","group","groups","out","portBody","r","in","customElNoInPorts","targetMarker","d","forEach","element","elementName","prop","require","push","stencil","Stencil","dropAnimation","duration","easing","load","getElementPredecessorLinks","getSubgraph","getPredecessors","filter","isLink","highlightCell","self","addClass","add","findView","isElement","className","unhighlightCell","remove","selectElement","getLinks","link","toFront","addHaloAndTooltip","cellView","undefined","halo","Halo","boxContent","changeHandle","Tooltip","rootTarget","addEventListener","evt","code","length","deleteArrId","models","getNodeAttr","$emit","preventDefault","removeCells","toArray","window","event","console","log","scrollY","scrollX","on","toBack","addTools","hideTools","removeTools","ctrlKey","metaKey","setCursor","startSelecting","startPanning","main","view","scrollTop","alert","opt","split","prosition","clipboard","Clipboard","zoom","max","min","undo","redo","cutElements","copyElements","pastedCells","pasteCells","translate","dx","dy","useLocalStorage","elements","_","$","bind","centerContent","getAllLinks","getAllNodes","getCells","clearAll","clear","node","getCell","nodeInfos","linkInfos","nodeInfo","nodeType","addCell","error","linkInfo","addTo"],"sourceRoot":"","sources":["C:\\Users\\Admin\\dataflow-test\\src\\components\\dataflow.vue"],"sourcesContent":["<template>\r\n  <div id=\"main\">\r\n    <div ref=\"Toolbar\" id=\"Toolbar\">\r\n      <button id=\"btn-zoomout\" class=\"btn\">zoom out</button>\r\n      <button id=\"btn-zoomin\" class=\"btn\">zoom in</button>\r\n      <button id=\"btn-center\" class=\"btn\">center</button>\r\n      <button id=\"btn-center-content\" class=\"btn\">center content</button>\r\n    </div>\r\n    <div ref=\"nodeStencile\" id=\"stencil\"></div>\r\n\r\n    <div id=\"paper\"></div>\r\n    <div id=\"navigator\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"DataFlow\",\r\n  props: {\r\n    width: {\r\n      type: [String, Number],\r\n      default: 800,\r\n    },\r\n    height: {\r\n      type: [String, Number],\r\n      default: 650,\r\n    },\r\n    gridSize: {\r\n      type: Number,\r\n      default: 10,\r\n    },\r\n    drawGrid: {\r\n      type: [Object, Boolean],\r\n      default: true,\r\n    },\r\n\r\n    highLightLinks: {\r\n      type: Array,\r\n      default() {\r\n        return [];\r\n      },\r\n    },\r\n    nodes: {\r\n      type: [Object, Boolean],\r\n      default: [\r\n        {\r\n          id: \"fd9c3b76-efea-436f-9bd5-ac2ba665d512\",\r\n          name: \"load\",\r\n          position: { x: 250, y: 250 },\r\n          type: \"Rectangle\",\r\n        },\r\n        {\r\n          id: \"4b20a9c1-bdbf-44fa-a64c-3ac11c377f84\",\r\n          name: \"filter\",\r\n          position: { x: 550, y: 250 },\r\n          type: \"Rectangle\",\r\n        },\r\n        {\r\n          id: \"fd45s2v9-bdbf-44fa-a64c-3ac11c377f84\",\r\n          name: \"filter\",\r\n          position: { x: 250, y: 450 },\r\n          type: \"Rectangle\",\r\n        },\r\n      ],\r\n    },\r\n    links: {\r\n      type: [Object, Boolean],\r\n      default:\r\n        // false,\r\n        [\r\n          {\r\n            source: \"fd9c3b76-efea-436f-9bd5-ac2ba665d512\",\r\n            target: \"4b20a9c1-bdbf-44fa-a64c-3ac11c377f84\",\r\n          },\r\n          {\r\n            source: \"fd45s2v9-bdbf-44fa-a64c-3ac11c377f84\",\r\n            target: \"4b20a9c1-bdbf-44fa-a64c-3ac11c377f84\",\r\n          },\r\n        ],\r\n    },\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      stencilShapes: [],\r\n      selectionNode: null,\r\n      selectedElement: null,\r\n      selectedLink: null,\r\n\r\n      //check ctrl shift\r\n      ctrlDown: false,\r\n      shiftDown: false,\r\n      color: \"rgb(255 136 0)\",\r\n      arr: [\r\n        \"filter\",\r\n        \"formula\",\r\n        \"join\",\r\n        \"load\",\r\n        \"pivot\",\r\n        \"sample\",\r\n        \"script\",\r\n        \"select\",\r\n        \"sort\",\r\n        \"summarize\",\r\n        \"transposeTable\",\r\n        \"union\",\r\n        \"weightAvg\",\r\n      ],\r\n    };\r\n  },\r\n  created() {\r\n    this.graph = new joint.dia.Graph();\r\n  },\r\n  mounted() {\r\n    this.initPaper();\r\n    // this.center()\r\n  },\r\n  methods: {\r\n    // center() {\r\n    //   _.bind(self.paperScroller.centerContent, self.paperScroller);\r\n    // },\r\n    initPaper() {\r\n      let graph = this.graph;\r\n      this.commandManager = new joint.dia.CommandManager({\r\n        graph: graph,\r\n        cmdBeforeAdd: (cmdName, cell, graph, options = {}) => {\r\n          return !options.ignoreCommandManager;\r\n        },\r\n      });\r\n      this.paper = new joint.dia.Paper({\r\n        width: this.width,\r\n        height: this.height,\r\n        model: this.graph,\r\n        async: true,\r\n        sorting: joint.dia.Paper.sorting.APPROX,\r\n        gridSize: this.gridSize,\r\n        drawGrid: this.drawGrid,\r\n        restrictTranslate: true,\r\n        stopDelegation: false,\r\n\r\n        interactive: { vertexAdd: false },\r\n        // background: { color: '#F3F7F6' },\r\n        // defaultConnectionPoint: { name: 'boundary' },\r\n        // defaultConnector: {\r\n        //     name: \"rounded\"\r\n        //   },\r\n        //   defaultRouter: {\r\n        //     name: \"manhattan\",\r\n        //     args: {\r\n        //       step: 10,\r\n        //       endDirections: [\"bottom\"],\r\n        //       startDirections: [\"top\"],\r\n        //       padding: { bottom: 20 }\r\n        //     }\r\n        //   },\r\n        snapLinks: {\r\n          radius: 75,\r\n        },\r\n        linkPinning: false,\r\n        multiLinks: false,\r\n        defaultRouter: { name: \"manhattan\", args: { padding: 10 } },\r\n        defaultConnector: { name: \"rounded\" },\r\n        validateConnection: function (\r\n          cellViewS,\r\n          magnetS,\r\n          cellViewT,\r\n          magnetT,\r\n          end,\r\n          linkView\r\n        ) {\r\n          // Prevent linking from input ports.\r\n          if (magnetS && magnetS.getAttribute(\"port-group\") === \"in\")\r\n            return false;\r\n          // Prevent linking from output ports to input ports within one element.\r\n          if (cellViewS === cellViewT) return false;\r\n          // Prevent linking to input ports.\r\n          return (\r\n            (magnetT && magnetT.getAttribute(\"port-group\") === \"in\") ||\r\n            (cellViewS.model.get(\"type\") === \"qad.Question\" &&\r\n              cellViewT.model.get(\"type\") === \"qad.Answer\")\r\n          );\r\n        },\r\n        // validateConnection: function (view1, _magnet1, view2, _magnet2) {\r\n        //     // Do not allow loop links (Element to Link, Element A to Element B is valid).\r\n        //     return view1 !== view2;\r\n        // },\r\n        interactive: {\r\n          linkMove: true,\r\n          labelMove: true,\r\n          arrowheadMove: true,\r\n          vertexMove: false,\r\n          vertexAdd: false,\r\n          vertexRemove: false,\r\n          useLinkTools: false,\r\n        },\r\n        defaultLink: function () {\r\n          return new joint.shapes.standard.Link({\r\n            attrs: {\r\n              z: 1,\r\n              line: {\r\n                connection: true,\r\n                stroke: \"#707070\",\r\n                strokeWidth: 2,\r\n                strokeLinejoin: \"round\",\r\n              },\r\n              wrapper: {\r\n                connection: true,\r\n                strokeWidth: 10,\r\n                strokeLinejoin: \"round\",\r\n              },\r\n            },\r\n\r\n            markup: [\r\n              {\r\n                tagName: \"path\",\r\n                selector: \"wrapper\",\r\n                attributes: {\r\n                  fill: \"none\",\r\n\r\n                  stroke: \"transparent\",\r\n                },\r\n              },\r\n              {\r\n                tagName: \"path\",\r\n                selector: \"line\",\r\n                attributes: {\r\n                  fill: \"none\",\r\n                },\r\n              },\r\n            ],\r\n          });\r\n        },\r\n      });\r\n      var targetArrowheadTool = new joint.linkTools.TargetArrowhead();\r\n      this.toolsView = new joint.dia.ToolsView({\r\n        tools: [\r\n          // verticesTool, segmentsTool,\r\n          // sourceArrowheadTool,\r\n          targetArrowheadTool,\r\n          // sourceAnchorTool, targetAnchorTool,\r\n          // boundaryTool, removeButton\r\n        ],\r\n      });\r\n      // var elementView = element.findView(this.paper);\r\n      // elementView.addTools(this.toolsView);\r\n      // var linkView = this.link.findView(this.paper);\r\n      // linkView.addTools(this.toolsView);\r\n      this.paperScroller = new joint.ui.PaperScroller({\r\n        paper: this.paper,\r\n        autoResizePaper: true,\r\n        scrollWhileDragging: true,\r\n        cursor: \"grab\",\r\n      });\r\n      this.selection = new joint.ui.Selection({\r\n        theme: \"material\",\r\n        paper: this.paper,\r\n        useModelGeometry: true,\r\n        allowTranslate: true,\r\n      });\r\n      this.selection.removeHandle(\"rotate\");\r\n      this.selection.removeHandle(\"resize\");\r\n\r\n      this.toolbar = new joint.ui.Toolbar({\r\n        // initialize tools with default settings\r\n        tools: [\"zoomIn\", \"zoomOut\", \"zoomToFit\", \"zoomSlider\", \"undo\", \"redo\"],\r\n        references: {\r\n          paperScroller: this.paperScroller,\r\n          commandManager: this.commandManager,\r\n        },\r\n      });\r\n      document.getElementById(\"Toolbar\").appendChild(this.toolbar.render().el);\r\n\r\n      this.snaplines = new joint.ui.Snaplines({ paper: this.paper });\r\n      this.snaplines.startListening();\r\n      //render paper\r\n      document\r\n        .getElementById(\"paper\")\r\n        .appendChild(this.paperScroller.render().el);\r\n      //render paperScroller\r\n      this.highlighters = joint.highlighters;\r\n      this.paperScroller.$el\r\n        .css({ width: 800, height: 600 })\r\n        .appendTo(\"#paper\");\r\n\r\n      this.addStencil();\r\n\r\n      this.handlePaperEvents();\r\n      this.btnHandler();\r\n      this.selection.collection.reset(graph.getElements());\r\n      this.render();\r\n      this.paperScroller.center();\r\n      // _.bind(this.paperScroller.centerContent, this.paperScroller)\r\n      // this.paperScroller.centerContent();\r\n      // this.paperScroller.adjustPaper();\r\n      // this.paperScroller.zoomToFit({ padding: 200 });\r\n    },\r\n    jsUcfirst(string) {\r\n      return string.charAt(0).toUpperCase() + string.slice(1);\r\n    },\r\n    stencilRenderHandler(\r\n      positionX,\r\n      positionY,\r\n      arr,\r\n      elNoInPorts = \"\",\r\n      spaceBetweenElToX = 0,\r\n      spaceBetweenElToY = 0\r\n    ) {\r\n      this.customEl = joint.dia.Element.define(\"standard.Rectangle\", {\r\n        z: 1,\r\n        size: {\r\n          width: 44,\r\n          height: 35,\r\n        },\r\n        removable: false,\r\n        attrs: {\r\n          image: {\r\n            x: 5,\r\n            y: 5,\r\n            width: \"calc(w-10)\",\r\n            height: \"calc(h-10 )\",\r\n          },\r\n          root: {\r\n            magnet: false,\r\n          },\r\n          body: {\r\n            fill: \"#FFFFFF\",\r\n            stroke: \"#A0A0A0\",\r\n            width: \"calc(w)\",\r\n            height: \"calc(h)\",\r\n            strokeWidth: 2,\r\n            rx: 5,\r\n            ry: 5,\r\n          },\r\n        },\r\n        ports: {\r\n          items: [\r\n            {\r\n              id: \"out-port\",\r\n              group: \"out\",\r\n            },\r\n            {\r\n              id: \"in-port\",\r\n              group: \"in\",\r\n            },\r\n          ],\r\n          groups: {\r\n            out: {\r\n              markup: [\r\n                {\r\n                  tagName: \"circle\",\r\n                  selector: \"portBody\",\r\n                },\r\n              ],\r\n              position: {\r\n                name: \"right\",\r\n              },\r\n              attrs: {\r\n                portBody: {\r\n                  r: 5,\r\n                  magnet: \"active\",\r\n                  fill: \"#187BD3\",\r\n                  stroke: \"#187BD3\",\r\n                },\r\n              },\r\n            },\r\n            in: {\r\n              markup: [\r\n                {\r\n                  tagName: \"circle\",\r\n                  selector: \"portBody\",\r\n                },\r\n              ],\r\n              position: {\r\n                name: \"left\",\r\n              },\r\n              attrs: {\r\n                portBody: {\r\n                  r: 5,\r\n                  magnet: \"passive\",\r\n                  fill: \"#FFFFFF\",\r\n                  stroke: \"#187BD3\",\r\n                },\r\n              },\r\n            },\r\n          },\r\n        },\r\n        markup: [\r\n          {\r\n            tagName: \"rect\",\r\n            selector: \"body\",\r\n          },\r\n          {\r\n            tagName: \"image\",\r\n            selector: \"image\",\r\n          },\r\n          {\r\n            tagName: \"ports\",\r\n            selector: \"ports\",\r\n          },\r\n        ],\r\n      });\r\n      this.customElNoInPorts = joint.dia.Element.define(\"standard.Rectangle\", {\r\n        z: 1,\r\n        theme: \"material\",\r\n        size: {\r\n          width: 44,\r\n          height: 35,\r\n        },\r\n        removable: false,\r\n        attrs: {\r\n          image: {\r\n            x: 5,\r\n            y: 5,\r\n            width: \"calc(w-10)\",\r\n            height: \"calc(h-10 )\",\r\n          },\r\n          root: {\r\n            magnet: false,\r\n          },\r\n          body: {\r\n            fill: \"#FFFFFF\",\r\n            stroke: \"#A0A0A0\",\r\n            width: \"calc(w)\",\r\n            height: \"calc(h)\",\r\n            strokeWidth: 2,\r\n          },\r\n          line: {\r\n            connection: true,\r\n            stroke: \"#333333\",\r\n            strokeWidth: 2,\r\n            strokeLinejoin: \"round\",\r\n            targetMarker: {\r\n              type: \"path\",\r\n              d: \"M 10 -5 0 0 10 5 z\",\r\n            },\r\n          },\r\n        },\r\n        ports: {\r\n          items: [\r\n            {\r\n              id: \"out-port\",\r\n              group: \"out\",\r\n            },\r\n          ],\r\n          groups: {\r\n            out: {\r\n              markup: [\r\n                {\r\n                  tagName: \"circle\",\r\n                  selector: \"portBody\",\r\n                },\r\n              ],\r\n              position: {\r\n                name: \"right\",\r\n              },\r\n              attrs: {\r\n                portBody: {\r\n                  r: 5,\r\n                  magnet: \"active\",\r\n                  fill: \"#187BD3\",\r\n                  stroke: \"#187BD3\",\r\n                },\r\n              },\r\n            },\r\n          },\r\n        },\r\n        markup: [\r\n          {\r\n            tagName: \"rect\",\r\n            selector: \"body\",\r\n          },\r\n          {\r\n            tagName: \"image\",\r\n            selector: \"image\",\r\n          },\r\n          {\r\n            tagName: \"ports\",\r\n            selector: \"ports\",\r\n          },\r\n        ],\r\n      });\r\n      arr.forEach((element) => {\r\n        //chuyển thành hoa chữ đầu cho đúng định dạng file ảnh lưu\r\n        let elementName = this.jsUcfirst(element);\r\n        if (elementName === this.jsUcfirst(elNoInPorts)) {\r\n          element = new this.customElNoInPorts();\r\n        } else {\r\n          element = new this.customEl();\r\n        }\r\n        element.prop(\r\n          \"attrs/image/xlinkHref\",\r\n          require(`../assets/${elementName}.svg`)\r\n        );\r\n        this.stencilShapes.push(element.position(positionX, positionY));\r\n        if (spaceBetweenElToX > 0) {\r\n          positionX += element.attributes.size.width + spaceBetweenElToX;\r\n        }\r\n        if (spaceBetweenElToY > 0) {\r\n          positionY += element.attributes.size.height + spaceBetweenElToY;\r\n        }\r\n      });\r\n    },\r\n\r\n    addStencil() {\r\n      let graph = this.graph;\r\n      let paper = this.paper;\r\n      var stencil = new joint.ui.Stencil({\r\n        paper: this.paperScroller,\r\n        width: 900,\r\n        height: 60,\r\n        dropAnimation: { duration: 200, easing: \"swing\" },\r\n      });\r\n\r\n      this.stencilRenderHandler(20, 20, this.arr, \"load\", 16);\r\n      document.getElementById(\"stencil\").appendChild(stencil.render().el);\r\n      stencil.load(this.stencilShapes);\r\n    },\r\n    getElementPredecessorLinks(el) {\r\n      let graph = this.graph;\r\n\r\n      return graph\r\n        .getSubgraph([el, ...graph.getPredecessors(el)])\r\n        .filter((cell) => cell.isLink());\r\n    },\r\n    highlightCell(cell) {\r\n      let self = this;\r\n      if (cell) {\r\n        self.highlighters.addClass.add(\r\n          cell.findView(self.paper),\r\n          cell.isElement() ? \"body\" : \"line\",\r\n          \"selection\",\r\n          { className: \"selection\" }\r\n        );\r\n      } else {\r\n        return;\r\n      }\r\n    },\r\n    unhighlightCell(cell) {\r\n      let self = this;\r\n      if (cell) {\r\n        self.highlighters.addClass.remove(\r\n          cell.findView(self.paper),\r\n          \"selection\"\r\n        );\r\n      } else {\r\n        return;\r\n      }\r\n    },\r\n    selectElement(el) {\r\n      let self = this;\r\n      let graph = self.graph;\r\n      if (self.selectionNode === el) return;\r\n      if (self.selectionNode) {\r\n        self.unhighlightCell(self.selectionNode);\r\n        graph.getLinks().forEach((link) => self.unhighlightCell(link));\r\n      }\r\n      if (el) {\r\n        self.highlightCell(el);\r\n        self.getElementPredecessorLinks(el).forEach((link) => {\r\n          self.highlightCell(link);\r\n          link.toFront({ ignoreCommandManager: true });\r\n        });\r\n        self.selectionNode = el;\r\n      } else {\r\n        self.selectionNode = null;\r\n      }\r\n    },\r\n    addHaloAndTooltip(cellView) {\r\n      if (\r\n        cellView.model instanceof joint.dia.Link &&\r\n        cellView.model.attributes.target.id === undefined\r\n      )\r\n        return;\r\n      // {\r\n      //   console.log(cellView.model.attributes.target.id=== undefined)\r\n      //   if(cellView.model.attributes.target.id){\r\n      //       console.log(1)\r\n      //   }\r\n\r\n      // }\r\n      // if (cellView.model instanceof joint.dia.Link &&cellView.model.attributes.target.id ==\"undefined\") return;\r\n      this.halo = new joint.ui.Halo({\r\n        cellView: cellView,\r\n        type: \"toolbar\",\r\n        boxContent: false, // bang phia duoi cell cho biet tọa độ height width và angle\r\n      });\r\n      this.halo.changeHandle(\"remove\", { position: \"se\" });\r\n      this.halo.changeHandle(\"remove\", {\r\n        attrs: {\r\n          \".handle\": {\r\n            \"data-tooltip-class-name\": \"small\",\r\n            \"data-tooltip\": \"Click to remove the object\",\r\n            \"data-tooltip-position\": \"bottom\",\r\n          },\r\n        },\r\n      });\r\n      this.halo.changeHandle(\"fork\", {\r\n        attrs: {\r\n          \".handle\": {\r\n            \"data-tooltip-class-name\": \"small\",\r\n            \"data-tooltip\":\r\n              \"Click and drag to clone and connect the object in one go\",\r\n            \"data-tooltip-position\": \"bottom\",\r\n          },\r\n        },\r\n      });\r\n      this.halo.changeHandle(\"clone\", {\r\n        attrs: {\r\n          \".handle\": {\r\n            \"data-tooltip-class-name\": \"small\",\r\n            \"data-tooltip\": \"Click and drag to clone the object\",\r\n            \"data-tooltip-position\": \"bottom\",\r\n          },\r\n        },\r\n      });\r\n      this.halo.changeHandle(\"unlink\", {\r\n        attrs: {\r\n          \".handle\": {\r\n            \"data-tooltip-class-name\": \"small\",\r\n            \"data-tooltip\": \"Click to break all connections to other objects\",\r\n            \"data-tooltip-position\": \"bottom\",\r\n          },\r\n        },\r\n      });\r\n      this.halo.changeHandle(\"link\", {\r\n        attrs: {\r\n          \".handle\": {\r\n            \"data-tooltip-class-name\": \"small\",\r\n            \"data-tooltip\": \"Click and drag to connect the object\",\r\n            \"data-tooltip-position\": \"bottom\",\r\n          },\r\n        },\r\n      });\r\n      new joint.ui.Tooltip({\r\n        rootTarget: document.body,\r\n        target: \"[data-tooltip]\",\r\n        padding: 15,\r\n      });\r\n\r\n      this.halo.removeHandle(\"resize\");\r\n      this.halo.removeHandle(\"rotate\");\r\n      this.halo.removeHandle(\"direction\");\r\n      this.halo.render();\r\n    },\r\n\r\n    handlePaperEvents() {\r\n      let self = this;\r\n      let paper = self.paper;\r\n      let graph = self.graph;\r\n      //nếu bấm thì =true\r\n      document.addEventListener(\"keydown\", function (evt) {\r\n        if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\r\n          self.ctrlDown = true;\r\n        }\r\n        if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\r\n          self.shiftDown = true;\r\n        }\r\n      });\r\n      document.addEventListener(\r\n        \"keyup\",\r\n        function (evt) {\r\n          if (!self.selectedElement && !self.selection) return;\r\n          if (evt.code === \"Backspace\" || evt.code === \"Delete\") {\r\n            //xóa 1 el\r\n\r\n            //xóa toàn bộ  el đã chọn\r\n            if (self.selection.model.length > 0) {\r\n              // chuyeent selection.collection thành mảng hảm remove cell nhận vào 1 mảng và xóa khỏi graph\r\n              let deleteArrId = [];\r\n              self.selection.model.models.forEach((element) => {\r\n                // console.log(element.id);\r\n                // console.log(self.getNodeAttr(element.id));\r\n                deleteArrId.push(element.id);\r\n                self.getNodeAttr(element.id);\r\n              });\r\n              self.$emit(\"arr-node-delete\", deleteArrId);\r\n\r\n              evt.preventDefault();\r\n              graph.removeCells(self.selection.collection.toArray());\r\n              self.selection.collection.reset([]);\r\n              self.selectionNode = null;\r\n            } else if (self.selectedElement) {\r\n              if (self.selectedElement.attributes.type === \"standard.Link\") {\r\n                self.$emit(\"link-delete\", { id: self.selectedElement.id });\r\n              } else {\r\n                self.$emit(\"node-delete\", { id: self.selectedElement.id });\r\n              }\r\n              // console.log(self.selectedElement);\r\n              self.selectedElement.remove();\r\n              // console.log(self.selectedElement);\r\n              self.selectionNode.attributes = null;\r\n              // console.log(self.selectedElement);\r\n              self.selectionNode = null;\r\n            }\r\n          }\r\n        },\r\n        false\r\n      );\r\n      //   document.addEventListener('keyup', function (evt) {\r\n\r\n      //     if (!self.selectedElement && !self.selection) return;\r\n      //     if (evt.code === 'Backspace' || evt.code === 'Delete') {\r\n      //         //xóa 1 el\r\n      //         console.log(self.selectedElement)\r\n      //         if (self.selectedElement) {\r\n      //             self.selectedElement.remove();\r\n      //             self.selectedElement = null;\r\n      //             self.selectionNode=null;\r\n      //         }\r\n      //         //xóa toàn bộ  el đã chọn\r\n      //         else if (self.selection) {\r\n      //             // chuyeent selection.collection thành mảng hảm remove cell nhận vào 1 mảng và xóa khỏi graph\r\n      //             evt.preventDefault();\r\n      //             graph.removeCells(self.selection.collection.toArray())\r\n      //             self.selectionNode=null;\r\n      //         }\r\n      //     }\r\n      // });\r\n      //nếu thả nút thì =false\r\n      window.addEventListener(\"scroll\", (event) => {\r\n        console.log(window.scrollY);\r\n        console.log(window.scrollX);\r\n      });\r\n      document.addEventListener(\"keyup\", function (evt) {\r\n        if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\r\n          self.shiftDown = false;\r\n        }\r\n        if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\r\n          self.ctrlDown = false;\r\n        }\r\n      });\r\n      paper.on(\"cell:pointerup\", function (cellView) {\r\n        self.addHaloAndTooltip(cellView);\r\n\r\n        if (cellView.model.attributes[\"type\"] === \"standard.Link\") {\r\n          self.$emit(\"select-link\", { id: cellView.model.id });\r\n        } else {\r\n          self.$emit(\"select-cell\", { id: cellView.model.id });\r\n        }\r\n\r\n        self.selectedElement = cellView.model;\r\n        self.selectedElement.toFront({ ignoreCommandManager: true });\r\n        // cellView.$el[0].parentElement.appendChild(cellView.$el[0])\r\n        // console.log(graph.getLinks())\r\n      });\r\n\r\n      paper.on({\r\n        //xử lý khi các sự kiện\r\n        \"cell:mouseenter\": (cellView) => {\r\n          cellView.model.toFront({ ignoreCommandManager: true });\r\n        },\r\n        \"cell:mouseleave\": (cellView) => {\r\n          cellView.model.toBack({ ignoreCommandManager: true });\r\n\r\n          if (self.selectionNode) {\r\n            self\r\n              .getElementPredecessorLinks(self.selectionNode)\r\n              .forEach((link) => {\r\n                link.toFront({ ignoreCommandManager: true });\r\n              });\r\n          }\r\n        },\r\n\r\n        \"element:pointerclick\": (cellView) => {\r\n          //chỉ đổi màu khi ko bấm ctrl\r\n          if (self.ctrlDown === false) {\r\n            self.selectElement(cellView.model);\r\n          }\r\n        },\r\n        \"link:mouseenter\": (cellView) => {\r\n          cellView.addTools(this.toolsView);\r\n        },\r\n        \"link:mouseleave\": (cellView) => {\r\n          cellView.hideTools();\r\n        },\r\n        \"link:pointerclick\": (cellView) => {\r\n          self.selectElement(cellView.model);\r\n          //chon vao link thi mo cho phep doi node\r\n          cellView.addTools(this.toolsView);\r\n        },\r\n\r\n        //chuyển lại màu cũ khi bấm ra ngoài\r\n        \"blank:pointerclick\": () => {\r\n          self.selectElement(null);\r\n          paper.removeTools({ ignoreCommandManager: true });\r\n        },\r\n\r\n        \"element:pointerup\": function (cellView, evt) {\r\n          if (evt.ctrlKey || evt.metaKey) {\r\n            console.log(self.selection);\r\n            self.selection.collection.add(cellView.model);\r\n            //loop to all the element in selection and set it to front\r\n            self.selection.collection.models.forEach((element) => {\r\n              element.toFront({ ignoreCommandManager: true });\r\n            });\r\n          }\r\n        },\r\n        //chuyển màu khi bấm vào link và cho nó lên trc\r\n        \"link:pointerup\": function (cellView) {\r\n          self.selectedLink = cellView.model;\r\n          self.selectedLink.toFront({ ignoreCommandManager: true });\r\n        },\r\n\r\n        // lắng nghe sự kiện bấm ở ngoài khoange trống check shift để active select\r\n        \"blank:pointerdown\": function (evt, x, y) {\r\n          if (self.shiftDown === true) {\r\n            self.selectElement(null);\r\n\r\n            self.paperScroller.setCursor(\"crosshair\");\r\n            self.selection.startSelecting(evt);\r\n          } else {\r\n            self.selection.collection.reset([]);\r\n            self.paperScroller.startPanning(evt, x, y);\r\n            paper.removeTools();\r\n            self.paperScroller.setCursor(\"grab\");\r\n          }\r\n        },\r\n      });\r\n      var main = document.getElementById(\"main\");\r\n      main.addEventListener(\"scroll\", (evt) => {\r\n        if (view.scrollTop > 0) {\r\n          alert(\"up\");\r\n          console.log('up')\r\n        }\r\n        if (view.scrollTop <= 0) {\r\n          alert(\"down\");\r\n          console.log('down')\r\n        }\r\n      });\r\n      graph.on(\"add\", (cell, collection, opt) => {\r\n        let type = cell.attributes.type;\r\n        // console.log(type.split('.')[1])\r\n        if (type == \"standard.Link\") {\r\n          // self.addLinkTools(cell, paper);\r\n          // console.log(cell.attributes.source)\r\n          self.$emit(\"link-added\", {\r\n            source: cell.attributes.source,\r\n            target: cell.attributes.target,\r\n          });\r\n        } else {\r\n          type = type.split(\".\")[1];\r\n          self.$emit(\"node-added\", {\r\n            id: cell.id,\r\n            type: type,\r\n            prosition: cell.attributes.position,\r\n          });\r\n        }\r\n      });\r\n      graph.on(\"change:target\", function (link) {\r\n        if (link.get(\"target\").id) {\r\n          self.$emit(\"change-link-target\", { id: link.get(\"target\").id });\r\n        }\r\n      });\r\n      //xóa el nếu chọn lại lần 2 khi bấm ctrl\r\n      self.selection.on(\"selection-box:pointerdown\", function (cellView, evt) {\r\n        if (evt.ctrlKey || evt.metaKey) {\r\n          self.selection.collection.remove(cellView.model);\r\n        }\r\n      });\r\n      //kết hợp bấm ctrl để check các tổ hợp phím ctrl + C,V,Z,Y,A...\r\n      document.addEventListener(\"keydown\", function (evt) {\r\n        self.clipboard = new joint.ui.Clipboard();\r\n\r\n        if (evt.code === \"NumpadAdd\" && self.shiftDown === true) {\r\n          // console.log(evt.code)\r\n          self.paperScroller.zoom(0.2, { max: 4 });\r\n        }\r\n        if (evt.code === \"NumpadSubtract\" && self.shiftDown === true) {\r\n          self.paperScroller.zoom(-0.2, { min: 0.2 });\r\n          // console.log(evt.code)\r\n        }\r\n        //check+ A\r\n        if (evt.code === \"KeyA\" && self.ctrlDown === true) {\r\n          self.selection.collection.reset(graph.getElements());\r\n          evt.preventDefault();\r\n        } //check ctrl + Z\r\n        if (evt.code === \"KeyZ\" && self.ctrlDown === true) {\r\n          self.commandManager.undo();\r\n\r\n          if (self.selectionNode) {\r\n            self.unhighlightCell(self.selectionNode);\r\n            graph.getLinks().forEach((link) => self.unhighlightCell(link));\r\n\r\n            // console.log(selectionNode)\r\n            self.selectionNode = null;\r\n          }\r\n        }\r\n        //check ctrl + Y\r\n        if (evt.code === \"KeyY\" && self.ctrlDown === true) {\r\n          self.commandManager.redo();\r\n          self.selectElement(null);\r\n        }\r\n        //check ctrl + V ,ctrl + C, ctrl+X\r\n        if (evt.code === \"KeyX\" && self.ctrlDown === true) {\r\n          self.clipboard.cutElements(self.selection.collection, paper.model);\r\n        }\r\n        if (evt.code === \"KeyC\" && self.ctrlDown === true) {\r\n          self.clipboard.copyElements(self.selection.collection, graph);\r\n        }\r\n        if (evt.code === \"KeyV\" && self.ctrlDown === true) {\r\n          var pastedCells = self.clipboard.pasteCells(graph, {\r\n            translate: { dx: 40, dy: 40 },\r\n            useLocalStorage: true,\r\n          });\r\n\r\n          var elements = _.filter(pastedCells, function (cell) {\r\n            return cell.isElement();\r\n          });\r\n          // Make sure pasted elements get selected immediately. This makes the UX better as\r\n          // the user can immediately manipulate the pasted elements.\r\n          self.selection.collection.reset(elements);\r\n        }\r\n      });\r\n    },\r\n    btnHandler() {\r\n      let self = this;\r\n      $(\"#btn-zoomin\").on(\"click\", function () {\r\n        self.paperScroller.zoom(0.2, { max: 4 });\r\n      });\r\n      $(\"#btn-zoomout\").on(\"click\", function () {\r\n        self.paperScroller.zoom(-0.2, { min: 0.2 });\r\n      });\r\n      $(\"#btn-center\").on(\r\n        \"click\",\r\n        _.bind(self.paperScroller.center, self.paperScroller)\r\n      );\r\n      $(\"#btn-center-content\").on(\r\n        \"click\",\r\n        _.bind(self.paperScroller.centerContent, self.paperScroller)\r\n      );\r\n    },\r\n\r\n    getAllLinks() {\r\n      return this.graph.getLinks();\r\n    },\r\n    getAllNodes() {\r\n      return this.graph.getCells();\r\n    },\r\n    clearAll() {\r\n      return this.graph.clear();\r\n    },\r\n    getNodeAttr(id) {\r\n      let node = this.graph.getCell(id);\r\n      if (node) {\r\n        return node.attributes;\r\n      } else {\r\n        return {};\r\n      }\r\n    },\r\n    render() {\r\n      let nodeInfos = this.nodes;\r\n      let linkInfos = this.links;\r\n      nodeInfos.forEach((nodeInfo) => {\r\n        let nodeType = nodeInfo.type;\r\n        let elementName = this.jsUcfirst(nodeInfo.name);\r\n        //checknode\r\n        if (nodeType === \"Rectangle\") {\r\n          if (elementName === \"Load\") {\r\n            let cell = new this.customElNoInPorts({\r\n              position: nodeInfo.position,\r\n              id: nodeInfo.id,\r\n            });\r\n            cell.prop(\r\n              \"attrs/image/xlinkHref\",\r\n              require(`../assets/${elementName}.svg`)\r\n            );\r\n            this.graph.addCell(cell);\r\n            // console.log(cell)\r\n            // linkInfo.source=cell\r\n          } else {\r\n            let cell = new this.customEl({\r\n              position: nodeInfo.position,\r\n              id: nodeInfo.id,\r\n            });\r\n            cell.prop(\r\n              \"attrs/image/xlinkHref\",\r\n              require(`../assets/${elementName}.svg`)\r\n            );\r\n            this.graph.addCell(cell);\r\n            //   linkInfo.target=cell\r\n            // console.log(cell)\r\n          }\r\n        } else {\r\n          console.error(\"Node type '\" + nodeType + \"' is not defined\");\r\n        }\r\n      });\r\n\r\n      if (linkInfos) {\r\n        linkInfos.forEach((linkInfo) => {\r\n          let link = new joint.shapes.standard.Link({\r\n            attrs: {\r\n              z: 1,\r\n              line: {\r\n                connection: true,\r\n                stroke: \"#707070\",\r\n                strokeWidth: 3,\r\n                strokeLinejoin: \"round\",\r\n                targetMarker: {\r\n                  type: \"path\",\r\n\r\n                  d: \"M 10 -5 0 0 10 5 Z\",\r\n                },\r\n              },\r\n              wrapper: {\r\n                connection: true,\r\n                strokeWidth: 6,\r\n                strokeLinejoin: \"round\",\r\n              },\r\n            },\r\n\r\n            markup: [\r\n              {\r\n                tagName: \"path\",\r\n                selector: \"wrapper\",\r\n                attributes: {\r\n                  fill: \"none\",\r\n\r\n                  stroke: \"transparent\",\r\n                },\r\n              },\r\n              {\r\n                tagName: \"path\",\r\n                selector: \"line\",\r\n                attributes: {\r\n                  fill: \"none\",\r\n                },\r\n              },\r\n            ],\r\n          });\r\n\r\n          link.source(this.getNodeAttr(linkInfo.source));\r\n          link.target(this.getNodeAttr(linkInfo.target));\r\n          link.addTo(this.graph);\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.joint-element .selection {\r\n  stroke: rgb(255 136 0);\r\n}\r\n.joint-link .selection {\r\n  stroke: rgb(255 136 0);\r\n  /* fill: rgb(255 136 0); */\r\n}\r\n/* .joint-paper-scroller.joint-theme-default {\r\n  width: 800px !important;\r\n  height: 600px;\r\n}\r\n.joint-toolbar.joint-theme-default {\r\n  width: 800px !important;\r\n} */\r\n.joint-halo.joint-theme-default.toolbar.type-element .handle.remove {\r\n  position: relative !important;\r\n  right: 0 !important;\r\n}\r\n.joint-halo.joint-theme-default.toolbar .handles:after {\r\n  left: 12px !important;\r\n}\r\n.joint-halo.joint-theme-default.toolbar .handles {\r\n  margin-left: 5px !important;\r\n}\r\n.joint-paper-background,\r\n.joint-paper-grid,\r\n.joint-paper > svg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n}\r\n.joint-selection.joint-theme-material .handle.remove {\r\n  position: static;\r\n  display: inline-block;\r\n  vertical-align: top;\r\n  white-space: nowrap;\r\n  background-color: #fff;\r\n  border: 1px solid #d3d3d3;\r\n  border-bottom: 4px solid #000;\r\n  width: 20px;\r\n  margin-top: -50px;\r\n  margin-left: 54px;\r\n}\r\ndiv.handle.nw.remove:before {\r\n  content: \"\";\r\n\r\n  position: absolute;\r\n  vertical-align: top;\r\n\r\n  margin-top: 22px;\r\n\r\n  border-top: 6px solid #000;\r\n  border-right: 10px solid transparent;\r\n  border-left: 8px solid transparent;\r\n  /* width: 2px; */\r\n}\r\n\r\n.joint-selection.joint-theme-material .handle.remove:after {\r\n  /* font-family: selection-icons-dark;\r\n  font-style: normal;\r\n  font-weight: 400;\r\n  speak: none;\r\n  display: inline-block;\r\n  text-decoration: inherit;\r\n  margin: auto;\r\n  text-align: center;\r\n  font-variant: normal;\r\n  text-transform: none;\r\n  font-size: 18px;\r\n  color: #5faaee; */\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}