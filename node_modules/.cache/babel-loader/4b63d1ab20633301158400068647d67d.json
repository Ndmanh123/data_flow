{"ast":null,"code":"require(\"core-js/modules/es.error.cause.js\");require(\"core-js/modules/es.array.includes.js\");require(\"core-js/modules/es.typed-array.at.js\");require(\"core-js/modules/es.typed-array.set.js\");require(\"core-js/modules/web.dom-exception.stack.js\");require(\"core-js/modules/es.array.at.js\");require(\"core-js/modules/es.string.at-alternative.js\");/*! JointJS v3.5.5 (2022-04-08) - JavaScript diagramming library\n\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports,require('backbone'),require('lodash'),require('jquery')):typeof define==='function'&&define.amd?define(['exports','backbone','lodash','jquery'],factory):(global=global||self,factory(global.joint={},global.Backbone,global._,global.$));})(this,function(exports,Backbone,_,$){'use strict';Backbone=Backbone&&Backbone.hasOwnProperty('default')?Backbone['default']:Backbone;_=_&&_.hasOwnProperty('default')?_['default']:_;$=$&&$.hasOwnProperty('default')?$['default']:$;var commonjsGlobal=typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{};function commonjsRequire(){throw new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');}function unwrapExports(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,'default')?x.default:x;}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports;}function getCjsExportFromNamespace(n){return n&&n.default||n;}var check=function(it){return it&&it.Math==Math&&it;};// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global_1=// eslint-disable-next-line no-undef\ncheck(typeof globalThis=='object'&&globalThis)||check(typeof window=='object'&&window)||check(typeof self=='object'&&self)||check(typeof commonjsGlobal=='object'&&commonjsGlobal)||// eslint-disable-next-line no-new-func\nfunction(){return this;}()||Function('return this')();var fails=function(exec){try{return!!exec();}catch(error){return true;}};// Detect IE8's incomplete defineProperty implementation\nvar descriptors=!fails(function(){return Object.defineProperty({},1,{get:function(){return 7;}})[1]!=7;});'use strict';var nativePropertyIsEnumerable={}.propertyIsEnumerable;var getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;// Nashorn ~ JDK8 bug\nvar NASHORN_BUG=getOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1);// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nvar f=NASHORN_BUG?function propertyIsEnumerable(V){var descriptor=getOwnPropertyDescriptor(this,V);return!!descriptor&&descriptor.enumerable;}:nativePropertyIsEnumerable;var objectPropertyIsEnumerable={f:f};var createPropertyDescriptor=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value};};var toString={}.toString;var classofRaw=function(it){return toString.call(it).slice(8,-1);};var split=''.split;// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar indexedObject=fails(function(){// throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n// eslint-disable-next-line no-prototype-builtins\nreturn!Object('z').propertyIsEnumerable(0);})?function(it){return classofRaw(it)=='String'?split.call(it,''):Object(it);}:Object;// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nvar requireObjectCoercible=function(it){if(it==undefined){throw TypeError(\"Can't call method on \"+it);}return it;};// toObject with fallback for non-array-like ES3 strings\nvar toIndexedObject=function(it){return indexedObject(requireObjectCoercible(it));};var isObject=function(it){return typeof it==='object'?it!==null:typeof it==='function';};// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nvar toPrimitive=function(input,PREFERRED_STRING){if(!isObject(input)){return input;}var fn,val;if(PREFERRED_STRING&&typeof(fn=input.toString)=='function'&&!isObject(val=fn.call(input))){return val;}if(typeof(fn=input.valueOf)=='function'&&!isObject(val=fn.call(input))){return val;}if(!PREFERRED_STRING&&typeof(fn=input.toString)=='function'&&!isObject(val=fn.call(input))){return val;}throw TypeError(\"Can't convert object to primitive value\");};var hasOwnProperty={}.hasOwnProperty;var has=function(it,key){return hasOwnProperty.call(it,key);};var document$1=global_1.document;// typeof document.createElement is 'object' in old IE\nvar EXISTS=isObject(document$1)&&isObject(document$1.createElement);var documentCreateElement=function(it){return EXISTS?document$1.createElement(it):{};};// Thank's IE8 for his funny defineProperty\nvar ie8DomDefine=!descriptors&&!fails(function(){return Object.defineProperty(documentCreateElement('div'),'a',{get:function(){return 7;}}).a!=7;});var nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nvar f$1=descriptors?nativeGetOwnPropertyDescriptor:function getOwnPropertyDescriptor(O,P){O=toIndexedObject(O);P=toPrimitive(P,true);if(ie8DomDefine){try{return nativeGetOwnPropertyDescriptor(O,P);}catch(error){/* empty */}}if(has(O,P)){return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(O,P),O[P]);}};var objectGetOwnPropertyDescriptor={f:f$1};var anObject=function(it){if(!isObject(it)){throw TypeError(String(it)+' is not an object');}return it;};var nativeDefineProperty=Object.defineProperty;// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nvar f$2=descriptors?nativeDefineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(ie8DomDefine){try{return nativeDefineProperty(O,P,Attributes);}catch(error){/* empty */}}if('get'in Attributes||'set'in Attributes){throw TypeError('Accessors not supported');}if('value'in Attributes){O[P]=Attributes.value;}return O;};var objectDefineProperty={f:f$2};var createNonEnumerableProperty=descriptors?function(object,key,value){return objectDefineProperty.f(object,key,createPropertyDescriptor(1,value));}:function(object,key,value){object[key]=value;return object;};var setGlobal=function(key,value){try{createNonEnumerableProperty(global_1,key,value);}catch(error){global_1[key]=value;}return value;};var SHARED='__core-js_shared__';var store=global_1[SHARED]||setGlobal(SHARED,{});var sharedStore=store;var functionToString=Function.toString;// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\nif(typeof sharedStore.inspectSource!='function'){sharedStore.inspectSource=function(it){return functionToString.call(it);};}var inspectSource=sharedStore.inspectSource;var WeakMap=global_1.WeakMap;var nativeWeakMap=typeof WeakMap==='function'&&/native code/.test(inspectSource(WeakMap));var isPure=false;var shared=createCommonjsModule(function(module){(module.exports=function(key,value){return sharedStore[key]||(sharedStore[key]=value!==undefined?value:{});})('versions',[]).push({version:'3.8.3',mode:isPure?'pure':'global',copyright:'Â© 2021 Denis Pushkarev (zloirock.ru)'});});var id=0;var postfix=Math.random();var uid=function(key){return'Symbol('+String(key===undefined?'':key)+')_'+(++id+postfix).toString(36);};var keys=shared('keys');var sharedKey=function(key){return keys[key]||(keys[key]=uid(key));};var hiddenKeys={};var WeakMap$1=global_1.WeakMap;var set,get,has$1;var enforce=function(it){return has$1(it)?get(it):set(it,{});};var getterFor=function(TYPE){return function(it){var state;if(!isObject(it)||(state=get(it)).type!==TYPE){throw TypeError('Incompatible receiver, '+TYPE+' required');}return state;};};if(nativeWeakMap){var store$1=sharedStore.state||(sharedStore.state=new WeakMap$1());var wmget=store$1.get;var wmhas=store$1.has;var wmset=store$1.set;set=function(it,metadata){metadata.facade=it;wmset.call(store$1,it,metadata);return metadata;};get=function(it){return wmget.call(store$1,it)||{};};has$1=function(it){return wmhas.call(store$1,it);};}else{var STATE=sharedKey('state');hiddenKeys[STATE]=true;set=function(it,metadata){metadata.facade=it;createNonEnumerableProperty(it,STATE,metadata);return metadata;};get=function(it){return has(it,STATE)?it[STATE]:{};};has$1=function(it){return has(it,STATE);};}var internalState={set:set,get:get,has:has$1,enforce:enforce,getterFor:getterFor};var internalState_1=internalState.set;var internalState_2=internalState.get;var internalState_3=internalState.has;var internalState_4=internalState.enforce;var internalState_5=internalState.getterFor;var redefine=createCommonjsModule(function(module){var getInternalState=internalState.get;var enforceInternalState=internalState.enforce;var TEMPLATE=String(String).split('String');(module.exports=function(O,key,value,options){var unsafe=options?!!options.unsafe:false;var simple=options?!!options.enumerable:false;var noTargetGet=options?!!options.noTargetGet:false;var state;if(typeof value=='function'){if(typeof key=='string'&&!has(value,'name')){createNonEnumerableProperty(value,'name',key);}state=enforceInternalState(value);if(!state.source){state.source=TEMPLATE.join(typeof key=='string'?key:'');}}if(O===global_1){if(simple){O[key]=value;}else{setGlobal(key,value);}return;}else if(!unsafe){delete O[key];}else if(!noTargetGet&&O[key]){simple=true;}if(simple){O[key]=value;}else{createNonEnumerableProperty(O,key,value);}// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype,'toString',function toString(){return typeof this=='function'&&getInternalState(this).source||inspectSource(this);});});var path=global_1;var aFunction=function(variable){return typeof variable=='function'?variable:undefined;};var getBuiltIn=function(namespace,method){return arguments.length<2?aFunction(path[namespace])||aFunction(global_1[namespace]):path[namespace]&&path[namespace][method]||global_1[namespace]&&global_1[namespace][method];};var ceil=Math.ceil;var floor=Math.floor;// `ToInteger` abstract operation\n// https://tc39.es/ecma262/#sec-tointeger\nvar toInteger=function(argument){return isNaN(argument=+argument)?0:(argument>0?floor:ceil)(argument);};var min=Math.min;// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nvar toLength=function(argument){return argument>0?min(toInteger(argument),0x1FFFFFFFFFFFFF):0;// 2 ** 53 - 1 == 9007199254740991\n};var max=Math.max;var min$1=Math.min;// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nvar toAbsoluteIndex=function(index,length){var integer=toInteger(index);return integer<0?max(integer+length,0):min$1(integer,length);};// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIndexedObject($this);var length=toLength(O.length);var index=toAbsoluteIndex(fromIndex,length);var value;// Array#includes uses SameValueZero equality algorithm\n// eslint-disable-next-line no-self-compare\nif(IS_INCLUDES&&el!=el){while(length>index){value=O[index++];// eslint-disable-next-line no-self-compare\nif(value!=value){return true;}// Array#indexOf ignores holes, Array#includes - not\n}}else{for(;length>index;index++){if((IS_INCLUDES||index in O)&&O[index]===el){return IS_INCLUDES||index||0;}}}return!IS_INCLUDES&&-1;};};var arrayIncludes={// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\nincludes:createMethod(true),// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\nindexOf:createMethod(false)};var arrayIncludes_1=arrayIncludes.includes;var arrayIncludes_2=arrayIncludes.indexOf;var indexOf=arrayIncludes.indexOf;var objectKeysInternal=function(object,names){var O=toIndexedObject(object);var i=0;var result=[];var key;for(key in O){!has(hiddenKeys,key)&&has(O,key)&&result.push(key);}// Don't enum bug & hidden keys\nwhile(names.length>i){if(has(O,key=names[i++])){~indexOf(result,key)||result.push(key);}}return result;};// IE8- don't enum bug keys\nvar enumBugKeys=['constructor','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','toLocaleString','toString','valueOf'];var hiddenKeys$1=enumBugKeys.concat('length','prototype');// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\nvar f$3=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return objectKeysInternal(O,hiddenKeys$1);};var objectGetOwnPropertyNames={f:f$3};var f$4=Object.getOwnPropertySymbols;var objectGetOwnPropertySymbols={f:f$4};// all object keys, includes non-enumerable and symbols\nvar ownKeys=getBuiltIn('Reflect','ownKeys')||function ownKeys(it){var keys=objectGetOwnPropertyNames.f(anObject(it));var getOwnPropertySymbols=objectGetOwnPropertySymbols.f;return getOwnPropertySymbols?keys.concat(getOwnPropertySymbols(it)):keys;};var copyConstructorProperties=function(target,source){var keys=ownKeys(source);var defineProperty=objectDefineProperty.f;var getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f;for(var i=0;i<keys.length;i++){var key=keys[i];if(!has(target,key)){defineProperty(target,key,getOwnPropertyDescriptor(source,key));}}};var replacement=/#|\\.prototype\\./;var isForced=function(feature,detection){var value=data[normalize(feature)];return value==POLYFILL?true:value==NATIVE?false:typeof detection=='function'?fails(detection):!!detection;};var normalize=isForced.normalize=function(string){return String(string).replace(replacement,'.').toLowerCase();};var data=isForced.data={};var NATIVE=isForced.NATIVE='N';var POLYFILL=isForced.POLYFILL='P';var isForced_1=isForced;var getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f;/*\n\t  options.target      - name of the target object\n\t  options.global      - target is the global object\n\t  options.stat        - export as static methods of target\n\t  options.proto       - export as prototype methods of target\n\t  options.real        - real prototype method for the `pure` version\n\t  options.forced      - export even if the native feature is available\n\t  options.bind        - bind methods to the target, required for the `pure` version\n\t  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n\t  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n\t  options.sham        - add a flag to not completely full polyfills\n\t  options.enumerable  - export as enumerable property\n\t  options.noTargetGet - prevent calling a getter on target\n\t*/var _export=function(options,source){var TARGET=options.target;var GLOBAL=options.global;var STATIC=options.stat;var FORCED,target,key,targetProperty,sourceProperty,descriptor;if(GLOBAL){target=global_1;}else if(STATIC){target=global_1[TARGET]||setGlobal(TARGET,{});}else{target=(global_1[TARGET]||{}).prototype;}if(target){for(key in source){sourceProperty=source[key];if(options.noTargetGet){descriptor=getOwnPropertyDescriptor$1(target,key);targetProperty=descriptor&&descriptor.value;}else{targetProperty=target[key];}FORCED=isForced_1(GLOBAL?key:TARGET+(STATIC?'.':'#')+key,options.forced);// contained in target\nif(!FORCED&&targetProperty!==undefined){if(typeof sourceProperty===typeof targetProperty){continue;}copyConstructorProperties(sourceProperty,targetProperty);}// add a flag to not completely full polyfills\nif(options.sham||targetProperty&&targetProperty.sham){createNonEnumerableProperty(sourceProperty,'sham',true);}// extend global\nredefine(target,key,sourceProperty,options);}}};var nativeSymbol=!!Object.getOwnPropertySymbols&&!fails(function(){// Chrome 38 Symbol has incorrect toString conversion\n// eslint-disable-next-line no-undef\nreturn!String(Symbol());});var useSymbolAsUid=nativeSymbol// eslint-disable-next-line no-undef\n&&!Symbol.sham// eslint-disable-next-line no-undef\n&&typeof Symbol.iterator=='symbol';var WellKnownSymbolsStore=shared('wks');var Symbol$1=global_1.Symbol;var createWellKnownSymbol=useSymbolAsUid?Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid;var wellKnownSymbol=function(name){if(!has(WellKnownSymbolsStore,name)){if(nativeSymbol&&has(Symbol$1,name)){WellKnownSymbolsStore[name]=Symbol$1[name];}else{WellKnownSymbolsStore[name]=createWellKnownSymbol('Symbol.'+name);}}return WellKnownSymbolsStore[name];};// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\nvar objectKeys=Object.keys||function keys(O){return objectKeysInternal(O,enumBugKeys);};// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\nvar objectDefineProperties=descriptors?Object.defineProperties:function defineProperties(O,Properties){anObject(O);var keys=objectKeys(Properties);var length=keys.length;var index=0;var key;while(length>index){objectDefineProperty.f(O,key=keys[index++],Properties[key]);}return O;};var html=getBuiltIn('document','documentElement');var GT='>';var LT='<';var PROTOTYPE='prototype';var SCRIPT='script';var IE_PROTO=sharedKey('IE_PROTO');var EmptyConstructor=function(){/* empty */};var scriptTag=function(content){return LT+SCRIPT+GT+content+LT+'/'+SCRIPT+GT;};// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX=function(activeXDocument){activeXDocument.write(scriptTag(''));activeXDocument.close();var temp=activeXDocument.parentWindow.Object;activeXDocument=null;// avoid memory leak\nreturn temp;};// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame=function(){// Thrash, waste and sodomy: IE GC bug\nvar iframe=documentCreateElement('iframe');var JS='java'+SCRIPT+':';var iframeDocument;iframe.style.display='none';html.appendChild(iframe);// https://github.com/zloirock/core-js/issues/475\niframe.src=String(JS);iframeDocument=iframe.contentWindow.document;iframeDocument.open();iframeDocument.write(scriptTag('document.F=Object'));iframeDocument.close();return iframeDocument.F;};// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;var NullProtoObject=function(){try{/* global ActiveXObject */activeXDocument=document.domain&&new ActiveXObject('htmlfile');}catch(error){/* ignore */}NullProtoObject=activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame();var length=enumBugKeys.length;while(length--){delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];}return NullProtoObject();};hiddenKeys[IE_PROTO]=true;// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nvar objectCreate=Object.create||function create(O,Properties){var result;if(O!==null){EmptyConstructor[PROTOTYPE]=anObject(O);result=new EmptyConstructor();EmptyConstructor[PROTOTYPE]=null;// add \"__proto__\" for Object.getPrototypeOf polyfill\nresult[IE_PROTO]=O;}else{result=NullProtoObject();}return Properties===undefined?result:objectDefineProperties(result,Properties);};var UNSCOPABLES=wellKnownSymbol('unscopables');var ArrayPrototype=Array.prototype;// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif(ArrayPrototype[UNSCOPABLES]==undefined){objectDefineProperty.f(ArrayPrototype,UNSCOPABLES,{configurable:true,value:objectCreate(null)});}// add a key to Array.prototype[@@unscopables]\nvar addToUnscopables=function(key){ArrayPrototype[UNSCOPABLES][key]=true;};var defineProperty=Object.defineProperty;var cache={};var thrower=function(it){throw it;};var arrayMethodUsesToLength=function(METHOD_NAME,options){if(has(cache,METHOD_NAME)){return cache[METHOD_NAME];}if(!options){options={};}var method=[][METHOD_NAME];var ACCESSORS=has(options,'ACCESSORS')?options.ACCESSORS:false;var argument0=has(options,0)?options[0]:thrower;var argument1=has(options,1)?options[1]:undefined;return cache[METHOD_NAME]=!!method&&!fails(function(){if(ACCESSORS&&!descriptors){return true;}var O={length:-1};if(ACCESSORS){defineProperty(O,1,{enumerable:true,get:thrower});}else{O[1]=1;}method.call(O,argument0,argument1);});};'use strict';var $includes=arrayIncludes.includes;var USES_TO_LENGTH=arrayMethodUsesToLength('indexOf',{ACCESSORS:true,1:0});// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\n_export({target:'Array',proto:true,forced:!USES_TO_LENGTH},{includes:function includes(el/* , fromIndex = 0 */){return $includes(this,el,arguments.length>1?arguments[1]:undefined);}});// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');var es_array_includes={};var aFunction$1=function(it){if(typeof it!='function'){throw TypeError(String(it)+' is not a function');}return it;};// optional / simple context binding\nvar functionBindContext=function(fn,that,length){aFunction$1(fn);if(that===undefined){return fn;}switch(length){case 0:return function(){return fn.call(that);};case 1:return function(a){return fn.call(that,a);};case 2:return function(a,b){return fn.call(that,a,b);};case 3:return function(a,b,c){return fn.call(that,a,b,c);};}return function/* ...args */(){return fn.apply(that,arguments);};};var call=Function.call;var entryUnbind=function(CONSTRUCTOR,METHOD,length){return functionBindContext(call,global_1[CONSTRUCTOR].prototype[METHOD],length);};var includes=entryUnbind('Array','includes');var includes$1=includes;// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nvar toObject=function(argument){return Object(requireObjectCoercible(argument));};// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\nvar isArray=Array.isArray||function isArray(arg){return classofRaw(arg)=='Array';};var SPECIES=wellKnownSymbol('species');// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nvar arraySpeciesCreate=function(originalArray,length){var C;if(isArray(originalArray)){C=originalArray.constructor;// cross-realm fallback\nif(typeof C=='function'&&(C===Array||isArray(C.prototype))){C=undefined;}else if(isObject(C)){C=C[SPECIES];if(C===null){C=undefined;}}}return new(C===undefined?Array:C)(length===0?0:length);};var push=[].push;// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterOut }` methods implementation\nvar createMethod$1=function(TYPE){var IS_MAP=TYPE==1;var IS_FILTER=TYPE==2;var IS_SOME=TYPE==3;var IS_EVERY=TYPE==4;var IS_FIND_INDEX=TYPE==6;var IS_FILTER_OUT=TYPE==7;var NO_HOLES=TYPE==5||IS_FIND_INDEX;return function($this,callbackfn,that,specificCreate){var O=toObject($this);var self=indexedObject(O);var boundFunction=functionBindContext(callbackfn,that,3);var length=toLength(self.length);var index=0;var create=specificCreate||arraySpeciesCreate;var target=IS_MAP?create($this,length):IS_FILTER||IS_FILTER_OUT?create($this,0):undefined;var value,result;for(;length>index;index++){if(NO_HOLES||index in self){value=self[index];result=boundFunction(value,index,O);if(TYPE){if(IS_MAP){target[index]=result;}// map\nelse if(result){switch(TYPE){case 3:return true;// some\ncase 5:return value;// find\ncase 6:return index;// findIndex\ncase 2:push.call(target,value);// filter\n}}else{switch(TYPE){case 4:return false;// every\ncase 7:push.call(target,value);// filterOut\n}}}}}return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:target;};};var arrayIteration={// `Array.prototype.forEach` method\n// https://tc39.es/ecma262/#sec-array.prototype.foreach\nforEach:createMethod$1(0),// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\nmap:createMethod$1(1),// `Array.prototype.filter` method\n// https://tc39.es/ecma262/#sec-array.prototype.filter\nfilter:createMethod$1(2),// `Array.prototype.some` method\n// https://tc39.es/ecma262/#sec-array.prototype.some\nsome:createMethod$1(3),// `Array.prototype.every` method\n// https://tc39.es/ecma262/#sec-array.prototype.every\nevery:createMethod$1(4),// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\nfind:createMethod$1(5),// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findIndex\nfindIndex:createMethod$1(6),// `Array.prototype.filterOut` method\n// https://github.com/tc39/proposal-array-filtering\nfilterOut:createMethod$1(7)};var arrayIteration_1=arrayIteration.forEach;var arrayIteration_2=arrayIteration.map;var arrayIteration_3=arrayIteration.filter;var arrayIteration_4=arrayIteration.some;var arrayIteration_5=arrayIteration.every;var arrayIteration_6=arrayIteration.find;var arrayIteration_7=arrayIteration.findIndex;var arrayIteration_8=arrayIteration.filterOut;'use strict';var $find=arrayIteration.find;var FIND='find';var SKIPS_HOLES=true;var USES_TO_LENGTH$1=arrayMethodUsesToLength(FIND);// Shouldn't skip holes\nif(FIND in[]){Array(1)[FIND](function(){SKIPS_HOLES=false;});}// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n_export({target:'Array',proto:true,forced:SKIPS_HOLES||!USES_TO_LENGTH$1},{find:function find(callbackfn/* , that = undefined */){return $find(this,callbackfn,arguments.length>1?arguments[1]:undefined);}});// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);var es_array_find={};var find=entryUnbind('Array','find');var find$1=find;// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod$2=function(CONVERT_TO_STRING){return function($this,pos){var S=String(requireObjectCoercible($this));var position=toInteger(pos);var size=S.length;var first,second;if(position<0||position>=size){return CONVERT_TO_STRING?'':undefined;}first=S.charCodeAt(position);return first<0xD800||first>0xDBFF||position+1===size||(second=S.charCodeAt(position+1))<0xDC00||second>0xDFFF?CONVERT_TO_STRING?S.charAt(position):first:CONVERT_TO_STRING?S.slice(position,position+2):(first-0xD800<<10)+(second-0xDC00)+0x10000;};};var stringMultibyte={// `String.prototype.codePointAt` method\n// https://tc39.es/ecma262/#sec-string.prototype.codepointat\ncodeAt:createMethod$2(false),// `String.prototype.at` method\n// https://github.com/mathiasbynens/String.prototype.at\ncharAt:createMethod$2(true)};var stringMultibyte_1=stringMultibyte.codeAt;var stringMultibyte_2=stringMultibyte.charAt;var correctPrototypeGetter=!fails(function(){function F(){/* empty */}F.prototype.constructor=null;return Object.getPrototypeOf(new F())!==F.prototype;});var IE_PROTO$1=sharedKey('IE_PROTO');var ObjectPrototype=Object.prototype;// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\nvar objectGetPrototypeOf=correctPrototypeGetter?Object.getPrototypeOf:function(O){O=toObject(O);if(has(O,IE_PROTO$1)){return O[IE_PROTO$1];}if(typeof O.constructor=='function'&&O instanceof O.constructor){return O.constructor.prototype;}return O instanceof Object?ObjectPrototype:null;};'use strict';var ITERATOR=wellKnownSymbol('iterator');var BUGGY_SAFARI_ITERATORS=false;var returnThis=function(){return this;};// `%IteratorPrototype%` object\n// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\nvar IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;if([].keys){arrayIterator=[].keys();// Safari 8 has buggy iterators w/o `next`\nif(!('next'in arrayIterator)){BUGGY_SAFARI_ITERATORS=true;}else{PrototypeOfArrayIteratorPrototype=objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator));if(PrototypeOfArrayIteratorPrototype!==Object.prototype){IteratorPrototype=PrototypeOfArrayIteratorPrototype;}}}var NEW_ITERATOR_PROTOTYPE=IteratorPrototype==undefined||fails(function(){var test={};// FF44- legacy iterators case\nreturn IteratorPrototype[ITERATOR].call(test)!==test;});if(NEW_ITERATOR_PROTOTYPE){IteratorPrototype={};}// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nif((!isPure||NEW_ITERATOR_PROTOTYPE)&&!has(IteratorPrototype,ITERATOR)){createNonEnumerableProperty(IteratorPrototype,ITERATOR,returnThis);}var iteratorsCore={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS};var iteratorsCore_1=iteratorsCore.IteratorPrototype;var iteratorsCore_2=iteratorsCore.BUGGY_SAFARI_ITERATORS;var defineProperty$1=objectDefineProperty.f;var TO_STRING_TAG=wellKnownSymbol('toStringTag');var setToStringTag=function(it,TAG,STATIC){if(it&&!has(it=STATIC?it:it.prototype,TO_STRING_TAG)){defineProperty$1(it,TO_STRING_TAG,{configurable:true,value:TAG});}};var iterators={};'use strict';var IteratorPrototype$1=iteratorsCore.IteratorPrototype;var returnThis$1=function(){return this;};var createIteratorConstructor=function(IteratorConstructor,NAME,next){var TO_STRING_TAG=NAME+' Iterator';IteratorConstructor.prototype=objectCreate(IteratorPrototype$1,{next:createPropertyDescriptor(1,next)});setToStringTag(IteratorConstructor,TO_STRING_TAG,false,true);iterators[TO_STRING_TAG]=returnThis$1;return IteratorConstructor;};var aPossiblePrototype=function(it){if(!isObject(it)&&it!==null){throw TypeError(\"Can't set \"+String(it)+' as a prototype');}return it;};// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */var objectSetPrototypeOf=Object.setPrototypeOf||('__proto__'in{}?function(){var CORRECT_SETTER=false;var test={};var setter;try{setter=Object.getOwnPropertyDescriptor(Object.prototype,'__proto__').set;setter.call(test,[]);CORRECT_SETTER=test instanceof Array;}catch(error){/* empty */}return function setPrototypeOf(O,proto){anObject(O);aPossiblePrototype(proto);if(CORRECT_SETTER){setter.call(O,proto);}else{O.__proto__=proto;}return O;};}():undefined);'use strict';var IteratorPrototype$2=iteratorsCore.IteratorPrototype;var BUGGY_SAFARI_ITERATORS$1=iteratorsCore.BUGGY_SAFARI_ITERATORS;var ITERATOR$1=wellKnownSymbol('iterator');var KEYS='keys';var VALUES='values';var ENTRIES='entries';var returnThis$2=function(){return this;};var defineIterator=function(Iterable,NAME,IteratorConstructor,next,DEFAULT,IS_SET,FORCED){createIteratorConstructor(IteratorConstructor,NAME,next);var getIterationMethod=function(KIND){if(KIND===DEFAULT&&defaultIterator){return defaultIterator;}if(!BUGGY_SAFARI_ITERATORS$1&&KIND in IterablePrototype){return IterablePrototype[KIND];}switch(KIND){case KEYS:return function keys(){return new IteratorConstructor(this,KIND);};case VALUES:return function values(){return new IteratorConstructor(this,KIND);};case ENTRIES:return function entries(){return new IteratorConstructor(this,KIND);};}return function(){return new IteratorConstructor(this);};};var TO_STRING_TAG=NAME+' Iterator';var INCORRECT_VALUES_NAME=false;var IterablePrototype=Iterable.prototype;var nativeIterator=IterablePrototype[ITERATOR$1]||IterablePrototype['@@iterator']||DEFAULT&&IterablePrototype[DEFAULT];var defaultIterator=!BUGGY_SAFARI_ITERATORS$1&&nativeIterator||getIterationMethod(DEFAULT);var anyNativeIterator=NAME=='Array'?IterablePrototype.entries||nativeIterator:nativeIterator;var CurrentIteratorPrototype,methods,KEY;// fix native\nif(anyNativeIterator){CurrentIteratorPrototype=objectGetPrototypeOf(anyNativeIterator.call(new Iterable()));if(IteratorPrototype$2!==Object.prototype&&CurrentIteratorPrototype.next){if(!isPure&&objectGetPrototypeOf(CurrentIteratorPrototype)!==IteratorPrototype$2){if(objectSetPrototypeOf){objectSetPrototypeOf(CurrentIteratorPrototype,IteratorPrototype$2);}else if(typeof CurrentIteratorPrototype[ITERATOR$1]!='function'){createNonEnumerableProperty(CurrentIteratorPrototype,ITERATOR$1,returnThis$2);}}// Set @@toStringTag to native iterators\nsetToStringTag(CurrentIteratorPrototype,TO_STRING_TAG,true,true);if(isPure){iterators[TO_STRING_TAG]=returnThis$2;}}}// fix Array#{values, @@iterator}.name in V8 / FF\nif(DEFAULT==VALUES&&nativeIterator&&nativeIterator.name!==VALUES){INCORRECT_VALUES_NAME=true;defaultIterator=function values(){return nativeIterator.call(this);};}// define iterator\nif((!isPure||FORCED)&&IterablePrototype[ITERATOR$1]!==defaultIterator){createNonEnumerableProperty(IterablePrototype,ITERATOR$1,defaultIterator);}iterators[NAME]=defaultIterator;// export additional methods\nif(DEFAULT){methods={values:getIterationMethod(VALUES),keys:IS_SET?defaultIterator:getIterationMethod(KEYS),entries:getIterationMethod(ENTRIES)};if(FORCED){for(KEY in methods){if(BUGGY_SAFARI_ITERATORS$1||INCORRECT_VALUES_NAME||!(KEY in IterablePrototype)){redefine(IterablePrototype,KEY,methods[KEY]);}}}else{_export({target:NAME,proto:true,forced:BUGGY_SAFARI_ITERATORS$1||INCORRECT_VALUES_NAME},methods);}}return methods;};'use strict';var charAt=stringMultibyte.charAt;var STRING_ITERATOR='String Iterator';var setInternalState=internalState.set;var getInternalState=internalState.getterFor(STRING_ITERATOR);// `String.prototype[@@iterator]` method\n// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String,'String',function(iterated){setInternalState(this,{type:STRING_ITERATOR,string:String(iterated),index:0});// `%StringIteratorPrototype%.next` method\n// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n},function next(){var state=getInternalState(this);var string=state.string;var index=state.index;var point;if(index>=string.length){return{value:undefined,done:true};}point=charAt(string,index);state.index+=point.length;return{value:point,done:false};});var es_string_iterator={};var iteratorClose=function(iterator){var returnMethod=iterator['return'];if(returnMethod!==undefined){return anObject(returnMethod.call(iterator)).value;}};// call something on iterator step with safe closing on error\nvar callWithSafeIterationClosing=function(iterator,fn,value,ENTRIES){try{return ENTRIES?fn(anObject(value)[0],value[1]):fn(value);// 7.4.6 IteratorClose(iterator, completion)\n}catch(error){iteratorClose(iterator);throw error;}};var ITERATOR$2=wellKnownSymbol('iterator');var ArrayPrototype$1=Array.prototype;// check on default Array iterator\nvar isArrayIteratorMethod=function(it){return it!==undefined&&(iterators.Array===it||ArrayPrototype$1[ITERATOR$2]===it);};'use strict';var createProperty=function(object,key,value){var propertyKey=toPrimitive(key);if(propertyKey in object){objectDefineProperty.f(object,propertyKey,createPropertyDescriptor(0,value));}else{object[propertyKey]=value;}};var TO_STRING_TAG$1=wellKnownSymbol('toStringTag');var test={};test[TO_STRING_TAG$1]='z';var toStringTagSupport=String(test)==='[object z]';var TO_STRING_TAG$2=wellKnownSymbol('toStringTag');// ES3 wrong here\nvar CORRECT_ARGUMENTS=classofRaw(function(){return arguments;}())=='Arguments';// fallback for IE11 Script Access Denied error\nvar tryGet=function(it,key){try{return it[key];}catch(error){/* empty */}};// getting tag from ES6+ `Object.prototype.toString`\nvar classof=toStringTagSupport?classofRaw:function(it){var O,tag,result;return it===undefined?'Undefined':it===null?'Null'// @@toStringTag case\n:typeof(tag=tryGet(O=Object(it),TO_STRING_TAG$2))=='string'?tag// builtinTag case\n:CORRECT_ARGUMENTS?classofRaw(O)// ES3 arguments fallback\n:(result=classofRaw(O))=='Object'&&typeof O.callee=='function'?'Arguments':result;};var ITERATOR$3=wellKnownSymbol('iterator');var getIteratorMethod=function(it){if(it!=undefined){return it[ITERATOR$3]||it['@@iterator']||iterators[classof(it)];}};'use strict';// `Array.from` method implementation\n// https://tc39.es/ecma262/#sec-array.from\nvar arrayFrom=function from(arrayLike/* , mapfn = undefined, thisArg = undefined */){var O=toObject(arrayLike);var C=typeof this=='function'?this:Array;var argumentsLength=arguments.length;var mapfn=argumentsLength>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var iteratorMethod=getIteratorMethod(O);var index=0;var length,result,step,iterator,next,value;if(mapping){mapfn=functionBindContext(mapfn,argumentsLength>2?arguments[2]:undefined,2);}// if the target is not iterable or it's an array with the default iterator - use a simple case\nif(iteratorMethod!=undefined&&!(C==Array&&isArrayIteratorMethod(iteratorMethod))){iterator=iteratorMethod.call(O);next=iterator.next;result=new C();for(;!(step=next.call(iterator)).done;index++){value=mapping?callWithSafeIterationClosing(iterator,mapfn,[step.value,index],true):step.value;createProperty(result,index,value);}}else{length=toLength(O.length);result=new C(length);for(;length>index;index++){value=mapping?mapfn(O[index],index):O[index];createProperty(result,index,value);}}result.length=index;return result;};var ITERATOR$4=wellKnownSymbol('iterator');var SAFE_CLOSING=false;try{var called=0;var iteratorWithReturn={next:function(){return{done:!!called++};},'return':function(){SAFE_CLOSING=true;}};iteratorWithReturn[ITERATOR$4]=function(){return this;};// eslint-disable-next-line no-throw-literal\nArray.from(iteratorWithReturn,function(){throw 2;});}catch(error){/* empty */}var checkCorrectnessOfIteration=function(exec,SKIP_CLOSING){if(!SKIP_CLOSING&&!SAFE_CLOSING){return false;}var ITERATION_SUPPORT=false;try{var object={};object[ITERATOR$4]=function(){return{next:function(){return{done:ITERATION_SUPPORT=true};}};};exec(object);}catch(error){/* empty */}return ITERATION_SUPPORT;};var INCORRECT_ITERATION=!checkCorrectnessOfIteration(function(iterable){Array.from(iterable);});// `Array.from` method\n// https://tc39.es/ecma262/#sec-array.from\n_export({target:'Array',stat:true,forced:INCORRECT_ITERATION},{from:arrayFrom});var es_array_from={};var from_1=path.Array.from;var from_1$1=from_1;'use strict';var $findIndex=arrayIteration.findIndex;var FIND_INDEX='findIndex';var SKIPS_HOLES$1=true;var USES_TO_LENGTH$2=arrayMethodUsesToLength(FIND_INDEX);// Shouldn't skip holes\nif(FIND_INDEX in[]){Array(1)[FIND_INDEX](function(){SKIPS_HOLES$1=false;});}// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findindex\n_export({target:'Array',proto:true,forced:SKIPS_HOLES$1||!USES_TO_LENGTH$2},{findIndex:function findIndex(callbackfn/* , that = undefined */){return $findIndex(this,callbackfn,arguments.length>1?arguments[1]:undefined);}});// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);var es_array_findIndex={};var findIndex=entryUnbind('Array','findIndex');var findIndex$1=findIndex;var base64=createCommonjsModule(function(module,exports){(function(){/**\n\t     * version: 0.3.0\n\t     * git://github.com/davidchambers/Base64.js.git\n\t     */var object='object'!='undefined'?exports:this;// #8: web workers\nvar chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';function InvalidCharacterError(message){this.message=message;}InvalidCharacterError.prototype=new Error();InvalidCharacterError.prototype.name='InvalidCharacterError';// encoder\n// [https://gist.github.com/999166] by [https://github.com/nignag]\nobject.btoa||(object.btoa=function(input){var str=String(input);for(// initialize result and counter\nvar block,charCode,idx=0,map=chars,output='';// if the next str index does not exist:\n//   change the mapping table to \"=\"\n//   check if d has no fractional digits\nstr.charAt(idx|0)||(map='=',idx%1);// \"8 - idx % 1 * 8\" generates the sequence 2, 4, 6, 8\noutput+=map.charAt(63&block>>8-idx%1*8)){charCode=str.charCodeAt(idx+=3/4);if(charCode>0xFF){throw new InvalidCharacterError('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');}block=block<<8|charCode;}return output;});// decoder\n// [https://gist.github.com/1020396] by [https://github.com/atk]\nobject.atob||(object.atob=function(input){var str=String(input).replace(/=+$/,'');if(str.length%4==1){throw new InvalidCharacterError('\\'atob\\' failed: The string to be decoded is not correctly encoded.');}for(// initialize result and counters\nvar bc=0,bs,buffer,idx=0,output='';// get next character\n// eslint-disable-next-line no-cond-assign\nbuffer=str.charAt(idx++);// character found in table? initialize bit storage and add its ascii value;\n~buffer&&(bs=bc%4?bs*64+buffer:buffer,// and if not first of each 4 characters,\n// convert the first 8 bits to one ascii character\nbc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0){// try to find character in table (0-63, not found => -1)\nbuffer=chars.indexOf(buffer);}return output;});})();});// `Number.isNaN` method\n// https://tc39.es/ecma262/#sec-number.isnan\n_export({target:'Number',stat:true},{isNaN:function isNaN(number){// eslint-disable-next-line no-self-compare\nreturn number!=number;}});var es_number_isNan={};var isNan=path.Number.isNaN;var isNan$1=isNan;var globalIsFinite=global_1.isFinite;// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\nvar numberIsFinite=Number.isFinite||function isFinite(it){return typeof it=='number'&&globalIsFinite(it);};// `Number.isFinite` method\n// https://tc39.es/ecma262/#sec-number.isfinite\n_export({target:'Number',stat:true},{isFinite:numberIsFinite});var es_number_isFinite={};var _isFinite=path.Number.isFinite;var _isFinite$1=_isFinite;var MATCH=wellKnownSymbol('match');// `IsRegExp` abstract operation\n// https://tc39.es/ecma262/#sec-isregexp\nvar isRegexp=function(it){var isRegExp;return isObject(it)&&((isRegExp=it[MATCH])!==undefined?!!isRegExp:classofRaw(it)=='RegExp');};var notARegexp=function(it){if(isRegexp(it)){throw TypeError(\"The method doesn't accept regular expressions\");}return it;};var MATCH$1=wellKnownSymbol('match');var correctIsRegexpLogic=function(METHOD_NAME){var regexp=/./;try{'/./'[METHOD_NAME](regexp);}catch(error1){try{regexp[MATCH$1]=false;return'/./'[METHOD_NAME](regexp);}catch(error2){/* empty */}}return false;};'use strict';// `String.prototype.includes` method\n// https://tc39.es/ecma262/#sec-string.prototype.includes\n_export({target:'String',proto:true,forced:!correctIsRegexpLogic('includes')},{includes:function includes(searchString/* , position = 0 */){return!!~String(requireObjectCoercible(this)).indexOf(notARegexp(searchString),arguments.length>1?arguments[1]:undefined);}});var es_string_includes={};var includes$2=entryUnbind('String','includes');var includes$3=includes$2;'use strict';var getOwnPropertyDescriptor$2=objectGetOwnPropertyDescriptor.f;var nativeStartsWith=''.startsWith;var min$2=Math.min;var CORRECT_IS_REGEXP_LOGIC=correctIsRegexpLogic('startsWith');// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG=!isPure&&!CORRECT_IS_REGEXP_LOGIC&&!!function(){var descriptor=getOwnPropertyDescriptor$2(String.prototype,'startsWith');return descriptor&&!descriptor.writable;}();// `String.prototype.startsWith` method\n// https://tc39.es/ecma262/#sec-string.prototype.startswith\n_export({target:'String',proto:true,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{startsWith:function startsWith(searchString/* , position = 0 */){var that=String(requireObjectCoercible(this));notARegexp(searchString);var index=toLength(min$2(arguments.length>1?arguments[1]:undefined,that.length));var search=String(searchString);return nativeStartsWith?nativeStartsWith.call(that,search,index):that.slice(index,index+search.length)===search;}});var es_string_startsWith={};var startsWith=entryUnbind('String','startsWith');var startsWith$1=startsWith;(function(){if(typeof Uint8Array!=='undefined'||typeof window==='undefined'){return;}function subarray(start,end){return this.slice(start,end);}function set_(array,offset){if(arguments.length<2){offset=0;}for(var i=0,n=array.length;i<n;++i,++offset){this[offset]=array[i]&0xFF;}}// we need typed arrays\nfunction TypedArray(arg1){var result;if(typeof arg1==='number'){result=new Array(arg1);for(var i=0;i<arg1;++i){result[i]=0;}}else{result=arg1.slice(0);}result.subarray=subarray;result.buffer=result;result.byteLength=result.length;result.set=set_;if(typeof arg1==='object'&&arg1.buffer){result.buffer=arg1.buffer;}return result;}window.Uint8Array=TypedArray;window.Uint32Array=TypedArray;window.Int32Array=TypedArray;})();// Declare shorthands to the most used math functions.\nvar round=Math.round;var floor$1=Math.floor;var PI=Math.PI;var scale={// Return the `value` from the `domain` interval scaled to the `range` interval.\nlinear:function(domain,range,value){var domainSpan=domain[1]-domain[0];var rangeSpan=range[1]-range[0];return(value-domain[0])/domainSpan*rangeSpan+range[0]||0;}};var normalizeAngle=function(angle){return angle%360+(angle<0?360:0);};var snapToGrid=function(value,gridSize){return gridSize*round(value/gridSize);};var toDeg=function(rad){return 180*rad/PI%360;};var toRad=function(deg,over360){over360=over360||false;deg=over360?deg:deg%360;return deg*PI/180;};// Return a random integer from the interval [min,max], inclusive.\nvar random=function(min,max){if(max===undefined){// use first argument as max, min is 0\nmax=min===undefined?1:min;min=0;}else if(max<min){// switch max and min\nvar temp=min;min=max;max=temp;}return floor$1(Math.random()*(max-min+1)+min);};// @return the bearing (cardinal direction) of the line. For example N, W, or SE.\nvar cos=Math.cos;var sin=Math.sin;var atan2=Math.atan2;var bearing=function(p,q){var lat1=toRad(p.y);var lat2=toRad(q.y);var lon1=p.x;var lon2=q.x;var dLon=toRad(lon2-lon1);var y=sin(dLon)*cos(lat2);var x=cos(lat1)*sin(lat2)-sin(lat1)*cos(lat2)*cos(dLon);var brng=toDeg(atan2(y,x));var bearings=['NE','E','SE','S','SW','W','NW','N'];var index=brng-22.5;if(index<0){index+=360;}index=parseInt(index/45);return bearings[index];};// @return {integer} length without sqrt\n// @note for applications where the exact length is not necessary (e.g. compare only)\nvar squaredLength=function(start,end){var x0=start.x;var y0=start.y;var x1=end.x;var y1=end.y;return(x0-=x1)*x0+(y0-=y1)*y0;};var length=function(start,end){return Math.sqrt(squaredLength(start,end));};var types={Point:1,Line:2,Ellipse:3,Rect:4,Polyline:5,Polygon:6,Curve:7,Path:8};/*\n\t    Point is the most basic object consisting of x/y coordinate.\n\n\t    Possible instantiations are:\n\t    * `Point(10, 20)`\n\t    * `new Point(10, 20)`\n\t    * `Point('10 20')`\n\t    * `Point(Point(10, 20))`\n\t*/var abs=Math.abs;var cos$1=Math.cos;var sin$1=Math.sin;var sqrt=Math.sqrt;var min$3=Math.min;var max$1=Math.max;var atan2$1=Math.atan2;var round$1=Math.round;var pow=Math.pow;var PI$1=Math.PI;var Point=function(x,y){if(!(this instanceof Point)){return new Point(x,y);}if(typeof x==='string'){var xy=x.split(x.indexOf('@')===-1?' ':'@');x=parseFloat(xy[0]);y=parseFloat(xy[1]);}else if(Object(x)===x){y=x.y;x=x.x;}this.x=x===undefined?0:x;this.y=y===undefined?0:y;};// Alternative constructor, from polar coordinates.\n// @param {number} Distance.\n// @param {number} Angle in radians.\n// @param {point} [optional] Origin.\nPoint.fromPolar=function(distance,angle,origin){origin=new Point(origin);var x=abs(distance*cos$1(angle));var y=abs(distance*sin$1(angle));var deg=normalizeAngle(toDeg(angle));if(deg<90){y=-y;}else if(deg<180){x=-x;y=-y;}else if(deg<270){x=-x;}return new Point(origin.x+x,origin.y+y);};// Create a point with random coordinates that fall into the range `[x1, x2]` and `[y1, y2]`.\nPoint.random=function(x1,x2,y1,y2){return new Point(random(x1,x2),random(y1,y2));};Point.prototype={type:types.Point,chooseClosest:function(points){var n=points.length;if(n===1){return new Point(points[0]);}var closest=null;var minSqrDistance=Infinity;for(var i=0;i<n;i++){var p=new Point(points[i]);var sqrDistance=this.squaredDistance(p);if(sqrDistance<minSqrDistance){closest=p;minSqrDistance=sqrDistance;}}return closest;},// If point lies outside rectangle `r`, return the nearest point on the boundary of rect `r`,\n// otherwise return point itself.\n// (see Squeak Smalltalk, Point>>adhereTo:)\nadhereToRect:function(r){if(r.containsPoint(this)){return this;}this.x=min$3(max$1(this.x,r.x),r.x+r.width);this.y=min$3(max$1(this.y,r.y),r.y+r.height);return this;},// Compute the angle between vector from me to p1 and the vector from me to p2.\n// ordering of points p1 and p2 is important!\n// theta function's angle convention:\n// returns angles between 0 and 180 when the angle is counterclockwise\n// returns angles between 180 and 360 to convert clockwise angles into counterclockwise ones\n// returns NaN if any of the points p1, p2 is coincident with this point\nangleBetween:function(p1,p2){var angleBetween=this.equals(p1)||this.equals(p2)?NaN:this.theta(p2)-this.theta(p1);if(angleBetween<0){angleBetween+=360;// correction to keep angleBetween between 0 and 360\n}return angleBetween;},// Return the bearing between me and the given point.\nbearing:function(point){return bearing(this,point);},// Returns change in angle from my previous position (-dx, -dy) to my new position\n// relative to ref point.\nchangeInAngle:function(dx,dy,ref){// Revert the translation and measure the change in angle around x-axis.\nreturn this.clone().offset(-dx,-dy).theta(ref)-this.theta(ref);},clone:function(){return new Point(this);},// Returns the cross product of this point relative to two other points\n// this point is the common point\n// point p1 lies on the first vector, point p2 lies on the second vector\n// watch out for the ordering of points p1 and p2!\n// positive result indicates a clockwise (\"right\") turn from first to second vector\n// negative result indicates a counterclockwise (\"left\") turn from first to second vector\n// zero indicates that the first and second vector are collinear\n// note that the above directions are reversed from the usual answer on the Internet\n// that is because we are in a left-handed coord system (because the y-axis points downward)\ncross:function(p1,p2){return p1&&p2?(p2.x-this.x)*(p1.y-this.y)-(p2.y-this.y)*(p1.x-this.x):NaN;},difference:function(dx,dy){if(Object(dx)===dx){dy=dx.y;dx=dx.x;}return new Point(this.x-(dx||0),this.y-(dy||0));},// Returns distance between me and point `p`.\ndistance:function(p){return length(this,p);},// Returns the dot product of this point with given other point\ndot:function(p){return p?this.x*p.x+this.y*p.y:NaN;},equals:function(p){return!!p&&this.x===p.x&&this.y===p.y;},// Linear interpolation\nlerp:function(p,t){var x=this.x;var y=this.y;return new Point((1-t)*x+t*p.x,(1-t)*y+t*p.y);},magnitude:function(){return sqrt(this.x*this.x+this.y*this.y)||0.01;},// Returns a manhattan (taxi-cab) distance between me and point `p`.\nmanhattanDistance:function(p){return abs(p.x-this.x)+abs(p.y-this.y);},// Move point on line starting from ref ending at me by\n// distance distance.\nmove:function(ref,distance){var theta=toRad(new Point(ref).theta(this));var offset=this.offset(cos$1(theta)*distance,-sin$1(theta)*distance);return offset;},// Scales x and y such that the distance between the point and the origin (0,0) is equal to the given length.\nnormalize:function(length){var scale=(length||1)/this.magnitude();return this.scale(scale,scale);},// Offset me by the specified amount.\noffset:function(dx,dy){if(Object(dx)===dx){dy=dx.y;dx=dx.x;}this.x+=dx||0;this.y+=dy||0;return this;},// Returns a point that is the reflection of me with\n// the center of inversion in ref point.\nreflection:function(ref){return new Point(ref).move(this,this.distance(ref));},// Rotate point by angle around origin.\n// Angle is flipped because this is a left-handed coord system (y-axis points downward).\nrotate:function(origin,angle){if(angle===0){return this;}origin=origin||new Point(0,0);angle=toRad(normalizeAngle(-angle));var cosAngle=cos$1(angle);var sinAngle=sin$1(angle);var x=cosAngle*(this.x-origin.x)-sinAngle*(this.y-origin.y)+origin.x;var y=sinAngle*(this.x-origin.x)+cosAngle*(this.y-origin.y)+origin.y;this.x=x;this.y=y;return this;},round:function(precision){var f=1;// case 0\nif(precision){switch(precision){case 1:f=10;break;case 2:f=100;break;case 3:f=1000;break;default:f=pow(10,precision);break;}}this.x=round$1(this.x*f)/f;this.y=round$1(this.y*f)/f;return this;},// Scale point with origin.\nscale:function(sx,sy,origin){origin=origin&&new Point(origin)||new Point(0,0);this.x=origin.x+sx*(this.x-origin.x);this.y=origin.y+sy*(this.y-origin.y);return this;},snapToGrid:function(gx,gy){this.x=snapToGrid(this.x,gx);this.y=snapToGrid(this.y,gy||gx);return this;},squaredDistance:function(p){return squaredLength(this,p);},// Compute the angle between me and `p` and the x axis.\n// (cartesian-to-polar coordinates conversion)\n// Return theta angle in degrees.\ntheta:function(p){p=new Point(p);// Invert the y-axis.\nvar y=-(p.y-this.y);var x=p.x-this.x;var rad=atan2$1(y,x);// defined for all 0 corner cases\n// Correction for III. and IV. quadrant.\nif(rad<0){rad=2*PI$1+rad;}return 180*rad/PI$1;},toJSON:function(){return{x:this.x,y:this.y};},// Converts rectangular to polar coordinates.\n// An origin can be specified, otherwise it's 0@0.\ntoPolar:function(o){o=o&&new Point(o)||new Point(0,0);var x=this.x;var y=this.y;this.x=sqrt((x-o.x)*(x-o.x)+(y-o.y)*(y-o.y));// r\nthis.y=toRad(o.theta(new Point(x,y)));return this;},toString:function(){return this.x+'@'+this.y;},serialize:function(){return this.x+','+this.y;},update:function(x,y){if(Object(x)===x){y=x.y;x=x.x;}this.x=x||0;this.y=y||0;return this;},// Compute the angle between the vector from 0,0 to me and the vector from 0,0 to p.\n// Returns NaN if p is at 0,0.\nvectorAngle:function(p){var zero=new Point(0,0);return zero.angleBetween(this,p);}};Point.prototype.translate=Point.prototype.offset;// For backwards compatibility:\nvar point=Point;var max$2=Math.max;var min$4=Math.min;var Line=function(p1,p2){if(!(this instanceof Line)){return new Line(p1,p2);}if(p1 instanceof Line){return new Line(p1.start,p1.end);}this.start=new Point(p1);this.end=new Point(p2);};Line.prototype={type:types.Line,// @returns the angle of incline of the line.\nangle:function(){var horizontalPoint=new Point(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,horizontalPoint);},bbox:function(){var left=min$4(this.start.x,this.end.x);var top=min$4(this.start.y,this.end.y);var right=max$2(this.start.x,this.end.x);var bottom=max$2(this.start.y,this.end.y);return new Rect(left,top,right-left,bottom-top);},// @return the bearing (cardinal direction) of the line. For example N, W, or SE.\n// @returns {String} One of the following bearings : NE, E, SE, S, SW, W, NW, N.\nbearing:function(){return bearing(this.start,this.end);},clone:function(){return new Line(this.start,this.end);},// @return {point} the closest point on the line to point `p`\nclosestPoint:function(p){return this.pointAt(this.closestPointNormalizedLength(p));},closestPointLength:function(p){return this.closestPointNormalizedLength(p)*this.length();},// @return {number} the normalized length of the closest point on the line to point `p`\nclosestPointNormalizedLength:function(p){var product=this.vector().dot(new Line(this.start,p).vector());var cpNormalizedLength=min$4(1,max$2(0,product/this.squaredLength()));// cpNormalizedLength returns `NaN` if this line has zero length\n// we can work with that - if `NaN`, return 0\nif(cpNormalizedLength!==cpNormalizedLength){return 0;}// condition evaluates to `true` if and only if cpNormalizedLength is `NaN`\n// (`NaN` is the only value that is not equal to itself)\nreturn cpNormalizedLength;},closestPointTangent:function(p){return this.tangentAt(this.closestPointNormalizedLength(p));},// Returns `true` if the point lies on the line.\ncontainsPoint:function(p){var start=this.start;var end=this.end;if(start.cross(p,end)!==0){return false;}// else: cross product of 0 indicates that this line and the vector to `p` are collinear\nvar length=this.length();if(new Line(start,p).length()>length){return false;}if(new Line(p,end).length()>length){return false;}// else: `p` lies between start and end of the line\nreturn true;},// Divides the line into two at requested `ratio` between 0 and 1.\ndivideAt:function(ratio){var dividerPoint=this.pointAt(ratio);// return array with two lines\nreturn[new Line(this.start,dividerPoint),new Line(dividerPoint,this.end)];},// Divides the line into two at requested `length`.\ndivideAtLength:function(length){var dividerPoint=this.pointAtLength(length);// return array with two new lines\nreturn[new Line(this.start,dividerPoint),new Line(dividerPoint,this.end)];},equals:function(l){return!!l&&this.start.x===l.start.x&&this.start.y===l.start.y&&this.end.x===l.end.x&&this.end.y===l.end.y;},// @return {point} Point where I'm intersecting a line.\n// @return [point] Points where I'm intersecting a rectangle.\n// @see Squeak Smalltalk, LineSegment>>intersectionWith:\nintersect:function(shape,opt){if(shape&&shape.intersectionWithLine){var intersection=shape.intersectionWithLine(this,opt);// Backwards compatibility\nif(intersection&&shape instanceof Line){intersection=intersection[0];}return intersection;}return null;},intersectionWithLine:function(line){var pt1Dir=new Point(this.end.x-this.start.x,this.end.y-this.start.y);var pt2Dir=new Point(line.end.x-line.start.x,line.end.y-line.start.y);var det=pt1Dir.x*pt2Dir.y-pt1Dir.y*pt2Dir.x;var deltaPt=new Point(line.start.x-this.start.x,line.start.y-this.start.y);var alpha=deltaPt.x*pt2Dir.y-deltaPt.y*pt2Dir.x;var beta=deltaPt.x*pt1Dir.y-deltaPt.y*pt1Dir.x;if(det===0||alpha*det<0||beta*det<0){// No intersection found.\nreturn null;}if(det>0){if(alpha>det||beta>det){return null;}}else{if(alpha<det||beta<det){return null;}}return[new Point(this.start.x+alpha*pt1Dir.x/det,this.start.y+alpha*pt1Dir.y/det)];},isDifferentiable:function(){return!this.start.equals(this.end);},// @return {double} length of the line\nlength:function(){return length(this.start,this.end);},// @return {point} my midpoint\nmidpoint:function(){return new Point((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2);},parallel:function(distance){var l=this.clone();if(!this.isDifferentiable()){return l;}var start=l.start;var end=l.end;var eRef=start.clone().rotate(end,270);var sRef=end.clone().rotate(start,90);start.move(sRef,distance);end.move(eRef,distance);return l;},// @return {point} my point at 't' <0,1>\npointAt:function(t){var start=this.start;var end=this.end;if(t<=0){return start.clone();}if(t>=1){return end.clone();}return start.lerp(end,t);},pointAtLength:function(length){var start=this.start;var end=this.end;var fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}var lineLength=this.length();if(length>=lineLength){return fromStart?end.clone():start.clone();}return this.pointAt((fromStart?length:lineLength-length)/lineLength);},// @return {number} the offset of the point `p` from the line. + if the point `p` is on the right side of the line, - if on the left and 0 if on the line.\npointOffset:function(p){// Find the sign of the determinant of vectors (start,end), where p is the query point.\np=new Point(p);var start=this.start;var end=this.end;var determinant=(end.x-start.x)*(p.y-start.y)-(end.y-start.y)*(p.x-start.x);return determinant/this.length();},rotate:function(origin,angle){this.start.rotate(origin,angle);this.end.rotate(origin,angle);return this;},round:function(precision){this.start.round(precision);this.end.round(precision);return this;},scale:function(sx,sy,origin){this.start.scale(sx,sy,origin);this.end.scale(sx,sy,origin);return this;},// @return {number} scale the line so that it has the requested length\nsetLength:function(length){var currentLength=this.length();if(!currentLength){return this;}var scaleFactor=length/currentLength;return this.scale(scaleFactor,scaleFactor,this.start);},// @return {integer} length without sqrt\n// @note for applications where the exact length is not necessary (e.g. compare only)\nsquaredLength:function(){return squaredLength(this.start,this.end);},tangentAt:function(t){if(!this.isDifferentiable()){return null;}var start=this.start;var end=this.end;var tangentStart=this.pointAt(t);// constrains `t` between 0 and 1\nvar tangentLine=new Line(start,end);tangentLine.translate(tangentStart.x-start.x,tangentStart.y-start.y);// move so that tangent line starts at the point requested\nreturn tangentLine;},tangentAtLength:function(length){if(!this.isDifferentiable()){return null;}var start=this.start;var end=this.end;var tangentStart=this.pointAtLength(length);var tangentLine=new Line(start,end);tangentLine.translate(tangentStart.x-start.x,tangentStart.y-start.y);// move so that tangent line starts at the point requested\nreturn tangentLine;},toString:function(){return this.start.toString()+' '+this.end.toString();},serialize:function(){return this.start.serialize()+' '+this.end.serialize();},translate:function(tx,ty){this.start.translate(tx,ty);this.end.translate(tx,ty);return this;},// @return vector {point} of the line\nvector:function(){return new Point(this.end.x-this.start.x,this.end.y-this.start.y);}};// For backwards compatibility:\nLine.prototype.intersection=Line.prototype.intersect;// For backwards compatibility:\nvar line=Line;var sqrt$1=Math.sqrt;var round$2=Math.round;var pow$1=Math.pow;var Ellipse=function(c,a,b){if(!(this instanceof Ellipse)){return new Ellipse(c,a,b);}if(c instanceof Ellipse){return new Ellipse(new Point(c.x,c.y),c.a,c.b);}c=new Point(c);this.x=c.x;this.y=c.y;this.a=a;this.b=b;};Ellipse.fromRect=function(rect){rect=new Rect(rect);return new Ellipse(rect.center(),rect.width/2,rect.height/2);};Ellipse.prototype={type:types.Ellipse,bbox:function(){return new Rect(this.x-this.a,this.y-this.b,2*this.a,2*this.b);},/**\n\t     * @returns {g.Point}\n\t     */center:function(){return new Point(this.x,this.y);},clone:function(){return new Ellipse(this);},/**\n\t     * @param {g.Point} p\n\t     * @returns {boolean}\n\t     */containsPoint:function(p){return this.normalizedDistance(p)<=1;},equals:function(ellipse){return!!ellipse&&ellipse.x===this.x&&ellipse.y===this.y&&ellipse.a===this.a&&ellipse.b===this.b;},// inflate by dx and dy\n// @param dx {delta_x} representing additional size to x\n// @param dy {delta_y} representing additional size to y -\n// dy param is not required -> in that case y is sized by dx\ninflate:function(dx,dy){if(dx===undefined){dx=0;}if(dy===undefined){dy=dx;}this.a+=2*dx;this.b+=2*dy;return this;},intersectionWithLine:function(line){var intersections=[];var a1=line.start;var a2=line.end;var rx=this.a;var ry=this.b;var dir=line.vector();var diff=a1.difference(new Point(this));var mDir=new Point(dir.x/(rx*rx),dir.y/(ry*ry));var mDiff=new Point(diff.x/(rx*rx),diff.y/(ry*ry));var a=dir.dot(mDir);var b=dir.dot(mDiff);var c=diff.dot(mDiff)-1.0;var d=b*b-a*c;if(d<0){return null;}else if(d>0){var root=sqrt$1(d);var ta=(-b-root)/a;var tb=(-b+root)/a;if((ta<0||1<ta)&&(tb<0||1<tb)){// if ((ta < 0 && tb < 0) || (ta > 1 && tb > 1)) outside else inside\nreturn null;}else{if(0<=ta&&ta<=1){intersections.push(a1.lerp(a2,ta));}if(0<=tb&&tb<=1){intersections.push(a1.lerp(a2,tb));}}}else{var t=-b/a;if(0<=t&&t<=1){intersections.push(a1.lerp(a2,t));}else{// outside\nreturn null;}}return intersections;},// Find point on me where line from my center to\n// point p intersects my boundary.\n// @param {number} angle If angle is specified, intersection with rotated ellipse is computed.\nintersectionWithLineFromCenterToPoint:function(p,angle){p=new Point(p);if(angle){p.rotate(new Point(this.x,this.y),angle);}var dx=p.x-this.x;var dy=p.y-this.y;var result;if(dx===0){result=this.bbox().pointNearestToPoint(p);if(angle){return result.rotate(new Point(this.x,this.y),-angle);}return result;}var m=dy/dx;var mSquared=m*m;var aSquared=this.a*this.a;var bSquared=this.b*this.b;var x=sqrt$1(1/(1/aSquared+mSquared/bSquared));x=dx<0?-x:x;var y=m*x;result=new Point(this.x+x,this.y+y);if(angle){return result.rotate(new Point(this.x,this.y),-angle);}return result;},/**\n\t     * @param {g.Point} point\n\t     * @returns {number} result < 1 - inside ellipse, result == 1 - on ellipse boundary, result > 1 - outside\n\t     */normalizedDistance:function(point){var x0=point.x;var y0=point.y;var a=this.a;var b=this.b;var x=this.x;var y=this.y;return(x0-x)*(x0-x)/(a*a)+(y0-y)*(y0-y)/(b*b);},round:function(precision){var f=1;// case 0\nif(precision){switch(precision){case 1:f=10;break;case 2:f=100;break;case 3:f=1000;break;default:f=pow$1(10,precision);break;}}this.x=round$2(this.x*f)/f;this.y=round$2(this.y*f)/f;this.a=round$2(this.a*f)/f;this.b=round$2(this.b*f)/f;return this;},/** Compute angle between tangent and x axis\n\t     * @param {g.Point} p Point of tangency, it has to be on ellipse boundaries.\n\t     * @returns {number} angle between tangent and x axis\n\t     */tangentTheta:function(p){var refPointDelta=30;var x0=p.x;var y0=p.y;var a=this.a;var b=this.b;var center=this.bbox().center();var m=center.x;var n=center.y;var q1=x0>center.x+a/2;var q3=x0<center.x-a/2;var y,x;if(q1||q3){y=x0>center.x?y0-refPointDelta:y0+refPointDelta;x=a*a/(x0-m)-a*a*(y0-n)*(y-n)/(b*b*(x0-m))+m;}else{x=y0>center.y?x0+refPointDelta:x0-refPointDelta;y=b*b/(y0-n)-b*b*(x0-m)*(x-m)/(a*a*(y0-n))+n;}return new Point(x,y).theta(p);},toString:function(){return new Point(this.x,this.y).toString()+' '+this.a+' '+this.b;}};// For backwards compatibility:\nvar ellipse=Ellipse;var abs$1=Math.abs;var cos$2=Math.cos;var sin$2=Math.sin;var min$5=Math.min;var max$3=Math.max;var round$3=Math.round;var pow$2=Math.pow;var Rect=function(x,y,w,h){if(!(this instanceof Rect)){return new Rect(x,y,w,h);}if(Object(x)===x){y=x.y;w=x.width;h=x.height;x=x.x;}this.x=x===undefined?0:x;this.y=y===undefined?0:y;this.width=w===undefined?0:w;this.height=h===undefined?0:h;};Rect.fromEllipse=function(e){e=new Ellipse(e);return new Rect(e.x-e.a,e.y-e.b,2*e.a,2*e.b);};Rect.fromPointUnion=function(){var points=[],len=arguments.length;while(len--)points[len]=arguments[len];if(points.length===0){return null;}var p=new Point();var minX,minY,maxX,maxY;minX=minY=Infinity;maxX=maxY=-Infinity;for(var i=0;i<points.length;i++){p.update(points[i]);var x=p.x;var y=p.y;if(x<minX){minX=x;}if(x>maxX){maxX=x;}if(y<minY){minY=y;}if(y>maxY){maxY=y;}}return new Rect(minX,minY,maxX-minX,maxY-minY);};Rect.fromRectUnion=function(){var rects=[],len=arguments.length;while(len--)rects[len]=arguments[len];if(rects.length===0){return null;}var r=new Rect();var minX,minY,maxX,maxY;minX=minY=Infinity;maxX=maxY=-Infinity;for(var i=0;i<rects.length;i++){r.update(rects[i]);var x=r.x;var y=r.y;var mX=x+r.width;var mY=y+r.height;if(x<minX){minX=x;}if(mX>maxX){maxX=mX;}if(y<minY){minY=y;}if(mY>maxY){maxY=mY;}}return new Rect(minX,minY,maxX-minX,maxY-minY);};Rect.prototype={type:types.Rect,// Find my bounding box when I'm rotated with the center of rotation in the center of me.\n// @return r {rectangle} representing a bounding box\nbbox:function(angle){return this.clone().rotateAroundCenter(angle);},rotateAroundCenter:function(angle){if(!angle){return this;}var ref=this;var width=ref.width;var height=ref.height;var theta=toRad(angle);var st=abs$1(sin$2(theta));var ct=abs$1(cos$2(theta));var w=width*ct+height*st;var h=width*st+height*ct;this.x+=(width-w)/2;this.y+=(height-h)/2;this.width=w;this.height=h;return this;},bottomLeft:function(){return new Point(this.x,this.y+this.height);},bottomLine:function(){return new Line(this.bottomLeft(),this.bottomRight());},bottomMiddle:function(){return new Point(this.x+this.width/2,this.y+this.height);},center:function(){return new Point(this.x+this.width/2,this.y+this.height/2);},clone:function(){return new Rect(this);},// @return {bool} true if point p is inside me.\ncontainsPoint:function(p){p=new Point(p);return p.x>=this.x&&p.x<=this.x+this.width&&p.y>=this.y&&p.y<=this.y+this.height;},// @return {bool} true if rectangle `r` is inside me.\ncontainsRect:function(r){var r0=new Rect(this).normalize();var r1=new Rect(r).normalize();var w0=r0.width;var h0=r0.height;var w1=r1.width;var h1=r1.height;if(!w0||!h0||!w1||!h1){// At least one of the dimensions is 0\nreturn false;}var x0=r0.x;var y0=r0.y;var x1=r1.x;var y1=r1.y;w1+=x1;w0+=x0;h1+=y1;h0+=y0;return x0<=x1&&w1<=w0&&y0<=y1&&h1<=h0;},corner:function(){return new Point(this.x+this.width,this.y+this.height);},// @return {boolean} true if rectangles are equal.\nequals:function(r){var mr=new Rect(this).normalize();var nr=new Rect(r).normalize();return mr.x===nr.x&&mr.y===nr.y&&mr.width===nr.width&&mr.height===nr.height;},// inflate by dx and dy, recompute origin [x, y]\n// @param dx {delta_x} representing additional size to x\n// @param dy {delta_y} representing additional size to y -\n// dy param is not required -> in that case y is sized by dx\ninflate:function(dx,dy){if(dx===undefined){dx=0;}if(dy===undefined){dy=dx;}this.x-=dx;this.y-=dy;this.width+=2*dx;this.height+=2*dy;return this;},// @return {rect} if rectangles intersect, {null} if not.\nintersect:function(r){var myOrigin=this.origin();var myCorner=this.corner();var rOrigin=r.origin();var rCorner=r.corner();// No intersection found\nif(rCorner.x<=myOrigin.x||rCorner.y<=myOrigin.y||rOrigin.x>=myCorner.x||rOrigin.y>=myCorner.y){return null;}var x=max$3(myOrigin.x,rOrigin.x);var y=max$3(myOrigin.y,rOrigin.y);return new Rect(x,y,min$5(myCorner.x,rCorner.x)-x,min$5(myCorner.y,rCorner.y)-y);},intersectionWithLine:function(line){var r=this;var rectLines=[r.topLine(),r.rightLine(),r.bottomLine(),r.leftLine()];var points=[];var dedupeArr=[];var pt,i;var n=rectLines.length;for(i=0;i<n;i++){pt=line.intersect(rectLines[i]);if(pt!==null&&dedupeArr.indexOf(pt.toString())<0){points.push(pt);dedupeArr.push(pt.toString());}}return points.length>0?points:null;},// Find point on my boundary where line starting\n// from my center ending in point p intersects me.\n// @param {number} angle If angle is specified, intersection with rotated rectangle is computed.\nintersectionWithLineFromCenterToPoint:function(p,angle){p=new Point(p);var center=new Point(this.x+this.width/2,this.y+this.height/2);var result;if(angle){p.rotate(center,angle);}// (clockwise, starting from the top side)\nvar sides=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()];var connector=new Line(center,p);for(var i=sides.length-1;i>=0;--i){var intersection=sides[i].intersection(connector);if(intersection!==null){result=intersection;break;}}if(result&&angle){result.rotate(center,-angle);}return result;},leftLine:function(){return new Line(this.topLeft(),this.bottomLeft());},leftMiddle:function(){return new Point(this.x,this.y+this.height/2);},maxRectScaleToFit:function(rect,origin){rect=new Rect(rect);origin||(origin=rect.center());var sx1,sx2,sx3,sx4,sy1,sy2,sy3,sy4;var ox=origin.x;var oy=origin.y;// Here we find the maximal possible scale for all corner points (for x and y axis) of the rectangle,\n// so when the scale is applied the point is still inside the rectangle.\nsx1=sx2=sx3=sx4=sy1=sy2=sy3=sy4=Infinity;// Top Left\nvar p1=rect.topLeft();if(p1.x<ox){sx1=(this.x-ox)/(p1.x-ox);}if(p1.y<oy){sy1=(this.y-oy)/(p1.y-oy);}// Bottom Right\nvar p2=rect.bottomRight();if(p2.x>ox){sx2=(this.x+this.width-ox)/(p2.x-ox);}if(p2.y>oy){sy2=(this.y+this.height-oy)/(p2.y-oy);}// Top Right\nvar p3=rect.topRight();if(p3.x>ox){sx3=(this.x+this.width-ox)/(p3.x-ox);}if(p3.y<oy){sy3=(this.y-oy)/(p3.y-oy);}// Bottom Left\nvar p4=rect.bottomLeft();if(p4.x<ox){sx4=(this.x-ox)/(p4.x-ox);}if(p4.y>oy){sy4=(this.y+this.height-oy)/(p4.y-oy);}return{sx:min$5(sx1,sx2,sx3,sx4),sy:min$5(sy1,sy2,sy3,sy4)};},maxRectUniformScaleToFit:function(rect,origin){var scale=this.maxRectScaleToFit(rect,origin);return min$5(scale.sx,scale.sy);},// Move and expand me.\n// @param r {rectangle} representing deltas\nmoveAndExpand:function(r){this.x+=r.x||0;this.y+=r.y||0;this.width+=r.width||0;this.height+=r.height||0;return this;},// Normalize the rectangle; i.e., make it so that it has a non-negative width and height.\n// If width < 0 the function swaps the left and right corners,\n// and it swaps the top and bottom corners if height < 0\n// like in http://qt-project.org/doc/qt-4.8/qrectf.html#normalized\nnormalize:function(){var newx=this.x;var newy=this.y;var newwidth=this.width;var newheight=this.height;if(this.width<0){newx=this.x+this.width;newwidth=-this.width;}if(this.height<0){newy=this.y+this.height;newheight=-this.height;}this.x=newx;this.y=newy;this.width=newwidth;this.height=newheight;return this;},// Offset me by the specified amount.\noffset:function(dx,dy){// pretend that this is a point and call offset()\n// rewrites x and y according to dx and dy\nreturn Point.prototype.offset.call(this,dx,dy);},origin:function(){return new Point(this.x,this.y);},// @return {point} a point on my boundary nearest to the given point.\n// @see Squeak Smalltalk, Rectangle>>pointNearestTo:\npointNearestToPoint:function(point){point=new Point(point);if(this.containsPoint(point)){var side=this.sideNearestToPoint(point);switch(side){case'right':return new Point(this.x+this.width,point.y);case'left':return new Point(this.x,point.y);case'bottom':return new Point(point.x,this.y+this.height);case'top':return new Point(point.x,this.y);}}return point.adhereToRect(this);},rightLine:function(){return new Line(this.topRight(),this.bottomRight());},rightMiddle:function(){return new Point(this.x+this.width,this.y+this.height/2);},round:function(precision){var f=1;// case 0\nif(precision){switch(precision){case 1:f=10;break;case 2:f=100;break;case 3:f=1000;break;default:f=pow$2(10,precision);break;}}this.x=round$3(this.x*f)/f;this.y=round$3(this.y*f)/f;this.width=round$3(this.width*f)/f;this.height=round$3(this.height*f)/f;return this;},// Scale rectangle with origin.\nscale:function(sx,sy,origin){origin=this.origin().scale(sx,sy,origin);this.x=origin.x;this.y=origin.y;this.width*=sx;this.height*=sy;return this;},// @return {string} (left|right|top|bottom) side which is nearest to point\n// @see Squeak Smalltalk, Rectangle>>sideNearestTo:\nsideNearestToPoint:function(point){point=new Point(point);var distToLeft=point.x-this.x;var distToRight=this.x+this.width-point.x;var distToTop=point.y-this.y;var distToBottom=this.y+this.height-point.y;var closest=distToLeft;var side='left';if(distToRight<closest){closest=distToRight;side='right';}if(distToTop<closest){closest=distToTop;side='top';}if(distToBottom<closest){// closest = distToBottom;\nside='bottom';}return side;},snapToGrid:function(gx,gy){var origin=this.origin().snapToGrid(gx,gy);var corner=this.corner().snapToGrid(gx,gy);this.x=origin.x;this.y=origin.y;this.width=corner.x-origin.x;this.height=corner.y-origin.y;return this;},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height};},topLine:function(){return new Line(this.topLeft(),this.topRight());},topMiddle:function(){return new Point(this.x+this.width/2,this.y);},topRight:function(){return new Point(this.x+this.width,this.y);},toString:function(){return this.origin().toString()+' '+this.corner().toString();},// @return {rect} representing the union of both rectangles.\nunion:function(rect){return Rect.fromRectUnion(this,rect);},update:function(x,y,w,h){if(Object(x)===x){y=x.y;w=x.width;h=x.height;x=x.x;}this.x=x||0;this.y=y||0;this.width=w||0;this.height=h||0;return this;}};Rect.prototype.bottomRight=Rect.prototype.corner;Rect.prototype.topLeft=Rect.prototype.origin;Rect.prototype.translate=Rect.prototype.offset;// For backwards compatibility:\nvar rect=Rect;function parsePoints(svgString){svgString=svgString.trim();if(svgString===''){return[];}var points=[];var coords=svgString.split(/\\s*,\\s*|\\s+/);var n=coords.length;for(var i=0;i<n;i+=2){points.push({x:+coords[i],y:+coords[i+1]});}return points;}function clonePoints(points){var numPoints=points.length;if(numPoints===0){return[];}var newPoints=[];for(var i=0;i<numPoints;i++){var point=points[i].clone();newPoints.push(point);}return newPoints;}// Returns a convex-hull polyline from this polyline.\n// Implements the Graham scan (https://en.wikipedia.org/wiki/Graham_scan).\n// Output polyline starts at the first element of the original polyline that is on the hull, then continues clockwise.\n// Minimal polyline is found (only vertices of the hull are reported, no collinear points).\nfunction convexHull(points){var abs=Math.abs;var i;var n;var numPoints=points.length;if(numPoints===0){return[];}// if points array is empty\n// step 1: find the starting point - point with the lowest y (if equality, highest x)\nvar startPoint;for(i=0;i<numPoints;i++){if(startPoint===undefined){// if this is the first point we see, set it as start point\nstartPoint=points[i];}else if(points[i].y<startPoint.y){// start point should have lowest y from all points\nstartPoint=points[i];}else if(points[i].y===startPoint.y&&points[i].x>startPoint.x){// if two points have the lowest y, choose the one that has highest x\n// there are no points to the right of startPoint - no ambiguity about theta 0\n// if there are several coincident start point candidates, first one is reported\nstartPoint=points[i];}}// step 2: sort the list of points\n// sorting by angle between line from startPoint to point and the x-axis (theta)\n// step 2a: create the point records = [point, originalIndex, angle]\nvar sortedPointRecords=[];for(i=0;i<numPoints;i++){var angle=startPoint.theta(points[i]);if(angle===0){angle=360;// give highest angle to start point\n// the start point will end up at end of sorted list\n// the start point will end up at beginning of hull points list\n}var entry=[points[i],i,angle];sortedPointRecords.push(entry);}// step 2b: sort the list in place\nsortedPointRecords.sort(function(record1,record2){// returning a negative number here sorts record1 before record2\n// if first angle is smaller than second, first angle should come before second\nvar sortOutput=record1[2]-record2[2];// negative if first angle smaller\nif(sortOutput===0){// if the two angles are equal, sort by originalIndex\nsortOutput=record2[1]-record1[1];// negative if first index larger\n// coincident points will be sorted in reverse-numerical order\n// so the coincident points with lower original index will be considered first\n}return sortOutput;});// step 2c: duplicate start record from the top of the stack to the bottom of the stack\nif(sortedPointRecords.length>2){var startPointRecord=sortedPointRecords[sortedPointRecords.length-1];sortedPointRecords.unshift(startPointRecord);}// step 3a: go through sorted points in order and find those with right turns\n// we want to get our results in clockwise order\nvar insidePoints={};// dictionary of points with left turns - cannot be on the hull\nvar hullPointRecords=[];// stack of records with right turns - hull point candidates\nvar currentPointRecord;var currentPoint;var lastHullPointRecord;var lastHullPoint;var secondLastHullPointRecord;var secondLastHullPoint;while(sortedPointRecords.length!==0){currentPointRecord=sortedPointRecords.pop();currentPoint=currentPointRecord[0];// check if point has already been discarded\n// keys for insidePoints are stored in the form 'point.x@point.y@@originalIndex'\nif(insidePoints.hasOwnProperty(currentPointRecord[0]+'@@'+currentPointRecord[1])){// this point had an incorrect turn at some previous iteration of this loop\n// this disqualifies it from possibly being on the hull\ncontinue;}var correctTurnFound=false;while(!correctTurnFound){if(hullPointRecords.length<2){// not enough points for comparison, just add current point\nhullPointRecords.push(currentPointRecord);correctTurnFound=true;}else{lastHullPointRecord=hullPointRecords.pop();lastHullPoint=lastHullPointRecord[0];secondLastHullPointRecord=hullPointRecords.pop();secondLastHullPoint=secondLastHullPointRecord[0];var crossProduct=secondLastHullPoint.cross(lastHullPoint,currentPoint);if(crossProduct<0){// found a right turn\nhullPointRecords.push(secondLastHullPointRecord);hullPointRecords.push(lastHullPointRecord);hullPointRecords.push(currentPointRecord);correctTurnFound=true;}else if(crossProduct===0){// the three points are collinear\n// three options:\n// there may be a 180 or 0 degree angle at lastHullPoint\n// or two of the three points are coincident\nvar THRESHOLD=1e-10;// we have to take rounding errors into account\nvar angleBetween=lastHullPoint.angleBetween(secondLastHullPoint,currentPoint);if(abs(angleBetween-180)<THRESHOLD){// rounding around 180 to 180\n// if the cross product is 0 because the angle is 180 degrees\n// discard last hull point (add to insidePoints)\n//insidePoints.unshift(lastHullPoint);\ninsidePoints[lastHullPointRecord[0]+'@@'+lastHullPointRecord[1]]=lastHullPoint;// reenter second-to-last hull point (will be last at next iter)\nhullPointRecords.push(secondLastHullPointRecord);// do not do anything with current point\n// correct turn not found\n}else if(lastHullPoint.equals(currentPoint)||secondLastHullPoint.equals(lastHullPoint)){// if the cross product is 0 because two points are the same\n// discard last hull point (add to insidePoints)\n//insidePoints.unshift(lastHullPoint);\ninsidePoints[lastHullPointRecord[0]+'@@'+lastHullPointRecord[1]]=lastHullPoint;// reenter second-to-last hull point (will be last at next iter)\nhullPointRecords.push(secondLastHullPointRecord);// do not do anything with current point\n// correct turn not found\n}else if(abs((angleBetween+1)%360-1)<THRESHOLD){// rounding around 0 and 360 to 0\n// if the cross product is 0 because the angle is 0 degrees\n// remove last hull point from hull BUT do not discard it\n// reenter second-to-last hull point (will be last at next iter)\nhullPointRecords.push(secondLastHullPointRecord);// put last hull point back into the sorted point records list\nsortedPointRecords.push(lastHullPointRecord);// we are switching the order of the 0deg and 180deg points\n// correct turn not found\n}}else{// found a left turn\n// discard last hull point (add to insidePoints)\n//insidePoints.unshift(lastHullPoint);\ninsidePoints[lastHullPointRecord[0]+'@@'+lastHullPointRecord[1]]=lastHullPoint;// reenter second-to-last hull point (will be last at next iter of loop)\nhullPointRecords.push(secondLastHullPointRecord);// do not do anything with current point\n// correct turn not found\n}}}}// at this point, hullPointRecords contains the output points in clockwise order\n// the points start with lowest-y,highest-x startPoint, and end at the same point\n// step 3b: remove duplicated startPointRecord from the end of the array\nif(hullPointRecords.length>2){hullPointRecords.pop();}// step 4: find the lowest originalIndex record and put it at the beginning of hull\nvar lowestHullIndex;// the lowest originalIndex on the hull\nvar indexOfLowestHullIndexRecord=-1;// the index of the record with lowestHullIndex\nn=hullPointRecords.length;for(i=0;i<n;i++){var currentHullIndex=hullPointRecords[i][1];if(lowestHullIndex===undefined||currentHullIndex<lowestHullIndex){lowestHullIndex=currentHullIndex;indexOfLowestHullIndexRecord=i;}}var hullPointRecordsReordered=[];if(indexOfLowestHullIndexRecord>0){var newFirstChunk=hullPointRecords.slice(indexOfLowestHullIndexRecord);var newSecondChunk=hullPointRecords.slice(0,indexOfLowestHullIndexRecord);hullPointRecordsReordered=newFirstChunk.concat(newSecondChunk);}else{hullPointRecordsReordered=hullPointRecords;}var hullPoints=[];n=hullPointRecordsReordered.length;for(i=0;i<n;i++){hullPoints.push(hullPointRecordsReordered[i][0]);}return hullPoints;}var Polyline=function(points){if(!(this instanceof Polyline)){return new Polyline(points);}if(typeof points==='string'){return new Polyline.parse(points);}this.points=Array.isArray(points)?points.map(Point):[];};Polyline.parse=function(svgString){return new Polyline(parsePoints(svgString));};Polyline.fromRect=function(rect){return new Polyline([rect.topLeft(),rect.topRight(),rect.bottomRight(),rect.bottomLeft(),rect.topLeft()]);};Polyline.prototype={type:types.Polyline,bbox:function(){var x1=Infinity;var x2=-Infinity;var y1=Infinity;var y2=-Infinity;var points=this.points;var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nfor(var i=0;i<numPoints;i++){var point=points[i];var x=point.x;var y=point.y;if(x<x1){x1=x;}if(x>x2){x2=x;}if(y<y1){y1=y;}if(y>y2){y2=y;}}return new Rect(x1,y1,x2-x1,y2-y1);},clone:function(){return new Polyline(clonePoints(this.points));},closestPoint:function(p){var cpLength=this.closestPointLength(p);return this.pointAtLength(cpLength);},closestPointLength:function(p){var points=this.lengthPoints();var numPoints=points.length;if(numPoints===0){return 0;}// if points array is empty\nif(numPoints===1){return 0;}// if there is only one point\nvar cpLength;var minSqrDistance=Infinity;var length=0;var n=numPoints-1;for(var i=0;i<n;i++){var line=new Line(points[i],points[i+1]);var lineLength=line.length();var cpNormalizedLength=line.closestPointNormalizedLength(p);var cp=line.pointAt(cpNormalizedLength);var sqrDistance=cp.squaredDistance(p);if(sqrDistance<minSqrDistance){minSqrDistance=sqrDistance;cpLength=length+cpNormalizedLength*lineLength;}length+=lineLength;}return cpLength;},closestPointNormalizedLength:function(p){var cpLength=this.closestPointLength(p);if(cpLength===0){return 0;}// shortcut\nvar length=this.length();if(length===0){return 0;}// prevents division by zero\nreturn cpLength/length;},closestPointTangent:function(p){var cpLength=this.closestPointLength(p);return this.tangentAtLength(cpLength);},// Returns `true` if the area surrounded by the polyline contains the point `p`.\n// Implements the even-odd SVG algorithm (self-intersections are \"outside\").\n// (Uses horizontal rays to the right of `p` to look for intersections.)\n// Closes open polylines (always imagines a final closing segment).\ncontainsPoint:function(p){var points=this.points;var numPoints=points.length;if(numPoints===0){return false;}// shortcut (this polyline has no points)\nvar x=p.x;var y=p.y;// initialize a final closing segment by creating one from last-first points on polyline\nvar startIndex=numPoints-1;// start of current polyline segment\nvar endIndex=0;// end of current polyline segment\nvar numIntersections=0;var segment=new Line();var ray=new Line();var rayEnd=new Point();for(;endIndex<numPoints;endIndex++){var start=points[startIndex];var end=points[endIndex];if(p.equals(start)){return true;}// shortcut (`p` is a point on polyline)\n// current polyline segment\nsegment.start=start;segment.end=end;if(segment.containsPoint(p)){return true;}// shortcut (`p` lies on a polyline segment)\n// do we have an intersection?\nif(y<=start.y&&y>end.y||y>start.y&&y<=end.y){// this conditional branch IS NOT entered when `segment` is collinear/coincident with `ray`\n// (when `y === start.y === end.y`)\n// this conditional branch IS entered when `segment` touches `ray` at only one point\n// (e.g. when `y === start.y !== end.y`)\n// since this branch is entered again for the following segment, the two touches cancel out\nvar xDifference=start.x-x>end.x-x?start.x-x:end.x-x;if(xDifference>=0){// segment lies at least partially to the right of `p`\nrayEnd.x=x+xDifference;rayEnd.y=y;// right\nray.start=p;ray.end=rayEnd;if(segment.intersect(ray)){// an intersection was detected to the right of `p`\nnumIntersections++;}}// else: `segment` lies completely to the left of `p` (i.e. no intersection to the right)\n}// move to check the next polyline segment\nstartIndex=endIndex;}// returns `true` for odd numbers of intersections (even-odd algorithm)\nreturn numIntersections%2===1;},close:function(){var ref=this;var start=ref.start;var end=ref.end;var points=ref.points;if(start&&end&&!start.equals(end)){points.push(start.clone());}return this;},lengthPoints:function(){return this.points;},convexHull:function(){return new Polyline(convexHull(this.points));},// Checks whether two polylines are exactly the same.\n// If `p` is undefined or null, returns false.\nequals:function(p){if(!p){return false;}var points=this.points;var otherPoints=p.points;var numPoints=points.length;if(otherPoints.length!==numPoints){return false;}// if the two polylines have different number of points, they cannot be equal\nfor(var i=0;i<numPoints;i++){var point=points[i];var otherPoint=p.points[i];// as soon as an inequality is found in points, return false\nif(!point.equals(otherPoint)){return false;}}// if no inequality found in points, return true\nreturn true;},intersectionWithLine:function(l){var line=new Line(l);var intersections=[];var points=this.lengthPoints();var l2=new Line();for(var i=0,n=points.length-1;i<n;i++){l2.start=points[i];l2.end=points[i+1];var int=line.intersectionWithLine(l2);if(int){intersections.push(int[0]);}}return intersections.length>0?intersections:null;},isDifferentiable:function(){var points=this.points;var numPoints=points.length;if(numPoints===0){return false;}var line=new Line();var n=numPoints-1;for(var i=0;i<n;i++){line.start=points[i];line.end=points[i+1];// as soon as a differentiable line is found between two points, return true\nif(line.isDifferentiable()){return true;}}// if no differentiable line is found between pairs of points, return false\nreturn false;},length:function(){var points=this.lengthPoints();var numPoints=points.length;if(numPoints===0){return 0;}// if points array is empty\nvar length=0;var n=numPoints-1;for(var i=0;i<n;i++){length+=points[i].distance(points[i+1]);}return length;},pointAt:function(ratio){var points=this.lengthPoints();var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nif(numPoints===1){return points[0].clone();}// if there is only one point\nif(ratio<=0){return points[0].clone();}if(ratio>=1){return points[numPoints-1].clone();}var polylineLength=this.length();var length=polylineLength*ratio;return this.pointAtLength(length);},pointAtLength:function(length){var points=this.lengthPoints();var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nif(numPoints===1){return points[0].clone();}// if there is only one point\nvar fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}var l=0;var n=numPoints-1;for(var i=0;i<n;i++){var index=fromStart?i:n-1-i;var a=points[index];var b=points[index+1];var line=new Line(a,b);var d=a.distance(b);if(length<=l+d){return line.pointAtLength((fromStart?1:-1)*(length-l));}l+=d;}// if length requested is higher than the length of the polyline, return last endpoint\nvar lastPoint=fromStart?points[numPoints-1]:points[0];return lastPoint.clone();},round:function(precision){var points=this.points;var numPoints=points.length;for(var i=0;i<numPoints;i++){points[i].round(precision);}return this;},scale:function(sx,sy,origin){var points=this.points;var numPoints=points.length;for(var i=0;i<numPoints;i++){points[i].scale(sx,sy,origin);}return this;},simplify:function(opt){if(opt===void 0)opt={};var points=this.points;if(points.length<3){return this;}// we need at least 3 points\n// TODO: we may also accept startIndex and endIndex to specify where to start and end simplification\nvar threshold=opt.threshold||0;// = max distance of middle point from chord to be simplified\n// start at the beginning of the polyline and go forward\nvar currentIndex=0;// we need at least one intermediate point (3 points) in every iteration\n// as soon as that stops being true, we know we reached the end of the polyline\nwhile(points[currentIndex+2]){var firstIndex=currentIndex;var middleIndex=currentIndex+1;var lastIndex=currentIndex+2;var firstPoint=points[firstIndex];var middlePoint=points[middleIndex];var lastPoint=points[lastIndex];var chord=new Line(firstPoint,lastPoint);// = connection between first and last point\nvar closestPoint=chord.closestPoint(middlePoint);// = closest point on chord from middle point\nvar closestPointDistance=closestPoint.distance(middlePoint);if(closestPointDistance<=threshold){// middle point is close enough to the chord = simplify\n// 1) remove middle point:\npoints.splice(middleIndex,1);// 2) in next iteration, investigate the newly-created triplet of points\n//    - do not change `currentIndex`\n//    = (first point stays, point after removed point becomes middle point)\n}else{// middle point is far from the chord\n// 1) preserve middle point\n// 2) in next iteration, move `currentIndex` by one step:\ncurrentIndex+=1;//    = (point after first point becomes first point)\n}}// `points` array was modified in-place\nreturn this;},tangentAt:function(ratio){var points=this.lengthPoints();var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nif(numPoints===1){return null;}// if there is only one point\nif(ratio<0){ratio=0;}if(ratio>1){ratio=1;}var polylineLength=this.length();var length=polylineLength*ratio;return this.tangentAtLength(length);},tangentAtLength:function(length){var points=this.lengthPoints();var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nif(numPoints===1){return null;}// if there is only one point\nvar fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}var lastValidLine;// differentiable (with a tangent)\nvar l=0;// length so far\nvar n=numPoints-1;for(var i=0;i<n;i++){var index=fromStart?i:n-1-i;var a=points[index];var b=points[index+1];var line=new Line(a,b);var d=a.distance(b);if(line.isDifferentiable()){// has a tangent line (line length is not 0)\nif(length<=l+d){return line.tangentAtLength((fromStart?1:-1)*(length-l));}lastValidLine=line;}l+=d;}// if length requested is higher than the length of the polyline, return last valid endpoint\nif(lastValidLine){var ratio=fromStart?1:0;return lastValidLine.tangentAt(ratio);}// if no valid line, return null\nreturn null;},toString:function(){return this.points+'';},translate:function(tx,ty){var points=this.points;var numPoints=points.length;for(var i=0;i<numPoints;i++){points[i].translate(tx,ty);}return this;},// Return svgString that can be used to recreate this line.\nserialize:function(){var points=this.points;var numPoints=points.length;if(numPoints===0){return'';}// if points array is empty\nvar output='';for(var i=0;i<numPoints;i++){var point=points[i];output+=point.x+','+point.y+' ';}return output.trim();}};Object.defineProperty(Polyline.prototype,'start',{// Getter for the first point of the polyline.\nconfigurable:true,enumerable:true,get:function(){var points=this.points;var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nreturn this.points[0];}});Object.defineProperty(Polyline.prototype,'end',{// Getter for the last point of the polyline.\nconfigurable:true,enumerable:true,get:function(){var points=this.points;var numPoints=points.length;if(numPoints===0){return null;}// if points array is empty\nreturn this.points[numPoints-1];}});var abs$2=Math.abs;var sqrt$2=Math.sqrt;var min$6=Math.min;var max$4=Math.max;var pow$3=Math.pow;var Curve=function(p1,p2,p3,p4){if(!(this instanceof Curve)){return new Curve(p1,p2,p3,p4);}if(p1 instanceof Curve){return new Curve(p1.start,p1.controlPoint1,p1.controlPoint2,p1.end);}this.start=new Point(p1);this.controlPoint1=new Point(p2);this.controlPoint2=new Point(p3);this.end=new Point(p4);};// Curve passing through points.\n// Ported from C# implementation by Oleg V. Polikarpotchkin and Peter Lee (http://www.codeproject.com/KB/graphics/BezierSpline.aspx).\n// @param {array} points Array of points through which the smooth line will go.\n// @return {array} curves.\nCurve.throughPoints=function(){// Get open-ended Bezier Spline Control Points.\n// @param knots Input Knot Bezier spline points (At least two points!).\n// @param firstControlPoints Output First Control points. Array of knots.length - 1 length.\n// @param secondControlPoints Output Second Control points. Array of knots.length - 1 length.\nfunction getCurveControlPoints(knots){var firstControlPoints=[];var secondControlPoints=[];var n=knots.length-1;var i;// Special case: Bezier curve should be a straight line.\nif(n==1){// 3P1 = 2P0 + P3\nfirstControlPoints[0]=new Point((2*knots[0].x+knots[1].x)/3,(2*knots[0].y+knots[1].y)/3);// P2 = 2P1 â P0\nsecondControlPoints[0]=new Point(2*firstControlPoints[0].x-knots[0].x,2*firstControlPoints[0].y-knots[0].y);return[firstControlPoints,secondControlPoints];}// Calculate first Bezier control points.\n// Right hand side vector.\nvar rhs=[];// Set right hand side X values.\nfor(i=1;i<n-1;i++){rhs[i]=4*knots[i].x+2*knots[i+1].x;}rhs[0]=knots[0].x+2*knots[1].x;rhs[n-1]=(8*knots[n-1].x+knots[n].x)/2.0;// Get first control points X-values.\nvar x=getFirstControlPoints(rhs);// Set right hand side Y values.\nfor(i=1;i<n-1;++i){rhs[i]=4*knots[i].y+2*knots[i+1].y;}rhs[0]=knots[0].y+2*knots[1].y;rhs[n-1]=(8*knots[n-1].y+knots[n].y)/2.0;// Get first control points Y-values.\nvar y=getFirstControlPoints(rhs);// Fill output arrays.\nfor(i=0;i<n;i++){// First control point.\nfirstControlPoints.push(new Point(x[i],y[i]));// Second control point.\nif(i<n-1){secondControlPoints.push(new Point(2*knots[i+1].x-x[i+1],2*knots[i+1].y-y[i+1]));}else{secondControlPoints.push(new Point((knots[n].x+x[n-1])/2,(knots[n].y+y[n-1])/2));}}return[firstControlPoints,secondControlPoints];}// Solves a tridiagonal system for one of coordinates (x or y) of first Bezier control points.\n// @param rhs Right hand side vector.\n// @return Solution vector.\nfunction getFirstControlPoints(rhs){var n=rhs.length;// `x` is a solution vector.\nvar x=[];var tmp=[];var b=2.0;x[0]=rhs[0]/b;// Decomposition and forward substitution.\nfor(var i=1;i<n;i++){tmp[i]=1/b;b=(i<n-1?4.0:3.5)-tmp[i];x[i]=(rhs[i]-x[i-1])/b;}for(i=1;i<n;i++){// Backsubstitution.\nx[n-i-1]-=tmp[n-i]*x[n-i];}return x;}return function(points){if(!points||Array.isArray(points)&&points.length<2){throw new Error('At least 2 points are required');}var controlPoints=getCurveControlPoints(points);var curves=[];var n=controlPoints[0].length;for(var i=0;i<n;i++){var controlPoint1=new Point(controlPoints[0][i].x,controlPoints[0][i].y);var controlPoint2=new Point(controlPoints[1][i].x,controlPoints[1][i].y);curves.push(new Curve(points[i],controlPoint1,controlPoint2,points[i+1]));}return curves;};}();Curve.prototype={type:types.Curve,// Returns a bbox that tightly envelops the curve.\nbbox:function(){var start=this.start;var controlPoint1=this.controlPoint1;var controlPoint2=this.controlPoint2;var end=this.end;var x0=start.x;var y0=start.y;var x1=controlPoint1.x;var y1=controlPoint1.y;var x2=controlPoint2.x;var y2=controlPoint2.y;var x3=end.x;var y3=end.y;var points=new Array();// local extremes\nvar tvalues=new Array();// t values of local extremes\nvar bounds=[new Array(),new Array()];var a,b,c,t;var t1,t2;var b2ac,sqrtb2ac;for(var i=0;i<2;++i){if(i===0){b=6*x0-12*x1+6*x2;a=-3*x0+9*x1-9*x2+3*x3;c=3*x1-3*x0;}else{b=6*y0-12*y1+6*y2;a=-3*y0+9*y1-9*y2+3*y3;c=3*y1-3*y0;}if(abs$2(a)<1e-12){// Numerical robustness\nif(abs$2(b)<1e-12){// Numerical robustness\ncontinue;}t=-c/b;if(0<t&&t<1){tvalues.push(t);}continue;}b2ac=b*b-4*c*a;sqrtb2ac=sqrt$2(b2ac);if(b2ac<0){continue;}t1=(-b+sqrtb2ac)/(2*a);if(0<t1&&t1<1){tvalues.push(t1);}t2=(-b-sqrtb2ac)/(2*a);if(0<t2&&t2<1){tvalues.push(t2);}}var j=tvalues.length;var jlen=j;var mt;var x,y;while(j--){t=tvalues[j];mt=1-t;x=mt*mt*mt*x0+3*mt*mt*t*x1+3*mt*t*t*x2+t*t*t*x3;bounds[0][j]=x;y=mt*mt*mt*y0+3*mt*mt*t*y1+3*mt*t*t*y2+t*t*t*y3;bounds[1][j]=y;points[j]={X:x,Y:y};}tvalues[jlen]=0;tvalues[jlen+1]=1;points[jlen]={X:x0,Y:y0};points[jlen+1]={X:x3,Y:y3};bounds[0][jlen]=x0;bounds[1][jlen]=y0;bounds[0][jlen+1]=x3;bounds[1][jlen+1]=y3;tvalues.length=jlen+2;bounds[0].length=jlen+2;bounds[1].length=jlen+2;points.length=jlen+2;var left=min$6.apply(null,bounds[0]);var top=min$6.apply(null,bounds[1]);var right=max$4.apply(null,bounds[0]);var bottom=max$4.apply(null,bounds[1]);return new Rect(left,top,right-left,bottom-top);},clone:function(){return new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end);},// Returns the point on the curve closest to point `p`\nclosestPoint:function(p,opt){return this.pointAtT(this.closestPointT(p,opt));},closestPointLength:function(p,opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;var localOpt={precision:precision,subdivisions:subdivisions};return this.lengthAtT(this.closestPointT(p,localOpt),localOpt);},closestPointNormalizedLength:function(p,opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;var localOpt={precision:precision,subdivisions:subdivisions};var cpLength=this.closestPointLength(p,localOpt);if(!cpLength){return 0;}var length=this.length(localOpt);if(length===0){return 0;}return cpLength/length;},// Returns `t` of the point on the curve closest to point `p`\nclosestPointT:function(p,opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;// does not use localOpt\n// identify the subdivision that contains the point:\nvar investigatedSubdivision;var investigatedSubdivisionStartT;// assume that subdivisions are evenly spaced\nvar investigatedSubdivisionEndT;var distFromStart;// distance of point from start of baseline\nvar distFromEnd;// distance of point from end of baseline\nvar chordLength;// distance between start and end of the subdivision\nvar minSumDist;// lowest observed sum of the two distances\nvar n=subdivisions.length;var subdivisionSize=n?1/n:0;for(var i=0;i<n;i++){var currentSubdivision=subdivisions[i];var startDist=currentSubdivision.start.distance(p);var endDist=currentSubdivision.end.distance(p);var sumDist=startDist+endDist;// check that the point is closest to current subdivision and not any other\nif(!minSumDist||sumDist<minSumDist){investigatedSubdivision=currentSubdivision;investigatedSubdivisionStartT=i*subdivisionSize;investigatedSubdivisionEndT=(i+1)*subdivisionSize;distFromStart=startDist;distFromEnd=endDist;chordLength=currentSubdivision.start.distance(currentSubdivision.end);minSumDist=sumDist;}}var precisionRatio=pow$3(10,-precision);// recursively divide investigated subdivision:\n// until distance between baselinePoint and closest path endpoint is within 10^(-precision)\n// then return the closest endpoint of that final subdivision\nwhile(true){// check if we have reached at least one required observed precision\n// - calculated as: the difference in distances from point to start and end divided by the distance\n// - note that this function is not monotonic = it doesn't converge stably but has \"teeth\"\n// - the function decreases while one of the endpoints is fixed but \"jumps\" whenever we switch\n// - this criterion works well for points lying far away from the curve\nvar startPrecisionRatio=distFromStart?abs$2(distFromStart-distFromEnd)/distFromStart:0;var endPrecisionRatio=distFromEnd?abs$2(distFromStart-distFromEnd)/distFromEnd:0;var hasRequiredPrecision=startPrecisionRatio<precisionRatio||endPrecisionRatio<precisionRatio;// check if we have reached at least one required minimal distance\n// - calculated as: the subdivision chord length multiplied by precisionRatio\n// - calculation is relative so it will work for arbitrarily large/small curves and their subdivisions\n// - this is a backup criterion that works well for points lying \"almost at\" the curve\nvar hasMinimalStartDistance=distFromStart?distFromStart<chordLength*precisionRatio:true;var hasMinimalEndDistance=distFromEnd?distFromEnd<chordLength*precisionRatio:true;var hasMinimalDistance=hasMinimalStartDistance||hasMinimalEndDistance;// do we stop now?\nif(hasRequiredPrecision||hasMinimalDistance){return distFromStart<=distFromEnd?investigatedSubdivisionStartT:investigatedSubdivisionEndT;}// otherwise, set up for next iteration\nvar divided=investigatedSubdivision.divide(0.5);subdivisionSize/=2;var startDist1=divided[0].start.distance(p);var endDist1=divided[0].end.distance(p);var sumDist1=startDist1+endDist1;var startDist2=divided[1].start.distance(p);var endDist2=divided[1].end.distance(p);var sumDist2=startDist2+endDist2;if(sumDist1<=sumDist2){investigatedSubdivision=divided[0];investigatedSubdivisionEndT-=subdivisionSize;// subdivisionSize was already halved\ndistFromStart=startDist1;distFromEnd=endDist1;}else{investigatedSubdivision=divided[1];investigatedSubdivisionStartT+=subdivisionSize;// subdivisionSize was already halved\ndistFromStart=startDist2;distFromEnd=endDist2;}}},closestPointTangent:function(p,opt){return this.tangentAtT(this.closestPointT(p,opt));},// Returns `true` if the area surrounded by the curve contains the point `p`.\n// Implements the even-odd algorithm (self-intersections are \"outside\").\n// Closes open curves (always imagines a closing segment).\n// Precision may be adjusted by passing an `opt` object.\ncontainsPoint:function(p,opt){var polyline=this.toPolyline(opt);return polyline.containsPoint(p);},// Divides the curve into two at requested `ratio` between 0 and 1 with precision better than `opt.precision`; optionally using `opt.subdivisions` provided.\n// For a function that uses `t`, use Curve.divideAtT().\ndivideAt:function(ratio,opt){if(ratio<=0){return this.divideAtT(0);}if(ratio>=1){return this.divideAtT(1);}var t=this.tAt(ratio,opt);return this.divideAtT(t);},// Divides the curve into two at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\ndivideAtLength:function(length,opt){var t=this.tAtLength(length,opt);return this.divideAtT(t);},// Divides the curve into two at point defined by `t` between 0 and 1.\n// Using de Casteljau's algorithm (http://math.stackexchange.com/a/317867).\n// Additional resource: https://pomax.github.io/bezierinfo/#decasteljau\ndivideAtT:function(t){var start=this.start;var controlPoint1=this.controlPoint1;var controlPoint2=this.controlPoint2;var end=this.end;// shortcuts for `t` values that are out of range\nif(t<=0){return[new Curve(start,start,start,start),new Curve(start,controlPoint1,controlPoint2,end)];}if(t>=1){return[new Curve(start,controlPoint1,controlPoint2,end),new Curve(end,end,end,end)];}var dividerPoints=this.getSkeletonPoints(t);var startControl1=dividerPoints.startControlPoint1;var startControl2=dividerPoints.startControlPoint2;var divider=dividerPoints.divider;var dividerControl1=dividerPoints.dividerControlPoint1;var dividerControl2=dividerPoints.dividerControlPoint2;// return array with two new curves\nreturn[new Curve(start,startControl1,startControl2,divider),new Curve(divider,dividerControl1,dividerControl2,end)];},// Returns the distance between the curve's start and end points.\nendpointDistance:function(){return this.start.distance(this.end);},// Checks whether two curves are exactly the same.\nequals:function(c){return!!c&&this.start.x===c.start.x&&this.start.y===c.start.y&&this.controlPoint1.x===c.controlPoint1.x&&this.controlPoint1.y===c.controlPoint1.y&&this.controlPoint2.x===c.controlPoint2.x&&this.controlPoint2.y===c.controlPoint2.y&&this.end.x===c.end.x&&this.end.y===c.end.y;},// Returns five helper points necessary for curve division.\ngetSkeletonPoints:function(t){var start=this.start;var control1=this.controlPoint1;var control2=this.controlPoint2;var end=this.end;// shortcuts for `t` values that are out of range\nif(t<=0){return{startControlPoint1:start.clone(),startControlPoint2:start.clone(),divider:start.clone(),dividerControlPoint1:control1.clone(),dividerControlPoint2:control2.clone()};}if(t>=1){return{startControlPoint1:control1.clone(),startControlPoint2:control2.clone(),divider:end.clone(),dividerControlPoint1:end.clone(),dividerControlPoint2:end.clone()};}var midpoint1=new Line(start,control1).pointAt(t);var midpoint2=new Line(control1,control2).pointAt(t);var midpoint3=new Line(control2,end).pointAt(t);var subControl1=new Line(midpoint1,midpoint2).pointAt(t);var subControl2=new Line(midpoint2,midpoint3).pointAt(t);var divider=new Line(subControl1,subControl2).pointAt(t);var output={startControlPoint1:midpoint1,startControlPoint2:subControl1,divider:divider,dividerControlPoint1:subControl2,dividerControlPoint2:midpoint3};return output;},// Returns a list of curves whose flattened length is better than `opt.precision`.\n// That is, observed difference in length between recursions is less than 10^(-3) = 0.001 = 0.1%\n// (Observed difference is not real precision, but close enough as long as special cases are covered)\n// (That is why skipping iteration 1 is important)\n// As a rule of thumb, increasing `precision` by 1 requires two more division operations\n// - Precision 0 (endpointDistance) - total of 2^0 - 1 = 0 operations (1 subdivision)\n// - Precision 1 (<10% error) - total of 2^2 - 1 = 3 operations (4 subdivisions)\n// - Precision 2 (<1% error) - total of 2^4 - 1 = 15 operations requires 4 division operations on all elements (15 operations total) (16 subdivisions)\n// - Precision 3 (<0.1% error) - total of 2^6 - 1 = 63 operations - acceptable when drawing (64 subdivisions)\n// - Precision 4 (<0.01% error) - total of 2^8 - 1 = 255 operations - high resolution, can be used to interpolate `t` (256 subdivisions)\n// (Variation of 1 recursion worse or better is possible depending on the curve, doubling/halving the number of operations accordingly)\ngetSubdivisions:function(opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;// not using opt.subdivisions\n// not using localOpt\nvar subdivisions=[new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(precision===0){return subdivisions;}var previousLength=this.endpointDistance();var precisionRatio=pow$3(10,-precision);// recursively divide curve at `t = 0.5`\n// until the difference between observed length at subsequent iterations is lower than precision\nvar iteration=0;while(true){iteration+=1;// divide all subdivisions\nvar newSubdivisions=[];var numSubdivisions=subdivisions.length;for(var i=0;i<numSubdivisions;i++){var currentSubdivision=subdivisions[i];var divided=currentSubdivision.divide(0.5);// dividing at t = 0.5 (not at middle length!)\nnewSubdivisions.push(divided[0],divided[1]);}// measure new length\nvar length=0;var numNewSubdivisions=newSubdivisions.length;for(var j=0;j<numNewSubdivisions;j++){var currentNewSubdivision=newSubdivisions[j];length+=currentNewSubdivision.endpointDistance();}// check if we have reached required observed precision\n// sine-like curves may have the same observed length in iteration 0 and 1 - skip iteration 1\n// not a problem for further iterations because cubic curves cannot have more than two local extrema\n// (i.e. cubic curves cannot intersect the baseline more than once)\n// therefore two subsequent iterations cannot produce sampling with equal length\nvar observedPrecisionRatio=length!==0?(length-previousLength)/length:0;if(iteration>1&&observedPrecisionRatio<precisionRatio){return newSubdivisions;}// otherwise, set up for next iteration\nsubdivisions=newSubdivisions;previousLength=length;}},isDifferentiable:function(){var start=this.start;var control1=this.controlPoint1;var control2=this.controlPoint2;var end=this.end;return!(start.equals(control1)&&control1.equals(control2)&&control2.equals(end));},// Returns flattened length of the curve with precision better than `opt.precision`; or using `opt.subdivisions` provided.\nlength:function(opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;// opt.precision only used in getSubdivisions() call\nvar subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;// not using localOpt\nvar length=0;var n=subdivisions.length;for(var i=0;i<n;i++){var currentSubdivision=subdivisions[i];length+=currentSubdivision.endpointDistance();}return length;},// Returns distance along the curve up to `t` with precision better than requested `opt.precision`. (Not using `opt.subdivisions`.)\nlengthAtT:function(t,opt){if(t<=0){return 0;}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;// not using opt.subdivisions\n// not using localOpt\nvar subCurve=this.divide(t)[0];var subCurveLength=subCurve.length({precision:precision});return subCurveLength;},// Returns point at requested `ratio` between 0 and 1 with precision better than `opt.precision`; optionally using `opt.subdivisions` provided.\n// Mirrors Line.pointAt() function.\n// For a function that tracks `t`, use Curve.pointAtT().\npointAt:function(ratio,opt){if(ratio<=0){return this.start.clone();}if(ratio>=1){return this.end.clone();}var t=this.tAt(ratio,opt);return this.pointAtT(t);},// Returns point at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\npointAtLength:function(length,opt){var t=this.tAtLength(length,opt);return this.pointAtT(t);},// Returns the point at provided `t` between 0 and 1.\n// `t` does not track distance along curve as it does in Line objects.\n// Non-linear relationship, speeds up and slows down as curve warps!\n// For linear length-based solution, use Curve.pointAt().\npointAtT:function(t){if(t<=0){return this.start.clone();}if(t>=1){return this.end.clone();}return this.getSkeletonPoints(t).divider;},// Default precision\nPRECISION:3,round:function(precision){this.start.round(precision);this.controlPoint1.round(precision);this.controlPoint2.round(precision);this.end.round(precision);return this;},scale:function(sx,sy,origin){this.start.scale(sx,sy,origin);this.controlPoint1.scale(sx,sy,origin);this.controlPoint2.scale(sx,sy,origin);this.end.scale(sx,sy,origin);return this;},// Returns a tangent line at requested `ratio` with precision better than requested `opt.precision`; or using `opt.subdivisions` provided.\ntangentAt:function(ratio,opt){if(!this.isDifferentiable()){return null;}if(ratio<0){ratio=0;}else if(ratio>1){ratio=1;}var t=this.tAt(ratio,opt);return this.tangentAtT(t);},// Returns a tangent line at requested `length` with precision better than requested `opt.precision`; or using `opt.subdivisions` provided.\ntangentAtLength:function(length,opt){if(!this.isDifferentiable()){return null;}var t=this.tAtLength(length,opt);return this.tangentAtT(t);},// Returns a tangent line at requested `t`.\ntangentAtT:function(t){if(!this.isDifferentiable()){return null;}if(t<0){t=0;}else if(t>1){t=1;}var skeletonPoints=this.getSkeletonPoints(t);var p1=skeletonPoints.startControlPoint2;var p2=skeletonPoints.dividerControlPoint1;var tangentStart=skeletonPoints.divider;var tangentLine=new Line(p1,p2);tangentLine.translate(tangentStart.x-p1.x,tangentStart.y-p1.y);// move so that tangent line starts at the point requested\nreturn tangentLine;},// Returns `t` at requested `ratio` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\ntAt:function(ratio,opt){if(ratio<=0){return 0;}if(ratio>=1){return 1;}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;var localOpt={precision:precision,subdivisions:subdivisions};var curveLength=this.length(localOpt);var length=curveLength*ratio;return this.tAtLength(length,localOpt);},// Returns `t` at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\n// Uses `precision` to approximate length within `precision` (always underestimates)\n// Then uses a binary search to find the `t` of a subdivision endpoint that is close (within `precision`) to the `length`, if the curve was as long as approximated\n// As a rule of thumb, increasing `precision` by 1 causes the algorithm to go 2^(precision - 1) deeper\n// - Precision 0 (chooses one of the two endpoints) - 0 levels\n// - Precision 1 (chooses one of 5 points, <10% error) - 1 level\n// - Precision 2 (<1% error) - 3 levels\n// - Precision 3 (<0.1% error) - 7 levels\n// - Precision 4 (<0.01% error) - 15 levels\ntAtLength:function(length,opt){var fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;var localOpt={precision:precision,subdivisions:subdivisions};// identify the subdivision that contains the point at requested `length`:\nvar investigatedSubdivision;var investigatedSubdivisionStartT;// assume that subdivisions are evenly spaced\nvar investigatedSubdivisionEndT;//var baseline; // straightened version of subdivision to investigate\n//var baselinePoint; // point on the baseline that is the requested distance away from start\nvar baselinePointDistFromStart;// distance of baselinePoint from start of baseline\nvar baselinePointDistFromEnd;// distance of baselinePoint from end of baseline\nvar l=0;// length so far\nvar n=subdivisions.length;var subdivisionSize=1/n;for(var i=0;i<n;i++){var index=fromStart?i:n-1-i;var currentSubdivision=subdivisions[i];var d=currentSubdivision.endpointDistance();// length of current subdivision\nif(length<=l+d){investigatedSubdivision=currentSubdivision;investigatedSubdivisionStartT=index*subdivisionSize;investigatedSubdivisionEndT=(index+1)*subdivisionSize;baselinePointDistFromStart=fromStart?length-l:d+l-length;baselinePointDistFromEnd=fromStart?d+l-length:length-l;break;}l+=d;}if(!investigatedSubdivision){return fromStart?1:0;}// length requested is out of range - return maximum t\n// note that precision affects what length is recorded\n// (imprecise measurements underestimate length by up to 10^(-precision) of the precise length)\n// e.g. at precision 1, the length may be underestimated by up to 10% and cause this function to return 1\nvar curveLength=this.length(localOpt);var precisionRatio=pow$3(10,-precision);// recursively divide investigated subdivision:\n// until distance between baselinePoint and closest path endpoint is within 10^(-precision)\n// then return the closest endpoint of that final subdivision\nwhile(true){// check if we have reached required observed precision\nvar observedPrecisionRatio;observedPrecisionRatio=curveLength!==0?baselinePointDistFromStart/curveLength:0;if(observedPrecisionRatio<precisionRatio){return investigatedSubdivisionStartT;}observedPrecisionRatio=curveLength!==0?baselinePointDistFromEnd/curveLength:0;if(observedPrecisionRatio<precisionRatio){return investigatedSubdivisionEndT;}// otherwise, set up for next iteration\nvar newBaselinePointDistFromStart;var newBaselinePointDistFromEnd;var divided=investigatedSubdivision.divide(0.5);subdivisionSize/=2;var baseline1Length=divided[0].endpointDistance();var baseline2Length=divided[1].endpointDistance();if(baselinePointDistFromStart<=baseline1Length){// point at requested length is inside divided[0]\ninvestigatedSubdivision=divided[0];investigatedSubdivisionEndT-=subdivisionSize;// sudivisionSize was already halved\nnewBaselinePointDistFromStart=baselinePointDistFromStart;newBaselinePointDistFromEnd=baseline1Length-newBaselinePointDistFromStart;}else{// point at requested length is inside divided[1]\ninvestigatedSubdivision=divided[1];investigatedSubdivisionStartT+=subdivisionSize;// subdivisionSize was already halved\nnewBaselinePointDistFromStart=baselinePointDistFromStart-baseline1Length;newBaselinePointDistFromEnd=baseline2Length-newBaselinePointDistFromStart;}baselinePointDistFromStart=newBaselinePointDistFromStart;baselinePointDistFromEnd=newBaselinePointDistFromEnd;}},// Returns an array of points that represents the curve when flattened, up to `opt.precision`; or using `opt.subdivisions` provided.\n// Flattened length is no more than 10^(-precision) away from real curve length.\ntoPoints:function(opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;// opt.precision only used in getSubdivisions() call\nvar subdivisions=opt.subdivisions===undefined?this.getSubdivisions({precision:precision}):opt.subdivisions;// not using localOpt\nvar points=[subdivisions[0].start.clone()];var n=subdivisions.length;for(var i=0;i<n;i++){var currentSubdivision=subdivisions[i];points.push(currentSubdivision.end.clone());}return points;},// Returns a polyline that represents the curve when flattened, up to `opt.precision`; or using `opt.subdivisions` provided.\n// Flattened length is no more than 10^(-precision) away from real curve length.\ntoPolyline:function(opt){return new Polyline(this.toPoints(opt));},toString:function(){return this.start+' '+this.controlPoint1+' '+this.controlPoint2+' '+this.end;},translate:function(tx,ty){this.start.translate(tx,ty);this.controlPoint1.translate(tx,ty);this.controlPoint2.translate(tx,ty);this.end.translate(tx,ty);return this;}};Curve.prototype.divide=Curve.prototype.divideAtT;// Local helper function.\n// Add properties from arguments on top of properties from `obj`.\n// This allows for rudimentary inheritance.\n// - The `obj` argument acts as parent.\n// - This function creates a new object that inherits all `obj` properties and adds/replaces those that are present in arguments.\n// - A high-level example: calling `extend(Vehicle, Car)` would be akin to declaring `class Car extends Vehicle`.\nfunction extend(obj){var arguments$1=arguments;// In JavaScript, the combination of a constructor function (e.g. `g.Line = function(...) {...}`) and prototype (e.g. `g.Line.prototype = {...}) is akin to a C++ class.\n// - When inheritance is not necessary, we can leave it at that. (This would be akin to calling extend with only `obj`.)\n// - But, what if we wanted the `g.Line` quasiclass to inherit from another quasiclass (let's call it `g.GeometryObject`) in JavaScript?\n// - First, realize that both of those quasiclasses would still have their own separate constructor function.\n// - So what we are actually saying is that we want the `g.Line` prototype to inherit from `g.GeometryObject` prototype.\n// - This method provides a way to do exactly that.\n// - It copies parent prototype's properties, then adds extra ones from child prototype/overrides parent prototype properties with child prototype properties.\n// - Therefore, to continue with the example above:\n//   - `g.Line.prototype = extend(g.GeometryObject.prototype, linePrototype)`\n//   - Where `linePrototype` is a properties object that looks just like `g.Line.prototype` does right now.\n//   - Then, `g.Line` would allow the programmer to access to all methods currently in `g.Line.Prototype`, plus any non-overridden methods from `g.GeometryObject.prototype`.\n//   - In that aspect, `g.GeometryObject` would then act like the parent of `g.Line`.\n// - Multiple inheritance is also possible, if multiple arguments are provided.\n// - What if we wanted to add another level of abstraction between `g.GeometryObject` and `g.Line` (let's call it `g.LinearObject`)?\n//   - `g.Line.prototype = extend(g.GeometryObject.prototype, g.LinearObject.prototype, linePrototype)`\n//   - The ancestors are applied in order of appearance.\n//   - That means that `g.Line` would have inherited from `g.LinearObject` that would have inherited from `g.GeometryObject`.\n//   - Any number of ancestors may be provided.\n// - Note that neither `obj` nor any of the arguments need to actually be prototypes of any JavaScript quasiclass, that was just a simplified explanation.\n// - We can create a new object composed from the properties of any number of other objects (since they do not have a constructor, we can think of those as interfaces).\n//   - `extend({ a: 1, b: 2 }, { b: 10, c: 20 }, { c: 100, d: 200 })` gives `{ a: 1, b: 10, c: 100, d: 200 }`.\n//   - Basically, with this function, we can emulate the `extends` keyword as well as the `implements` keyword.\n// - Therefore, both of the following are valid:\n//   - `Lineto.prototype = extend(Line.prototype, segmentPrototype, linetoPrototype)`\n//   - `Moveto.prototype = extend(segmentPrototype, movetoPrototype)`\nvar i;var n;var args=[];n=arguments.length;for(i=1;i<n;i++){// skip over obj\nargs.push(arguments$1[i]);}if(!obj){throw new Error('Missing a parent object.');}var child=Object.create(obj);n=args.length;for(i=0;i<n;i++){var src=args[i];var inheritedProperty;var key;for(key in src){if(src.hasOwnProperty(key)){delete child[key];// delete property inherited from parent\ninheritedProperty=Object.getOwnPropertyDescriptor(src,key);// get new definition of property from src\nObject.defineProperty(child,key,inheritedProperty);// re-add property with new definition (includes getter/setter methods)\n}}}return child;}// Accepts path data string, array of segments, array of Curves and/or Lines, or a Polyline.\nvar Path=function(arg){if(!(this instanceof Path)){return new Path(arg);}if(typeof arg==='string'){// create from a path data string\nreturn new Path.parse(arg);}this.segments=[];var i;var n;if(!arg){// don't do anything\n}else if(Array.isArray(arg)&&arg.length!==0){// if arg is a non-empty array\n// flatten one level deep\n// so we can chain arbitrary Path.createSegment results\narg=arg.reduce(function(acc,val){return acc.concat(val);},[]);n=arg.length;if(arg[0].isSegment){// create from an array of segments\nfor(i=0;i<n;i++){var segment=arg[i];this.appendSegment(segment);}}else{// create from an array of Curves and/or Lines\nvar previousObj=null;for(i=0;i<n;i++){var obj=arg[i];if(!(obj instanceof Line||obj instanceof Curve)){throw new Error('Cannot construct a path segment from the provided object.');}if(i===0){this.appendSegment(Path.createSegment('M',obj.start));}// if objects do not link up, moveto segments are inserted to cover the gaps\nif(previousObj&&!previousObj.end.equals(obj.start)){this.appendSegment(Path.createSegment('M',obj.start));}if(obj instanceof Line){this.appendSegment(Path.createSegment('L',obj.end));}else if(obj instanceof Curve){this.appendSegment(Path.createSegment('C',obj.controlPoint1,obj.controlPoint2,obj.end));}previousObj=obj;}}}else if(arg.isSegment){// create from a single segment\nthis.appendSegment(arg);}else if(arg instanceof Line){// create from a single Line\nthis.appendSegment(Path.createSegment('M',arg.start));this.appendSegment(Path.createSegment('L',arg.end));}else if(arg instanceof Curve){// create from a single Curve\nthis.appendSegment(Path.createSegment('M',arg.start));this.appendSegment(Path.createSegment('C',arg.controlPoint1,arg.controlPoint2,arg.end));}else if(arg instanceof Polyline){// create from a Polyline\nif(!(arg.points&&arg.points.length!==0)){return;}// if Polyline has no points, leave Path empty\nn=arg.points.length;for(i=0;i<n;i++){var point=arg.points[i];if(i===0){this.appendSegment(Path.createSegment('M',point));}else{this.appendSegment(Path.createSegment('L',point));}}}else{// unknown object\nthrow new Error('Cannot construct a path from the provided object.');}};// More permissive than V.normalizePathData and Path.prototype.serialize.\n// Allows path data strings that do not start with a Moveto command (unlike SVG specification).\n// Does not require spaces between elements; commas are allowed, separators may be omitted when unambiguous (e.g. 'ZM10,10', 'L1.6.8', 'M100-200').\n// Allows for command argument chaining.\n// Throws an error if wrong number of arguments is provided with a command.\n// Throws an error if an unrecognized path command is provided (according to Path.segmentTypes). Only a subset of SVG commands is currently supported (L, C, M, Z).\nPath.parse=function(pathData){if(!pathData){return new Path();}var path=new Path();var commandRe=/(?:[a-zA-Z] *)(?:(?:-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)? *,? *)|(?:-?\\.\\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\\d|-|\\.)/g;var commands=pathData.match(commandRe);var numCommands=commands.length;for(var i=0;i<numCommands;i++){var command=commands[i];var argRe=/(?:[a-zA-Z])|(?:(?:-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))|(?:(?:-?\\.\\d+))/g;var args=command.match(argRe);var segment=Path.createSegment.apply(this,args);// args = [type, coordinate1, coordinate2...]\npath.appendSegment(segment);}return path;};// Create a segment or an array of segments.\n// Accepts unlimited points/coords arguments after `type`.\nPath.createSegment=function(type){var arguments$1=arguments;if(!type){throw new Error('Type must be provided.');}var segmentConstructor=Path.segmentTypes[type];if(!segmentConstructor){throw new Error(type+' is not a recognized path segment type.');}var args=[];var n=arguments.length;for(var i=1;i<n;i++){// do not add first element (`type`) to args array\nargs.push(arguments$1[i]);}return applyToNew(segmentConstructor,args);};Path.prototype={type:types.Path,// Accepts one segment or an array of segments as argument.\n// Throws an error if argument is not a segment or an array of segments.\nappendSegment:function(arg){var segments=this.segments;var numSegments=segments.length;// works even if path has no segments\nvar currentSegment;var previousSegment=numSegments!==0?segments[numSegments-1]:null;// if we are appending to an empty path, previousSegment is null\nvar nextSegment=null;if(!Array.isArray(arg)){// arg is a segment\nif(!arg||!arg.isSegment){throw new Error('Segment required.');}currentSegment=this.prepareSegment(arg,previousSegment,nextSegment);segments.push(currentSegment);}else{// arg is an array of segments\n// flatten one level deep\n// so we can chain arbitrary Path.createSegment results\narg=arg.reduce(function(acc,val){return acc.concat(val);},[]);if(!arg[0].isSegment){throw new Error('Segments required.');}var n=arg.length;for(var i=0;i<n;i++){var currentArg=arg[i];currentSegment=this.prepareSegment(currentArg,previousSegment,nextSegment);segments.push(currentSegment);previousSegment=currentSegment;}}},// Returns the bbox of the path.\n// If path has no segments, returns null.\n// If path has only invisible segments, returns bbox of the end point of last segment.\nbbox:function(){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nvar bbox;for(var i=0;i<numSegments;i++){var segment=segments[i];if(segment.isVisible){var segmentBBox=segment.bbox();bbox=bbox?bbox.union(segmentBBox):segmentBBox;}}if(bbox){return bbox;}// if the path has only invisible elements, return end point of last segment\nvar lastSegment=segments[numSegments-1];return new Rect(lastSegment.end.x,lastSegment.end.y,0,0);},// Returns a new path that is a clone of this path.\nclone:function(){var segments=this.segments;var numSegments=segments.length;// works even if path has no segments\nvar path=new Path();for(var i=0;i<numSegments;i++){var segment=segments[i].clone();path.appendSegment(segment);}return path;},closestPoint:function(p,opt){var t=this.closestPointT(p,opt);if(!t){return null;}return this.pointAtT(t);},closestPointLength:function(p,opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var localOpt={precision:precision,segmentSubdivisions:segmentSubdivisions};var t=this.closestPointT(p,localOpt);if(!t){return 0;}return this.lengthAtT(t,localOpt);},closestPointNormalizedLength:function(p,opt){opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var localOpt={precision:precision,segmentSubdivisions:segmentSubdivisions};var cpLength=this.closestPointLength(p,localOpt);if(cpLength===0){return 0;}// shortcut\nvar length=this.length(localOpt);if(length===0){return 0;}// prevents division by zero\nreturn cpLength/length;},// Private function.\nclosestPointT:function(p,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nopt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar closestPointT;var minSquaredDistance=Infinity;for(var i=0;i<numSegments;i++){var segment=segments[i];var subdivisions=segmentSubdivisions[i];if(segment.isVisible){var segmentClosestPointT=segment.closestPointT(p,{precision:precision,subdivisions:subdivisions});var segmentClosestPoint=segment.pointAtT(segmentClosestPointT);var squaredDistance=new Line(segmentClosestPoint,p).squaredLength();if(squaredDistance<minSquaredDistance){closestPointT={segmentIndex:i,value:segmentClosestPointT};minSquaredDistance=squaredDistance;}}}if(closestPointT){return closestPointT;}// if no visible segment, return end of last segment\nreturn{segmentIndex:numSegments-1,value:1};},closestPointTangent:function(p,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nopt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar closestPointTangent;var minSquaredDistance=Infinity;for(var i=0;i<numSegments;i++){var segment=segments[i];var subdivisions=segmentSubdivisions[i];if(segment.isDifferentiable()){var segmentClosestPointT=segment.closestPointT(p,{precision:precision,subdivisions:subdivisions});var segmentClosestPoint=segment.pointAtT(segmentClosestPointT);var squaredDistance=new Line(segmentClosestPoint,p).squaredLength();if(squaredDistance<minSquaredDistance){closestPointTangent=segment.tangentAtT(segmentClosestPointT);minSquaredDistance=squaredDistance;}}}if(closestPointTangent){return closestPointTangent;}// if no valid segment, return null\nreturn null;},// Returns `true` if the area surrounded by the path contains the point `p`.\n// Implements the even-odd algorithm (self-intersections are \"outside\").\n// Closes open paths (always imagines a final closing segment).\n// Precision may be adjusted by passing an `opt` object.\ncontainsPoint:function(p,opt){var polylines=this.toPolylines(opt);if(!polylines){return false;}// shortcut (this path has no polylines)\nvar numPolylines=polylines.length;// how many component polylines does `p` lie within?\nvar numIntersections=0;for(var i=0;i<numPolylines;i++){var polyline=polylines[i];if(polyline.containsPoint(p)){// `p` lies within this polyline\nnumIntersections++;}}// returns `true` for odd numbers of intersections (even-odd algorithm)\nreturn numIntersections%2===1;},// Divides the path into two at requested `ratio` between 0 and 1 with precision better than `opt.precision`; optionally using `opt.subdivisions` provided.\ndivideAt:function(ratio,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nif(ratio<0){ratio=0;}if(ratio>1){ratio=1;}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var localOpt={precision:precision,segmentSubdivisions:segmentSubdivisions};var pathLength=this.length(localOpt);var length=pathLength*ratio;return this.divideAtLength(length,localOpt);},// Divides the path into two at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\ndivideAtLength:function(length,opt){var numSegments=this.segments.length;if(numSegments===0){return null;}// if segments is an empty array\nvar fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar i;var segment;// identify the segment to divide:\nvar l=0;// length so far\nvar divided;var dividedSegmentIndex;var lastValidSegment;// visible AND differentiable\nvar lastValidSegmentIndex;var t;for(i=0;i<numSegments;i++){var index=fromStart?i:numSegments-1-i;segment=this.getSegment(index);var subdivisions=segmentSubdivisions[index];var d=segment.length({precision:precision,subdivisions:subdivisions});if(segment.isDifferentiable()){// segment is not just a point\nlastValidSegment=segment;lastValidSegmentIndex=index;if(length<=l+d){dividedSegmentIndex=index;divided=segment.divideAtLength((fromStart?1:-1)*(length-l),{precision:precision,subdivisions:subdivisions});break;}}l+=d;}if(!lastValidSegment){// no valid segment found\nreturn null;}// else: the path contains at least one valid segment\nif(!divided){// the desired length is greater than the length of the path\ndividedSegmentIndex=lastValidSegmentIndex;t=fromStart?1:0;divided=lastValidSegment.divideAtT(t);}// create a copy of this path and replace the identified segment with its two divided parts:\nvar pathCopy=this.clone();pathCopy.replaceSegment(dividedSegmentIndex,divided);var divisionStartIndex=dividedSegmentIndex;var divisionMidIndex=dividedSegmentIndex+1;var divisionEndIndex=dividedSegmentIndex+2;// do not insert the part if it looks like a point\nif(!divided[0].isDifferentiable()){pathCopy.removeSegment(divisionStartIndex);divisionMidIndex-=1;divisionEndIndex-=1;}// insert a Moveto segment to ensure secondPath will be valid:\nvar movetoEnd=pathCopy.getSegment(divisionMidIndex).start;pathCopy.insertSegment(divisionMidIndex,Path.createSegment('M',movetoEnd));divisionEndIndex+=1;// do not insert the part if it looks like a point\nif(!divided[1].isDifferentiable()){pathCopy.removeSegment(divisionEndIndex-1);divisionEndIndex-=1;}// ensure that Closepath segments in secondPath will be assigned correct subpathStartSegment:\nvar secondPathSegmentIndexConversion=divisionEndIndex-divisionStartIndex-1;for(i=divisionEndIndex;i<pathCopy.segments.length;i++){var originalSegment=this.getSegment(i-secondPathSegmentIndexConversion);segment=pathCopy.getSegment(i);if(segment.type==='Z'&&!originalSegment.subpathStartSegment.end.equals(segment.subpathStartSegment.end)){// pathCopy segment's subpathStartSegment is different from original segment's one\n// convert this Closepath segment to a Lineto and replace it in pathCopy\nvar convertedSegment=Path.createSegment('L',originalSegment.end);pathCopy.replaceSegment(i,convertedSegment);}}// distribute pathCopy segments into two paths and return those:\nvar firstPath=new Path(pathCopy.segments.slice(0,divisionMidIndex));var secondPath=new Path(pathCopy.segments.slice(divisionMidIndex));return[firstPath,secondPath];},// Checks whether two paths are exactly the same.\n// If `p` is undefined or null, returns false.\nequals:function(p){if(!p){return false;}var segments=this.segments;var otherSegments=p.segments;var numSegments=segments.length;if(otherSegments.length!==numSegments){return false;}// if the two paths have different number of segments, they cannot be equal\nfor(var i=0;i<numSegments;i++){var segment=segments[i];var otherSegment=otherSegments[i];// as soon as an inequality is found in segments, return false\nif(segment.type!==otherSegment.type||!segment.equals(otherSegment)){return false;}}// if no inequality found in segments, return true\nreturn true;},// Accepts negative indices.\n// Throws an error if path has no segments.\n// Throws an error if index is out of range.\ngetSegment:function(index){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){throw new Error('Path has no segments.');}if(index<0){index=numSegments+index;}// convert negative indices to positive\nif(index>=numSegments||index<0){throw new Error('Index out of range.');}return segments[index];},// Returns an array of segment subdivisions, with precision better than requested `opt.precision`.\ngetSegmentSubdivisions:function(opt){var segments=this.segments;var numSegments=segments.length;// works even if path has no segments\nopt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;// not using opt.segmentSubdivisions\n// not using localOpt\nvar segmentSubdivisions=[];for(var i=0;i<numSegments;i++){var segment=segments[i];var subdivisions=segment.getSubdivisions({precision:precision});segmentSubdivisions.push(subdivisions);}return segmentSubdivisions;},// Returns an array of subpaths of this path.\n// Invalid paths are validated first.\n// Returns `[]` if path has no segments.\ngetSubpaths:function(){var validatedPath=this.clone().validate();var segments=validatedPath.segments;var numSegments=segments.length;var subpaths=[];for(var i=0;i<numSegments;i++){var segment=segments[i];if(segment.isSubpathStart){// we encountered a subpath start segment\n// create a new path for segment, and push it to list of subpaths\nsubpaths.push(new Path(segment));}else{// append current segment to the last subpath\nsubpaths[subpaths.length-1].appendSegment(segment);}}return subpaths;},// Insert `arg` at given `index`.\n// `index = 0` means insert at the beginning.\n// `index = segments.length` means insert at the end.\n// Accepts negative indices, from `-1` to `-(segments.length + 1)`.\n// Accepts one segment or an array of segments as argument.\n// Throws an error if index is out of range.\n// Throws an error if argument is not a segment or an array of segments.\ninsertSegment:function(index,arg){var segments=this.segments;var numSegments=segments.length;// works even if path has no segments\n// note that these are incremented compared to getSegments()\n// we can insert after last element (note that this changes the meaning of index -1)\nif(index<0){index=numSegments+index+1;}// convert negative indices to positive\nif(index>numSegments||index<0){throw new Error('Index out of range.');}var currentSegment;var previousSegment=null;var nextSegment=null;if(numSegments!==0){if(index>=1){previousSegment=segments[index-1];nextSegment=previousSegment.nextSegment;// if we are inserting at end, nextSegment is null\n}else{// if index === 0\n// previousSegment is null\nnextSegment=segments[0];}}if(!Array.isArray(arg)){if(!arg||!arg.isSegment){throw new Error('Segment required.');}currentSegment=this.prepareSegment(arg,previousSegment,nextSegment);segments.splice(index,0,currentSegment);}else{// flatten one level deep\n// so we can chain arbitrary Path.createSegment results\narg=arg.reduce(function(acc,val){return acc.concat(val);},[]);if(!arg[0].isSegment){throw new Error('Segments required.');}var n=arg.length;for(var i=0;i<n;i++){var currentArg=arg[i];currentSegment=this.prepareSegment(currentArg,previousSegment,nextSegment);segments.splice(index+i,0,currentSegment);// incrementing index to insert subsequent segments after inserted segments\npreviousSegment=currentSegment;}}},intersectionWithLine:function(line,opt){var intersection=null;var polylines=this.toPolylines(opt);if(!polylines){return null;}for(var i=0,n=polylines.length;i<n;i++){var polyline=polylines[i];var polylineIntersection=line.intersect(polyline);if(polylineIntersection){intersection||(intersection=[]);if(Array.isArray(polylineIntersection)){Array.prototype.push.apply(intersection,polylineIntersection);}else{intersection.push(polylineIntersection);}}}return intersection;},isDifferentiable:function(){var segments=this.segments;var numSegments=segments.length;for(var i=0;i<numSegments;i++){var segment=segments[i];// as soon as a differentiable segment is found in segments, return true\nif(segment.isDifferentiable()){return true;}}// if no differentiable segment is found in segments, return false\nreturn false;},// Checks whether current path segments are valid.\n// Note that d is allowed to be empty - should disable rendering of the path.\nisValid:function(){var segments=this.segments;var isValid=segments.length===0||segments[0].type==='M';// either empty or first segment is a Moveto\nreturn isValid;},// Returns length of the path, with precision better than requested `opt.precision`; or using `opt.segmentSubdivisions` provided.\n// If path has no segments, returns 0.\nlength:function(opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return 0;}// if segments is an empty array\nopt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;// opt.precision only used in getSegmentSubdivisions() call\nvar segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar length=0;for(var i=0;i<numSegments;i++){var segment=segments[i];var subdivisions=segmentSubdivisions[i];length+=segment.length({subdivisions:subdivisions});}return length;},// Private function.\nlengthAtT:function(t,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return 0;}// if segments is an empty array\nvar segmentIndex=t.segmentIndex;if(segmentIndex<0){return 0;}// regardless of t.value\nvar tValue=t.value;if(segmentIndex>=numSegments){segmentIndex=numSegments-1;tValue=1;}else if(tValue<0){tValue=0;}else if(tValue>1){tValue=1;}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar subdivisions;var length=0;for(var i=0;i<segmentIndex;i++){var segment=segments[i];subdivisions=segmentSubdivisions[i];length+=segment.length({precisison:precision,subdivisions:subdivisions});}segment=segments[segmentIndex];subdivisions=segmentSubdivisions[segmentIndex];length+=segment.lengthAtT(tValue,{precisison:precision,subdivisions:subdivisions});return length;},// Returns point at requested `ratio` between 0 and 1, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\npointAt:function(ratio,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nif(ratio<=0){return this.start.clone();}if(ratio>=1){return this.end.clone();}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var localOpt={precision:precision,segmentSubdivisions:segmentSubdivisions};var pathLength=this.length(localOpt);var length=pathLength*ratio;return this.pointAtLength(length,localOpt);},// Returns point at requested `length`, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\n// Accepts negative length.\npointAtLength:function(length,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nif(length===0){return this.start.clone();}var fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar lastVisibleSegment;var l=0;// length so far\nfor(var i=0;i<numSegments;i++){var index=fromStart?i:numSegments-1-i;var segment=segments[index];var subdivisions=segmentSubdivisions[index];var d=segment.length({precision:precision,subdivisions:subdivisions});if(segment.isVisible){if(length<=l+d){return segment.pointAtLength((fromStart?1:-1)*(length-l),{precision:precision,subdivisions:subdivisions});}lastVisibleSegment=segment;}l+=d;}// if length requested is higher than the length of the path, return last visible segment endpoint\nif(lastVisibleSegment){return fromStart?lastVisibleSegment.end:lastVisibleSegment.start;}// if no visible segment, return last segment end point (no matter if fromStart or no)\nvar lastSegment=segments[numSegments-1];return lastSegment.end.clone();},// Private function.\npointAtT:function(t){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nvar segmentIndex=t.segmentIndex;if(segmentIndex<0){return segments[0].pointAtT(0);}if(segmentIndex>=numSegments){return segments[numSegments-1].pointAtT(1);}var tValue=t.value;if(tValue<0){tValue=0;}else if(tValue>1){tValue=1;}return segments[segmentIndex].pointAtT(tValue);},// Default precision\nPRECISION:3,// Helper method for adding segments.\nprepareSegment:function(segment,previousSegment,nextSegment){// insert after previous segment and before previous segment's next segment\nsegment.previousSegment=previousSegment;segment.nextSegment=nextSegment;if(previousSegment){previousSegment.nextSegment=segment;}if(nextSegment){nextSegment.previousSegment=segment;}var updateSubpathStart=segment;if(segment.isSubpathStart){segment.subpathStartSegment=segment;// assign self as subpath start segment\nupdateSubpathStart=nextSegment;// start updating from next segment\n}// assign previous segment's subpath start (or self if it is a subpath start) to subsequent segments\nif(updateSubpathStart){this.updateSubpathStartSegment(updateSubpathStart);}return segment;},// Remove the segment at `index`.\n// Accepts negative indices, from `-1` to `-segments.length`.\n// Throws an error if path has no segments.\n// Throws an error if index is out of range.\nremoveSegment:function(index){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){throw new Error('Path has no segments.');}if(index<0){index=numSegments+index;}// convert negative indices to positive\nif(index>=numSegments||index<0){throw new Error('Index out of range.');}var removedSegment=segments.splice(index,1)[0];var previousSegment=removedSegment.previousSegment;var nextSegment=removedSegment.nextSegment;// link the previous and next segments together (if present)\nif(previousSegment){previousSegment.nextSegment=nextSegment;}// may be null\nif(nextSegment){nextSegment.previousSegment=previousSegment;}// may be null\n// if removed segment used to start a subpath, update all subsequent segments until another subpath start segment is reached\nif(removedSegment.isSubpathStart&&nextSegment){this.updateSubpathStartSegment(nextSegment);}},// Replace the segment at `index` with `arg`.\n// Accepts negative indices, from `-1` to `-segments.length`.\n// Accepts one segment or an array of segments as argument.\n// Throws an error if path has no segments.\n// Throws an error if index is out of range.\n// Throws an error if argument is not a segment or an array of segments.\nreplaceSegment:function(index,arg){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){throw new Error('Path has no segments.');}if(index<0){index=numSegments+index;}// convert negative indices to positive\nif(index>=numSegments||index<0){throw new Error('Index out of range.');}var currentSegment;var replacedSegment=segments[index];var previousSegment=replacedSegment.previousSegment;var nextSegment=replacedSegment.nextSegment;var updateSubpathStart=replacedSegment.isSubpathStart;// boolean: is an update of subpath starts necessary?\nif(!Array.isArray(arg)){if(!arg||!arg.isSegment){throw new Error('Segment required.');}currentSegment=this.prepareSegment(arg,previousSegment,nextSegment);segments.splice(index,1,currentSegment);// directly replace\nif(updateSubpathStart&&currentSegment.isSubpathStart){updateSubpathStart=false;}// already updated by `prepareSegment`\n}else{// flatten one level deep\n// so we can chain arbitrary Path.createSegment results\narg=arg.reduce(function(acc,val){return acc.concat(val);},[]);if(!arg[0].isSegment){throw new Error('Segments required.');}segments.splice(index,1);var n=arg.length;for(var i=0;i<n;i++){var currentArg=arg[i];currentSegment=this.prepareSegment(currentArg,previousSegment,nextSegment);segments.splice(index+i,0,currentSegment);// incrementing index to insert subsequent segments after inserted segments\npreviousSegment=currentSegment;if(updateSubpathStart&&currentSegment.isSubpathStart){updateSubpathStart=false;}// already updated by `prepareSegment`\n}}// if replaced segment used to start a subpath and no new subpath start was added, update all subsequent segments until another subpath start segment is reached\nif(updateSubpathStart&&nextSegment){this.updateSubpathStartSegment(nextSegment);}},round:function(precision){var segments=this.segments;var numSegments=segments.length;for(var i=0;i<numSegments;i++){var segment=segments[i];segment.round(precision);}return this;},scale:function(sx,sy,origin){var segments=this.segments;var numSegments=segments.length;for(var i=0;i<numSegments;i++){var segment=segments[i];segment.scale(sx,sy,origin);}return this;},segmentAt:function(ratio,opt){var index=this.segmentIndexAt(ratio,opt);if(!index){return null;}return this.getSegment(index);},// Accepts negative length.\nsegmentAtLength:function(length,opt){var index=this.segmentIndexAtLength(length,opt);if(!index){return null;}return this.getSegment(index);},segmentIndexAt:function(ratio,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nif(ratio<0){ratio=0;}if(ratio>1){ratio=1;}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var localOpt={precision:precision,segmentSubdivisions:segmentSubdivisions};var pathLength=this.length(localOpt);var length=pathLength*ratio;return this.segmentIndexAtLength(length,localOpt);},// Accepts negative length.\nsegmentIndexAtLength:function(length,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nvar fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar lastVisibleSegmentIndex=null;var l=0;// length so far\nfor(var i=0;i<numSegments;i++){var index=fromStart?i:numSegments-1-i;var segment=segments[index];var subdivisions=segmentSubdivisions[index];var d=segment.length({precision:precision,subdivisions:subdivisions});if(segment.isVisible){if(length<=l+d){return index;}lastVisibleSegmentIndex=index;}l+=d;}// if length requested is higher than the length of the path, return last visible segment index\n// if no visible segment, return null\nreturn lastVisibleSegmentIndex;},// Returns a string that can be used to reconstruct the path.\n// Additional error checking compared to toString (must start with M segment).\nserialize:function(){if(!this.isValid()){throw new Error('Invalid path segments.');}return this.toString();},// Returns tangent line at requested `ratio` between 0 and 1, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\ntangentAt:function(ratio,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nif(ratio<0){ratio=0;}if(ratio>1){ratio=1;}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var localOpt={precision:precision,segmentSubdivisions:segmentSubdivisions};var pathLength=this.length(localOpt);var length=pathLength*ratio;return this.tangentAtLength(length,localOpt);},// Returns tangent line at requested `length`, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\n// Accepts negative length.\ntangentAtLength:function(length,opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nvar fromStart=true;if(length<0){fromStart=false;// negative lengths mean start calculation from end point\nlength=-length;// absolute value\n}opt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;// not using localOpt\nvar lastValidSegment;// visible AND differentiable (with a tangent)\nvar l=0;// length so far\nfor(var i=0;i<numSegments;i++){var index=fromStart?i:numSegments-1-i;var segment=segments[index];var subdivisions=segmentSubdivisions[index];var d=segment.length({precision:precision,subdivisions:subdivisions});if(segment.isDifferentiable()){if(length<=l+d){return segment.tangentAtLength((fromStart?1:-1)*(length-l),{precision:precision,subdivisions:subdivisions});}lastValidSegment=segment;}l+=d;}// if length requested is higher than the length of the path, return tangent of endpoint of last valid segment\nif(lastValidSegment){var t=fromStart?1:0;return lastValidSegment.tangentAtT(t);}// if no valid segment, return null\nreturn null;},// Private function.\ntangentAtT:function(t){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nvar segmentIndex=t.segmentIndex;if(segmentIndex<0){return segments[0].tangentAtT(0);}if(segmentIndex>=numSegments){return segments[numSegments-1].tangentAtT(1);}var tValue=t.value;if(tValue<0){tValue=0;}else if(tValue>1){tValue=1;}return segments[segmentIndex].tangentAtT(tValue);},toPoints:function(opt){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}// if segments is an empty array\nopt=opt||{};var precision=opt.precision===undefined?this.PRECISION:opt.precision;var segmentSubdivisions=opt.segmentSubdivisions===undefined?this.getSegmentSubdivisions({precision:precision}):opt.segmentSubdivisions;var points=[];var partialPoints=[];for(var i=0;i<numSegments;i++){var segment=segments[i];if(segment.isVisible){var currentSegmentSubdivisions=segmentSubdivisions[i];if(currentSegmentSubdivisions.length>0){var subdivisionPoints=currentSegmentSubdivisions.map(function(curve){return curve.start;});Array.prototype.push.apply(partialPoints,subdivisionPoints);}else{partialPoints.push(segment.start);}}else if(partialPoints.length>0){partialPoints.push(segments[i-1].end);points.push(partialPoints);partialPoints=[];}}if(partialPoints.length>0){partialPoints.push(this.end);points.push(partialPoints);}return points;},toPolylines:function(opt){var polylines=[];var points=this.toPoints(opt);if(!points){return null;}for(var i=0,n=points.length;i<n;i++){polylines.push(new Polyline(points[i]));}return polylines;},toString:function(){var segments=this.segments;var numSegments=segments.length;var pathData='';for(var i=0;i<numSegments;i++){var segment=segments[i];pathData+=segment.serialize()+' ';}return pathData.trim();},translate:function(tx,ty){var segments=this.segments;var numSegments=segments.length;for(var i=0;i<numSegments;i++){var segment=segments[i];segment.translate(tx,ty);}return this;},// Helper method for updating subpath start of segments, starting with the one provided.\nupdateSubpathStartSegment:function(segment){var previousSegment=segment.previousSegment;// may be null\nwhile(segment&&!segment.isSubpathStart){// assign previous segment's subpath start segment to this segment\nif(previousSegment){segment.subpathStartSegment=previousSegment.subpathStartSegment;}// may be null\nelse{segment.subpathStartSegment=null;}// if segment had no previous segment, assign null - creates an invalid path!\npreviousSegment=segment;segment=segment.nextSegment;// move on to the segment after etc.\n}},// If the path is not valid, insert M 0 0 at the beginning.\n// Path with no segments is considered valid, so nothing is inserted.\nvalidate:function(){if(!this.isValid()){this.insertSegment(0,Path.createSegment('M',0,0));}return this;}};Object.defineProperty(Path.prototype,'start',{// Getter for the first visible endpoint of the path.\nconfigurable:true,enumerable:true,get:function(){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}for(var i=0;i<numSegments;i++){var segment=segments[i];if(segment.isVisible){return segment.start;}}// if no visible segment, return last segment end point\nreturn segments[numSegments-1].end;}});Object.defineProperty(Path.prototype,'end',{// Getter for the last visible endpoint of the path.\nconfigurable:true,enumerable:true,get:function(){var segments=this.segments;var numSegments=segments.length;if(numSegments===0){return null;}for(var i=numSegments-1;i>=0;i--){var segment=segments[i];if(segment.isVisible){return segment.end;}}// if no visible segment, return last segment end point\nreturn segments[numSegments-1].end;}});// Local helper function.\n// Use an array of arguments to call a constructor (function called with `new`).\n// Adapted from https://stackoverflow.com/a/8843181/2263595\n// It is not necessary to use this function if the arguments can be passed separately (i.e. if the number of arguments is limited).\n// - If that is the case, use `new constructor(arg1, arg2)`, for example.\n// It is not necessary to use this function if the function that needs an array of arguments is not supposed to be used as a constructor.\n// - If that is the case, use `f.apply(thisArg, [arg1, arg2...])`, for example.\nfunction applyToNew(constructor,argsArray){// The `new` keyword can only be applied to functions that take a limited number of arguments.\n// - We can fake that with .bind().\n// - It calls a function (`constructor`, here) with the arguments that were provided to it - effectively transforming an unlimited number of arguments into limited.\n// - So `new (constructor.bind(thisArg, arg1, arg2...))`\n// - `thisArg` can be anything (e.g. null) because `new` keyword resets context to the constructor object.\n// We need to pass in a variable number of arguments to the bind() call.\n// - We can use .apply().\n// - So `new (constructor.bind.apply(constructor, [thisArg, arg1, arg2...]))`\n// - `thisArg` can still be anything because `new` overwrites it.\n// Finally, to make sure that constructor.bind overwriting is not a problem, we switch to `Function.prototype.bind`.\n// - So, the final version is `new (Function.prototype.bind.apply(constructor, [thisArg, arg1, arg2...]))`\n// The function expects `argsArray[0]` to be `thisArg`.\n// - This means that whatever is sent as the first element will be ignored.\n// - The constructor will only see arguments starting from argsArray[1].\n// - So, a new dummy element is inserted at the start of the array.\nargsArray.unshift(null);return new(Function.prototype.bind.apply(constructor,argsArray))();}// Path segment interface:\nvar segmentPrototype={// virtual\nbbox:function(){throw new Error('Declaration missing for virtual function.');},// virtual\nclone:function(){throw new Error('Declaration missing for virtual function.');},// virtual\nclosestPoint:function(){throw new Error('Declaration missing for virtual function.');},// virtual\nclosestPointLength:function(){throw new Error('Declaration missing for virtual function.');},// virtual\nclosestPointNormalizedLength:function(){throw new Error('Declaration missing for virtual function.');},// Redirect calls to closestPointNormalizedLength() function if closestPointT() is not defined for segment.\nclosestPointT:function(p){if(this.closestPointNormalizedLength){return this.closestPointNormalizedLength(p);}throw new Error('Neither closestPointT() nor closestPointNormalizedLength() function is implemented.');},// virtual\nclosestPointTangent:function(){throw new Error('Declaration missing for virtual function.');},// virtual\ndivideAt:function(){throw new Error('Declaration missing for virtual function.');},// virtual\ndivideAtLength:function(){throw new Error('Declaration missing for virtual function.');},// Redirect calls to divideAt() function if divideAtT() is not defined for segment.\ndivideAtT:function(t){if(this.divideAt){return this.divideAt(t);}throw new Error('Neither divideAtT() nor divideAt() function is implemented.');},// virtual\nequals:function(){throw new Error('Declaration missing for virtual function.');},// virtual\ngetSubdivisions:function(){throw new Error('Declaration missing for virtual function.');},// virtual\nisDifferentiable:function(){throw new Error('Declaration missing for virtual function.');},isSegment:true,isSubpathStart:false,// true for Moveto segments\nisVisible:true,// false for Moveto segments\n// virtual\nlength:function(){throw new Error('Declaration missing for virtual function.');},// Return a fraction of result of length() function if lengthAtT() is not defined for segment.\nlengthAtT:function(t){if(t<=0){return 0;}var length=this.length();if(t>=1){return length;}return length*t;},nextSegment:null,// needed for subpath start segment updating\n// virtual\npointAt:function(){throw new Error('Declaration missing for virtual function.');},// virtual\npointAtLength:function(){throw new Error('Declaration missing for virtual function.');},// Redirect calls to pointAt() function if pointAtT() is not defined for segment.\npointAtT:function(t){if(this.pointAt){return this.pointAt(t);}throw new Error('Neither pointAtT() nor pointAt() function is implemented.');},previousSegment:null,// needed to get segment start property\n// virtual\nround:function(){throw new Error('Declaration missing for virtual function.');},subpathStartSegment:null,// needed to get Closepath segment end property\n// virtual\nscale:function(){throw new Error('Declaration missing for virtual function.');},// virtual\nserialize:function(){throw new Error('Declaration missing for virtual function.');},// virtual\ntangentAt:function(){throw new Error('Declaration missing for virtual function.');},// virtual\ntangentAtLength:function(){throw new Error('Declaration missing for virtual function.');},// Redirect calls to tangentAt() function if tangentAtT() is not defined for segment.\ntangentAtT:function(t){if(this.tangentAt){return this.tangentAt(t);}throw new Error('Neither tangentAtT() nor tangentAt() function is implemented.');},// virtual\ntoString:function(){throw new Error('Declaration missing for virtual function.');},// virtual\ntranslate:function(){throw new Error('Declaration missing for virtual function.');}};// usually directly assigned\n// getter for Closepath\nObject.defineProperty(segmentPrototype,'end',{configurable:true,enumerable:true,writable:true});// always a getter\n// always throws error for Moveto\nObject.defineProperty(segmentPrototype,'start',{// get a reference to the end point of previous segment\nconfigurable:true,enumerable:true,get:function(){if(!this.previousSegment){throw new Error('Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)');}return this.previousSegment.end;}});// virtual\nObject.defineProperty(segmentPrototype,'type',{configurable:true,enumerable:true,get:function(){throw new Error('Bad segment declaration. No type specified.');}});// Path segment implementations:\nvar Lineto=function(){var arguments$1=arguments;var args=[];var n=arguments.length;for(var i=0;i<n;i++){args.push(arguments$1[i]);}if(!(this instanceof Lineto)){// switching context of `this` to Lineto when called without `new`\nreturn applyToNew(Lineto,args);}if(n===0){throw new Error('Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).');}var outputArray;if(args[0]instanceof Line){// lines provided\nif(n===1){this.end=args[0].end.clone();return this;}else{throw new Error('Lineto constructor expects a line, 1 point, or 2 coordinates ('+n+' lines provided).');}}else if(typeof args[0]==='string'||typeof args[0]==='number'){// coordinates provided\nif(n===2){this.end=new Point(+args[0],+args[1]);return this;}else if(n<2){throw new Error('Lineto constructor expects a line, 1 point, or 2 coordinates ('+n+' coordinates provided).');}else{// this is a poly-line segment\nvar segmentCoords;outputArray=[];for(i=0;i<n;i+=2){// coords come in groups of two\nsegmentCoords=args.slice(i,i+2);// will send one coord if args.length not divisible by 2\noutputArray.push(applyToNew(Lineto,segmentCoords));}return outputArray;}}else{// points provided (needs to be last to also cover plain objects with x and y)\nif(n===1){this.end=new Point(args[0]);return this;}else{// this is a poly-line segment\nvar segmentPoint;outputArray=[];for(i=0;i<n;i+=1){segmentPoint=args[i];outputArray.push(new Lineto(segmentPoint));}return outputArray;}}};var linetoPrototype={clone:function(){return new Lineto(this.end);},divideAt:function(ratio){var line=new Line(this.start,this.end);var divided=line.divideAt(ratio);return[new Lineto(divided[0]),new Lineto(divided[1])];},divideAtLength:function(length){var line=new Line(this.start,this.end);var divided=line.divideAtLength(length);return[new Lineto(divided[0]),new Lineto(divided[1])];},getSubdivisions:function(){return[];},isDifferentiable:function(){if(!this.previousSegment){return false;}return!this.start.equals(this.end);},round:function(precision){this.end.round(precision);return this;},scale:function(sx,sy,origin){this.end.scale(sx,sy,origin);return this;},serialize:function(){var end=this.end;return this.type+' '+end.x+' '+end.y;},toString:function(){return this.type+' '+this.start+' '+this.end;},translate:function(tx,ty){this.end.translate(tx,ty);return this;}};Object.defineProperty(linetoPrototype,'type',{configurable:true,enumerable:true,value:'L'});Lineto.prototype=extend(segmentPrototype,Line.prototype,linetoPrototype);var Curveto=function(){var arguments$1=arguments;var args=[];var n=arguments.length;for(var i=0;i<n;i++){args.push(arguments$1[i]);}if(!(this instanceof Curveto)){// switching context of `this` to Curveto when called without `new`\nreturn applyToNew(Curveto,args);}if(n===0){throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).');}var outputArray;if(args[0]instanceof Curve){// curves provided\nif(n===1){this.controlPoint1=args[0].controlPoint1.clone();this.controlPoint2=args[0].controlPoint2.clone();this.end=args[0].end.clone();return this;}else{throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates ('+n+' curves provided).');}}else if(typeof args[0]==='string'||typeof args[0]==='number'){// coordinates provided\nif(n===6){this.controlPoint1=new Point(+args[0],+args[1]);this.controlPoint2=new Point(+args[2],+args[3]);this.end=new Point(+args[4],+args[5]);return this;}else if(n<6){throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates ('+n+' coordinates provided).');}else{// this is a poly-bezier segment\nvar segmentCoords;outputArray=[];for(i=0;i<n;i+=6){// coords come in groups of six\nsegmentCoords=args.slice(i,i+6);// will send fewer than six coords if args.length not divisible by 6\noutputArray.push(applyToNew(Curveto,segmentCoords));}return outputArray;}}else{// points provided (needs to be last to also cover plain objects with x and y)\nif(n===3){this.controlPoint1=new Point(args[0]);this.controlPoint2=new Point(args[1]);this.end=new Point(args[2]);return this;}else if(n<3){throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates ('+n+' points provided).');}else{// this is a poly-bezier segment\nvar segmentPoints;outputArray=[];for(i=0;i<n;i+=3){// points come in groups of three\nsegmentPoints=args.slice(i,i+3);// will send fewer than three points if args.length is not divisible by 3\noutputArray.push(applyToNew(Curveto,segmentPoints));}return outputArray;}}};var curvetoPrototype={clone:function(){return new Curveto(this.controlPoint1,this.controlPoint2,this.end);},divideAt:function(ratio,opt){var curve=new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end);var divided=curve.divideAt(ratio,opt);return[new Curveto(divided[0]),new Curveto(divided[1])];},divideAtLength:function(length,opt){var curve=new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end);var divided=curve.divideAtLength(length,opt);return[new Curveto(divided[0]),new Curveto(divided[1])];},divideAtT:function(t){var curve=new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end);var divided=curve.divideAtT(t);return[new Curveto(divided[0]),new Curveto(divided[1])];},isDifferentiable:function(){if(!this.previousSegment){return false;}var start=this.start;var control1=this.controlPoint1;var control2=this.controlPoint2;var end=this.end;return!(start.equals(control1)&&control1.equals(control2)&&control2.equals(end));},round:function(precision){this.controlPoint1.round(precision);this.controlPoint2.round(precision);this.end.round(precision);return this;},scale:function(sx,sy,origin){this.controlPoint1.scale(sx,sy,origin);this.controlPoint2.scale(sx,sy,origin);this.end.scale(sx,sy,origin);return this;},serialize:function(){var c1=this.controlPoint1;var c2=this.controlPoint2;var end=this.end;return this.type+' '+c1.x+' '+c1.y+' '+c2.x+' '+c2.y+' '+end.x+' '+end.y;},toString:function(){return this.type+' '+this.start+' '+this.controlPoint1+' '+this.controlPoint2+' '+this.end;},translate:function(tx,ty){this.controlPoint1.translate(tx,ty);this.controlPoint2.translate(tx,ty);this.end.translate(tx,ty);return this;}};Object.defineProperty(curvetoPrototype,'type',{configurable:true,enumerable:true,value:'C'});Curveto.prototype=extend(segmentPrototype,Curve.prototype,curvetoPrototype);var Moveto=function(){var arguments$1=arguments;var args=[];var n=arguments.length;for(var i=0;i<n;i++){args.push(arguments$1[i]);}if(!(this instanceof Moveto)){// switching context of `this` to Moveto when called without `new`\nreturn applyToNew(Moveto,args);}if(n===0){throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).');}var outputArray;if(args[0]instanceof Line){// lines provided\nif(n===1){this.end=args[0].end.clone();return this;}else{throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ('+n+' lines provided).');}}else if(args[0]instanceof Curve){// curves provided\nif(n===1){this.end=args[0].end.clone();return this;}else{throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ('+n+' curves provided).');}}else if(typeof args[0]==='string'||typeof args[0]==='number'){// coordinates provided\nif(n===2){this.end=new Point(+args[0],+args[1]);return this;}else if(n<2){throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ('+n+' coordinates provided).');}else{// this is a moveto-with-subsequent-poly-line segment\nvar segmentCoords;outputArray=[];for(i=0;i<n;i+=2){// coords come in groups of two\nsegmentCoords=args.slice(i,i+2);// will send one coord if args.length not divisible by 2\nif(i===0){outputArray.push(applyToNew(Moveto,segmentCoords));}else{outputArray.push(applyToNew(Lineto,segmentCoords));}}return outputArray;}}else{// points provided (needs to be last to also cover plain objects with x and y)\nif(n===1){this.end=new Point(args[0]);return this;}else{// this is a moveto-with-subsequent-poly-line segment\nvar segmentPoint;outputArray=[];for(i=0;i<n;i+=1){// points come one by one\nsegmentPoint=args[i];if(i===0){outputArray.push(new Moveto(segmentPoint));}else{outputArray.push(new Lineto(segmentPoint));}}return outputArray;}}};var movetoPrototype={bbox:function(){return null;},clone:function(){return new Moveto(this.end);},closestPoint:function(){return this.end.clone();},closestPointNormalizedLength:function(){return 0;},closestPointLength:function(){return 0;},closestPointT:function(){return 1;},closestPointTangent:function(){return null;},divideAt:function(){return[this.clone(),this.clone()];},divideAtLength:function(){return[this.clone(),this.clone()];},equals:function(m){return this.end.equals(m.end);},getSubdivisions:function(){return[];},isDifferentiable:function(){return false;},isSubpathStart:true,isVisible:false,length:function(){return 0;},lengthAtT:function(){return 0;},pointAt:function(){return this.end.clone();},pointAtLength:function(){return this.end.clone();},pointAtT:function(){return this.end.clone();},round:function(precision){this.end.round(precision);return this;},scale:function(sx,sy,origin){this.end.scale(sx,sy,origin);return this;},serialize:function(){var end=this.end;return this.type+' '+end.x+' '+end.y;},tangentAt:function(){return null;},tangentAtLength:function(){return null;},tangentAtT:function(){return null;},toString:function(){return this.type+' '+this.end;},translate:function(tx,ty){this.end.translate(tx,ty);return this;}};Object.defineProperty(movetoPrototype,'start',{configurable:true,enumerable:true,get:function(){throw new Error('Illegal access. Moveto segments should not need a start property.');}});Object.defineProperty(movetoPrototype,'type',{configurable:true,enumerable:true,value:'M'});Moveto.prototype=extend(segmentPrototype,movetoPrototype);// does not inherit from any other geometry object\nvar Closepath=function(){var arguments$1=arguments;var args=[];var n=arguments.length;for(var i=0;i<n;i++){args.push(arguments$1[i]);}if(!(this instanceof Closepath)){// switching context of `this` to Closepath when called without `new`\nreturn applyToNew(Closepath,args);}if(n>0){throw new Error('Closepath constructor expects no arguments.');}return this;};var closepathPrototype={clone:function(){return new Closepath();},divideAt:function(ratio){var line=new Line(this.start,this.end);var divided=line.divideAt(ratio);return[// if we didn't actually cut into the segment, first divided part can stay as Z\ndivided[1].isDifferentiable()?new Lineto(divided[0]):this.clone(),new Lineto(divided[1])];},divideAtLength:function(length){var line=new Line(this.start,this.end);var divided=line.divideAtLength(length);return[// if we didn't actually cut into the segment, first divided part can stay as Z\ndivided[1].isDifferentiable()?new Lineto(divided[0]):this.clone(),new Lineto(divided[1])];},getSubdivisions:function(){return[];},isDifferentiable:function(){if(!this.previousSegment||!this.subpathStartSegment){return false;}return!this.start.equals(this.end);},round:function(){return this;},scale:function(){return this;},serialize:function(){return this.type;},toString:function(){return this.type+' '+this.start+' '+this.end;},translate:function(){return this;}};Object.defineProperty(closepathPrototype,'end',{// get a reference to the end point of subpath start segment\nconfigurable:true,enumerable:true,get:function(){if(!this.subpathStartSegment){throw new Error('Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)');}return this.subpathStartSegment.end;}});Object.defineProperty(closepathPrototype,'type',{configurable:true,enumerable:true,value:'Z'});Closepath.prototype=extend(segmentPrototype,Line.prototype,closepathPrototype);var segmentTypes=Path.segmentTypes={L:Lineto,C:Curveto,M:Moveto,Z:Closepath,z:Closepath};Path.regexSupportedData=new RegExp('^[\\\\s\\\\d'+Object.keys(segmentTypes).join('')+',.]*$');Path.isDataSupported=function(data){if(typeof data!=='string'){return false;}return this.regexSupportedData.test(data);};var bezier={// Cubic Bezier curve path through points.\n// @deprecated\n// @param {array} points Array of points through which the smooth line will go.\n// @return {array} SVG Path commands as an array\ncurveThroughPoints:function(points){console.warn('deprecated');return new Path(Curve.throughPoints(points)).serialize();},// Get open-ended Bezier Spline Control Points.\n// @deprecated\n// @param knots Input Knot Bezier spline points (At least two points!).\n// @param firstControlPoints Output First Control points. Array of knots.length - 1 length.\n// @param secondControlPoints Output Second Control points. Array of knots.length - 1 length.\ngetCurveControlPoints:function(knots){console.warn('deprecated');var firstControlPoints=[];var secondControlPoints=[];var n=knots.length-1;var i;// Special case: Bezier curve should be a straight line.\nif(n==1){// 3P1 = 2P0 + P3\nfirstControlPoints[0]=new Point((2*knots[0].x+knots[1].x)/3,(2*knots[0].y+knots[1].y)/3);// P2 = 2P1 â P0\nsecondControlPoints[0]=new Point(2*firstControlPoints[0].x-knots[0].x,2*firstControlPoints[0].y-knots[0].y);return[firstControlPoints,secondControlPoints];}// Calculate first Bezier control points.\n// Right hand side vector.\nvar rhs=[];// Set right hand side X values.\nfor(i=1;i<n-1;i++){rhs[i]=4*knots[i].x+2*knots[i+1].x;}rhs[0]=knots[0].x+2*knots[1].x;rhs[n-1]=(8*knots[n-1].x+knots[n].x)/2.0;// Get first control points X-values.\nvar x=this.getFirstControlPoints(rhs);// Set right hand side Y values.\nfor(i=1;i<n-1;++i){rhs[i]=4*knots[i].y+2*knots[i+1].y;}rhs[0]=knots[0].y+2*knots[1].y;rhs[n-1]=(8*knots[n-1].y+knots[n].y)/2.0;// Get first control points Y-values.\nvar y=this.getFirstControlPoints(rhs);// Fill output arrays.\nfor(i=0;i<n;i++){// First control point.\nfirstControlPoints.push(new Point(x[i],y[i]));// Second control point.\nif(i<n-1){secondControlPoints.push(new Point(2*knots[i+1].x-x[i+1],2*knots[i+1].y-y[i+1]));}else{secondControlPoints.push(new Point((knots[n].x+x[n-1])/2,(knots[n].y+y[n-1])/2));}}return[firstControlPoints,secondControlPoints];},// Divide a Bezier curve into two at point defined by value 't' <0,1>.\n// Using deCasteljau algorithm. http://math.stackexchange.com/a/317867\n// @deprecated\n// @param control points (start, control start, control end, end)\n// @return a function that accepts t and returns 2 curves.\ngetCurveDivider:function(p0,p1,p2,p3){console.warn('deprecated');var curve=new Curve(p0,p1,p2,p3);return function divideCurve(t){var divided=curve.divide(t);return[{p0:divided[0].start,p1:divided[0].controlPoint1,p2:divided[0].controlPoint2,p3:divided[0].end},{p0:divided[1].start,p1:divided[1].controlPoint1,p2:divided[1].controlPoint2,p3:divided[1].end}];};},// Solves a tridiagonal system for one of coordinates (x or y) of first Bezier control points.\n// @deprecated\n// @param rhs Right hand side vector.\n// @return Solution vector.\ngetFirstControlPoints:function(rhs){console.warn('deprecated');var n=rhs.length;// `x` is a solution vector.\nvar x=[];var tmp=[];var b=2.0;x[0]=rhs[0]/b;// Decomposition and forward substitution.\nfor(var i=1;i<n;i++){tmp[i]=1/b;b=(i<n-1?4.0:3.5)-tmp[i];x[i]=(rhs[i]-x[i-1])/b;}for(i=1;i<n;i++){// Backsubstitution.\nx[n-i-1]-=tmp[n-i]*x[n-i];}return x;},// Solves an inversion problem -- Given the (x, y) coordinates of a point which lies on\n// a parametric curve x = x(t)/w(t), y = y(t)/w(t), ï¬nd the parameter value t\n// which corresponds to that point.\n// @deprecated\n// @param control points (start, control start, control end, end)\n// @return a function that accepts a point and returns t.\ngetInversionSolver:function(p0,p1,p2,p3){console.warn('deprecated');var curve=new Curve(p0,p1,p2,p3);return function solveInversion(p){return curve.closestPointT(p);};}};var Polygon=function(points){if(!(this instanceof Polygon)){return new Polygon(points);}if(typeof points==='string'){return new Polygon.parse(points);}this.points=Array.isArray(points)?points.map(Point):[];};Polygon.parse=function(svgString){return new Polygon(parsePoints(svgString));};Polygon.fromRect=function(rect){return new Polygon([rect.topLeft(),rect.topRight(),rect.bottomRight(),rect.bottomLeft()]);};Polygon.prototype=extend(Polyline.prototype,{type:types.Polygon,clone:function(){return new Polygon(clonePoints(this.points));},convexHull:function(){return new Polygon(convexHull(this.points));},lengthPoints:function(){var ref=this;var start=ref.start;var end=ref.end;var points=ref.points;if(points.length<=1||start.equals(end)){return points;}return points.concat([start.clone()]);}});function exists(shape1,shape2,shape1opt,shape2opt){switch(shape1.type){case types.Line:{switch(shape2.type){case types.Line:{return lineWithLine(shape1,shape2);}}break;}case types.Ellipse:{switch(shape2.type){case types.Line:{return ellipseWithLine(shape1,shape2);}case types.Ellipse:{return ellipseWithEllipse(shape1,shape2);}}break;}case types.Rect:{switch(shape2.type){case types.Line:{return rectWithLine(shape1,shape2);}case types.Ellipse:{return rectWithEllipse(shape1,shape2);}case types.Rect:{return rectWithRect(shape1,shape2);}}break;}case types.Polyline:{switch(shape2.type){case types.Line:{return polylineWithLine(shape1,shape2);}case types.Ellipse:{return polylineWithEllipse(shape1,shape2);}case types.Rect:{return polylineWithRect(shape1,shape2);}case types.Polyline:{return polylineWithPolyline(shape1,shape2);}}break;}case types.Polygon:{switch(shape2.type){case types.Line:{return polygonWithLine(shape1,shape2);}case types.Ellipse:{return polygonWithEllipse(shape1,shape2);}case types.Rect:{return polygonWithRect(shape1,shape2);}case types.Polyline:{return polygonWithPolyline(shape1,shape2);}case types.Polygon:{return polygonWithPolygon(shape1,shape2);}}break;}case types.Path:{switch(shape2.type){case types.Line:{return pathWithLine(shape1,shape2,shape1opt);}case types.Ellipse:{return pathWithEllipse(shape1,shape2,shape1opt);}case types.Rect:{return pathWithRect(shape1,shape2,shape1opt);}case types.Polyline:{return pathWithPolyline(shape1,shape2,shape1opt);}case types.Polygon:{return pathWithPolygon(shape1,shape2,shape1opt);}case types.Path:{return pathWithPath(shape1,shape2,shape1opt,shape2opt);}}break;}}// None of the cases above\nswitch(shape2.type){case types.Ellipse:case types.Rect:case types.Polyline:case types.Polygon:case types.Path:{return exists(shape2,shape1,shape2opt,shape1opt);}default:{throw Error(\"The intersection for \"+shape1+\" and \"+shape2+\" could not be found.\");}}}/* Line */function lineWithLine(line1,line2){var x1=line1.start.x;var y1=line1.start.y;var x2=line1.end.x;var y2=line1.end.y;var x3=line2.start.x;var y3=line2.start.y;var x4=line2.end.x;var y4=line2.end.y;var s1x=x2-x1;var s1y=y2-y1;var s2x=x4-x3;var s2y=y4-y3;var s3x=x1-x3;var s3y=y1-y3;var p=s1x*s2y-s2x*s1y;var s=(s1x*s3y-s1y*s3x)/p;var t=(s2x*s3y-s2y*s3x)/p;return s>=0&&s<=1&&t>=0&&t<=1;}/* Ellipse */function ellipseWithLine(ellipse,line){var rex=ellipse.a;var rey=ellipse.b;var xe=ellipse.x;var ye=ellipse.y;var x1=line.start.x-xe;var x2=line.end.x-xe;var y1=line.start.y-ye;var y2=line.end.y-ye;var rex_2=rex*rex;var rey_2=rey*rey;var dx=x2-x1;var dy=y2-y1;var A=dx*dx/rex_2+dy*dy/rey_2;var B=2*x1*dx/rex_2+2*y1*dy/rey_2;var C=x1*x1/rex_2+y1*y1/rey_2-1;var D=B*B-4*A*C;if(D===0){var t=-B/2/A;return t>=0&&t<=1;}else if(D>0){var sqrt=Math.sqrt(D);var t1=(-B+sqrt)/2/A;var t2=(-B-sqrt)/2/A;return t1>=0&&t1<=1||t2>=0&&t2<=1;}return false;}function ellipseWithEllipse(ellipse1,ellipse2){return _ellipsesIntersection(ellipse1,0,ellipse2,0);}/* Rect */function rectWithLine(rect,line){var start=line.start;var end=line.end;var x=rect.x;var y=rect.y;var width=rect.width;var height=rect.height;if(start.x>x+width&&end.x>x+width||start.x<x&&end.x<x||start.y>y+height&&end.y>y+height||start.y<y&&end.y<y){return false;}if(rect.containsPoint(line.start)||rect.containsPoint(line.end)){return true;}return lineWithLine(rect.topLine(),line)||lineWithLine(rect.rightLine(),line)||lineWithLine(rect.bottomLine(),line)||lineWithLine(rect.leftLine(),line);}function rectWithEllipse(rect,ellipse){if(!rectWithRect(rect,Rect.fromEllipse(ellipse))){return false;}return polygonWithEllipse(Polygon.fromRect(rect),ellipse);}function rectWithRect(rect1,rect2){return rect1.x<rect2.x+rect2.width&&rect1.x+rect1.width>rect2.x&&rect1.y<rect2.y+rect2.height&&rect1.y+rect1.height>rect2.y;}/* Polyline */function polylineWithLine(polyline,line){return _polylineWithLine(polyline,line,{interior:false});}function polylineWithEllipse(polyline,ellipse){return _polylineWithEllipse(polyline,ellipse,{interior:false});}function polylineWithRect(polyline,rect){return _polylineWithRect(polyline,rect,{interior:false});}function polylineWithPolyline(polyline1,polyline2){return _polylineWithPolyline(polyline1,polyline2,{interior:false});}/* Polygon */function polygonWithLine(polygon,line){return _polylineWithLine(polygon,line,{interior:true});}function polygonWithEllipse(polygon,ellipse){return _polylineWithEllipse(polygon,ellipse,{interior:true});}function polygonWithRect(polygon,rect){return _polylineWithRect(polygon,rect,{interior:true});}function polygonWithPolyline(polygon,polyline){return _polylineWithPolyline(polygon,polyline,{interior:true});}function polygonWithPolygon(polygon1,polygon2){return _polylineWithPolygon(polygon1,polygon2,{interior:true});}/* Path */function pathWithLine(path,line,pathOpt){return path.getSubpaths().some(function(subpath){var ref=subpath.toPolylines(pathOpt);var polyline=ref[0];var ref$1=subpath.getSegment(-1);var type=ref$1.type;if(type==='Z'){return polygonWithLine(polyline,line);}else{return polylineWithLine(polyline,line);}});}function pathWithEllipse(path,ellipse,pathOpt){return path.getSubpaths().some(function(subpath){var ref=subpath.toPolylines(pathOpt);var polyline=ref[0];var ref$1=subpath.getSegment(-1);var type=ref$1.type;if(type==='Z'){return polygonWithEllipse(polyline,ellipse);}else{return polylineWithEllipse(polyline,ellipse);}});}function pathWithRect(path,rect,pathOpt){return pathWithPolygon(path,Polygon.fromRect(rect),pathOpt);}function pathWithPolyline(path,polyline,pathOpt){return _pathWithPolyline(path,polyline,pathOpt,{interior:false});}function pathWithPolygon(path,polygon,pathOpt){return _pathWithPolyline(path,polygon,pathOpt,{interior:true});}function pathWithPath(path1,path2,pathOpt1,pathOpt2){return path1.getSubpaths().some(function(subpath){var ref=subpath.toPolylines(pathOpt1);var polyline1=ref[0];var ref$1=subpath.getSegment(-1);var type=ref$1.type;if(type==='Z'){return pathWithPolygon(path2,polyline1,pathOpt2);}else{return pathWithPolyline(path2,polyline1,pathOpt2);}});}function _polylineWithLine(polyline,line,opt){if(opt===void 0)opt={};var interior=opt.interior;if(interior===void 0)interior=false;var thisPoints;if(interior){if(polyline.containsPoint(line.start)){// If any point of the polyline lies inside this polygon (interior = true)\n// there is an intersection (we've chosen the start point)\nreturn true;}var start=polyline.start;var end=polyline.end;var points=polyline.points;thisPoints=end.equals(start)?points:points.concat([start]);}else{thisPoints=polyline.points;}var length=thisPoints.length;var segment=new Line();for(var i=0;i<length-1;i++){segment.start=thisPoints[i];segment.end=thisPoints[i+1];if(lineWithLine(line,segment)){return true;}}return false;}function _polylineWithEllipse(polyline,ellipse,opt){if(opt===void 0)opt={};var start=polyline.start;var end=polyline.end;var points=polyline.points;if(ellipse.containsPoint(start)){return true;}var thisPoints;var interior=opt.interior;if(interior===void 0)interior=false;if(interior){if(polyline.containsPoint(ellipse.center())){// If any point of the ellipse lies inside this polygon (interior = true)\n// there is an intersection (we've chosen the center point)\nreturn true;}thisPoints=end.equals(start)?points:points.concat([start]);}else{thisPoints=points;}var length=thisPoints.length;var segment=new Line();for(var i=0;i<length-1;i++){segment.start=thisPoints[i];segment.end=thisPoints[i+1];if(ellipseWithLine(ellipse,segment)){return true;}}return false;}function _polylineWithRect(polyline,rect,opt){var polygon=Polygon.fromRect(rect);return _polylineWithPolygon(polyline,polygon,opt);}function _pathWithPolyline(path,polyline1,pathOpt,opt){return path.getSubpaths().some(function(subpath){var ref=subpath.toPolylines(pathOpt);var polyline2=ref[0];var ref$1=subpath.getSegment(-1);var type=ref$1.type;if(type==='Z'){return _polylineWithPolygon(polyline1,polyline2,opt);}else{return _polylineWithPolyline(polyline1,polyline2,opt);}});}function _polylineWithPolyline(polyline1,polyline2,opt){if(opt===void 0)opt={};var interior=opt.interior;if(interior===void 0)interior=false;var thisPolyline;if(interior){var start=polyline2.start;if(polyline1.containsPoint(start)){// If any point of the polyline lies inside this polygon (interior = true)\n// there is an intersection (we've chosen the start point)\nreturn true;}thisPolyline=polyline1.clone().close();}else{thisPolyline=polyline1;}var otherPoints=polyline2.points;var length=otherPoints.length;var segment=new Line();for(var i=0;i<length-1;i++){segment.start=otherPoints[i];segment.end=otherPoints[i+1];if(polylineWithLine(thisPolyline,segment)){return true;}}return false;}function _polylineWithPolygon(polyline,polygon,opt){return polygon.containsPoint(polyline.start)||_polylineWithPolyline(polyline,polygon.clone().close(),opt);}function _ellipsesIntersection(e1,w1,e2,w2){var cos=Math.cos;var sin=Math.sin;var sinW1=sin(w1);var cosW1=cos(w1);var sinW2=sin(w2);var cosW2=cos(w2);var sinW1s=sinW1*sinW1;var cosW1s=cosW1*cosW1;var sinCos1=sinW1*cosW1;var sinW2s=sinW2*sinW2;var cosW2s=cosW2*cosW2;var sinCos2=sinW2*cosW2;var a1s=e1.a*e1.a;var b1s=e1.b*e1.b;var a2s=e2.a*e2.a;var b2s=e2.b*e2.b;var A1=a1s*sinW1s+b1s*cosW1s;var A2=a2s*sinW2s+b2s*cosW2s;var B1=a1s*cosW1s+b1s*sinW1s;var B2=a2s*cosW2s+b2s*sinW2s;var C1=2*(b1s-a1s)*sinCos1;var C2=2*(b2s-a2s)*sinCos2;var D1=-2*A1*e1.x-C1*e1.y;var D2=-2*A2*e2.x-C2*e2.y;var E1=-C1*e1.x-2*B1*e1.y;var E2=-C2*e2.x-2*B2*e2.y;var F1=A1*e1.x*e1.x+B1*e1.y*e1.y+C1*e1.x*e1.y-a1s*b1s;var F2=A2*e2.x*e2.x+B2*e2.y*e2.y+C2*e2.x*e2.y-a2s*b2s;C1=C1/2;C2=C2/2;D1=D1/2;D2=D2/2;E1=E1/2;E2=E2/2;var l3=det3([[A1,C1,D1],[C1,B1,E1],[D1,E1,F1]]);var l0=det3([[A2,C2,D2],[C2,B2,E2],[D2,E2,F2]]);var l2=0.33333333*(det3([[A2,C1,D1],[C2,B1,E1],[D2,E1,F1]])+det3([[A1,C2,D1],[C1,B2,E1],[D1,E2,F1]])+det3([[A1,C1,D2],[C1,B1,E2],[D1,E1,F2]]));var l1=0.33333333*(det3([[A1,C2,D2],[C1,B2,E2],[D1,E2,F2]])+det3([[A2,C1,D2],[C2,B1,E2],[D2,E1,F2]])+det3([[A2,C2,D1],[C2,B2,E1],[D2,E2,F1]]));var delta1=det2([[l3,l2],[l2,l1]]);var delta2=det2([[l3,l1],[l2,l0]]);var delta3=det2([[l2,l1],[l1,l0]]);var dP=det2([[2*delta1,delta2],[delta2,2*delta3]]);if(dP>0&&(l1>0||l2>0)){return false;}return true;}function det2(m){return m[0][0]*m[1][1]-m[0][1]*m[1][0];}function det3(m){return m[0][0]*m[1][1]*m[2][2]-m[0][0]*m[1][2]*m[2][1]-m[0][1]*m[1][0]*m[2][2]+m[0][1]*m[1][2]*m[2][0]+m[0][2]*m[1][0]*m[2][1]-m[0][2]*m[1][1]*m[2][0];}var _intersection={exists:exists,lineWithLine:lineWithLine,ellipseWithLine:ellipseWithLine,ellipseWithEllipse:ellipseWithEllipse,rectWithLine:rectWithLine,rectWithEllipse:rectWithEllipse,rectWithRect:rectWithRect,polylineWithLine:polylineWithLine,polylineWithEllipse:polylineWithEllipse,polylineWithRect:polylineWithRect,polylineWithPolyline:polylineWithPolyline,polygonWithLine:polygonWithLine,polygonWithEllipse:polygonWithEllipse,polygonWithRect:polygonWithRect,polygonWithPolyline:polygonWithPolyline,polygonWithPolygon:polygonWithPolygon,pathWithLine:pathWithLine,pathWithEllipse:pathWithEllipse,pathWithRect:pathWithRect,pathWithPolyline:pathWithPolyline,pathWithPolygon:pathWithPolygon,pathWithPath:pathWithPath};// Geometry library.\nvar intersection=_intersection;var g={intersection:intersection,scale:scale,normalizeAngle:normalizeAngle,snapToGrid:snapToGrid,toDeg:toDeg,toRad:toRad,random:random,bezier:bezier,Curve:Curve,Ellipse:Ellipse,ellipse:ellipse,Line:Line,line:line,Path:Path,Point:Point,point:point,Polyline:Polyline,Polygon:Polygon,Rect:Rect,rect:rect,types:types};// Vectorizer.\nvar V=function(){var hasSvg=typeof window==='object'&&!!(window.SVGAngle||document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure','1.1'));// SVG support is required.\nif(!hasSvg){// Return a function that throws an error when it is used.\nreturn function(){throw new Error('SVG is required to use Vectorizer.');};}// XML namespaces.\nvar ns={svg:'http://www.w3.org/2000/svg',xmlns:'http://www.w3.org/2000/xmlns/',xml:'http://www.w3.org/XML/1998/namespace',xlink:'http://www.w3.org/1999/xlink',xhtml:'http://www.w3.org/1999/xhtml'};var SVGVersion='1.1';// Declare shorthands to the most used math functions.\nvar math=Math;var PI=math.PI;var atan2=math.atan2;var sqrt=math.sqrt;var min=math.min;var max=math.max;var cos=math.cos;var sin=math.sin;var V=function(el,attrs,children){// This allows using V() without the new keyword.\nif(!(this instanceof V)){return V.apply(Object.create(V.prototype),arguments);}if(!el){return;}if(V.isV(el)){el=el.node;}attrs=attrs||{};if(V.isString(el)){el=el.trim();if(el.toLowerCase()==='svg'){// Create a new SVG canvas.\nel=V.createSvgDocument();}else if(el[0]==='<'){// Create element from an SVG string.\n// Allows constructs of type: `document.appendChild(V('<rect></rect>').node)`.\nvar svgDoc=V.createSvgDocument(el);// Note that `V()` might also return an array should the SVG string passed as\n// the first argument contain more than one root element.\nif(svgDoc.childNodes.length>1){// Map child nodes to `V`s.\nvar arrayOfVels=[];var i,len;for(i=0,len=svgDoc.childNodes.length;i<len;i++){var childNode=svgDoc.childNodes[i];arrayOfVels.push(new V(document.importNode(childNode,true)));}return arrayOfVels;}el=document.importNode(svgDoc.firstChild,true);}else{el=document.createElementNS(ns.svg,el);}V.ensureId(el);}this.node=el;this.setAttributes(attrs);if(children){this.append(children);}return this;};var VPrototype=V.prototype;Object.defineProperty(VPrototype,'id',{enumerable:true,get:function(){return this.node.id;},set:function(id){this.node.id=id;}});/**\n\t     * @param {SVGGElement} toElem\n\t     * @returns {SVGMatrix}\n\t     */VPrototype.getTransformToElement=function(target){var node=this.node;if(V.isSVGGraphicsElement(target)&&V.isSVGGraphicsElement(node)){var targetCTM=V.toNode(target).getScreenCTM();var nodeCTM=node.getScreenCTM();if(targetCTM&&nodeCTM){return targetCTM.inverse().multiply(nodeCTM);}}// Could not get actual transformation matrix\nreturn V.createSVGMatrix();};/**\n\t     * @param {SVGMatrix} matrix\n\t     * @param {Object=} opt\n\t     * @returns {Vectorizer|SVGMatrix} Setter / Getter\n\t     */VPrototype.transform=function(matrix,opt){var node=this.node;if(V.isUndefined(matrix)){return V.transformStringToMatrix(this.attr('transform'));}if(opt&&opt.absolute){return this.attr('transform',V.matrixToTransformString(matrix));}var svgTransform=V.createSVGTransform(matrix);node.transform.baseVal.appendItem(svgTransform);return this;};VPrototype.translate=function(tx,ty,opt){opt=opt||{};ty=ty||0;var transformAttr=this.attr('transform')||'';var transform=V.parseTransformString(transformAttr);transformAttr=transform.value;// Is it a getter?\nif(V.isUndefined(tx)){return transform.translate;}transformAttr=transformAttr.replace(/translate\\([^)]*\\)/g,'').trim();var newTx=opt.absolute?tx:transform.translate.tx+tx;var newTy=opt.absolute?ty:transform.translate.ty+ty;var newTranslate='translate('+newTx+','+newTy+')';// Note that `translate()` is always the first transformation. This is\n// usually the desired case.\nthis.attr('transform',(newTranslate+' '+transformAttr).trim());return this;};VPrototype.rotate=function(angle,cx,cy,opt){opt=opt||{};var transformAttr=this.attr('transform')||'';var transform=V.parseTransformString(transformAttr);transformAttr=transform.value;// Is it a getter?\nif(V.isUndefined(angle)){return transform.rotate;}transformAttr=transformAttr.replace(/rotate\\([^)]*\\)/g,'').trim();angle%=360;var newAngle=opt.absolute?angle:transform.rotate.angle+angle;var newOrigin=cx!==undefined&&cy!==undefined?','+cx+','+cy:'';var newRotate='rotate('+newAngle+newOrigin+')';this.attr('transform',(transformAttr+' '+newRotate).trim());return this;};// Note that `scale` as the only transformation does not combine with previous values.\nVPrototype.scale=function(sx,sy){sy=V.isUndefined(sy)?sx:sy;var transformAttr=this.attr('transform')||'';var transform=V.parseTransformString(transformAttr);transformAttr=transform.value;// Is it a getter?\nif(V.isUndefined(sx)){return transform.scale;}transformAttr=transformAttr.replace(/scale\\([^)]*\\)/g,'').trim();var newScale='scale('+sx+','+sy+')';this.attr('transform',(transformAttr+' '+newScale).trim());return this;};// Get SVGRect that contains coordinates and dimension of the real bounding box,\n// i.e. after transformations are applied.\n// If `target` is specified, bounding box will be computed relatively to `target` element.\nVPrototype.bbox=function(withoutTransformations,target){var box;var node=this.node;var ownerSVGElement=node.ownerSVGElement;// If the element is not in the live DOM, it does not have a bounding box defined and\n// so fall back to 'zero' dimension element.\nif(!ownerSVGElement){return new Rect(0,0,0,0);}try{box=node.getBBox();}catch(e){// Fallback for IE.\nbox={x:node.clientLeft,y:node.clientTop,width:node.clientWidth,height:node.clientHeight};}if(withoutTransformations){return new Rect(box);}var matrix=this.getTransformToElement(target||ownerSVGElement);return V.transformRect(box,matrix);};// Returns an SVGRect that contains coordinates and dimensions of the real bounding box,\n// i.e. after transformations are applied.\n// Fixes a browser implementation bug that returns incorrect bounding boxes for groups of svg elements.\n// Takes an (Object) `opt` argument (optional) with the following attributes:\n// (Object) `target` (optional): if not undefined, transform bounding boxes relative to `target`; if undefined, transform relative to this\n// (Boolean) `recursive` (optional): if true, recursively enter all groups and get a union of element bounding boxes (svg bbox fix); if false or undefined, return result of native function this.node.getBBox();\nVPrototype.getBBox=function(opt){var options={};var outputBBox;var node=this.node;var ownerSVGElement=node.ownerSVGElement;// If the element is not in the live DOM, it does not have a bounding box defined and\n// so fall back to 'zero' dimension element.\n// If the element is not an SVGGraphicsElement, we could not measure the bounding box either\nif(!ownerSVGElement||!V.isSVGGraphicsElement(node)){return new Rect(0,0,0,0);}if(opt){if(opt.target){// check if target exists\noptions.target=V.toNode(opt.target);// works for V objects, jquery objects, and node objects\n}if(opt.recursive){options.recursive=opt.recursive;}}if(!options.recursive){try{outputBBox=node.getBBox();}catch(e){// Fallback for IE.\noutputBBox={x:node.clientLeft,y:node.clientTop,width:node.clientWidth,height:node.clientHeight};}if(!options.target){// transform like this (that is, not at all)\nreturn new Rect(outputBBox);}else{// transform like target\nvar matrix=this.getTransformToElement(options.target);return V.transformRect(outputBBox,matrix);}}else{// if we want to calculate the bbox recursively\n// browsers report correct bbox around svg elements (one that envelops the path lines tightly)\n// but some browsers fail to report the same bbox when the elements are in a group (returning a looser bbox that also includes control points, like node.getClientRect())\n// this happens even if we wrap a single svg element into a group!\n// this option setting makes the function recursively enter all the groups from this and deeper, get bboxes of the elements inside, then return a union of those bboxes\nvar children=this.children();var n=children.length;if(n===0){return this.getBBox({target:options.target,recursive:false});}// recursion's initial pass-through setting:\n// recursive passes-through just keep the target as whatever was set up here during the initial pass-through\nif(!options.target){// transform children/descendants like this (their parent/ancestor)\noptions.target=this;}// else transform children/descendants like target\nfor(var i=0;i<n;i++){var currentChild=children[i];var childBBox;// if currentChild is not a group element, get its bbox with a nonrecursive call\nif(currentChild.children().length===0){childBBox=currentChild.getBBox({target:options.target,recursive:false});}else{// if currentChild is a group element (determined by checking the number of children), enter it with a recursive call\nchildBBox=currentChild.getBBox({target:options.target,recursive:true});}if(!outputBBox){// if this is the first iteration\noutputBBox=childBBox;}else{// make a new bounding box rectangle that contains this child's bounding box and previous bounding box\noutputBBox=outputBBox.union(childBBox);}}return outputBBox;}};// Text() helpers\nfunction createTextPathNode(attrs,vel){attrs||(attrs={});var textPathElement=V('textPath');var d=attrs.d;if(d&&attrs['xlink:href']===undefined){// If `opt.attrs` is a plain string, consider it to be directly the\n// SVG path data for the text to go along (this is a shortcut).\n// Otherwise if it is an object and contains the `d` property, then this is our path.\n// Wrap the text in the SVG <textPath> element that points\n// to a path defined by `opt.attrs` inside the `<defs>` element.\nvar linkedPath=V('path').attr('d',d).appendTo(vel.defs());textPathElement.attr('xlink:href','#'+linkedPath.id);}if(V.isObject(attrs)){// Set attributes on the `<textPath>`. The most important one\n// is the `xlink:href` that points to our newly created `<path/>` element in `<defs/>`.\n// Note that we also allow the following construct:\n// `t.text('my text', { textPath: { 'xlink:href': '#my-other-path' } })`.\n// In other words, one can completely skip the auto-creation of the path\n// and use any other arbitrary path that is in the document.\ntextPathElement.attr(attrs);}return textPathElement.node;}function annotateTextLine(lineNode,lineAnnotations,opt){opt||(opt={});var includeAnnotationIndices=opt.includeAnnotationIndices;var eol=opt.eol;var lineHeight=opt.lineHeight;var baseSize=opt.baseSize;var maxFontSize=0;var fontMetrics={};var lastJ=lineAnnotations.length-1;for(var j=0;j<=lastJ;j++){var annotation=lineAnnotations[j];var fontSize=null;if(V.isObject(annotation)){var annotationAttrs=annotation.attrs;var vTSpan=V('tspan',annotationAttrs);var tspanNode=vTSpan.node;var t=annotation.t;if(eol&&j===lastJ){t+=eol;}tspanNode.textContent=t;// Per annotation className\nvar annotationClass=annotationAttrs['class'];if(annotationClass){vTSpan.addClass(annotationClass);}// If `opt.includeAnnotationIndices` is `true`,\n// set the list of indices of all the applied annotations\n// in the `annotations` attribute. This list is a comma\n// separated list of indices.\nif(includeAnnotationIndices){vTSpan.attr('annotations',annotation.annotations);}// Check for max font size\nfontSize=parseFloat(annotationAttrs['font-size']);if(!isFinite(fontSize)){fontSize=baseSize;}if(fontSize&&fontSize>maxFontSize){maxFontSize=fontSize;}}else{if(eol&&j===lastJ){annotation+=eol;}tspanNode=document.createTextNode(annotation||' ');if(baseSize&&baseSize>maxFontSize){maxFontSize=baseSize;}}lineNode.appendChild(tspanNode);}if(maxFontSize){fontMetrics.maxFontSize=maxFontSize;}if(lineHeight){fontMetrics.lineHeight=lineHeight;}else if(maxFontSize){fontMetrics.lineHeight=maxFontSize*1.2;}return fontMetrics;}var emRegex=/em$/;function convertEmToPx(em,fontSize){var numerical=parseFloat(em);if(emRegex.test(em)){return numerical*fontSize;}return numerical;}function calculateDY(alignment,linesMetrics,baseSizePx,lineHeight){if(!Array.isArray(linesMetrics)){return 0;}var n=linesMetrics.length;if(!n){return 0;}var lineMetrics=linesMetrics[0];var flMaxFont=convertEmToPx(lineMetrics.maxFontSize,baseSizePx)||baseSizePx;var rLineHeights=0;var lineHeightPx=convertEmToPx(lineHeight,baseSizePx);for(var i=1;i<n;i++){lineMetrics=linesMetrics[i];var iLineHeight=convertEmToPx(lineMetrics.lineHeight,baseSizePx)||lineHeightPx;rLineHeights+=iLineHeight;}var llMaxFont=convertEmToPx(lineMetrics.maxFontSize,baseSizePx)||baseSizePx;var dy;switch(alignment){case'middle':dy=flMaxFont/2-0.15*llMaxFont-rLineHeights/2;break;case'bottom':dy=-(0.25*llMaxFont)-rLineHeights;break;default:case'top':dy=0.8*flMaxFont;break;}return dy;}VPrototype.text=function(content,opt){if(content&&typeof content!=='string'){throw new Error('Vectorizer: text() expects the first argument to be a string.');}// Replace all spaces with the Unicode No-break space (http://www.fileformat.info/info/unicode/char/a0/index.htm).\n// IE would otherwise collapse all spaces into one.\ncontent=V.sanitizeText(content);opt||(opt={});// Should we allow the text to be selected?\nvar displayEmpty=opt.displayEmpty;// End of Line character\nvar eol=opt.eol;// Text along path\nvar textPath=opt.textPath;// Vertical shift\nvar verticalAnchor=opt.textVerticalAnchor;var namedVerticalAnchor=verticalAnchor==='middle'||verticalAnchor==='bottom'||verticalAnchor==='top';// Horizontal shift applied to all the lines but the first.\nvar x=opt.x;if(x===undefined){x=this.attr('x')||0;}// Annotations\nvar iai=opt.includeAnnotationIndices;var annotations=opt.annotations;if(annotations&&!V.isArray(annotations)){annotations=[annotations];}// Shift all the <tspan> but first by one line (`1em`)\nvar defaultLineHeight=opt.lineHeight;var autoLineHeight=defaultLineHeight==='auto';var lineHeight=autoLineHeight?'1.5em':defaultLineHeight||'1em';// Clearing the element\nthis.empty();this.attr({// Preserve spaces. In other words, we do not want consecutive spaces to get collapsed to one.\n'xml:space':'preserve',// An empty text gets rendered into the DOM in webkit-based browsers.\n// In order to unify this behaviour across all browsers\n// we rather hide the text element when it's empty.\n'display':content||displayEmpty?null:'none'});// Set default font-size if none\nvar fontSize=parseFloat(this.attr('font-size'));if(!fontSize){fontSize=16;if(namedVerticalAnchor||annotations){this.attr('font-size',fontSize);}}var doc=document;var containerNode;if(textPath){// Now all the `<tspan>`s will be inside the `<textPath>`.\nif(typeof textPath==='string'){textPath={d:textPath};}containerNode=createTextPathNode(textPath,this);}else{containerNode=doc.createDocumentFragment();}var offset=0;var lines=content.split('\\n');var linesMetrics=[];var annotatedY;for(var i=0,lastI=lines.length-1;i<=lastI;i++){var dy=lineHeight;var lineClassName='v-line';var lineNode=doc.createElementNS(ns.svg,'tspan');var line=lines[i];var lineMetrics;if(line){if(annotations){// Find the *compacted* annotations for this line.\nvar lineAnnotations=V.annotateString(line,annotations,{offset:-offset,includeAnnotationIndices:iai});lineMetrics=annotateTextLine(lineNode,lineAnnotations,{includeAnnotationIndices:iai,eol:i!==lastI&&eol,lineHeight:autoLineHeight?null:lineHeight,baseSize:fontSize});// Get the line height based on the biggest font size in the annotations for this line.\nvar iLineHeight=lineMetrics.lineHeight;if(iLineHeight&&autoLineHeight&&i!==0){dy=iLineHeight;}if(i===0){annotatedY=lineMetrics.maxFontSize*0.8;}}else{if(eol&&i!==lastI){line+=eol;}lineNode.textContent=line;}}else{// Make sure the textContent is never empty. If it is, add a dummy\n// character and make it invisible, making the following lines correctly\n// relatively positioned. `dy=1em` won't work with empty lines otherwise.\nlineNode.textContent='-';lineClassName+=' v-empty-line';// 'opacity' needs to be specified with fill, stroke. Opacity without specification\n// is not applied in Firefox\nvar lineNodeStyle=lineNode.style;lineNodeStyle.fillOpacity=0;lineNodeStyle.strokeOpacity=0;if(annotations){lineMetrics={};}}if(lineMetrics){linesMetrics.push(lineMetrics);}if(i>0){lineNode.setAttribute('dy',dy);}// Firefox requires 'x' to be set on the first line when inside a text path\nif(i>0||textPath){lineNode.setAttribute('x',x);}lineNode.className.baseVal=lineClassName;containerNode.appendChild(lineNode);offset+=line.length+1;// + 1 = newline character.\n}// Y Alignment calculation\nif(namedVerticalAnchor){if(annotations){dy=calculateDY(verticalAnchor,linesMetrics,fontSize,lineHeight);}else if(verticalAnchor==='top'){// A shortcut for top alignment. It does not depend on font-size nor line-height\ndy='0.8em';}else{var rh;// remaining height\nif(lastI>0){rh=parseFloat(lineHeight)||1;rh*=lastI;if(!emRegex.test(lineHeight)){rh/=fontSize;}}else{// Single-line text\nrh=0;}switch(verticalAnchor){case'middle':dy=0.3-rh/2+'em';break;case'bottom':dy=-rh-0.3+'em';break;}}}else{if(verticalAnchor===0){dy='0em';}else if(verticalAnchor){dy=verticalAnchor;}else{// No vertical anchor is defined\ndy=0;// Backwards compatibility - we change the `y` attribute instead of `dy`.\nif(this.attr('y')===null){this.attr('y',annotatedY||'0.8em');}}}containerNode.firstChild.setAttribute('dy',dy);// Appending lines to the element.\nthis.append(containerNode);return this;};/**\n\t     * @public\n\t     * @param {string} name\n\t     * @returns {Vectorizer}\n\t     */VPrototype.removeAttr=function(name){var qualifiedName=V.qualifyAttr(name);var el=this.node;if(qualifiedName.ns){if(el.hasAttributeNS(qualifiedName.ns,qualifiedName.local)){el.removeAttributeNS(qualifiedName.ns,qualifiedName.local);}}else if(el.hasAttribute(name)){el.removeAttribute(name);}return this;};VPrototype.attr=function(name,value){if(V.isUndefined(name)){// Return all attributes.\nvar attributes=this.node.attributes;var attrs={};for(var i=0;i<attributes.length;i++){attrs[attributes[i].name]=attributes[i].value;}return attrs;}if(V.isString(name)&&V.isUndefined(value)){return this.node.getAttribute(name);}if(typeof name==='object'){for(var attrName in name){if(name.hasOwnProperty(attrName)){this.setAttribute(attrName,name[attrName]);}}}else{this.setAttribute(name,value);}return this;};VPrototype.normalizePath=function(){var tagName=this.tagName();if(tagName==='PATH'){this.attr('d',V.normalizePathData(this.attr('d')));}return this;};VPrototype.remove=function(){if(this.node.parentNode){this.node.parentNode.removeChild(this.node);}return this;};VPrototype.empty=function(){while(this.node.firstChild){this.node.removeChild(this.node.firstChild);}return this;};/**\n\t     * @private\n\t     * @param {object} attrs\n\t     * @returns {Vectorizer}\n\t     */VPrototype.setAttributes=function(attrs){for(var key in attrs){if(attrs.hasOwnProperty(key)){this.setAttribute(key,attrs[key]);}}return this;};VPrototype.append=function(els){if(!V.isArray(els)){els=[els];}for(var i=0,len=els.length;i<len;i++){this.node.appendChild(V.toNode(els[i]));// lgtm [js/xss-through-dom]\n}return this;};VPrototype.prepend=function(els){var child=this.node.firstChild;return child?V(child).before(els):this.append(els);};VPrototype.before=function(els){var node=this.node;var parent=node.parentNode;if(parent){if(!V.isArray(els)){els=[els];}for(var i=0,len=els.length;i<len;i++){parent.insertBefore(V.toNode(els[i]),node);}}return this;};VPrototype.appendTo=function(node){V.toNode(node).appendChild(this.node);// lgtm [js/xss-through-dom]\nreturn this;};VPrototype.svg=function(){return this.node instanceof window.SVGSVGElement?this:V(this.node.ownerSVGElement);};VPrototype.tagName=function(){return this.node.tagName.toUpperCase();};VPrototype.defs=function(){var context=this.svg()||this;var defsNode=context.node.getElementsByTagName('defs')[0];if(defsNode){return V(defsNode);}return V('defs').appendTo(context);};VPrototype.clone=function(){var clone=V(this.node.cloneNode(true/* deep */));// Note that clone inherits also ID. Therefore, we need to change it here.\nclone.node.id=V.uniqueId();return clone;};VPrototype.findOne=function(selector){var found=this.node.querySelector(selector);return found?V(found):undefined;};VPrototype.find=function(selector){var vels=[];var nodes=this.node.querySelectorAll(selector);if(nodes){// Map DOM elements to `V`s.\nfor(var i=0;i<nodes.length;i++){vels.push(V(nodes[i]));}}return vels;};// Returns an array of V elements made from children of this.node.\nVPrototype.children=function(){var children=this.node.childNodes;var outputArray=[];for(var i=0;i<children.length;i++){var currentChild=children[i];if(currentChild.nodeType===1){outputArray.push(V(children[i]));}}return outputArray;};// Returns the V element from parentNode of this.node.\nVPrototype.parent=function(){return V(this.node.parentNode)||null;},// Find an index of an element inside its container.\nVPrototype.index=function(){var index=0;var node=this.node.previousSibling;while(node){// nodeType 1 for ELEMENT_NODE\nif(node.nodeType===1){index++;}node=node.previousSibling;}return index;};VPrototype.findParentByClass=function(className,terminator){var ownerSVGElement=this.node.ownerSVGElement;var node=this.node.parentNode;while(node&&node!==terminator&&node!==ownerSVGElement){var vel=V(node);if(vel.hasClass(className)){return vel;}node=node.parentNode;}return null;};// https://jsperf.com/get-common-parent\nVPrototype.contains=function(el){var a=this.node;var b=V.toNode(el);var bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&a.compareDocumentPosition(bup)&16);};// Convert global point into the coordinate space of this element.\nVPrototype.toLocalPoint=function(x,y){var svg=this.svg().node;var p=svg.createSVGPoint();p.x=x;p.y=y;try{var globalPoint=p.matrixTransform(svg.getScreenCTM().inverse());var globalToLocalMatrix=this.getTransformToElement(svg).inverse();}catch(e){// IE9 throws an exception in odd cases. (`Unexpected call to method or property access`)\n// We have to make do with the original coordianates.\nreturn p;}return globalPoint.matrixTransform(globalToLocalMatrix);};VPrototype.translateCenterToPoint=function(p){var bbox=this.getBBox({target:this.svg()});var center=bbox.center();this.translate(p.x-center.x,p.y-center.y);return this;};// Efficiently auto-orient an element. This basically implements the orient=auto attribute\n// of markers. The easiest way of understanding on what this does is to imagine the element is an\n// arrowhead. Calling this method on the arrowhead makes it point to the `position` point while\n// being auto-oriented (properly rotated) towards the `reference` point.\n// `target` is the element relative to which the transformations are applied. Usually a viewport.\nVPrototype.translateAndAutoOrient=function(position,reference,target){position=new Point(position);reference=new Point(reference);target||(target=this.svg());// Clean-up previously set transformations except the scale. If we didn't clean up the\n// previous transformations then they'd add up with the old ones. Scale is an exception as\n// it doesn't add up, consider: `this.scale(2).scale(2).scale(2)`. The result is that the\n// element is scaled by the factor 2, not 8.\nvar scale=this.scale();this.attr('transform','');var bbox=this.getBBox({target:target}).scale(scale.sx,scale.sy);// 1. Translate to origin.\nvar translateToOrigin=V.createSVGTransform();translateToOrigin.setTranslate(-bbox.x-bbox.width/2,-bbox.y-bbox.height/2);// 2. Rotate around origin.\nvar rotateAroundOrigin=V.createSVGTransform();var angle=position.angleBetween(reference,position.clone().offset(1,0));if(angle){rotateAroundOrigin.setRotate(angle,0,0);}// 3. Translate to the `position` + the offset (half my width) towards the `reference` point.\nvar translateFromOrigin=V.createSVGTransform();var finalPosition=position.clone().move(reference,bbox.width/2);translateFromOrigin.setTranslate(2*position.x-finalPosition.x,2*position.y-finalPosition.y);// 4. Get the current transformation matrix of this node\nvar ctm=this.getTransformToElement(target);// 5. Apply transformations and the scale\nvar transform=V.createSVGTransform();transform.setMatrix(translateFromOrigin.matrix.multiply(rotateAroundOrigin.matrix.multiply(translateToOrigin.matrix.multiply(ctm.scale(scale.sx,scale.sy)))));this.attr('transform',V.matrixToTransformString(transform.matrix));return this;};VPrototype.animateAlongPath=function(attrs,path){path=V.toNode(path);var id=V.ensureId(path);var animateMotion=V('animateMotion',attrs);var mpath=V('mpath',{'xlink:href':'#'+id});animateMotion.append(mpath);this.append(animateMotion);try{animateMotion.node.beginElement();}catch(e){// Fallback for IE 9.\n// Run the animation programmatically if FakeSmile (`http://leunen.me/fakesmile/`) present\nif(document.documentElement.getAttribute('smiling')==='fake'){/* global getTargets:true, Animator:true, animators:true id2anim:true */ // Register the animation. (See `https://answers.launchpad.net/smil/+question/203333`)\nvar animation=animateMotion.node;animation.animators=[];var animationID=animation.getAttribute('id');if(animationID){id2anim[animationID]=animation;}var targets=getTargets(animation);for(var i=0,len=targets.length;i<len;i++){var target=targets[i];var animator=new Animator(animation,target,i);animators.push(animator);animation.animators[i]=animator;animator.register();}}}return this;};VPrototype.hasClass=function(className){return new RegExp('(\\\\s|^)'+className+'(\\\\s|$)').test(this.node.getAttribute('class'));};VPrototype.addClass=function(className){if(className&&!this.hasClass(className)){var prevClasses=this.node.getAttribute('class')||'';this.node.setAttribute('class',(prevClasses+' '+className).trim());}return this;};VPrototype.removeClass=function(className){if(className&&this.hasClass(className)){var newClasses=this.node.getAttribute('class').replace(new RegExp('(\\\\s|^)'+className+'(\\\\s|$)','g'),'$2');this.node.setAttribute('class',newClasses);}return this;};VPrototype.toggleClass=function(className,toAdd){var toRemove=V.isUndefined(toAdd)?this.hasClass(className):!toAdd;if(toRemove){this.removeClass(className);}else{this.addClass(className);}return this;};// Interpolate path by discrete points. The precision of the sampling\n// is controlled by `interval`. In other words, `sample()` will generate\n// a point on the path starting at the beginning of the path going to the end\n// every `interval` pixels.\n// The sampler can be very useful for e.g. finding intersection between two\n// paths (finding the two closest points from two samples).\nVPrototype.sample=function(interval){interval=interval||1;var node=this.node;var length=node.getTotalLength();var samples=[];var distance=0;var sample;while(distance<length){sample=node.getPointAtLength(distance);samples.push({x:sample.x,y:sample.y,distance:distance});distance+=interval;}return samples;};VPrototype.convertToPath=function(){var path=V('path');path.attr(this.attr());var d=this.convertToPathData();if(d){path.attr('d',d);}return path;};VPrototype.convertToPathData=function(){var tagName=this.tagName();switch(tagName){case'PATH':return this.attr('d');case'LINE':return V.convertLineToPathData(this.node);case'POLYGON':return V.convertPolygonToPathData(this.node);case'POLYLINE':return V.convertPolylineToPathData(this.node);case'ELLIPSE':return V.convertEllipseToPathData(this.node);case'CIRCLE':return V.convertCircleToPathData(this.node);case'RECT':return V.convertRectToPathData(this.node);}throw new Error(tagName+' cannot be converted to PATH.');};V.prototype.toGeometryShape=function(){var x,y,width,height,cx,cy,r,rx,ry,points,d,x1,x2,y1,y2;switch(this.tagName()){case'RECT':x=parseFloat(this.attr('x'))||0;y=parseFloat(this.attr('y'))||0;width=parseFloat(this.attr('width'))||0;height=parseFloat(this.attr('height'))||0;return new Rect(x,y,width,height);case'CIRCLE':cx=parseFloat(this.attr('cx'))||0;cy=parseFloat(this.attr('cy'))||0;r=parseFloat(this.attr('r'))||0;return new Ellipse({x:cx,y:cy},r,r);case'ELLIPSE':cx=parseFloat(this.attr('cx'))||0;cy=parseFloat(this.attr('cy'))||0;rx=parseFloat(this.attr('rx'))||0;ry=parseFloat(this.attr('ry'))||0;return new Ellipse({x:cx,y:cy},rx,ry);case'POLYLINE':points=V.getPointsFromSvgNode(this);return new Polyline(points);case'POLYGON':points=V.getPointsFromSvgNode(this);if(points.length>1){points.push(points[0]);}return new Polyline(points);case'PATH':d=this.attr('d');if(!Path.isDataSupported(d)){d=V.normalizePathData(d);}return new Path(d);case'LINE':x1=parseFloat(this.attr('x1'))||0;y1=parseFloat(this.attr('y1'))||0;x2=parseFloat(this.attr('x2'))||0;y2=parseFloat(this.attr('y2'))||0;return new Line({x:x1,y:y1},{x:x2,y:y2});}// Anything else is a rectangle\nreturn this.getBBox();};// Find the intersection of a line starting in the center\n// of the SVG `node` ending in the point `ref`.\n// `target` is an SVG element to which `node`s transformations are relative to.\n// Note that `ref` point must be in the coordinate system of the `target` for this function to work properly.\n// Returns a point in the `target` coordinate system (the same system as `ref` is in) if\n// an intersection is found. Returns `undefined` otherwise.\nVPrototype.findIntersection=function(ref,target){var svg=this.svg().node;target=target||svg;var bbox=this.getBBox({target:target});var center=bbox.center();if(!bbox.intersectionWithLineFromCenterToPoint(ref)){return undefined;}var spot;var tagName=this.tagName();// Little speed up optimization for `<rect>` element. We do not do conversion\n// to path element and sampling but directly calculate the intersection through\n// a transformed geometrical rectangle.\nif(tagName==='RECT'){var gRect=new Rect(parseFloat(this.attr('x')||0),parseFloat(this.attr('y')||0),parseFloat(this.attr('width')),parseFloat(this.attr('height')));// Get the rect transformation matrix with regards to the SVG document.\nvar rectMatrix=this.getTransformToElement(target);// Decompose the matrix to find the rotation angle.\nvar rectMatrixComponents=V.decomposeMatrix(rectMatrix);// Now we want to rotate the rectangle back so that we\n// can use `intersectionWithLineFromCenterToPoint()` passing the angle as the second argument.\nvar resetRotation=svg.createSVGTransform();resetRotation.setRotate(-rectMatrixComponents.rotation,center.x,center.y);var rect=V.transformRect(gRect,resetRotation.matrix.multiply(rectMatrix));spot=new Rect(rect).intersectionWithLineFromCenterToPoint(ref,rectMatrixComponents.rotation);}else if(tagName==='PATH'||tagName==='POLYGON'||tagName==='POLYLINE'||tagName==='CIRCLE'||tagName==='ELLIPSE'){var pathNode=tagName==='PATH'?this:this.convertToPath();var samples=pathNode.sample();var minDistance=Infinity;var closestSamples=[];var i,sample,gp,centerDistance,refDistance,distance;for(i=0;i<samples.length;i++){sample=samples[i];// Convert the sample point in the local coordinate system to the global coordinate system.\ngp=V.createSVGPoint(sample.x,sample.y);gp=gp.matrixTransform(this.getTransformToElement(target));sample=new Point(gp);centerDistance=sample.distance(center);// Penalize a higher distance to the reference point by 10%.\n// This gives better results. This is due to\n// inaccuracies introduced by rounding errors and getPointAtLength() returns.\nrefDistance=sample.distance(ref)*1.1;distance=centerDistance+refDistance;if(distance<minDistance){minDistance=distance;closestSamples=[{sample:sample,refDistance:refDistance}];}else if(distance<minDistance+1){closestSamples.push({sample:sample,refDistance:refDistance});}}closestSamples.sort(function(a,b){return a.refDistance-b.refDistance;});if(closestSamples[0]){spot=closestSamples[0].sample;}}return spot;};/**\n\t     * @private\n\t     * @param {string} name\n\t     * @param {string} value\n\t     * @returns {Vectorizer}\n\t     */VPrototype.setAttribute=function(name,value){var el=this.node;if(value===null){this.removeAttr(name);return this;}var qualifiedName=V.qualifyAttr(name);if(qualifiedName.ns){// Attribute names can be namespaced. E.g. `image` elements\n// have a `xlink:href` attribute to set the source of the image.\nel.setAttributeNS(qualifiedName.ns,name,value);}else if(name==='id'){el.id=value;}else{el.setAttribute(name,value);}return this;};// Create an SVG document element.\n// If `content` is passed, it will be used as the SVG content of the `<svg>` root element.\nV.createSvgDocument=function(content){if(content){var XMLString=\"<svg xmlns=\\\"\"+ns.svg+\"\\\" xmlns:xlink=\\\"\"+ns.xlink+\"\\\" version=\\\"\"+SVGVersion+\"\\\">\"+content+\"</svg>\";var ref=V.parseXML(XMLString,{async:false});var documentElement=ref.documentElement;return documentElement;}var svg=document.createElementNS(ns.svg,'svg');svg.setAttributeNS(ns.xmlns,'xmlns:xlink',ns.xlink);svg.setAttribute('version',SVGVersion);return svg;};V.createSVGStyle=function(stylesheet){var ref=V('style',{type:'text/css'},[V.createCDATASection(stylesheet)]);var node=ref.node;return node;},V.createCDATASection=function(data){if(data===void 0)data='';var xml=document.implementation.createDocument(null,'xml',null);return xml.createCDATASection(data);};V.idCounter=0;// A function returning a unique identifier for this client session with every call.\nV.uniqueId=function(){return'v-'+ ++V.idCounter;};V.toNode=function(el){return V.isV(el)?el.node:el.nodeName&&el||el[0];};V.ensureId=function(node){node=V.toNode(node);return node.id||(node.id=V.uniqueId());};// Replace all spaces with the Unicode No-break space (http://www.fileformat.info/info/unicode/char/a0/index.htm).\n// IE would otherwise collapse all spaces into one. This is used in the text() method but it is\n// also exposed so that the programmer can use it in case he needs to. This is useful e.g. in tests\n// when you want to compare the actual DOM text content without having to add the unicode character in\n// the place of all spaces.\nV.sanitizeText=function(text){return(text||'').replace(/ /g,'\\u00A0');};V.isUndefined=function(value){return typeof value==='undefined';};V.isString=function(value){return typeof value==='string';};V.isObject=function(value){return value&&typeof value==='object';};V.isArray=Array.isArray;V.parseXML=function(data,opt){opt=opt||{};var xml;try{var parser=new DOMParser();if(!V.isUndefined(opt.async)){parser.async=opt.async;}xml=parser.parseFromString(data,'text/xml');}catch(error){xml=undefined;}if(!xml||xml.getElementsByTagName('parsererror').length){throw new Error('Invalid XML: '+data);}return xml;};/**\n\t     * @param {string} name\n\t     * @returns {{ns: string|null, local: string}} namespace and attribute name\n\t     */V.qualifyAttr=function(name){if(name.indexOf(':')!==-1){var combinedKey=name.split(':');return{ns:ns[combinedKey[0]],local:combinedKey[1]};}return{ns:null,local:name};};V.transformRegex=/(\\w+)\\(([^,)]+),?([^)]+)?\\)/gi;V.transformSeparatorRegex=/[ ,]+/;V.transformationListRegex=/^(\\w+)\\((.*)\\)/;V.transformStringToMatrix=function(transform){var transformationMatrix=V.createSVGMatrix();var matches=transform&&transform.match(V.transformRegex);if(!matches){return transformationMatrix;}for(var i=0,n=matches.length;i<n;i++){var transformationString=matches[i];var transformationMatch=transformationString.match(V.transformationListRegex);if(transformationMatch){var sx,sy,tx,ty,angle;var ctm=V.createSVGMatrix();var args=transformationMatch[2].split(V.transformSeparatorRegex);switch(transformationMatch[1].toLowerCase()){case'scale':sx=parseFloat(args[0]);sy=args[1]===undefined?sx:parseFloat(args[1]);ctm=ctm.scaleNonUniform(sx,sy);break;case'translate':tx=parseFloat(args[0]);ty=parseFloat(args[1]);ctm=ctm.translate(tx,ty);break;case'rotate':angle=parseFloat(args[0]);tx=parseFloat(args[1])||0;ty=parseFloat(args[2])||0;if(tx!==0||ty!==0){ctm=ctm.translate(tx,ty).rotate(angle).translate(-tx,-ty);}else{ctm=ctm.rotate(angle);}break;case'skewx':angle=parseFloat(args[0]);ctm=ctm.skewX(angle);break;case'skewy':angle=parseFloat(args[0]);ctm=ctm.skewY(angle);break;case'matrix':ctm.a=parseFloat(args[0]);ctm.b=parseFloat(args[1]);ctm.c=parseFloat(args[2]);ctm.d=parseFloat(args[3]);ctm.e=parseFloat(args[4]);ctm.f=parseFloat(args[5]);break;default:continue;}transformationMatrix=transformationMatrix.multiply(ctm);}}return transformationMatrix;};V.matrixToTransformString=function(matrix){matrix||(matrix=true);return'matrix('+(matrix.a!==undefined?matrix.a:1)+','+(matrix.b!==undefined?matrix.b:0)+','+(matrix.c!==undefined?matrix.c:0)+','+(matrix.d!==undefined?matrix.d:1)+','+(matrix.e!==undefined?matrix.e:0)+','+(matrix.f!==undefined?matrix.f:0)+')';};V.parseTransformString=function(transform){var translate,rotate,scale;if(transform){var separator=V.transformSeparatorRegex;// Allow reading transform string with a single matrix\nif(transform.trim().indexOf('matrix')>=0){var matrix=V.transformStringToMatrix(transform);var decomposedMatrix=V.decomposeMatrix(matrix);translate=[decomposedMatrix.translateX,decomposedMatrix.translateY];scale=[decomposedMatrix.scaleX,decomposedMatrix.scaleY];rotate=[decomposedMatrix.rotation];var transformations=[];if(translate[0]!==0||translate[1]!==0){transformations.push('translate('+translate+')');}if(scale[0]!==1||scale[1]!==1){transformations.push('scale('+scale+')');}if(rotate[0]!==0){transformations.push('rotate('+rotate+')');}transform=transformations.join(' ');}else{var translateMatch=transform.match(/translate\\((.*?)\\)/);if(translateMatch){translate=translateMatch[1].split(separator);}var rotateMatch=transform.match(/rotate\\((.*?)\\)/);if(rotateMatch){rotate=rotateMatch[1].split(separator);}var scaleMatch=transform.match(/scale\\((.*?)\\)/);if(scaleMatch){scale=scaleMatch[1].split(separator);}}}var sx=scale&&scale[0]?parseFloat(scale[0]):1;return{value:transform,translate:{tx:translate&&translate[0]?parseInt(translate[0],10):0,ty:translate&&translate[1]?parseInt(translate[1],10):0},rotate:{angle:rotate&&rotate[0]?parseInt(rotate[0],10):0,cx:rotate&&rotate[1]?parseInt(rotate[1],10):undefined,cy:rotate&&rotate[2]?parseInt(rotate[2],10):undefined},scale:{sx:sx,sy:scale&&scale[1]?parseFloat(scale[1]):sx}};};V.deltaTransformPoint=function(matrix,point){var dx=point.x*matrix.a+point.y*matrix.c+0;var dy=point.x*matrix.b+point.y*matrix.d+0;return{x:dx,y:dy};};V.decomposeMatrix=function(matrix){// @see https://gist.github.com/2052247\n// calculate delta transform point\nvar px=V.deltaTransformPoint(matrix,{x:0,y:1});var py=V.deltaTransformPoint(matrix,{x:1,y:0});// calculate skew\nvar skewX=180/PI*atan2(px.y,px.x)-90;var skewY=180/PI*atan2(py.y,py.x);return{translateX:matrix.e,translateY:matrix.f,scaleX:sqrt(matrix.a*matrix.a+matrix.b*matrix.b),scaleY:sqrt(matrix.c*matrix.c+matrix.d*matrix.d),skewX:skewX,skewY:skewY,rotation:skewX// rotation is the same as skew x\n};};// Return the `scale` transformation from the following equation:\n// `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`\nV.matrixToScale=function(matrix){var a,b,c,d;if(matrix){a=V.isUndefined(matrix.a)?1:matrix.a;d=V.isUndefined(matrix.d)?1:matrix.d;b=matrix.b;c=matrix.c;}else{a=d=1;}return{sx:b?sqrt(a*a+b*b):a,sy:c?sqrt(c*c+d*d):d};};// Return the `rotate` transformation from the following equation:\n// `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`\nV.matrixToRotate=function(matrix){var p={x:0,y:1};if(matrix){p=V.deltaTransformPoint(matrix,p);}return{angle:normalizeAngle(toDeg(atan2(p.y,p.x))-90)};};// Return the `translate` transformation from the following equation:\n// `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`\nV.matrixToTranslate=function(matrix){return{tx:matrix&&matrix.e||0,ty:matrix&&matrix.f||0};};V.isV=function(object){return object instanceof V;};// For backwards compatibility:\nV.isVElement=V.isV;// Element implements `getBBox()`, `getCTM()` and `getScreenCTM()`\n// https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement\nV.isSVGGraphicsElement=function(node){if(!node){return false;}node=V.toNode(node);// IE/Edge does not implement SVGGraphicsElement interface, thus check for `getScreenCTM` below\nreturn node instanceof SVGElement&&typeof node.getScreenCTM==='function';};var svgDocument=V('svg').node;V.createSVGMatrix=function(matrix){var svgMatrix=svgDocument.createSVGMatrix();for(var component in matrix){svgMatrix[component]=matrix[component];}return svgMatrix;};V.createSVGTransform=function(matrix){if(!V.isUndefined(matrix)){if(!(matrix instanceof SVGMatrix)){matrix=V.createSVGMatrix(matrix);}return svgDocument.createSVGTransformFromMatrix(matrix);}return svgDocument.createSVGTransform();};V.createSVGPoint=function(x,y){var p=svgDocument.createSVGPoint();p.x=x;p.y=y;return p;};V.transformRect=function(r,matrix){var p=svgDocument.createSVGPoint();p.x=r.x;p.y=r.y;var corner1=p.matrixTransform(matrix);p.x=r.x+r.width;p.y=r.y;var corner2=p.matrixTransform(matrix);p.x=r.x+r.width;p.y=r.y+r.height;var corner3=p.matrixTransform(matrix);p.x=r.x;p.y=r.y+r.height;var corner4=p.matrixTransform(matrix);var minX=min(corner1.x,corner2.x,corner3.x,corner4.x);var maxX=max(corner1.x,corner2.x,corner3.x,corner4.x);var minY=min(corner1.y,corner2.y,corner3.y,corner4.y);var maxY=max(corner1.y,corner2.y,corner3.y,corner4.y);return new Rect(minX,minY,maxX-minX,maxY-minY);};V.transformPoint=function(p,matrix){return new Point(V.createSVGPoint(p.x,p.y).matrixTransform(matrix));};V.transformLine=function(l,matrix){return new Line(V.transformPoint(l.start,matrix),V.transformPoint(l.end,matrix));};V.transformPolyline=function(p,matrix){var inPoints=p instanceof Polyline?p.points:p;if(!V.isArray(inPoints)){inPoints=[];}var outPoints=[];for(var i=0,n=inPoints.length;i<n;i++){outPoints[i]=V.transformPoint(inPoints[i],matrix);}return new Polyline(outPoints);};// Convert a style represented as string (e.g. `'fill=\"blue\"; stroke=\"red\"'`) to\n// an object (`{ fill: 'blue', stroke: 'red' }`).\nV.styleToObject=function(styleString){var ret={};var styles=styleString.split(';');for(var i=0;i<styles.length;i++){var style=styles[i];var pair=style.split('=');ret[pair[0].trim()]=pair[1].trim();}return ret;};// Inspired by d3.js https://github.com/mbostock/d3/blob/master/src/svg/arc.js\nV.createSlicePathData=function(innerRadius,outerRadius,startAngle,endAngle){var svgArcMax=2*PI-1e-6;var r0=innerRadius;var r1=outerRadius;var a0=startAngle;var a1=endAngle;var da=(a1<a0&&(da=a0,a0=a1,a1=da),a1-a0);var df=da<PI?'0':'1';var c0=cos(a0);var s0=sin(a0);var c1=cos(a1);var s1=sin(a1);return da>=svgArcMax?r0?'M0,'+r1+'A'+r1+','+r1+' 0 1,1 0,'+-r1+'A'+r1+','+r1+' 0 1,1 0,'+r1+'M0,'+r0+'A'+r0+','+r0+' 0 1,0 0,'+-r0+'A'+r0+','+r0+' 0 1,0 0,'+r0+'Z':'M0,'+r1+'A'+r1+','+r1+' 0 1,1 0,'+-r1+'A'+r1+','+r1+' 0 1,1 0,'+r1+'Z':r0?'M'+r1*c0+','+r1*s0+'A'+r1+','+r1+' 0 '+df+',1 '+r1*c1+','+r1*s1+'L'+r0*c1+','+r0*s1+'A'+r0+','+r0+' 0 '+df+',0 '+r0*c0+','+r0*s0+'Z':'M'+r1*c0+','+r1*s0+'A'+r1+','+r1+' 0 '+df+',1 '+r1*c1+','+r1*s1+'L0,0'+'Z';};// Merge attributes from object `b` with attributes in object `a`.\n// Note that this modifies the object `a`.\n// Also important to note that attributes are merged but CSS classes are concatenated.\nV.mergeAttrs=function(a,b){for(var attr in b){if(attr==='class'){// Concatenate classes.\na[attr]=a[attr]?a[attr]+' '+b[attr]:b[attr];}else if(attr==='style'){// `style` attribute can be an object.\nif(V.isObject(a[attr])&&V.isObject(b[attr])){// `style` stored in `a` is an object.\na[attr]=V.mergeAttrs(a[attr],b[attr]);}else if(V.isObject(a[attr])){// `style` in `a` is an object but it's a string in `b`.\n// Convert the style represented as a string to an object in `b`.\na[attr]=V.mergeAttrs(a[attr],V.styleToObject(b[attr]));}else if(V.isObject(b[attr])){// `style` in `a` is a string, in `b` it's an object.\na[attr]=V.mergeAttrs(V.styleToObject(a[attr]),b[attr]);}else{// Both styles are strings.\na[attr]=V.mergeAttrs(V.styleToObject(a[attr]),V.styleToObject(b[attr]));}}else{a[attr]=b[attr];}}return a;};V.annotateString=function(t,annotations,opt){annotations=annotations||[];opt=opt||{};var offset=opt.offset||0;var compacted=[];var batch;var ret=[];var item;var prev;for(var i=0;i<t.length;i++){item=ret[i]=t[i];for(var j=0;j<annotations.length;j++){var annotation=annotations[j];var start=annotation.start+offset;var end=annotation.end+offset;if(i>=start&&i<end){// Annotation applies.\nif(V.isObject(item)){// There is more than one annotation to be applied => Merge attributes.\nitem.attrs=V.mergeAttrs(V.mergeAttrs({},item.attrs),annotation.attrs);}else{item=ret[i]={t:t[i],attrs:annotation.attrs};}if(opt.includeAnnotationIndices){(item.annotations||(item.annotations=[])).push(j);}}}prev=ret[i-1];if(!prev){batch=item;}else if(V.isObject(item)&&V.isObject(prev)){// Both previous item and the current one are annotations. If the attributes\n// didn't change, merge the text.\nif(JSON.stringify(item.attrs)===JSON.stringify(prev.attrs)){batch.t+=item.t;}else{compacted.push(batch);batch=item;}}else if(V.isObject(item)){// Previous item was a string, current item is an annotation.\ncompacted.push(batch);batch=item;}else if(V.isObject(prev)){// Previous item was an annotation, current item is a string.\ncompacted.push(batch);batch=item;}else{// Both previous and current item are strings.\nbatch=(batch||'')+item;}}if(batch){compacted.push(batch);}return compacted;};V.findAnnotationsAtIndex=function(annotations,index){var found=[];if(annotations){annotations.forEach(function(annotation){if(annotation.start<index&&index<=annotation.end){found.push(annotation);}});}return found;};V.findAnnotationsBetweenIndexes=function(annotations,start,end){var found=[];if(annotations){annotations.forEach(function(annotation){if(start>=annotation.start&&start<annotation.end||end>annotation.start&&end<=annotation.end||annotation.start>=start&&annotation.end<end){found.push(annotation);}});}return found;};// Shift all the text annotations after character `index` by `offset` positions.\nV.shiftAnnotations=function(annotations,index,offset){if(annotations){annotations.forEach(function(annotation){if(annotation.start<index&&annotation.end>=index){annotation.end+=offset;}else if(annotation.start>=index){annotation.start+=offset;annotation.end+=offset;}});}return annotations;};V.convertLineToPathData=function(line){line=V(line);var d=['M',line.attr('x1'),line.attr('y1'),'L',line.attr('x2'),line.attr('y2')].join(' ');return d;};V.convertPolygonToPathData=function(polygon){var points=V.getPointsFromSvgNode(polygon);if(points.length===0){return null;}return V.svgPointsToPath(points)+' Z';};V.convertPolylineToPathData=function(polyline){var points=V.getPointsFromSvgNode(polyline);if(points.length===0){return null;}return V.svgPointsToPath(points);};V.svgPointsToPath=function(points){for(var i=0,n=points.length;i<n;i++){points[i]=points[i].x+' '+points[i].y;}return'M '+points.join(' L');};V.getPointsFromSvgNode=function(node){node=V.toNode(node);var points=[];var nodePoints=node.points;if(nodePoints){for(var i=0,n=nodePoints.numberOfItems;i<n;i++){points.push(nodePoints.getItem(i));}}return points;};V.KAPPA=0.551784;V.convertCircleToPathData=function(circle){circle=V(circle);var cx=parseFloat(circle.attr('cx'))||0;var cy=parseFloat(circle.attr('cy'))||0;var r=parseFloat(circle.attr('r'));var cd=r*V.KAPPA;// Control distance.\nvar d=['M',cx,cy-r,// Move to the first point.\n'C',cx+cd,cy-r,cx+r,cy-cd,cx+r,cy,// I. Quadrant.\n'C',cx+r,cy+cd,cx+cd,cy+r,cx,cy+r,// II. Quadrant.\n'C',cx-cd,cy+r,cx-r,cy+cd,cx-r,cy,// III. Quadrant.\n'C',cx-r,cy-cd,cx-cd,cy-r,cx,cy-r,// IV. Quadrant.\n'Z'].join(' ');return d;};V.convertEllipseToPathData=function(ellipse){ellipse=V(ellipse);var cx=parseFloat(ellipse.attr('cx'))||0;var cy=parseFloat(ellipse.attr('cy'))||0;var rx=parseFloat(ellipse.attr('rx'));var ry=parseFloat(ellipse.attr('ry'))||rx;var cdx=rx*V.KAPPA;// Control distance x.\nvar cdy=ry*V.KAPPA;// Control distance y.\nvar d=['M',cx,cy-ry,// Move to the first point.\n'C',cx+cdx,cy-ry,cx+rx,cy-cdy,cx+rx,cy,// I. Quadrant.\n'C',cx+rx,cy+cdy,cx+cdx,cy+ry,cx,cy+ry,// II. Quadrant.\n'C',cx-cdx,cy+ry,cx-rx,cy+cdy,cx-rx,cy,// III. Quadrant.\n'C',cx-rx,cy-cdy,cx-cdx,cy-ry,cx,cy-ry,// IV. Quadrant.\n'Z'].join(' ');return d;};V.convertRectToPathData=function(rect){rect=V(rect);return V.rectToPath({x:parseFloat(rect.attr('x'))||0,y:parseFloat(rect.attr('y'))||0,width:parseFloat(rect.attr('width'))||0,height:parseFloat(rect.attr('height'))||0,rx:parseFloat(rect.attr('rx'))||0,ry:parseFloat(rect.attr('ry'))||0});};// Convert a rectangle to SVG path commands. `r` is an object of the form:\n// `{ x: [number], y: [number], width: [number], height: [number], top-ry: [number], top-ry: [number], bottom-rx: [number], bottom-ry: [number] }`,\n// where `x, y, width, height` are the usual rectangle attributes and [top-/bottom-]rx/ry allows for\n// specifying radius of the rectangle for all its sides (as opposed to the built-in SVG rectangle\n// that has only `rx` and `ry` attributes).\nV.rectToPath=function(r){var d;var x=r.x;var y=r.y;var width=r.width;var height=r.height;var topRx=min(r.rx||r['top-rx']||0,width/2);var bottomRx=min(r.rx||r['bottom-rx']||0,width/2);var topRy=min(r.ry||r['top-ry']||0,height/2);var bottomRy=min(r.ry||r['bottom-ry']||0,height/2);if(topRx||bottomRx||topRy||bottomRy){d=['M',x,y+topRy,'v',height-topRy-bottomRy,'a',bottomRx,bottomRy,0,0,0,bottomRx,bottomRy,'h',width-2*bottomRx,'a',bottomRx,bottomRy,0,0,0,bottomRx,-bottomRy,'v',-(height-bottomRy-topRy),'a',topRx,topRy,0,0,0,-topRx,-topRy,'h',-(width-2*topRx),'a',topRx,topRy,0,0,0,-topRx,topRy,'Z'];}else{d=['M',x,y,'H',x+width,'V',y+height,'H',x,'V',y,'Z'];}return d.join(' ');};// Take a path data string\n// Return a normalized path data string\n// If data cannot be parsed, return 'M 0 0'\n// Adapted from Rappid normalizePath polyfill\n// Highly inspired by Raphael Library (www.raphael.com)\nV.normalizePathData=function(){var spaces='\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029';var pathCommand=new RegExp('([a-z])['+spaces+',]*((-?\\\\d*\\\\.?\\\\d*(?:e[\\\\-+]?\\\\d+)?['+spaces+']*,?['+spaces+']*)+)','ig');var pathValues=new RegExp('(-?\\\\d*\\\\.?\\\\d*(?:e[\\\\-+]?\\\\d+)?)['+spaces+']*,?['+spaces+']*','ig');var math=Math;var PI=math.PI;var sin=math.sin;var cos=math.cos;var tan=math.tan;var asin=math.asin;var sqrt=math.sqrt;var abs=math.abs;function q2c(x1,y1,ax,ay,x2,y2){var _13=1/3;var _23=2/3;return[_13*x1+_23*ax,_13*y1+_23*ay,_13*x2+_23*ax,_13*y2+_23*ay,x2,y2];}function rotate(x,y,rad){var X=x*cos(rad)-y*sin(rad);var Y=x*sin(rad)+y*cos(rad);return{x:X,y:Y};}function a2c(x1,y1,rx,ry,angle,large_arc_flag,sweep_flag,x2,y2,recursive){// for more information of where this math came from visit:\n// http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\nvar _120=PI*120/180;var rad=PI/180*(+angle||0);var res=[];var xy;if(!recursive){xy=rotate(x1,y1,-rad);x1=xy.x;y1=xy.y;xy=rotate(x2,y2,-rad);x2=xy.x;y2=xy.y;var x=(x1-x2)/2;var y=(y1-y2)/2;var h=x*x/(rx*rx)+y*y/(ry*ry);if(h>1){h=sqrt(h);rx=h*rx;ry=h*ry;}var rx2=rx*rx;var ry2=ry*ry;var k=(large_arc_flag==sweep_flag?-1:1)*sqrt(abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x)));var cx=k*rx*y/ry+(x1+x2)/2;var cy=k*-ry*x/rx+(y1+y2)/2;var f1=asin(((y1-cy)/ry).toFixed(9));var f2=asin(((y2-cy)/ry).toFixed(9));f1=x1<cx?PI-f1:f1;f2=x2<cx?PI-f2:f2;if(f1<0){f1=PI*2+f1;}if(f2<0){f2=PI*2+f2;}if(sweep_flag&&f1>f2){f1=f1-PI*2;}if(!sweep_flag&&f2>f1){f2=f2-PI*2;}}else{f1=recursive[0];f2=recursive[1];cx=recursive[2];cy=recursive[3];}var df=f2-f1;if(abs(df)>_120){var f2old=f2;var x2old=x2;var y2old=y2;f2=f1+_120*(sweep_flag&&f2>f1?1:-1);x2=cx+rx*cos(f2);y2=cy+ry*sin(f2);res=a2c(x2,y2,rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy]);}df=f2-f1;var c1=cos(f1);var s1=sin(f1);var c2=cos(f2);var s2=sin(f2);var t=tan(df/4);var hx=4/3*(rx*t);var hy=4/3*(ry*t);var m1=[x1,y1];var m2=[x1+hx*s1,y1-hy*c1];var m3=[x2+hx*s2,y2-hy*c2];var m4=[x2,y2];m2[0]=2*m1[0]-m2[0];m2[1]=2*m1[1]-m2[1];if(recursive){return[m2,m3,m4].concat(res);}else{res=[m2,m3,m4].concat(res).join().split(',');var newres=[];var ii=res.length;for(var i=0;i<ii;i++){newres[i]=i%2?rotate(res[i-1],res[i],rad).y:rotate(res[i],res[i+1],rad).x;}return newres;}}function parsePathString(pathString){if(!pathString){return null;}var paramCounts={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};var data=[];String(pathString).replace(pathCommand,function(a,b,c){var params=[];var name=b.toLowerCase();c.replace(pathValues,function(a,b){if(b){params.push(+b);}});if(name==='m'&&params.length>2){data.push([b].concat(params.splice(0,2)));name='l';b=b==='m'?'l':'L';}while(params.length>=paramCounts[name]){data.push([b].concat(params.splice(0,paramCounts[name])));if(!paramCounts[name]){break;}}});return data;}function pathToAbsolute(pathArray){if(!Array.isArray(pathArray)||!Array.isArray(pathArray&&pathArray[0])){// rough assumption\npathArray=parsePathString(pathArray);}// if invalid string, return 'M 0 0'\nif(!pathArray||!pathArray.length){return[['M',0,0]];}var res=[];var x=0;var y=0;var mx=0;var my=0;var start=0;var pa0;var ii=pathArray.length;for(var i=start;i<ii;i++){var r=[];res.push(r);var pa=pathArray[i];pa0=pa[0];if(pa0!=pa0.toUpperCase()){r[0]=pa0.toUpperCase();var jj;var j;switch(r[0]){case'A':r[1]=pa[1];r[2]=pa[2];r[3]=pa[3];r[4]=pa[4];r[5]=pa[5];r[6]=+pa[6]+x;r[7]=+pa[7]+y;break;case'V':r[1]=+pa[1]+y;break;case'H':r[1]=+pa[1]+x;break;case'M':mx=+pa[1]+x;my=+pa[2]+y;jj=pa.length;for(j=1;j<jj;j++){r[j]=+pa[j]+(j%2?x:y);}break;default:jj=pa.length;for(j=1;j<jj;j++){r[j]=+pa[j]+(j%2?x:y);}break;}}else{var kk=pa.length;for(var k=0;k<kk;k++){r[k]=pa[k];}}switch(r[0]){case'Z':x=+mx;y=+my;break;case'H':x=r[1];break;case'V':y=r[1];break;case'M':mx=r[r.length-2];my=r[r.length-1];x=r[r.length-2];y=r[r.length-1];break;default:x=r[r.length-2];y=r[r.length-1];break;}}return res;}function normalize(path){var p=pathToAbsolute(path);var attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function processPath(path,d,pcom){var nx,ny;if(!path){return['C',d.x,d.y,d.x,d.y,d.x,d.y];}if(!(path[0]in{T:1,Q:1})){d.qx=null;d.qy=null;}switch(path[0]){case'M':d.X=path[1];d.Y=path[2];break;case'A':if(parseFloat(path[1])===0||parseFloat(path[2])===0){// https://www.w3.org/TR/SVG/paths.html#ArcOutOfRangeParameters\n// \"If either rx or ry is 0, then this arc is treated as a\n// straight line segment (a \"lineto\") joining the endpoints.\"\npath=['L',path[6],path[7]];}else{path=['C'].concat(a2c.apply(0,[d.x,d.y].concat(path.slice(1))));}break;case'S':if(pcom==='C'||pcom==='S'){// In 'S' case we have to take into account, if the previous command is C/S.\nnx=d.x*2-d.bx;// And reflect the previous\nny=d.y*2-d.by;// command's control point relative to the current point.\n}else{// or some else or nothing\nnx=d.x;ny=d.y;}path=['C',nx,ny].concat(path.slice(1));break;case'T':if(pcom==='Q'||pcom==='T'){// In 'T' case we have to take into account, if the previous command is Q/T.\nd.qx=d.x*2-d.qx;// And make a reflection similar\nd.qy=d.y*2-d.qy;// to case 'S'.\n}else{// or something else or nothing\nd.qx=d.x;d.qy=d.y;}path=['C'].concat(q2c(d.x,d.y,d.qx,d.qy,path[1],path[2]));break;case'Q':d.qx=path[1];d.qy=path[2];path=['C'].concat(q2c(d.x,d.y,path[1],path[2],path[3],path[4]));break;case'H':path=['L'].concat(path[1],d.y);break;case'V':path=['L'].concat(d.x,path[1]);break;case'L':break;case'Z':break;}return path;}function fixArc(pp,i){if(pp[i].length>7){pp[i].shift();var pi=pp[i];while(pi.length){pcoms[i]='A';// if created multiple 'C's, their original seg is saved\npp.splice(i++,0,['C'].concat(pi.splice(0,6)));}pp.splice(i,1);ii=p.length;}}var pcoms=[];// path commands of original path p\nvar pfirst='';// temporary holder for original path command\nvar pcom='';// holder for previous path command of original path\nvar ii=p.length;for(var i=0;i<ii;i++){if(p[i]){pfirst=p[i][0];}// save current path command\nif(pfirst!=='C'){// C is not saved yet, because it may be result of conversion\npcoms[i]=pfirst;// Save current path command\nif(i>0){pcom=pcoms[i-1];}// Get previous path command pcom\n}p[i]=processPath(p[i],attrs,pcom);// Previous path command is inputted to processPath\nif(pcoms[i]!=='A'&&pfirst==='C'){pcoms[i]='C';}// 'A' is the only command\n// which may produce multiple 'C's\n// so we have to make sure that 'C' is also 'C' in original path\nfixArc(p,i);// fixArc adds also the right amount of 'A's to pcoms\nvar seg=p[i];var seglen=seg.length;attrs.x=seg[seglen-2];attrs.y=seg[seglen-1];attrs.bx=parseFloat(seg[seglen-4])||attrs.x;attrs.by=parseFloat(seg[seglen-3])||attrs.y;}// make sure normalized path data string starts with an M segment\nif(!p[0][0]||p[0][0]!=='M'){p.unshift(['M',0,0]);}return p;}return function(pathData){return normalize(pathData).join(',').split(',').join(' ');};}();V.namespace=ns;V.g=g;return V;}();var config={// When set to `true` the cell selectors could be defined as CSS selectors.\n// If not, only JSON Markup selectors are taken into account.\n// export let useCSSSelectors = true;\nuseCSSSelectors:true,// The class name prefix config is for advanced use only.\n// Be aware that if you change the prefix, the JointJS CSS will no longer function properly.\n// export let classNamePrefix = 'joint-';\n// export let defaultTheme = 'default';\nclassNamePrefix:'joint-',defaultTheme:'default',// The maximum delay required for two consecutive touchend events to be interpreted\n// as a double-tap.\ndoubleTapInterval:300};var addClassNamePrefix=function(className){if(!className){return className;}return className.toString().split(' ').map(function(_className){if(_className.substr(0,config.classNamePrefix.length)!==config.classNamePrefix){_className=config.classNamePrefix+_className;}return _className;}).join(' ');};var removeClassNamePrefix=function(className){if(!className){return className;}return className.toString().split(' ').map(function(_className){if(_className.substr(0,config.classNamePrefix.length)===config.classNamePrefix){_className=_className.substr(config.classNamePrefix.length);}return _className;}).join(' ');};var parseDOMJSON=function(json,namespace){var selectors={};var groupSelectors={};var svgNamespace=V.namespace.svg;var ns=namespace||svgNamespace;var fragment=document.createDocumentFragment();var queue=[json,fragment,ns];while(queue.length>0){ns=queue.pop();var parentNode=queue.pop();var siblingsDef=queue.pop();for(var i=0,n=siblingsDef.length;i<n;i++){var nodeDef=siblingsDef[i];// TagName\nif(!nodeDef.hasOwnProperty('tagName')){throw new Error('json-dom-parser: missing tagName');}var tagName=nodeDef.tagName;// Namespace URI\nif(nodeDef.hasOwnProperty('namespaceURI')){ns=nodeDef.namespaceURI;}var node=document.createElementNS(ns,tagName);var svg=ns===svgNamespace;var wrapper=svg?V:$;// Attributes\nvar attributes=nodeDef.attributes;if(attributes){wrapper(node).attr(attributes);}// Style\nvar style=nodeDef.style;if(style){$(node).css(style);}// ClassName\nif(nodeDef.hasOwnProperty('className')){var className=nodeDef.className;if(svg){node.className.baseVal=className;}else{node.className=className;}}// TextContent\nif(nodeDef.hasOwnProperty('textContent')){node.textContent=nodeDef.textContent;}// Selector\nif(nodeDef.hasOwnProperty('selector')){var nodeSelector=nodeDef.selector;if(selectors[nodeSelector]){throw new Error('json-dom-parser: selector must be unique');}selectors[nodeSelector]=node;wrapper(node).attr('joint-selector',nodeSelector);}// Groups\nif(nodeDef.hasOwnProperty('groupSelector')){var nodeGroups=nodeDef.groupSelector;if(!Array.isArray(nodeGroups)){nodeGroups=[nodeGroups];}for(var j=0,m=nodeGroups.length;j<m;j++){var nodeGroup=nodeGroups[j];var group=groupSelectors[nodeGroup];if(!group){group=groupSelectors[nodeGroup]=[];}group.push(node);}}parentNode.appendChild(node);// Children\nvar childrenDef=nodeDef.children;if(Array.isArray(childrenDef)){queue.push(childrenDef,node,ns);}}}return{fragment:fragment,selectors:selectors,groupSelectors:groupSelectors};};// Return a simple hash code from a string. See http://werxltd.com/wp/2010/05/13/javascript-implementation-of-javas-string-hashcode-method/.\nvar hashCode=function(str){var hash=0;if(str.length===0){return hash;}for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);hash=(hash<<5)-hash+c;hash=hash&hash;// Convert to 32bit integer\n}return hash;};var getByPath=function(obj,path,delimiter){var keys=Array.isArray(path)?path:path.split(delimiter||'/');var key;var i=0;var length=keys.length;while(i<length){key=keys[i++];if(Object(obj)===obj&&key in obj){obj=obj[key];}else{return undefined;}}return obj;};var isGetSafe=function(obj,key){// Prevent prototype pollution\n// https://snyk.io/vuln/SNYK-JS-JSON8MERGEPATCH-1038399\nif(typeof key!=='string'&&typeof key!=='number'){key=String(key);}if(key==='constructor'&&typeof obj[key]==='function'){return false;}if(key==='__proto__'){return false;}return true;};var setByPath=function(obj,path,value,delimiter){var keys=Array.isArray(path)?path:path.split(delimiter||'/');var last=keys.length-1;var diver=obj;var i=0;for(;i<last;i++){var key=keys[i];if(!isGetSafe(diver,key)){return obj;}var value$1=diver[key];// diver creates an empty object if there is no nested object under such a key.\n// This means that one can populate an empty nested object with setByPath().\ndiver=value$1||(diver[key]={});}diver[keys[last]]=value;return obj;};var unsetByPath=function(obj,path,delimiter){var keys=Array.isArray(path)?path:path.split(delimiter||'/');var last=keys.length-1;var diver=obj;var i=0;for(;i<last;i++){var key=keys[i];if(!isGetSafe(diver,key)){return obj;}var value=diver[key];if(!value){return obj;}diver=value;}delete diver[keys[last]];return obj;};var flattenObject=function(obj,delim,stop){delim=delim||'/';var ret={};for(var key in obj){if(!obj.hasOwnProperty(key)){continue;}var shouldGoDeeper=typeof obj[key]==='object';if(shouldGoDeeper&&stop&&stop(obj[key])){shouldGoDeeper=false;}if(shouldGoDeeper){var flatObject=flattenObject(obj[key],delim,stop);for(var flatKey in flatObject){if(!flatObject.hasOwnProperty(flatKey)){continue;}ret[key+delim+flatKey]=flatObject[flatKey];}}else{ret[key]=obj[key];}}return ret;};var uuid=function(){// credit: http://stackoverflow.com/posts/2117523/revisions\nreturn'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=c==='x'?r:r&0x3|0x8;return v.toString(16);});};// Generate global unique id for obj and store it as a property of the object.\nvar guid=function(obj){guid.id=guid.id||1;obj.id=obj.id===undefined?'j_'+guid.id++:obj.id;return obj.id;};var toKebabCase=function(string){return string.replace(/[A-Z]/g,'-$&').toLowerCase();};var normalizeEvent=function(evt){var normalizedEvent=evt;var touchEvt=evt.originalEvent&&evt.originalEvent.changedTouches&&evt.originalEvent.changedTouches[0];if(touchEvt){for(var property in evt){// copy all the properties from the input event that are not\n// defined on the touch event (functions included).\nif(touchEvt[property]===undefined){touchEvt[property]=evt[property];}}normalizedEvent=touchEvt;}// IE: evt.target could be set to SVGElementInstance for SVGUseElement\nvar target=normalizedEvent.target;if(target){var useElement=target.correspondingUseElement;if(useElement){normalizedEvent.target=useElement;}}return normalizedEvent;};var nextFrame=function(){var raf;if(typeof window!=='undefined'){raf=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;}if(!raf){var lastTime=0;raf=function(callback){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};}return function(callback,context){var rest=[],len=arguments.length-2;while(len-->0)rest[len]=arguments[len+2];return context!==undefined?raf(callback.bind.apply(callback,[context].concat(rest))):raf(callback);};}();var cancelFrame=function(){var caf;var client=typeof window!='undefined';if(client){caf=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame;}caf=caf||clearTimeout;return client?caf.bind(window):caf;}();/**\n\t * @deprecated\n\t */var shapePerimeterConnectionPoint=function(linkView,view,magnet,reference){var bbox;var spot;if(!magnet){// There is no magnet, try to make the best guess what is the\n// wrapping SVG element. This is because we want this \"smart\"\n// connection points to work out of the box without the\n// programmer to put magnet marks to any of the subelements.\n// For example, we want the function to work on basic.Path elements\n// without any special treatment of such elements.\n// The code below guesses the wrapping element based on\n// one simple assumption. The wrapping elemnet is the\n// first child of the scalable group if such a group exists\n// or the first child of the rotatable group if not.\n// This makese sense because usually the wrapping element\n// is below any other sub element in the shapes.\nvar scalable=view.$('.scalable')[0];var rotatable=view.$('.rotatable')[0];if(scalable&&scalable.firstChild){magnet=scalable.firstChild;}else if(rotatable&&rotatable.firstChild){magnet=rotatable.firstChild;}}if(magnet){spot=V(magnet).findIntersection(reference,linkView.paper.cells);if(!spot){bbox=V(magnet).getBBox({target:linkView.paper.cells});}}else{bbox=view.model.getBBox();spot=bbox.intersectionWithLineFromCenterToPoint(reference);}return spot||bbox.center();};var isPercentage=function(val){return isString(val)&&val.slice(-1)==='%';};var parseCssNumeric=function(val,restrictUnits){function getUnit(validUnitExp){// one or more numbers, followed by\n// any number of (\n//  `.`, followed by\n//  one or more numbers\n// ), followed by\n// `validUnitExp`, followed by\n// end of string\nvar matches=new RegExp('(?:\\\\d+(?:\\\\.\\\\d+)*)('+validUnitExp+')$').exec(val);if(!matches){return null;}return matches[1];}var number=parseFloat(val);// if `val` cannot be parsed as a number, return `null`\nif(Number.isNaN(number)){return null;}// else: we know `output.value`\nvar output={};output.value=number;// determine the unit\nvar validUnitExp;if(restrictUnits==null){// no restriction\n// accept any unit, as well as no unit\nvalidUnitExp='[A-Za-z]*';}else if(Array.isArray(restrictUnits)){// if this is an empty array, top restriction - return `null`\nif(restrictUnits.length===0){return null;}// else: restriction - an array of valid unit strings\nvalidUnitExp=restrictUnits.join('|');}else if(isString(restrictUnits)){// restriction - a single valid unit string\nvalidUnitExp=restrictUnits;}var unit=getUnit(validUnitExp);// if we found no matches for `restrictUnits`, return `null`\nif(unit===null){return null;}// else: we know the unit\noutput.unit=unit;return output;};var breakText=function(text,size,styles,opt){if(styles===void 0)styles={};if(opt===void 0)opt={};var width=size.width;var height=size.height;var svgDocument=opt.svgDocument||V('svg').node;var textSpan=V('tspan').node;var textElement=V('text').attr(styles).append(textSpan).node;var textNode=document.createTextNode('');// Prevent flickering\ntextElement.style.opacity=0;// Prevent FF from throwing an uncaught exception when `getBBox()`\n// called on element that is not in the render tree (is not measurable).\n// <tspan>.getComputedTextLength() returns always 0 in this case.\n// Note that the `textElement` resp. `textSpan` can become hidden\n// when it's appended to the DOM and a `display: none` CSS stylesheet\n// rule gets applied.\ntextElement.style.display='block';textSpan.style.display='block';textSpan.appendChild(textNode);svgDocument.appendChild(textElement);// lgtm [js/xss-through-dom]\nif(!opt.svgDocument){document.body.appendChild(svgDocument);}var separator=opt.separator||' ';var eol=opt.eol||'\\n';var hyphen=opt.hyphen?new RegExp(opt.hyphen):/[^\\w\\d]/;var maxLineCount=opt.maxLineCount;if(!isNumber(maxLineCount)){maxLineCount=Infinity;}var words=text.split(separator);var full=[];var lines=[];var p,h;var lineHeight;for(var i=0,l=0,len=words.length;i<len;i++){var word=words[i];if(!word){continue;}var isEol=false;if(eol&&word.indexOf(eol)>=0){// word contains end-of-line character\nif(word.length>1){// separate word and continue cycle\nvar eolWords=word.split(eol);for(var j=0,jl=eolWords.length-1;j<jl;j++){eolWords.splice(2*j+1,0,eol);}words.splice.apply(words,[i,1].concat(eolWords.filter(function(word){return word!=='';})));i--;len=words.length;continue;}else{// creates a new line\nlines[++l]='';isEol=true;}}if(!isEol){textNode.data=lines[l]?lines[l]+' '+word:word;if(textSpan.getComputedTextLength()<=width){// the current line fits\nlines[l]=textNode.data;if(p||h){// We were partitioning. Put rest of the word onto next line\nfull[l++]=true;// cancel partitioning and splitting by hyphens\np=0;h=0;}}else{if(!lines[l]||p){var partition=!!p;p=word.length-1;if(partition||!p){// word has only one character.\nif(!p){if(!lines[l]){// we won't fit this text within our rect\nlines=[];break;}// partitioning didn't help on the non-empty line\n// try again, but this time start with a new line\n// cancel partitions created\nwords.splice(i,2,word+words[i+1]);// adjust word length\nlen--;full[l++]=true;i--;continue;}// move last letter to the beginning of the next word\nwords[i]=word.substring(0,p);words[i+1]=word.substring(p)+(words[i+1]===undefined?'':words[i+1]);}else{if(h){// cancel splitting and put the words together again\nwords.splice(i,2,words[i]+words[i+1]);h=0;}else{var hyphenIndex=word.search(hyphen);if(hyphenIndex>-1&&hyphenIndex!==word.length-1&&hyphenIndex!==0){h=hyphenIndex+1;p=0;}// We initiate partitioning or splitting\n// split the long word into two words\nwords.splice(i,1,word.substring(0,h||p),word.substring(h||p));// adjust words length\nlen++;}if(l&&!full[l-1]){// if the previous line is not full, try to fit max part of\n// the current word there\nl--;}}i--;continue;}l++;i--;}}var lastL=null;if(lines.length>maxLineCount){lastL=maxLineCount-1;}else if(height!==undefined){// if size.height is defined we have to check whether the height of the entire\n// text exceeds the rect height\nif(lineHeight===undefined){var heightValue;// use the same defaults as in V.prototype.text\nif(styles.lineHeight==='auto'){heightValue={value:1.5,unit:'em'};}else{heightValue=parseCssNumeric(styles.lineHeight,['em'])||{value:1,unit:'em'};}lineHeight=heightValue.value;if(heightValue.unit==='em'){lineHeight*=textElement.getBBox().height;}}if(lineHeight*lines.length>height){// remove overflowing lines\nlastL=Math.floor(height/lineHeight)-1;}}if(lastL!==null){lines.splice(lastL+1);// add ellipsis\nvar ellipsis=opt.ellipsis;if(!ellipsis||lastL<0){break;}if(typeof ellipsis!=='string'){ellipsis='\\u2026';}var lastLine=lines[lastL];if(!lastLine&&!isEol){break;}var k=lastLine.length;var lastLineWithOmission,lastChar,separatorChar;do{lastChar=lastLine[k];lastLineWithOmission=lastLine.substring(0,k);if(!lastChar){separatorChar=typeof separator==='string'?separator:' ';lastLineWithOmission+=separatorChar;}else if(lastChar.match(separator)){lastLineWithOmission+=lastChar;}lastLineWithOmission+=ellipsis;textNode.data=lastLineWithOmission;if(textSpan.getComputedTextLength()<=width){lines[lastL]=lastLineWithOmission;break;}k--;}while(k>=0);break;}}if(opt.svgDocument){// svg document was provided, remove the text element only\nsvgDocument.removeChild(textElement);}else{// clean svg document\ndocument.body.removeChild(svgDocument);}return lines.join(eol);};// Sanitize HTML\n// Based on https://gist.github.com/ufologist/5a0da51b2b9ef1b861c30254172ac3c9\n// Parses a string into an array of DOM nodes.\n// Then outputs it back as a string.\nvar sanitizeHTML=function(html){// Ignores tags that are invalid inside a <div> tag (e.g. <body>, <head>)\n// If documentContext (second parameter) is not specified or given as `null` or `undefined`, a new document is used.\n// Inline events will not execute when the HTML is parsed; this includes, for example, sending GET requests for images.\n// If keepScripts (last parameter) is `false`, scripts are not executed.\nvar output=$($.parseHTML('<div>'+html+'</div>',null,false));output.find('*').each(function(){// for all nodes\nvar currentNode=this;$.each(currentNode.attributes,function(){// for all attributes in each node\nvar currentAttribute=this;var attrName=currentAttribute.name;var attrValue=currentAttribute.value;// Remove attribute names that start with \"on\" (e.g. onload, onerror...).\n// Remove attribute values that start with \"javascript:\" pseudo protocol (e.g. `href=\"javascript:alert(1)\"`).\nif(attrName.startsWith('on')||attrValue.startsWith('javascript:')||attrValue.startsWith('data:')||attrValue.startsWith('vbscript:')){$(currentNode).removeAttr(attrName);}});});return output.html();};// Download `blob` as file with `fileName`.\n// Does not work in IE9.\nvar downloadBlob=function(blob,fileName){if(window.navigator.msSaveBlob){// requires IE 10+\n// pulls up a save dialog\nwindow.navigator.msSaveBlob(blob,fileName);}else{// other browsers\n// downloads directly in Chrome and Safari\n// presents a save/open dialog in Firefox\n// Firefox bug: `from` field in save dialog always shows `from:blob:`\n// https://bugzilla.mozilla.org/show_bug.cgi?id=1053327\nvar url=window.URL.createObjectURL(blob);var link=document.createElement('a');link.href=url;link.download=fileName;document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(url);// mark the url for garbage collection\n}};// Download `dataUri` as file with `fileName`.\n// Does not work in IE9.\nvar downloadDataUri=function(dataUri,fileName){var blob=dataUriToBlob(dataUri);downloadBlob(blob,fileName);};// Convert an uri-encoded data component (possibly also base64-encoded) to a blob.\nvar dataUriToBlob=function(dataUri){// first, make sure there are no newlines in the data uri\ndataUri=dataUri.replace(/\\s/g,'');dataUri=decodeURIComponent(dataUri);var firstCommaIndex=dataUri.indexOf(',');// split dataUri as `dataTypeString`,`data`\nvar dataTypeString=dataUri.slice(0,firstCommaIndex);// e.g. 'data:image/jpeg;base64'\nvar mimeString=dataTypeString.split(':')[1].split(';')[0];// e.g. 'image/jpeg'\nvar data=dataUri.slice(firstCommaIndex+1);var decodedString;if(dataTypeString.indexOf('base64')>=0){// data may be encoded in base64\ndecodedString=atob(data);// decode data\n}else{// convert the decoded string to UTF-8\ndecodedString=unescape(encodeURIComponent(data));}// write the bytes of the string to a typed array\nvar ia=new Uint8Array(decodedString.length);for(var i=0;i<decodedString.length;i++){ia[i]=decodedString.charCodeAt(i);}return new Blob([ia],{type:mimeString});// return the typed array as Blob\n};// Read an image at `url` and return it as base64-encoded data uri.\n// The mime type of the image is inferred from the `url` file extension.\n// If data uri is provided as `url`, it is returned back unchanged.\n// `callback` is a method with `err` as first argument and `dataUri` as second argument.\n// Works with IE9.\nvar imageToDataUri=function(url,callback){if(!url||url.substr(0,'data:'.length)==='data:'){// No need to convert to data uri if it is already in data uri.\n// This not only convenient but desired. For example,\n// IE throws a security error if data:image/svg+xml is used to render\n// an image to the canvas and an attempt is made to read out data uri.\n// Now if our image is already in data uri, there is no need to render it to the canvas\n// and so we can bypass this error.\n// Keep the async nature of the function.\nreturn setTimeout(function(){callback(null,url);},0);}// chrome, IE10+\nvar modernHandler=function(xhr,callback){if(xhr.status===200){var reader=new FileReader();reader.onload=function(evt){var dataUri=evt.target.result;callback(null,dataUri);};reader.onerror=function(){callback(new Error('Failed to load image '+url));};reader.readAsDataURL(xhr.response);}else{callback(new Error('Failed to load image '+url));}};var legacyHandler=function(xhr,callback){var Uint8ToString=function(u8a){var CHUNK_SZ=0x8000;var c=[];for(var i=0;i<u8a.length;i+=CHUNK_SZ){c.push(String.fromCharCode.apply(null,u8a.subarray(i,i+CHUNK_SZ)));}return c.join('');};if(xhr.status===200){var bytes=new Uint8Array(xhr.response);var suffix=url.split('.').pop()||'png';var map={'svg':'svg+xml'};var meta='data:image/'+(map[suffix]||suffix)+';base64,';var b64encoded=meta+btoa(Uint8ToString(bytes));callback(null,b64encoded);}else{callback(new Error('Failed to load image '+url));}};var xhr=new XMLHttpRequest();xhr.open('GET',url,true);xhr.addEventListener('error',function(){callback(new Error('Failed to load image '+url));});xhr.responseType=window.FileReader?'blob':'arraybuffer';xhr.addEventListener('load',function(){if(window.FileReader){modernHandler(xhr,callback);}else{legacyHandler(xhr,callback);}});xhr.send();};var getElementBBox=function(el){var $el=$(el);if($el.length===0){throw new Error('Element not found');}var element=$el[0];var doc=element.ownerDocument;var clientBBox=element.getBoundingClientRect();var strokeWidthX=0;var strokeWidthY=0;// Firefox correction\nif(element.ownerSVGElement){var vel=V(element);var bbox=vel.getBBox({target:vel.svg()});// if FF getBoundingClientRect includes stroke-width, getBBox doesn't.\n// To unify this across all browsers we need to adjust the final bBox with `stroke-width` value.\nstrokeWidthX=clientBBox.width-bbox.width;strokeWidthY=clientBBox.height-bbox.height;}return{x:clientBBox.left+window.pageXOffset-doc.documentElement.offsetLeft+strokeWidthX/2,y:clientBBox.top+window.pageYOffset-doc.documentElement.offsetTop+strokeWidthY/2,width:clientBBox.width-strokeWidthX,height:clientBBox.height-strokeWidthY};};// Highly inspired by the jquery.sortElements plugin by Padolsey.\n// See http://james.padolsey.com/javascript/sorting-elements-with-jquery/.\nvar sortElements=function(elements,comparator){var $elements=$(elements);var placements=$elements.map(function(){var sortElement=this;var parentNode=sortElement.parentNode;// Since the element itself will change position, we have\n// to have some way of storing it's original position in\n// the DOM. The easiest way is to have a 'flag' node:\nvar nextSibling=parentNode.insertBefore(document.createTextNode(''),sortElement.nextSibling);return function(){if(parentNode===this){throw new Error('You can\\'t sort elements if any one is a descendant of another.');}// Insert before flag:\nparentNode.insertBefore(this,nextSibling);// Remove flag:\nparentNode.removeChild(nextSibling);};});return Array.prototype.sort.call($elements,comparator).each(function(i){placements[i].call(this);});};// Sets attributes on the given element and its descendants based on the selector.\n// `attrs` object: { [SELECTOR1]: { attrs1 }, [SELECTOR2]: { attrs2}, ... } e.g. { 'input': { color : 'red' }}\nvar setAttributesBySelector=function(element,attrs){var $element=$(element);forIn(attrs,function(attrs,selector){var $elements=$element.find(selector).addBack().filter(selector);// Make a special case for setting classes.\n// We do not want to overwrite any existing class.\nif(has$2(attrs,'class')){$elements.addClass(attrs['class']);attrs=omit(attrs,'class');}$elements.attr(attrs);});};// Return a new object with all four sides (top, right, bottom, left) in it.\n// Value of each side is taken from the given argument (either number or object).\n// Default value for a side is 0.\n// Examples:\n// normalizeSides(5) --> { top: 5, right: 5, bottom: 5, left: 5 }\n// normalizeSides({ horizontal: 5 }) --> { top: 0, right: 5, bottom: 0, left: 5 }\n// normalizeSides({ left: 5 }) --> { top: 0, right: 0, bottom: 0, left: 5 }\n// normalizeSides({ horizontal: 10, left: 5 }) --> { top: 0, right: 10, bottom: 0, left: 5 }\n// normalizeSides({ horizontal: 0, left: 5 }) --> { top: 0, right: 0, bottom: 0, left: 5 }\nvar normalizeSides=function(box){if(Object(box)!==box){// `box` is not an object\nvar val=0;// `val` left as 0 if `box` cannot be understood as finite number\nif(isFinite(box)){val=+box;}// actually also accepts string numbers (e.g. '100')\nreturn{top:val,right:val,bottom:val,left:val};}// `box` is an object\nvar top,right,bottom,left;top=right=bottom=left=0;if(isFinite(box.vertical)){top=bottom=+box.vertical;}if(isFinite(box.horizontal)){right=left=+box.horizontal;}if(isFinite(box.top)){top=+box.top;}// overwrite vertical\nif(isFinite(box.right)){right=+box.right;}// overwrite horizontal\nif(isFinite(box.bottom)){bottom=+box.bottom;}// overwrite vertical\nif(isFinite(box.left)){left=+box.left;}// overwrite horizontal\nreturn{top:top,right:right,bottom:bottom,left:left};};var timing={linear:function(t){return t;},quad:function(t){return t*t;},cubic:function(t){return t*t*t;},inout:function(t){if(t<=0){return 0;}if(t>=1){return 1;}var t2=t*t;var t3=t2*t;return 4*(t<.5?t3:3*(t-t2)+t3-.75);},exponential:function(t){return Math.pow(2,10*(t-1));},bounce:function(t){for(var a=0,b=1;1;a+=b,b/=2){if(t>=(7-4*a)/11){var q=(11-6*a-11*t)/4;return-q*q+b*b;}}},reverse:function(f){return function(t){return 1-f(1-t);};},reflect:function(f){return function(t){return .5*(t<.5?f(2*t):2-f(2-2*t));};},clamp:function(f,n,x){n=n||0;x=x||1;return function(t){var r=f(t);return r<n?n:r>x?x:r;};},back:function(s){if(!s){s=1.70158;}return function(t){return t*t*((s+1)*t-s);};},elastic:function(x){if(!x){x=1.5;}return function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*x/3*t);};}};var interpolate={number:function(a,b){var d=b-a;return function(t){return a+d*t;};},object:function(a,b){var s=Object.keys(a);return function(t){var i,p;var r={};for(i=s.length-1;i!=-1;i--){p=s[i];r[p]=a[p]+(b[p]-a[p])*t;}return r;};},hexColor:function(a,b){var ca=parseInt(a.slice(1),16);var cb=parseInt(b.slice(1),16);var ra=ca&0x0000ff;var rd=(cb&0x0000ff)-ra;var ga=ca&0x00ff00;var gd=(cb&0x00ff00)-ga;var ba=ca&0xff0000;var bd=(cb&0xff0000)-ba;return function(t){var r=ra+rd*t&0x000000ff;var g=ga+gd*t&0x0000ff00;var b=ba+bd*t&0x00ff0000;return'#'+(1<<24|r|g|b).toString(16).slice(1);};},unit:function(a,b){var r=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/;var ma=r.exec(a);var mb=r.exec(b);var p=mb[1].indexOf('.');var f=p>0?mb[1].length-p-1:0;a=+ma[1];var d=+mb[1]-a;var u=ma[2];return function(t){return(a+d*t).toFixed(f)+u;};}};// SVG filters.\n// (values in parentheses are default values)\nvar filter={// `color` ... outline color ('blue')\n// `width`... outline width (1)\n// `opacity` ... outline opacity (1)\n// `margin` ... gap between outline and the element (2)\noutline:function(args){var tpl='<filter><feFlood flood-color=\"${color}\" flood-opacity=\"${opacity}\" result=\"colored\"/><feMorphology in=\"SourceAlpha\" result=\"morphedOuter\" operator=\"dilate\" radius=\"${outerRadius}\" /><feMorphology in=\"SourceAlpha\" result=\"morphedInner\" operator=\"dilate\" radius=\"${innerRadius}\" /><feComposite result=\"morphedOuterColored\" in=\"colored\" in2=\"morphedOuter\" operator=\"in\"/><feComposite operator=\"xor\" in=\"morphedOuterColored\" in2=\"morphedInner\" result=\"outline\"/><feMerge><feMergeNode in=\"outline\"/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>';var margin=Number.isFinite(args.margin)?args.margin:2;var width=Number.isFinite(args.width)?args.width:1;return template(tpl)({color:args.color||'blue',opacity:Number.isFinite(args.opacity)?args.opacity:1,outerRadius:margin+width,innerRadius:margin});},// `color` ... color ('red')\n// `width`... width (1)\n// `blur` ... blur (0)\n// `opacity` ... opacity (1)\nhighlight:function(args){var tpl='<filter><feFlood flood-color=\"${color}\" flood-opacity=\"${opacity}\" result=\"colored\"/><feMorphology result=\"morphed\" in=\"SourceGraphic\" operator=\"dilate\" radius=\"${width}\"/><feComposite result=\"composed\" in=\"colored\" in2=\"morphed\" operator=\"in\"/><feGaussianBlur result=\"blured\" in=\"composed\" stdDeviation=\"${blur}\"/><feBlend in=\"SourceGraphic\" in2=\"blured\" mode=\"normal\"/></filter>';return template(tpl)({color:args.color||'red',width:Number.isFinite(args.width)?args.width:1,blur:Number.isFinite(args.blur)?args.blur:0,opacity:Number.isFinite(args.opacity)?args.opacity:1});},// `x` ... horizontal blur (2)\n// `y` ... vertical blur (optional)\nblur:function(args){var x=Number.isFinite(args.x)?args.x:2;return template('<filter><feGaussianBlur stdDeviation=\"${stdDeviation}\"/></filter>')({stdDeviation:Number.isFinite(args.y)?[x,args.y]:x});},// `dx` ... horizontal shift (0)\n// `dy` ... vertical shift (0)\n// `blur` ... blur (4)\n// `color` ... color ('black')\n// `opacity` ... opacity (1)\ndropShadow:function(args){var tpl='SVGFEDropShadowElement'in window?'<filter><feDropShadow stdDeviation=\"${blur}\" dx=\"${dx}\" dy=\"${dy}\" flood-color=\"${color}\" flood-opacity=\"${opacity}\"/></filter>':'<filter><feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"${blur}\"/><feOffset dx=\"${dx}\" dy=\"${dy}\" result=\"offsetblur\"/><feFlood flood-color=\"${color}\"/><feComposite in2=\"offsetblur\" operator=\"in\"/><feComponentTransfer><feFuncA type=\"linear\" slope=\"${opacity}\"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>';return template(tpl)({dx:args.dx||0,dy:args.dy||0,opacity:Number.isFinite(args.opacity)?args.opacity:1,color:args.color||'black',blur:Number.isFinite(args.blur)?args.blur:4});},// `amount` ... the proportion of the conversion (1). A value of 1 (default) is completely grayscale. A value of 0 leaves the input unchanged.\ngrayscale:function(args){var amount=Number.isFinite(args.amount)?args.amount:1;return template('<filter><feColorMatrix type=\"matrix\" values=\"${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0\"/></filter>')({a:0.2126+0.7874*(1-amount),b:0.7152-0.7152*(1-amount),c:0.0722-0.0722*(1-amount),d:0.2126-0.2126*(1-amount),e:0.7152+0.2848*(1-amount),f:0.0722-0.0722*(1-amount),g:0.2126-0.2126*(1-amount),h:0.0722+0.9278*(1-amount)});},// `amount` ... the proportion of the conversion (1). A value of 1 (default) is completely sepia. A value of 0 leaves the input unchanged.\nsepia:function(args){var amount=Number.isFinite(args.amount)?args.amount:1;return template('<filter><feColorMatrix type=\"matrix\" values=\"${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0\"/></filter>')({a:0.393+0.607*(1-amount),b:0.769-0.769*(1-amount),c:0.189-0.189*(1-amount),d:0.349-0.349*(1-amount),e:0.686+0.314*(1-amount),f:0.168-0.168*(1-amount),g:0.272-0.272*(1-amount),h:0.534-0.534*(1-amount),i:0.131+0.869*(1-amount)});},// `amount` ... the proportion of the conversion (1). A value of 0 is completely un-saturated. A value of 1 (default) leaves the input unchanged.\nsaturate:function(args){var amount=Number.isFinite(args.amount)?args.amount:1;return template('<filter><feColorMatrix type=\"saturate\" values=\"${amount}\"/></filter>')({amount:1-amount});},// `angle` ...  the number of degrees around the color circle the input samples will be adjusted (0).\nhueRotate:function(args){return template('<filter><feColorMatrix type=\"hueRotate\" values=\"${angle}\"/></filter>')({angle:args.angle||0});},// `amount` ... the proportion of the conversion (1). A value of 1 (default) is completely inverted. A value of 0 leaves the input unchanged.\ninvert:function(args){var amount=Number.isFinite(args.amount)?args.amount:1;return template('<filter><feComponentTransfer><feFuncR type=\"table\" tableValues=\"${amount} ${amount2}\"/><feFuncG type=\"table\" tableValues=\"${amount} ${amount2}\"/><feFuncB type=\"table\" tableValues=\"${amount} ${amount2}\"/></feComponentTransfer></filter>')({amount:amount,amount2:1-amount});},// `amount` ... proportion of the conversion (1). A value of 0 will create an image that is completely black. A value of 1 (default) leaves the input unchanged.\nbrightness:function(args){return template('<filter><feComponentTransfer><feFuncR type=\"linear\" slope=\"${amount}\"/><feFuncG type=\"linear\" slope=\"${amount}\"/><feFuncB type=\"linear\" slope=\"${amount}\"/></feComponentTransfer></filter>')({amount:Number.isFinite(args.amount)?args.amount:1});},// `amount` ... proportion of the conversion (1). A value of 0 will create an image that is completely black. A value of 1 (default) leaves the input unchanged.\ncontrast:function(args){var amount=Number.isFinite(args.amount)?args.amount:1;return template('<filter><feComponentTransfer><feFuncR type=\"linear\" slope=\"${amount}\" intercept=\"${amount2}\"/><feFuncG type=\"linear\" slope=\"${amount}\" intercept=\"${amount2}\"/><feFuncB type=\"linear\" slope=\"${amount}\" intercept=\"${amount2}\"/></feComponentTransfer></filter>')({amount:amount,amount2:.5-amount/2});}};var format={// Formatting numbers via the Python Format Specification Mini-language.\n// See http://docs.python.org/release/3.1.3/library/string.html#format-specification-mini-language.\n// Heavilly inspired by the D3.js library implementation.\nnumber:function(specifier,value,locale){locale=locale||{currency:['$',''],decimal:'.',thousands:',',grouping:[3]};// See Python format specification mini-language: http://docs.python.org/release/3.1.3/library/string.html#format-specification-mini-language.\n// [[fill]align][sign][symbol][0][width][,][.precision][type]\nvar re=/(?:([^{])?([<>=^]))?([+\\- ])?([$#])?(0)?(\\d+)?(,)?(\\.-?\\d+)?([a-z%])?/i;var match=re.exec(specifier);var fill=match[1]||' ';var align=match[2]||'>';var sign=match[3]||'';var symbol=match[4]||'';var zfill=match[5];var width=+match[6];var comma=match[7];var precision=match[8];var type=match[9];var scale=1;var prefix='';var suffix='';var integer=false;if(precision){precision=+precision.substring(1);}if(zfill||fill==='0'&&align==='='){zfill=fill='0';align='=';if(comma){width-=Math.floor((width-1)/4);}}switch(type){case'n':comma=true;type='g';break;case'%':scale=100;suffix='%';type='f';break;case'p':scale=100;suffix='%';type='r';break;case'b':case'o':case'x':case'X':if(symbol==='#'){prefix='0'+type.toLowerCase();}break;case'c':case'd':integer=true;precision=0;break;case's':scale=-1;type='r';break;}if(symbol==='$'){prefix=locale.currency[0];suffix=locale.currency[1];}// If no precision is specified for `'r'`, fallback to general notation.\nif(type=='r'&&!precision){type='g';}// Ensure that the requested precision is in the supported range.\nif(precision!=null){if(type=='g'){precision=Math.max(1,Math.min(21,precision));}else if(type=='e'||type=='f'){precision=Math.max(0,Math.min(20,precision));}}var zcomma=zfill&&comma;// Return the empty string for floats formatted as ints.\nif(integer&&value%1){return'';}// Convert negative to positive, and record the sign prefix.\nvar negative=value<0||value===0&&1/value<0?(value=-value,'-'):sign;var fullSuffix=suffix;// Apply the scale, computing it from the value's exponent for si format.\n// Preserve the existing suffix, if any, such as the currency symbol.\nif(scale<0){var unit=this.prefix(value,precision);value=unit.scale(value);fullSuffix=unit.symbol+suffix;}else{value*=scale;}// Convert to the desired precision.\nvalue=this.convert(type,value,precision);// Break the value into the integer part (before) and decimal part (after).\nvar i=value.lastIndexOf('.');var before=i<0?value:value.substring(0,i);var after=i<0?'':locale.decimal+value.substring(i+1);function formatGroup(value){var i=value.length;var t=[];var j=0;var g=locale.grouping[0];while(i>0&&g>0){t.push(value.substring(i-=g,i+g));g=locale.grouping[j=(j+1)%locale.grouping.length];}return t.reverse().join(locale.thousands);}// If the fill character is not `'0'`, grouping is applied before padding.\nif(!zfill&&comma&&locale.grouping){before=formatGroup(before);}var length=prefix.length+before.length+after.length+(zcomma?0:negative.length);var padding=length<width?new Array(length=width-length+1).join(fill):'';// If the fill character is `'0'`, grouping is applied after padding.\nif(zcomma){before=formatGroup(padding+before);}// Apply prefix.\nnegative+=prefix;// Rejoin integer and decimal parts.\nvalue=before+after;return(align==='<'?negative+value+padding:align==='>'?padding+negative+value:align==='^'?padding.substring(0,length>>=1)+negative+value+padding.substring(length):negative+(zcomma?value:padding+value))+fullSuffix;},// Formatting string via the Python Format string.\n// See https://docs.python.org/2/library/string.html#format-string-syntax)\nstring:function(formatString,value){var fieldDelimiterIndex;var fieldDelimiter='{';var endPlaceholder=false;var formattedStringArray=[];while((fieldDelimiterIndex=formatString.indexOf(fieldDelimiter))!==-1){var pieceFormattedString,formatSpec,fieldName;pieceFormattedString=formatString.slice(0,fieldDelimiterIndex);if(endPlaceholder){formatSpec=pieceFormattedString.split(':');fieldName=formatSpec.shift().split('.');pieceFormattedString=value;for(var i=0;i<fieldName.length;i++){pieceFormattedString=pieceFormattedString[fieldName[i]];}if(formatSpec.length){pieceFormattedString=this.number(formatSpec,pieceFormattedString);}}formattedStringArray.push(pieceFormattedString);formatString=formatString.slice(fieldDelimiterIndex+1);endPlaceholder=!endPlaceholder;fieldDelimiter=endPlaceholder?'}':'{';}formattedStringArray.push(formatString);return formattedStringArray.join('');},convert:function(type,value,precision){switch(type){case'b':return value.toString(2);case'c':return String.fromCharCode(value);case'o':return value.toString(8);case'x':return value.toString(16);case'X':return value.toString(16).toUpperCase();case'g':return value.toPrecision(precision);case'e':return value.toExponential(precision);case'f':return value.toFixed(precision);case'r':return(value=this.round(value,this.precision(value,precision))).toFixed(Math.max(0,Math.min(20,this.precision(value*(1+1e-15),precision))));default:return value+'';}},round:function(value,precision){return precision?Math.round(value*(precision=Math.pow(10,precision)))/precision:Math.round(value);},precision:function(value,precision){return precision-(value?Math.ceil(Math.log(value)/Math.LN10):1);},prefix:function(value,precision){var prefixes=['y','z','a','f','p','n','Âµ','m','','k','M','G','T','P','E','Z','Y'].map(function(d,i){var k=Math.pow(10,Math.abs(8-i)*3);return{scale:i>8?function(d){return d/k;}:function(d){return d*k;},symbol:d};});var i=0;if(value){if(value<0){value*=-1;}if(precision){value=this.round(value,this.precision(value,precision));}i=1+Math.floor(1e-12+Math.log(value)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i<=0?i+1:i-1)/3)*3));}return prefixes[8+i/3];}};/*\n\t    Pre-compile the HTML to be used as a template.\n\t*/var template=function(html){/*\n\t        Must support the variation in templating syntax found here:\n\t        https://lodash.com/docs#template\n\t    */var regex=/<%= ([^ ]+) %>|\\$\\{ ?([^{} ]+) ?\\}|\\{\\{([^{} ]+)\\}\\}/g;return function(data){data=data||{};return html.replace(regex,function(match){var args=Array.from(arguments);var attr=args.slice(1,4).find(function(_attr){return!!_attr;});var attrArray=attr.split('.');var value=data[attrArray.shift()];while(value!==undefined&&attrArray.length){value=value[attrArray.shift()];}return value!==undefined?value:'';});};};/**\n\t * @param {Element} el Element, which content is intent to display in full-screen mode, 'window.top.document.body' is default.\n\t */var toggleFullScreen=function(el){var topDocument=window.top.document;el=el||topDocument.body;function prefixedResult(el,prop){var prefixes=['webkit','moz','ms','o',''];for(var i=0;i<prefixes.length;i++){var prefix=prefixes[i];var propName=prefix?prefix+prop:prop.substr(0,1).toLowerCase()+prop.substr(1);if(el[propName]!==undefined){return isFunction(el[propName])?el[propName]():el[propName];}}}if(prefixedResult(topDocument,'FullscreenElement')||prefixedResult(topDocument,'FullScreenElement')){prefixedResult(topDocument,'ExitFullscreen')||// Spec.\nprefixedResult(topDocument,'CancelFullScreen');// Firefox\n}else{prefixedResult(el,'RequestFullscreen')||// Spec.\nprefixedResult(el,'RequestFullScreen');// Firefox\n}};// Deprecated\n// Copy all the properties to the first argument from the following arguments.\n// All the properties will be overwritten by the properties from the following\n// arguments. Inherited properties are ignored.\nvar mixin=_.assign;// Deprecated\n// Copy all properties to the first argument from the following\n// arguments only in case if they don't exists in the first argument.\n// All the function propererties in the first argument will get\n// additional property base pointing to the extenders same named\n// property function's call method.\nvar supplement=_.defaults;// Same as `mixin()` but deep version.\nvar deepMixin=mixin;// Deprecated\n// Same as `supplement()` but deep version.\nvar deepSupplement=_.defaultsDeep;// Replacements for deprecated functions\nvar assign=_.assign;var defaults=_.defaults;// no better-named replacement for `deepMixin`\nvar defaultsDeep=_.defaultsDeep;// Lodash 3 vs 4 incompatible\nvar invoke=_.invokeMap||_.invoke;var sortedIndex=_.sortedIndexBy||_.sortedIndex;var uniq=_.uniqBy||_.uniq;var clone=_.clone;var cloneDeep=_.cloneDeep;var isEmpty=_.isEmpty;var isEqual=_.isEqual;var isFunction=_.isFunction;var isPlainObject=_.isPlainObject;var toArray=_.toArray;var debounce=_.debounce;var groupBy=_.groupBy;var sortBy=_.sortBy;var flattenDeep=_.flattenDeep;var without=_.without;var difference=_.difference;var intersection$1=_.intersection;var union=_.union;var has$2=_.has;var result=_.result;var omit=_.omit;var pick=_.pick;var bindAll=_.bindAll;var forIn=_.forIn;var camelCase=_.camelCase;var uniqueId=_.uniqueId;var merge=function(){if(_.mergeWith){var args=Array.from(arguments);var last=args[args.length-1];var customizer=isFunction(last)?last:noop;args.push(function(a,b){var customResult=customizer(a,b);if(customResult!==undefined){return customResult;}if(Array.isArray(a)&&!Array.isArray(b)){return b;}});return _.mergeWith.apply(this,args);}return _.merge.apply(this,arguments);};var isBoolean=function(value){var toString=Object.prototype.toString;return value===true||value===false||!!value&&typeof value==='object'&&toString.call(value)==='[object Boolean]';};var isObject$1=function(value){return!!value&&(typeof value==='object'||typeof value==='function');};var isNumber=function(value){var toString=Object.prototype.toString;return typeof value==='number'||!!value&&typeof value==='object'&&toString.call(value)==='[object Number]';};var isString=function(value){var toString=Object.prototype.toString;return typeof value==='string'||!!value&&typeof value==='object'&&toString.call(value)==='[object String]';};var noop=function(){};// Clone `cells` returning an object that maps the original cell ID to the clone. The number\n// of clones is exactly the same as the `cells.length`.\n// This function simply clones all the `cells`. However, it also reconstructs\n// all the `source/target` and `parent/embed` references within the `cells`.\n// This is the main difference from the `cell.clone()` method. The\n// `cell.clone()` method works on one single cell only.\n// For example, for a graph: `A --- L ---> B`, `cloneCells([A, L, B])`\n// returns `[A2, L2, B2]` resulting to a graph: `A2 --- L2 ---> B2`, i.e.\n// the source and target of the link `L2` is changed to point to `A2` and `B2`.\nfunction cloneCells(cells){cells=uniq(cells);// A map of the form [original cell ID] -> [clone] helping\n// us to reconstruct references for source/target and parent/embeds.\n// This is also the returned value.\nvar cloneMap=toArray(cells).reduce(function(map,cell){map[cell.id]=cell.clone();return map;},{});toArray(cells).forEach(function(cell){var clone=cloneMap[cell.id];// assert(clone exists)\nif(clone.isLink()){var source=clone.source();var target=clone.target();if(source.id&&cloneMap[source.id]){// Source points to an element and the element is among the clones.\n// => Update the source of the cloned link.\nclone.prop('source/id',cloneMap[source.id].id);}if(target.id&&cloneMap[target.id]){// Target points to an element and the element is among the clones.\n// => Update the target of the cloned link.\nclone.prop('target/id',cloneMap[target.id].id);}}// Find the parent of the original cell\nvar parent=cell.get('parent');if(parent&&cloneMap[parent]){clone.set('parent',cloneMap[parent].id);}// Find the embeds of the original cell\nvar embeds=toArray(cell.get('embeds')).reduce(function(newEmbeds,embed){// Embedded cells that are not being cloned can not be carried\n// over with other embedded cells.\nif(cloneMap[embed]){newEmbeds.push(cloneMap[embed].id);}return newEmbeds;},[]);if(!isEmpty(embeds)){clone.set('embeds',embeds);}});return cloneMap;}var props={x:'x',y:'y',width:'w',height:'h',minimum:'s',maximum:'l',diagonal:'d'};var propsList=Object.keys(props).map(function(key){return props[key];}).join('');var numberPattern='[-+]?[0-9]*\\\\.?[0-9]+(?:[eE][-+]?[0-9]+)?';var findSpacesRegex=/\\s/g;var parseExpressionRegExp=new RegExp(\"^(\"+numberPattern+\"\\\\*)?([\"+propsList+\"])([-+]{1,2}\"+numberPattern+\")?$\",'g');function throwInvalid(expression){throw new Error(\"Invalid calc() expression: \"+expression);}function evalCalcExpression(expression,bbox){var match=parseExpressionRegExp.exec(expression.replace(findSpacesRegex,''));if(!match){throwInvalid(expression);}parseExpressionRegExp.lastIndex=0;// reset regex results for the next run\nvar multiply=match[1];if(multiply===void 0)multiply=1;var property=match[2];var add=match[3];if(add===void 0)add=0;var x=bbox.x;var y=bbox.y;var width=bbox.width;var height=bbox.height;var value=0;switch(property){case props.width:{value=width;break;}case props.height:{value=height;break;}case props.x:{value=x;break;}case props.y:{value=y;break;}case props.minimum:{value=Math.min(height,width);break;}case props.maximum:{value=Math.max(height,width);break;}case props.diagonal:{value=Math.sqrt(height*height+width*width);break;}}return parseFloat(multiply)*value+evalAddExpression(add);}function evalAddExpression(addExpression){if(!addExpression){return 0;}var sign=addExpression[0];switch(sign){case'+':{return parseFloat(addExpression.substr(1));}case'-':{return-parseFloat(addExpression.substr(1));}}return parseFloat(addExpression);}function isCalcAttribute(value){return typeof value==='string'&&value.includes('calc');}var calcStart='calc(';var calcStartOffset=calcStart.length;function evalCalcAttribute(attributeValue,refBBox){var value=attributeValue;var startSearchIndex=0;do{var calcIndex=value.indexOf(calcStart,startSearchIndex);if(calcIndex===-1){return value;}var calcEndIndex=calcIndex+calcStartOffset;var brackets=1;findClosingBracket:do{switch(value[calcEndIndex]){case'(':{brackets++;break;}case')':{brackets--;if(brackets===0){break findClosingBracket;}break;}case undefined:{// Could not find the closing bracket.\nthrowInvalid(value);}}calcEndIndex++;}while(true);// Get the calc() expression without nested calcs (recursion)\nvar expression=value.slice(calcIndex+calcStartOffset,calcEndIndex);if(isCalcAttribute(expression)){expression=evalCalcAttribute(expression,refBBox);}// Eval the calc() expression without nested calcs.\nvar calcValue=String(evalCalcExpression(expression,refBBox));// Replace the calc() expression and continue search\nvalue=value.slice(0,calcIndex)+calcValue+value.slice(calcEndIndex+1);startSearchIndex=calcIndex+calcValue.length;}while(true);}function setWrapper(attrName,dimension){return function(value,refBBox){var isValuePercentage=isPercentage(value);value=parseFloat(value);if(isValuePercentage){value/=100;}var attrs={};if(isFinite(value)){var attrValue=isValuePercentage||value>=0&&value<=1?value*refBBox[dimension]:Math.max(value+refBBox[dimension],0);attrs[attrName]=attrValue;}return attrs;};}function positionWrapper(axis,dimension,origin){return function(value,refBBox){var valuePercentage=isPercentage(value);value=parseFloat(value);if(valuePercentage){value/=100;}var delta;if(isFinite(value)){var refOrigin=refBBox[origin]();if(valuePercentage||value>0&&value<1){delta=refOrigin[axis]+refBBox[dimension]*value;}else{delta=refOrigin[axis]+value;}}var point=Point();point[axis]=delta||0;return point;};}function offsetWrapper(axis,dimension,corner){return function(value,nodeBBox){var delta;if(value==='middle'){delta=nodeBBox[dimension]/2;}else if(value===corner){delta=nodeBBox[dimension];}else if(isFinite(value)){// TODO: or not to do a breaking change?\ndelta=value>-1&&value<1?-nodeBBox[dimension]*value:-value;}else if(isPercentage(value)){delta=nodeBBox[dimension]*parseFloat(value)/100;}else{delta=0;}var point=Point();point[axis]=-(nodeBBox[axis]+delta);return point;};}function shapeWrapper(shapeConstructor,opt){var cacheName='joint-shape';var resetOffset=opt&&opt.resetOffset;return function(value,refBBox,node){var $node=$(node);var cache=$node.data(cacheName);if(!cache||cache.value!==value){// only recalculate if value has changed\nvar cachedShape=shapeConstructor(value);cache={value:value,shape:cachedShape,shapeBBox:cachedShape.bbox()};$node.data(cacheName,cache);}var shape=cache.shape.clone();var shapeBBox=cache.shapeBBox.clone();var shapeOrigin=shapeBBox.origin();var refOrigin=refBBox.origin();shapeBBox.x=refOrigin.x;shapeBBox.y=refOrigin.y;var fitScale=refBBox.maxRectScaleToFit(shapeBBox,refOrigin);// `maxRectScaleToFit` can give Infinity if width or height is 0\nvar sx=shapeBBox.width===0||refBBox.width===0?1:fitScale.sx;var sy=shapeBBox.height===0||refBBox.height===0?1:fitScale.sy;shape.scale(sx,sy,shapeOrigin);if(resetOffset){shape.translate(-shapeOrigin.x,-shapeOrigin.y);}return shape;};}// `d` attribute for SVGPaths\nfunction dWrapper(opt){function pathConstructor(value){return new Path(V.normalizePathData(value));}var shape=shapeWrapper(pathConstructor,opt);return function(value,refBBox,node){var path=shape(value,refBBox,node);return{d:path.serialize()};};}// `points` attribute for SVGPolylines and SVGPolygons\nfunction pointsWrapper(opt){var shape=shapeWrapper(Polyline,opt);return function(value,refBBox,node){var polyline=shape(value,refBBox,node);return{points:polyline.serialize()};};}function atConnectionWrapper(method,opt){var zeroVector=new Point(1,0);return function(value){var p,angle;var tangent=this[method](value);if(tangent){angle=opt.rotate?tangent.vector().vectorAngle(zeroVector):0;p=tangent.start;}else{p=this.path.start;angle=0;}if(angle===0){return{transform:'translate('+p.x+','+p.y+')'};}return{transform:'translate('+p.x+','+p.y+') rotate('+angle+')'};};}function setIfChangedWrapper(attribute){return function setIfChanged(value,_,node){var vel=V(node);if(vel.attr(attribute)===value){return;}vel.attr(attribute,value);};}function isTextInUse(_value,_node,attrs){return attrs.text!==undefined;}function isLinkView(){return this.model.isLink();}function contextMarker(context){var marker={};// Stroke\n// The context 'fill' is disregared here. The usual case is to use the marker with a connection\n// (for which 'fill' attribute is set to 'none').\nvar stroke=context.stroke;if(typeof stroke==='string'){marker['stroke']=stroke;marker['fill']=stroke;}// Opacity\n// Again the context 'fill-opacity' is ignored.\nvar strokeOpacity=context.strokeOpacity;if(strokeOpacity===undefined){strokeOpacity=context['stroke-opacity'];}if(strokeOpacity===undefined){strokeOpacity=context.opacity;}if(strokeOpacity!==undefined){marker['stroke-opacity']=strokeOpacity;marker['fill-opacity']=strokeOpacity;}return marker;}function setPaintURL(def){var ref=this;var paper=ref.paper;var url=def.type==='pattern'?paper.definePattern(def):paper.defineGradient(def);return\"url(#\"+url+\")\";}var attributesNS={xlinkShow:{set:'xlink:show'},xlinkRole:{set:'xlink:role'},xlinkType:{set:'xlink:type'},xlinkArcrole:{set:'xlink:arcrole'},xlinkTitle:{set:'xlink:title'},xlinkActuate:{set:'xlink:actuate'},xmlSpace:{set:'xml:space'},xmlBase:{set:'xml:base'},xmlLang:{set:'xml:lang'},preserveAspectRatio:{set:'preserveAspectRatio'},requiredExtension:{set:'requiredExtension'},requiredFeatures:{set:'requiredFeatures'},systemLanguage:{set:'systemLanguage'},externalResourcesRequired:{set:'externalResourceRequired'},href:{set:setIfChangedWrapper('href')},xlinkHref:{set:setIfChangedWrapper('xlink:href')},filter:{qualify:isPlainObject,set:function(filter){return'url(#'+this.paper.defineFilter(filter)+')';}},fill:{qualify:isPlainObject,set:setPaintURL},stroke:{qualify:isPlainObject,set:setPaintURL},sourceMarker:{qualify:isPlainObject,set:function(marker,refBBox,node,attrs){marker=assign(contextMarker(attrs),marker);return{'marker-start':'url(#'+this.paper.defineMarker(marker)+')'};}},targetMarker:{qualify:isPlainObject,set:function(marker,refBBox,node,attrs){marker=assign(contextMarker(attrs),{'transform':'rotate(180)'},marker);return{'marker-end':'url(#'+this.paper.defineMarker(marker)+')'};}},vertexMarker:{qualify:isPlainObject,set:function(marker,refBBox,node,attrs){marker=assign(contextMarker(attrs),marker);return{'marker-mid':'url(#'+this.paper.defineMarker(marker)+')'};}},text:{qualify:function(_text,_node,attrs){return!attrs.textWrap||!isPlainObject(attrs.textWrap);},set:function(text,refBBox,node,attrs){var $node=$(node);var cacheName='joint-text';var cache=$node.data(cacheName);var textAttrs=pick(attrs,'lineHeight','annotations','textPath','x','textVerticalAnchor','eol','displayEmpty');// eval `x` if using calc()\nvar x=textAttrs.x;if(isCalcAttribute(x)){textAttrs.x=evalCalcAttribute(x,refBBox);}var fontSize=textAttrs.fontSize=attrs['font-size']||attrs['fontSize'];var textHash=JSON.stringify([text,textAttrs]);// Update the text only if there was a change in the string\n// or any of its attributes.\nif(cache===undefined||cache!==textHash){// Chrome bug:\n// Tspans positions defined as `em` are not updated\n// when container `font-size` change.\nif(fontSize){node.setAttribute('font-size',fontSize);}// Text Along Path Selector\nvar textPath=textAttrs.textPath;if(isObject$1(textPath)){var pathSelector=textPath.selector;if(typeof pathSelector==='string'){var pathNode=this.findBySelector(pathSelector)[0];if(pathNode instanceof SVGPathElement){textAttrs.textPath=assign({'xlink:href':'#'+pathNode.id},textPath);}}}V(node).text(''+text,textAttrs);$node.data(cacheName,textHash);}}},textWrap:{qualify:isPlainObject,set:function(value,refBBox,node,attrs){// option `width`\nvar width=value.width||0;var size={};if(isPercentage(width)){size.width=refBBox.width*parseFloat(width)/100;}else if(width<=0){size.width=refBBox.width+width;}else{size.width=width;}// option `height`\nvar height=value.height||0;if(isPercentage(height)){size.height=refBBox.height*parseFloat(height)/100;}else if(height<=0){size.height=refBBox.height+height;}else{size.height=height;}// option `text`\nvar wrappedText;var text=value.text;if(text===undefined){text=attrs.text;}if(text!==undefined){wrappedText=breakText(''+text,size,{'font-weight':attrs['font-weight']||attrs.fontWeight,'font-size':attrs['font-size']||attrs.fontSize,'font-family':attrs['font-family']||attrs.fontFamily,'lineHeight':attrs.lineHeight,'letter-spacing':'letter-spacing'in attrs?attrs['letter-spacing']:attrs.letterSpacing},{// Provide an existing SVG Document here\n// instead of creating a temporary one over again.\nsvgDocument:this.paper.svg,ellipsis:value.ellipsis,hyphen:value.hyphen,maxLineCount:value.maxLineCount});}else{wrappedText='';}attributesNS.text.set.call(this,wrappedText,refBBox,node,attrs);}},title:{qualify:function(title,node){// HTMLElement title is specified via an attribute (i.e. not an element)\nreturn node instanceof SVGElement;},set:function(title,refBBox,node){var $node=$(node);var cacheName='joint-title';var cache=$node.data(cacheName);if(cache===undefined||cache!==title){$node.data(cacheName,title);// Generally <title> element should be the first child element of its parent.\nvar firstChild=node.firstChild;if(firstChild&&firstChild.tagName.toUpperCase()==='TITLE'){// Update an existing title\nfirstChild.textContent=title;}else{// Create a new title\nvar titleNode=document.createElementNS(node.namespaceURI,'title');titleNode.textContent=title;node.insertBefore(titleNode,firstChild);}}}},lineHeight:{qualify:isTextInUse},textVerticalAnchor:{qualify:isTextInUse},textPath:{qualify:isTextInUse},annotations:{qualify:isTextInUse},eol:{qualify:isTextInUse},displayEmpty:{qualify:isTextInUse},// `port` attribute contains the `id` of the port that the underlying magnet represents.\nport:{set:function(port){return port===null||port.id===undefined?port:port.id;}},// `style` attribute is special in the sense that it sets the CSS style of the subelement.\nstyle:{qualify:isPlainObject,set:function(styles,refBBox,node){$(node).css(styles);}},html:{set:function(html,refBBox,node){$(node).html(html+'');}},ref:{// We do not set `ref` attribute directly on an element.\n// The attribute itself does not qualify for relative positioning.\n},// if `refX` is in [0, 1] then `refX` is a fraction of bounding box width\n// if `refX` is < 0 then `refX`'s absolute values is the right coordinate of the bounding box\n// otherwise, `refX` is the left coordinate of the bounding box\nrefX:{position:positionWrapper('x','width','origin')},refY:{position:positionWrapper('y','height','origin')},// `ref-dx` and `ref-dy` define the offset of the subelement relative to the right and/or bottom\n// coordinate of the reference element.\nrefDx:{position:positionWrapper('x','width','corner')},refDy:{position:positionWrapper('y','height','corner')},// 'ref-width'/'ref-height' defines the width/height of the subelement relatively to\n// the reference element size\n// val in 0..1         ref-width = 0.75 sets the width to 75% of the ref. el. width\n// val < 0 || val > 1  ref-height = -20 sets the height to the ref. el. height shorter by 20\nrefWidth:{set:setWrapper('width','width')},refHeight:{set:setWrapper('height','height')},refRx:{set:setWrapper('rx','width')},refRy:{set:setWrapper('ry','height')},refRInscribed:{set:function(attrName){var widthFn=setWrapper(attrName,'width');var heightFn=setWrapper(attrName,'height');return function(value,refBBox){var fn=refBBox.height>refBBox.width?widthFn:heightFn;return fn(value,refBBox);};}('r')},refRCircumscribed:{set:function(value,refBBox){var isValuePercentage=isPercentage(value);value=parseFloat(value);if(isValuePercentage){value/=100;}var diagonalLength=Math.sqrt(refBBox.height*refBBox.height+refBBox.width*refBBox.width);var rValue;if(isFinite(value)){if(isValuePercentage||value>=0&&value<=1){rValue=value*diagonalLength;}else{rValue=Math.max(value+diagonalLength,0);}}return{r:rValue};}},refCx:{set:setWrapper('cx','width')},refCy:{set:setWrapper('cy','height')},// `x-alignment` when set to `middle` causes centering of the subelement around its new x coordinate.\n// `x-alignment` when set to `right` uses the x coordinate as referenced to the right of the bbox.\nxAlignment:{offset:offsetWrapper('x','width','right')},// `y-alignment` when set to `middle` causes centering of the subelement around its new y coordinate.\n// `y-alignment` when set to `bottom` uses the y coordinate as referenced to the bottom of the bbox.\nyAlignment:{offset:offsetWrapper('y','height','bottom')},resetOffset:{offset:function(val,nodeBBox){return val?{x:-nodeBBox.x,y:-nodeBBox.y}:{x:0,y:0};}},refDResetOffset:{set:dWrapper({resetOffset:true})},refDKeepOffset:{set:dWrapper({resetOffset:false})},refPointsResetOffset:{set:pointsWrapper({resetOffset:true})},refPointsKeepOffset:{set:pointsWrapper({resetOffset:false})},// LinkView Attributes\nconnection:{qualify:isLinkView,set:function(ref){var stubs=ref.stubs;if(stubs===void 0)stubs=0;var d;if(isFinite(stubs)&&stubs!==0){var offset;if(stubs<0){offset=(this.getConnectionLength()+stubs)/2;}else{offset=stubs;}var path=this.getConnection();var sourceParts=path.divideAtLength(offset);var targetParts=path.divideAtLength(-offset);if(sourceParts&&targetParts){d=sourceParts[0].serialize()+\" \"+targetParts[1].serialize();}}return{d:d||this.getSerializedConnection()};}},atConnectionLengthKeepGradient:{qualify:isLinkView,set:atConnectionWrapper('getTangentAtLength',{rotate:true})},atConnectionLengthIgnoreGradient:{qualify:isLinkView,set:atConnectionWrapper('getTangentAtLength',{rotate:false})},atConnectionRatioKeepGradient:{qualify:isLinkView,set:atConnectionWrapper('getTangentAtRatio',{rotate:true})},atConnectionRatioIgnoreGradient:{qualify:isLinkView,set:atConnectionWrapper('getTangentAtRatio',{rotate:false})}};attributesNS['xlink:href']=attributesNS.xlinkHref;// Support `calc()` with the following SVG attributes\n['transform',// g\n'd',// path\n'points',// polyline / polygon\n'width','height',// rect / image\n'cx','cy',// circle / ellipse\n'r',// circle\n'rx','ry',// rect / ellipse\n'x1','x2','y1','y2',// line\n'x','y',// rect / text / image\n'dx','dy'// text\n].forEach(function(attribute){attributesNS[attribute]={qualify:isCalcAttribute,set:function setCalcAttribute(value,refBBox){var obj;return obj={},obj[attribute]=evalCalcAttribute(value,refBBox),obj;}};});// Aliases\nattributesNS.refR=attributesNS.refRInscribed;attributesNS.refD=attributesNS.refDResetOffset;attributesNS.refPoints=attributesNS.refPointsResetOffset;attributesNS.atConnectionLength=attributesNS.atConnectionLengthKeepGradient;attributesNS.atConnectionRatio=attributesNS.atConnectionRatioKeepGradient;// This allows to combine both absolute and relative positioning\n// refX: 50%, refX2: 20\nattributesNS.refX2=attributesNS.refX;attributesNS.refY2=attributesNS.refY;attributesNS.refWidth2=attributesNS.refWidth;attributesNS.refHeight2=attributesNS.refHeight;// Aliases for backwards compatibility\nattributesNS['ref-x']=attributesNS.refX;attributesNS['ref-y']=attributesNS.refY;attributesNS['ref-dy']=attributesNS.refDy;attributesNS['ref-dx']=attributesNS.refDx;attributesNS['ref-width']=attributesNS.refWidth;attributesNS['ref-height']=attributesNS.refHeight;attributesNS['x-alignment']=attributesNS.xAlignment;attributesNS['y-alignment']=attributesNS.yAlignment;var attributes=attributesNS;// Cell base model.\n// --------------------------\nvar Cell=Backbone.Model.extend({// This is the same as Backbone.Model with the only difference that is uses util.merge\n// instead of just _.extend. The reason is that we want to mixin attributes set in upper classes.\nconstructor:function(attributes,options){var defaults;var attrs=attributes||{};if(typeof this.preinitialize==='function'){// Check to support an older version of Backbone (prior v1.4)\nthis.preinitialize.apply(this,arguments);}this.cid=uniqueId('c');this.attributes={};if(options&&options.collection){this.collection=options.collection;}if(options&&options.parse){attrs=this.parse(attrs,options)||{};}if(defaults=result(this,'defaults')){//<custom code>\n// Replaced the call to _.defaults with util.merge.\nattrs=merge({},defaults,attrs);//</custom code>\n}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments);},translate:function(dx,dy,opt){throw new Error('Must define a translate() method.');},toJSON:function(){var defaults=result(this.constructor.prototype,'defaults');var defaultAttrs=defaults.attrs||{};var attrs=this.attributes.attrs;var finalAttrs={};// Loop through all the attributes and\n// omit the default attributes as they are implicitly reconstructible by the cell 'type'.\nforIn(attrs,function(attr,selector){var defaultAttr=defaultAttrs[selector];forIn(attr,function(value,name){// attr is mainly flat though it might have one more level (consider the `style` attribute).\n// Check if the `value` is object and if yes, go one level deep.\nif(isObject$1(value)&&!Array.isArray(value)){forIn(value,function(value2,name2){if(!defaultAttr||!defaultAttr[name]||!isEqual(defaultAttr[name][name2],value2)){finalAttrs[selector]=finalAttrs[selector]||{};(finalAttrs[selector][name]||(finalAttrs[selector][name]={}))[name2]=value2;}});}else if(!defaultAttr||!isEqual(defaultAttr[name],value)){// `value` is not an object, default attribute for such a selector does not exist\n// or it is different than the attribute value set on the model.\nfinalAttrs[selector]=finalAttrs[selector]||{};finalAttrs[selector][name]=value;}});});var attributes=cloneDeep(omit(this.attributes,'attrs'));attributes.attrs=finalAttrs;return attributes;},initialize:function(options){var idAttribute=this.getIdAttribute();if(!options||!(idAttribute in options)){this.set(idAttribute,this.generateId(),{silent:true});}this._transitionIds={};this._scheduledTransitionIds={};// Collect ports defined in `attrs` and keep collecting whenever `attrs` object changes.\nthis.processPorts();this.on('change:attrs',this.processPorts,this);},getIdAttribute:function(){return this.idAttribute||'id';},generateId:function(){return uuid();},/**\n\t     * @deprecated\n\t     */processPorts:function(){// Whenever `attrs` changes, we extract ports from the `attrs` object and store it\n// in a more accessible way. Also, if any port got removed and there were links that had `target`/`source`\n// set to that port, we remove those links as well (to follow the same behaviour as\n// with a removed element).\nvar previousPorts=this.ports;// Collect ports from the `attrs` object.\nvar ports={};forIn(this.get('attrs'),function(attrs,selector){if(attrs&&attrs.port){// `port` can either be directly an `id` or an object containing an `id` (and potentially other data).\nif(attrs.port.id!==undefined){ports[attrs.port.id]=attrs.port;}else{ports[attrs.port]={id:attrs.port};}}});// Collect ports that have been removed (compared to the previous ports) - if any.\n// Use hash table for quick lookup.\nvar removedPorts={};forIn(previousPorts,function(port,id){if(!ports[id]){removedPorts[id]=true;}});// Remove all the incoming/outgoing links that have source/target port set to any of the removed ports.\nif(this.graph&&!isEmpty(removedPorts)){var inboundLinks=this.graph.getConnectedLinks(this,{inbound:true});inboundLinks.forEach(function(link){if(removedPorts[link.get('target').port]){link.remove();}});var outboundLinks=this.graph.getConnectedLinks(this,{outbound:true});outboundLinks.forEach(function(link){if(removedPorts[link.get('source').port]){link.remove();}});}// Update the `ports` object.\nthis.ports=ports;},remove:function(opt){if(opt===void 0)opt={};// Store the graph in a variable because `this.graph` won't be accessible\n// after `this.trigger('remove', ...)` down below.\nvar ref=this;var graph=ref.graph;var collection=ref.collection;if(!graph){// The collection is a common Backbone collection (not the graph collection).\nif(collection){collection.remove(this,opt);}return this;}graph.startBatch('remove');// First, unembed this cell from its parent cell if there is one.\nvar parentCell=this.getParentCell();if(parentCell){parentCell.unembed(this,opt);}// Remove also all the cells, which were embedded into this cell\nvar embeddedCells=this.getEmbeddedCells();for(var i=0,n=embeddedCells.length;i<n;i++){var embed=embeddedCells[i];if(embed){embed.remove(opt);}}this.trigger('remove',this,graph.attributes.cells,opt);graph.stopBatch('remove');return this;},toFront:function(opt){var graph=this.graph;if(graph){opt=opt||{};var z=graph.maxZIndex();var cells;if(opt.deep){cells=this.getEmbeddedCells({deep:true,breadthFirst:opt.breadthFirst!==false});cells.unshift(this);}else{cells=[this];}z=z-cells.length+1;var collection=graph.get('cells');var shouldUpdate=collection.indexOf(this)!==collection.length-cells.length;if(!shouldUpdate){shouldUpdate=cells.some(function(cell,index){return cell.get('z')!==z+index;});}if(shouldUpdate){this.startBatch('to-front');z=z+cells.length;cells.forEach(function(cell,index){cell.set('z',z+index,opt);});this.stopBatch('to-front');}}return this;},toBack:function(opt){var graph=this.graph;if(graph){opt=opt||{};var z=graph.minZIndex();var cells;if(opt.deep){cells=this.getEmbeddedCells({deep:true,breadthFirst:opt.breadthFirst!==false});cells.unshift(this);}else{cells=[this];}var collection=graph.get('cells');var shouldUpdate=collection.indexOf(this)!==0;if(!shouldUpdate){shouldUpdate=cells.some(function(cell,index){return cell.get('z')!==z+index;});}if(shouldUpdate){this.startBatch('to-back');z-=cells.length;cells.forEach(function(cell,index){cell.set('z',z+index,opt);});this.stopBatch('to-back');}}return this;},parent:function(parent,opt){// getter\nif(parent===undefined){return this.get('parent');}// setter\nreturn this.set('parent',parent,opt);},embed:function(cell,opt){var cells=Array.isArray(cell)?cell:[cell];if(!this.canEmbed(cells)){throw new Error('Recursive embedding not allowed.');}this._embedCells(cells,opt);return this;},unembed:function(cell,opt){var cells=Array.isArray(cell)?cell:[cell];this._unembedCells(cells,opt);return this;},canEmbed:function(cell){var this$1=this;var cells=Array.isArray(cell)?cell:[cell];return cells.every(function(c){return this$1!==c&&!this$1.isEmbeddedIn(c);});},_embedCells:function(cells,opt){var this$1=this;var batchName='embed';this.startBatch(batchName);var embeds=assign([],this.get('embeds'));cells.forEach(function(cell){// We keep all element ids after link ids.\nembeds[cell.isLink()?'unshift':'push'](cell.id);cell.parent(this$1.id,opt);});this.set('embeds',uniq(embeds),opt);this.stopBatch(batchName);},_unembedCells:function(cells,opt){var batchName='unembed';this.startBatch(batchName);cells.forEach(function(cell){return cell.unset('parent',opt);});this.set('embeds',without.apply(void 0,[this.get('embeds')].concat(cells.map(function(cell){return cell.id;}))),opt);this.stopBatch(batchName);},getParentCell:function(){// unlike link.source/target, cell.parent stores id directly as a string\nvar parentId=this.parent();var graph=this.graph;return parentId&&graph&&graph.getCell(parentId)||null;},// Return an array of ancestor cells.\n// The array is ordered from the parent of the cell\n// to the most distant ancestor.\ngetAncestors:function(){var ancestors=[];if(!this.graph){return ancestors;}var parentCell=this.getParentCell();while(parentCell){ancestors.push(parentCell);parentCell=parentCell.getParentCell();}return ancestors;},getEmbeddedCells:function(opt){opt=opt||{};// Cell models can only be retrieved when this element is part of a collection.\n// There is no way this element knows about other cells otherwise.\n// This also means that calling e.g. `translate()` on an element with embeds before\n// adding it to a graph does not translate its embeds.\nif(this.graph){var cells;if(opt.deep){if(opt.breadthFirst){// breadthFirst algorithm\ncells=[];var queue=this.getEmbeddedCells();while(queue.length>0){var parent=queue.shift();cells.push(parent);queue.push.apply(queue,parent.getEmbeddedCells());}}else{// depthFirst algorithm\ncells=this.getEmbeddedCells();cells.forEach(function(cell){cells.push.apply(cells,cell.getEmbeddedCells(opt));});}}else{cells=toArray(this.get('embeds')).map(this.graph.getCell,this.graph);}return cells;}return[];},isEmbeddedIn:function(cell,opt){var cellId=isString(cell)?cell:cell.id;var parentId=this.parent();opt=defaults({deep:true},opt);// See getEmbeddedCells().\nif(this.graph&&opt.deep){while(parentId){if(parentId===cellId){return true;}parentId=this.graph.getCell(parentId).parent();}return false;}else{// When this cell is not part of a collection check\n// at least whether it's a direct child of given cell.\nreturn parentId===cellId;}},// Whether or not the cell is embedded in any other cell.\nisEmbedded:function(){return!!this.parent();},// Isolated cloning. Isolated cloning has two versions: shallow and deep (pass `{ deep: true }` in `opt`).\n// Shallow cloning simply clones the cell and returns a new cell with different ID.\n// Deep cloning clones the cell and all its embedded cells recursively.\nclone:function(opt){opt=opt||{};if(!opt.deep){// Shallow cloning.\nvar clone=Backbone.Model.prototype.clone.apply(this,arguments);// We don't want the clone to have the same ID as the original.\nclone.set(this.getIdAttribute(),this.generateId());// A shallow cloned element does not carry over the original embeds.\nclone.unset('embeds');// And can not be embedded in any cell\n// as the clone is not part of the graph.\nclone.unset('parent');return clone;}else{// Deep cloning.\n// For a deep clone, simply call `graph.cloneCells()` with the cell and all its embedded cells.\nreturn toArray(cloneCells([this].concat(this.getEmbeddedCells({deep:true}))));}},// A convenient way to set nested properties.\n// This method merges the properties you'd like to set with the ones\n// stored in the cell and makes sure change events are properly triggered.\n// You can either set a nested property with one object\n// or use a property path.\n// The most simple use case is:\n// `cell.prop('name/first', 'John')` or\n// `cell.prop({ name: { first: 'John' } })`.\n// Nested arrays are supported too:\n// `cell.prop('series/0/data/0/degree', 50)` or\n// `cell.prop({ series: [ { data: [ { degree: 50 } ] } ] })`.\nprop:function(props,value,opt){var delim='/';var _isString=isString(props);if(_isString||Array.isArray(props)){// Get/set an attribute by a special path syntax that delimits\n// nested objects by the colon character.\nif(arguments.length>1){var path;var pathArray;if(_isString){path=props;pathArray=path.split('/');}else{path=props.join(delim);pathArray=props.slice();}var property=pathArray[0];var pathArrayLength=pathArray.length;opt=opt||{};opt.propertyPath=path;opt.propertyValue=value;opt.propertyPathArray=pathArray;if(pathArrayLength===1){// Property is not nested. We can simply use `set()`.\nreturn this.set(property,value,opt);}var update={};// Initialize the nested object. Subobjects are either arrays or objects.\n// An empty array is created if the sub-key is an integer. Otherwise, an empty object is created.\n// Note that this imposes a limitation on object keys one can use with Inspector.\n// Pure integer keys will cause issues and are therefore not allowed.\nvar initializer=update;var prevProperty=property;for(var i=1;i<pathArrayLength;i++){var pathItem=pathArray[i];var isArrayIndex=Number.isFinite(_isString?Number(pathItem):pathItem);initializer=initializer[prevProperty]=isArrayIndex?[]:{};prevProperty=pathItem;}// Fill update with the `value` on `path`.\nupdate=setByPath(update,pathArray,value,'/');var baseAttributes=merge({},this.attributes);// if rewrite mode enabled, we replace value referenced by path with\n// the new one (we don't merge).\nopt.rewrite&&unsetByPath(baseAttributes,path,'/');// Merge update with the model attributes.\nvar attributes=merge(baseAttributes,update);// Finally, set the property to the updated attributes.\nreturn this.set(property,attributes[property],opt);}else{return getByPath(this.attributes,props,delim);}}return this.set(merge({},this.attributes,props),value);},// A convenient way to unset nested properties\nremoveProp:function(path,opt){opt=opt||{};var pathArray=Array.isArray(path)?path:path.split('/');// Once a property is removed from the `attrs` attribute\n// the cellView will recognize a `dirty` flag and re-render itself\n// in order to remove the attribute from SVG element.\nvar property=pathArray[0];if(property==='attrs'){opt.dirty=true;}if(pathArray.length===1){// A top level property\nreturn this.unset(path,opt);}// A nested property\nvar nestedPath=pathArray.slice(1);var propertyValue=cloneDeep(this.get(property));unsetByPath(propertyValue,nestedPath,'/');return this.set(property,propertyValue,opt);},// A convenient way to set nested attributes.\nattr:function(attrs,value,opt){var args=Array.from(arguments);if(args.length===0){return this.get('attrs');}if(Array.isArray(attrs)){args[0]=['attrs'].concat(attrs);}else if(isString(attrs)){// Get/set an attribute by a special path syntax that delimits\n// nested objects by the colon character.\nargs[0]='attrs/'+attrs;}else{args[0]={'attrs':attrs};}return this.prop.apply(this,args);},// A convenient way to unset nested attributes\nremoveAttr:function(path,opt){if(Array.isArray(path)){return this.removeProp(['attrs'].concat(path));}return this.removeProp('attrs/'+path,opt);},transition:function(path,value,opt,delim){var this$1=this;delim=delim||'/';var defaults={duration:100,delay:10,timingFunction:timing.linear,valueFunction:interpolate.number};opt=assign(defaults,opt);var firstFrameTime=0;var interpolatingFunction;var setter=function(runtime){var id,progress,propertyValue;firstFrameTime=firstFrameTime||runtime;runtime-=firstFrameTime;progress=runtime/opt.duration;if(progress<1){this._transitionIds[path]=id=nextFrame(setter);}else{progress=1;delete this._transitionIds[path];}propertyValue=interpolatingFunction(opt.timingFunction(progress));opt.transitionId=id;this.prop(path,propertyValue,opt);if(!id){this.trigger('transition:end',this,path);}}.bind(this);var ref=this;var _scheduledTransitionIds=ref._scheduledTransitionIds;var initialId;var initiator=function(callback){if(_scheduledTransitionIds[path]){_scheduledTransitionIds[path]=without(_scheduledTransitionIds[path],initialId);if(_scheduledTransitionIds[path].length===0){delete _scheduledTransitionIds[path];}}this$1.stopPendingTransitions(path,delim);interpolatingFunction=opt.valueFunction(getByPath(this$1.attributes,path,delim),value);this$1._transitionIds[path]=nextFrame(callback);this$1.trigger('transition:start',this$1,path);};initialId=setTimeout(initiator,opt.delay,setter);_scheduledTransitionIds[path]||(_scheduledTransitionIds[path]=[]);_scheduledTransitionIds[path].push(initialId);return initialId;},getTransitions:function(){return union(Object.keys(this._transitionIds),Object.keys(this._scheduledTransitionIds));},stopScheduledTransitions:function(path,delim){if(delim===void 0)delim='/';var ref=this;var _scheduledTransitionIds=ref._scheduledTransitionIds;if(_scheduledTransitionIds===void 0)_scheduledTransitionIds={};var transitions=Object.keys(_scheduledTransitionIds);if(path){var pathArray=path.split(delim);transitions=transitions.filter(function(key){return isEqual(pathArray,key.split(delim).slice(0,pathArray.length));});}transitions.forEach(function(key){var transitionIds=_scheduledTransitionIds[key];// stop the initiator\ntransitionIds.forEach(function(transitionId){return clearTimeout(transitionId);});delete _scheduledTransitionIds[key];// Note: we could trigger transition:cancel` event here\n});return this;},stopPendingTransitions:function stopPendingTransitions(path,delim){var this$1=this;if(delim===void 0)delim='/';var ref=this;var _transitionIds=ref._transitionIds;if(_transitionIds===void 0)_transitionIds={};var transitions=Object.keys(_transitionIds);if(path){var pathArray=path.split(delim);transitions=transitions.filter(function(key){return isEqual(pathArray,key.split(delim).slice(0,pathArray.length));});}transitions.forEach(function(key){var transitionId=_transitionIds[key];// stop the setter\ncancelFrame(transitionId);delete _transitionIds[key];this$1.trigger('transition:end',this$1,key);});},stopTransitions:function(path,delim){if(delim===void 0)delim='/';this.stopScheduledTransitions(path,delim);this.stopPendingTransitions(path,delim);return this;},// A shorcut making it easy to create constructs like the following:\n// `var el = (new joint.shapes.basic.Rect).addTo(graph)`.\naddTo:function(graph,opt){graph.addCell(this,opt);return this;},// A shortcut for an equivalent call: `paper.findViewByModel(cell)`\n// making it easy to create constructs like the following:\n// `cell.findView(paper).highlight()`\nfindView:function(paper){return paper.findViewByModel(this);},isElement:function(){return false;},isLink:function(){return false;},startBatch:function(name,opt){if(this.graph){this.graph.startBatch(name,assign({},opt,{cell:this}));}return this;},stopBatch:function(name,opt){if(this.graph){this.graph.stopBatch(name,assign({},opt,{cell:this}));}return this;},getChangeFlag:function(attributes){var flag=0;if(!attributes){return flag;}for(var key in attributes){if(!attributes.hasOwnProperty(key)||!this.hasChanged(key)){continue;}flag|=attributes[key];}return flag;},angle:function(){// To be overridden.\nreturn 0;},position:function(){// To be overridden.\nreturn new Point(0,0);},getPointFromConnectedLink:function(){// To be overridden\nreturn new Point();},getBBox:function(){// To be overridden\nreturn new Rect(0,0,0,0);},getPointRotatedAroundCenter:function getPointRotatedAroundCenter(angle,x,y){var point=new Point(x,y);if(angle){point.rotate(this.getBBox().center(),angle);}return point;},getAbsolutePointFromRelative:function getAbsolutePointFromRelative(x,y){// Rotate the position to take the model angle into account\nreturn this.getPointRotatedAroundCenter(-this.angle(),// Transform the relative position to absolute\nthis.position().offset(x,y));},getRelativePointFromAbsolute:function getRelativePointFromAbsolute(x,y){return this// Rotate the coordinates to mitigate the element's rotation.\n.getPointRotatedAroundCenter(this.angle(),x,y)// Transform the absolute position into relative\n.difference(this.position());}},{getAttributeDefinition:function(attrName){var defNS=this.attributes;var globalDefNS=attributes;return defNS&&defNS[attrName]||globalDefNS[attrName];},define:function(type,defaults,protoProps,staticProps){protoProps=assign({defaults:defaultsDeep({type:type},defaults,this.prototype.defaults)},protoProps);var Cell=this.extend(protoProps,staticProps);// es5 backward compatibility\n/* eslint-disable no-undef */if(typeof joint!=='undefined'&&has$2(joint,'shapes')){setByPath(joint.shapes,type,Cell,'.');}/* eslint-enable no-undef */return Cell;}});var wrapWith=function(object,methods,wrapper){if(isString(wrapper)){if(!wrappers[wrapper]){throw new Error('Unknown wrapper: \"'+wrapper+'\"');}wrapper=wrappers[wrapper];}if(!isFunction(wrapper)){throw new Error('Wrapper must be a function.');}toArray(methods).forEach(function(method){object[method]=wrapper(object[method]);});};var wrappers={cells:function(fn){return function(){var args=Array.from(arguments);var n=args.length;var cells=n>0&&args[0]||[];var opt=n>1&&args[n-1]||{};if(!Array.isArray(cells)){if(opt instanceof Cell){cells=args;}else if(cells instanceof Cell){if(args.length>1){args.pop();}cells=args;}}if(opt instanceof Cell){opt={};}return fn.call(this,cells,opt);};}};var index={wrapWith:wrapWith,wrappers:wrappers,addClassNamePrefix:addClassNamePrefix,removeClassNamePrefix:removeClassNamePrefix,parseDOMJSON:parseDOMJSON,hashCode:hashCode,getByPath:getByPath,setByPath:setByPath,unsetByPath:unsetByPath,flattenObject:flattenObject,uuid:uuid,guid:guid,toKebabCase:toKebabCase,normalizeEvent:normalizeEvent,nextFrame:nextFrame,cancelFrame:cancelFrame,shapePerimeterConnectionPoint:shapePerimeterConnectionPoint,isPercentage:isPercentage,parseCssNumeric:parseCssNumeric,breakText:breakText,sanitizeHTML:sanitizeHTML,downloadBlob:downloadBlob,downloadDataUri:downloadDataUri,dataUriToBlob:dataUriToBlob,imageToDataUri:imageToDataUri,getElementBBox:getElementBBox,sortElements:sortElements,setAttributesBySelector:setAttributesBySelector,normalizeSides:normalizeSides,timing:timing,interpolate:interpolate,filter:filter,format:format,template:template,toggleFullScreen:toggleFullScreen,mixin:mixin,supplement:supplement,deepMixin:deepMixin,deepSupplement:deepSupplement,assign:assign,defaults:defaults,defaultsDeep:defaultsDeep,invoke:invoke,sortedIndex:sortedIndex,uniq:uniq,clone:clone,cloneDeep:cloneDeep,isEmpty:isEmpty,isEqual:isEqual,isFunction:isFunction,isPlainObject:isPlainObject,toArray:toArray,debounce:debounce,groupBy:groupBy,sortBy:sortBy,flattenDeep:flattenDeep,without:without,difference:difference,intersection:intersection$1,union:union,has:has$2,result:result,omit:omit,pick:pick,bindAll:bindAll,forIn:forIn,camelCase:camelCase,uniqueId:uniqueId,merge:merge,isBoolean:isBoolean,isObject:isObject$1,isNumber:isNumber,isString:isString,noop:noop,cloneCells:cloneCells};function portTransformAttrs(point,angle,opt){var trans=point.toJSON();trans.angle=angle||0;return defaults({},opt,trans);}function lineLayout(ports,p1,p2){return ports.map(function(port,index,ports){var p=this.pointAt((index+0.5)/ports.length);// `dx`,`dy` per port offset option\nif(port.dx||port.dy){p.offset(port.dx||0,port.dy||0);}return portTransformAttrs(p.round(),0,port);},line(p1,p2));}function ellipseLayout(ports,elBBox,startAngle,stepFn){var center=elBBox.center();var ratio=elBBox.width/elBBox.height;var p1=elBBox.topMiddle();var ellipse=Ellipse.fromRect(elBBox);return ports.map(function(port,index,ports){var angle=startAngle+stepFn(index,ports.length);var p2=p1.clone().rotate(center,-angle).scale(ratio,1,center);var theta=port.compensateRotation?-ellipse.tangentTheta(p2):0;// `dx`,`dy` per port offset option\nif(port.dx||port.dy){p2.offset(port.dx||0,port.dy||0);}// `dr` delta radius option\nif(port.dr){p2.move(center,port.dr);}return portTransformAttrs(p2.round(),theta,port);});}// Creates a point stored in arguments\nfunction argPoint(bbox,args){var x=args.x;if(isString(x)){x=parseFloat(x)/100*bbox.width;}var y=args.y;if(isString(y)){y=parseFloat(y)/100*bbox.height;}return point(x||0,y||0);}/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var absolute=function(ports,elBBox,opt){//TODO v.talas angle\nreturn ports.map(argPoint.bind(null,elBBox));};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var fn=function(ports,elBBox,opt){return opt.fn(ports,elBBox,opt);};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var line$1=function(ports,elBBox,opt){var start=argPoint(elBBox,opt.start||elBBox.origin());var end=argPoint(elBBox,opt.end||elBBox.corner());return lineLayout(ports,start,end);};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var left=function(ports,elBBox,opt){return lineLayout(ports,elBBox.origin(),elBBox.bottomLeft());};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var right=function(ports,elBBox,opt){return lineLayout(ports,elBBox.topRight(),elBBox.corner());};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var top=function(ports,elBBox,opt){return lineLayout(ports,elBBox.origin(),elBBox.topRight());};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */var bottom=function(ports,elBBox,opt){return lineLayout(ports,elBBox.bottomLeft(),elBBox.corner());};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt Group options\n\t * @returns {Array<g.Point>}\n\t */var ellipseSpread=function(ports,elBBox,opt){var startAngle=opt.startAngle||0;var stepAngle=opt.step||360/ports.length;return ellipseLayout(ports,elBBox,startAngle,function(index){return index*stepAngle;});};/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt Group options\n\t * @returns {Array<g.Point>}\n\t */var ellipse$1=function(ports,elBBox,opt){var startAngle=opt.startAngle||0;var stepAngle=opt.step||20;return ellipseLayout(ports,elBBox,startAngle,function(index,count){return(index+0.5-count/2)*stepAngle;});};var Port={absolute:absolute,fn:fn,line:line$1,left:left,right:right,top:top,bottom:bottom,ellipseSpread:ellipseSpread,ellipse:ellipse$1};function labelAttributes(opt1,opt2){return defaultsDeep({},opt1,opt2,{x:0,y:0,angle:0,attrs:{'.':{y:'0','text-anchor':'start'}}});}function outsideLayout(portPosition,elBBox,autoOrient,opt){opt=defaults({},opt,{offset:15});var angle=elBBox.center().theta(portPosition);var x=getBBoxAngles(elBBox);var tx,ty,y,textAnchor;var offset=opt.offset;var orientAngle=0;if(angle<x[1]||angle>x[2]){y='.3em';tx=offset;ty=0;textAnchor='start';}else if(angle<x[0]){y='0';tx=0;ty=-offset;if(autoOrient){orientAngle=-90;textAnchor='start';}else{textAnchor='middle';}}else if(angle<x[3]){y='.3em';tx=-offset;ty=0;textAnchor='end';}else{y='.6em';tx=0;ty=offset;if(autoOrient){orientAngle=90;textAnchor='start';}else{textAnchor='middle';}}var round=Math.round;return labelAttributes({x:round(tx),y:round(ty),angle:orientAngle,attrs:{'.':{y:y,'text-anchor':textAnchor}}});}function getBBoxAngles(elBBox){var center=elBBox.center();var tl=center.theta(elBBox.origin());var bl=center.theta(elBBox.bottomLeft());var br=center.theta(elBBox.corner());var tr=center.theta(elBBox.topRight());return[tl,tr,br,bl];}function insideLayout(portPosition,elBBox,autoOrient,opt){var angle=elBBox.center().theta(portPosition);opt=defaults({},opt,{offset:15});var tx,ty,y,textAnchor;var offset=opt.offset;var orientAngle=0;var bBoxAngles=getBBoxAngles(elBBox);if(angle<bBoxAngles[1]||angle>bBoxAngles[2]){y='.3em';tx=-offset;ty=0;textAnchor='end';}else if(angle<bBoxAngles[0]){y='.6em';tx=0;ty=offset;if(autoOrient){orientAngle=90;textAnchor='start';}else{textAnchor='middle';}}else if(angle<bBoxAngles[3]){y='.3em';tx=offset;ty=0;textAnchor='start';}else{y='0em';tx=0;ty=-offset;if(autoOrient){orientAngle=-90;textAnchor='start';}else{textAnchor='middle';}}var round=Math.round;return labelAttributes({x:round(tx),y:round(ty),angle:orientAngle,attrs:{'.':{y:y,'text-anchor':textAnchor}}});}function radialLayout(portCenterOffset,autoOrient,opt){opt=defaults({},opt,{offset:20});var origin=point(0,0);var angle=-portCenterOffset.theta(origin);var orientAngle=angle;var offset=portCenterOffset.clone().move(origin,opt.offset).difference(portCenterOffset).round();var y='.3em';var textAnchor;if((angle+90)%180===0){textAnchor=autoOrient?'end':'middle';if(!autoOrient&&angle===-270){y='0em';}}else if(angle>-270&&angle<-90){textAnchor='start';orientAngle=angle-180;}else{textAnchor='end';}var round=Math.round;return labelAttributes({x:round(offset.x),y:round(offset.y),angle:autoOrient?orientAngle:0,attrs:{'.':{y:y,'text-anchor':textAnchor}}});}var manual=function(portPosition,elBBox,opt){return labelAttributes(opt,elBBox);};var left$1=function(portPosition,elBBox,opt){return labelAttributes(opt,{x:-15,attrs:{'.':{y:'.3em','text-anchor':'end'}}});};var right$1=function(portPosition,elBBox,opt){return labelAttributes(opt,{x:15,attrs:{'.':{y:'.3em','text-anchor':'start'}}});};var top$1=function(portPosition,elBBox,opt){return labelAttributes(opt,{y:-15,attrs:{'.':{'text-anchor':'middle'}}});};var bottom$1=function(portPosition,elBBox,opt){return labelAttributes(opt,{y:15,attrs:{'.':{y:'.6em','text-anchor':'middle'}}});};var outsideOriented=function(portPosition,elBBox,opt){return outsideLayout(portPosition,elBBox,true,opt);};var outside=function(portPosition,elBBox,opt){return outsideLayout(portPosition,elBBox,false,opt);};var insideOriented=function(portPosition,elBBox,opt){return insideLayout(portPosition,elBBox,true,opt);};var inside=function(portPosition,elBBox,opt){return insideLayout(portPosition,elBBox,false,opt);};var radial=function(portPosition,elBBox,opt){return radialLayout(portPosition.difference(elBBox.center()),false,opt);};var radialOriented=function(portPosition,elBBox,opt){return radialLayout(portPosition.difference(elBBox.center()),true,opt);};var PortLabel={manual:manual,left:left$1,right:right$1,top:top$1,bottom:bottom$1,outsideOriented:outsideOriented,outside:outside,insideOriented:insideOriented,inside:inside,radial:radial,radialOriented:radialOriented};// Link base model.\n// --------------------------\nvar Link=Cell.extend({// The default markup for links.\nmarkup:['<path class=\"connection\" stroke=\"black\" d=\"M 0 0 0 0\"/>','<path class=\"marker-source\" fill=\"black\" stroke=\"black\" d=\"M 0 0 0 0\"/>','<path class=\"marker-target\" fill=\"black\" stroke=\"black\" d=\"M 0 0 0 0\"/>','<path class=\"connection-wrap\" d=\"M 0 0 0 0\"/>','<g class=\"labels\"/>','<g class=\"marker-vertices\"/>','<g class=\"marker-arrowheads\"/>','<g class=\"link-tools\"/>'].join(''),toolMarkup:['<g class=\"link-tool\">','<g class=\"tool-remove\" event=\"remove\">','<circle r=\"11\" />','<path transform=\"scale(.8) translate(-16, -16)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\" />','<title>Remove link.</title>','</g>','<g class=\"tool-options\" event=\"link:options\">','<circle r=\"11\" transform=\"translate(25)\"/>','<path fill=\"white\" transform=\"scale(.55) translate(29, -16)\" d=\"M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z\"/>','<title>Link options.</title>','</g>','</g>'].join(''),doubleToolMarkup:undefined,// The default markup for showing/removing vertices. These elements are the children of the .marker-vertices element (see `this.markup`).\n// Only .marker-vertex and .marker-vertex-remove element have special meaning. The former is used for\n// dragging vertices (changing their position). The latter is used for removing vertices.\nvertexMarkup:['<g class=\"marker-vertex-group\" transform=\"translate(<%= x %>, <%= y %>)\">','<circle class=\"marker-vertex\" idx=\"<%= idx %>\" r=\"10\" />','<path class=\"marker-vertex-remove-area\" idx=\"<%= idx %>\" d=\"M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z\" transform=\"translate(5, -33)\"/>','<path class=\"marker-vertex-remove\" idx=\"<%= idx %>\" transform=\"scale(.8) translate(9.5, -37)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\">','<title>Remove vertex.</title>','</path>','</g>'].join(''),arrowheadMarkup:['<g class=\"marker-arrowhead-group marker-arrowhead-group-<%= end %>\">','<path class=\"marker-arrowhead\" end=\"<%= end %>\" d=\"M 26 0 L 0 13 L 26 26 z\" />','</g>'].join(''),// may be overwritten by user to change default label (its markup, attrs, position)\ndefaultLabel:undefined,// deprecated\n// may be overwritten by user to change default label markup\n// lower priority than defaultLabel.markup\nlabelMarkup:undefined,// private\n_builtins:{defaultLabel:{// builtin default markup:\n// used if neither defaultLabel.markup\n// nor label.markup is set\nmarkup:[{tagName:'rect',selector:'rect'// faster than tagName CSS selector\n},{tagName:'text',selector:'text'// faster than tagName CSS selector\n}],// builtin default attributes:\n// applied only if builtin default markup is used\nattrs:{text:{fill:'#000000',fontSize:14,textAnchor:'middle',yAlignment:'middle',pointerEvents:'none'},rect:{ref:'text',fill:'#ffffff',rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},// builtin default position:\n// used if neither defaultLabel.position\n// nor label.position is set\nposition:{distance:0.5}}},defaults:{type:'link',source:{},target:{}},isLink:function(){return true;},disconnect:function(opt){return this.set({source:{x:0,y:0},target:{x:0,y:0}},opt);},source:function(source,args,opt){// getter\nif(source===undefined){return clone(this.get('source'));}// setter\nvar setSource;var setOpt;// `source` is a cell\n// take only its `id` and combine with `args`\nvar isCellProvided=source instanceof Cell;if(isCellProvided){// three arguments\nsetSource=clone(args)||{};setSource.id=source.id;setOpt=opt;return this.set('source',setSource,setOpt);}// `source` is a point-like object\n// for example, a g.Point\n// take only its `x` and `y` and combine with `args`\nvar isPointProvided=!isPlainObject(source);if(isPointProvided){// three arguments\nsetSource=clone(args)||{};setSource.x=source.x;setSource.y=source.y;setOpt=opt;return this.set('source',setSource,setOpt);}// `source` is an object\n// no checking\n// two arguments\nsetSource=source;setOpt=args;return this.set('source',setSource,setOpt);},target:function(target,args,opt){// getter\nif(target===undefined){return clone(this.get('target'));}// setter\nvar setTarget;var setOpt;// `target` is a cell\n// take only its `id` argument and combine with `args`\nvar isCellProvided=target instanceof Cell;if(isCellProvided){// three arguments\nsetTarget=clone(args)||{};setTarget.id=target.id;setOpt=opt;return this.set('target',setTarget,setOpt);}// `target` is a point-like object\n// for example, a g.Point\n// take only its `x` and `y` and combine with `args`\nvar isPointProvided=!isPlainObject(target);if(isPointProvided){// three arguments\nsetTarget=clone(args)||{};setTarget.x=target.x;setTarget.y=target.y;setOpt=opt;return this.set('target',setTarget,setOpt);}// `target` is an object\n// no checking\n// two arguments\nsetTarget=target;setOpt=args;return this.set('target',setTarget,setOpt);},router:function(name,args,opt){// getter\nif(name===undefined){var router=this.get('router');if(!router){if(this.get('manhattan')){return{name:'orthogonal'};}// backwards compatibility\nreturn null;}if(typeof router==='object'){return clone(router);}return router;// e.g. a function\n}// setter\nvar isRouterProvided=typeof name==='object'||typeof name==='function';var localRouter=isRouterProvided?name:{name:name,args:args};var localOpt=isRouterProvided?args:opt;return this.set('router',localRouter,localOpt);},connector:function(name,args,opt){// getter\nif(name===undefined){var connector=this.get('connector');if(!connector){if(this.get('smooth')){return{name:'smooth'};}// backwards compatibility\nreturn null;}if(typeof connector==='object'){return clone(connector);}return connector;// e.g. a function\n}// setter\nvar isConnectorProvided=typeof name==='object'||typeof name==='function';var localConnector=isConnectorProvided?name:{name:name,args:args};var localOpt=isConnectorProvided?args:opt;return this.set('connector',localConnector,localOpt);},// Labels API\n// A convenient way to set labels. Currently set values will be mixined with `value` if used as a setter.\nlabel:function(idx,label,opt){var labels=this.labels();idx=isFinite(idx)&&idx!==null?idx|0:0;if(idx<0){idx=labels.length+idx;}// getter\nif(arguments.length<=1){return this.prop(['labels',idx]);}// setter\nreturn this.prop(['labels',idx],label,opt);},labels:function(labels,opt){// getter\nif(arguments.length===0){labels=this.get('labels');if(!Array.isArray(labels)){return[];}return labels.slice();}// setter\nif(!Array.isArray(labels)){labels=[];}return this.set('labels',labels,opt);},hasLabels:function(){var ref=this.attributes;var labels=ref.labels;return Array.isArray(labels)&&labels.length>0;},insertLabel:function(idx,label,opt){if(!label){throw new Error('dia.Link: no label provided');}var labels=this.labels();var n=labels.length;idx=isFinite(idx)&&idx!==null?idx|0:n;if(idx<0){idx=n+idx+1;}labels.splice(idx,0,label);return this.labels(labels,opt);},// convenience function\n// add label to end of labels array\nappendLabel:function(label,opt){return this.insertLabel(-1,label,opt);},removeLabel:function(idx,opt){var labels=this.labels();idx=isFinite(idx)&&idx!==null?idx|0:-1;labels.splice(idx,1);return this.labels(labels,opt);},// Vertices API\nvertex:function(idx,vertex,opt){var vertices=this.vertices();idx=isFinite(idx)&&idx!==null?idx|0:0;if(idx<0){idx=vertices.length+idx;}// getter\nif(arguments.length<=1){return this.prop(['vertices',idx]);}// setter\nvar setVertex=this._normalizeVertex(vertex);return this.prop(['vertices',idx],setVertex,opt);},vertices:function(vertices,opt){// getter\nif(arguments.length===0){vertices=this.get('vertices');if(!Array.isArray(vertices)){return[];}return vertices.slice();}// setter\nif(!Array.isArray(vertices)){vertices=[];}var setVertices=[];for(var i=0;i<vertices.length;i++){var vertex=vertices[i];var setVertex=this._normalizeVertex(vertex);setVertices.push(setVertex);}return this.set('vertices',setVertices,opt);},insertVertex:function(idx,vertex,opt){if(!vertex){throw new Error('dia.Link: no vertex provided');}var vertices=this.vertices();var n=vertices.length;idx=isFinite(idx)&&idx!==null?idx|0:n;if(idx<0){idx=n+idx+1;}var setVertex=this._normalizeVertex(vertex);vertices.splice(idx,0,setVertex);return this.vertices(vertices,opt);},removeVertex:function(idx,opt){var vertices=this.vertices();idx=isFinite(idx)&&idx!==null?idx|0:-1;vertices.splice(idx,1);return this.vertices(vertices,opt);},_normalizeVertex:function(vertex){// is vertex a point-like object?\n// for example, a g.Point\nvar isPointProvided=!isPlainObject(vertex);if(isPointProvided){return{x:vertex.x,y:vertex.y};}// else: return vertex unchanged\nreturn vertex;},// Transformations\ntranslate:function(tx,ty,opt){// enrich the option object\nopt=opt||{};opt.translateBy=opt.translateBy||this.id;opt.tx=tx;opt.ty=ty;return this.applyToPoints(function(p){return{x:(p.x||0)+tx,y:(p.y||0)+ty};},opt);},scale:function(sx,sy,origin,opt){return this.applyToPoints(function(p){return Point(p).scale(sx,sy,origin).toJSON();},opt);},applyToPoints:function(fn,opt){if(!isFunction(fn)){throw new TypeError('dia.Link: applyToPoints expects its first parameter to be a function.');}var attrs={};var ref=this.attributes;var source=ref.source;var target=ref.target;if(!source.id){attrs.source=fn(source);}if(!target.id){attrs.target=fn(target);}var vertices=this.vertices();if(vertices.length>0){attrs.vertices=vertices.map(fn);}return this.set(attrs,opt);},getSourcePoint:function(){var sourceCell=this.getSourceCell();if(!sourceCell){return new Point(this.source());}return sourceCell.getPointFromConnectedLink(this,'source');},getTargetPoint:function(){var targetCell=this.getTargetCell();if(!targetCell){return new Point(this.target());}return targetCell.getPointFromConnectedLink(this,'target');},getPointFromConnectedLink:function/* link, endType */(){return this.getPolyline().pointAt(0.5);},getPolyline:function(){var points=[this.getSourcePoint()].concat(this.vertices().map(Point),[this.getTargetPoint()]);return new Polyline(points);},getBBox:function(){return this.getPolyline().bbox();},reparent:function(opt){var newParent;if(this.graph){var source=this.getSourceElement();var target=this.getTargetElement();var prevParent=this.getParentCell();if(source&&target){if(source===target||source.isEmbeddedIn(target)){newParent=target;}else if(target.isEmbeddedIn(source)){newParent=source;}else{newParent=this.graph.getCommonAncestor(source,target);}}if(prevParent&&(!newParent||newParent.id!==prevParent.id)){// Unembed the link if source and target has no common ancestor\n// or common ancestor changed\nprevParent.unembed(this,opt);}if(newParent){newParent.embed(this,opt);}}return newParent;},hasLoop:function(opt){opt=opt||{};var ref=this.attributes;var source=ref.source;var target=ref.target;var sourceId=source.id;var targetId=target.id;if(!sourceId||!targetId){// Link \"pinned\" to the paper does not have a loop.\nreturn false;}var loop=sourceId===targetId;// Note that there in the deep mode a link can have a loop,\n// even if it connects only a parent and its embed.\n// A loop \"target equals source\" is valid in both shallow and deep mode.\nif(!loop&&opt.deep&&this.graph){var sourceElement=this.getSourceCell();var targetElement=this.getTargetCell();loop=sourceElement.isEmbeddedIn(targetElement)||targetElement.isEmbeddedIn(sourceElement);}return loop;},// unlike source(), this method returns null if source is a point\ngetSourceCell:function(){var ref=this;var graph=ref.graph;var attributes=ref.attributes;var source=attributes.source;return source&&source.id&&graph&&graph.getCell(source.id)||null;},getSourceElement:function(){var cell=this;var visited={};do{if(visited[cell.id]){return null;}visited[cell.id]=true;cell=cell.getSourceCell();}while(cell&&cell.isLink());return cell;},// unlike target(), this method returns null if target is a point\ngetTargetCell:function(){var ref=this;var graph=ref.graph;var attributes=ref.attributes;var target=attributes.target;return target&&target.id&&graph&&graph.getCell(target.id)||null;},getTargetElement:function(){var cell=this;var visited={};do{if(visited[cell.id]){return null;}visited[cell.id]=true;cell=cell.getTargetCell();}while(cell&&cell.isLink());return cell;},// Returns the common ancestor for the source element,\n// target element and the link itself.\ngetRelationshipAncestor:function(){var connectionAncestor;if(this.graph){var cells=[this,this.getSourceElement(),// null if source is a point\nthis.getTargetElement()// null if target is a point\n].filter(function(item){return!!item;});connectionAncestor=this.graph.getCommonAncestor.apply(this.graph,cells);}return connectionAncestor||null;},// Is source, target and the link itself embedded in a given cell?\nisRelationshipEmbeddedIn:function(cell){var cellId=isString(cell)||isNumber(cell)?cell:cell.id;var ancestor=this.getRelationshipAncestor();return!!ancestor&&(ancestor.id===cellId||ancestor.isEmbeddedIn(cellId));},// Get resolved default label.\n_getDefaultLabel:function(){var defaultLabel=this.get('defaultLabel')||this.defaultLabel||{};var label={};label.markup=defaultLabel.markup||this.get('labelMarkup')||this.labelMarkup;label.position=defaultLabel.position;label.attrs=defaultLabel.attrs;label.size=defaultLabel.size;return label;}},{endsEqual:function(a,b){var portsEqual=a.port===b.port||!a.port&&!b.port;return a.id===b.id&&portsEqual;}});var PortData=function(data){var clonedData=cloneDeep(data)||{};this.ports=[];this.groups={};this.portLayoutNamespace=Port;this.portLabelLayoutNamespace=PortLabel;this._init(clonedData);};PortData.prototype={getPorts:function(){return this.ports;},getGroup:function(name){return this.groups[name]||{};},getPortsByGroup:function(groupName){return this.ports.filter(function(port){return port.group===groupName;});},getGroupPortsMetrics:function(groupName,elBBox){var group=this.getGroup(groupName);var ports=this.getPortsByGroup(groupName);var groupPosition=group.position||{};var groupPositionName=groupPosition.name;var namespace=this.portLayoutNamespace;if(!namespace[groupPositionName]){groupPositionName='left';}var groupArgs=groupPosition.args||{};var portsArgs=ports.map(function(port){return port&&port.position&&port.position.args;});var groupPortTransformations=namespace[groupPositionName](portsArgs,elBBox,groupArgs);var accumulator={ports:ports,result:[]};toArray(groupPortTransformations).reduce(function(res,portTransformation,index){var port=res.ports[index];res.result.push({portId:port.id,portTransformation:portTransformation,labelTransformation:this._getPortLabelLayout(port,Point(portTransformation),elBBox),portAttrs:port.attrs,portSize:port.size,labelSize:port.label.size});return res;}.bind(this),accumulator);return accumulator.result;},_getPortLabelLayout:function(port,portPosition,elBBox){var namespace=this.portLabelLayoutNamespace;var labelPosition=port.label.position.name||'left';if(namespace[labelPosition]){return namespace[labelPosition](portPosition,elBBox,port.label.position.args);}return null;},_init:function(data){// prepare groups\nif(isObject$1(data.groups)){var groups=Object.keys(data.groups);for(var i=0,n=groups.length;i<n;i++){var key=groups[i];this.groups[key]=this._evaluateGroup(data.groups[key]);}}// prepare ports\nvar ports=toArray(data.items);for(var j=0,m=ports.length;j<m;j++){this.ports.push(this._evaluatePort(ports[j]));}},_evaluateGroup:function(group){return merge(group,{position:this._getPosition(group.position,true),label:this._getLabel(group,true)});},_evaluatePort:function(port){var evaluated=assign({},port);var group=this.getGroup(port.group);evaluated.markup=evaluated.markup||group.markup;evaluated.attrs=merge({},group.attrs,evaluated.attrs);evaluated.position=this._createPositionNode(group,evaluated);evaluated.label=merge({},group.label,this._getLabel(evaluated));evaluated.z=this._getZIndex(group,evaluated);evaluated.size=assign({},group.size,evaluated.size);return evaluated;},_getZIndex:function(group,port){if(isNumber(port.z)){return port.z;}if(isNumber(group.z)||group.z==='auto'){return group.z;}return'auto';},_createPositionNode:function(group,port){return merge({name:'left',args:{}},group.position,{args:port.args});},_getPosition:function(position,setDefault){var args={};var positionName;if(isFunction(position)){positionName='fn';args.fn=position;}else if(isString(position)){positionName=position;}else if(position===undefined){positionName=setDefault?'left':null;}else if(Array.isArray(position)){positionName='absolute';args.x=position[0];args.y=position[1];}else if(isObject$1(position)){positionName=position.name;assign(args,position.args);}var result={args:args};if(positionName){result.name=positionName;}return result;},_getLabel:function(item,setDefaults){var label=item.label||{};var ret=label;ret.position=this._getPosition(label.position,setDefaults);return ret;}};var elementPortPrototype={_initializePorts:function(){this._createPortData();this.on('change:ports',function(){this._processRemovedPort();this._createPortData();},this);},/**\n\t     * remove links tied wiht just removed element\n\t     * @private\n\t     */_processRemovedPort:function(){var current=this.get('ports')||{};var currentItemsMap={};toArray(current.items).forEach(function(item){currentItemsMap[item.id]=true;});var previous=this.previous('ports')||{};var removed={};toArray(previous.items).forEach(function(item){if(!currentItemsMap[item.id]){removed[item.id]=true;}});var graph=this.graph;if(graph&&!isEmpty(removed)){var inboundLinks=graph.getConnectedLinks(this,{inbound:true});inboundLinks.forEach(function(link){if(removed[link.get('target').port]){link.remove();}});var outboundLinks=graph.getConnectedLinks(this,{outbound:true});outboundLinks.forEach(function(link){if(removed[link.get('source').port]){link.remove();}});}},/**\n\t     * @returns {boolean}\n\t     */hasPorts:function(){var ports=this.prop('ports/items');return Array.isArray(ports)&&ports.length>0;},/**\n\t     * @param {string} id\n\t     * @returns {boolean}\n\t     */hasPort:function(id){return this.getPortIndex(id)!==-1;},/**\n\t     * @returns {Array<object>}\n\t     */getPorts:function(){return cloneDeep(this.prop('ports/items'))||[];},/**\n\t     * @returns {Array<object>}\n\t     */getGroupPorts:function(groupName){var groupPorts=toArray(this.prop(['ports','items'])).filter(function(port){return port.group===groupName;});return cloneDeep(groupPorts);},/**\n\t     * @param {string} id\n\t     * @returns {object}\n\t     */getPort:function(id){return cloneDeep(toArray(this.prop('ports/items')).find(function(port){return port.id&&port.id===id;}));},/**\n\t     * @param {string} groupName\n\t     * @returns {Object<portId, {x: number, y: number, angle: number}>}\n\t     */getPortsPositions:function(groupName){var portsMetrics=this._portSettingsData.getGroupPortsMetrics(groupName,Rect(this.size()));return portsMetrics.reduce(function(positions,metrics){var transformation=metrics.portTransformation;positions[metrics.portId]={x:transformation.x,y:transformation.y,angle:transformation.angle};return positions;},{});},/**\n\t     * @param {string|Port} port port id or port\n\t     * @returns {number} port index\n\t     */getPortIndex:function(port){var id=isObject$1(port)?port.id:port;if(!this._isValidPortId(id)){return-1;}return toArray(this.prop('ports/items')).findIndex(function(item){return item.id===id;});},/**\n\t     * @param {object} port\n\t     * @param {object} [opt]\n\t     * @returns {joint.dia.Element}\n\t     */addPort:function(port,opt){if(!isObject$1(port)||Array.isArray(port)){throw new Error('Element: addPort requires an object.');}var ports=assign([],this.prop('ports/items'));ports.push(port);this.prop('ports/items',ports,opt);return this;},/**\n\t     * @param {string|Port|number} before\n\t     * @param {object} port\n\t     * @param {object} [opt]\n\t     * @returns {joint.dia.Element}\n\t     */insertPort:function(before,port,opt){var index$1=typeof before==='number'?before:this.getPortIndex(before);if(!isObject$1(port)||Array.isArray(port)){throw new Error('dia.Element: insertPort requires an object.');}var ports=assign([],this.prop('ports/items'));ports.splice(index$1,0,port);this.prop('ports/items',ports,opt);return this;},/**\n\t     * @param {string} portId\n\t     * @param {string|object=} path\n\t     * @param {*=} value\n\t     * @param {object=} opt\n\t     * @returns {joint.dia.Element}\n\t     */portProp:function(portId,path,value,opt){var index$1=this.getPortIndex(portId);if(index$1===-1){throw new Error('Element: unable to find port with id '+portId);}var args=Array.prototype.slice.call(arguments,1);if(Array.isArray(path)){args[0]=['ports','items',index$1].concat(path);}else if(isString(path)){// Get/set an attribute by a special path syntax that delimits\n// nested objects by the colon character.\nargs[0]=['ports/items/',index$1,'/',path].join('');}else{args=['ports/items/'+index$1];if(isPlainObject(path)){args.push(path);args.push(value);}}return this.prop.apply(this,args);},_validatePorts:function(){var portsAttr=this.get('ports')||{};var errorMessages=[];portsAttr=portsAttr||{};var ports=toArray(portsAttr.items);ports.forEach(function(p){if(typeof p!=='object'){errorMessages.push('Element: invalid port ',p);}if(!this._isValidPortId(p.id)){p.id=this.generatePortId();}},this);if(uniq(ports,'id').length!==ports.length){errorMessages.push('Element: found id duplicities in ports.');}return errorMessages;},generatePortId:function(){return this.generateId();},/**\n\t     * @param {string} id port id\n\t     * @returns {boolean}\n\t     * @private\n\t     */_isValidPortId:function(id){return id!==null&&id!==undefined&&!isObject$1(id);},addPorts:function(ports,opt){if(ports.length){this.prop('ports/items',assign([],this.prop('ports/items')).concat(ports),opt);}return this;},removePort:function(port,opt){var options=opt||{};var index$1=this.getPortIndex(port);if(index$1!==-1){var ports=assign([],this.prop(['ports','items']));ports.splice(index$1,1);options.rewrite=true;this.startBatch('port-remove');this.prop(['ports','items'],ports,options);this.stopBatch('port-remove');}return this;},removePorts:function(portsForRemoval,opt){var options,newPorts;if(Array.isArray(portsForRemoval)){options=opt||{};if(portsForRemoval.length===0){return this.this;}var currentPorts=assign([],this.prop(['ports','items']));newPorts=currentPorts.filter(function(cp){return!portsForRemoval.some(function(rp){var rpId=isObject$1(rp)?rp.id:rp;return cp.id===rpId;});});}else{options=portsForRemoval||{};newPorts=[];}this.startBatch('port-remove');options.rewrite=true;this.prop(['ports','items'],newPorts,options);this.stopBatch('port-remove');return this;},/**\n\t     * @private\n\t     */_createPortData:function(){var err=this._validatePorts();if(err.length>0){this.set('ports',this.previous('ports'));throw new Error(err.join(' '));}var prevPortData;if(this._portSettingsData){prevPortData=this._portSettingsData.getPorts();}this._portSettingsData=new PortData(this.get('ports'));var curPortData=this._portSettingsData.getPorts();if(prevPortData){var added=curPortData.filter(function(item){if(!prevPortData.find(function(prevPort){return prevPort.id===item.id;})){return item;}});var removed=prevPortData.filter(function(item){if(!curPortData.find(function(curPort){return curPort.id===item.id;})){return item;}});if(removed.length>0){this.trigger('ports:remove',this,removed);}if(added.length>0){this.trigger('ports:add',this,added);}}}};var elementViewPortPrototype={portContainerMarkup:'g',portMarkup:[{tagName:'circle',selector:'circle',attributes:{'r':10,'fill':'#FFFFFF','stroke':'#000000'}}],portLabelMarkup:[{tagName:'text',selector:'text',attributes:{'fill':'#000000'}}],/** @type {Object<string, {portElement: Vectorizer, portLabelElement: Vectorizer}>} */_portElementsCache:null,/**\n\t     * @private\n\t     */_initializePorts:function(){this._cleanPortsCache();},/**\n\t     * @typedef {Object} Port\n\t     *\n\t     * @property {string} id\n\t     * @property {Object} position\n\t     * @property {Object} label\n\t     * @property {Object} attrs\n\t     * @property {string} markup\n\t     * @property {string} group\n\t     */ /**\n\t     * @private\n\t     */_refreshPorts:function(){this._removePorts();this._cleanPortsCache();this._renderPorts();},_cleanPortsCache:function(){this._portElementsCache={};},/**\n\t     * @private\n\t     */_renderPorts:function(){// references to rendered elements without z-index\nvar elementReferences=[];var elem=this._getContainerElement();for(var i=0,count=elem.node.childNodes.length;i<count;i++){elementReferences.push(elem.node.childNodes[i]);}var portsGropsByZ=groupBy(this.model._portSettingsData.getPorts(),'z');var withoutZKey='auto';// render non-z first\ntoArray(portsGropsByZ[withoutZKey]).forEach(function(port){var portElement=this._getPortElement(port);elem.append(portElement);elementReferences.push(portElement);},this);var groupNames=Object.keys(portsGropsByZ);for(var k=0;k<groupNames.length;k++){var groupName=groupNames[k];if(groupName!==withoutZKey){var z=parseInt(groupName,10);this._appendPorts(portsGropsByZ[groupName],z,elementReferences);}}this._updatePorts();},/**\n\t     * @returns {V}\n\t     * @private\n\t     */_getContainerElement:function(){return this.rotatableNode||this.vel;},/**\n\t     * @param {Array<Port>}ports\n\t     * @param {number} z\n\t     * @param refs\n\t     * @private\n\t     */_appendPorts:function(ports,z,refs){var containerElement=this._getContainerElement();var portElements=toArray(ports).map(this._getPortElement,this);if(refs[z]||z<0){V(refs[Math.max(z,0)]).before(portElements);}else{containerElement.append(portElements);}},/**\n\t     * Try to get element from cache,\n\t     * @param port\n\t     * @returns {*}\n\t     * @private\n\t     */_getPortElement:function(port){if(this._portElementsCache[port.id]){return this._portElementsCache[port.id].portElement;}return this._createPortElement(port);},findPortNode:function(portId,selector){var portCache=this._portElementsCache[portId];if(!portCache){return null;}var portRoot=portCache.portContentElement.node;var portSelectors=portCache.portContentSelectors;var ref=this.findBySelector(selector,portRoot,portSelectors);var node=ref[0];if(node===void 0)node=null;return node;},/**\n\t     * @private\n\t     */_updatePorts:function(){// layout ports without group\nthis._updatePortGroup(undefined);// layout ports with explicit group\nvar groupsNames=Object.keys(this.model._portSettingsData.groups);groupsNames.forEach(this._updatePortGroup,this);},/**\n\t     * @private\n\t     */_removePorts:function(){invoke(this._portElementsCache,'portElement.remove');},/**\n\t     * @param {Port} port\n\t     * @returns {V}\n\t     * @private\n\t     */_createPortElement:function(port){var portElement;var labelElement;var labelSelectors;var portSelectors;var portContainerElement=V(this.portContainerMarkup).addClass('joint-port');var portMarkup=this._getPortMarkup(port);if(Array.isArray(portMarkup)){var portDoc=this.parseDOMJSON(portMarkup,portContainerElement.node);var portFragment=portDoc.fragment;if(portFragment.childNodes.length>1){portElement=V('g').append(portFragment);}else{portElement=V(portFragment.firstChild);}portSelectors=portDoc.selectors;}else{portElement=V(portMarkup);if(Array.isArray(portElement)){portElement=V('g').append(portElement);}}if(!portElement){throw new Error('ElementView: Invalid port markup.');}portElement.attr({'port':port.id,'port-group':port.group});var labelMarkupDef=this._getPortLabelMarkup(port.label);if(Array.isArray(labelMarkupDef)){// JSON Markup\nvar ref=this.parseDOMJSON(labelMarkupDef,portContainerElement.node);var fragment=ref.fragment;var selectors=ref.selectors;var childCount=fragment.childNodes.length;if(childCount>0){labelSelectors=selectors;labelElement=childCount===1?V(fragment.firstChild):V('g').append(fragment);}}else{// String Markup\nlabelElement=V(labelMarkupDef);if(Array.isArray(labelElement)){labelElement=V('g').append(labelElement);}}var portContainerSelectors;if(portSelectors&&labelSelectors){for(var key in labelSelectors){if(portSelectors[key]&&key!==this.selector){throw new Error('ElementView: selectors within port must be unique.');}}portContainerSelectors=assign({},portSelectors,labelSelectors);}else{portContainerSelectors=portSelectors||labelSelectors;}portContainerElement.append(portElement.addClass('joint-port-body'));if(labelElement){portContainerElement.append(labelElement.addClass('joint-port-label'));}this._portElementsCache[port.id]={portElement:portContainerElement,portLabelElement:labelElement,portSelectors:portContainerSelectors,portLabelSelectors:labelSelectors,portContentElement:portElement,portContentSelectors:portSelectors};return portContainerElement;},/**\n\t     * @param {string=} groupName\n\t     * @private\n\t     */_updatePortGroup:function(groupName){var elementBBox=Rect(this.model.size());var portsMetrics=this.model._portSettingsData.getGroupPortsMetrics(groupName,elementBBox);for(var i=0,n=portsMetrics.length;i<n;i++){var metrics=portsMetrics[i];var portId=metrics.portId;var cached=this._portElementsCache[portId]||{};var portTransformation=metrics.portTransformation;this.applyPortTransform(cached.portElement,portTransformation);this.updateDOMSubtreeAttributes(cached.portElement.node,metrics.portAttrs,{rootBBox:new Rect(metrics.portSize),selectors:cached.portSelectors});var labelTransformation=metrics.labelTransformation;if(labelTransformation&&cached.portLabelElement){this.applyPortTransform(cached.portLabelElement,labelTransformation,-portTransformation.angle||0);this.updateDOMSubtreeAttributes(cached.portLabelElement.node,labelTransformation.attrs,{rootBBox:new Rect(metrics.labelSize),selectors:cached.portLabelSelectors});}}},/**\n\t     * @param {Vectorizer} element\n\t     * @param {{dx:number, dy:number, angle: number, attrs: Object, x:number: y:number}} transformData\n\t     * @param {number=} initialAngle\n\t     * @constructor\n\t     */applyPortTransform:function(element,transformData,initialAngle){var matrix=V.createSVGMatrix().rotate(initialAngle||0).translate(transformData.x||0,transformData.y||0).rotate(transformData.angle||0);element.transform(matrix,{absolute:true});},/**\n\t     * @param {Port} port\n\t     * @returns {string}\n\t     * @private\n\t     */_getPortMarkup:function(port){return port.markup||this.model.get('portMarkup')||this.model.portMarkup||this.portMarkup;},/**\n\t     * @param {Object} label\n\t     * @returns {string}\n\t     * @private\n\t     */_getPortLabelMarkup:function(label){return label.markup||this.model.get('portLabelMarkup')||this.model.portLabelMarkup||this.portLabelMarkup;}};// Element base model.\n// -----------------------------\nvar Element$1=Cell.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts();Cell.prototype.initialize.apply(this,arguments);},/**\n\t     * @abstract\n\t     */_initializePorts:function(){// implemented in ports.js\n},_refreshPorts:function(){// implemented in ports.js\n},isElement:function(){return true;},position:function(x,y,opt){var isSetter=isNumber(y);opt=(isSetter?opt:x)||{};var parentRelative=opt.parentRelative;var deep=opt.deep;var restrictedArea=opt.restrictedArea;// option `parentRelative` for setting the position relative to the element's parent.\nvar parentPosition;if(parentRelative){// Getting the parent's position requires the collection.\n// Cell.parent() holds cell id only.\nif(!this.graph){throw new Error('Element must be part of a graph.');}var parent=this.getParentCell();if(parent&&!parent.isLink()){parentPosition=parent.get('position');}}if(isSetter){if(parentPosition){x+=parentPosition.x;y+=parentPosition.y;}if(deep||restrictedArea){var ref=this.get('position');var x0=ref.x;var y0=ref.y;this.translate(x-x0,y-y0,opt);}else{this.set('position',{x:x,y:y},opt);}return this;}else{// Getter returns a geometry point.\nvar elementPosition=Point(this.get('position'));return parentRelative?elementPosition.difference(parentPosition):elementPosition;}},translate:function(tx,ty,opt){tx=tx||0;ty=ty||0;if(tx===0&&ty===0){// Like nothing has happened.\nreturn this;}opt=opt||{};// Pass the initiator of the translation.\nopt.translateBy=opt.translateBy||this.id;var position=this.get('position')||{x:0,y:0};var ra=opt.restrictedArea;if(ra&&opt.translateBy===this.id){if(typeof ra==='function'){var newPosition=ra.call(this,position.x+tx,position.y+ty,opt);tx=newPosition.x-position.x;ty=newPosition.y-position.y;}else{// We are restricting the translation for the element itself only. We get\n// the bounding box of the element including all its embeds.\n// All embeds have to be translated the exact same way as the element.\nvar bbox=this.getBBox({deep:true});//- - - - - - - - - - - - -> ra.x + ra.width\n// - - - -> position.x      |\n// -> bbox.x\n//                âââââââ   |\n//         ââââââââââââââ\n//         âââââââââ        |\n//   âââââââââââââââ\n//   ââââââââ               |\n//   <-dx->                     | restricted area right border\n//         <-width->        |   â translated element\n//   <- - bbox.width - ->       â embedded element\nvar dx=position.x-bbox.x;var dy=position.y-bbox.y;// Find the maximal/minimal coordinates that the element can be translated\n// while complies the restrictions.\nvar x=Math.max(ra.x+dx,Math.min(ra.x+ra.width+dx-bbox.width,position.x+tx));var y=Math.max(ra.y+dy,Math.min(ra.y+ra.height+dy-bbox.height,position.y+ty));// recalculate the translation taking the restrictions into account.\ntx=x-position.x;ty=y-position.y;}}var translatedPosition={x:position.x+tx,y:position.y+ty};// To find out by how much an element was translated in event 'change:position' handlers.\nopt.tx=tx;opt.ty=ty;if(opt.transition){if(!isObject$1(opt.transition)){opt.transition={};}this.transition('position',translatedPosition,assign({},opt.transition,{valueFunction:interpolate.object}));// Recursively call `translate()` on all the embeds cells.\ninvoke(this.getEmbeddedCells(),'translate',tx,ty,opt);}else{this.startBatch('translate',opt);this.set('position',translatedPosition,opt);invoke(this.getEmbeddedCells(),'translate',tx,ty,opt);this.stopBatch('translate',opt);}return this;},size:function(width,height,opt){var currentSize=this.get('size');// Getter\n// () signature\nif(width===undefined){return{width:currentSize.width,height:currentSize.height};}// Setter\n// (size, opt) signature\nif(isObject$1(width)){opt=height;height=isNumber(width.height)?width.height:currentSize.height;width=isNumber(width.width)?width.width:currentSize.width;}return this.resize(width,height,opt);},resize:function(width,height,opt){opt=opt||{};this.startBatch('resize',opt);if(opt.direction){var currentSize=this.get('size');switch(opt.direction){case'left':case'right':// Don't change height when resizing horizontally.\nheight=currentSize.height;break;case'top':case'bottom':// Don't change width when resizing vertically.\nwidth=currentSize.width;break;}// Get the angle and clamp its value between 0 and 360 degrees.\nvar angle=normalizeAngle(this.get('angle')||0);// This is a rectangle in size of the un-rotated element.\nvar bbox=this.getBBox();var origin;if(angle){var quadrant={'top-right':0,'right':0,'top-left':1,'top':1,'bottom-left':2,'left':2,'bottom-right':3,'bottom':3}[opt.direction];if(opt.absolute){// We are taking the element's rotation into account\nquadrant+=Math.floor((angle+45)/90);quadrant%=4;}// Pick the corner point on the element, which meant to stay on its place before and\n// after the rotation.\nvar fixedPoint=bbox[['bottomLeft','corner','topRight','origin'][quadrant]]();// Find  an image of the previous indent point. This is the position, where is the\n// point actually located on the screen.\nvar imageFixedPoint=Point(fixedPoint).rotate(bbox.center(),-angle);// Every point on the element rotates around a circle with the centre of rotation\n// in the middle of the element while the whole element is being rotated. That means\n// that the distance from a point in the corner of the element (supposed its always rect) to\n// the center of the element doesn't change during the rotation and therefore it equals\n// to a distance on un-rotated element.\n// We can find the distance as DISTANCE = (ELEMENTWIDTH/2)^2 + (ELEMENTHEIGHT/2)^2)^0.5.\nvar radius=Math.sqrt(width*width+height*height)/2;// Now we are looking for an angle between x-axis and the line starting at image of fixed point\n// and ending at the center of the element. We call this angle `alpha`.\n// The image of a fixed point is located in n-th quadrant. For each quadrant passed\n// going anti-clockwise we have to add 90 degrees. Note that the first quadrant has index 0.\n//\n// 3 | 2\n// --c-- Quadrant positions around the element's center `c`\n// 0 | 1\n//\nvar alpha=quadrant*Math.PI/2;// Add an angle between the beginning of the current quadrant (line parallel with x-axis or y-axis\n// going through the center of the element) and line crossing the indent of the fixed point and the center\n// of the element. This is the angle we need but on the un-rotated element.\nalpha+=Math.atan(quadrant%2==0?height/width:width/height);// Lastly we have to deduct the original angle the element was rotated by and that's it.\nalpha-=toRad(angle);// With this angle and distance we can easily calculate the centre of the un-rotated element.\n// Note that fromPolar constructor accepts an angle in radians.\nvar center=Point.fromPolar(radius,alpha,imageFixedPoint);// The top left corner on the un-rotated element has to be half a width on the left\n// and half a height to the top from the center. This will be the origin of rectangle\n// we were looking for.\norigin=Point(center).offset(width/-2,height/-2);}else{// calculation for the origin Point when there is no rotation of the element\norigin=bbox.topLeft();switch(opt.direction){case'top':case'top-right':origin.offset(0,bbox.height-height);break;case'left':case'bottom-left':origin.offset(bbox.width-width,0);break;case'top-left':origin.offset(bbox.width-width,bbox.height-height);break;}}// Resize the element (before re-positioning it).\nthis.set('size',{width:width,height:height},opt);// Finally, re-position the element.\nthis.position(origin.x,origin.y,opt);}else{// Resize the element.\nthis.set('size',{width:width,height:height},opt);}this.stopBatch('resize',opt);return this;},scale:function(sx,sy,origin,opt){var scaledBBox=this.getBBox().scale(sx,sy,origin);this.startBatch('scale',opt);this.position(scaledBBox.x,scaledBBox.y,opt);this.resize(scaledBBox.width,scaledBBox.height,opt);this.stopBatch('scale');return this;},fitEmbeds:function(opt){if(opt===void 0)opt={};// Getting the children's size and position requires the collection.\n// Cell.get('embeds') helds an array of cell ids only.\nvar ref=this;var graph=ref.graph;if(!graph){throw new Error('Element must be part of a graph.');}var embeddedCells=this.getEmbeddedCells().filter(function(cell){return cell.isElement();});if(embeddedCells.length===0){return this;}this.startBatch('fit-embeds',opt);if(opt.deep){// Recursively apply fitEmbeds on all embeds first.\ninvoke(embeddedCells,'fitEmbeds',opt);}// Compute cell's size and position based on the children bbox\n// and given padding.\nvar ref$1=normalizeSides(opt.padding);var left=ref$1.left;var right=ref$1.right;var top=ref$1.top;var bottom=ref$1.bottom;var ref$2=graph.getCellsBBox(embeddedCells);var x=ref$2.x;var y=ref$2.y;var width=ref$2.width;var height=ref$2.height;// Apply padding computed above to the bbox.\nx-=left;y-=top;width+=left+right;height+=bottom+top;// Set new element dimensions finally.\nthis.set({position:{x:x,y:y},size:{width:width,height:height}},opt);this.stopBatch('fit-embeds');return this;},// Rotate element by `angle` degrees, optionally around `origin` point.\n// If `origin` is not provided, it is considered to be the center of the element.\n// If `absolute` is `true`, the `angle` is considered is absolute, i.e. it is not\n// the difference from the previous angle.\nrotate:function(angle,absolute,origin,opt){if(origin){var center=this.getBBox().center();var size=this.get('size');var position=this.get('position');center.rotate(origin,this.get('angle')-angle);var dx=center.x-size.width/2-position.x;var dy=center.y-size.height/2-position.y;this.startBatch('rotate',{angle:angle,absolute:absolute,origin:origin});this.position(position.x+dx,position.y+dy,opt);this.rotate(angle,absolute,null,opt);this.stopBatch('rotate');}else{this.set('angle',absolute?angle:(this.get('angle')+angle)%360,opt);}return this;},angle:function(){return normalizeAngle(this.get('angle')||0);},getBBox:function(opt){if(opt===void 0)opt={};var ref=this;var graph=ref.graph;var attributes=ref.attributes;var deep=opt.deep;var rotate=opt.rotate;if(deep&&graph){// Get all the embedded elements using breadth first algorithm.\nvar elements=this.getEmbeddedCells({deep:true,breadthFirst:true});// Add the model itself.\nelements.push(this);// Note: the default of getCellsBBox() is rotate=true and can't be\n// changed without a breaking change\nreturn graph.getCellsBBox(elements,opt);}var angle=attributes.angle;if(angle===void 0)angle=0;var attributes_position=attributes.position;var x=attributes_position.x;var y=attributes_position.y;var attributes_size=attributes.size;var width=attributes_size.width;var height=attributes_size.height;var bbox=new Rect(x,y,width,height);if(rotate){bbox.rotateAroundCenter(angle);}return bbox;},getPointFromConnectedLink:function(link,endType){// Center of the model\nvar bbox=this.getBBox();var center=bbox.center();// Center of a port\nvar endDef=link.get(endType);if(!endDef){return center;}var portId=endDef.port;if(!portId||!this.hasPort(portId)){return center;}var portGroup=this.portProp(portId,['group']);var portsPositions=this.getPortsPositions(portGroup);var portCenter=new Point(portsPositions[portId]).offset(bbox.origin());var angle=this.angle();if(angle){portCenter.rotate(center,-angle);}return portCenter;}});assign(Element$1.prototype,elementPortPrototype);var GraphCells=Backbone.Collection.extend({initialize:function(models,opt){// Set the optional namespace where all model classes are defined.\nif(opt.cellNamespace){this.cellNamespace=opt.cellNamespace;}else{/* eslint-disable no-undef */this.cellNamespace=typeof joint!=='undefined'&&has$2(joint,'shapes')?joint.shapes:null;/* eslint-enable no-undef */}this.graph=opt.graph;},model:function(attrs,opt){var collection=opt.collection;var namespace=collection.cellNamespace;// Find the model class in the namespace or use the default one.\nvar ModelClass=attrs.type==='link'?Link:getByPath(namespace,attrs.type,'.')||Element$1;var cell=new ModelClass(attrs,opt);// Add a reference to the graph. It is necessary to do this here because this is the earliest place\n// where a new model is created from a plain JS object. For other objects, see `joint.dia.Graph>>_prepareCell()`.\nif(!opt.dry){cell.graph=collection.graph;}return cell;},// `comparator` makes it easy to sort cells based on their `z` index.\ncomparator:function(model){return model.get('z')||0;}});var Graph=Backbone.Model.extend({initialize:function(attrs,opt){opt=opt||{};// Passing `cellModel` function in the options object to graph allows for\n// setting models based on attribute objects. This is especially handy\n// when processing JSON graphs that are in a different than JointJS format.\nvar cells=new GraphCells([],{model:opt.cellModel,cellNamespace:opt.cellNamespace,graph:this});Backbone.Model.prototype.set.call(this,'cells',cells);// Make all the events fired in the `cells` collection available.\n// to the outside world.\ncells.on('all',this.trigger,this);// Backbone automatically doesn't trigger re-sort if models attributes are changed later when\n// they're already in the collection. Therefore, we're triggering sort manually here.\nthis.on('change:z',this._sortOnChangeZ,this);// `joint.dia.Graph` keeps an internal data structure (an adjacency list)\n// for fast graph queries. All changes that affect the structure of the graph\n// must be reflected in the `al` object. This object provides fast answers to\n// questions such as \"what are the neighbours of this node\" or \"what\n// are the sibling links of this link\".\n// Outgoing edges per node. Note that we use a hash-table for the list\n// of outgoing edges for a faster lookup.\n// [nodeId] -> Object [edgeId] -> true\nthis._out={};// Ingoing edges per node.\n// [nodeId] -> Object [edgeId] -> true\nthis._in={};// `_nodes` is useful for quick lookup of all the elements in the graph, without\n// having to go through the whole cells array.\n// [node ID] -> true\nthis._nodes={};// `_edges` is useful for quick lookup of all the links in the graph, without\n// having to go through the whole cells array.\n// [edgeId] -> true\nthis._edges={};this._batches={};cells.on('add',this._restructureOnAdd,this);cells.on('remove',this._restructureOnRemove,this);cells.on('reset',this._restructureOnReset,this);cells.on('change:source',this._restructureOnChangeSource,this);cells.on('change:target',this._restructureOnChangeTarget,this);cells.on('remove',this._removeCell,this);},_sortOnChangeZ:function(){this.get('cells').sort();},_restructureOnAdd:function(cell){if(cell.isLink()){this._edges[cell.id]=true;var ref=cell.attributes;var source=ref.source;var target=ref.target;if(source.id){(this._out[source.id]||(this._out[source.id]={}))[cell.id]=true;}if(target.id){(this._in[target.id]||(this._in[target.id]={}))[cell.id]=true;}}else{this._nodes[cell.id]=true;}},_restructureOnRemove:function(cell){if(cell.isLink()){delete this._edges[cell.id];var ref=cell.attributes;var source=ref.source;var target=ref.target;if(source.id&&this._out[source.id]&&this._out[source.id][cell.id]){delete this._out[source.id][cell.id];}if(target.id&&this._in[target.id]&&this._in[target.id][cell.id]){delete this._in[target.id][cell.id];}}else{delete this._nodes[cell.id];}},_restructureOnReset:function(cells){// Normalize into an array of cells. The original `cells` is GraphCells Backbone collection.\ncells=cells.models;this._out={};this._in={};this._nodes={};this._edges={};cells.forEach(this._restructureOnAdd,this);},_restructureOnChangeSource:function(link){var prevSource=link.previous('source');if(prevSource.id&&this._out[prevSource.id]){delete this._out[prevSource.id][link.id];}var source=link.attributes.source;if(source.id){(this._out[source.id]||(this._out[source.id]={}))[link.id]=true;}},_restructureOnChangeTarget:function(link){var prevTarget=link.previous('target');if(prevTarget.id&&this._in[prevTarget.id]){delete this._in[prevTarget.id][link.id];}var target=link.get('target');if(target.id){(this._in[target.id]||(this._in[target.id]={}))[link.id]=true;}},// Return all outbound edges for the node. Return value is an object\n// of the form: [edgeId] -> true\ngetOutboundEdges:function(node){return this._out&&this._out[node]||{};},// Return all inbound edges for the node. Return value is an object\n// of the form: [edgeId] -> true\ngetInboundEdges:function(node){return this._in&&this._in[node]||{};},toJSON:function(){// Backbone does not recursively call `toJSON()` on attributes that are themselves models/collections.\n// It just clones the attributes. Therefore, we must call `toJSON()` on the cells collection explicitly.\nvar json=Backbone.Model.prototype.toJSON.apply(this,arguments);json.cells=this.get('cells').toJSON();return json;},fromJSON:function(json,opt){if(!json.cells){throw new Error('Graph JSON must contain cells array.');}return this.set(json,opt);},set:function(key,val,opt){var attrs;// Handle both `key`, value and {key: value} style arguments.\nif(typeof key==='object'){attrs=key;opt=val;}else{(attrs={})[key]=val;}// Make sure that `cells` attribute is handled separately via resetCells().\nif(attrs.hasOwnProperty('cells')){this.resetCells(attrs.cells,opt);attrs=omit(attrs,'cells');}// The rest of the attributes are applied via original set method.\nreturn Backbone.Model.prototype.set.call(this,attrs,opt);},clear:function(opt){opt=assign({},opt,{clear:true});var collection=this.get('cells');if(collection.length===0){return this;}this.startBatch('clear',opt);// The elements come after the links.\nvar cells=collection.sortBy(function(cell){return cell.isLink()?1:2;});do{// Remove all the cells one by one.\n// Note that all the links are removed first, so it's\n// safe to remove the elements without removing the connected\n// links first.\ncells.shift().remove(opt);}while(cells.length>0);this.stopBatch('clear');return this;},_prepareCell:function(cell,opt){var attrs;if(cell instanceof Backbone.Model){attrs=cell.attributes;if(!cell.graph&&(!opt||!opt.dry)){// An element can not be member of more than one graph.\n// A cell stops being the member of the graph after it's explicitly removed.\ncell.graph=this;}}else{// In case we're dealing with a plain JS object, we have to set the reference\n// to the `graph` right after the actual model is created. This happens in the `model()` function\n// of `joint.dia.GraphCells`.\nattrs=cell;}if(!isString(attrs.type)){throw new TypeError('dia.Graph: cell type must be a string.');}return cell;},minZIndex:function(){var firstCell=this.get('cells').first();return firstCell?firstCell.get('z')||0:0;},maxZIndex:function(){var lastCell=this.get('cells').last();return lastCell?lastCell.get('z')||0:0;},addCell:function(cell,opt){if(Array.isArray(cell)){return this.addCells(cell,opt);}if(cell instanceof Backbone.Model){if(!cell.has('z')){cell.set('z',this.maxZIndex()+1);}}else if(cell.z===undefined){cell.z=this.maxZIndex()+1;}this.get('cells').add(this._prepareCell(cell,opt),opt||{});return this;},addCells:function(cells,opt){if(cells.length===0){return this;}cells=flattenDeep(cells);opt.maxPosition=opt.position=cells.length-1;this.startBatch('add',opt);cells.forEach(function(cell){this.addCell(cell,opt);opt.position--;},this);this.stopBatch('add',opt);return this;},// When adding a lot of cells, it is much more efficient to\n// reset the entire cells collection in one go.\n// Useful for bulk operations and optimizations.\nresetCells:function(cells,opt){var preparedCells=toArray(cells).map(function(cell){return this._prepareCell(cell,opt);},this);this.get('cells').reset(preparedCells,opt);return this;},removeCells:function(cells,opt){if(cells.length){this.startBatch('remove');invoke(cells,'remove',opt);this.stopBatch('remove');}return this;},_removeCell:function(cell,collection,options){options=options||{};if(!options.clear){// Applications might provide a `disconnectLinks` option set to `true` in order to\n// disconnect links when a cell is removed rather then removing them. The default\n// is to remove all the associated links.\nif(options.disconnectLinks){this.disconnectLinks(cell,options);}else{this.removeLinks(cell,options);}}// Silently remove the cell from the cells collection. Silently, because\n// `joint.dia.Cell.prototype.remove` already triggers the `remove` event which is\n// then propagated to the graph model. If we didn't remove the cell silently, two `remove` events\n// would be triggered on the graph model.\nthis.get('cells').remove(cell,{silent:true});if(cell.graph===this){// Remove the element graph reference only if the cell is the member of this graph.\ncell.graph=null;}},// Get a cell by `id`.\ngetCell:function(id){return this.get('cells').get(id);},getCells:function(){return this.get('cells').toArray();},getElements:function(){return this.get('cells').filter(function(cell){return cell.isElement();});},getLinks:function(){return this.get('cells').filter(function(cell){return cell.isLink();});},getFirstCell:function(){return this.get('cells').first();},getLastCell:function(){return this.get('cells').last();},// Get all inbound and outbound links connected to the cell `model`.\ngetConnectedLinks:function(model,opt){opt=opt||{};var indirect=opt.indirect;var inbound=opt.inbound;var outbound=opt.outbound;if(inbound===undefined&&outbound===undefined){inbound=outbound=true;}// the final array of connected link models\nvar links=[];// a hash table of connected edges of the form: [edgeId] -> true\n// used for quick lookups to check if we already added a link\nvar edges={};if(outbound){addOutbounds(this,model);}if(inbound){addInbounds(this,model);}function addOutbounds(graph,model){forIn(graph.getOutboundEdges(model.id),function(_,edge){// skip links that were already added\n// (those must be self-loop links)\n// (because they are inbound and outbound edges of the same two elements)\nif(edges[edge]){return;}var link=graph.getCell(edge);links.push(link);edges[edge]=true;if(indirect){if(inbound){addInbounds(graph,link);}if(outbound){addOutbounds(graph,link);}}}.bind(graph));if(indirect&&model.isLink()){var outCell=model.getTargetCell();if(outCell&&outCell.isLink()){if(!edges[outCell.id]){links.push(outCell);addOutbounds(graph,outCell);}}}}function addInbounds(graph,model){forIn(graph.getInboundEdges(model.id),function(_,edge){// skip links that were already added\n// (those must be self-loop links)\n// (because they are inbound and outbound edges of the same two elements)\nif(edges[edge]){return;}var link=graph.getCell(edge);links.push(link);edges[edge]=true;if(indirect){if(inbound){addInbounds(graph,link);}if(outbound){addOutbounds(graph,link);}}}.bind(graph));if(indirect&&model.isLink()){var inCell=model.getSourceCell();if(inCell&&inCell.isLink()){if(!edges[inCell.id]){links.push(inCell);addInbounds(graph,inCell);}}}}// if `deep` option is `true`, check also all the links that are connected to any of the descendant cells\nif(opt.deep){var embeddedCells=model.getEmbeddedCells({deep:true});// in the first round, we collect all the embedded elements\nvar embeddedElements={};embeddedCells.forEach(function(cell){if(cell.isElement()){embeddedElements[cell.id]=true;}});embeddedCells.forEach(function(cell){if(cell.isLink()){return;}if(outbound){forIn(this.getOutboundEdges(cell.id),function(exists,edge){if(!edges[edge]){var edgeCell=this.getCell(edge);var ref=edgeCell.attributes;var source=ref.source;var target=ref.target;var sourceId=source.id;var targetId=target.id;// if `includeEnclosed` option is falsy, skip enclosed links\nif(!opt.includeEnclosed&&sourceId&&embeddedElements[sourceId]&&targetId&&embeddedElements[targetId]){return;}links.push(this.getCell(edge));edges[edge]=true;}}.bind(this));}if(inbound){forIn(this.getInboundEdges(cell.id),function(exists,edge){if(!edges[edge]){var edgeCell=this.getCell(edge);var ref=edgeCell.attributes;var source=ref.source;var target=ref.target;var sourceId=source.id;var targetId=target.id;// if `includeEnclosed` option is falsy, skip enclosed links\nif(!opt.includeEnclosed&&sourceId&&embeddedElements[sourceId]&&targetId&&embeddedElements[targetId]){return;}links.push(this.getCell(edge));edges[edge]=true;}}.bind(this));}},this);}return links;},getNeighbors:function(model,opt){opt||(opt={});var inbound=opt.inbound;var outbound=opt.outbound;if(inbound===undefined&&outbound===undefined){inbound=outbound=true;}var neighbors=this.getConnectedLinks(model,opt).reduce(function(res,link){var ref=link.attributes;var source=ref.source;var target=ref.target;var loop=link.hasLoop(opt);// Discard if it is a point, or if the neighbor was already added.\nif(inbound&&has$2(source,'id')&&!res[source.id]){var sourceElement=this.getCell(source.id);if(sourceElement.isElement()){if(loop||sourceElement&&sourceElement!==model&&(!opt.deep||!sourceElement.isEmbeddedIn(model))){res[source.id]=sourceElement;}}}// Discard if it is a point, or if the neighbor was already added.\nif(outbound&&has$2(target,'id')&&!res[target.id]){var targetElement=this.getCell(target.id);if(targetElement.isElement()){if(loop||targetElement&&targetElement!==model&&(!opt.deep||!targetElement.isEmbeddedIn(model))){res[target.id]=targetElement;}}}return res;}.bind(this),{});if(model.isLink()){if(inbound){var sourceCell=model.getSourceCell();if(sourceCell&&sourceCell.isElement()&&!neighbors[sourceCell.id]){neighbors[sourceCell.id]=sourceCell;}}if(outbound){var targetCell=model.getTargetCell();if(targetCell&&targetCell.isElement()&&!neighbors[targetCell.id]){neighbors[targetCell.id]=targetCell;}}}return toArray(neighbors);},getCommonAncestor:function/* cells */(){var cellsAncestors=Array.from(arguments).map(function(cell){var ancestors=[];var parentId=cell.get('parent');while(parentId){ancestors.push(parentId);parentId=this.getCell(parentId).get('parent');}return ancestors;},this);cellsAncestors=cellsAncestors.sort(function(a,b){return a.length-b.length;});var commonAncestor=toArray(cellsAncestors.shift()).find(function(ancestor){return cellsAncestors.every(function(cellAncestors){return cellAncestors.includes(ancestor);});});return this.getCell(commonAncestor);},// Find the whole branch starting at `element`.\n// If `opt.deep` is `true`, take into account embedded elements too.\n// If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.\ngetSuccessors:function(element,opt){opt=opt||{};var res=[];// Modify the options so that it includes the `outbound` neighbors only. In other words, search forwards.\nthis.search(element,function(el){if(el!==element){res.push(el);}},assign({},opt,{outbound:true}));return res;},cloneCells:cloneCells,// Clone the whole subgraph (including all the connected links whose source/target is in the subgraph).\n// If `opt.deep` is `true`, also take into account all the embedded cells of all the subgraph cells.\n// Return a map of the form: [original cell ID] -> [clone].\ncloneSubgraph:function(cells,opt){var subgraph=this.getSubgraph(cells,opt);return this.cloneCells(subgraph);},// Return `cells` and all the connected links that connect cells in the `cells` array.\n// If `opt.deep` is `true`, return all the cells including all their embedded cells\n// and all the links that connect any of the returned cells.\n// For example, for a single shallow element, the result is that very same element.\n// For two elements connected with a link: `A --- L ---> B`, the result for\n// `getSubgraph([A, B])` is `[A, L, B]`. The same goes for `getSubgraph([L])`, the result is again `[A, L, B]`.\ngetSubgraph:function(cells,opt){opt=opt||{};var subgraph=[];// `cellMap` is used for a quick lookup of existence of a cell in the `cells` array.\nvar cellMap={};var elements=[];var links=[];toArray(cells).forEach(function(cell){if(!cellMap[cell.id]){subgraph.push(cell);cellMap[cell.id]=cell;if(cell.isLink()){links.push(cell);}else{elements.push(cell);}}if(opt.deep){var embeds=cell.getEmbeddedCells({deep:true});embeds.forEach(function(embed){if(!cellMap[embed.id]){subgraph.push(embed);cellMap[embed.id]=embed;if(embed.isLink()){links.push(embed);}else{elements.push(embed);}}});}});links.forEach(function(link){// For links, return their source & target (if they are elements - not points).\nvar ref=link.attributes;var source=ref.source;var target=ref.target;if(source.id&&!cellMap[source.id]){var sourceElement=this.getCell(source.id);subgraph.push(sourceElement);cellMap[sourceElement.id]=sourceElement;elements.push(sourceElement);}if(target.id&&!cellMap[target.id]){var targetElement=this.getCell(target.id);subgraph.push(this.getCell(target.id));cellMap[targetElement.id]=targetElement;elements.push(targetElement);}},this);elements.forEach(function(element){// For elements, include their connected links if their source/target is in the subgraph;\nvar links=this.getConnectedLinks(element,opt);links.forEach(function(link){var ref=link.attributes;var source=ref.source;var target=ref.target;if(!cellMap[link.id]&&source.id&&cellMap[source.id]&&target.id&&cellMap[target.id]){subgraph.push(link);cellMap[link.id]=link;}});},this);return subgraph;},// Find all the predecessors of `element`. This is a reverse operation of `getSuccessors()`.\n// If `opt.deep` is `true`, take into account embedded elements too.\n// If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.\ngetPredecessors:function(element,opt){opt=opt||{};var res=[];// Modify the options so that it includes the `inbound` neighbors only. In other words, search backwards.\nthis.search(element,function(el){if(el!==element){res.push(el);}},assign({},opt,{inbound:true}));return res;},// Perform search on the graph.\n// If `opt.breadthFirst` is `true`, use the Breadth-first Search algorithm, otherwise use Depth-first search.\n// By setting `opt.inbound` to `true`, you can reverse the direction of the search.\n// If `opt.deep` is `true`, take into account embedded elements too.\n// `iteratee` is a function of the form `function(element) {}`.\n// If `iteratee` explicitly returns `false`, the searching stops.\nsearch:function(element,iteratee,opt){opt=opt||{};if(opt.breadthFirst){this.bfs(element,iteratee,opt);}else{this.dfs(element,iteratee,opt);}},// Breadth-first search.\n// If `opt.deep` is `true`, take into account embedded elements too.\n// If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).\n// `iteratee` is a function of the form `function(element, distance) {}`.\n// where `element` is the currently visited element and `distance` is the distance of that element\n// from the root `element` passed the `bfs()`, i.e. the element we started the search from.\n// Note that the `distance` is not the shortest or longest distance, it is simply the number of levels\n// crossed till we visited the `element` for the first time. It is especially useful for tree graphs.\n// If `iteratee` explicitly returns `false`, the searching stops.\nbfs:function(element,iteratee,opt){if(opt===void 0)opt={};var visited={};var distance={};var queue=[];queue.push(element);distance[element.id]=0;while(queue.length>0){var next=queue.shift();if(visited[next.id]){continue;}visited[next.id]=true;if(iteratee.call(this,next,distance[next.id])===false){continue;}var neighbors=this.getNeighbors(next,opt);for(var i=0,n=neighbors.length;i<n;i++){var neighbor=neighbors[i];distance[neighbor.id]=distance[next.id]+1;queue.push(neighbor);}}},// Depth-first search.\n// If `opt.deep` is `true`, take into account embedded elements too.\n// If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).\n// `iteratee` is a function of the form `function(element, distance) {}`.\n// If `iteratee` explicitly returns `false`, the search stops.\ndfs:function(element,iteratee,opt){if(opt===void 0)opt={};var visited={};var distance={};var queue=[];queue.push(element);distance[element.id]=0;while(queue.length>0){var next=queue.pop();if(visited[next.id]){continue;}visited[next.id]=true;if(iteratee.call(this,next,distance[next.id])===false){continue;}var neighbors=this.getNeighbors(next,opt);var lastIndex=queue.length;for(var i=0,n=neighbors.length;i<n;i++){var neighbor=neighbors[i];distance[neighbor.id]=distance[next.id]+1;queue.splice(lastIndex,0,neighbor);}}},// Get all the roots of the graph. Time complexity: O(|V|).\ngetSources:function(){var sources=[];forIn(this._nodes,function(exists,node){if(!this._in[node]||isEmpty(this._in[node])){sources.push(this.getCell(node));}}.bind(this));return sources;},// Get all the leafs of the graph. Time complexity: O(|V|).\ngetSinks:function(){var sinks=[];forIn(this._nodes,function(exists,node){if(!this._out[node]||isEmpty(this._out[node])){sinks.push(this.getCell(node));}}.bind(this));return sinks;},// Return `true` if `element` is a root. Time complexity: O(1).\nisSource:function(element){return!this._in[element.id]||isEmpty(this._in[element.id]);},// Return `true` if `element` is a leaf. Time complexity: O(1).\nisSink:function(element){return!this._out[element.id]||isEmpty(this._out[element.id]);},// Return `true` is `elementB` is a successor of `elementA`. Return `false` otherwise.\nisSuccessor:function(elementA,elementB){var isSuccessor=false;this.search(elementA,function(element){if(element===elementB&&element!==elementA){isSuccessor=true;return false;}},{outbound:true});return isSuccessor;},// Return `true` is `elementB` is a predecessor of `elementA`. Return `false` otherwise.\nisPredecessor:function(elementA,elementB){var isPredecessor=false;this.search(elementA,function(element){if(element===elementB&&element!==elementA){isPredecessor=true;return false;}},{inbound:true});return isPredecessor;},// Return `true` is `elementB` is a neighbor of `elementA`. Return `false` otherwise.\n// `opt.deep` controls whether to take into account embedded elements as well. See `getNeighbors()`\n// for more details.\n// If `opt.outbound` is set to `true`, return `true` only if `elementB` is a successor neighbor.\n// Similarly, if `opt.inbound` is set to `true`, return `true` only if `elementB` is a predecessor neighbor.\nisNeighbor:function(elementA,elementB,opt){opt=opt||{};var inbound=opt.inbound;var outbound=opt.outbound;if(inbound===undefined&&outbound===undefined){inbound=outbound=true;}var isNeighbor=false;this.getConnectedLinks(elementA,opt).forEach(function(link){var ref=link.attributes;var source=ref.source;var target=ref.target;// Discard if it is a point.\nif(inbound&&has$2(source,'id')&&source.id===elementB.id){isNeighbor=true;return false;}// Discard if it is a point, or if the neighbor was already added.\nif(outbound&&has$2(target,'id')&&target.id===elementB.id){isNeighbor=true;return false;}});return isNeighbor;},// Disconnect links connected to the cell `model`.\ndisconnectLinks:function(model,opt){this.getConnectedLinks(model).forEach(function(link){link.set(link.attributes.source.id===model.id?'source':'target',{x:0,y:0},opt);});},// Remove links connected to the cell `model` completely.\nremoveLinks:function(model,opt){invoke(this.getConnectedLinks(model),'remove',opt);},// Find all elements at given point\nfindModelsFromPoint:function(p){return this.getElements().filter(function(el){return el.getBBox({rotate:true}).containsPoint(p);});},// Find all elements in given area\nfindModelsInArea:function(rect,opt){if(opt===void 0)opt={};var r=new Rect(rect);var strict=opt.strict;if(strict===void 0)strict=false;var method=strict?'containsRect':'intersect';return this.getElements().filter(function(el){return r[method](el.getBBox({rotate:true}));});},// Find all elements under the given element.\nfindModelsUnderElement:function(element,opt){if(opt===void 0)opt={};var searchBy=opt.searchBy;if(searchBy===void 0)searchBy='bbox';var bbox=element.getBBox().rotateAroundCenter(element.angle());var elements=searchBy==='bbox'?this.findModelsInArea(bbox):this.findModelsFromPoint(bbox[searchBy]());// don't account element itself or any of its descendants\nreturn elements.filter(function(el){return element.id!==el.id&&!el.isEmbeddedIn(element);});},// Return bounding box of all elements.\ngetBBox:function(){return this.getCellsBBox(this.getCells());},// Return the bounding box of all cells in array provided.\ngetCellsBBox:function(cells,opt){if(opt===void 0)opt={};var rotate=opt.rotate;if(rotate===void 0)rotate=true;return toArray(cells).reduce(function(memo,cell){var rect=cell.getBBox({rotate:rotate});if(!rect){return memo;}if(memo){return memo.union(rect);}return rect;},null);},translate:function(dx,dy,opt){// Don't translate cells that are embedded in any other cell.\nvar cells=this.getCells().filter(function(cell){return!cell.isEmbedded();});invoke(cells,'translate',dx,dy,opt);return this;},resize:function(width,height,opt){return this.resizeCells(width,height,this.getCells(),opt);},resizeCells:function(width,height,cells,opt){// `getBBox` method returns `null` if no elements provided.\n// i.e. cells can be an array of links\nvar bbox=this.getCellsBBox(cells);if(bbox){var sx=Math.max(width/bbox.width,0);var sy=Math.max(height/bbox.height,0);invoke(cells,'scale',sx,sy,bbox.origin(),opt);}return this;},startBatch:function(name,data){data=data||{};this._batches[name]=(this._batches[name]||0)+1;return this.trigger('batch:start',assign({},data,{batchName:name}));},stopBatch:function(name,data){data=data||{};this._batches[name]=(this._batches[name]||0)-1;return this.trigger('batch:stop',assign({},data,{batchName:name}));},hasActiveBatch:function(name){var batches=this._batches;var names;if(arguments.length===0){names=Object.keys(batches);}else if(Array.isArray(name)){names=name;}else{names=[name];}return names.some(function(batch){return batches[batch]>0;});}},{validations:{multiLinks:function(graph,link){// Do not allow multiple links to have the same source and target.\nvar ref=link.attributes;var source=ref.source;var target=ref.target;if(source.id&&target.id){var sourceModel=link.getSourceCell();if(sourceModel){var connectedLinks=graph.getConnectedLinks(sourceModel,{outbound:true});var sameLinks=connectedLinks.filter(function(_link){var ref=_link.attributes;var _source=ref.source;var _target=ref.target;return _source&&_source.id===source.id&&(!_source.port||_source.port===source.port)&&_target&&_target.id===target.id&&(!_target.port||_target.port===target.port);});if(sameLinks.length>1){return false;}}}return true;},linkPinning:function(_graph,link){var ref=link.attributes;var source=ref.source;var target=ref.target;return source.id&&target.id;}}});wrapWith(Graph.prototype,['resetCells','addCells','removeCells'],wrappers.cells);var views={};var View=Backbone.View.extend({options:{},theme:null,themeClassNamePrefix:addClassNamePrefix('theme-'),requireSetThemeOverride:false,defaultTheme:config.defaultTheme,children:null,childNodes:null,DETACHABLE:true,UPDATE_PRIORITY:2,FLAG_INSERT:1<<30,FLAG_REMOVE:1<<29,constructor:function(options){this.requireSetThemeOverride=options&&!!options.theme;this.options=assign({},this.options,options);Backbone.View.call(this,options);},initialize:function(){views[this.cid]=this;this.setTheme(this.options.theme||this.defaultTheme);this.init();},unmount:function(){if(this.svgElement){this.vel.remove();}else{this.$el.remove();}},renderChildren:function(children){children||(children=result(this,'children'));if(children){var isSVG=this.svgElement;var namespace=V.namespace[isSVG?'svg':'xhtml'];var doc=parseDOMJSON(children,namespace);(isSVG?this.vel:this.$el).empty().append(doc.fragment);this.childNodes=doc.selectors;}return this;},findAttribute:function(attributeName,node){var currentNode=node;while(currentNode&&currentNode.nodeType===1){var attributeValue=currentNode.getAttribute(attributeName);// attribute found\nif(attributeValue){return attributeValue;}// do not climb up the DOM\nif(currentNode===this.el){return null;}// try parent node\ncurrentNode=currentNode.parentNode;}return null;},// Override the Backbone `_ensureElement()` method in order to create an\n// svg element (e.g., `<g>`) node that wraps all the nodes of the Cell view.\n// Expose class name setter as a separate method.\n_ensureElement:function(){if(!this.el){var tagName=result(this,'tagName');var attrs=assign({},result(this,'attributes'));var style=assign({},result(this,'style'));if(this.id){attrs.id=result(this,'id');}this.setElement(this._createElement(tagName));this._setAttributes(attrs);this._setStyle(style);}else{this.setElement(result(this,'el'));}this._ensureElClassName();},_setAttributes:function(attrs){if(this.svgElement){this.vel.attr(attrs);}else{this.$el.attr(attrs);}},_setStyle:function(style){this.$el.css(style);},_createElement:function(tagName){if(this.svgElement){return document.createElementNS(V.namespace.svg,tagName);}else{return document.createElement(tagName);}},// Utilize an alternative DOM manipulation API by\n// adding an element reference wrapped in Vectorizer.\n_setElement:function(el){this.$el=el instanceof Backbone.$?el:Backbone.$(el);this.el=this.$el[0];if(this.svgElement){this.vel=V(this.el);}},_ensureElClassName:function(){var className=result(this,'className');if(!className){return;}var prefixedClassName=addClassNamePrefix(className);// Note: className removal here kept for backwards compatibility only\nif(this.svgElement){this.vel.removeClass(className).addClass(prefixedClassName);}else{this.$el.removeClass(className).addClass(prefixedClassName);}},init:function(){// Intentionally empty.\n// This method is meant to be overridden.\n},onRender:function(){// Intentionally empty.\n// This method is meant to be overridden.\n},confirmUpdate:function(){// Intentionally empty.\n// This method is meant to be overridden.\nreturn 0;},setTheme:function(theme,opt){opt=opt||{};// Theme is already set, override is required, and override has not been set.\n// Don't set the theme.\nif(this.theme&&this.requireSetThemeOverride&&!opt.override){return this;}this.removeThemeClassName();this.addThemeClassName(theme);this.onSetTheme(this.theme/* oldTheme */,theme/* newTheme */);this.theme=theme;return this;},addThemeClassName:function(theme){theme=theme||this.theme;if(!theme){return this;}var className=this.themeClassNamePrefix+theme;if(this.svgElement){this.vel.addClass(className);}else{this.$el.addClass(className);}return this;},removeThemeClassName:function(theme){theme=theme||this.theme;var className=this.themeClassNamePrefix+theme;if(this.svgElement){this.vel.removeClass(className);}else{this.$el.removeClass(className);}return this;},onSetTheme:function(oldTheme,newTheme){// Intentionally empty.\n// This method is meant to be overridden.\n},remove:function(){this.onRemove();this.undelegateDocumentEvents();views[this.cid]=null;Backbone.View.prototype.remove.apply(this,arguments);return this;},onRemove:function(){// Intentionally empty.\n// This method is meant to be overridden.\n},getEventNamespace:function(){// Returns a per-session unique namespace\nreturn'.joint-event-ns-'+this.cid;},delegateElementEvents:function(element,events,data){if(!events){return this;}data||(data={});var eventNS=this.getEventNamespace();for(var eventName in events){var method=events[eventName];if(typeof method!=='function'){method=this[method];}if(!method){continue;}$(element).on(eventName+eventNS,data,method.bind(this));}return this;},undelegateElementEvents:function(element){$(element).off(this.getEventNamespace());return this;},delegateDocumentEvents:function(events,data){events||(events=result(this,'documentEvents'));return this.delegateElementEvents(document,events,data);},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document);},eventData:function(evt,data){if(!evt){throw new Error('eventData(): event object required.');}var currentData=evt.data;var key='__'+this.cid+'__';if(data===undefined){if(!currentData){return{};}return currentData[key]||{};}currentData||(currentData=evt.data={});currentData[key]||(currentData[key]={});assign(currentData[key],data);return this;},stopPropagation:function(evt){this.eventData(evt,{propagationStopped:true});return this;},isPropagationStopped:function(evt){return!!this.eventData(evt).propagationStopped;}},{extend:function(){var args=Array.from(arguments);// Deep clone the prototype and static properties objects.\n// This prevents unexpected behavior where some properties are overwritten outside of this function.\nvar protoProps=args[0]&&assign({},args[0])||{};var staticProps=args[1]&&assign({},args[1])||{};// Need the real render method so that we can wrap it and call it later.\nvar renderFn=protoProps.render||this.prototype&&this.prototype.render||null;/*\n\t            Wrap the real render method so that:\n\t                .. `onRender` is always called.\n\t                .. `this` is always returned.\n\t        */protoProps.render=function(){if(typeof renderFn==='function'){// Call the original render method.\nrenderFn.apply(this,arguments);}if(this.render.__render__===renderFn){// Should always call onRender() method.\n// Should call it only once when renderFn is actual prototype method i.e. not the wrapper\nthis.onRender();}// Should always return itself.\nreturn this;};protoProps.render.__render__=renderFn;return Backbone.View.extend.call(this,protoProps,staticProps);}});var DoubleTapEventName='dbltap';if($.event&&!(DoubleTapEventName in $.event.special)){var maxDelay=config.doubleTapInterval;var minDelay=30;$.event.special[DoubleTapEventName]={bindType:'touchend',delegateType:'touchend',handle:function(event){var ref;var args=[],len=arguments.length-1;while(len-->0)args[len]=arguments[len+1];var handleObj=event.handleObj;var target=event.target;var targetData=$.data(target);var now=new Date().getTime();var delta='lastTouch'in targetData?now-targetData.lastTouch:0;if(delta<maxDelay&&delta>minDelay){targetData.lastTouch=null;event.type=handleObj.origType;// let jQuery handle the triggering of \"dbltap\" event handlers\n(ref=handleObj.handler).call.apply(ref,[this,event].concat(args));}else{targetData.lastTouch=now;}}};}var index$1={views:views,View:View};var LayersNames={CELLS:'cells',BACK:'back',FRONT:'front',TOOLS:'tools',LABELS:'labels'};var PaperLayer=View.extend({tagName:'g',svgElement:true,pivotNodes:null,defaultTheme:null,options:{name:''},className:function(){return addClassNamePrefix(this.options.name+\"-layer\");},init:function(){this.pivotNodes={};},insertSortedNode:function(node,z){this.el.insertBefore(node,this.insertPivot(z));},insertNode:function(node){var ref=this;var el=ref.el;if(node.parentNode!==el){el.appendChild(node);}},insertPivot:function(z){var ref=this;var el=ref.el;var pivotNodes=ref.pivotNodes;z=+z;z||(z=0);var pivotNode=pivotNodes[z];if(pivotNode){return pivotNode;}pivotNode=pivotNodes[z]=document.createComment('z-index:'+(z+1));var neighborZ=-Infinity;for(var currentZ in pivotNodes){currentZ=+currentZ;if(currentZ<z&&currentZ>neighborZ){neighborZ=currentZ;if(neighborZ===z-1){continue;}}}if(neighborZ!==-Infinity){var neighborPivot=pivotNodes[neighborZ];// Insert After\nel.insertBefore(pivotNode,neighborPivot.nextSibling);}else{// First Child\nel.insertBefore(pivotNode,el.firstChild);}return pivotNode;},removePivots:function(){var ref=this;var el=ref.el;var pivotNodes=ref.pivotNodes;for(var z in pivotNodes){el.removeChild(pivotNodes[z]);}this.pivotNodes={};}});function toArray$1(obj){if(!obj){return[];}if(Array.isArray(obj)){return obj;}return[obj];}var HighlighterView=View.extend({tagName:'g',svgElement:true,className:'highlight',HIGHLIGHT_FLAG:1,UPDATE_PRIORITY:3,DETACHABLE:false,UPDATABLE:true,MOUNTABLE:true,cellView:null,nodeSelector:null,node:null,updateRequested:false,transformGroup:null,requestUpdate:function requestUpdate(cellView,nodeSelector){var paper=cellView.paper;this.cellView=cellView;this.nodeSelector=nodeSelector;if(paper){this.updateRequested=true;paper.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY);}},confirmUpdate:function confirmUpdate(){// The cellView is now rendered/updated since it has a higher update priority.\nthis.updateRequested=false;var ref=this;var cellView=ref.cellView;var nodeSelector=ref.nodeSelector;this.update(cellView,nodeSelector);this.mount();this.transform();return 0;},findNode:function findNode(cellView,nodeSelector){var assign,assign$1;if(nodeSelector===void 0)nodeSelector=null;var el;if(typeof nodeSelector==='string'){assign=cellView.findBySelector(nodeSelector),el=assign[0];}else if(isPlainObject(nodeSelector)){var isLink=cellView.model.isLink();var label=nodeSelector.label;if(label===void 0)label=null;var port=nodeSelector.port;var selector=nodeSelector.selector;if(isLink&&label!==null){// Link Label Selector\nel=cellView.findLabelNode(label,selector);}else if(!isLink&&port){// Element Port Selector\nel=cellView.findPortNode(port,selector);}else{// Cell Selector\nassign$1=cellView.findBySelector(selector),el=assign$1[0];}}else if(nodeSelector){el=V.toNode(nodeSelector);if(!(el instanceof SVGElement)){el=null;}}return el?el:null;},mount:function mount(){var ref=this;var MOUNTABLE=ref.MOUNTABLE;var cellView=ref.cellView;var el=ref.el;var options=ref.options;var transformGroup=ref.transformGroup;if(!MOUNTABLE||transformGroup){return;}var cellViewRoot=cellView.vel;var paper=cellView.paper;var layerName=options.layer;if(layerName){var vGroup=this.transformGroup=V('g').addClass('highlight-transform').append(el);paper.getLayerView(layerName).insertSortedNode(vGroup.node,options.z);}else{// TODO: prepend vs append\nif(!el.parentNode||el.nextSibling){// Not appended yet or not the last child\ncellViewRoot.append(el);}}},unmount:function unmount(){var ref=this;var MOUNTABLE=ref.MOUNTABLE;var transformGroup=ref.transformGroup;var vel=ref.vel;if(!MOUNTABLE){return;}if(transformGroup){this.transformGroup=null;transformGroup.remove();}else{vel.remove();}},transform:function transform(){var ref=this;var transformGroup=ref.transformGroup;var cellView=ref.cellView;var updateRequested=ref.updateRequested;if(!transformGroup||cellView.model.isLink()||updateRequested){return;}var translateMatrix=cellView.getRootTranslateMatrix();var rotateMatrix=cellView.getRootRotateMatrix();var transformMatrix=translateMatrix.multiply(rotateMatrix);transformGroup.attr('transform',V.matrixToTransformString(transformMatrix));},update:function update(){var ref=this;var prevNode=ref.node;var cellView=ref.cellView;var nodeSelector=ref.nodeSelector;var updateRequested=ref.updateRequested;var id=ref.id;if(updateRequested){return;}var node=this.node=this.findNode(cellView,nodeSelector);if(prevNode){this.unhighlight(cellView,prevNode);}if(node){this.highlight(cellView,node);this.mount();}else{this.unmount();cellView.notify('cell:highlight:invalid',id,this);}},onRemove:function onRemove(){var ref=this;var node=ref.node;var cellView=ref.cellView;var id=ref.id;var constructor=ref.constructor;if(node){this.unhighlight(cellView,node);}this.unmount();constructor._removeRef(cellView,id);},highlight:function highlight(_cellView,_node){// to be overridden\n},unhighlight:function unhighlight(_cellView,_node){// to be overridden\n}},{_views:{},// Used internally by CellView highlight()\nhighlight:function(cellView,node,opt){var id=this.uniqueId(node,opt);this.add(cellView,node,id,opt);},// Used internally by CellView unhighlight()\nunhighlight:function(cellView,node,opt){var id=this.uniqueId(node,opt);this.remove(cellView,id);},get:function get(cellView,id){if(id===void 0)id=null;var cid=cellView.cid;var ref$2=this;var _views=ref$2._views;var refs=_views[cid];if(id===null){// all highlighters\nvar views=[];if(!refs){return views;}for(var hid in refs){var ref=refs[hid];if(ref instanceof this){views.push(ref);}}return views;}else{// single highlighter\nif(!refs){return null;}if(id in refs){var ref$1=refs[id];if(ref$1 instanceof this){return ref$1;}}return null;}},add:function add(cellView,nodeSelector,id,opt){if(opt===void 0)opt={};if(!id){throw new Error('dia.HighlighterView: An ID required.');}// Search the existing view amongst all the highlighters\nvar previousView=HighlighterView.get(cellView,id);if(previousView){previousView.remove();}var view=new this(opt);view.id=id;this._addRef(cellView,id,view);view.requestUpdate(cellView,nodeSelector);return view;},_addRef:function _addRef(cellView,id,view){var cid=cellView.cid;var ref=this;var _views=ref._views;var refs=_views[cid];if(!refs){refs=_views[cid]={};}refs[id]=view;},_removeRef:function _removeRef(cellView,id){var cid=cellView.cid;var ref=this;var _views=ref._views;var refs=_views[cid];if(!refs){return;}if(id){delete refs[id];}for(var _ in refs){return;}delete _views[cid];},remove:function remove(cellView,id){if(id===void 0)id=null;toArray$1(this.get(cellView,id)).forEach(function(view){view.remove();});},update:function update(cellView,id,dirty){if(id===void 0)id=null;if(dirty===void 0)dirty=false;toArray$1(this.get(cellView,id)).forEach(function(view){if(dirty||view.UPDATABLE){view.update();}});},transform:function transform(cellView,id){if(id===void 0)id=null;toArray$1(this.get(cellView,id)).forEach(function(view){if(view.UPDATABLE){view.transform();}});},uniqueId:function uniqueId(node,opt){if(opt===void 0)opt='';return V.ensureId(node)+JSON.stringify(opt);}});var HighlightingTypes={DEFAULT:'default',EMBEDDING:'embedding',CONNECTING:'connecting',MAGNET_AVAILABILITY:'magnetAvailability',ELEMENT_AVAILABILITY:'elementAvailability'};// CellView base view and controller.\n// --------------------------------------------\n// This is the base view and controller for `ElementView` and `LinkView`.\nvar CellView=View.extend({tagName:'g',svgElement:true,selector:'root',metrics:null,className:function(){var classNames=['cell'];var type=this.model.get('type');if(type){type.toLowerCase().split('.').forEach(function(value,index,list){classNames.push('type-'+list.slice(0,index+1).join('-'));});}return classNames.join(' ');},_presentationAttributes:null,_flags:null,setFlags:function(){var flags={};var attributes={};var shift=0;var i,n,label;var presentationAttributes=result(this,'presentationAttributes');for(var attribute in presentationAttributes){if(!presentationAttributes.hasOwnProperty(attribute)){continue;}var labels=presentationAttributes[attribute];if(!Array.isArray(labels)){labels=[labels];}for(i=0,n=labels.length;i<n;i++){label=labels[i];var flag=flags[label];if(!flag){flag=flags[label]=1<<shift++;}attributes[attribute]|=flag;}}var initFlag=result(this,'initFlag');if(!Array.isArray(initFlag)){initFlag=[initFlag];}for(i=0,n=initFlag.length;i<n;i++){label=initFlag[i];if(!flags[label]){flags[label]=1<<shift++;}}// 26 - 30 are reserved for paper flags\n// 31+ overflows maximal number\nif(shift>25){throw new Error('dia.CellView: Maximum number of flags exceeded.');}this._flags=flags;this._presentationAttributes=attributes;},hasFlag:function(flag,label){return flag&this.getFlag(label);},removeFlag:function(flag,label){return flag^flag&this.getFlag(label);},getFlag:function(label){var flags=this._flags;if(!flags){return 0;}var flag=0;if(Array.isArray(label)){for(var i=0,n=label.length;i<n;i++){flag|=flags[label[i]];}}else{flag|=flags[label];}return flag;},attributes:function(){var cell=this.model;return{'model-id':cell.id,'data-type':cell.attributes.type};},constructor:function(options){// Make sure a global unique id is assigned to this view. Store this id also to the properties object.\n// The global unique id makes sure that the same view can be rendered on e.g. different machines and\n// still be associated to the same object among all those clients. This is necessary for real-time\n// collaboration mechanism.\noptions.id=options.id||guid(this);View.call(this,options);},initialize:function(){this.setFlags();View.prototype.initialize.apply(this,arguments);this.cleanNodesCache();// Store reference to this to the <g> DOM element so that the view is accessible through the DOM tree.\nthis.$el.data('view',this);this.startListening();},onMount:function onMount(){// To be overridden\n},startListening:function(){this.listenTo(this.model,'change',this.onAttributesChange);},onAttributesChange:function(model,opt){var flag=model.getChangeFlag(this._presentationAttributes);if(opt.updateHandled||!flag){return;}if(opt.dirty&&this.hasFlag(flag,'UPDATE')){flag|=this.getFlag('RENDER');}// TODO: tool changes does not need to be sync\n// Fix Segments tools\nif(opt.tool){opt.async=false;}this.requestUpdate(flag,opt);},requestUpdate:function(flags,opt){var ref=this;var paper=ref.paper;if(paper&&flags>0){paper.requestViewUpdate(this,flags,this.UPDATE_PRIORITY,opt);}},parseDOMJSON:function(markup,root){var doc=parseDOMJSON(markup);var selectors=doc.selectors;var groups=doc.groupSelectors;for(var group in groups){if(selectors[group]){throw new Error('dia.CellView: ambiguous group selector');}selectors[group]=groups[group];}if(root){var rootSelector=this.selector;if(selectors[rootSelector]){throw new Error('dia.CellView: ambiguous root selector.');}selectors[rootSelector]=root;}return{fragment:doc.fragment,selectors:selectors};},// Return `true` if cell link is allowed to perform a certain UI `feature`.\n// Example: `can('vertexMove')`, `can('labelMove')`.\ncan:function(feature){var interactive=isFunction(this.options.interactive)?this.options.interactive(this):this.options.interactive;return isObject$1(interactive)&&interactive[feature]!==false||isBoolean(interactive)&&interactive!==false;},findBySelector:function(selector,root,selectors){root||(root=this.el);selectors||(selectors=this.selectors);// These are either descendants of `this.$el` of `this.$el` itself.\n// `.` is a special selector used to select the wrapping `<g>` element.\nif(!selector||selector==='.'){return[root];}if(selectors){var nodes=selectors[selector];if(nodes){if(Array.isArray(nodes)){return nodes;}return[nodes];}}// Maintaining backwards compatibility\n// e.g. `circle:first` would fail with querySelector() call\nif(config.useCSSSelectors){return $(root).find(selector).toArray();}return[];},notify:function(eventName){if(this.paper){var args=Array.prototype.slice.call(arguments,1);// Trigger the event on both the element itself and also on the paper.\nthis.trigger.apply(this,[eventName].concat(args));// Paper event handlers receive the view object as the first argument.\nthis.paper.trigger.apply(this.paper,[eventName,this].concat(args));}},getBBox:function(opt){var bbox;if(opt&&opt.useModelGeometry){var model=this.model;bbox=model.getBBox().bbox(model.angle());}else{bbox=this.getNodeBBox(this.el);}return this.paper.localToPaperRect(bbox);},getNodeBBox:function(magnet){var rect=this.getNodeBoundingRect(magnet);var magnetMatrix=this.getNodeMatrix(magnet);var translateMatrix=this.getRootTranslateMatrix();var rotateMatrix=this.getRootRotateMatrix();return V.transformRect(rect,translateMatrix.multiply(rotateMatrix).multiply(magnetMatrix));},getNodeUnrotatedBBox:function(magnet){var rect=this.getNodeBoundingRect(magnet);var magnetMatrix=this.getNodeMatrix(magnet);var translateMatrix=this.getRootTranslateMatrix();return V.transformRect(rect,translateMatrix.multiply(magnetMatrix));},getRootTranslateMatrix:function(){var model=this.model;var position=model.position();var mt=V.createSVGMatrix().translate(position.x,position.y);return mt;},getRootRotateMatrix:function(){var mr=V.createSVGMatrix();var model=this.model;var angle=model.angle();if(angle){var bbox=model.getBBox();var cx=bbox.width/2;var cy=bbox.height/2;mr=mr.translate(cx,cy).rotate(angle).translate(-cx,-cy);}return mr;},_notifyHighlight:function(eventName,el,opt){var assign,assign$1;if(opt===void 0)opt={};var ref=this;var rootNode=ref.el;var node;if(typeof el==='string'){assign=this.findBySelector(el),node=assign[0],node=node===void 0?rootNode:node;}else{assign$1=this.$(el),node=assign$1[0],node=node===void 0?rootNode:node;}// set partial flag if the highlighted element is not the entire view.\nopt.partial=node!==rootNode;// translate type flag into a type string\nif(opt.type===undefined){var type;switch(true){case opt.embedding:type=HighlightingTypes.EMBEDDING;break;case opt.connecting:type=HighlightingTypes.CONNECTING;break;case opt.magnetAvailability:type=HighlightingTypes.MAGNET_AVAILABILITY;break;case opt.elementAvailability:type=HighlightingTypes.ELEMENT_AVAILABILITY;break;default:type=HighlightingTypes.DEFAULT;break;}opt.type=type;}this.notify(eventName,node,opt);return this;},highlight:function(el,opt){return this._notifyHighlight('cell:highlight',el,opt);},unhighlight:function(el,opt){if(opt===void 0)opt={};return this._notifyHighlight('cell:unhighlight',el,opt);},// Find the closest element that has the `magnet` attribute set to `true`. If there was not such\n// an element found, return the root element of the cell view.\nfindMagnet:function(el){var root=this.el;var magnet=this.$(el)[0];if(!magnet){magnet=root;}do{var magnetAttribute=magnet.getAttribute('magnet');var isMagnetRoot=magnet===root;if((magnetAttribute||isMagnetRoot)&&magnetAttribute!=='false'){return magnet;}if(isMagnetRoot){// If the overall cell has set `magnet === false`, then return `undefined` to\n// announce there is no magnet found for this cell.\n// This is especially useful to set on cells that have 'ports'. In this case,\n// only the ports have set `magnet === true` and the overall element has `magnet === false`.\nreturn undefined;}magnet=magnet.parentNode;}while(magnet);return undefined;},findProxyNode:function(el,type){el||(el=this.el);var nodeSelector=el.getAttribute(type+\"-selector\");if(nodeSelector){var ref=this.findBySelector(nodeSelector);var proxyNode=ref[0];if(proxyNode){return proxyNode;}}return el;},// Construct a unique selector for the `el` element within this view.\n// `prevSelector` is being collected through the recursive call.\n// No value for `prevSelector` is expected when using this method.\ngetSelector:function(el,prevSelector){var selector;if(el===this.el){if(typeof prevSelector==='string'){selector='> '+prevSelector;}return selector;}if(el){var nthChild=V(el).index()+1;selector=el.tagName+':nth-child('+nthChild+')';if(prevSelector){selector+=' > '+prevSelector;}selector=this.getSelector(el.parentNode,selector);}return selector;},addLinkFromMagnet:function(magnet,x,y){var paper=this.paper;var graph=paper.model;var link=paper.getDefaultLink(this,magnet);link.set({source:this.getLinkEnd(magnet,x,y,link,'source'),target:{x:x,y:y}}).addTo(graph,{async:false,ui:true});return link.findView(paper);},getLinkEnd:function(magnet){var ref;var args=[],len=arguments.length-1;while(len-->0)args[len]=arguments[len+1];var model=this.model;var id=model.id;var port=this.findAttribute('port',magnet);// Find a unique `selector` of the element under pointer that is a magnet.\nvar selector=magnet.getAttribute('joint-selector');var end={id:id};if(selector!=null){end.magnet=selector;}if(port!=null){end.port=port;if(!model.hasPort(port)&&!selector){// port created via the `port` attribute (not API)\nend.selector=this.getSelector(magnet);}}else if(selector==null&&this.el!==magnet){end.selector=this.getSelector(magnet);}return(ref=this).customizeLinkEnd.apply(ref,[end,magnet].concat(args));},customizeLinkEnd:function(end,magnet,x,y,link,endType){var ref=this;var paper=ref.paper;var ref$1=paper.options;var connectionStrategy=ref$1.connectionStrategy;if(typeof connectionStrategy==='function'){var strategy=connectionStrategy.call(paper,end,this,magnet,new Point(x,y),link,endType,paper);if(strategy){return strategy;}}return end;},getMagnetFromLinkEnd:function(end){var root=this.el;var port=end.port;var selector=end.magnet;var model=this.model;var magnet;if(port!=null&&model.isElement()&&model.hasPort(port)){magnet=this.findPortNode(port,selector)||root;}else{if(!selector){selector=end.selector;}if(!selector&&port!=null){// link end has only `id` and `port` property referencing\n// a port created via the `port` attribute (not API).\nselector='[port=\"'+port+'\"]';}magnet=this.findBySelector(selector,root,this.selectors)[0];}return this.findProxyNode(magnet,'magnet');},dragLinkStart:function(evt,magnet,x,y){this.model.startBatch('add-link');var linkView=this.addLinkFromMagnet(magnet,x,y);// backwards compatibility events\nlinkView.notifyPointerdown(evt,x,y);linkView.eventData(evt,linkView.startArrowheadMove('target',{whenNotAllowed:'remove'}));this.eventData(evt,{linkView:linkView});},dragLink:function(evt,x,y){var data=this.eventData(evt);var linkView=data.linkView;if(linkView){linkView.pointermove(evt,x,y);}else{var paper=this.paper;var magnetThreshold=paper.options.magnetThreshold;var currentTarget=this.getEventTarget(evt);var targetMagnet=data.targetMagnet;if(magnetThreshold==='onleave'){// magnetThreshold when the pointer leaves the magnet\nif(targetMagnet===currentTarget||V(targetMagnet).contains(currentTarget)){return;}}else{// magnetThreshold defined as a number of movements\nif(paper.eventData(evt).mousemoved<=magnetThreshold){return;}}this.dragLinkStart(evt,targetMagnet,x,y);}},dragLinkEnd:function(evt,x,y){var data=this.eventData(evt);var linkView=data.linkView;if(!linkView){return;}linkView.pointerup(evt,x,y);this.model.stopBatch('add-link');},getAttributeDefinition:function(attrName){return this.model.constructor.getAttributeDefinition(attrName);},setNodeAttributes:function(node,attrs){if(!isEmpty(attrs)){if(node instanceof SVGElement){V(node).attr(attrs);}else{$(node).attr(attrs);}}},processNodeAttributes:function(node,attrs){var attrName,attrVal,def,i,n;var normalAttrs,setAttrs,positionAttrs,offsetAttrs;var relatives=[];// divide the attributes between normal and special\nfor(attrName in attrs){if(!attrs.hasOwnProperty(attrName)){continue;}attrVal=attrs[attrName];def=this.getAttributeDefinition(attrName);if(def&&(!isFunction(def.qualify)||def.qualify.call(this,attrVal,node,attrs))){if(isString(def.set)){normalAttrs||(normalAttrs={});normalAttrs[def.set]=attrVal;}if(attrVal!==null){relatives.push(attrName,def);}}else{normalAttrs||(normalAttrs={});normalAttrs[toKebabCase(attrName)]=attrVal;}}// handle the rest of attributes via related method\n// from the special attributes namespace.\nfor(i=0,n=relatives.length;i<n;i+=2){attrName=relatives[i];def=relatives[i+1];attrVal=attrs[attrName];if(isFunction(def.set)){setAttrs||(setAttrs={});setAttrs[attrName]=attrVal;}if(isFunction(def.position)){positionAttrs||(positionAttrs={});positionAttrs[attrName]=attrVal;}if(isFunction(def.offset)){offsetAttrs||(offsetAttrs={});offsetAttrs[attrName]=attrVal;}}return{raw:attrs,normal:normalAttrs,set:setAttrs,position:positionAttrs,offset:offsetAttrs};},updateRelativeAttributes:function(node,attrs,refBBox,opt){opt||(opt={});var attrName,attrVal,def;var rawAttrs=attrs.raw||{};var nodeAttrs=attrs.normal||{};var setAttrs=attrs.set;var positionAttrs=attrs.position;var offsetAttrs=attrs.offset;for(attrName in setAttrs){attrVal=setAttrs[attrName];def=this.getAttributeDefinition(attrName);// SET - set function should return attributes to be set on the node,\n// which will affect the node dimensions based on the reference bounding\n// box. e.g. `width`, `height`, `d`, `rx`, `ry`, `points\nvar setResult=def.set.call(this,attrVal,refBBox.clone(),node,rawAttrs);if(isObject$1(setResult)){assign(nodeAttrs,setResult);}else if(setResult!==undefined){nodeAttrs[attrName]=setResult;}}if(node instanceof HTMLElement){// TODO: setting the `transform` attribute on HTMLElements\n// via `node.style.transform = 'matrix(...)';` would introduce\n// a breaking change (e.g. basic.TextBlock).\nthis.setNodeAttributes(node,nodeAttrs);return;}// The final translation of the subelement.\nvar nodeTransform=nodeAttrs.transform;var nodeMatrix=V.transformStringToMatrix(nodeTransform);var nodePosition=Point(nodeMatrix.e,nodeMatrix.f);if(nodeTransform){nodeAttrs=omit(nodeAttrs,'transform');nodeMatrix.e=nodeMatrix.f=0;}// Calculate node scale determined by the scalable group\n// only if later needed.\nvar sx,sy,translation;if(positionAttrs||offsetAttrs){var nodeScale=this.getNodeScale(node,opt.scalableNode);sx=nodeScale.sx;sy=nodeScale.sy;}var positioned=false;for(attrName in positionAttrs){attrVal=positionAttrs[attrName];def=this.getAttributeDefinition(attrName);// POSITION - position function should return a point from the\n// reference bounding box. The default position of the node is x:0, y:0 of\n// the reference bounding box or could be further specify by some\n// SVG attributes e.g. `x`, `y`\ntranslation=def.position.call(this,attrVal,refBBox.clone(),node,rawAttrs);if(translation){nodePosition.offset(Point(translation).scale(sx,sy));positioned||(positioned=true);}}// The node bounding box could depend on the `size` set from the previous loop.\n// Here we know, that all the size attributes have been already set.\nthis.setNodeAttributes(node,nodeAttrs);var offseted=false;if(offsetAttrs){// Check if the node is visible\nvar nodeBoundingRect=this.getNodeBoundingRect(node);if(nodeBoundingRect.width>0&&nodeBoundingRect.height>0){var nodeBBox=V.transformRect(nodeBoundingRect,nodeMatrix).scale(1/sx,1/sy);for(attrName in offsetAttrs){attrVal=offsetAttrs[attrName];def=this.getAttributeDefinition(attrName);// OFFSET - offset function should return a point from the element\n// bounding box. The default offset point is x:0, y:0 (origin) or could be further\n// specify with some SVG attributes e.g. `text-anchor`, `cx`, `cy`\ntranslation=def.offset.call(this,attrVal,nodeBBox,node,rawAttrs);if(translation){nodePosition.offset(Point(translation).scale(sx,sy));offseted||(offseted=true);}}}}// Do not touch node's transform attribute if there is no transformation applied.\nif(nodeTransform!==undefined||positioned||offseted){// Round the coordinates to 1 decimal point.\nnodePosition.round(1);nodeMatrix.e=nodePosition.x;nodeMatrix.f=nodePosition.y;node.setAttribute('transform',V.matrixToTransformString(nodeMatrix));// TODO: store nodeMatrix metrics?\n}},getNodeScale:function(node,scalableNode){// Check if the node is a descendant of the scalable group.\nvar sx,sy;if(scalableNode&&scalableNode.contains(node)){var scale=scalableNode.scale();sx=1/scale.sx;sy=1/scale.sy;}else{sx=1;sy=1;}return{sx:sx,sy:sy};},cleanNodesCache:function(){this.metrics={};},nodeCache:function(magnet){var metrics=this.metrics;// Don't use cache? It most likely a custom view with overridden update.\nif(!metrics){return{};}var id=V.ensureId(magnet);var value=metrics[id];if(!value){value=metrics[id]={};}return value;},getNodeData:function(magnet){var metrics=this.nodeCache(magnet);if(!metrics.data){metrics.data={};}return metrics.data;},getNodeBoundingRect:function(magnet){var metrics=this.nodeCache(magnet);if(metrics.boundingRect===undefined){metrics.boundingRect=V(magnet).getBBox();}return new Rect(metrics.boundingRect);},getNodeMatrix:function(magnet){var metrics=this.nodeCache(magnet);if(metrics.magnetMatrix===undefined){var target=this.rotatableNode||this.el;metrics.magnetMatrix=V(magnet).getTransformToElement(target);}return V.createSVGMatrix(metrics.magnetMatrix);},getNodeShape:function(magnet){var metrics=this.nodeCache(magnet);if(metrics.geometryShape===undefined){metrics.geometryShape=V(magnet).toGeometryShape();}return metrics.geometryShape.clone();},isNodeConnection:function(node){return this.model.isLink()&&(!node||node===this.el);},findNodesAttributes:function(attrs,root,selectorCache,selectors){var i,n,nodeAttrs,nodeId;var nodesAttrs={};var mergeIds=[];for(var selector in attrs){if(!attrs.hasOwnProperty(selector)){continue;}nodeAttrs=attrs[selector];if(!isPlainObject(nodeAttrs)){continue;}// Not a valid selector-attributes pair\nvar selected=selectorCache[selector]=this.findBySelector(selector,root,selectors);for(i=0,n=selected.length;i<n;i++){var node=selected[i];nodeId=V.ensureId(node);// \"unique\" selectors are selectors that referencing a single node (defined by `selector`)\n// groupSelector referencing a single node is not \"unique\"\nvar unique=selectors&&selectors[selector]===node;var prevNodeAttrs=nodesAttrs[nodeId];if(prevNodeAttrs){// Note, that nodes referenced by deprecated `CSS selectors` are not taken into account.\n// e.g. css:`.circle` and selector:`circle` can be applied in a random order\nif(!prevNodeAttrs.array){mergeIds.push(nodeId);prevNodeAttrs.array=true;prevNodeAttrs.attributes=[prevNodeAttrs.attributes];prevNodeAttrs.selectedLength=[prevNodeAttrs.selectedLength];}var attributes=prevNodeAttrs.attributes;var selectedLength=prevNodeAttrs.selectedLength;if(unique){// node referenced by `selector`\nattributes.unshift(nodeAttrs);selectedLength.unshift(-1);}else{// node referenced by `groupSelector`\nvar sortIndex=sortedIndex(selectedLength,n);attributes.splice(sortIndex,0,nodeAttrs);selectedLength.splice(sortIndex,0,n);}}else{nodesAttrs[nodeId]={attributes:nodeAttrs,selectedLength:unique?-1:n,node:node,array:false};}}}for(i=0,n=mergeIds.length;i<n;i++){nodeId=mergeIds[i];nodeAttrs=nodesAttrs[nodeId];nodeAttrs.attributes=merge.apply(void 0,[{}].concat(nodeAttrs.attributes.reverse()));}return nodesAttrs;},getEventTarget:function(evt,opt){if(opt===void 0)opt={};// Touchmove/Touchend event's target is not reflecting the element under the coordinates as mousemove does.\n// It holds the element when a touchstart triggered.\nvar target=evt.target;var type=evt.type;var clientX=evt.clientX;if(clientX===void 0)clientX=0;var clientY=evt.clientY;if(clientY===void 0)clientY=0;if(opt.fromPoint||type==='touchmove'||type==='touchend'){return document.elementFromPoint(clientX,clientY);}return target;},// Default is to process the `model.attributes.attrs` object and set attributes on subelements based on the selectors,\n// unless `attrs` parameter was passed.\nupdateDOMSubtreeAttributes:function(rootNode,attrs,opt){opt||(opt={});opt.rootBBox||(opt.rootBBox=Rect());opt.selectors||(opt.selectors=this.selectors);// selector collection to use\n// Cache table for query results and bounding box calculation.\n// Note that `selectorCache` needs to be invalidated for all\n// `updateAttributes` calls, as the selectors might pointing\n// to nodes designated by an attribute or elements dynamically\n// created.\nvar selectorCache={};var bboxCache={};var relativeItems=[];var relativeRefItems=[];var item,node,nodeAttrs,nodeData,processedAttrs;var roAttrs=opt.roAttributes;var nodesAttrs=this.findNodesAttributes(roAttrs||attrs,rootNode,selectorCache,opt.selectors);// `nodesAttrs` are different from all attributes, when\n// rendering only  attributes sent to this method.\nvar nodesAllAttrs=roAttrs?this.findNodesAttributes(attrs,rootNode,selectorCache,opt.selectors):nodesAttrs;for(var nodeId in nodesAttrs){nodeData=nodesAttrs[nodeId];nodeAttrs=nodeData.attributes;node=nodeData.node;processedAttrs=this.processNodeAttributes(node,nodeAttrs);if(!processedAttrs.set&&!processedAttrs.position&&!processedAttrs.offset){// Set all the normal attributes right on the SVG/HTML element.\nthis.setNodeAttributes(node,processedAttrs.normal);}else{var nodeAllAttrs=nodesAllAttrs[nodeId]&&nodesAllAttrs[nodeId].attributes;var refSelector=nodeAllAttrs&&nodeAttrs.ref===undefined?nodeAllAttrs.ref:nodeAttrs.ref;var refNode;if(refSelector){refNode=(selectorCache[refSelector]||this.findBySelector(refSelector,rootNode,opt.selectors))[0];if(!refNode){throw new Error('dia.CellView: \"'+refSelector+'\" reference does not exist.');}}else{refNode=null;}item={node:node,refNode:refNode,processedAttributes:processedAttrs,allAttributes:nodeAllAttrs};if(refNode){// If an element in the list is positioned relative to this one, then\n// we want to insert this one before it in the list.\nvar itemIndex=relativeRefItems.findIndex(function(item){return item.refNode===node;});if(itemIndex>-1){relativeRefItems.splice(itemIndex,0,item);}else{relativeRefItems.push(item);}}else{// A node with no ref attribute. To be updated before the nodes referencing other nodes.\n// The order of no-ref-items is not specified/important.\nrelativeItems.push(item);}}}relativeItems.push.apply(relativeItems,relativeRefItems);var rotatableMatrix;for(var i=0,n=relativeItems.length;i<n;i++){item=relativeItems[i];node=item.node;refNode=item.refNode;// Find the reference element bounding box. If no reference was provided, we\n// use the optional bounding box.\nvar vRotatable=V(opt.rotatableNode);var refNodeId=refNode?V.ensureId(refNode):'';var isRefNodeRotatable=!!vRotatable&&!!refNode&&vRotatable.contains(refNode);var unrotatedRefBBox=bboxCache[refNodeId];if(!unrotatedRefBBox){// Get the bounding box of the reference element relative to the `rotatable` `<g>` (without rotation)\n// or to the root `<g>` element if no rotatable group present if reference node present.\n// Uses the bounding box provided.\nvar transformationTarget=isRefNodeRotatable?vRotatable:rootNode;unrotatedRefBBox=bboxCache[refNodeId]=refNode?V(refNode).getBBox({target:transformationTarget}):opt.rootBBox;}if(roAttrs){// if there was a special attribute affecting the position amongst passed-in attributes\n// we have to merge it with the rest of the element's attributes as they are necessary\n// to update the position relatively (i.e `ref-x` && 'ref-dx')\nprocessedAttrs=this.processNodeAttributes(node,item.allAttributes);this.mergeProcessedAttributes(processedAttrs,item.processedAttributes);}else{processedAttrs=item.processedAttributes;}var refBBox=unrotatedRefBBox;if(isRefNodeRotatable&&!vRotatable.contains(node)){// if the referenced node is inside the rotatable group while the updated node is outside,\n// we need to take the rotatable node transformation into account\nif(!rotatableMatrix){rotatableMatrix=V.transformStringToMatrix(vRotatable.attr('transform'));}refBBox=V.transformRect(unrotatedRefBBox,rotatableMatrix);}this.updateRelativeAttributes(node,processedAttrs,refBBox,opt);}},mergeProcessedAttributes:function(processedAttrs,roProcessedAttrs){processedAttrs.set||(processedAttrs.set={});processedAttrs.position||(processedAttrs.position={});processedAttrs.offset||(processedAttrs.offset={});assign(processedAttrs.set,roProcessedAttrs.set);assign(processedAttrs.position,roProcessedAttrs.position);assign(processedAttrs.offset,roProcessedAttrs.offset);// Handle also the special transform property.\nvar transform=processedAttrs.normal&&processedAttrs.normal.transform;if(transform!==undefined&&roProcessedAttrs.normal){roProcessedAttrs.normal.transform=transform;}processedAttrs.normal=roProcessedAttrs.normal;},onRemove:function(){this.removeTools();this.removeHighlighters();},_toolsView:null,hasTools:function(name){var toolsView=this._toolsView;if(!toolsView){return false;}if(!name){return true;}return toolsView.getName()===name;},addTools:function(toolsView){this.removeTools();if(toolsView){this._toolsView=toolsView;toolsView.configure({relatedView:this});toolsView.listenTo(this.paper,'tools:event',this.onToolEvent.bind(this));}return this;},updateTools:function(opt){var toolsView=this._toolsView;if(toolsView){toolsView.update(opt);}return this;},removeTools:function(){var toolsView=this._toolsView;if(toolsView){toolsView.remove();this._toolsView=null;}return this;},hideTools:function(){var toolsView=this._toolsView;if(toolsView){toolsView.hide();}return this;},showTools:function(){var toolsView=this._toolsView;if(toolsView){toolsView.show();}return this;},onToolEvent:function(event){switch(event){case'remove':this.removeTools();break;case'hide':this.hideTools();break;case'show':this.showTools();break;}},removeHighlighters:function(){HighlighterView.remove(this);},updateHighlighters:function(dirty){if(dirty===void 0)dirty=false;HighlighterView.update(this,null,dirty);},transformHighlighters:function(){HighlighterView.transform(this);},// Interaction. The controller part.\n// ---------------------------------\n// Interaction is handled by the paper and delegated to the view in interest.\n// `x` & `y` parameters passed to these functions represent the coordinates already snapped to the paper grid.\n// If necessary, real coordinates can be obtained from the `evt` event object.\n// These functions are supposed to be overriden by the views that inherit from `joint.dia.Cell`,\n// i.e. `joint.dia.Element` and `joint.dia.Link`.\npointerdblclick:function(evt,x,y){this.notify('cell:pointerdblclick',evt,x,y);},pointerclick:function(evt,x,y){this.notify('cell:pointerclick',evt,x,y);},contextmenu:function(evt,x,y){this.notify('cell:contextmenu',evt,x,y);},pointerdown:function(evt,x,y){var ref=this;var model=ref.model;var graph=model.graph;if(graph){model.startBatch('pointer');this.eventData(evt,{graph:graph});}this.notify('cell:pointerdown',evt,x,y);},pointermove:function(evt,x,y){this.notify('cell:pointermove',evt,x,y);},pointerup:function(evt,x,y){var ref=this.eventData(evt);var graph=ref.graph;this.notify('cell:pointerup',evt,x,y);if(graph){// we don't want to trigger event on model as model doesn't\n// need to be member of collection anymore (remove)\ngraph.stopBatch('pointer',{cell:this.model});}},mouseover:function(evt){this.notify('cell:mouseover',evt);},mouseout:function(evt){this.notify('cell:mouseout',evt);},mouseenter:function(evt){this.notify('cell:mouseenter',evt);},mouseleave:function(evt){this.notify('cell:mouseleave',evt);},mousewheel:function(evt,x,y,delta){this.notify('cell:mousewheel',evt,x,y,delta);},onevent:function(evt,eventName,x,y){this.notify(eventName,evt,x,y);},onmagnet:function(){// noop\n},magnetpointerdblclick:function(){// noop\n},magnetcontextmenu:function(){// noop\n},checkMouseleave:function checkMouseleave(evt){var ref=this;var paper=ref.paper;if(paper.isAsync()){// Do the updates of the current view synchronously now\npaper.dumpView(this);}var target=this.getEventTarget(evt,{fromPoint:true});var view=paper.findView(target);if(view===this){return;}// Leaving the current view\nthis.mouseleave(evt);if(!view){return;}// Entering another view\nview.mouseenter(evt);},setInteractivity:function(value){this.options.interactive=value;}},{Highlighting:HighlightingTypes,addPresentationAttributes:function(presentationAttributes){return merge({},result(this.prototype,'presentationAttributes'),presentationAttributes,function(a,b){if(!a||!b){return;}if(typeof a==='string'){a=[a];}if(typeof b==='string'){b=[b];}if(Array.isArray(a)&&Array.isArray(b)){return uniq(a.concat(b));}});}});var Flags={UPDATE:'UPDATE',TRANSLATE:'TRANSLATE',TOOLS:'TOOLS',RESIZE:'RESIZE',PORTS:'PORTS',ROTATE:'ROTATE',RENDER:'RENDER'};// Element base view and controller.\n// -------------------------------------------\nvar ElementView=CellView.extend({/**\n\t     * @abstract\n\t     */_removePorts:function(){// implemented in ports.js\n},/**\n\t     *\n\t     * @abstract\n\t     */_renderPorts:function(){// implemented in ports.js\n},className:function(){var classNames=CellView.prototype.className.apply(this).split(' ');classNames.push('element');return classNames.join(' ');},initialize:function(){CellView.prototype.initialize.apply(this,arguments);this._initializePorts();},presentationAttributes:{'attrs':[Flags.UPDATE],'position':[Flags.TRANSLATE,Flags.TOOLS],'size':[Flags.RESIZE,Flags.PORTS,Flags.TOOLS],'angle':[Flags.ROTATE,Flags.TOOLS],'markup':[Flags.RENDER],'ports':[Flags.PORTS]},initFlag:[Flags.RENDER],UPDATE_PRIORITY:0,confirmUpdate:function(flag,opt){var useCSSSelectors=config.useCSSSelectors;if(this.hasFlag(flag,Flags.PORTS)){this._removePorts();this._cleanPortsCache();}var transformHighlighters=false;if(this.hasFlag(flag,Flags.RENDER)){this.render();this.updateTools(opt);this.updateHighlighters(true);transformHighlighters=true;flag=this.removeFlag(flag,[Flags.RENDER,Flags.UPDATE,Flags.RESIZE,Flags.TRANSLATE,Flags.ROTATE,Flags.PORTS,Flags.TOOLS]);}else{var updateHighlighters=false;// Skip this branch if render is required\nif(this.hasFlag(flag,Flags.RESIZE)){this.resize(opt);updateHighlighters=true;// Resize method is calling `update()` internally\nflag=this.removeFlag(flag,[Flags.RESIZE,Flags.UPDATE]);}if(this.hasFlag(flag,Flags.UPDATE)){this.update(this.model,null,opt);flag=this.removeFlag(flag,Flags.UPDATE);updateHighlighters=true;if(useCSSSelectors){// `update()` will render ports when useCSSSelectors are enabled\nflag=this.removeFlag(flag,Flags.PORTS);}}if(this.hasFlag(flag,Flags.TRANSLATE)){this.translate();flag=this.removeFlag(flag,Flags.TRANSLATE);transformHighlighters=true;}if(this.hasFlag(flag,Flags.ROTATE)){this.rotate();flag=this.removeFlag(flag,Flags.ROTATE);transformHighlighters=true;}if(this.hasFlag(flag,Flags.PORTS)){this._renderPorts();updateHighlighters=true;flag=this.removeFlag(flag,Flags.PORTS);}if(updateHighlighters){this.updateHighlighters(false);}}if(transformHighlighters){this.transformHighlighters();}if(this.hasFlag(flag,Flags.TOOLS)){this.updateTools(opt);flag=this.removeFlag(flag,Flags.TOOLS);}return flag;},/**\n\t     * @abstract\n\t     */_initializePorts:function(){},update:function(_,renderingOnlyAttrs){this.cleanNodesCache();// When CSS selector strings are used, make sure no rule matches port nodes.\nvar useCSSSelectors=config.useCSSSelectors;if(useCSSSelectors){this._removePorts();}var model=this.model;var modelAttrs=model.attr();this.updateDOMSubtreeAttributes(this.el,modelAttrs,{rootBBox:new Rect(model.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,// Use rendering only attributes if they differs from the model attributes\nroAttributes:renderingOnlyAttrs===modelAttrs?null:renderingOnlyAttrs});if(useCSSSelectors){this._renderPorts();}},rotatableSelector:'rotatable',scalableSelector:'scalable',scalableNode:null,rotatableNode:null,// `prototype.markup` is rendered by default. Set the `markup` attribute on the model if the\n// default markup is not desirable.\nrenderMarkup:function(){var element=this.model;var markup=element.get('markup')||element.markup;if(!markup){throw new Error('dia.ElementView: markup required');}if(Array.isArray(markup)){return this.renderJSONMarkup(markup);}if(typeof markup==='string'){return this.renderStringMarkup(markup);}throw new Error('dia.ElementView: invalid markup');},renderJSONMarkup:function(markup){var doc=this.parseDOMJSON(markup,this.el);var selectors=this.selectors=doc.selectors;this.rotatableNode=V(selectors[this.rotatableSelector])||null;this.scalableNode=V(selectors[this.scalableSelector])||null;// Fragment\nthis.vel.append(doc.fragment);},renderStringMarkup:function(markup){var vel=this.vel;vel.append(V(markup));// Cache transformation groups\nthis.rotatableNode=vel.findOne('.rotatable');this.scalableNode=vel.findOne('.scalable');var selectors=this.selectors={};selectors[this.selector]=this.el;},render:function(){this.vel.empty();this.renderMarkup();if(this.scalableNode){// Double update is necessary for elements with the scalable group only\n// Note the resize() triggers the other `update`.\nthis.update();}this.resize();if(this.rotatableNode){// Translate transformation is applied on `this.el` while the rotation transformation\n// on `this.rotatableNode`\nthis.rotate();this.translate();}else{this.updateTransformation();}if(!config.useCSSSelectors){this._renderPorts();}return this;},resize:function(opt){if(this.scalableNode){return this.sgResize(opt);}if(this.model.attributes.angle){this.rotate();}this.update();},translate:function(){if(this.rotatableNode){return this.rgTranslate();}this.updateTransformation();},rotate:function(){if(this.rotatableNode){this.rgRotate();// It's necessary to call the update for the nodes outside\n// the rotatable group referencing nodes inside the group\nthis.update();return;}this.updateTransformation();},updateTransformation:function(){var transformation=this.getTranslateString();var rotateString=this.getRotateString();if(rotateString){transformation+=' '+rotateString;}this.vel.attr('transform',transformation);},getTranslateString:function(){var position=this.model.attributes.position;return'translate('+position.x+','+position.y+')';},getRotateString:function(){var attributes=this.model.attributes;var angle=attributes.angle;if(!angle){return null;}var size=attributes.size;return'rotate('+angle+','+size.width/2+','+size.height/2+')';},// Rotatable & Scalable Group\n// always slower, kept mainly for backwards compatibility\nrgRotate:function(){this.rotatableNode.attr('transform',this.getRotateString());},rgTranslate:function(){this.vel.attr('transform',this.getTranslateString());},sgResize:function(opt){var model=this.model;var angle=model.angle();var size=model.size();var scalable=this.scalableNode;// Getting scalable group's bbox.\n// Due to a bug in webkit's native SVG .getBBox implementation, the bbox of groups with path children includes the paths' control points.\n// To work around the issue, we need to check whether there are any path elements inside the scalable group.\nvar recursive=false;if(scalable.node.getElementsByTagName('path').length>0){// If scalable has at least one descendant that is a path, we need to switch to recursive bbox calculation.\n// If there are no path descendants, group bbox calculation works and so we can use the (faster) native function directly.\nrecursive=true;}var scalableBBox=scalable.getBBox({recursive:recursive});// Make sure `scalableBbox.width` and `scalableBbox.height` are not zero which can happen if the element does not have any content. By making\n// the width/height 1, we prevent HTML errors of the type `scale(Infinity, Infinity)`.\nvar sx=size.width/(scalableBBox.width||1);var sy=size.height/(scalableBBox.height||1);scalable.attr('transform','scale('+sx+','+sy+')');// Now the interesting part. The goal is to be able to store the object geometry via just `x`, `y`, `angle`, `width` and `height`\n// Order of transformations is significant but we want to reconstruct the object always in the order:\n// resize(), rotate(), translate() no matter of how the object was transformed. For that to work,\n// we must adjust the `x` and `y` coordinates of the object whenever we resize it (because the origin of the\n// rotation changes). The new `x` and `y` coordinates are computed by canceling the previous rotation\n// around the center of the resized object (which is a different origin then the origin of the previous rotation)\n// and getting the top-left corner of the resulting object. Then we clean up the rotation back to what it originally was.\n// Cancel the rotation but now around a different origin, which is the center of the scaled object.\nvar rotatable=this.rotatableNode;var rotation=rotatable&&rotatable.attr('transform');if(rotation){rotatable.attr('transform',rotation+' rotate('+-angle+','+size.width/2+','+size.height/2+')');var rotatableBBox=scalable.getBBox({target:this.paper.cells});// Store new x, y and perform rotate() again against the new rotation origin.\nmodel.set('position',{x:rotatableBBox.x,y:rotatableBBox.y},assign({updateHandled:true},opt));this.translate();this.rotate();}// Update must always be called on non-rotated element. Otherwise, relative positioning\n// would work with wrong (rotated) bounding boxes.\nthis.update();},// Embedding mode methods.\n// -----------------------\nprepareEmbedding:function(data){if(data===void 0)data={};var element=data.model||this.model;var paper=data.paper||this.paper;var graph=paper.model;var initialZIndices=data.initialZIndices={};var embeddedCells=element.getEmbeddedCells({deep:true});var connectedLinks=graph.getConnectedLinks(element,{deep:true,includeEnclosed:true});// Note: an embedded cell can be a connect link, but it's fine\n// to iterate over the cell twice.\n[element].concat(embeddedCells,connectedLinks).forEach(function(cell){return initialZIndices[cell.id]=cell.attributes.z;});element.startBatch('to-front');// Bring the model to the front with all his embeds.\nelement.toFront({deep:true,ui:true});// Note that at this point cells in the collection are not sorted by z index (it's running in the batch, see\n// the dia.Graph._sortOnChangeZ), so we can't assume that the last cell in the collection has the highest z.\nvar maxZ=graph.getElements().reduce(function(max,cell){return Math.max(max,cell.attributes.z||0);},0);// Move to front also all the inbound and outbound links that are connected\n// to any of the element descendant. If we bring to front only embedded elements,\n// links connected to them would stay in the background.\nconnectedLinks.forEach(function(link){if(link.attributes.z<=maxZ){link.set('z',maxZ+1,{ui:true});}});element.stopBatch('to-front');// Before we start looking for suitable parent we remove the current one.\nvar parentId=element.parent();if(parentId){var parent=graph.getCell(parentId);parent.unembed(element,{ui:true});data.initialParentId=parentId;}else{data.initialParentId=null;}},processEmbedding:function(data,evt,x,y){if(data===void 0)data={};var model=data.model||this.model;var paper=data.paper||this.paper;var graph=paper.model;var ref=paper.options;var findParentBy=ref.findParentBy;var frontParentOnly=ref.frontParentOnly;var validateEmbedding=ref.validateEmbedding;var candidates;if(isFunction(findParentBy)){candidates=toArray(findParentBy.call(graph,this,evt,x,y));}else if(findParentBy==='pointer'){candidates=toArray(graph.findModelsFromPoint({x:x,y:y}));}else{candidates=graph.findModelsUnderElement(model,{searchBy:findParentBy});}candidates=candidates.filter(function(el){return el instanceof Cell&&model.id!==el.id&&!el.isEmbeddedIn(model);});if(frontParentOnly){// pick the element with the highest `z` index\ncandidates=candidates.slice(-1);}var newCandidateView=null;var prevCandidateView=data.candidateEmbedView;// iterate over all candidates starting from the last one (has the highest z-index).\nfor(var i=candidates.length-1;i>=0;i--){var candidate=candidates[i];if(prevCandidateView&&prevCandidateView.model.id==candidate.id){// candidate remains the same\nnewCandidateView=prevCandidateView;break;}else{var view=candidate.findView(paper);if(!isFunction(validateEmbedding)||validateEmbedding.call(paper,this,view)){// flip to the new candidate\nnewCandidateView=view;break;}}}if(newCandidateView&&newCandidateView!=prevCandidateView){// A new candidate view found. Highlight the new one.\nthis.clearEmbedding(data);data.candidateEmbedView=newCandidateView.highlight(newCandidateView.findProxyNode(null,'container'),{embedding:true});}if(!newCandidateView&&prevCandidateView){// No candidate view found. Unhighlight the previous candidate.\nthis.clearEmbedding(data);}},clearEmbedding:function(data){data||(data={});var candidateView=data.candidateEmbedView;if(candidateView){// No candidate view found. Unhighlight the previous candidate.\ncandidateView.unhighlight(candidateView.findProxyNode(null,'container'),{embedding:true});data.candidateEmbedView=null;}},finalizeEmbedding:function(data){if(data===void 0)data={};var candidateView=data.candidateEmbedView;var element=data.model||this.model;var paper=data.paper||this.paper;if(candidateView){// We finished embedding. Candidate view is chosen to become the parent of the model.\ncandidateView.model.embed(element,{ui:true});candidateView.unhighlight(candidateView.findProxyNode(null,'container'),{embedding:true});data.candidateEmbedView=null;}else{var ref=paper.options;var validateUnembedding=ref.validateUnembedding;var initialParentId=data.initialParentId;// The element was originally embedded into another element.\n// The interaction would unembed the element. Let's validate\n// if the element can be unembedded.\nif(initialParentId&&typeof validateUnembedding==='function'&&!validateUnembedding.call(paper,this)){this._disallowUnembed(data);return;}}paper.model.getConnectedLinks(element,{deep:true}).forEach(function(link){link.reparent({ui:true});});},_disallowUnembed:function(data){var model=data.model;var whenNotAllowed=data.whenNotAllowed;if(whenNotAllowed===void 0)whenNotAllowed='revert';var element=model||this.model;var paper=data.paper||this.paper;var graph=paper.model;switch(whenNotAllowed){case'remove':{element.remove({ui:true});break;}case'revert':{var initialParentId=data.initialParentId;var initialPosition=data.initialPosition;var initialZIndices=data.initialZIndices;// Revert the element's position (and the position of its embedded cells if any)\nif(initialPosition){var x=initialPosition.x;var y=initialPosition.y;element.position(x,y,{deep:true,ui:true});}// Revert all the z-indices changed during the embedding\nif(initialZIndices){Object.keys(initialZIndices).forEach(function(id){var cell=graph.getCell(id);if(cell){cell.set('z',initialZIndices[id],{ui:true});}});}// Revert the original parent\nvar parent=graph.getCell(initialParentId);if(parent){parent.embed(element,{ui:true});}break;}}},getDelegatedView:function(){var view=this;var model=view.model;var paper=view.paper;while(view){if(model.isLink()){break;}if(!model.isEmbedded()||view.can('stopDelegation')){return view;}model=model.getParentCell();view=paper.findViewByModel(model);}return null;},findProxyNode:function(el,type){el||(el=this.el);var nodeSelector=el.getAttribute(type+\"-selector\");if(nodeSelector){var port=this.findAttribute('port',el);if(port){var proxyPortNode=this.findPortNode(port,nodeSelector);if(proxyPortNode){return proxyPortNode;}}else{var ref=this.findBySelector(nodeSelector);var proxyNode=ref[0];if(proxyNode){return proxyNode;}}}return el;},// Interaction. The controller part.\n// ---------------------------------\nnotifyPointerdown:function notifyPointerdown(evt,x,y){CellView.prototype.pointerdown.call(this,evt,x,y);this.notify('element:pointerdown',evt,x,y);},notifyPointermove:function notifyPointermove(evt,x,y){CellView.prototype.pointermove.call(this,evt,x,y);this.notify('element:pointermove',evt,x,y);},notifyPointerup:function notifyPointerup(evt,x,y){this.notify('element:pointerup',evt,x,y);CellView.prototype.pointerup.call(this,evt,x,y);},pointerdblclick:function(evt,x,y){CellView.prototype.pointerdblclick.apply(this,arguments);this.notify('element:pointerdblclick',evt,x,y);},pointerclick:function(evt,x,y){CellView.prototype.pointerclick.apply(this,arguments);this.notify('element:pointerclick',evt,x,y);},contextmenu:function(evt,x,y){CellView.prototype.contextmenu.apply(this,arguments);this.notify('element:contextmenu',evt,x,y);},pointerdown:function(evt,x,y){if(this.isPropagationStopped(evt)){return;}this.notifyPointerdown(evt,x,y);this.dragStart(evt,x,y);},pointermove:function(evt,x,y){var data=this.eventData(evt);switch(data.action){case'magnet':this.dragMagnet(evt,x,y);break;case'move':(data.delegatedView||this).drag(evt,x,y);// eslint: no-fallthrough=false\ndefault:this.notifyPointermove(evt,x,y);break;}// Make sure the element view data is passed along.\n// It could have been wiped out in the handlers above.\nthis.eventData(evt,data);},pointerup:function(evt,x,y){var data=this.eventData(evt);switch(data.action){case'magnet':this.dragMagnetEnd(evt,x,y);break;case'move':(data.delegatedView||this).dragEnd(evt,x,y);// eslint: no-fallthrough=false\ndefault:this.notifyPointerup(evt,x,y);}var magnet=data.targetMagnet;if(magnet){this.magnetpointerclick(evt,magnet,x,y);}this.checkMouseleave(evt);},mouseover:function(evt){CellView.prototype.mouseover.apply(this,arguments);this.notify('element:mouseover',evt);},mouseout:function(evt){CellView.prototype.mouseout.apply(this,arguments);this.notify('element:mouseout',evt);},mouseenter:function(evt){CellView.prototype.mouseenter.apply(this,arguments);this.notify('element:mouseenter',evt);},mouseleave:function(evt){CellView.prototype.mouseleave.apply(this,arguments);this.notify('element:mouseleave',evt);},mousewheel:function(evt,x,y,delta){CellView.prototype.mousewheel.apply(this,arguments);this.notify('element:mousewheel',evt,x,y,delta);},onmagnet:function(evt,x,y){this.dragMagnetStart(evt,x,y);},magnetpointerdblclick:function(evt,magnet,x,y){this.notify('element:magnet:pointerdblclick',evt,magnet,x,y);},magnetcontextmenu:function(evt,magnet,x,y){this.notify('element:magnet:contextmenu',evt,magnet,x,y);},// Drag Start Handlers\ndragStart:function(evt,x,y){var view=this.getDelegatedView();if(!view||!view.can('elementMove')){return;}this.eventData(evt,{action:'move',delegatedView:view});var position=view.model.position();view.eventData(evt,{initialPosition:position,pointerOffset:position.difference(x,y),restrictedArea:this.paper.getRestrictedArea(view,x,y)});},dragMagnetStart:function(evt,x,y){if(!this.can('addLinkFromMagnet')){return;}var magnet=evt.currentTarget;var paper=this.paper;this.eventData(evt,{targetMagnet:magnet});evt.stopPropagation();if(paper.options.validateMagnet(this,magnet,evt)){if(paper.options.magnetThreshold<=0){this.dragLinkStart(evt,magnet,x,y);}this.eventData(evt,{action:'magnet'});this.stopPropagation(evt);}else{this.pointerdown(evt,x,y);}paper.delegateDragEvents(this,evt.data);},// Drag Handlers\ndrag:function(evt,x,y){var paper=this.paper;var grid=paper.options.gridSize;var element=this.model;var data=this.eventData(evt);var pointerOffset=data.pointerOffset;var restrictedArea=data.restrictedArea;var embedding=data.embedding;// Make sure the new element's position always snaps to the current grid\nvar elX=snapToGrid(x+pointerOffset.x,grid);var elY=snapToGrid(y+pointerOffset.y,grid);element.position(elX,elY,{restrictedArea:restrictedArea,deep:true,ui:true});if(paper.options.embeddingMode){if(!embedding){// Prepare the element for embedding only if the pointer moves.\n// We don't want to do unnecessary action with the element\n// if an user only clicks/dblclicks on it.\nthis.prepareEmbedding(data);embedding=true;}this.processEmbedding(data,evt,x,y);}this.eventData(evt,{embedding:embedding});},dragMagnet:function(evt,x,y){this.dragLink(evt,x,y);},// Drag End Handlers\ndragEnd:function(evt,x,y){var data=this.eventData(evt);if(data.embedding){this.finalizeEmbedding(data);}},dragMagnetEnd:function(evt,x,y){this.dragLinkEnd(evt,x,y);},magnetpointerclick:function(evt,magnet,x,y){var paper=this.paper;if(paper.eventData(evt).mousemoved>paper.options.clickThreshold){return;}this.notify('element:magnet:pointerclick',evt,magnet,x,y);}},{Flags:Flags});assign(ElementView.prototype,elementViewPortPrototype);// Does not make any changes to vertices.\n// Returns the arguments that are passed to it, unchanged.\nvar normal=function(vertices,opt,linkView){return vertices;};// Routes the link always to/from a certain side\n//\n// Arguments:\n//   padding ... gap between the element and the first vertex. :: Default 40.\n//   side ... 'left' | 'right' | 'top' | 'bottom' :: Default 'bottom'.\n//\nvar oneSide=function(vertices,opt,linkView){var side=opt.side||'bottom';var padding=normalizeSides(opt.padding||40);// LinkView contains cached source an target bboxes.\n// Note that those are Geometry rectangle objects.\nvar sourceBBox=linkView.sourceBBox;var targetBBox=linkView.targetBBox;var sourcePoint=sourceBBox.center();var targetPoint=targetBBox.center();var coordinate,dimension,direction;switch(side){case'bottom':direction=1;coordinate='y';dimension='height';break;case'top':direction=-1;coordinate='y';dimension='height';break;case'left':direction=-1;coordinate='x';dimension='width';break;case'right':direction=1;coordinate='x';dimension='width';break;default:throw new Error('Router: invalid side');}// move the points from the center of the element to outside of it.\nsourcePoint[coordinate]+=direction*(sourceBBox[dimension]/2+padding[side]);targetPoint[coordinate]+=direction*(targetBBox[dimension]/2+padding[side]);// make link orthogonal (at least the first and last vertex).\nif(direction*(sourcePoint[coordinate]-targetPoint[coordinate])>0){targetPoint[coordinate]=sourcePoint[coordinate];}else{sourcePoint[coordinate]=targetPoint[coordinate];}return[sourcePoint].concat(vertices,targetPoint);};// bearing -> opposite bearing\nvar opposites={N:'S',S:'N',E:'W',W:'E'};// bearing -> radians\nvar radians={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};// HELPERS //\n// returns a point `p` where lines p,p1 and p,p2 are perpendicular and p is not contained\n// in the given box\nfunction freeJoin(p1,p2,bbox){var p=new Point(p1.x,p2.y);if(bbox.containsPoint(p)){p=new Point(p2.x,p1.y);}// kept for reference\n// if (bbox.containsPoint(p)) p = null;\nreturn p;}// returns either width or height of a bbox based on the given bearing\nfunction getBBoxSize(bbox,bearing){return bbox[bearing==='W'||bearing==='E'?'width':'height'];}// simple bearing method (calculates only orthogonal cardinals)\nfunction getBearing(from,to){if(from.x===to.x){return from.y>to.y?'N':'S';}if(from.y===to.y){return from.x>to.x?'W':'E';}return null;}// transform point to a rect\nfunction getPointBox(p){return new Rect(p.x,p.y,0,0);}function getPaddingBox(opt){// if both provided, opt.padding wins over opt.elementPadding\nvar sides=normalizeSides(opt.padding||opt.elementPadding||20);return{x:-sides.left,y:-sides.top,width:sides.left+sides.right,height:sides.top+sides.bottom};}// return source bbox\nfunction getSourceBBox(linkView,opt){return linkView.sourceBBox.clone().moveAndExpand(getPaddingBox(opt));}// return target bbox\nfunction getTargetBBox(linkView,opt){return linkView.targetBBox.clone().moveAndExpand(getPaddingBox(opt));}// return source anchor\nfunction getSourceAnchor(linkView,opt){if(linkView.sourceAnchor){return linkView.sourceAnchor;}// fallback: center of bbox\nvar sourceBBox=getSourceBBox(linkView,opt);return sourceBBox.center();}// return target anchor\nfunction getTargetAnchor(linkView,opt){if(linkView.targetAnchor){return linkView.targetAnchor;}// fallback: center of bbox\nvar targetBBox=getTargetBBox(linkView,opt);return targetBBox.center();// default\n}// PARTIAL ROUTERS //\nfunction vertexVertex(from,to,bearing){var p1=new Point(from.x,to.y);var p2=new Point(to.x,from.y);var d1=getBearing(from,p1);var d2=getBearing(from,p2);var opposite=opposites[bearing];var p=d1===bearing||d1!==opposite&&(d2===opposite||d2!==bearing)?p1:p2;return{points:[p],direction:getBearing(p,to)};}function elementVertex(from,to,fromBBox){var p=freeJoin(from,to,fromBBox);return{points:[p],direction:getBearing(p,to)};}function vertexElement(from,to,toBBox,bearing){var route={};var points=[new Point(from.x,to.y),new Point(to.x,from.y)];var freePoints=points.filter(function(pt){return!toBBox.containsPoint(pt);});var freeBearingPoints=freePoints.filter(function(pt){return getBearing(pt,from)!==bearing;});var p;if(freeBearingPoints.length>0){// Try to pick a point which bears the same direction as the previous segment.\np=freeBearingPoints.filter(function(pt){return getBearing(from,pt)===bearing;}).pop();p=p||freeBearingPoints[0];route.points=[p];route.direction=getBearing(p,to);}else{// Here we found only points which are either contained in the element or they would create\n// a link segment going in opposite direction from the previous one.\n// We take the point inside element and move it outside the element in the direction the\n// route is going. Now we can join this point with the current end (using freeJoin).\np=difference(points,freePoints)[0];var p2=new Point(to).move(p,-getBBoxSize(toBBox,bearing)/2);var p1=freeJoin(p2,from,toBBox);route.points=[p1,p2];route.direction=getBearing(p2,to);}return route;}function elementElement(from,to,fromBBox,toBBox){var route=elementVertex(to,from,toBBox);var p1=route.points[0];if(fromBBox.containsPoint(p1)){route=elementVertex(from,to,fromBBox);var p2=route.points[0];if(toBBox.containsPoint(p2)){var fromBorder=new Point(from).move(p2,-getBBoxSize(fromBBox,getBearing(from,p2))/2);var toBorder=new Point(to).move(p1,-getBBoxSize(toBBox,getBearing(to,p1))/2);var mid=new Line(fromBorder,toBorder).midpoint();var startRoute=elementVertex(from,mid,fromBBox);var endRoute=vertexVertex(mid,to,startRoute.direction);route.points=[startRoute.points[0],endRoute.points[0]];route.direction=endRoute.direction;}}return route;}// Finds route for situations where one element is inside the other.\n// Typically the route is directed outside the outer element first and\n// then back towards the inner element.\nfunction insideElement(from,to,fromBBox,toBBox,bearing){var route={};var boundary=fromBBox.union(toBBox).inflate(1);// start from the point which is closer to the boundary\nvar reversed=boundary.center().distance(to)>boundary.center().distance(from);var start=reversed?to:from;var end=reversed?from:to;var p1,p2,p3;if(bearing){// Points on circle with radius equals 'W + H` are always outside the rectangle\n// with width W and height H if the center of that circle is the center of that rectangle.\np1=Point.fromPolar(boundary.width+boundary.height,radians[bearing],start);p1=boundary.pointNearestToPoint(p1).move(p1,-1);}else{p1=boundary.pointNearestToPoint(start).move(start,1);}p2=freeJoin(p1,end,boundary);if(p1.round().equals(p2.round())){p2=Point.fromPolar(boundary.width+boundary.height,toRad(p1.theta(start))+Math.PI/2,end);p2=boundary.pointNearestToPoint(p2).move(end,1).round();p3=freeJoin(p1,p2,boundary);route.points=reversed?[p2,p3,p1]:[p1,p3,p2];}else{route.points=reversed?[p2,p1]:[p1,p2];}route.direction=reversed?getBearing(p1,to):getBearing(p2,to);return route;}// MAIN ROUTER //\n// Return points through which a connection needs to be drawn in order to obtain an orthogonal link\n// routing from source to target going through `vertices`.\nfunction orthogonal(vertices,opt,linkView){var sourceBBox=getSourceBBox(linkView,opt);var targetBBox=getTargetBBox(linkView,opt);var sourceAnchor=getSourceAnchor(linkView,opt);var targetAnchor=getTargetAnchor(linkView,opt);// if anchor lies outside of bbox, the bbox expands to include it\nsourceBBox=sourceBBox.union(getPointBox(sourceAnchor));targetBBox=targetBBox.union(getPointBox(targetAnchor));vertices=toArray(vertices).map(Point);vertices.unshift(sourceAnchor);vertices.push(targetAnchor);var bearing;// bearing of previous route segment\nvar orthogonalVertices=[];// the array of found orthogonal vertices to be returned\nfor(var i=0,max=vertices.length-1;i<max;i++){var route=null;var from=vertices[i];var to=vertices[i+1];var isOrthogonal=!!getBearing(from,to);if(i===0){// source\nif(i+1===max){// route source -> target\n// Expand one of the elements by 1px to detect situations when the two\n// elements are positioned next to each other with no gap in between.\nif(sourceBBox.intersect(targetBBox.clone().inflate(1))){route=insideElement(from,to,sourceBBox,targetBBox);}else if(!isOrthogonal){route=elementElement(from,to,sourceBBox,targetBBox);}}else{// route source -> vertex\nif(sourceBBox.containsPoint(to)){route=insideElement(from,to,sourceBBox,getPointBox(to).moveAndExpand(getPaddingBox(opt)));}else if(!isOrthogonal){route=elementVertex(from,to,sourceBBox);}}}else if(i+1===max){// route vertex -> target\n// prevent overlaps with previous line segment\nvar isOrthogonalLoop=isOrthogonal&&getBearing(to,from)===bearing;if(targetBBox.containsPoint(from)||isOrthogonalLoop){route=insideElement(from,to,getPointBox(from).moveAndExpand(getPaddingBox(opt)),targetBBox,bearing);}else if(!isOrthogonal){route=vertexElement(from,to,targetBBox,bearing);}}else if(!isOrthogonal){// route vertex -> vertex\nroute=vertexVertex(from,to,bearing);}// applicable to all routes:\n// set bearing for next iteration\nif(route){Array.prototype.push.apply(orthogonalVertices,route.points);bearing=route.direction;}else{// orthogonal route and not looped\nbearing=getBearing(from,to);}// push `to` point to identified orthogonal vertices array\nif(i+1<max){orthogonalVertices.push(to);}}return orthogonalVertices;}var config$1={// size of the step to find a route (the grid of the manhattan pathfinder)\nstep:10,// the number of route finding loops that cause the router to abort\n// returns fallback route instead\nmaximumLoops:2000,// the number of decimal places to round floating point coordinates\nprecision:1,// maximum change of direction\nmaxAllowedDirectionChange:90,// should the router use perpendicular linkView option?\n// does not connect anchor of element but rather a point close-by that is orthogonal\n// this looks much better\nperpendicular:true,// should the source and/or target not be considered as obstacles?\nexcludeEnds:[],// 'source', 'target'\n// should certain types of elements not be considered as obstacles?\nexcludeTypes:['basic.Text'],// possible starting directions from an element\nstartDirections:['top','right','bottom','left'],// possible ending directions to an element\nendDirections:['top','right','bottom','left'],// specify the directions used above and what they mean\ndirectionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},// cost of an orthogonal step\ncost:function(){return this.step;},// an array of directions to find next points on the route\n// different from start/end directions\ndirections:function(){var step=this.step;var cost=this.cost();return[{offsetX:step,offsetY:0,cost:cost},{offsetX:-step,offsetY:0,cost:cost},{offsetX:0,offsetY:step,cost:cost},{offsetX:0,offsetY:-step,cost:cost}];},// a penalty received for direction change\npenalties:function(){return{0:0,45:this.step/2,90:this.step/2};},// padding applied on the element bounding boxes\npaddingBox:function(){var step=this.step;return{x:-step,y:-step,width:2*step,height:2*step};},// A function that determines whether a given point is an obstacle or not.\n// If used, the `padding`, `excludeEnds`and `excludeTypes` options are ignored.\n// (point: dia.Point) => boolean;\nisPointObstacle:null,// a router to use when the manhattan router fails\n// (one of the partial routes returns null)\nfallbackRouter:function(vertices,opt,linkView){if(!isFunction(orthogonal)){throw new Error('Manhattan requires the orthogonal router as default fallback.');}return orthogonal(vertices,assign({},config$1,opt),linkView);},/* Deprecated */ // a simple route used in situations when main routing method fails\n// (exceed max number of loop iterations, inaccessible)\nfallbackRoute:function(from,to,opt){return null;// null result will trigger the fallbackRouter\n// left for reference:\n/*// Find an orthogonal route ignoring obstacles.\n\n\t        var point = ((opt.previousDirAngle || 0) % 180 === 0)\n\t                ? new g.Point(from.x, to.y)\n\t                : new g.Point(to.x, from.y);\n\n\t        return [point];*/},// if a function is provided, it's used to route the link while dragging an end\n// i.e. function(from, to, opt) { return []; }\ndraggingRoute:null};// HELPER CLASSES //\n// Map of obstacles\n// Helper structure to identify whether a point lies inside an obstacle.\nfunction ObstacleMap(opt){this.map={};this.options=opt;// tells how to divide the paper when creating the elements map\nthis.mapGridSize=100;}ObstacleMap.prototype.build=function(graph,link){var opt=this.options;// source or target element could be excluded from set of obstacles\nvar excludedEnds=toArray(opt.excludeEnds).reduce(function(res,item){var end=link.get(item);if(end){var cell=graph.getCell(end.id);if(cell){res.push(cell);}}return res;},[]);// Exclude any embedded elements from the source and the target element.\nvar excludedAncestors=[];var source=graph.getCell(link.get('source').id);if(source){excludedAncestors=union(excludedAncestors,source.getAncestors().map(function(cell){return cell.id;}));}var target=graph.getCell(link.get('target').id);if(target){excludedAncestors=union(excludedAncestors,target.getAncestors().map(function(cell){return cell.id;}));}// Builds a map of all elements for quicker obstacle queries (i.e. is a point contained\n// in any obstacle?) (a simplified grid search).\n// The paper is divided into smaller cells, where each holds information about which\n// elements belong to it. When we query whether a point lies inside an obstacle we\n// don't need to go through all obstacles, we check only those in a particular cell.\nvar mapGridSize=this.mapGridSize;graph.getElements().reduce(function(map,element){var isExcludedType=toArray(opt.excludeTypes).includes(element.get('type'));var isExcludedEnd=excludedEnds.find(function(excluded){return excluded.id===element.id;});var isExcludedAncestor=excludedAncestors.includes(element.id);var isExcluded=isExcludedType||isExcludedEnd||isExcludedAncestor;if(!isExcluded){var bbox=element.getBBox().moveAndExpand(opt.paddingBox);var origin=bbox.origin().snapToGrid(mapGridSize);var corner=bbox.corner().snapToGrid(mapGridSize);for(var x=origin.x;x<=corner.x;x+=mapGridSize){for(var y=origin.y;y<=corner.y;y+=mapGridSize){var gridKey=x+'@'+y;map[gridKey]=map[gridKey]||[];map[gridKey].push(bbox);}}}return map;},this.map);return this;};ObstacleMap.prototype.isPointAccessible=function(point){var mapKey=point.clone().snapToGrid(this.mapGridSize).toString();return toArray(this.map[mapKey]).every(function(obstacle){return!obstacle.containsPoint(point);});};// Sorted Set\n// Set of items sorted by given value.\nfunction SortedSet(){this.items=[];this.hash={};this.values={};this.OPEN=1;this.CLOSE=2;}SortedSet.prototype.add=function(item,value){if(this.hash[item]){// item removal\nthis.items.splice(this.items.indexOf(item),1);}else{this.hash[item]=this.OPEN;}this.values[item]=value;var index$1=sortedIndex(this.items,item,function(i){return this.values[i];}.bind(this));this.items.splice(index$1,0,item);};SortedSet.prototype.remove=function(item){this.hash[item]=this.CLOSE;};SortedSet.prototype.isOpen=function(item){return this.hash[item]===this.OPEN;};SortedSet.prototype.isClose=function(item){return this.hash[item]===this.CLOSE;};SortedSet.prototype.isEmpty=function(){return this.items.length===0;};SortedSet.prototype.pop=function(){var item=this.items.shift();this.remove(item);return item;};// HELPERS //\n// return source bbox\nfunction getSourceBBox$1(linkView,opt){// expand by padding box\nif(opt&&opt.paddingBox){return linkView.sourceBBox.clone().moveAndExpand(opt.paddingBox);}return linkView.sourceBBox.clone();}// return target bbox\nfunction getTargetBBox$1(linkView,opt){// expand by padding box\nif(opt&&opt.paddingBox){return linkView.targetBBox.clone().moveAndExpand(opt.paddingBox);}return linkView.targetBBox.clone();}// return source anchor\nfunction getSourceAnchor$1(linkView,opt){if(linkView.sourceAnchor){return linkView.sourceAnchor;}// fallback: center of bbox\nvar sourceBBox=getSourceBBox$1(linkView,opt);return sourceBBox.center();}// return target anchor\nfunction getTargetAnchor$1(linkView,opt){if(linkView.targetAnchor){return linkView.targetAnchor;}// fallback: center of bbox\nvar targetBBox=getTargetBBox$1(linkView,opt);return targetBBox.center();// default\n}// returns a direction index from start point to end point\n// corrects for grid deformation between start and end\nfunction getDirectionAngle(start,end,numDirections,grid,opt){var quadrant=360/numDirections;var angleTheta=start.theta(fixAngleEnd(start,end,grid,opt));var normalizedAngle=normalizeAngle(angleTheta+quadrant/2);return quadrant*Math.floor(normalizedAngle/quadrant);}// helper function for getDirectionAngle()\n// corrects for grid deformation\n// (if a point is one grid steps away from another in both dimensions,\n// it is considered to be 45 degrees away, even if the real angle is different)\n// this causes visible angle discrepancies if `opt.step` is much larger than `paper.gridSize`\nfunction fixAngleEnd(start,end,grid,opt){var step=opt.step;var diffX=end.x-start.x;var diffY=end.y-start.y;var gridStepsX=diffX/grid.x;var gridStepsY=diffY/grid.y;var distanceX=gridStepsX*step;var distanceY=gridStepsY*step;return new Point(start.x+distanceX,start.y+distanceY);}// return the change in direction between two direction angles\nfunction getDirectionChange(angle1,angle2){var directionChange=Math.abs(angle1-angle2);return directionChange>180?360-directionChange:directionChange;}// fix direction offsets according to current grid\nfunction getGridOffsets(directions,grid,opt){var step=opt.step;toArray(opt.directions).forEach(function(direction){direction.gridOffsetX=direction.offsetX/step*grid.x;direction.gridOffsetY=direction.offsetY/step*grid.y;});}// get grid size in x and y dimensions, adapted to source and target positions\nfunction getGrid(step,source,target){return{source:source.clone(),x:getGridDimension(target.x-source.x,step),y:getGridDimension(target.y-source.y,step)};}// helper function for getGrid()\nfunction getGridDimension(diff,step){// return step if diff = 0\nif(!diff){return step;}var absDiff=Math.abs(diff);var numSteps=Math.round(absDiff/step);// return absDiff if less than one step apart\nif(!numSteps){return absDiff;}// otherwise, return corrected step\nvar roundedDiff=numSteps*step;var remainder=absDiff-roundedDiff;var stepCorrection=remainder/numSteps;return step+stepCorrection;}// return a clone of point snapped to grid\nfunction snapToGrid$1(point,grid){var source=grid.source;var snappedX=snapToGrid(point.x-source.x,grid.x)+source.x;var snappedY=snapToGrid(point.y-source.y,grid.y)+source.y;return new Point(snappedX,snappedY);}// round the point to opt.precision\nfunction round$4(point,precision){return point.round(precision);}// snap to grid and then round the point\nfunction align(point,grid,precision){return round$4(snapToGrid$1(point.clone(),grid),precision);}// return a string representing the point\n// string is rounded in both dimensions\nfunction getKey(point){return point.clone().toString();}// return a normalized vector from given point\n// used to determine the direction of a difference of two points\nfunction normalizePoint(point){return new Point(point.x===0?0:Math.abs(point.x)/point.x,point.y===0?0:Math.abs(point.y)/point.y);}// PATHFINDING //\n// reconstructs a route by concatenating points with their parents\nfunction reconstructRoute(parents,points,tailPoint,from,to,grid,opt){var route=[];var prevDiff=normalizePoint(to.difference(tailPoint));// tailPoint is assumed to be aligned already\nvar currentKey=getKey(tailPoint);var parent=parents[currentKey];var point;while(parent){// point is assumed to be aligned already\npoint=points[currentKey];var diff=normalizePoint(point.difference(parent));if(!diff.equals(prevDiff)){route.unshift(point);prevDiff=diff;}// parent is assumed to be aligned already\ncurrentKey=getKey(parent);parent=parents[currentKey];}// leadPoint is assumed to be aligned already\nvar leadPoint=points[currentKey];var fromDiff=normalizePoint(leadPoint.difference(from));if(!fromDiff.equals(prevDiff)){route.unshift(leadPoint);}return route;}// heuristic method to determine the distance between two points\nfunction estimateCost(from,endPoints){var min=Infinity;for(var i=0,len=endPoints.length;i<len;i++){var cost=from.manhattanDistance(endPoints[i]);if(cost<min){min=cost;}}return min;}// find points around the bbox taking given directions into account\n// lines are drawn from anchor in given directions, intersections recorded\n// if anchor is outside bbox, only those directions that intersect get a rect point\n// the anchor itself is returned as rect point (representing some directions)\n// (since those directions are unobstructed by the bbox)\nfunction getRectPoints(anchor,bbox,directionList,grid,opt){var precision=opt.precision;var directionMap=opt.directionMap;var anchorCenterVector=anchor.difference(bbox.center());var keys=isObject$1(directionMap)?Object.keys(directionMap):[];var dirList=toArray(directionList);var rectPoints=keys.reduce(function(res,key){if(dirList.includes(key)){var direction=directionMap[key];// create a line that is guaranteed to intersect the bbox if bbox is in the direction\n// even if anchor lies outside of bbox\nvar endpoint=new Point(anchor.x+direction.x*(Math.abs(anchorCenterVector.x)+bbox.width),anchor.y+direction.y*(Math.abs(anchorCenterVector.y)+bbox.height));var intersectionLine=new Line(anchor,endpoint);// get the farther intersection, in case there are two\n// (that happens if anchor lies next to bbox)\nvar intersections=intersectionLine.intersect(bbox)||[];var numIntersections=intersections.length;var farthestIntersectionDistance;var farthestIntersection=null;for(var i=0;i<numIntersections;i++){var currentIntersection=intersections[i];var distance=anchor.squaredDistance(currentIntersection);if(farthestIntersectionDistance===undefined||distance>farthestIntersectionDistance){farthestIntersectionDistance=distance;farthestIntersection=currentIntersection;}}// if an intersection was found in this direction, it is our rectPoint\nif(farthestIntersection){var point=align(farthestIntersection,grid,precision);// if the rectPoint lies inside the bbox, offset it by one more step\nif(bbox.containsPoint(point)){point=align(point.offset(direction.x*grid.x,direction.y*grid.y),grid,precision);}// then add the point to the result array\n// aligned\nres.push(point);}}return res;},[]);// if anchor lies outside of bbox, add it to the array of points\nif(!bbox.containsPoint(anchor)){// aligned\nrectPoints.push(align(anchor,grid,precision));}return rectPoints;}// finds the route between two points/rectangles (`from`, `to`) implementing A* algorithm\n// rectangles get rect points assigned by getRectPoints()\nfunction findRoute(from,to,isPointObstacle,opt){var precision=opt.precision;// Get grid for this route.\nvar sourceAnchor,targetAnchor;if(from instanceof Rect){// `from` is sourceBBox\nsourceAnchor=round$4(getSourceAnchor$1(this,opt).clone(),precision);}else{sourceAnchor=round$4(from.clone(),precision);}if(to instanceof Rect){// `to` is targetBBox\ntargetAnchor=round$4(getTargetAnchor$1(this,opt).clone(),precision);}else{targetAnchor=round$4(to.clone(),precision);}var grid=getGrid(opt.step,sourceAnchor,targetAnchor);// Get pathfinding points.\nvar start,end;// aligned with grid by definition\nvar startPoints,endPoints;// assumed to be aligned with grid already\n// set of points we start pathfinding from\nif(from instanceof Rect){// `from` is sourceBBox\nstart=sourceAnchor;startPoints=getRectPoints(start,from,opt.startDirections,grid,opt);}else{start=sourceAnchor;startPoints=[start];}// set of points we want the pathfinding to finish at\nif(to instanceof Rect){// `to` is targetBBox\nend=targetAnchor;endPoints=getRectPoints(targetAnchor,to,opt.endDirections,grid,opt);}else{end=targetAnchor;endPoints=[end];}// take into account only accessible rect points (those not under obstacles)\nstartPoints=startPoints.filter(function(p){return!isPointObstacle(p);});endPoints=endPoints.filter(function(p){return!isPointObstacle(p);});// Check that there is an accessible route point on both sides.\n// Otherwise, use fallbackRoute().\nif(startPoints.length>0&&endPoints.length>0){// The set of tentative points to be evaluated, initially containing the start points.\n// Rounded to nearest integer for simplicity.\nvar openSet=new SortedSet();// Keeps reference to actual points for given elements of the open set.\nvar points={};// Keeps reference to a point that is immediate predecessor of given element.\nvar parents={};// Cost from start to a point along best known path.\nvar costs={};for(var i=0,n=startPoints.length;i<n;i++){// startPoint is assumed to be aligned already\nvar startPoint=startPoints[i];var key=getKey(startPoint);openSet.add(key,estimateCost(startPoint,endPoints));points[key]=startPoint;costs[key]=0;}var previousRouteDirectionAngle=opt.previousDirectionAngle;// undefined for first route\nvar isPathBeginning=previousRouteDirectionAngle===undefined;// directions\nvar direction,directionChange;var directions=opt.directions;getGridOffsets(directions,grid,opt);var numDirections=directions.length;var endPointsKeys=toArray(endPoints).reduce(function(res,endPoint){// endPoint is assumed to be aligned already\nvar key=getKey(endPoint);res.push(key);return res;},[]);// main route finding loop\nvar loopsRemaining=opt.maximumLoops;while(!openSet.isEmpty()&&loopsRemaining>0){// remove current from the open list\nvar currentKey=openSet.pop();var currentPoint=points[currentKey];var currentParent=parents[currentKey];var currentCost=costs[currentKey];var isRouteBeginning=currentParent===undefined;// undefined for route starts\nvar isStart=currentPoint.equals(start);// (is source anchor or `from` point) = can leave in any direction\nvar previousDirectionAngle;if(!isRouteBeginning){previousDirectionAngle=getDirectionAngle(currentParent,currentPoint,numDirections,grid,opt);}// a vertex on the route\nelse if(!isPathBeginning){previousDirectionAngle=previousRouteDirectionAngle;}// beginning of route on the path\nelse if(!isStart){previousDirectionAngle=getDirectionAngle(start,currentPoint,numDirections,grid,opt);}// beginning of path, start rect point\nelse{previousDirectionAngle=null;}// beginning of path, source anchor or `from` point\n// check if we reached any endpoint\nvar samePoints=startPoints.length===endPoints.length;if(samePoints){for(var j=0;j<startPoints.length;j++){if(!startPoints[j].equals(endPoints[j])){samePoints=false;break;}}}var skipEndCheck=isRouteBeginning&&samePoints;if(!skipEndCheck&&endPointsKeys.indexOf(currentKey)>=0){opt.previousDirectionAngle=previousDirectionAngle;return reconstructRoute(parents,points,currentPoint,start,end,grid,opt);}// go over all possible directions and find neighbors\nfor(i=0;i<numDirections;i++){direction=directions[i];var directionAngle=direction.angle;directionChange=getDirectionChange(previousDirectionAngle,directionAngle);// if the direction changed rapidly, don't use this point\n// any direction is allowed for starting points\nif(!(isPathBeginning&&isStart)&&directionChange>opt.maxAllowedDirectionChange){continue;}var neighborPoint=align(currentPoint.clone().offset(direction.gridOffsetX,direction.gridOffsetY),grid,precision);var neighborKey=getKey(neighborPoint);// Closed points from the openSet were already evaluated.\nif(openSet.isClose(neighborKey)||isPointObstacle(neighborPoint)){continue;}// We can only enter end points at an acceptable angle.\nif(endPointsKeys.indexOf(neighborKey)>=0){// neighbor is an end point\nvar isNeighborEnd=neighborPoint.equals(end);// (is target anchor or `to` point) = can be entered in any direction\nif(!isNeighborEnd){var endDirectionAngle=getDirectionAngle(neighborPoint,end,numDirections,grid,opt);var endDirectionChange=getDirectionChange(directionAngle,endDirectionAngle);if(endDirectionChange>opt.maxAllowedDirectionChange){continue;}}}// The current direction is ok.\nvar neighborCost=direction.cost;var neighborPenalty=isStart?0:opt.penalties[directionChange];// no penalties for start point\nvar costFromStart=currentCost+neighborCost+neighborPenalty;if(!openSet.isOpen(neighborKey)||costFromStart<costs[neighborKey]){// neighbor point has not been processed yet\n// or the cost of the path from start is lower than previously calculated\npoints[neighborKey]=neighborPoint;parents[neighborKey]=currentPoint;costs[neighborKey]=costFromStart;openSet.add(neighborKey,costFromStart+estimateCost(neighborPoint,endPoints));}}loopsRemaining--;}}// no route found (`to` point either wasn't accessible or finding route took\n// way too much calculation)\nreturn opt.fallbackRoute.call(this,start,end,opt);}// resolve some of the options\nfunction resolveOptions(opt){opt.directions=result(opt,'directions');opt.penalties=result(opt,'penalties');opt.paddingBox=result(opt,'paddingBox');opt.padding=result(opt,'padding');if(opt.padding){// if both provided, opt.padding wins over opt.paddingBox\nvar sides=normalizeSides(opt.padding);opt.paddingBox={x:-sides.left,y:-sides.top,width:sides.left+sides.right,height:sides.top+sides.bottom};}toArray(opt.directions).forEach(function(direction){var point1=new Point(0,0);var point2=new Point(direction.offsetX,direction.offsetY);direction.angle=normalizeAngle(point1.theta(point2));});}// initialization of the route finding\nfunction router(vertices,opt,linkView){resolveOptions(opt);// enable/disable linkView perpendicular option\nlinkView.options.perpendicular=!!opt.perpendicular;var sourceBBox=getSourceBBox$1(linkView,opt);var targetBBox=getTargetBBox$1(linkView,opt);var sourceAnchor=getSourceAnchor$1(linkView,opt);//var targetAnchor = getTargetAnchor(linkView, opt);\n// pathfinding\nvar isPointObstacle;if(typeof opt.isPointObstacle==='function'){isPointObstacle=opt.isPointObstacle;}else{var map=new ObstacleMap(opt);map.build(linkView.paper.model,linkView.model);isPointObstacle=function(point){return!map.isPointAccessible(point);};}var oldVertices=toArray(vertices).map(Point);var newVertices=[];var tailPoint=sourceAnchor;// the origin of first route's grid, does not need snapping\n// find a route by concatenating all partial routes (routes need to pass through vertices)\n// source -> vertex[1] -> ... -> vertex[n] -> target\nvar to,from;for(var i=0,len=oldVertices.length;i<=len;i++){var partialRoute=null;from=to||sourceBBox;to=oldVertices[i];if(!to){// this is the last iteration\n// we ran through all vertices in oldVertices\n// 'to' is not a vertex.\nto=targetBBox;// If the target is a point (i.e. it's not an element), we\n// should use dragging route instead of main routing method if it has been provided.\nvar isEndingAtPoint=!linkView.model.get('source').id||!linkView.model.get('target').id;if(isEndingAtPoint&&isFunction(opt.draggingRoute)){// Make sure we are passing points only (not rects).\nvar dragFrom=from===sourceBBox?sourceAnchor:from;var dragTo=to.origin();partialRoute=opt.draggingRoute.call(linkView,dragFrom,dragTo,opt);}}// if partial route has not been calculated yet use the main routing method to find one\npartialRoute=partialRoute||findRoute.call(linkView,from,to,isPointObstacle,opt);if(partialRoute===null){// the partial route cannot be found\nreturn opt.fallbackRouter(vertices,opt,linkView);}var leadPoint=partialRoute[0];// remove the first point if the previous partial route had the same point as last\nif(leadPoint&&leadPoint.equals(tailPoint)){partialRoute.shift();}// save tailPoint for next iteration\ntailPoint=partialRoute[partialRoute.length-1]||tailPoint;Array.prototype.push.apply(newVertices,partialRoute);}return newVertices;}// public function\nvar manhattan=function(vertices,opt,linkView){return router(vertices,assign({},config$1,opt),linkView);};var config$2={maxAllowedDirectionChange:45,// cost of a diagonal step\ndiagonalCost:function(){var step=this.step;return Math.ceil(Math.sqrt(step*step<<1));},// an array of directions to find next points on the route\n// different from start/end directions\ndirections:function(){var step=this.step;var cost=this.cost();var diagonalCost=this.diagonalCost();return[{offsetX:step,offsetY:0,cost:cost},{offsetX:step,offsetY:step,cost:diagonalCost},{offsetX:0,offsetY:step,cost:cost},{offsetX:-step,offsetY:step,cost:diagonalCost},{offsetX:-step,offsetY:0,cost:cost},{offsetX:-step,offsetY:-step,cost:diagonalCost},{offsetX:0,offsetY:-step,cost:cost},{offsetX:step,offsetY:-step,cost:diagonalCost}];},// a simple route used in situations when main routing method fails\n// (exceed max number of loop iterations, inaccessible)\nfallbackRoute:function(from,to,opt){// Find a route which breaks by 45 degrees ignoring all obstacles.\nvar theta=from.theta(to);var route=[];var a={x:to.x,y:from.y};var b={x:from.x,y:to.y};if(theta%180>90){var t=a;a=b;b=t;}var p1=theta%90<45?a:b;var l1=new Line(from,p1);var alpha=90*Math.ceil(theta/90);var p2=Point.fromPolar(l1.squaredLength(),toRad(alpha+135),p1);var l2=new Line(to,p2);var intersectionPoint=l1.intersection(l2);var point=intersectionPoint?intersectionPoint:to;var directionFrom=intersectionPoint?point:from;var quadrant=360/opt.directions.length;var angleTheta=directionFrom.theta(to);var normalizedAngle=normalizeAngle(angleTheta+quadrant/2);var directionAngle=quadrant*Math.floor(normalizedAngle/quadrant);opt.previousDirectionAngle=directionAngle;if(point){route.push(point.round());}route.push(to);return route;}};// public function\nvar metro=function(vertices,opt,linkView){if(!isFunction(manhattan)){throw new Error('Metro requires the manhattan router.');}return manhattan(vertices,assign({},config$2,opt),linkView);};var routers={normal:normal,oneSide:oneSide,orthogonal:orthogonal,manhattan:manhattan,metro:metro};// default size of jump if not specified in options\nvar JUMP_SIZE=5;// available jump types\n// first one taken as default\nvar JUMP_TYPES=['arc','gap','cubic'];// default radius\nvar RADIUS=0;// takes care of math. error for case when jump is too close to end of line\nvar CLOSE_PROXIMITY_PADDING=1;// list of connector types not to jump over.\nvar IGNORED_CONNECTORS=['smooth'];// internal constants for round segment\nvar _13=1/3;var _23=2/3;/**\n\t * Transform start/end and route into series of lines\n\t * @param {g.point} sourcePoint start point\n\t * @param {g.point} targetPoint end point\n\t * @param {g.point[]} route optional list of route\n\t * @return {g.line[]} [description]\n\t */function createLines(sourcePoint,targetPoint,route){// make a flattened array of all points\nvar points=[].concat(sourcePoint,route,targetPoint);return points.reduce(function(resultLines,point,idx){// if there is a next point, make a line with it\nvar nextPoint=points[idx+1];if(nextPoint!=null){resultLines[idx]=line(point,nextPoint);}return resultLines;},[]);}function setupUpdating(jumpOverLinkView){var paper=jumpOverLinkView.paper;var updateList=paper._jumpOverUpdateList;// first time setup for this paper\nif(updateList==null){updateList=paper._jumpOverUpdateList=[];var graph=paper.model;graph.on('batch:stop',function(){if(this.hasActiveBatch()){return;}updateJumpOver(paper);});graph.on('reset',function(){updateList=paper._jumpOverUpdateList=[];});}// add this link to a list so it can be updated when some other link is updated\nif(updateList.indexOf(jumpOverLinkView)<0){updateList.push(jumpOverLinkView);// watch for change of connector type or removal of link itself\n// to remove the link from a list of jump over connectors\njumpOverLinkView.listenToOnce(jumpOverLinkView.model,'change:connector remove',function(){updateList.splice(updateList.indexOf(jumpOverLinkView),1);});}}/**\n\t * Handler for a batch:stop event to force\n\t * update of all registered links with jump over connector\n\t * @param {object} batchEvent optional object with info about batch\n\t */function updateJumpOver(paper){var updateList=paper._jumpOverUpdateList;for(var i=0;i<updateList.length;i++){var linkView=updateList[i];var updateFlag=linkView.getFlag(linkView.constructor.Flags.CONNECTOR);linkView.requestUpdate(updateFlag);}}/**\n\t * Utility function to collect all intersection points of a single\n\t * line against group of other lines.\n\t * @param {g.line} line where to find points\n\t * @param {g.line[]} crossCheckLines lines to cross\n\t * @return {g.point[]} list of intersection points\n\t */function findLineIntersections(line,crossCheckLines){return toArray(crossCheckLines).reduce(function(res,crossCheckLine){var intersection=line.intersection(crossCheckLine);if(intersection){res.push(intersection);}return res;},[]);}/**\n\t * Sorting function for list of points by their distance.\n\t * @param {g.point} p1 first point\n\t * @param {g.point} p2 second point\n\t * @return {number} squared distance between points\n\t */function sortPoints(p1,p2){return line(p1,p2).squaredLength();}/**\n\t * Split input line into multiple based on intersection points.\n\t * @param {g.line} line input line to split\n\t * @param {g.point[]} intersections points where to split the line\n\t * @param {number} jumpSize the size of jump arc (length empty spot on a line)\n\t * @return {g.line[]} list of lines being split\n\t */function createJumps(line$1,intersections,jumpSize){return intersections.reduce(function(resultLines,point$1,idx){// skipping points that were merged with the previous line\n// to make bigger arc over multiple lines that are close to each other\nif(point$1.skip===true){return resultLines;}// always grab the last line from buffer and modify it\nvar lastLine=resultLines.pop()||line$1;// calculate start and end of jump by moving by a given size of jump\nvar jumpStart=point(point$1).move(lastLine.start,-jumpSize);var jumpEnd=point(point$1).move(lastLine.start,+jumpSize);// now try to look at the next intersection point\nvar nextPoint=intersections[idx+1];if(nextPoint!=null){var distance=jumpEnd.distance(nextPoint);if(distance<=jumpSize){// next point is close enough, move the jump end by this\n// difference and mark the next point to be skipped\njumpEnd=nextPoint.move(lastLine.start,distance);nextPoint.skip=true;}}else{// this block is inside of `else` as an optimization so the distance is\n// not calculated when we know there are no other intersection points\nvar endDistance=jumpStart.distance(lastLine.end);// if the end is too close to possible jump, draw remaining line instead of a jump\nif(endDistance<jumpSize*2+CLOSE_PROXIMITY_PADDING){resultLines.push(lastLine);return resultLines;}}var startDistance=jumpEnd.distance(lastLine.start);if(startDistance<jumpSize*2+CLOSE_PROXIMITY_PADDING){// if the start of line is too close to jump, draw that line instead of a jump\nresultLines.push(lastLine);return resultLines;}// finally create a jump line\nvar jumpLine=line(jumpStart,jumpEnd);// it's just simple line but with a `isJump` property\njumpLine.isJump=true;resultLines.push(line(lastLine.start,jumpStart),jumpLine,line(jumpEnd,lastLine.end));return resultLines;},[]);}/**\n\t * Assemble `D` attribute of a SVG path by iterating given lines.\n\t * @param {g.line[]} lines source lines to use\n\t * @param {number} jumpSize the size of jump arc (length empty spot on a line)\n\t * @param {number} radius the radius\n\t * @return {string}\n\t */function buildPath(lines,jumpSize,jumpType,radius){var path=new Path();var segment;// first move to the start of a first line\nsegment=Path.createSegment('M',lines[0].start);path.appendSegment(segment);// make a paths from lines\ntoArray(lines).forEach(function(line,index){if(line.isJump){var angle,diff;var control1,control2;if(jumpType==='arc'){// approximates semicircle with 2 curves\nangle=-90;// determine rotation of arc based on difference between points\ndiff=line.start.difference(line.end);// make sure the arc always points up (or right)\nvar xAxisRotate=Number(diff.x<0||diff.x===0&&diff.y<0);if(xAxisRotate){angle+=180;}var midpoint=line.midpoint();var centerLine=new Line(midpoint,line.end).rotate(midpoint,angle);var halfLine;// first half\nhalfLine=new Line(line.start,midpoint);control1=halfLine.pointAt(2/3).rotate(line.start,angle);control2=centerLine.pointAt(1/3).rotate(centerLine.end,-angle);segment=Path.createSegment('C',control1,control2,centerLine.end);path.appendSegment(segment);// second half\nhalfLine=new Line(midpoint,line.end);control1=centerLine.pointAt(1/3).rotate(centerLine.end,angle);control2=halfLine.pointAt(1/3).rotate(line.end,-angle);segment=Path.createSegment('C',control1,control2,line.end);path.appendSegment(segment);}else if(jumpType==='gap'){segment=Path.createSegment('M',line.end);path.appendSegment(segment);}else if(jumpType==='cubic'){// approximates semicircle with 1 curve\nangle=line.start.theta(line.end);var xOffset=jumpSize*0.6;var yOffset=jumpSize*1.35;// determine rotation of arc based on difference between points\ndiff=line.start.difference(line.end);// make sure the arc always points up (or right)\nxAxisRotate=Number(diff.x<0||diff.x===0&&diff.y<0);if(xAxisRotate){yOffset*=-1;}control1=Point(line.start.x+xOffset,line.start.y+yOffset).rotate(line.start,angle);control2=Point(line.end.x-xOffset,line.end.y+yOffset).rotate(line.end,angle);segment=Path.createSegment('C',control1,control2,line.end);path.appendSegment(segment);}}else{var nextLine=lines[index+1];if(radius==0||!nextLine||nextLine.isJump){segment=Path.createSegment('L',line.end);path.appendSegment(segment);}else{buildRoundedSegment(radius,path,line.end,line.start,nextLine.end);}}});return path;}function buildRoundedSegment(offset,path,curr,prev,next){var prevDistance=curr.distance(prev)/2;var nextDistance=curr.distance(next)/2;var startMove=-Math.min(offset,prevDistance);var endMove=-Math.min(offset,nextDistance);var roundedStart=curr.clone().move(prev,startMove).round();var roundedEnd=curr.clone().move(next,endMove).round();var control1=new Point(_13*roundedStart.x+_23*curr.x,_23*curr.y+_13*roundedStart.y);var control2=new Point(_13*roundedEnd.x+_23*curr.x,_23*curr.y+_13*roundedEnd.y);var segment;segment=Path.createSegment('L',roundedStart);path.appendSegment(segment);segment=Path.createSegment('C',control1,control2,roundedEnd);path.appendSegment(segment);}/**\n\t * Actual connector function that will be run on every update.\n\t * @param {g.point} sourcePoint start point of this link\n\t * @param {g.point} targetPoint end point of this link\n\t * @param {g.point[]} route of this link\n\t * @param {object} opt options\n\t * @property {number} size optional size of a jump arc\n\t * @return {string} created `D` attribute of SVG path\n\t */var jumpover=function(sourcePoint,targetPoint,route,opt){// eslint-disable-line max-params\nsetupUpdating(this);var raw=opt.raw;var jumpSize=opt.size||JUMP_SIZE;var jumpType=opt.jump&&(''+opt.jump).toLowerCase();var radius=opt.radius||RADIUS;var ignoreConnectors=opt.ignoreConnectors||IGNORED_CONNECTORS;// grab the first jump type as a default if specified one is invalid\nif(JUMP_TYPES.indexOf(jumpType)===-1){jumpType=JUMP_TYPES[0];}var paper=this.paper;var graph=paper.model;var allLinks=graph.getLinks();// there is just one link, draw it directly\nif(allLinks.length===1){return buildPath(createLines(sourcePoint,targetPoint,route),jumpSize,jumpType,radius);}var thisModel=this.model;var thisIndex=allLinks.indexOf(thisModel);var defaultConnector=paper.options.defaultConnector||{};// not all links are meant to be jumped over.\nvar links=allLinks.filter(function(link,idx){var connector=link.get('connector')||defaultConnector;// avoid jumping over links with connector type listed in `ignored connectors`.\nif(toArray(ignoreConnectors).includes(connector.name)){return false;}// filter out links that are above this one and  have the same connector type\n// otherwise there would double hoops for each intersection\nif(idx>thisIndex){return connector.name!=='jumpover';}return true;});// find views for all links\nvar linkViews=links.map(function(link){return paper.findViewByModel(link);});// create lines for this link\nvar thisLines=createLines(sourcePoint,targetPoint,route);// create lines for all other links\nvar linkLines=linkViews.map(function(linkView){if(linkView==null){return[];}if(linkView===this){return thisLines;}return createLines(linkView.sourcePoint,linkView.targetPoint,linkView.route);},this);// transform lines for this link by splitting with jump lines at\n// points of intersection with other links\nvar jumpingLines=thisLines.reduce(function(resultLines,thisLine){// iterate all links and grab the intersections with this line\n// these are then sorted by distance so the line can be split more easily\nvar intersections=links.reduce(function(res,link,i){// don't intersection with itself\nif(link!==thisModel){var lineIntersections=findLineIntersections(thisLine,linkLines[i]);res.push.apply(res,lineIntersections);}return res;},[]).sort(function(a,b){return sortPoints(thisLine.start,a)-sortPoints(thisLine.start,b);});if(intersections.length>0){// split the line based on found intersection points\nresultLines.push.apply(resultLines,createJumps(thisLine,intersections,jumpSize));}else{// without any intersection the line goes uninterrupted\nresultLines.push(thisLine);}return resultLines;},[]);var path=buildPath(jumpingLines,jumpSize,jumpType,radius);return raw?path:path.serialize();};var normal$1=function(sourcePoint,targetPoint,route,opt){var raw=opt&&opt.raw;var points=[sourcePoint].concat(route).concat([targetPoint]);var polyline=new Polyline(points);var path=new Path(polyline);return raw?path:path.serialize();};var rounded=function(sourcePoint,targetPoint,route,opt){opt||(opt={});var offset=opt.radius||10;var raw=opt.raw;var path=new Path();var segment;segment=Path.createSegment('M',sourcePoint);path.appendSegment(segment);var _13=1/3;var _23=2/3;var curr;var prev,next;var prevDistance,nextDistance;var startMove,endMove;var roundedStart,roundedEnd;var control1,control2;for(var index=0,n=route.length;index<n;index++){curr=new Point(route[index]);prev=route[index-1]||sourcePoint;next=route[index+1]||targetPoint;prevDistance=nextDistance||curr.distance(prev)/2;nextDistance=curr.distance(next)/2;startMove=-Math.min(offset,prevDistance);endMove=-Math.min(offset,nextDistance);roundedStart=curr.clone().move(prev,startMove).round();roundedEnd=curr.clone().move(next,endMove).round();control1=new Point(_13*roundedStart.x+_23*curr.x,_23*curr.y+_13*roundedStart.y);control2=new Point(_13*roundedEnd.x+_23*curr.x,_23*curr.y+_13*roundedEnd.y);segment=Path.createSegment('L',roundedStart);path.appendSegment(segment);segment=Path.createSegment('C',control1,control2,roundedEnd);path.appendSegment(segment);}segment=Path.createSegment('L',targetPoint);path.appendSegment(segment);return raw?path:path.serialize();};var smooth=function(sourcePoint,targetPoint,route,opt){var raw=opt&&opt.raw;var path;if(route&&route.length!==0){var points=[sourcePoint].concat(route).concat([targetPoint]);var curves=Curve.throughPoints(points);path=new Path(curves);}else{// if we have no route, use a default cubic bezier curve\n// cubic bezier requires two control points\n// the control points have `x` midway between source and target\n// this produces an S-like curve\npath=new Path();var segment;segment=Path.createSegment('M',sourcePoint);path.appendSegment(segment);if(Math.abs(sourcePoint.x-targetPoint.x)>=Math.abs(sourcePoint.y-targetPoint.y)){var controlPointX=(sourcePoint.x+targetPoint.x)/2;segment=Path.createSegment('C',controlPointX,sourcePoint.y,controlPointX,targetPoint.y,targetPoint.x,targetPoint.y);path.appendSegment(segment);}else{var controlPointY=(sourcePoint.y+targetPoint.y)/2;segment=Path.createSegment('C',sourcePoint.x,controlPointY,targetPoint.x,controlPointY,targetPoint.x,targetPoint.y);path.appendSegment(segment);}}return raw?path:path.serialize();};var Directions={AUTO:'auto',HORIZONTAL:'horizontal',VERTICAL:'vertical',CLOSEST_POINT:'closest-point',OUTWARDS:'outwards'};var TangentDirections={UP:'up',DOWN:'down',LEFT:'left',RIGHT:'right',AUTO:'auto',CLOSEST_POINT:'closest-point',OUTWARDS:'outwards'};var curve=function(sourcePoint,targetPoint,route,opt,linkView){if(route===void 0)route=[];if(opt===void 0)opt={};var raw=Boolean(opt.raw);// distanceCoefficient - a coefficient of the tangent vector length relative to the distance between points.\n// angleTangentCoefficient - a coefficient of the end tangents length in the case of angles larger than 45 degrees.\n// tension - a Catmull-Rom curve tension parameter.\n// sourceTangent - a tangent vector along the curve at the sourcePoint.\n// sourceDirection - a unit direction vector along the curve at the sourcePoint.\n// targetTangent - a tangent vector along the curve at the targetPoint.\n// targetDirection - a unit direction vector along the curve at the targetPoint.\n// precision - a rounding precision for path values.\nvar direction=opt.direction;if(direction===void 0)direction=Directions.AUTO;var precision=opt.precision;if(precision===void 0)precision=3;var options={coeff:opt.distanceCoefficient||0.6,angleTangentCoefficient:opt.angleTangentCoefficient||80,tau:opt.tension||0.5,sourceTangent:opt.sourceTangent?new Point(opt.sourceTangent):null,targetTangent:opt.targetTangent?new Point(opt.targetTangent):null};if(typeof opt.sourceDirection==='string'){options.sourceDirection=opt.sourceDirection;}else if(typeof opt.sourceDirection==='number'){options.sourceDirection=new Point(1,0).rotate(null,opt.sourceDirection);}else{options.sourceDirection=opt.sourceDirection?new Point(opt.sourceDirection).normalize():null;}if(typeof opt.targetDirection==='string'){options.targetDirection=opt.targetDirection;}else if(typeof opt.targetDirection==='number'){options.targetDirection=new Point(1,0).rotate(null,opt.targetDirection);}else{options.targetDirection=opt.targetDirection?new Point(opt.targetDirection).normalize():null;}var completeRoute=[sourcePoint].concat(route.map(function(p){return new Point(p);}),[targetPoint]);// The calculation of a sourceTangent\nvar sourceTangent;if(options.sourceTangent){sourceTangent=options.sourceTangent;}else{var sourceDirection=getSourceTangentDirection(linkView,completeRoute,direction,options);var tangentLength=completeRoute[0].distance(completeRoute[1])*options.coeff;var pointsVector=completeRoute[1].difference(completeRoute[0]).normalize();var angle=angleBetweenVectors(sourceDirection,pointsVector);if(angle>Math.PI/4){var updatedLength=tangentLength+(angle-Math.PI/4)*options.angleTangentCoefficient;sourceTangent=sourceDirection.clone().scale(updatedLength,updatedLength);}else{sourceTangent=sourceDirection.clone().scale(tangentLength,tangentLength);}}// The calculation of a targetTangent\nvar targetTangent;if(options.targetTangent){targetTangent=options.targetTangent;}else{var targetDirection=getTargetTangentDirection(linkView,completeRoute,direction,options);var last=completeRoute.length-1;var tangentLength$1=completeRoute[last-1].distance(completeRoute[last])*options.coeff;var pointsVector$1=completeRoute[last-1].difference(completeRoute[last]).normalize();var angle$1=angleBetweenVectors(targetDirection,pointsVector$1);if(angle$1>Math.PI/4){var updatedLength$1=tangentLength$1+(angle$1-Math.PI/4)*options.angleTangentCoefficient;targetTangent=targetDirection.clone().scale(updatedLength$1,updatedLength$1);}else{targetTangent=targetDirection.clone().scale(tangentLength$1,tangentLength$1);}}var catmullRomCurves=createCatmullRomCurves(completeRoute,sourceTangent,targetTangent,options);var bezierCurves=catmullRomCurves.map(function(curve){return catmullRomToBezier(curve,options);});var path=new Path(bezierCurves).round(precision);return raw?path:path.serialize();};curve.Directions=Directions;curve.TangentDirections=TangentDirections;function getHorizontalSourceDirection(linkView,route,options){var sourceBBox=linkView.sourceBBox;var sourceSide;if(!sourceBBox.width||!sourceBBox.height){if(sourceBBox.x>route[1].x){sourceSide='right';}else{sourceSide='left';}}else{sourceSide=sourceBBox.sideNearestToPoint(route[0]);}switch(sourceSide){case'left':return new Point(-1,0);case'right':default:return new Point(1,0);}}function getHorizontalTargetDirection(linkView,route,options){var targetBBox=linkView.targetBBox;var targetSide;if(!targetBBox.width||!targetBBox.height){if(targetBBox.x>route[route.length-2].x){targetSide='left';}else{targetSide='right';}}else{targetSide=targetBBox.sideNearestToPoint(route[route.length-1]);}switch(targetSide){case'left':return new Point(-1,0);case'right':default:return new Point(1,0);}}function getVerticalSourceDirection(linkView,route,options){var sourceBBox=linkView.sourceBBox;var sourceSide;if(!sourceBBox.width||!sourceBBox.height){if(sourceBBox.y>route[1].y){sourceSide='bottom';}else{sourceSide='top';}}else{sourceSide=sourceBBox.sideNearestToPoint(route[0]);}switch(sourceSide){case'top':return new Point(0,-1);case'bottom':default:return new Point(0,1);}}function getVerticalTargetDirection(linkView,route,options){var targetBBox=linkView.targetBBox;var targetSide;if(!targetBBox.width||!targetBBox.height){if(targetBBox.y>route[route.length-2].y){targetSide='top';}else{targetSide='bottom';}}else{targetSide=targetBBox.sideNearestToPoint(route[route.length-1]);}switch(targetSide){case'top':return new Point(0,-1);case'bottom':default:return new Point(0,1);}}function getAutoSourceDirection(linkView,route,options){var sourceBBox=linkView.sourceBBox;var sourceSide;if(!sourceBBox.width||!sourceBBox.height){sourceSide=sourceBBox.sideNearestToPoint(route[1]);}else{sourceSide=sourceBBox.sideNearestToPoint(route[0]);}switch(sourceSide){case'top':return new Point(0,-1);case'bottom':return new Point(0,1);case'right':return new Point(1,0);case'left':return new Point(-1,0);}}function getAutoTargetDirection(linkView,route,options){var targetBBox=linkView.targetBBox;var targetSide;if(!targetBBox.width||!targetBBox.height){targetSide=targetBBox.sideNearestToPoint(route[route.length-2]);}else{targetSide=targetBBox.sideNearestToPoint(route[route.length-1]);}switch(targetSide){case'top':return new Point(0,-1);case'bottom':return new Point(0,1);case'right':return new Point(1,0);case'left':return new Point(-1,0);}}function getClosestPointSourceDirection(linkView,route,options){return route[1].difference(route[0]).normalize();}function getClosestPointTargetDirection(linkView,route,options){var last=route.length-1;return route[last-1].difference(route[last]).normalize();}function getOutwardsSourceDirection(linkView,route,options){var sourceBBox=linkView.sourceBBox;var sourceCenter=sourceBBox.center();return route[0].difference(sourceCenter).normalize();}function getOutwardsTargetDirection(linkView,route,options){var targetBBox=linkView.targetBBox;var targetCenter=targetBBox.center();return route[route.length-1].difference(targetCenter).normalize();}function getSourceTangentDirection(linkView,route,direction,options){if(options.sourceDirection){switch(options.sourceDirection){case TangentDirections.UP:return new Point(0,-1);case TangentDirections.DOWN:return new Point(0,1);case TangentDirections.LEFT:return new Point(-1,0);case TangentDirections.RIGHT:return new Point(1,0);case TangentDirections.AUTO:return getAutoSourceDirection(linkView,route,options);case TangentDirections.CLOSEST_POINT:return getClosestPointSourceDirection(linkView,route,options);case TangentDirections.OUTWARDS:return getOutwardsSourceDirection(linkView,route,options);default:return options.sourceDirection;}}switch(direction){case Directions.HORIZONTAL:return getHorizontalSourceDirection(linkView,route,options);case Directions.VERTICAL:return getVerticalSourceDirection(linkView,route,options);case Directions.CLOSEST_POINT:return getClosestPointSourceDirection(linkView,route,options);case Directions.OUTWARDS:return getOutwardsSourceDirection(linkView,route,options);case Directions.AUTO:default:return getAutoSourceDirection(linkView,route,options);}}function getTargetTangentDirection(linkView,route,direction,options){if(options.targetDirection){switch(options.targetDirection){case TangentDirections.UP:return new Point(0,-1);case TangentDirections.DOWN:return new Point(0,1);case TangentDirections.LEFT:return new Point(-1,0);case TangentDirections.RIGHT:return new Point(0,1);case TangentDirections.AUTO:return getAutoTargetDirection(linkView,route,options);case TangentDirections.CLOSEST_POINT:return getClosestPointTargetDirection(linkView,route,options);case TangentDirections.OUTWARDS:return getOutwardsTargetDirection(linkView,route,options);default:return options.targetDirection;}}switch(direction){case Directions.HORIZONTAL:return getHorizontalTargetDirection(linkView,route,options);case Directions.VERTICAL:return getVerticalTargetDirection(linkView,route,options);case Directions.CLOSEST_POINT:return getClosestPointTargetDirection(linkView,route,options);case Directions.OUTWARDS:return getOutwardsTargetDirection(linkView,route,options);case Directions.AUTO:default:return getAutoTargetDirection(linkView,route,options);}}function rotateVector(vector,angle){var cos=Math.cos(angle);var sin=Math.sin(angle);var x=cos*vector.x-sin*vector.y;var y=sin*vector.x+cos*vector.y;vector.x=x;vector.y=y;}function angleBetweenVectors(v1,v2){var cos=v1.dot(v2)/(v1.magnitude()*v2.magnitude());if(cos<-1){cos=-1;}if(cos>1){cos=1;}return Math.acos(cos);}function determinant(v1,v2){return v1.x*v2.y-v1.y*v2.x;}function createCatmullRomCurves(points,sourceTangent,targetTangent,options){var tau=options.tau;var coeff=options.coeff;var distances=[];var tangents=[];var catmullRomCurves=[];var n=points.length-1;for(var i=0;i<n;i++){distances[i]=points[i].distance(points[i+1]);}tangents[0]=sourceTangent;tangents[n]=targetTangent;// The calculation of tangents of vertices\nfor(var i$1=1;i$1<n;i$1++){var tpPrev=void 0;var tpNext=void 0;if(i$1===1){tpPrev=points[i$1-1].clone().offset(tangents[i$1-1].x,tangents[i$1-1].y);}else{tpPrev=points[i$1-1].clone();}if(i$1===n-1){tpNext=points[i$1+1].clone().offset(tangents[i$1+1].x,tangents[i$1+1].y);}else{tpNext=points[i$1+1].clone();}var v1=tpPrev.difference(points[i$1]).normalize();var v2=tpNext.difference(points[i$1]).normalize();var vAngle=angleBetweenVectors(v1,v2);var rot=(Math.PI-vAngle)/2;var t=void 0;var vectorDeterminant=determinant(v1,v2);var pointsDeterminant=void 0;pointsDeterminant=determinant(points[i$1].difference(points[i$1+1]),points[i$1].difference(points[i$1-1]));if(vectorDeterminant<0){rot=-rot;}if(vAngle<Math.PI/2&&(rot<0&&pointsDeterminant<0||rot>0&&pointsDeterminant>0)){rot=rot-Math.PI;}t=v2.clone();rotateVector(t,rot);var t1=t.clone();var t2=t.clone();var scaleFactor1=distances[i$1-1]*coeff;var scaleFactor2=distances[i$1]*coeff;t1.scale(scaleFactor1,scaleFactor1);t2.scale(scaleFactor2,scaleFactor2);tangents[i$1]=[t1,t2];}// The building of a Catmull-Rom curve based of tangents of points\nfor(var i$2=0;i$2<n;i$2++){var p0=void 0;var p3=void 0;if(i$2===0){p0=points[i$2+1].difference(tangents[i$2].x/tau,tangents[i$2].y/tau);}else{p0=points[i$2+1].difference(tangents[i$2][1].x/tau,tangents[i$2][1].y/tau);}if(i$2===n-1){p3=points[i$2].clone().offset(tangents[i$2+1].x/tau,tangents[i$2+1].y/tau);}else{p3=points[i$2].difference(tangents[i$2+1][0].x/tau,tangents[i$2+1][0].y/tau);}catmullRomCurves[i$2]=[p0,points[i$2],points[i$2+1],p3];}return catmullRomCurves;}// The function to convert Catmull-Rom curve to Bezier curve using the tension (tau)\nfunction catmullRomToBezier(points,options){var tau=options.tau;var bcp1=new Point();bcp1.x=points[1].x+(points[2].x-points[0].x)/(6*tau);bcp1.y=points[1].y+(points[2].y-points[0].y)/(6*tau);var bcp2=new Point();bcp2.x=points[2].x+(points[3].x-points[1].x)/(6*tau);bcp2.y=points[2].y+(points[3].y-points[1].y)/(6*tau);return new Curve(points[1],bcp1,bcp2,points[2]);}var connectors={jumpover:jumpover,normal:normal$1,rounded:rounded,smooth:smooth,curve:curve};var Flags$1={RENDER:'RENDER',UPDATE:'UPDATE',TOOLS:'TOOLS',LEGACY_TOOLS:'LEGACY_TOOLS',LABELS:'LABELS',VERTICES:'VERTICES',SOURCE:'SOURCE',TARGET:'TARGET',CONNECTOR:'CONNECTOR'};// Link base view and controller.\n// ----------------------------------------\nvar LinkView=CellView.extend({className:function(){var classNames=CellView.prototype.className.apply(this).split(' ');classNames.push('link');return classNames.join(' ');},options:{shortLinkLength:105,doubleLinkTools:false,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,// deprecated\nmetrics:null,decimalsRounding:2,initialize:function(){CellView.prototype.initialize.apply(this,arguments);// `_.labelCache` is a mapping of indexes of labels in the `this.get('labels')` array to\n// `<g class=\"label\">` nodes wrapped by Vectorizer. This allows for quick access to the\n// nodes in `updateLabelPosition()` in order to update the label positions.\nthis._labelCache={};// a cache of label selectors\nthis._labelSelectors={};// keeps markers bboxes and positions again for quicker access\nthis._markerCache={};// cache of default markup nodes\nthis._V={};// connection path metrics\nthis.cleanNodesCache();},presentationAttributes:{markup:[Flags$1.RENDER],attrs:[Flags$1.UPDATE],router:[Flags$1.UPDATE],connector:[Flags$1.CONNECTOR],smooth:[Flags$1.UPDATE],manhattan:[Flags$1.UPDATE],toolMarkup:[Flags$1.LEGACY_TOOLS],labels:[Flags$1.LABELS],labelMarkup:[Flags$1.LABELS],vertices:[Flags$1.VERTICES,Flags$1.UPDATE],vertexMarkup:[Flags$1.VERTICES],source:[Flags$1.SOURCE,Flags$1.UPDATE],target:[Flags$1.TARGET,Flags$1.UPDATE]},initFlag:[Flags$1.RENDER,Flags$1.SOURCE,Flags$1.TARGET,Flags$1.TOOLS],UPDATE_PRIORITY:1,confirmUpdate:function(flags,opt){opt||(opt={});if(this.hasFlag(flags,Flags$1.SOURCE)){if(!this.updateEndProperties('source')){return flags;}flags=this.removeFlag(flags,Flags$1.SOURCE);}if(this.hasFlag(flags,Flags$1.TARGET)){if(!this.updateEndProperties('target')){return flags;}flags=this.removeFlag(flags,Flags$1.TARGET);}var ref=this;var paper=ref.paper;var sourceView=ref.sourceView;var targetView=ref.targetView;if(paper&&(sourceView&&!paper.isViewMounted(sourceView)||targetView&&!paper.isViewMounted(targetView))){// Wait for the sourceView and targetView to be rendered\nreturn flags;}if(this.hasFlag(flags,Flags$1.RENDER)){this.render();this.updateHighlighters(true);this.updateTools(opt);flags=this.removeFlag(flags,[Flags$1.RENDER,Flags$1.UPDATE,Flags$1.VERTICES,Flags$1.LABELS,Flags$1.TOOLS,Flags$1.LEGACY_TOOLS,Flags$1.CONNECTOR]);return flags;}var updateHighlighters=false;if(this.hasFlag(flags,Flags$1.VERTICES)){this.renderVertexMarkers();flags=this.removeFlag(flags,Flags$1.VERTICES);}var ref$1=this;var model=ref$1.model;var attributes=model.attributes;var updateLabels=this.hasFlag(flags,Flags$1.LABELS);var updateLegacyTools=this.hasFlag(flags,Flags$1.LEGACY_TOOLS);if(updateLabels){this.onLabelsChange(model,attributes.labels,opt);flags=this.removeFlag(flags,Flags$1.LABELS);updateHighlighters=true;}if(updateLegacyTools){this.renderTools();flags=this.removeFlag(flags,Flags$1.LEGACY_TOOLS);}var updateAll=this.hasFlag(flags,Flags$1.UPDATE);var updateConnector=this.hasFlag(flags,Flags$1.CONNECTOR);if(updateAll||updateConnector){if(!updateAll){// Keep the current route and update the geometry\nthis.updatePath();this.updateDOM();}else if(opt.translateBy&&model.isRelationshipEmbeddedIn(opt.translateBy)){// The link is being translated by an ancestor that will\n// shift source point, target point and all vertices\n// by an equal distance.\nthis.translate(opt.tx,opt.ty);}else{this.update();}this.updateTools(opt);flags=this.removeFlag(flags,[Flags$1.UPDATE,Flags$1.TOOLS,Flags$1.CONNECTOR]);updateLabels=false;updateLegacyTools=false;updateHighlighters=true;}if(updateLabels){this.updateLabelPositions();}if(updateLegacyTools){this.updateToolsPosition();}if(updateHighlighters){this.updateHighlighters();}if(this.hasFlag(flags,Flags$1.TOOLS)){this.updateTools(opt);flags=this.removeFlag(flags,Flags$1.TOOLS);}return flags;},requestConnectionUpdate:function(opt){this.requestUpdate(this.getFlag(Flags$1.UPDATE),opt);},isLabelsRenderRequired:function(opt){if(opt===void 0)opt={};var previousLabels=this.model.previous('labels');if(!previousLabels){return true;}// Here is an optimization for cases when we know, that change does\n// not require re-rendering of all labels.\nif('propertyPathArray'in opt&&'propertyValue'in opt){// The label is setting by `prop()` method\nvar pathArray=opt.propertyPathArray||[];var pathLength=pathArray.length;if(pathLength>1){// We are changing a single label here e.g. 'labels/0/position'\nvar labelExists=!!previousLabels[pathArray[1]];if(labelExists){if(pathLength===2){// We are changing the entire label. Need to check if the\n// markup is also being changed.\nreturn'markup'in Object(opt.propertyValue);}else if(pathArray[2]!=='markup'){// We are changing a label property but not the markup\nreturn false;}}}}return true;},onLabelsChange:function(_link,_labels,opt){// Note: this optimization works in async=false mode only\nif(this.isLabelsRenderRequired(opt)){this.renderLabels();}else{this.updateLabels();}},// Rendering.\n// ----------\nrender:function(){this.vel.empty();this.unmountLabels();this._V={};this.renderMarkup();// rendering labels has to be run after the link is appended to DOM tree. (otherwise <Text> bbox\n// returns zero values)\nthis.renderLabels();this.update();return this;},renderMarkup:function(){var link=this.model;var markup=link.get('markup')||link.markup;if(!markup){throw new Error('dia.LinkView: markup required');}if(Array.isArray(markup)){return this.renderJSONMarkup(markup);}if(typeof markup==='string'){return this.renderStringMarkup(markup);}throw new Error('dia.LinkView: invalid markup');},renderJSONMarkup:function(markup){var doc=this.parseDOMJSON(markup,this.el);// Selectors\nthis.selectors=doc.selectors;// Fragment\nthis.vel.append(doc.fragment);},renderStringMarkup:function(markup){// A special markup can be given in the `properties.markup` property. This might be handy\n// if e.g. arrowhead markers should be `<image>` elements or any other element than `<path>`s.\n// `.connection`, `.connection-wrap`, `.marker-source` and `.marker-target` selectors\n// of elements with special meaning though. Therefore, those classes should be preserved in any\n// special markup passed in `properties.markup`.\nvar children=V(markup);// custom markup may contain only one children\nif(!Array.isArray(children)){children=[children];}// Cache all children elements for quicker access.\nvar cache=this._V;// vectorized markup;\nfor(var i=0,n=children.length;i<n;i++){var child=children[i];var className=child.attr('class');if(className){// Strip the joint class name prefix, if there is one.\nclassName=removeClassNamePrefix(className);cache[$.camelCase(className)]=child;}}// partial rendering\nthis.renderTools();this.renderVertexMarkers();this.renderArrowheadMarkers();this.vel.append(children);},_getLabelMarkup:function(labelMarkup){if(!labelMarkup){return undefined;}if(Array.isArray(labelMarkup)){return this.parseDOMJSON(labelMarkup,null);}if(typeof labelMarkup==='string'){return this._getLabelStringMarkup(labelMarkup);}throw new Error('dia.linkView: invalid label markup');},_getLabelStringMarkup:function(labelMarkup){var children=V(labelMarkup);var fragment=document.createDocumentFragment();if(!Array.isArray(children)){fragment.appendChild(children.node);}else{for(var i=0,n=children.length;i<n;i++){var currentChild=children[i].node;fragment.appendChild(currentChild);}}return{fragment:fragment,selectors:{}};// no selectors\n},// Label markup fragment may come wrapped in <g class=\"label\" />, or not.\n// If it doesn't, add the <g /> container here.\n_normalizeLabelMarkup:function(markup){if(!markup){return undefined;}var fragment=markup.fragment;if(!(markup.fragment instanceof DocumentFragment)||!markup.fragment.hasChildNodes()){throw new Error('dia.LinkView: invalid label markup.');}var vNode;var childNodes=fragment.childNodes;if(childNodes.length>1||childNodes[0].nodeName.toUpperCase()!=='G'){// default markup fragment is not wrapped in <g />\n// add a <g /> container\nvNode=V('g').append(fragment);}else{vNode=V(childNodes[0]);}vNode.addClass('label');return{node:vNode.node,selectors:markup.selectors};},renderLabels:function(){var cache=this._V;var vLabels=cache.labels;var labelCache=this._labelCache={};var labelSelectors=this._labelSelectors={};var model=this.model;var labels=model.attributes.labels||[];var labelsCount=labels.length;if(labelsCount===0){if(vLabels){vLabels.remove();}return this;}if(vLabels){vLabels.empty();}else{// there is no label container in the markup but some labels are defined\n// add a <g class=\"labels\" /> container\nvLabels=cache.labels=V('g').addClass('labels');if(this.options.labelsLayer){vLabels.addClass(addClassNamePrefix(result(this,'className')));vLabels.attr('model-id',model.id);}}for(var i=0;i<labelsCount;i++){var label=labels[i];var labelMarkup=this._normalizeLabelMarkup(this._getLabelMarkup(label.markup));var labelNode;var selectors;if(labelMarkup){labelNode=labelMarkup.node;selectors=labelMarkup.selectors;}else{var builtinDefaultLabel=model._builtins.defaultLabel;var builtinDefaultLabelMarkup=this._normalizeLabelMarkup(this._getLabelMarkup(builtinDefaultLabel.markup));var defaultLabel=model._getDefaultLabel();var defaultLabelMarkup=this._normalizeLabelMarkup(this._getLabelMarkup(defaultLabel.markup));var defaultMarkup=defaultLabelMarkup||builtinDefaultLabelMarkup;labelNode=defaultMarkup.node;selectors=defaultMarkup.selectors;}labelNode.setAttribute('label-idx',i);// assign label-idx\nvLabels.append(labelNode);labelCache[i]=labelNode;// cache node for `updateLabels()` so it can just update label node positions\nvar rootSelector=this.selector;if(selectors[rootSelector]){throw new Error('dia.LinkView: ambiguous label root selector.');}selectors[rootSelector]=labelNode;labelSelectors[i]=selectors;// cache label selectors for `updateLabels()`\n}if(!vLabels.parent()){this.mountLabels();}this.updateLabels();return this;},mountLabels:function(){var ref=this;var el=ref.el;var paper=ref.paper;var model=ref.model;var _V=ref._V;var options=ref.options;var vLabels=_V.labels;if(!vLabels||!model.hasLabels()){return;}var node=vLabels.node;if(options.labelsLayer){paper.getLayerView(options.labelsLayer).insertSortedNode(node,model.get('z'));}else{if(node.parentNode!==el){el.appendChild(node);}}},unmountLabels:function(){var ref=this;var options=ref.options;var _V=ref._V;if(!_V){return;}var vLabels=_V.labels;if(vLabels&&options.labelsLayer){vLabels.remove();}},onMount:function(){this.mountLabels();},unmount:function(){CellView.prototype.unmount.apply(this,arguments);this.unmountLabels();},findLabelNode:function(labelIndex,selector){var labelRoot=this._labelCache[labelIndex];if(!labelRoot){return null;}var labelSelectors=this._labelSelectors[labelIndex];var ref=this.findBySelector(selector,labelRoot,labelSelectors);var node=ref[0];if(node===void 0)node=null;return node;},// merge default label attrs into label attrs\n// keep `undefined` or `null` because `{}` means something else\n_mergeLabelAttrs:function(hasCustomMarkup,labelAttrs,defaultLabelAttrs,builtinDefaultLabelAttrs){if(labelAttrs===null){return null;}if(labelAttrs===undefined){if(defaultLabelAttrs===null){return null;}if(defaultLabelAttrs===undefined){if(hasCustomMarkup){return undefined;}return builtinDefaultLabelAttrs;}if(hasCustomMarkup){return defaultLabelAttrs;}return merge({},builtinDefaultLabelAttrs,defaultLabelAttrs);}if(hasCustomMarkup){return merge({},defaultLabelAttrs,labelAttrs);}return merge({},builtinDefaultLabelAttrs,defaultLabelAttrs,labelAttrs);},updateLabels:function(){if(!this._V.labels){return this;}var model=this.model;var labels=model.get('labels')||[];var canLabelMove=this.can('labelMove');var builtinDefaultLabel=model._builtins.defaultLabel;var builtinDefaultLabelAttrs=builtinDefaultLabel.attrs;var defaultLabel=model._getDefaultLabel();var defaultLabelMarkup=defaultLabel.markup;var defaultLabelAttrs=defaultLabel.attrs;for(var i=0,n=labels.length;i<n;i++){var labelNode=this._labelCache[i];labelNode.setAttribute('cursor',canLabelMove?'move':'default');var selectors=this._labelSelectors[i];var label=labels[i];var labelMarkup=label.markup;var labelAttrs=label.attrs;var attrs=this._mergeLabelAttrs(labelMarkup||defaultLabelMarkup,labelAttrs,defaultLabelAttrs,builtinDefaultLabelAttrs);this.updateDOMSubtreeAttributes(labelNode,attrs,{rootBBox:new Rect(label.size),selectors:selectors});}return this;},renderTools:function(){if(!this._V.linkTools){return this;}// Tools are a group of clickable elements that manipulate the whole link.\n// A good example of this is the remove tool that removes the whole link.\n// Tools appear after hovering the link close to the `source` element/point of the link\n// but are offset a bit so that they don't cover the `marker-arrowhead`.\nvar $tools=$(this._V.linkTools.node).empty();var toolTemplate=template(this.model.get('toolMarkup')||this.model.toolMarkup);var tool=V(toolTemplate());$tools.append(tool.node);// Cache the tool node so that the `updateToolsPosition()` can update the tool position quickly.\nthis._toolCache=tool;// If `doubleLinkTools` is enabled, we render copy of the tools on the other side of the\n// link as well but only if the link is longer than `longLinkLength`.\nif(this.options.doubleLinkTools){var tool2;if(this.model.get('doubleToolMarkup')||this.model.doubleToolMarkup){toolTemplate=template(this.model.get('doubleToolMarkup')||this.model.doubleToolMarkup);tool2=V(toolTemplate());}else{tool2=tool.clone();}$tools.append(tool2.node);this._tool2Cache=tool2;}return this;},renderVertexMarkers:function(){if(!this._V.markerVertices){return this;}var $markerVertices=$(this._V.markerVertices.node).empty();// A special markup can be given in the `properties.vertexMarkup` property. This might be handy\n// if default styling (elements) are not desired. This makes it possible to use any\n// SVG elements for .marker-vertex and .marker-vertex-remove tools.\nvar markupTemplate=template(this.model.get('vertexMarkup')||this.model.vertexMarkup);this.model.vertices().forEach(function(vertex,idx){$markerVertices.append(V(markupTemplate(assign({idx:idx},vertex))).node);});return this;},renderArrowheadMarkers:function(){// Custom markups might not have arrowhead markers. Therefore, jump of this function immediately if that's the case.\nif(!this._V.markerArrowheads){return this;}var $markerArrowheads=$(this._V.markerArrowheads.node);$markerArrowheads.empty();// A special markup can be given in the `properties.vertexMarkup` property. This might be handy\n// if default styling (elements) are not desired. This makes it possible to use any\n// SVG elements for .marker-vertex and .marker-vertex-remove tools.\nvar markupTemplate=template(this.model.get('arrowheadMarkup')||this.model.arrowheadMarkup);this._V.sourceArrowhead=V(markupTemplate({end:'source'}));this._V.targetArrowhead=V(markupTemplate({end:'target'}));$markerArrowheads.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node);return this;},// remove vertices that lie on (or nearly on) straight lines within the link\n// return the number of removed points\nremoveRedundantLinearVertices:function(opt){var SIMPLIFY_THRESHOLD=0.001;var link=this.model;var vertices=link.vertices();var routePoints=[this.sourceAnchor].concat(vertices,[this.targetAnchor]);var numRoutePoints=routePoints.length;// put routePoints into a polyline and try to simplify\nvar polyline=new Polyline(routePoints);polyline.simplify({threshold:SIMPLIFY_THRESHOLD});var polylinePoints=polyline.points.map(function(point){return point.toJSON();});// JSON of points after simplification\nvar numPolylinePoints=polylinePoints.length;// number of points after simplification\n// shortcut if simplification did not remove any redundant vertices:\nif(numRoutePoints===numPolylinePoints){return 0;}// else: set simplified polyline points as link vertices\n// remove first and last polyline points again (= source/target anchors)\nlink.vertices(polylinePoints.slice(1,numPolylinePoints-1),opt);return numRoutePoints-numPolylinePoints;},updateDefaultConnectionPath:function(){var cache=this._V;if(cache.connection){cache.connection.attr('d',this.getSerializedConnection());}if(cache.connectionWrap){cache.connectionWrap.attr('d',this.getSerializedConnection());}if(cache.markerSource&&cache.markerTarget){this._translateAndAutoOrientArrows(cache.markerSource,cache.markerTarget);}},getEndView:function(type){switch(type){case'source':return this.sourceView||null;case'target':return this.targetView||null;default:throw new Error('dia.LinkView: type parameter required.');}},getEndAnchor:function(type){switch(type){case'source':return new Point(this.sourceAnchor);case'target':return new Point(this.targetAnchor);default:throw new Error('dia.LinkView: type parameter required.');}},getEndConnectionPoint:function(type){switch(type){case'source':return new Point(this.sourcePoint);case'target':return new Point(this.targetPoint);default:throw new Error('dia.LinkView: type parameter required.');}},getEndMagnet:function(type){switch(type){case'source':var sourceView=this.sourceView;if(!sourceView){break;}return this.sourceMagnet||sourceView.el;case'target':var targetView=this.targetView;if(!targetView){break;}return this.targetMagnet||targetView.el;default:throw new Error('dia.LinkView: type parameter required.');}return null;},// Updating.\n// ---------\nupdate:function(){this.updateRoute();this.updatePath();this.updateDOM();return this;},translate:function(tx,ty){if(tx===void 0)tx=0;if(ty===void 0)ty=0;var ref=this;var route=ref.route;var path=ref.path;if(!route||!path){return;}// translate the route\nvar polyline=new Polyline(route);polyline.translate(tx,ty);this.route=polyline.points;// translate source and target connection and marker points.\nthis._translateConnectionPoints(tx,ty);// translate the geometry path\npath.translate(tx,ty);this.updateDOM();},updateDOM:function updateDOM(){var ref=this;var el=ref.el;var model=ref.model;var selectors=ref.selectors;this.cleanNodesCache();// update SVG attributes defined by 'attrs/'.\nthis.updateDOMSubtreeAttributes(el,model.attr(),{selectors:selectors});// legacy link path update\nthis.updateDefaultConnectionPath();// update the label position etc.\nthis.updateLabelPositions();this.updateToolsPosition();this.updateArrowheadMarkers();// *Deprecated*\n// Local perpendicular flag (as opposed to one defined on paper).\n// Could be enabled inside a connector/router. It's valid only\n// during the update execution.\nthis.options.perpendicular=null;},updateRoute:function(){var ref=this;var model=ref.model;var vertices=model.vertices();// 1. Find Anchors\nvar anchors=this.findAnchors(vertices);var sourceAnchor=this.sourceAnchor=anchors.source;var targetAnchor=this.targetAnchor=anchors.target;// 2. Find Route\nvar route=this.findRoute(vertices);this.route=route;// 3. Find Connection Points\nvar connectionPoints=this.findConnectionPoints(route,sourceAnchor,targetAnchor);this.sourcePoint=connectionPoints.source;this.targetPoint=connectionPoints.target;},updatePath:function(){var ref=this;var route=ref.route;var sourcePoint=ref.sourcePoint;var targetPoint=ref.targetPoint;// 3b. Find Marker Connection Point - Backwards Compatibility\nvar markerPoints=this.findMarkerPoints(route,sourcePoint,targetPoint);// 4. Find Connection\nvar path=this.findPath(route,markerPoints.source||sourcePoint,markerPoints.target||targetPoint);this.path=path;},findMarkerPoints:function(route,sourcePoint,targetPoint){var firstWaypoint=route[0];var lastWaypoint=route[route.length-1];// Move the source point by the width of the marker taking into account\n// its scale around x-axis. Note that scale is the only transform that\n// makes sense to be set in `.marker-source` attributes object\n// as all other transforms (translate/rotate) will be replaced\n// by the `translateAndAutoOrient()` function.\nvar cache=this._markerCache;// cache source and target points\nvar sourceMarkerPoint,targetMarkerPoint;if(this._V.markerSource){cache.sourceBBox=cache.sourceBBox||this._V.markerSource.getBBox();sourceMarkerPoint=Point(sourcePoint).move(firstWaypoint||targetPoint,cache.sourceBBox.width*this._V.markerSource.scale().sx*-1).round();}if(this._V.markerTarget){cache.targetBBox=cache.targetBBox||this._V.markerTarget.getBBox();targetMarkerPoint=Point(targetPoint).move(lastWaypoint||sourcePoint,cache.targetBBox.width*this._V.markerTarget.scale().sx*-1).round();}// if there was no markup for the marker, use the connection point.\ncache.sourcePoint=sourceMarkerPoint||sourcePoint.clone();cache.targetPoint=targetMarkerPoint||targetPoint.clone();return{source:sourceMarkerPoint,target:targetMarkerPoint};},findAnchorsOrdered:function(firstEndType,firstRef,secondEndType,secondRef){var firstAnchor,secondAnchor;var firstAnchorRef,secondAnchorRef;var model=this.model;var firstDef=model.get(firstEndType);var secondDef=model.get(secondEndType);var firstView=this.getEndView(firstEndType);var secondView=this.getEndView(secondEndType);var firstMagnet=this.getEndMagnet(firstEndType);var secondMagnet=this.getEndMagnet(secondEndType);// Anchor first\nif(firstView){if(firstRef){firstAnchorRef=new Point(firstRef);}else if(secondView){firstAnchorRef=secondMagnet;}else{firstAnchorRef=new Point(secondDef);}firstAnchor=this.getAnchor(firstDef.anchor,firstView,firstMagnet,firstAnchorRef,firstEndType);}else{firstAnchor=new Point(firstDef);}// Anchor second\nif(secondView){secondAnchorRef=new Point(secondRef||firstAnchor);secondAnchor=this.getAnchor(secondDef.anchor,secondView,secondMagnet,secondAnchorRef,secondEndType);}else{secondAnchor=new Point(secondDef);}var res={};res[firstEndType]=firstAnchor;res[secondEndType]=secondAnchor;return res;},findAnchors:function(vertices){var model=this.model;var firstVertex=vertices[0];var lastVertex=vertices[vertices.length-1];if(model.target().priority&&!model.source().priority){// Reversed order\nreturn this.findAnchorsOrdered('target',lastVertex,'source',firstVertex);}// Usual order\nreturn this.findAnchorsOrdered('source',firstVertex,'target',lastVertex);},findConnectionPoints:function(route,sourceAnchor,targetAnchor){var firstWaypoint=route[0];var lastWaypoint=route[route.length-1];var model=this.model;var sourceDef=model.get('source');var targetDef=model.get('target');var sourceView=this.sourceView;var targetView=this.targetView;var paperOptions=this.paper.options;var sourceMagnet,targetMagnet;// Connection Point Source\nvar sourcePoint;if(sourceView&&!sourceView.isNodeConnection(this.sourceMagnet)){sourceMagnet=this.sourceMagnet||sourceView.el;var sourceConnectionPointDef=sourceDef.connectionPoint||paperOptions.defaultConnectionPoint;var sourcePointRef=firstWaypoint||targetAnchor;var sourceLine=new Line(sourcePointRef,sourceAnchor);sourcePoint=this.getConnectionPoint(sourceConnectionPointDef,sourceView,sourceMagnet,sourceLine,'source');}else{sourcePoint=sourceAnchor;}// Connection Point Target\nvar targetPoint;if(targetView&&!targetView.isNodeConnection(this.targetMagnet)){targetMagnet=this.targetMagnet||targetView.el;var targetConnectionPointDef=targetDef.connectionPoint||paperOptions.defaultConnectionPoint;var targetPointRef=lastWaypoint||sourceAnchor;var targetLine=new Line(targetPointRef,targetAnchor);targetPoint=this.getConnectionPoint(targetConnectionPointDef,targetView,targetMagnet,targetLine,'target');}else{targetPoint=targetAnchor;}return{source:sourcePoint,target:targetPoint};},getAnchor:function(anchorDef,cellView,magnet,ref,endType){var isConnection=cellView.isNodeConnection(magnet);var paperOptions=this.paper.options;if(!anchorDef){if(isConnection){anchorDef=paperOptions.defaultLinkAnchor;}else{if(paperOptions.perpendicularLinks||this.options.perpendicular){// Backwards compatibility\n// If `perpendicularLinks` flag is set on the paper and there are vertices\n// on the link, then try to find a connection point that makes the link perpendicular\n// even though the link won't point to the center of the targeted object.\nanchorDef={name:'perpendicular'};}else{anchorDef=paperOptions.defaultAnchor;}}}if(!anchorDef){throw new Error('Anchor required.');}var anchorFn;if(typeof anchorDef==='function'){anchorFn=anchorDef;}else{var anchorName=anchorDef.name;var anchorNamespace=isConnection?'linkAnchorNamespace':'anchorNamespace';anchorFn=paperOptions[anchorNamespace][anchorName];if(typeof anchorFn!=='function'){throw new Error('Unknown anchor: '+anchorName);}}var anchor=anchorFn.call(this,cellView,magnet,ref,anchorDef.args||{},endType,this);if(!anchor){return new Point();}return anchor.round(this.decimalsRounding);},getConnectionPoint:function(connectionPointDef,view,magnet,line,endType){var connectionPoint;var anchor=line.end;var paperOptions=this.paper.options;// Backwards compatibility\nif(typeof paperOptions.linkConnectionPoint==='function'){var linkConnectionMagnet=magnet===view.el?undefined:magnet;connectionPoint=paperOptions.linkConnectionPoint(this,view,linkConnectionMagnet,line.start,endType);if(connectionPoint){return connectionPoint;}}if(!connectionPointDef){return anchor;}var connectionPointFn;if(typeof connectionPointDef==='function'){connectionPointFn=connectionPointDef;}else{var connectionPointName=connectionPointDef.name;connectionPointFn=paperOptions.connectionPointNamespace[connectionPointName];if(typeof connectionPointFn!=='function'){throw new Error('Unknown connection point: '+connectionPointName);}}connectionPoint=connectionPointFn.call(this,line,view,magnet,connectionPointDef.args||{},endType,this);if(!connectionPoint){return anchor;}return connectionPoint.round(this.decimalsRounding);},_translateConnectionPoints:function(tx,ty){var cache=this._markerCache;cache.sourcePoint.offset(tx,ty);cache.targetPoint.offset(tx,ty);this.sourcePoint.offset(tx,ty);this.targetPoint.offset(tx,ty);this.sourceAnchor.offset(tx,ty);this.targetAnchor.offset(tx,ty);},// if label position is a number, normalize it to a position object\n// this makes sure that label positions can be merged properly\n_normalizeLabelPosition:function(labelPosition){if(typeof labelPosition==='number'){return{distance:labelPosition,offset:null,angle:0,args:null};}return labelPosition;},updateLabelPositions:function(){if(!this._V.labels){return this;}var path=this.path;if(!path){return this;}// This method assumes all the label nodes are stored in the `this._labelCache` hash table\n// by their indices in the `this.get('labels')` array. This is done in the `renderLabels()` method.\nvar model=this.model;var labels=model.get('labels')||[];if(!labels.length){return this;}var builtinDefaultLabel=model._builtins.defaultLabel;var builtinDefaultLabelPosition=builtinDefaultLabel.position;var defaultLabel=model._getDefaultLabel();var defaultLabelPosition=this._normalizeLabelPosition(defaultLabel.position);var defaultPosition=merge({},builtinDefaultLabelPosition,defaultLabelPosition);for(var idx=0,n=labels.length;idx<n;idx++){var labelNode=this._labelCache[idx];if(!labelNode){continue;}var label=labels[idx];var labelPosition=this._normalizeLabelPosition(label.position);var position=merge({},defaultPosition,labelPosition);var transformationMatrix=this._getLabelTransformationMatrix(position);labelNode.setAttribute('transform',V.matrixToTransformString(transformationMatrix));this._cleanLabelMatrices(idx);}return this;},_cleanLabelMatrices:function(index){// Clean magnetMatrix for all nodes of the label.\n// Cached BoundingRect does not need to updated when the position changes\n// TODO: this doesn't work for labels with XML String markups.\nvar ref=this;var metrics=ref.metrics;var _labelSelectors=ref._labelSelectors;var selectors=_labelSelectors[index];if(!selectors){return;}for(var selector in selectors){var ref$1=selectors[selector];var id=ref$1.id;if(id&&id in metrics){delete metrics[id].magnetMatrix;}}},updateToolsPosition:function(){if(!this._V.linkTools){return this;}// Move the tools a bit to the target position but don't cover the `sourceArrowhead` marker.\n// Note that the offset is hardcoded here. The offset should be always\n// more than the `this.$('.marker-arrowhead[end=\"source\"]')[0].bbox().width` but looking\n// this up all the time would be slow.\nvar scale='';var offset=this.options.linkToolsOffset;var connectionLength=this.getConnectionLength();// Firefox returns connectionLength=NaN in odd cases (for bezier curves).\n// In that case we won't update tools position at all.\nif(!Number.isNaN(connectionLength)){// If the link is too short, make the tools half the size and the offset twice as low.\nif(connectionLength<this.options.shortLinkLength){scale='scale(.5)';offset/=2;}var toolPosition=this.getPointAtLength(offset);this._toolCache.attr('transform','translate('+toolPosition.x+', '+toolPosition.y+') '+scale);if(this.options.doubleLinkTools&&connectionLength>=this.options.longLinkLength){var doubleLinkToolsOffset=this.options.doubleLinkToolsOffset||offset;toolPosition=this.getPointAtLength(connectionLength-doubleLinkToolsOffset);this._tool2Cache.attr('transform','translate('+toolPosition.x+', '+toolPosition.y+') '+scale);this._tool2Cache.attr('visibility','visible');}else if(this.options.doubleLinkTools){this._tool2Cache.attr('visibility','hidden');}}return this;},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads){return this;}// getting bbox of an element with `display=\"none\"` in IE9 ends up with access violation\nif($.css(this._V.markerArrowheads.node,'display')==='none'){return this;}var sx=this.getConnectionLength()<this.options.shortLinkLength?.5:1;this._V.sourceArrowhead.scale(sx);this._V.targetArrowhead.scale(sx);this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead);return this;},updateEndProperties:function(endType){var ref=this;var model=ref.model;var paper=ref.paper;var endViewProperty=endType+\"View\";var endDef=model.get(endType);var endId=endDef&&endDef.id;if(!endId){// the link end is a point ~ rect 0x0\nthis[endViewProperty]=null;this.updateEndMagnet(endType);return true;}var endModel=paper.getModelById(endId);if(!endModel){throw new Error('LinkView: invalid '+endType+' cell.');}var endView=endModel.findView(paper);if(!endView){// A view for a model should always exist\nreturn false;}this[endViewProperty]=endView;this.updateEndMagnet(endType);return true;},updateEndMagnet:function(endType){var endMagnetProperty=endType+\"Magnet\";var endView=this.getEndView(endType);if(endView){var connectedMagnet=endView.getMagnetFromLinkEnd(this.model.get(endType));if(connectedMagnet===endView.el){connectedMagnet=null;}this[endMagnetProperty]=connectedMagnet;}else{this[endMagnetProperty]=null;}},_translateAndAutoOrientArrows:function(sourceArrow,targetArrow){// Make the markers \"point\" to their sticky points being auto-oriented towards\n// `targetPosition`/`sourcePosition`. And do so only if there is a markup for them.\nvar route=toArray(this.route);if(sourceArrow){sourceArrow.translateAndAutoOrient(this.sourcePoint,route[0]||this.targetPoint,this.paper.cells);}if(targetArrow){targetArrow.translateAndAutoOrient(this.targetPoint,route[route.length-1]||this.sourcePoint,this.paper.cells);}},_getLabelPositionAngle:function(idx){var labelPosition=this.model.label(idx).position||{};return labelPosition.angle||0;},_getLabelPositionArgs:function(idx){var labelPosition=this.model.label(idx).position||{};return labelPosition.args;},_getDefaultLabelPositionArgs:function(){var defaultLabel=this.model._getDefaultLabel();var defaultLabelPosition=defaultLabel.position||{};return defaultLabelPosition.args;},// merge default label position args into label position args\n// keep `undefined` or `null` because `{}` means something else\n_mergeLabelPositionArgs:function(labelPositionArgs,defaultLabelPositionArgs){if(labelPositionArgs===null){return null;}if(labelPositionArgs===undefined){if(defaultLabelPositionArgs===null){return null;}return defaultLabelPositionArgs;}return merge({},defaultLabelPositionArgs,labelPositionArgs);},// Add default label at given position at end of `labels` array.\n// Four signatures:\n// - obj, obj = point, opt\n// - obj, num, obj = point, angle, opt\n// - num, num, obj = x, y, opt\n// - num, num, num, obj = x, y, angle, opt\n// Assigns relative coordinates by default:\n// `opt.absoluteDistance` forces absolute coordinates.\n// `opt.reverseDistance` forces reverse absolute coordinates (if absoluteDistance = true).\n// `opt.absoluteOffset` forces absolute coordinates for offset.\n// Additional args:\n// `opt.keepGradient` auto-adjusts the angle of the label to match path gradient at position.\n// `opt.ensureLegibility` rotates labels so they are never upside-down.\naddLabel:function(p1,p2,p3,p4){// normalize data from the four possible signatures\nvar localX;var localY;var localAngle=0;var localOpt;if(typeof p1!=='number'){// {x, y} object provided as first parameter\nlocalX=p1.x;localY=p1.y;if(typeof p2==='number'){// angle and opt provided as second and third parameters\nlocalAngle=p2;localOpt=p3;}else{// opt provided as second parameter\nlocalOpt=p2;}}else{// x and y provided as first and second parameters\nlocalX=p1;localY=p2;if(typeof p3==='number'){// angle and opt provided as third and fourth parameters\nlocalAngle=p3;localOpt=p4;}else{// opt provided as third parameter\nlocalOpt=p3;}}// merge label position arguments\nvar defaultLabelPositionArgs=this._getDefaultLabelPositionArgs();var labelPositionArgs=localOpt;var positionArgs=this._mergeLabelPositionArgs(labelPositionArgs,defaultLabelPositionArgs);// append label to labels array\nvar label={position:this.getLabelPosition(localX,localY,localAngle,positionArgs)};var idx=-1;this.model.insertLabel(idx,label,localOpt);return idx;},// Add a new vertex at calculated index to the `vertices` array.\naddVertex:function(x,y,opt){// accept input in form `{ x, y }, opt` or `x, y, opt`\nvar isPointProvided=typeof x!=='number';var localX=isPointProvided?x.x:x;var localY=isPointProvided?x.y:y;var localOpt=isPointProvided?y:opt;var vertex={x:localX,y:localY};var idx=this.getVertexIndex(localX,localY);this.model.insertVertex(idx,vertex,localOpt);return idx;},// Send a token (an SVG element, usually a circle) along the connection path.\n// Example: `link.findView(paper).sendToken(V('circle', { r: 7, fill: 'green' }).node)`\n// `opt.duration` is optional and is a time in milliseconds that the token travels from the source to the target of the link. Default is `1000`.\n// `opt.directon` is optional and it determines whether the token goes from source to target or other way round (`reverse`)\n// `opt.connection` is an optional selector to the connection path.\n// `callback` is optional and is a function to be called once the token reaches the target.\nsendToken:function(token,opt,callback){function onAnimationEnd(vToken,callback){return function(){vToken.remove();if(typeof callback==='function'){callback();}};}var duration,isReversed,selector;if(isObject$1(opt)){duration=opt.duration;isReversed=opt.direction==='reverse';selector=opt.connection;}else{// Backwards compatibility\nduration=opt;isReversed=false;selector=null;}duration=duration||1000;var animationAttributes={dur:duration+'ms',repeatCount:1,calcMode:'linear',fill:'freeze'};if(isReversed){animationAttributes.keyPoints='1;0';animationAttributes.keyTimes='0;1';}var vToken=V(token);var connection;if(typeof selector==='string'){// Use custom connection path.\nconnection=this.findBySelector(selector,this.el,this.selectors)[0];}else{// Select connection path automatically.\nvar cache=this._V;connection=cache.connection?cache.connection.node:this.el.querySelector('path');}if(!(connection instanceof SVGPathElement)){throw new Error('dia.LinkView: token animation requires a valid connection path.');}vToken.appendTo(this.paper.cells).animateAlongPath(animationAttributes,connection);setTimeout(onAnimationEnd(vToken,callback),duration);},findRoute:function(vertices){vertices||(vertices=[]);var namespace=this.paper.options.routerNamespace||routers;var router=this.model.router();var defaultRouter=this.paper.options.defaultRouter;if(!router){if(defaultRouter){router=defaultRouter;}else{return vertices.map(Point);}// no router specified\n}var routerFn=isFunction(router)?router:namespace[router.name];if(!isFunction(routerFn)){throw new Error('dia.LinkView: unknown router: \"'+router.name+'\".');}var args=router.args||{};var route=routerFn.call(this,// context\nvertices,// vertices\nargs,// options\nthis// linkView\n);if(!route){return vertices.map(Point);}return route;},// Return the `d` attribute value of the `<path>` element representing the link\n// between `source` and `target`.\nfindPath:function(route,sourcePoint,targetPoint){var namespace=this.paper.options.connectorNamespace||connectors;var connector=this.model.connector();var defaultConnector=this.paper.options.defaultConnector;if(!connector){connector=defaultConnector||{};}var connectorFn=isFunction(connector)?connector:namespace[connector.name];if(!isFunction(connectorFn)){throw new Error('dia.LinkView: unknown connector: \"'+connector.name+'\".');}var args=clone(connector.args||{});args.raw=true;// Request raw g.Path as the result.\nvar path=connectorFn.call(this,// context\nsourcePoint,// start point\ntargetPoint,// end point\nroute,// vertices\nargs,// options\nthis// linkView\n);if(typeof path==='string'){// Backwards compatibility for connectors not supporting `raw` option.\npath=new Path(V.normalizePathData(path));}return path;},// Public API.\n// -----------\ngetConnection:function(){var path=this.path;if(!path){return null;}return path.clone();},getSerializedConnection:function(){var path=this.path;if(!path){return null;}var metrics=this.metrics;if(metrics.hasOwnProperty('data')){return metrics.data;}var data=path.serialize();metrics.data=data;return data;},getConnectionSubdivisions:function(){var path=this.path;if(!path){return null;}var metrics=this.metrics;if(metrics.hasOwnProperty('segmentSubdivisions')){return metrics.segmentSubdivisions;}var subdivisions=path.getSegmentSubdivisions();metrics.segmentSubdivisions=subdivisions;return subdivisions;},getConnectionLength:function(){var path=this.path;if(!path){return 0;}var metrics=this.metrics;if(metrics.hasOwnProperty('length')){return metrics.length;}var length=path.length({segmentSubdivisions:this.getConnectionSubdivisions()});metrics.length=length;return length;},getPointAtLength:function(length){var path=this.path;if(!path){return null;}return path.pointAtLength(length,{segmentSubdivisions:this.getConnectionSubdivisions()});},getPointAtRatio:function(ratio){var path=this.path;if(!path){return null;}if(isPercentage(ratio)){ratio=parseFloat(ratio)/100;}return path.pointAt(ratio,{segmentSubdivisions:this.getConnectionSubdivisions()});},getTangentAtLength:function(length){var path=this.path;if(!path){return null;}return path.tangentAtLength(length,{segmentSubdivisions:this.getConnectionSubdivisions()});},getTangentAtRatio:function(ratio){var path=this.path;if(!path){return null;}return path.tangentAt(ratio,{segmentSubdivisions:this.getConnectionSubdivisions()});},getClosestPoint:function(point){var path=this.path;if(!path){return null;}return path.closestPoint(point,{segmentSubdivisions:this.getConnectionSubdivisions()});},getClosestPointLength:function(point){var path=this.path;if(!path){return null;}return path.closestPointLength(point,{segmentSubdivisions:this.getConnectionSubdivisions()});},getClosestPointRatio:function(point){var path=this.path;if(!path){return null;}return path.closestPointNormalizedLength(point,{segmentSubdivisions:this.getConnectionSubdivisions()});},// Get label position object based on two provided coordinates, x and y.\n// (Used behind the scenes when user moves labels around.)\n// Two signatures:\n// - num, num, obj = x, y, options\n// - num, num, num, obj = x, y, angle, options\n// Accepts distance/offset options = `absoluteDistance: boolean`, `reverseDistance: boolean`, `absoluteOffset: boolean`\n// - `absoluteOffset` is necessary in order to move beyond connection endpoints\n// Additional options = `keepGradient: boolean`, `ensureLegibility: boolean`\ngetLabelPosition:function(x,y,p3,p4){var position={};// normalize data from the two possible signatures\nvar localAngle=0;var localOpt;if(typeof p3==='number'){// angle and opt provided as third and fourth argument\nlocalAngle=p3;localOpt=p4;}else{// opt provided as third argument\nlocalOpt=p3;}// save localOpt as `args` of the position object that is passed along\nif(localOpt){position.args=localOpt;}// identify distance/offset settings\nvar isDistanceRelative=!(localOpt&&localOpt.absoluteDistance);// relative by default\nvar isDistanceAbsoluteReverse=localOpt&&localOpt.absoluteDistance&&localOpt.reverseDistance;// non-reverse by default\nvar isOffsetAbsolute=localOpt&&localOpt.absoluteOffset;// offset is non-absolute by default\n// find closest point t\nvar path=this.path;var pathOpt={segmentSubdivisions:this.getConnectionSubdivisions()};var labelPoint=new Point(x,y);var t=path.closestPointT(labelPoint,pathOpt);// DISTANCE:\nvar labelDistance=path.lengthAtT(t,pathOpt);if(isDistanceRelative){labelDistance=labelDistance/this.getConnectionLength()||0;}// fix to prevent NaN for 0 length\nif(isDistanceAbsoluteReverse){labelDistance=-1*(this.getConnectionLength()-labelDistance)||1;}// fix for end point (-0 => 1)\nposition.distance=labelDistance;// OFFSET:\n// use absolute offset if:\n// - opt.absoluteOffset is true,\n// - opt.absoluteOffset is not true but there is no tangent\nvar tangent;if(!isOffsetAbsolute){tangent=path.tangentAtT(t);}var labelOffset;if(tangent){labelOffset=tangent.pointOffset(labelPoint);}else{var closestPoint=path.pointAtT(t);var labelOffsetDiff=labelPoint.difference(closestPoint);labelOffset={x:labelOffsetDiff.x,y:labelOffsetDiff.y};}position.offset=labelOffset;// ANGLE:\nposition.angle=localAngle;return position;},_getLabelTransformationMatrix:function(labelPosition){var labelDistance;var labelAngle=0;var args={};if(typeof labelPosition==='number'){labelDistance=labelPosition;}else if(typeof labelPosition.distance==='number'){args=labelPosition.args||{};labelDistance=labelPosition.distance;labelAngle=labelPosition.angle||0;}else{throw new Error('dia.LinkView: invalid label position distance.');}var isDistanceRelative=labelDistance>0&&labelDistance<=1;var labelOffset=0;var labelOffsetCoordinates={x:0,y:0};if(labelPosition.offset){var positionOffset=labelPosition.offset;if(typeof positionOffset==='number'){labelOffset=positionOffset;}if(positionOffset.x){labelOffsetCoordinates.x=positionOffset.x;}if(positionOffset.y){labelOffsetCoordinates.y=positionOffset.y;}}var isOffsetAbsolute=labelOffsetCoordinates.x!==0||labelOffsetCoordinates.y!==0||labelOffset===0;var isKeepGradient=args.keepGradient;var isEnsureLegibility=args.ensureLegibility;var path=this.path;var pathOpt={segmentSubdivisions:this.getConnectionSubdivisions()};var distance=isDistanceRelative?labelDistance*this.getConnectionLength():labelDistance;var tangent=path.tangentAtLength(distance,pathOpt);var translation;var angle=labelAngle;if(tangent){if(isOffsetAbsolute){translation=tangent.start;translation.offset(labelOffsetCoordinates);}else{var normal=tangent.clone();normal.rotate(tangent.start,-90);normal.setLength(labelOffset);translation=normal.end;}if(isKeepGradient){angle=tangent.angle()+labelAngle;if(isEnsureLegibility){angle=normalizeAngle((angle+90)%180-90);}}}else{// fallback - the connection has zero length\ntranslation=path.start;if(isOffsetAbsolute){translation.offset(labelOffsetCoordinates);}}return V.createSVGMatrix().translate(translation.x,translation.y).rotate(angle);},getLabelCoordinates:function(labelPosition){var transformationMatrix=this._getLabelTransformationMatrix(labelPosition);return new Point(transformationMatrix.e,transformationMatrix.f);},getVertexIndex:function(x,y){var model=this.model;var vertices=model.vertices();var vertexLength=this.getClosestPointLength(new Point(x,y));var idx=0;for(var n=vertices.length;idx<n;idx++){var currentVertex=vertices[idx];var currentVertexLength=this.getClosestPointLength(currentVertex);if(vertexLength<currentVertexLength){break;}}return idx;},// Interaction. The controller part.\n// ---------------------------------\nnotifyPointerdown:function notifyPointerdown(evt,x,y){CellView.prototype.pointerdown.call(this,evt,x,y);this.notify('link:pointerdown',evt,x,y);},notifyPointermove:function notifyPointermove(evt,x,y){CellView.prototype.pointermove.call(this,evt,x,y);this.notify('link:pointermove',evt,x,y);},notifyPointerup:function notifyPointerup(evt,x,y){this.notify('link:pointerup',evt,x,y);CellView.prototype.pointerup.call(this,evt,x,y);},pointerdblclick:function(evt,x,y){CellView.prototype.pointerdblclick.apply(this,arguments);this.notify('link:pointerdblclick',evt,x,y);},pointerclick:function(evt,x,y){CellView.prototype.pointerclick.apply(this,arguments);this.notify('link:pointerclick',evt,x,y);},contextmenu:function(evt,x,y){CellView.prototype.contextmenu.apply(this,arguments);this.notify('link:contextmenu',evt,x,y);},pointerdown:function(evt,x,y){this.notifyPointerdown(evt,x,y);// Backwards compatibility for the default markup\nvar className=evt.target.getAttribute('class');switch(className){case'marker-vertex':this.dragVertexStart(evt,x,y);return;case'marker-vertex-remove':case'marker-vertex-remove-area':this.dragVertexRemoveStart(evt,x,y);return;case'marker-arrowhead':this.dragArrowheadStart(evt,x,y);return;case'connection':case'connection-wrap':this.dragConnectionStart(evt,x,y);return;case'marker-source':case'marker-target':return;}this.dragStart(evt,x,y);},pointermove:function(evt,x,y){// Backwards compatibility\nvar dragData=this._dragData;if(dragData){this.eventData(evt,dragData);}var data=this.eventData(evt);switch(data.action){case'vertex-move':this.dragVertex(evt,x,y);break;case'label-move':this.dragLabel(evt,x,y);break;case'arrowhead-move':this.dragArrowhead(evt,x,y);break;case'move':this.drag(evt,x,y);break;}// Backwards compatibility\nif(dragData){assign(dragData,this.eventData(evt));}this.notifyPointermove(evt,x,y);},pointerup:function(evt,x,y){// Backwards compatibility\nvar dragData=this._dragData;if(dragData){this.eventData(evt,dragData);this._dragData=null;}var data=this.eventData(evt);switch(data.action){case'vertex-move':this.dragVertexEnd(evt,x,y);break;case'label-move':this.dragLabelEnd(evt,x,y);break;case'arrowhead-move':this.dragArrowheadEnd(evt,x,y);break;case'move':this.dragEnd(evt,x,y);}this.notifyPointerup(evt,x,y);this.checkMouseleave(evt);},mouseover:function(evt){CellView.prototype.mouseover.apply(this,arguments);this.notify('link:mouseover',evt);},mouseout:function(evt){CellView.prototype.mouseout.apply(this,arguments);this.notify('link:mouseout',evt);},mouseenter:function(evt){CellView.prototype.mouseenter.apply(this,arguments);this.notify('link:mouseenter',evt);},mouseleave:function(evt){CellView.prototype.mouseleave.apply(this,arguments);this.notify('link:mouseleave',evt);},mousewheel:function(evt,x,y,delta){CellView.prototype.mousewheel.apply(this,arguments);this.notify('link:mousewheel',evt,x,y,delta);},onevent:function(evt,eventName,x,y){// Backwards compatibility\nvar linkTool=V(evt.target).findParentByClass('link-tool',this.el);if(linkTool){// No further action to be executed\nevt.stopPropagation();// Allow `interactive.useLinkTools=false`\nif(this.can('useLinkTools')){if(eventName==='remove'){// Built-in remove event\nthis.model.remove({ui:true});// Do not trigger link pointerdown\nreturn;}else{// link:options and other custom events inside the link tools\nthis.notify(eventName,evt,x,y);}}this.notifyPointerdown(evt,x,y);this.paper.delegateDragEvents(this,evt.data);}else{CellView.prototype.onevent.apply(this,arguments);}},onlabel:function(evt,x,y){this.notifyPointerdown(evt,x,y);this.dragLabelStart(evt,x,y);var stopPropagation=this.eventData(evt).stopPropagation;if(stopPropagation){evt.stopPropagation();}},// Drag Start Handlers\ndragConnectionStart:function(evt,x,y){if(!this.can('vertexAdd')){return;}// Store the index at which the new vertex has just been placed.\n// We'll be update the very same vertex position in `pointermove()`.\nvar vertexIdx=this.addVertex({x:x,y:y},{ui:true});this.eventData(evt,{action:'vertex-move',vertexIdx:vertexIdx});},dragLabelStart:function(evt,_x,_y){if(this.can('labelMove')){var labelNode=evt.currentTarget;var labelIdx=parseInt(labelNode.getAttribute('label-idx'),10);var positionAngle=this._getLabelPositionAngle(labelIdx);var labelPositionArgs=this._getLabelPositionArgs(labelIdx);var defaultLabelPositionArgs=this._getDefaultLabelPositionArgs();var positionArgs=this._mergeLabelPositionArgs(labelPositionArgs,defaultLabelPositionArgs);this.eventData(evt,{action:'label-move',labelIdx:labelIdx,positionAngle:positionAngle,positionArgs:positionArgs,stopPropagation:true});}else{// Backwards compatibility:\n// If labels can't be dragged no default action is triggered.\nthis.eventData(evt,{stopPropagation:true});}this.paper.delegateDragEvents(this,evt.data);},dragVertexStart:function(evt,x,y){if(!this.can('vertexMove')){return;}var vertexNode=evt.target;var vertexIdx=parseInt(vertexNode.getAttribute('idx'),10);this.eventData(evt,{action:'vertex-move',vertexIdx:vertexIdx});},dragVertexRemoveStart:function(evt,x,y){if(!this.can('vertexRemove')){return;}var removeNode=evt.target;var vertexIdx=parseInt(removeNode.getAttribute('idx'),10);this.model.removeVertex(vertexIdx);},dragArrowheadStart:function(evt,x,y){if(!this.can('arrowheadMove')){return;}var arrowheadNode=evt.target;var arrowheadType=arrowheadNode.getAttribute('end');var data=this.startArrowheadMove(arrowheadType,{ignoreBackwardsCompatibility:true});this.eventData(evt,data);},dragStart:function(evt,x,y){if(!this.can('linkMove')){return;}this.eventData(evt,{action:'move',dx:x,dy:y});},// Drag Handlers\ndragLabel:function(evt,x,y){var data=this.eventData(evt);var label={position:this.getLabelPosition(x,y,data.positionAngle,data.positionArgs)};if(this.paper.options.snapLabels){delete label.position.offset;}this.model.label(data.labelIdx,label);},dragVertex:function(evt,x,y){var data=this.eventData(evt);this.model.vertex(data.vertexIdx,{x:x,y:y},{ui:true});},dragArrowhead:function(evt,x,y){if(this.paper.options.snapLinks){this._snapArrowhead(evt,x,y);}else{this._connectArrowhead(this.getEventTarget(evt),x,y,this.eventData(evt));}},drag:function(evt,x,y){var data=this.eventData(evt);this.model.translate(x-data.dx,y-data.dy,{ui:true});this.eventData(evt,{dx:x,dy:y});},// Drag End Handlers\ndragLabelEnd:function(){// noop\n},dragVertexEnd:function(){// noop\n},dragArrowheadEnd:function(evt,x,y){var data=this.eventData(evt);var paper=this.paper;if(paper.options.snapLinks){this._snapArrowheadEnd(data);}else{this._connectArrowheadEnd(data,x,y);}if(!paper.linkAllowed(this)){// If the changed link is not allowed, revert to its previous state.\nthis._disallow(data);}else{this._finishEmbedding(data);this._notifyConnectEvent(data,evt);}this._afterArrowheadMove(data);},dragEnd:function(){// noop\n},_disallow:function(data){switch(data.whenNotAllowed){case'remove':this.model.remove({ui:true});break;case'revert':default:this.model.set(data.arrowhead,data.initialEnd,{ui:true});break;}},_finishEmbedding:function(data){// Reparent the link if embedding is enabled\nif(this.paper.options.embeddingMode&&this.model.reparent()){// Make sure we don't reverse to the original 'z' index (see afterArrowheadMove()).\ndata.z=null;}},_notifyConnectEvent:function(data,evt){var arrowhead=data.arrowhead;var initialEnd=data.initialEnd;var currentEnd=this.model.prop(arrowhead);var endChanged=currentEnd&&!Link.endsEqual(initialEnd,currentEnd);if(endChanged){var paper=this.paper;if(initialEnd.id){this.notify('link:disconnect',evt,paper.findViewByModel(initialEnd.id),data.initialMagnet,arrowhead);}if(currentEnd.id){this.notify('link:connect',evt,paper.findViewByModel(currentEnd.id),data.magnetUnderPointer,arrowhead);}}},_snapArrowhead:function(evt,x,y){var ref=this;var paper=ref.paper;var ref$1=paper.options;var snapLinks=ref$1.snapLinks;var connectionStrategy=ref$1.connectionStrategy;var data=this.eventData(evt);// checking view in close area of the pointer\nvar r=snapLinks.radius||50;var viewsInArea=paper.findViewsInArea({x:x-r,y:y-r,width:2*r,height:2*r});var prevClosestView=data.closestView||null;var prevClosestMagnet=data.closestMagnet||null;var prevMagnetProxy=data.magnetProxy||null;data.closestView=data.closestMagnet=data.magnetProxy=null;var minDistance=Number.MAX_VALUE;var pointer=new Point(x,y);viewsInArea.forEach(function(view){var candidates=[];// skip connecting to the element in case '.': { magnet: false } attribute present\nif(view.el.getAttribute('magnet')!=='false'){candidates.push({bbox:view.model.getBBox(),magnet:view.el});}view.$('[magnet]').toArray().forEach(function(magnet){candidates.push({bbox:view.getNodeBBox(magnet),magnet:magnet});});candidates.forEach(function(candidate){var magnet=candidate.magnet;var bbox=candidate.bbox;// find distance from the center of the model to pointer coordinates\nvar distance=bbox.center().squaredDistance(pointer);// the connection is looked up in a circle area by `distance < r`\nif(distance<minDistance){var isAlreadyValidated=prevClosestMagnet===magnet;if(isAlreadyValidated||paper.options.validateConnection.apply(paper,data.validateConnectionArgs(view,view.el===magnet?null:magnet))){minDistance=distance;data.closestView=view;data.closestMagnet=magnet;}}});},this);var end;var magnetProxy=null;var closestView=data.closestView;var closestMagnet=data.closestMagnet;if(closestMagnet){magnetProxy=data.magnetProxy=closestView.findProxyNode(closestMagnet,'highlighter');}var endType=data.arrowhead;var newClosestMagnet=prevClosestMagnet!==closestMagnet;if(prevClosestView&&newClosestMagnet){prevClosestView.unhighlight(prevMagnetProxy,{connecting:true,snapping:true});}if(closestView){var prevEnd=data.prevEnd;var prevX=data.prevX;var prevY=data.prevY;data.prevX=x;data.prevY=y;if(!newClosestMagnet){if(typeof connectionStrategy!=='function'||prevX===x&&prevY===y){// the magnet has not changed and the link's end does not depend on the x and y\nreturn;}}end=closestView.getLinkEnd(closestMagnet,x,y,this.model,endType);if(!newClosestMagnet&&isEqual(prevEnd,end)){// the source/target json has not changed\nreturn;}data.prevEnd=end;if(newClosestMagnet){closestView.highlight(magnetProxy,{connecting:true,snapping:true});}}else{end={x:x,y:y};}this.model.set(endType,end||{x:x,y:y},{ui:true});if(prevClosestView){this.notify('link:snap:disconnect',evt,prevClosestView,prevClosestMagnet,endType);}if(closestView){this.notify('link:snap:connect',evt,closestView,closestMagnet,endType);}},_snapArrowheadEnd:function(data){// Finish off link snapping.\n// Everything except view unhighlighting was already done on pointermove.\nvar closestView=data.closestView;var closestMagnet=data.closestMagnet;if(closestView&&closestMagnet){closestView.unhighlight(data.magnetProxy,{connecting:true,snapping:true});data.magnetUnderPointer=closestView.findMagnet(closestMagnet);}data.closestView=data.closestMagnet=null;},_connectArrowhead:function(target,x,y,data){// checking views right under the pointer\nvar ref=this;var paper=ref.paper;var model=ref.model;if(data.eventTarget!==target){// Unhighlight the previous view under pointer if there was one.\nif(data.magnetProxy){data.viewUnderPointer.unhighlight(data.magnetProxy,{connecting:true});}var viewUnderPointer=data.viewUnderPointer=paper.findView(target);if(viewUnderPointer){// If we found a view that is under the pointer, we need to find the closest\n// magnet based on the real target element of the event.\nvar magnetUnderPointer=data.magnetUnderPointer=viewUnderPointer.findMagnet(target);var magnetProxy=data.magnetProxy=viewUnderPointer.findProxyNode(magnetUnderPointer,'highlighter');if(magnetUnderPointer&&this.paper.options.validateConnection.apply(paper,data.validateConnectionArgs(viewUnderPointer,magnetUnderPointer))){// If there was no magnet found, do not highlight anything and assume there\n// is no view under pointer we're interested in reconnecting to.\n// This can only happen if the overall element has the attribute `'.': { magnet: false }`.\nif(magnetProxy){viewUnderPointer.highlight(magnetProxy,{connecting:true});}}else{// This type of connection is not valid. Disregard this magnet.\ndata.magnetUnderPointer=null;data.magnetProxy=null;}}else{// Make sure we'll unset previous magnet.\ndata.magnetUnderPointer=null;data.magnetProxy=null;}}data.eventTarget=target;model.set(data.arrowhead,{x:x,y:y},{ui:true});},_connectArrowheadEnd:function(data,x,y){if(data===void 0)data={};var ref=this;var model=ref.model;var viewUnderPointer=data.viewUnderPointer;var magnetUnderPointer=data.magnetUnderPointer;var magnetProxy=data.magnetProxy;var arrowhead=data.arrowhead;if(!magnetUnderPointer||!magnetProxy||!viewUnderPointer){return;}viewUnderPointer.unhighlight(magnetProxy,{connecting:true});// The link end is taken from the magnet under the pointer, not the proxy.\nvar end=viewUnderPointer.getLinkEnd(magnetUnderPointer,x,y,model,arrowhead);model.set(arrowhead,end,{ui:true});},_beforeArrowheadMove:function(data){data.z=this.model.get('z');this.model.toFront();// Let the pointer propagate through the link view elements so that\n// the `evt.target` is another element under the pointer, not the link itself.\nvar style=this.el.style;data.pointerEvents=style.pointerEvents;style.pointerEvents='none';if(this.paper.options.markAvailable){this._markAvailableMagnets(data);}},_afterArrowheadMove:function(data){if(data.z!==null){this.model.set('z',data.z,{ui:true});data.z=null;}// Put `pointer-events` back to its original value. See `_beforeArrowheadMove()` for explanation.\nthis.el.style.pointerEvents=data.pointerEvents;if(this.paper.options.markAvailable){this._unmarkAvailableMagnets(data);}},_createValidateConnectionArgs:function(arrowhead){// It makes sure the arguments for validateConnection have the following form:\n// (source view, source magnet, target view, target magnet and link view)\nvar args=[];args[4]=arrowhead;args[5]=this;var oppositeArrowhead;var i=0;var j=0;if(arrowhead==='source'){i=2;oppositeArrowhead='target';}else{j=2;oppositeArrowhead='source';}var end=this.model.get(oppositeArrowhead);if(end.id){var view=args[i]=this.paper.findViewByModel(end.id);var magnet=view.getMagnetFromLinkEnd(end);if(magnet===view.el){magnet=undefined;}args[i+1]=magnet;}function validateConnectionArgs(cellView,magnet){args[j]=cellView;args[j+1]=cellView.el===magnet?undefined:magnet;return args;}return validateConnectionArgs;},_markAvailableMagnets:function(data){function isMagnetAvailable(view,magnet){var paper=view.paper;var validate=paper.options.validateConnection;return validate.apply(paper,this.validateConnectionArgs(view,magnet));}var paper=this.paper;var elements=paper.model.getCells();data.marked={};for(var i=0,n=elements.length;i<n;i++){var view=elements[i].findView(paper);if(!view){continue;}var magnets=Array.prototype.slice.call(view.el.querySelectorAll('[magnet]'));if(view.el.getAttribute('magnet')!=='false'){// Element wrapping group is also a magnet\nmagnets.push(view.el);}var availableMagnets=magnets.filter(isMagnetAvailable.bind(data,view));if(availableMagnets.length>0){// highlight all available magnets\nfor(var j=0,m=availableMagnets.length;j<m;j++){view.highlight(availableMagnets[j],{magnetAvailability:true});}// highlight the entire view\nview.highlight(null,{elementAvailability:true});data.marked[view.model.id]=availableMagnets;}}},_unmarkAvailableMagnets:function(data){var markedKeys=Object.keys(data.marked);var id;var markedMagnets;for(var i=0,n=markedKeys.length;i<n;i++){id=markedKeys[i];markedMagnets=data.marked[id];var view=this.paper.findViewByModel(id);if(view){for(var j=0,m=markedMagnets.length;j<m;j++){view.unhighlight(markedMagnets[j],{magnetAvailability:true});}view.unhighlight(null,{elementAvailability:true});}}data.marked=null;},startArrowheadMove:function(end,opt){opt||(opt={});// Allow to delegate events from an another view to this linkView in order to trigger arrowhead\n// move without need to click on the actual arrowhead dom element.\nvar data={action:'arrowhead-move',arrowhead:end,whenNotAllowed:opt.whenNotAllowed||'revert',initialMagnet:this[end+'Magnet']||(this[end+'View']?this[end+'View'].el:null),initialEnd:clone(this.model.get(end)),validateConnectionArgs:this._createValidateConnectionArgs(end)};this._beforeArrowheadMove(data);if(opt.ignoreBackwardsCompatibility!==true){this._dragData=data;}return data;},onRemove:function(){CellView.prototype.onRemove.apply(this,arguments);this.unmountLabels();}},{Flags:Flags$1});Object.defineProperty(LinkView.prototype,'sourceBBox',{enumerable:true,get:function(){var sourceView=this.sourceView;if(!sourceView){var sourceDef=this.model.source();return new Rect(sourceDef.x,sourceDef.y);}var sourceMagnet=this.sourceMagnet;if(sourceView.isNodeConnection(sourceMagnet)){return new Rect(this.sourceAnchor);}return sourceView.getNodeBBox(sourceMagnet||sourceView.el);}});Object.defineProperty(LinkView.prototype,'targetBBox',{enumerable:true,get:function(){var targetView=this.targetView;if(!targetView){var targetDef=this.model.target();return new Rect(targetDef.x,targetDef.y);}var targetMagnet=this.targetMagnet;if(targetView.isNodeConnection(targetMagnet)){return new Rect(this.targetAnchor);}return targetView.getNodeBBox(targetMagnet||targetView.el);}});var stroke=HighlighterView.extend({tagName:'path',className:'highlight-stroke',attributes:{'pointer-events':'none','vector-effect':'non-scaling-stroke','fill':'none'},options:{padding:3,rx:0,ry:0,useFirstSubpath:false,attrs:{'stroke-width':3,'stroke':'#FEB663'}},getPathData:function getPathData(cellView,node){var ref=this;var options=ref.options;var useFirstSubpath=options.useFirstSubpath;var d;try{var vNode=V(node);d=vNode.convertToPathData().trim();if(vNode.tagName()==='PATH'&&useFirstSubpath){var secondSubpathIndex=d.search(/.M/i)+1;if(secondSubpathIndex>0){d=d.substr(0,secondSubpathIndex);}}}catch(error){// Failed to get path data from magnet element.\n// Draw a rectangle around the node instead.\nvar nodeBBox=cellView.getNodeBoundingRect(node);d=V.rectToPath(assign({},options,nodeBBox.toJSON()));}return d;},highlightConnection:function highlightConnection(cellView){this.vel.attr('d',cellView.getSerializedConnection());},highlightNode:function highlightNode(cellView,node){var ref=this;var vel=ref.vel;var options=ref.options;var padding=options.padding;var layer=options.layer;var highlightMatrix=cellView.getNodeMatrix(node);// Add padding to the highlight element.\nif(padding){if(!layer&&node===cellView.el){// If the highlighter is appended to the cellView\n// and we measure the size of the cellView wrapping group\n// it's necessary to remove the highlighter first\nvel.remove();}var nodeBBox=cellView.getNodeBoundingRect(node);var cx=nodeBBox.x+nodeBBox.width/2;var cy=nodeBBox.y+nodeBBox.height/2;nodeBBox=V.transformRect(nodeBBox,highlightMatrix);var width=Math.max(nodeBBox.width,1);var height=Math.max(nodeBBox.height,1);var sx=(width+padding)/width;var sy=(height+padding)/height;var paddingMatrix=V.createSVGMatrix({a:sx,b:0,c:0,d:sy,e:cx-sx*cx,f:cy-sy*cy});highlightMatrix=highlightMatrix.multiply(paddingMatrix);}vel.attr({'d':this.getPathData(cellView,node),'transform':V.matrixToTransformString(highlightMatrix)});},highlight:function highlight(cellView,node){var ref=this;var vel=ref.vel;var options=ref.options;vel.attr(options.attrs);if(cellView.isNodeConnection(node)){this.highlightConnection(cellView);}else{this.highlightNode(cellView,node);}}});var MASK_CLIP=20;function forEachDescendant(vel,fn){var descendants=vel.children();while(descendants.length>0){var descendant=descendants.shift();if(fn(descendant)){descendants.push.apply(descendants,descendant.children());}}}var mask=HighlighterView.extend({tagName:'rect',className:'highlight-mask',attributes:{'pointer-events':'none'},options:{padding:3,maskClip:MASK_CLIP,deep:false,attrs:{'stroke':'#FEB663','stroke-width':3,'stroke-linecap':'butt','stroke-linejoin':'miter'}},VISIBLE:'white',INVISIBLE:'black',MASK_ROOT_ATTRIBUTE_BLACKLIST:['marker-start','marker-end','marker-mid','transform','stroke-dasharray'],MASK_CHILD_ATTRIBUTE_BLACKLIST:['stroke','fill','stroke-width','stroke-opacity','stroke-dasharray','fill-opacity','marker-start','marker-end','marker-mid'],// TODO: change the list to a function callback\nMASK_REPLACE_TAGS:['FOREIGNOBJECT','IMAGE','USE','TEXT','TSPAN','TEXTPATH'],// TODO: change the list to a function callback\nMASK_REMOVE_TAGS:['TEXT','TSPAN','TEXTPATH'],transformMaskChild:function transformMaskChild(cellView,childEl){var ref=this;var MASK_CHILD_ATTRIBUTE_BLACKLIST=ref.MASK_CHILD_ATTRIBUTE_BLACKLIST;var MASK_REPLACE_TAGS=ref.MASK_REPLACE_TAGS;var MASK_REMOVE_TAGS=ref.MASK_REMOVE_TAGS;var childTagName=childEl.tagName();// Do not include the element in the mask's image\nif(!V.isSVGGraphicsElement(childEl)||MASK_REMOVE_TAGS.includes(childTagName)){childEl.remove();return false;}// Replace the element with a rectangle\nif(MASK_REPLACE_TAGS.includes(childTagName)){// Note: clone() method does not change the children ids\nvar originalChild=cellView.vel.findOne(\"#\"+childEl.id);if(originalChild){var originalNode=originalChild.node;var childBBox=cellView.getNodeBoundingRect(originalNode);if(cellView.model.isElement()){childBBox=V.transformRect(childBBox,cellView.getNodeMatrix(originalNode));}var replacement=V('rect',childBBox.toJSON());var ref$1=childBBox.center();var ox=ref$1.x;var oy=ref$1.y;var ref$2=originalChild.rotate();var angle=ref$2.angle;var cx=ref$2.cx;if(cx===void 0)cx=ox;var cy=ref$2.cy;if(cy===void 0)cy=oy;if(angle){replacement.rotate(angle,cx,cy);}// Note: it's not important to keep the same sibling index since all subnodes are filled\nchildEl.parent().append(replacement);}childEl.remove();return false;}// Keep the element, but clean it from certain attributes\nMASK_CHILD_ATTRIBUTE_BLACKLIST.forEach(function(attrName){if(attrName==='fill'&&childEl.attr('fill')==='none'){return;}childEl.removeAttr(attrName);});return true;},transformMaskRoot:function transformMaskRoot(_cellView,rootEl){var ref=this;var MASK_ROOT_ATTRIBUTE_BLACKLIST=ref.MASK_ROOT_ATTRIBUTE_BLACKLIST;MASK_ROOT_ATTRIBUTE_BLACKLIST.forEach(function(attrName){rootEl.removeAttr(attrName);});},getMaskShape:function getMaskShape(cellView,vel){var this$1=this;var ref=this;var options=ref.options;var MASK_REPLACE_TAGS=ref.MASK_REPLACE_TAGS;var deep=options.deep;var tagName=vel.tagName();var maskRoot;if(tagName==='G'){if(!deep){return null;}maskRoot=vel.clone();forEachDescendant(maskRoot,function(maskChild){return this$1.transformMaskChild(cellView,maskChild);});}else{if(MASK_REPLACE_TAGS.includes(tagName)){return null;}maskRoot=vel.clone();}this.transformMaskRoot(cellView,maskRoot);return maskRoot;},getMaskId:function getMaskId(){return\"highlight-mask-\"+this.cid;},getMask:function getMask(cellView,vNode){var ref=this;var VISIBLE=ref.VISIBLE;var INVISIBLE=ref.INVISIBLE;var options=ref.options;var padding=options.padding;var attrs=options.attrs;var strokeWidth='stroke-width'in attrs?attrs['stroke-width']:1;var hasNodeFill=vNode.attr('fill')!=='none';var magnetStrokeWidth=parseFloat(vNode.attr('stroke-width'));if(isNaN(magnetStrokeWidth)){magnetStrokeWidth=1;}// stroke of the invisible shape\nvar minStrokeWidth=magnetStrokeWidth+padding*2;// stroke of the visible shape\nvar maxStrokeWidth=minStrokeWidth+strokeWidth*2;var maskEl=this.getMaskShape(cellView,vNode);if(!maskEl){var nodeBBox=cellView.getNodeBoundingRect(vNode.node);// Make sure the rect is visible\nnodeBBox.inflate(nodeBBox.width?0:0.5,nodeBBox.height?0:0.5);maskEl=V('rect',nodeBBox.toJSON());}maskEl.attr(attrs);return V('mask',{'id':this.getMaskId()}).append([maskEl.clone().attr({'fill':hasNodeFill?VISIBLE:'none','stroke':VISIBLE,'stroke-width':maxStrokeWidth}),maskEl.clone().attr({'fill':hasNodeFill?INVISIBLE:'none','stroke':INVISIBLE,'stroke-width':minStrokeWidth})]);},removeMask:function removeMask(paper){var maskNode=paper.svg.getElementById(this.getMaskId());if(maskNode){paper.defs.removeChild(maskNode);}},addMask:function addMask(paper,maskEl){paper.defs.appendChild(maskEl.node);},highlight:function highlight(cellView,node){var ref=this;var options=ref.options;var vel=ref.vel;var padding=options.padding;var attrs=options.attrs;var maskClip=options.maskClip;if(maskClip===void 0)maskClip=MASK_CLIP;var layer=options.layer;var color='stroke'in attrs?attrs['stroke']:'#000000';if(!layer&&node===cellView.el){// If the highlighter is appended to the cellView\n// and we measure the size of the cellView wrapping group\n// it's necessary to remove the highlighter first\nvel.remove();}var highlighterBBox=cellView.getNodeBoundingRect(node).inflate(padding+maskClip);var maskEl=this.getMask(cellView,V(node));this.addMask(cellView.paper,maskEl);vel.attr(highlighterBBox.toJSON());vel.attr({'transform':V.matrixToTransformString(cellView.getNodeMatrix(node)),'mask':\"url(#\"+maskEl.id+\")\",'fill':color});},unhighlight:function unhighlight(cellView){this.removeMask(cellView.paper);}});var opacity=HighlighterView.extend({UPDATABLE:false,MOUNTABLE:false,opacityClassName:addClassNamePrefix('highlight-opacity'),highlight:function(_cellView,node){V(node).addClass(this.opacityClassName);},unhighlight:function(_cellView,node){V(node).removeClass(this.opacityClassName);}});var className=addClassNamePrefix('highlighted');var addClass=HighlighterView.extend({UPDATABLE:false,MOUNTABLE:false,options:{className:className},highlight:function(_cellView,node){V(node).addClass(this.options.className);},unhighlight:function(_cellView,node){V(node).removeClass(this.options.className);}},{// Backwards Compatibility\nclassName:className});var highlighters={stroke:stroke,mask:mask,opacity:opacity,addClass:addClass};function connectionRatio(view,_magnet,_refPoint,opt){var ratio='ratio'in opt?opt.ratio:0.5;return view.getPointAtRatio(ratio);}function connectionLength(view,_magnet,_refPoint,opt){var length='length'in opt?opt.length:20;return view.getPointAtLength(length);}function _connectionPerpendicular(view,_magnet,refPoint,opt){var OFFSET=1e6;var path=view.getConnection();var segmentSubdivisions=view.getConnectionSubdivisions();var verticalLine=new Line(refPoint.clone().offset(0,OFFSET),refPoint.clone().offset(0,-OFFSET));var horizontalLine=new Line(refPoint.clone().offset(OFFSET,0),refPoint.clone().offset(-OFFSET,0));var verticalIntersections=verticalLine.intersect(path,{segmentSubdivisions:segmentSubdivisions});var horizontalIntersections=horizontalLine.intersect(path,{segmentSubdivisions:segmentSubdivisions});var intersections=[];if(verticalIntersections){Array.prototype.push.apply(intersections,verticalIntersections);}if(horizontalIntersections){Array.prototype.push.apply(intersections,horizontalIntersections);}if(intersections.length>0){return refPoint.chooseClosest(intersections);}if('fallbackAt'in opt){return getPointAtLink(view,opt.fallbackAt);}return connectionClosest(view,_magnet,refPoint,opt);}function _connectionClosest(view,_magnet,refPoint,_opt){var closestPoint=view.getClosestPoint(refPoint);if(!closestPoint){return new Point();}return closestPoint;}function resolveRef(fn){return function(view,magnet,ref,opt){if(ref instanceof Element){var refView=this.paper.findView(ref);var refPoint;if(refView){if(refView.isNodeConnection(ref)){var distance='fixedAt'in opt?opt.fixedAt:'50%';refPoint=getPointAtLink(refView,distance);}else{refPoint=refView.getNodeBBox(ref).center();}}else{// Something went wrong\nrefPoint=new Point();}return fn.call(this,view,magnet,refPoint,opt);}return fn.apply(this,arguments);};}function getPointAtLink(view,value){var parsedValue=parseFloat(value);if(isPercentage(value)){return view.getPointAtRatio(parsedValue/100);}else{return view.getPointAtLength(parsedValue);}}var connectionPerpendicular=resolveRef(_connectionPerpendicular);var connectionClosest=resolveRef(_connectionClosest);var linkAnchors={resolveRef:resolveRef,connectionRatio:connectionRatio,connectionLength:connectionLength,connectionPerpendicular:connectionPerpendicular,connectionClosest:connectionClosest};function offsetPoint(p1,p2,offset){if(isPlainObject(offset)){var x=offset.x;var y=offset.y;if(isFinite(y)){var line=new Line(p2,p1);var ref=line.parallel(y);var start=ref.start;var end=ref.end;p2=start;p1=end;}offset=x;}if(!isFinite(offset)){return p1;}var length=p1.distance(p2);if(offset===0&&length>0){return p1;}return p1.move(p2,-Math.min(offset,length-1));}function stroke$1(magnet){var stroke=magnet.getAttribute('stroke-width');if(stroke===null){return 0;}return parseFloat(stroke)||0;}function alignLine(line,type,offset){if(offset===void 0)offset=0;var coordinate,a,b,direction;var start=line.start;var end=line.end;switch(type){case'left':coordinate='x';a=end;b=start;direction=-1;break;case'right':coordinate='x';a=start;b=end;direction=1;break;case'top':coordinate='y';a=end;b=start;direction=-1;break;case'bottom':coordinate='y';a=start;b=end;direction=1;break;default:return;}if(start[coordinate]<end[coordinate]){a[coordinate]=b[coordinate];}else{b[coordinate]=a[coordinate];}if(isFinite(offset)){a[coordinate]+=direction*offset;b[coordinate]+=direction*offset;}}// Connection Points\nfunction anchorConnectionPoint(line,_view,_magnet,opt){var offset=opt.offset;var alignOffset=opt.alignOffset;var align=opt.align;if(align){alignLine(line,align,alignOffset);}return offsetPoint(line.end,line.start,offset);}function bboxIntersection(line,view,magnet,opt){var bbox=view.getNodeBBox(magnet);if(opt.stroke){bbox.inflate(stroke$1(magnet)/2);}var intersections=line.intersect(bbox);var cp=intersections?line.start.chooseClosest(intersections):line.end;return offsetPoint(cp,line.start,opt.offset);}function rectangleIntersection(line,view,magnet,opt){var angle=view.model.angle();if(angle===0){return bboxIntersection(line,view,magnet,opt);}var bboxWORotation=view.getNodeUnrotatedBBox(magnet);if(opt.stroke){bboxWORotation.inflate(stroke$1(magnet)/2);}var center=bboxWORotation.center();var lineWORotation=line.clone().rotate(center,angle);var intersections=lineWORotation.setLength(1e6).intersect(bboxWORotation);var cp=intersections?lineWORotation.start.chooseClosest(intersections).rotate(center,-angle):line.end;return offsetPoint(cp,line.start,opt.offset);}function findShapeNode(magnet){if(!magnet){return null;}var node=magnet;do{var tagName=node.tagName;if(typeof tagName!=='string'){return null;}tagName=tagName.toUpperCase();if(tagName==='G'){node=node.firstElementChild;}else if(tagName==='TITLE'){node=node.nextElementSibling;}else{break;}}while(node);return node;}var BNDR_SUBDIVISIONS='segmentSubdivisons';var BNDR_SHAPE_BBOX='shapeBBox';function boundaryIntersection(line,view,magnet,opt){var node,intersection;var selector=opt.selector;var anchor=line.end;if(typeof selector==='string'){node=view.findBySelector(selector)[0];}else if(Array.isArray(selector)){node=getByPath(magnet,selector);}else{node=findShapeNode(magnet);}if(!V.isSVGGraphicsElement(node)){if(node===magnet||!V.isSVGGraphicsElement(magnet)){return anchor;}node=magnet;}var localShape=view.getNodeShape(node);var magnetMatrix=view.getNodeMatrix(node);var translateMatrix=view.getRootTranslateMatrix();var rotateMatrix=view.getRootRotateMatrix();var targetMatrix=translateMatrix.multiply(rotateMatrix).multiply(magnetMatrix);var localMatrix=targetMatrix.inverse();var localLine=V.transformLine(line,localMatrix);var localRef=localLine.start.clone();var data=view.getNodeData(node);if(opt.insideout===false){if(!data[BNDR_SHAPE_BBOX]){data[BNDR_SHAPE_BBOX]=localShape.bbox();}var localBBox=data[BNDR_SHAPE_BBOX];if(localBBox.containsPoint(localRef)){return anchor;}}// Caching segment subdivisions for paths\nvar pathOpt;if(localShape instanceof Path){var precision=opt.precision||2;if(!data[BNDR_SUBDIVISIONS]){data[BNDR_SUBDIVISIONS]=localShape.getSegmentSubdivisions({precision:precision});}pathOpt={precision:precision,segmentSubdivisions:data[BNDR_SUBDIVISIONS]};}if(opt.extrapolate===true){localLine.setLength(1e6);}intersection=localLine.intersect(localShape,pathOpt);if(intersection){// More than one intersection\nif(V.isArray(intersection)){intersection=localRef.chooseClosest(intersection);}}else if(opt.sticky===true){// No intersection, find the closest point instead\nif(localShape instanceof Rect){intersection=localShape.pointNearestToPoint(localRef);}else if(localShape instanceof Ellipse){intersection=localShape.intersectionWithLineFromCenterToPoint(localRef);}else{intersection=localShape.closestPoint(localRef,pathOpt);}}var cp=intersection?V.transformPoint(intersection,targetMatrix):anchor;var cpOffset=opt.offset||0;if(opt.stroke){cpOffset+=stroke$1(node)/2;}return offsetPoint(cp,line.start,cpOffset);}var anchor=anchorConnectionPoint;var bbox=bboxIntersection;var rectangle=rectangleIntersection;var boundary=boundaryIntersection;var connectionPoints={anchor:anchor,bbox:bbox,rectangle:rectangle,boundary:boundary};function bboxWrapper(method){return function(view,magnet,ref,opt){var rotate=!!opt.rotate;var bbox=rotate?view.getNodeUnrotatedBBox(magnet):view.getNodeBBox(magnet);var anchor=bbox[method]();var dx=opt.dx;if(dx){var dxPercentage=isPercentage(dx);dx=parseFloat(dx);if(isFinite(dx)){if(dxPercentage){dx/=100;dx*=bbox.width;}anchor.x+=dx;}}var dy=opt.dy;if(dy){var dyPercentage=isPercentage(dy);dy=parseFloat(dy);if(isFinite(dy)){if(dyPercentage){dy/=100;dy*=bbox.height;}anchor.y+=dy;}}return rotate?anchor.rotate(view.model.getBBox().center(),-view.model.angle()):anchor;};}function _perpendicular(view,magnet,refPoint,opt){var angle=view.model.angle();var bbox=view.getNodeBBox(magnet);var anchor=bbox.center();var topLeft=bbox.origin();var bottomRight=bbox.corner();var padding=opt.padding;if(!isFinite(padding)){padding=0;}if(topLeft.y+padding<=refPoint.y&&refPoint.y<=bottomRight.y-padding){var dy=refPoint.y-anchor.y;anchor.x+=angle===0||angle===180?0:dy*1/Math.tan(toRad(angle));anchor.y+=dy;}else if(topLeft.x+padding<=refPoint.x&&refPoint.x<=bottomRight.x-padding){var dx=refPoint.x-anchor.x;anchor.y+=angle===90||angle===270?0:dx*Math.tan(toRad(angle));anchor.x+=dx;}return anchor;}function _midSide(view,magnet,refPoint,opt){var rotate=!!opt.rotate;var bbox,angle,center;if(rotate){bbox=view.getNodeUnrotatedBBox(magnet);center=view.model.getBBox().center();angle=view.model.angle();}else{bbox=view.getNodeBBox(magnet);}var padding=opt.padding;if(isFinite(padding)){bbox.inflate(padding);}if(rotate){refPoint.rotate(center,angle);}var side=bbox.sideNearestToPoint(refPoint);var anchor;switch(side){case'left':anchor=bbox.leftMiddle();break;case'right':anchor=bbox.rightMiddle();break;case'top':anchor=bbox.topMiddle();break;case'bottom':anchor=bbox.bottomMiddle();break;}return rotate?anchor.rotate(center,-angle):anchor;}// Can find anchor from model, when there is no selector or the link end\n// is connected to a port\nfunction _modelCenter(view,_magnet,_refPoint,opt,endType){return view.model.getPointFromConnectedLink(this.model,endType).offset(opt.dx,opt.dy);}//joint.anchors\nvar center=bboxWrapper('center');var top$2=bboxWrapper('topMiddle');var bottom$2=bboxWrapper('bottomMiddle');var left$2=bboxWrapper('leftMiddle');var right$2=bboxWrapper('rightMiddle');var topLeft=bboxWrapper('origin');var topRight=bboxWrapper('topRight');var bottomLeft=bboxWrapper('bottomLeft');var bottomRight=bboxWrapper('corner');var perpendicular=resolveRef(_perpendicular);var midSide=resolveRef(_midSide);var modelCenter=_modelCenter;var anchors={center:center,top:top$2,bottom:bottom$2,left:left$2,right:right$2,topLeft:topLeft,topRight:topRight,bottomLeft:bottomLeft,bottomRight:bottomRight,perpendicular:perpendicular,midSide:midSide,modelCenter:modelCenter};var sortingTypes={NONE:'sorting-none',APPROX:'sorting-approximate',EXACT:'sorting-exact'};var MOUNT_BATCH_SIZE=1000;var UPDATE_BATCH_SIZE=Infinity;var MIN_PRIORITY=9007199254740991;// Number.MAX_SAFE_INTEGER\nvar HighlightingTypes$1=CellView.Highlighting;var defaultHighlighting={};defaultHighlighting[HighlightingTypes$1.DEFAULT]={name:'stroke',options:{padding:3}};defaultHighlighting[HighlightingTypes$1.MAGNET_AVAILABILITY]={name:'addClass',options:{className:'available-magnet'}};defaultHighlighting[HighlightingTypes$1.ELEMENT_AVAILABILITY]={name:'addClass',options:{className:'available-cell'}};var defaultLayers=[{name:LayersNames.BACK},{name:LayersNames.CELLS},{name:LayersNames.LABELS},{name:LayersNames.FRONT},{name:LayersNames.TOOLS}];var Paper=View.extend({className:'paper',options:{width:800,height:600,origin:{x:0,y:0},// x,y coordinates in top-left corner\ngridSize:1,// Whether or not to draw the grid lines on the paper's DOM element.\n// e.g drawGrid: true, drawGrid: { color: 'red', thickness: 2 }\ndrawGrid:false,// Whether or not to draw the background on the paper's DOM element.\n// e.g. background: { color: 'lightblue', image: '/paper-background.png', repeat: 'flip-xy' }\nbackground:false,perpendicularLinks:false,elementView:ElementView,linkView:LinkView,snapLabels:false,// false, true\nsnapLinks:false,// false, true, { radius: value }\n// Should the link labels be rendered into its own layer?\n// `false` - the labels are part of the links\n// `true` - the labels are appended to LayersName.LABELS\n// [LayersName] - the labels are appended to the layer specified\nlabelsLayer:false,// When set to FALSE, an element may not have more than 1 link with the same source and target element.\nmultiLinks:true,// For adding custom guard logic.\nguard:function(evt,view){// FALSE means the event isn't guarded.\nreturn false;},highlighting:defaultHighlighting,// Prevent the default context menu from being displayed.\npreventContextMenu:true,// Prevent the default action for blank:pointer<action>.\npreventDefaultBlankAction:true,// Restrict the translation of elements by given bounding box.\n// Option accepts a boolean:\n//  true - the translation is restricted to the paper area\n//  false - no restrictions\n// A method:\n// restrictTranslate: function(elementView) {\n//     var parentId = elementView.model.get('parent');\n//     return parentId && this.model.getCell(parentId).getBBox();\n// },\n// Or a bounding box:\n// restrictTranslate: { x: 10, y: 10, width: 790, height: 590 }\nrestrictTranslate:false,// Marks all available magnets with 'available-magnet' class name and all available cells with\n// 'available-cell' class name. Marks them when dragging a link is started and unmark\n// when the dragging is stopped.\nmarkAvailable:false,// Defines what link model is added to the graph after an user clicks on an active magnet.\n// Value could be the Backbone.model or a function returning the Backbone.model\n// defaultLink: function(elementView, magnet) { return condition ? new customLink1() : new customLink2() }\ndefaultLink:new Link(),// A connector that is used by links with no connector defined on the model.\n// e.g. { name: 'rounded', args: { radius: 5 }} or a function\ndefaultConnector:{name:'normal'},// A router that is used by links with no router defined on the model.\n// e.g. { name: 'oneSide', args: { padding: 10 }} or a function\ndefaultRouter:{name:'normal'},defaultAnchor:{name:'center'},defaultLinkAnchor:{name:'connectionRatio'},defaultConnectionPoint:{name:'bbox'},/* CONNECTING */connectionStrategy:null,// Check whether to add a new link to the graph when user clicks on an a magnet.\nvalidateMagnet:function(_cellView,magnet,_evt){return magnet.getAttribute('magnet')!=='passive';},// Check whether to allow or disallow the link connection while an arrowhead end (source/target)\n// being changed.\nvalidateConnection:function(cellViewS,_magnetS,cellViewT,_magnetT,end,_linkView){return(end==='target'?cellViewT:cellViewS)instanceof ElementView;},/* EMBEDDING */ // Enables embedding. Re-parent the dragged element with elements under it and makes sure that\n// all links and elements are visible taken the level of embedding into account.\nembeddingMode:false,// Check whether to allow or disallow the element embedding while an element being translated.\nvalidateEmbedding:function(childView,parentView){// by default all elements can be in relation child-parent\nreturn true;},// Check whether to allow or disallow an embedded element to be unembedded / to become a root.\nvalidateUnembedding:function(childView){// by default all elements can become roots\nreturn true;},// Determines the way how a cell finds a suitable parent when it's dragged over the paper.\n// The cell with the highest z-index (visually on the top) will be chosen.\nfindParentBy:'bbox',// 'bbox'|'center'|'origin'|'corner'|'topRight'|'bottomLeft'\n// If enabled only the element on the very front is taken into account for the embedding.\n// If disabled the elements under the dragged view are tested one by one\n// (from front to back) until a valid parent found.\nfrontParentOnly:true,// Interactive flags. See online docs for the complete list of interactive flags.\ninteractive:{labelMove:false},// When set to true the links can be pinned to the paper.\n// i.e. link source/target can be a point e.g. link.get('source') ==> { x: 100, y: 100 };\nlinkPinning:true,// Custom validation after an interaction with a link ends.\n// Recognizes a function. If `false` is returned, the link is disallowed (removed or reverted)\n// (linkView, paper) => boolean\nallowLink:null,// Allowed number of mousemove events after which the pointerclick event will be still triggered.\nclickThreshold:0,// Number of required mousemove events before the first pointermove event will be triggered.\nmoveThreshold:0,// Number of required mousemove events before the a link is created out of the magnet.\n// Or string `onleave` so the link is created when the pointer leaves the magnet\nmagnetThreshold:0,// Rendering Options\nsorting:sortingTypes.EXACT,frozen:false,// no docs yet\nonViewUpdate:function(view,flag,priority,opt,paper){// Do not update connected links when:\n// 1. the view was just inserted (added to the graph and rendered)\n// 2. the view was just mounted (added back to the paper by viewport function)\n// 3. the change was marked as `isolate`.\n// 4. the view model was just removed from the graph\nif(flag&(view.FLAG_INSERT|view.FLAG_REMOVE)||opt.mounting||opt.isolate){return;}paper.requestConnectedLinksUpdate(view,priority,opt);},// no docs yet\nonViewPostponed:function(view,flag,paper){return paper.forcePostponedViewUpdate(view,flag);},beforeRender:null,// function(opt, paper) { },\nafterRender:null,// function(stats, opt, paper) {\nviewport:null,// Default namespaces\ncellViewNamespace:null,routerNamespace:null,connectorNamespace:null,highlighterNamespace:highlighters,anchorNamespace:anchors,linkAnchorNamespace:linkAnchors,connectionPointNamespace:connectionPoints},events:{'dblclick':'pointerdblclick','contextmenu':'contextmenu','mousedown':'pointerdown','touchstart':'pointerdown','mouseover':'mouseover','mouseout':'mouseout','mouseenter':'mouseenter','mouseleave':'mouseleave','wheel':'mousewheel','mouseenter .joint-cell':'mouseenter','mouseleave .joint-cell':'mouseleave','mouseenter .joint-tools':'mouseenter','mouseleave .joint-tools':'mouseleave','mousedown .joint-cell [event]':'onevent',// interaction with cell with `event` attribute set\n'touchstart .joint-cell [event]':'onevent','mousedown .joint-cell [magnet]':'onmagnet',// interaction with cell with `magnet` attribute set\n'touchstart .joint-cell [magnet]':'onmagnet','dblclick .joint-cell [magnet]':'magnetpointerdblclick','contextmenu .joint-cell [magnet]':'magnetcontextmenu','mousedown .joint-link .label':'onlabel',// interaction with link label\n'touchstart .joint-link .label':'onlabel','dragstart .joint-cell image':'onImageDragStart'// firefox fix\n},documentEvents:{'mousemove':'pointermove','touchmove':'pointermove','mouseup':'pointerup','touchend':'pointerup','touchcancel':'pointerup'},svg:null,viewport:null,defs:null,tools:null,$background:null,layers:null,$grid:null,$document:null,// For storing the current transformation matrix (CTM) of the paper's viewport.\n_viewportMatrix:null,// For verifying whether the CTM is up-to-date. The viewport transform attribute\n// could have been manipulated directly.\n_viewportTransformString:null,// Updates data (priorities, unmounted views etc.)\n_updates:null,// Paper Layers\n_layers:null,SORT_DELAYING_BATCHES:['add','to-front','to-back'],UPDATE_DELAYING_BATCHES:['translate'],MIN_SCALE:1e-6,init:function(){var ref=this;var options=ref.options;var el=ref.el;if(!options.cellViewNamespace){/* eslint-disable no-undef */options.cellViewNamespace=typeof joint!=='undefined'&&has$2(joint,'shapes')?joint.shapes:null;/* eslint-enable no-undef */}var model=this.model=options.model||new Graph();// Layers (SVGGroups)\nthis._layers={};this.setGrid(options.drawGrid);this.cloneOptions();this.render();this._setDimensions();this.startListening();// Hash of all cell views.\nthis._views={};// Reference to the paper owner document\nthis.$document=$(el.ownerDocument);// Render existing cells in the graph\nthis.resetViews(model.attributes.cells.models);// Start the Rendering Loop\nif(!this.isFrozen()&&this.isAsync()){this.updateViewsAsync();}},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:false,freezeKey:null,sort:false};},startListening:function(){var model=this.model;this.listenTo(model,'add',this.onCellAdded).listenTo(model,'remove',this.onCellRemoved).listenTo(model,'change',this.onCellChange).listenTo(model,'reset',this.onGraphReset).listenTo(model,'sort',this.onGraphSort).listenTo(model,'batch:stop',this.onGraphBatchStop);this.on('cell:highlight',this.onCellHighlight).on('cell:unhighlight',this.onCellUnhighlight).on('scale translate',this.update);},onCellAdded:function(cell,_,opt){var position=opt.position;if(this.isAsync()||!isNumber(position)){this.renderView(cell,opt);}else{if(opt.maxPosition===position){this.freeze({key:'addCells'});}this.renderView(cell,opt);if(position===0){this.unfreeze({key:'addCells'});}}},onCellRemoved:function(cell,_,opt){var view=this.findViewByModel(cell);if(view){this.requestViewUpdate(view,view.FLAG_REMOVE,view.UPDATE_PRIORITY,opt);}},onCellChange:function(cell,opt){if(cell===this.model.attributes.cells){return;}if(cell.hasChanged('z')&&this.options.sorting===sortingTypes.APPROX){var view=this.findViewByModel(cell);if(view){this.requestViewUpdate(view,view.FLAG_INSERT,view.UPDATE_PRIORITY,opt);}}},onGraphReset:function(collection,opt){this.resetLayers();this.resetViews(collection.models,opt);},onGraphSort:function(){if(this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)){return;}this.sortViews();},onGraphBatchStop:function(data){if(this.isFrozen()){return;}var name=data&&data.batchName;var graph=this.model;if(!this.isAsync()){var updateDelayingBatches=this.UPDATE_DELAYING_BATCHES;if(updateDelayingBatches.includes(name)&&!graph.hasActiveBatch(updateDelayingBatches)){this.updateViews(data);}}var sortDelayingBatches=this.SORT_DELAYING_BATCHES;if(sortDelayingBatches.includes(name)&&!graph.hasActiveBatch(sortDelayingBatches)){this.sortViews();}},cloneOptions:function(){var ref=this;var options=ref.options;var defaultConnector=options.defaultConnector;var defaultRouter=options.defaultRouter;var defaultConnectionPoint=options.defaultConnectionPoint;var defaultAnchor=options.defaultAnchor;var defaultLinkAnchor=options.defaultLinkAnchor;var origin=options.origin;var highlighting=options.highlighting;var cellViewNamespace=options.cellViewNamespace;var interactive=options.interactive;// Default cellView namespace for ES5\n/* eslint-disable no-undef */if(!cellViewNamespace&&typeof joint!=='undefined'&&has$2(joint,'shapes')){options.cellViewNamespace=joint.shapes;}/* eslint-enable no-undef */ // Here if a function was provided, we can not clone it, as this would result in loosing the function.\n// If the default is used, the cloning is necessary in order to prevent modifying the options on prototype.\nif(!isFunction(defaultConnector)){options.defaultConnector=cloneDeep(defaultConnector);}if(!isFunction(defaultRouter)){options.defaultRouter=cloneDeep(defaultRouter);}if(!isFunction(defaultConnectionPoint)){options.defaultConnectionPoint=cloneDeep(defaultConnectionPoint);}if(!isFunction(defaultAnchor)){options.defaultAnchor=cloneDeep(defaultAnchor);}if(!isFunction(defaultLinkAnchor)){options.defaultLinkAnchor=cloneDeep(defaultLinkAnchor);}if(isPlainObject(interactive)){options.interactive=assign({},interactive);}if(isPlainObject(highlighting)){// Return the default highlighting options into the user specified options.\noptions.highlighting=defaultsDeep({},highlighting,defaultHighlighting);}options.origin=assign({},origin);},children:function(){var ns=V.namespace;return[{namespaceURI:ns.xhtml,tagName:'div',className:addClassNamePrefix('paper-background'),selector:'background'},{namespaceURI:ns.xhtml,tagName:'div',className:addClassNamePrefix('paper-grid'),selector:'grid'},{namespaceURI:ns.svg,tagName:'svg',attributes:{'width':'100%','height':'100%','xmlns:xlink':ns.xlink},selector:'svg',children:[{// Append `<defs>` element to the SVG document. This is useful for filters and gradients.\n// It's desired to have the defs defined before the viewport (e.g. to make a PDF document pick up defs properly).\ntagName:'defs',selector:'defs'},{tagName:'g',className:addClassNamePrefix('layers'),selector:'layers'}]}];},hasLayerView:function hasLayerView(layerName){return layerName in this._layers;},getLayerView:function getLayerView(layerName){var ref=this;var _layers=ref._layers;if(layerName in _layers){return _layers[layerName];}throw new Error(\"dia.Paper: Unknown layer \\\"\"+layerName+\"\\\"\");},getLayerNode:function getLayerNode(layerName){return this.getLayerView(layerName).el;},render:function(){this.renderChildren();var ref=this;var childNodes=ref.childNodes;var options=ref.options;var svg=childNodes.svg;var defs=childNodes.defs;var layers=childNodes.layers;var background=childNodes.background;var grid=childNodes.grid;this.svg=svg;this.defs=defs;this.layers=layers;this.$background=$(background);this.$grid=$(grid);this.renderLayers();V.ensureId(svg);if(options.background){this.drawBackground(options.background);}if(options.drawGrid){this.drawGrid();}return this;},renderLayers:function(layers){var this$1=this;if(layers===void 0)layers=defaultLayers;this.removeLayers();// TODO: Layers to be read from the graph `layers` attribute\nlayers.forEach(function(ref){var name=ref.name;var sorted=ref.sorted;var layerView=new PaperLayer({name:name});this$1.layers.appendChild(layerView.el);this$1._layers[name]=layerView;});// Throws an exception if doesn't exist\nvar cellsLayerView=this.getLayerView(LayersNames.CELLS);var toolsLayerView=this.getLayerView(LayersNames.TOOLS);var labelsLayerView=this.getLayerView(LayersNames.LABELS);// backwards compatibility\nthis.tools=toolsLayerView.el;this.cells=this.viewport=cellsLayerView.el;// user-select: none;\ncellsLayerView.vel.addClass(addClassNamePrefix('viewport'));labelsLayerView.vel.addClass(addClassNamePrefix('viewport'));},removeLayers:function(){var ref=this;var _layers=ref._layers;Object.keys(_layers,function(name){_layers[name].remove();delete _layers[name];});},resetLayers:function(){var ref=this;var _layers=ref._layers;Object.keys(_layers,function(name){_layers[name].removePivots();});},update:function(){if(this.options.drawGrid){this.drawGrid();}if(this._background){this.updateBackgroundImage(this._background);}return this;},matrix:function(ctm){var viewport=this.layers;// Getter:\nif(ctm===undefined){var transformString=viewport.getAttribute('transform');if((this._viewportTransformString||null)===transformString){// It's ok to return the cached matrix. The transform attribute has not changed since\n// the matrix was stored.\nctm=this._viewportMatrix;}else{// The viewport transform attribute has changed. Measure the matrix and cache again.\nctm=viewport.getCTM();this._viewportMatrix=ctm;this._viewportTransformString=transformString;}// Clone the cached current transformation matrix.\n// If no matrix previously stored the identity matrix is returned.\nreturn V.createSVGMatrix(ctm);}// Setter:\nctm=V.createSVGMatrix(ctm);var ctmString=V.matrixToTransformString(ctm);viewport.setAttribute('transform',ctmString);this._viewportMatrix=ctm;this._viewportTransformString=viewport.getAttribute('transform');return this;},clientMatrix:function(){return V.createSVGMatrix(this.cells.getScreenCTM());},requestConnectedLinksUpdate:function(view,priority,opt){if(view instanceof CellView){var model=view.model;var links=this.model.getConnectedLinks(model);for(var j=0,n=links.length;j<n;j++){var link=links[j];var linkView=this.findViewByModel(link);if(!linkView){continue;}var flagLabels=['UPDATE'];if(link.getTargetCell()===model){flagLabels.push('TARGET');}if(link.getSourceCell()===model){flagLabels.push('SOURCE');}var nextPriority=Math.max(priority+1,linkView.UPDATE_PRIORITY);this.scheduleViewUpdate(linkView,linkView.getFlag(flagLabels),nextPriority,opt);}}},forcePostponedViewUpdate:function(view,flag){if(!view||!(view instanceof CellView)){return false;}var model=view.model;if(model.isElement()){return false;}if((flag&view.getFlag(['SOURCE','TARGET']))===0){// LinkView is waiting for the target or the source cellView to be rendered\n// This can happen when the cells are not in the viewport.\nvar sourceFlag=0;var sourceView=this.findViewByModel(model.getSourceCell());if(sourceView&&!this.isViewMounted(sourceView)){sourceFlag=this.dumpView(sourceView);view.updateEndMagnet('source');}var targetFlag=0;var targetView=this.findViewByModel(model.getTargetCell());if(targetView&&!this.isViewMounted(targetView)){targetFlag=this.dumpView(targetView);view.updateEndMagnet('target');}if(sourceFlag===0&&targetFlag===0){// If leftover flag is 0, all view updates were done.\nreturn!this.dumpView(view);}}return false;},requestViewUpdate:function(view,flag,priority,opt){opt||(opt={});this.scheduleViewUpdate(view,flag,priority,opt);var isAsync=this.isAsync();if(this.isFrozen()||isAsync&&opt.async!==false){return;}if(this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)){return;}var stats=this.updateViews(opt);if(isAsync){this.notifyAfterRender(stats,opt);}},scheduleViewUpdate:function(view,type,priority,opt){var ref=this;var updates=ref._updates;var options=ref.options;var FLAG_REMOVE=view.FLAG_REMOVE;var FLAG_INSERT=view.FLAG_INSERT;var UPDATE_PRIORITY=view.UPDATE_PRIORITY;var cid=view.cid;var priorityUpdates=updates.priorities[priority];if(!priorityUpdates){priorityUpdates=updates.priorities[priority]={};}// Move higher priority updates to this priority\nif(priority>UPDATE_PRIORITY){// Not the default priority for this view. It's most likely a link view\n// connected to another link view, which triggered the update.\n// TODO: If there is an update scheduled with a lower priority already, we should\n// change the requested priority to the lowest one. Does not seem to be critical\n// right now, as it \"only\" results in multiple updates on the same view.\nfor(var i=priority-1;i>=UPDATE_PRIORITY;i--){var prevPriorityUpdates=updates.priorities[i];if(!prevPriorityUpdates||!(cid in prevPriorityUpdates)){continue;}priorityUpdates[cid]|=prevPriorityUpdates[cid];delete prevPriorityUpdates[cid];}}var currentType=priorityUpdates[cid]||0;// Prevent cycling\nif((currentType&type)===type){return;}if(!currentType){updates.count++;}if(type&FLAG_REMOVE&&currentType&FLAG_INSERT){// When a view is removed we need to remove the insert flag as this is a reinsert\npriorityUpdates[cid]^=FLAG_INSERT;}else if(type&FLAG_INSERT&&currentType&FLAG_REMOVE){// When a view is added we need to remove the remove flag as this is view was previously removed\npriorityUpdates[cid]^=FLAG_REMOVE;}priorityUpdates[cid]|=type;var viewUpdateFn=options.onViewUpdate;if(typeof viewUpdateFn==='function'){viewUpdateFn.call(this,view,type,priority,opt||{},this);}},dumpViewUpdate:function(view){if(!view){return 0;}var updates=this._updates;var cid=view.cid;var priorityUpdates=updates.priorities[view.UPDATE_PRIORITY];var flag=this.registerMountedView(view)|priorityUpdates[cid];delete priorityUpdates[cid];return flag;},dumpView:function(view,opt){var flag=this.dumpViewUpdate(view);if(!flag){return 0;}return this.updateView(view,flag,opt);},updateView:function(view,flag,opt){if(!view){return 0;}var FLAG_REMOVE=view.FLAG_REMOVE;var FLAG_INSERT=view.FLAG_INSERT;var model=view.model;if(view instanceof CellView){if(flag&FLAG_REMOVE){this.removeView(model);return 0;}if(flag&FLAG_INSERT){this.insertView(view);flag^=FLAG_INSERT;}}if(!flag){return 0;}return view.confirmUpdate(flag,opt||{});},requireView:function(model,opt){var view=this.findViewByModel(model);if(!view){return null;}this.dumpView(view,opt);return view;},registerUnmountedView:function(view){var cid=view.cid;var updates=this._updates;if(cid in updates.unmounted){return 0;}var flag=updates.unmounted[cid]|=view.FLAG_INSERT;updates.unmountedCids.push(cid);delete updates.mounted[cid];return flag;},registerMountedView:function(view){var cid=view.cid;var updates=this._updates;if(cid in updates.mounted){return 0;}updates.mounted[cid]=true;updates.mountedCids.push(cid);var flag=updates.unmounted[cid]||0;delete updates.unmounted[cid];return flag;},isViewMounted:function(view){if(!view){return false;}var cid=view.cid;var updates=this._updates;return cid in updates.mounted;},dumpViews:function(opt){var passingOpt=defaults({},opt,{viewport:null});this.checkViewport(passingOpt);this.updateViews(passingOpt);},// Synchronous views update\nupdateViews:function(opt){this.notifyBeforeRender(opt);var batchStats;var updateCount=0;var batchCount=0;var priority=MIN_PRIORITY;do{batchCount++;batchStats=this.updateViewsBatch(opt);updateCount+=batchStats.updated;priority=Math.min(batchStats.priority,priority);}while(!batchStats.empty);var stats={updated:updateCount,batches:batchCount,priority:priority};this.notifyAfterRender(stats,opt);return stats;},hasScheduledUpdates:function(){var priorities=this._updates.priorities;var priorityIndexes=Object.keys(priorities);// convert priorities to a dense array\nvar i=priorityIndexes.length;while(i>0&&i--){// a faster way how to check if an object is empty\nfor(var _key in priorities[priorityIndexes[i]]){return true;}}return false;},updateViewsAsync:function(opt,data){opt||(opt={});data||(data={processed:0,priority:MIN_PRIORITY});var updates=this._updates;var id=updates.id;if(id){cancelFrame(id);if(data.processed===0&&this.hasScheduledUpdates()){this.notifyBeforeRender(opt);}var stats=this.updateViewsBatch(opt);var passingOpt=defaults({},opt,{mountBatchSize:MOUNT_BATCH_SIZE-stats.mounted,unmountBatchSize:MOUNT_BATCH_SIZE-stats.unmounted});var checkStats=this.checkViewport(passingOpt);var unmountCount=checkStats.unmounted;var mountCount=checkStats.mounted;var processed=data.processed;var total=updates.count;if(stats.updated>0){// Some updates have been just processed\nprocessed+=stats.updated+stats.unmounted;stats.processed=processed;data.priority=Math.min(stats.priority,data.priority);if(stats.empty&&mountCount===0){stats.unmounted+=unmountCount;stats.mounted+=mountCount;stats.priority=data.priority;this.notifyAfterRender(stats,opt);data.processed=0;data.priority=MIN_PRIORITY;updates.count=0;}else{data.processed=processed;}}// Progress callback\nvar progressFn=opt.progress;if(total&&typeof progressFn==='function'){progressFn.call(this,stats.empty,processed,total,stats,this);}// The current frame could have been canceled in a callback\nif(updates.id!==id){return;}}updates.id=nextFrame(this.updateViewsAsync,this,opt,data);},notifyBeforeRender:function(opt){if(opt===void 0)opt={};var beforeFn=opt.beforeRender;if(typeof beforeFn!=='function'){beforeFn=this.options.beforeRender;if(typeof beforeFn!=='function'){return;}}beforeFn.call(this,opt,this);},notifyAfterRender:function(stats,opt){if(opt===void 0)opt={};var afterFn=opt.afterRender;if(typeof afterFn!=='function'){afterFn=this.options.afterRender;}if(typeof afterFn==='function'){afterFn.call(this,stats,opt,this);}this.trigger('render:done',stats,opt);},updateViewsBatch:function(opt){opt||(opt={});var batchSize=opt.batchSize||UPDATE_BATCH_SIZE;var updates=this._updates;var updateCount=0;var postponeCount=0;var unmountCount=0;var mountCount=0;var maxPriority=MIN_PRIORITY;var empty=true;var options=this.options;var priorities=updates.priorities;var viewportFn='viewport'in opt?opt.viewport:options.viewport;if(typeof viewportFn!=='function'){viewportFn=null;}var postponeViewFn=options.onViewPostponed;if(typeof postponeViewFn!=='function'){postponeViewFn=null;}var priorityIndexes=Object.keys(priorities);// convert priorities to a dense array\nmain:for(var i=0,n=priorityIndexes.length;i<n;i++){var priority=+priorityIndexes[i];var priorityUpdates=priorities[priority];for(var cid in priorityUpdates){if(updateCount>=batchSize){empty=false;break main;}var view=views[cid];if(!view){// This should not occur\ndelete priorityUpdates[cid];continue;}var currentFlag=priorityUpdates[cid];if((currentFlag&view.FLAG_REMOVE)===0){// We should never check a view for viewport if we are about to remove the view\nvar isDetached=(cid in updates.unmounted);if(view.DETACHABLE&&viewportFn&&!viewportFn.call(this,view,!isDetached,this)){// Unmount View\nif(!isDetached){this.registerUnmountedView(view);view.unmount();}updates.unmounted[cid]|=currentFlag;delete priorityUpdates[cid];unmountCount++;continue;}// Mount View\nif(isDetached){currentFlag|=view.FLAG_INSERT;mountCount++;}currentFlag|=this.registerMountedView(view);}var leftoverFlag=this.updateView(view,currentFlag,opt);if(leftoverFlag>0){// View update has not finished completely\npriorityUpdates[cid]=leftoverFlag;if(!postponeViewFn||!postponeViewFn.call(this,view,leftoverFlag,this)||priorityUpdates[cid]){postponeCount++;empty=false;continue;}}if(maxPriority>priority){maxPriority=priority;}updateCount++;delete priorityUpdates[cid];}}return{priority:maxPriority,updated:updateCount,postponed:postponeCount,unmounted:unmountCount,mounted:mountCount,empty:empty};},getUnmountedViews:function(){var updates=this._updates;var unmountedCids=Object.keys(updates.unmounted);var n=unmountedCids.length;var unmountedViews=new Array(n);for(var i=0;i<n;i++){unmountedViews[i]=views[unmountedCids[i]];}return unmountedViews;},getMountedViews:function(){var updates=this._updates;var mountedCids=Object.keys(updates.mounted);var n=mountedCids.length;var mountedViews=new Array(n);for(var i=0;i<n;i++){mountedViews[i]=views[mountedCids[i]];}return mountedViews;},checkUnmountedViews:function(viewportFn,opt){opt||(opt={});var mountCount=0;if(typeof viewportFn!=='function'){viewportFn=null;}var batchSize='mountBatchSize'in opt?opt.mountBatchSize:Infinity;var updates=this._updates;var unmountedCids=updates.unmountedCids;var unmounted=updates.unmounted;for(var i=0,n=Math.min(unmountedCids.length,batchSize);i<n;i++){var cid=unmountedCids[i];if(!(cid in unmounted)){continue;}var view=views[cid];if(!view){continue;}if(view.DETACHABLE&&viewportFn&&!viewportFn.call(this,view,false,this)){// Push at the end of all unmounted ids, so this can be check later again\nunmountedCids.push(cid);continue;}mountCount++;var flag=this.registerMountedView(view);if(flag){this.scheduleViewUpdate(view,flag,view.UPDATE_PRIORITY,{mounting:true});}}// Get rid of views, that have been mounted\nunmountedCids.splice(0,i);return mountCount;},checkMountedViews:function(viewportFn,opt){opt||(opt={});var unmountCount=0;if(typeof viewportFn!=='function'){return unmountCount;}var batchSize='unmountBatchSize'in opt?opt.unmountBatchSize:Infinity;var updates=this._updates;var mountedCids=updates.mountedCids;var mounted=updates.mounted;for(var i=0,n=Math.min(mountedCids.length,batchSize);i<n;i++){var cid=mountedCids[i];if(!(cid in mounted)){continue;}var view=views[cid];if(!view){continue;}if(!view.DETACHABLE||viewportFn.call(this,view,true,this)){// Push at the end of all mounted ids, so this can be check later again\nmountedCids.push(cid);continue;}unmountCount++;var flag=this.registerUnmountedView(view);if(flag){view.unmount();}}// Get rid of views, that have been unmounted\nmountedCids.splice(0,i);return unmountCount;},checkViewport:function(opt){var passingOpt=defaults({},opt,{mountBatchSize:Infinity,unmountBatchSize:Infinity});var viewportFn='viewport'in passingOpt?passingOpt.viewport:this.options.viewport;var unmountedCount=this.checkMountedViews(viewportFn,passingOpt);if(unmountedCount>0){// Do not check views, that have been just unmounted and pushed at the end of the cids array\nvar unmountedCids=this._updates.unmountedCids;passingOpt.mountBatchSize=Math.min(unmountedCids.length-unmountedCount,passingOpt.mountBatchSize);}var mountedCount=this.checkUnmountedViews(viewportFn,passingOpt);return{mounted:mountedCount,unmounted:unmountedCount};},freeze:function(opt){opt||(opt={});var updates=this._updates;var key=opt.key;var isFrozen=this.options.frozen;var freezeKey=updates.freezeKey;if(key&&key!==freezeKey){// key passed, but the paper is already freezed with another key\nif(isFrozen&&freezeKey){return;}updates.freezeKey=key;updates.keyFrozen=isFrozen;}this.options.frozen=true;var id=updates.id;updates.id=null;if(this.isAsync()&&id){cancelFrame(id);}},unfreeze:function(opt){opt||(opt={});var updates=this._updates;var key=opt.key;var freezeKey=updates.freezeKey;// key passed, but the paper is already freezed with another key\nif(key&&freezeKey&&key!==freezeKey){return;}updates.freezeKey=null;// key passed, but the paper is already freezed\nif(key&&key===freezeKey&&updates.keyFrozen){return;}if(this.isAsync()){this.freeze();this.updateViewsAsync(opt);}else{this.updateViews(opt);}this.options.frozen=updates.keyFrozen=false;if(updates.sort){this.sortViews();updates.sort=false;}},isAsync:function(){return!!this.options.async;},isFrozen:function(){return!!this.options.frozen;},isExactSorting:function(){return this.options.sorting===sortingTypes.EXACT;},onRemove:function(){this.freeze();//clean up all DOM elements/views to prevent memory leaks\nthis.removeLayers();this.removeViews();},getComputedSize:function(){var options=this.options;var w=options.width;var h=options.height;if(!isNumber(w)){w=this.el.clientWidth;}if(!isNumber(h)){h=this.el.clientHeight;}return{width:w,height:h};},setDimensions:function(width,height){var ref=this;var options=ref.options;var currentWidth=options.width;var currentHeight=options.height;var w=width===undefined?currentWidth:width;var h=height===undefined?currentHeight:height;if(currentWidth===w&&currentHeight===h){return;}options.width=w;options.height=h;this._setDimensions();var computedSize=this.getComputedSize();this.trigger('resize',computedSize.width,computedSize.height);},_setDimensions:function(){var ref=this;var options=ref.options;var w=options.width;var h=options.height;if(isNumber(w)){w=Math.round(w);}if(isNumber(h)){h=Math.round(h);}this.$el.css({width:w===null?'':w,height:h===null?'':h});},setOrigin:function(ox,oy){return this.translate(ox||0,oy||0);},// Expand/shrink the paper to fit the content.\n// Alternatively signature function(opt)\nfitToContent:function(gridWidth,gridHeight,padding,opt){if(isObject$1(gridWidth)){// first parameter is an option object\nopt=gridWidth;}else{// Support for a deprecated signature\nopt=assign({gridWidth:gridWidth,gridHeight:gridHeight,padding:padding},opt);}var ref=this.getFitToContentArea(opt);var x=ref.x;var y=ref.y;var width=ref.width;var height=ref.height;var ref$1=this.scale();var sx=ref$1.sx;var sy=ref$1.sy;this.setOrigin(-x*sx,-y*sy);this.setDimensions(width*sx,height*sy);return new Rect(x,y,width,height);},getFitToContentArea:function(opt){if(opt===void 0)opt={};// Calculate the paper size to accommodate all the graph's elements.\nvar gridWidth=opt.gridWidth||1;var gridHeight=opt.gridHeight||1;var padding=normalizeSides(opt.padding||0);var minWidth=Math.max(opt.minWidth||0,gridWidth);var minHeight=Math.max(opt.minHeight||0,gridHeight);var maxWidth=opt.maxWidth||Number.MAX_VALUE;var maxHeight=opt.maxHeight||Number.MAX_VALUE;var newOrigin=opt.allowNewOrigin;var area='contentArea'in opt?new Rect(opt.contentArea):this.getContentArea(opt);var ref=this.scale();var sx=ref.sx;var sy=ref.sy;area.x*=sx;area.y*=sy;area.width*=sx;area.height*=sy;var calcWidth=Math.ceil((area.width+area.x)/gridWidth);var calcHeight=Math.ceil((area.height+area.y)/gridHeight);if(!opt.allowNegativeBottomRight){calcWidth=Math.max(calcWidth,1);calcHeight=Math.max(calcHeight,1);}calcWidth*=gridWidth;calcHeight*=gridHeight;var tx=0;if(newOrigin==='negative'&&area.x<0||newOrigin==='positive'&&area.x>=0||newOrigin==='any'){tx=Math.ceil(-area.x/gridWidth)*gridWidth;tx+=padding.left;calcWidth+=tx;}var ty=0;if(newOrigin==='negative'&&area.y<0||newOrigin==='positive'&&area.y>=0||newOrigin==='any'){ty=Math.ceil(-area.y/gridHeight)*gridHeight;ty+=padding.top;calcHeight+=ty;}calcWidth+=padding.right;calcHeight+=padding.bottom;// Make sure the resulting width and height are greater than minimum.\ncalcWidth=Math.max(calcWidth,minWidth);calcHeight=Math.max(calcHeight,minHeight);// Make sure the resulting width and height are lesser than maximum.\ncalcWidth=Math.min(calcWidth,maxWidth);calcHeight=Math.min(calcHeight,maxHeight);return new Rect(-tx/sx,-ty/sy,calcWidth/sx,calcHeight/sy);},scaleContentToFit:function(opt){opt||(opt={});var contentBBox,contentLocalOrigin;if('contentArea'in opt){var contentArea=opt.contentArea;contentBBox=this.localToPaperRect(contentArea);contentLocalOrigin=new Point(contentArea);}else{contentBBox=this.getContentBBox(opt);contentLocalOrigin=this.paperToLocalPoint(contentBBox);}if(!contentBBox.width||!contentBBox.height){return;}defaults(opt,{padding:0,preserveAspectRatio:true,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE//minScaleX\n//minScaleY\n//maxScaleX\n//maxScaleY\n//fittingBBox\n});var padding=normalizeSides(opt.padding);var minScaleX=opt.minScaleX||opt.minScale;var maxScaleX=opt.maxScaleX||opt.maxScale;var minScaleY=opt.minScaleY||opt.minScale;var maxScaleY=opt.maxScaleY||opt.maxScale;var fittingBBox;if(opt.fittingBBox){fittingBBox=opt.fittingBBox;}else{var currentTranslate=this.translate();var computedSize=this.getComputedSize();fittingBBox={x:currentTranslate.tx,y:currentTranslate.ty,width:computedSize.width,height:computedSize.height};}fittingBBox=new Rect(fittingBBox).moveAndExpand({x:padding.left,y:padding.top,width:-padding.left-padding.right,height:-padding.top-padding.bottom});var currentScale=this.scale();var newSx=fittingBBox.width/contentBBox.width*currentScale.sx;var newSy=fittingBBox.height/contentBBox.height*currentScale.sy;if(opt.preserveAspectRatio){newSx=newSy=Math.min(newSx,newSy);}// snap scale to a grid\nif(opt.scaleGrid){var gridSize=opt.scaleGrid;newSx=gridSize*Math.floor(newSx/gridSize);newSy=gridSize*Math.floor(newSy/gridSize);}// scale min/max boundaries\nnewSx=Math.min(maxScaleX,Math.max(minScaleX,newSx));newSy=Math.min(maxScaleY,Math.max(minScaleY,newSy));var origin=this.options.origin;var newOx=fittingBBox.x-contentLocalOrigin.x*newSx-origin.x;var newOy=fittingBBox.y-contentLocalOrigin.y*newSy-origin.y;this.scale(newSx,newSy);this.translate(newOx,newOy);},// Return the dimensions of the content area in local units (without transformations).\ngetContentArea:function(opt){if(opt&&opt.useModelGeometry){return this.model.getBBox()||new Rect();}return V(this.cells).getBBox();},// Return the dimensions of the content bbox in the paper units (as it appears on screen).\ngetContentBBox:function(opt){return this.localToPaperRect(this.getContentArea(opt));},// Returns a geometry rectangle representing the entire\n// paper area (coordinates from the left paper border to the right one\n// and the top border to the bottom one).\ngetArea:function(){return this.paperToLocalRect(this.getComputedSize());},getRestrictedArea:function(){var args=[],len=arguments.length;while(len--)args[len]=arguments[len];var ref=this.options;var restrictTranslate=ref.restrictTranslate;var restrictedArea;if(isFunction(restrictTranslate)){// A method returning a bounding box\nrestrictedArea=restrictTranslate.apply(this,args);}else if(restrictTranslate===true){// The paper area\nrestrictedArea=this.getArea();}else if(!restrictTranslate){// falsy value\nrestrictedArea=null;}else{// any other value\nrestrictedArea=new Rect(restrictTranslate);}return restrictedArea;},createViewForModel:function(cell){var ref=this;var options=ref.options;// A class taken from the paper options.\nvar optionalViewClass;// A default basic class (either dia.ElementView or dia.LinkView)\nvar defaultViewClass;// A special class defined for this model in the corresponding namespace.\n// e.g. joint.shapes.basic.Rect searches for joint.shapes.basic.RectView\nvar namespace=options.cellViewNamespace;var type=cell.get('type')+'View';var namespaceViewClass=getByPath(namespace,type,'.');if(cell.isLink()){optionalViewClass=options.linkView;defaultViewClass=LinkView;}else{optionalViewClass=options.elementView;defaultViewClass=ElementView;}// a) the paper options view is a class (deprecated)\n//  1. search the namespace for a view\n//  2. if no view was found, use view from the paper options\n// b) the paper options view is a function\n//  1. call the function from the paper options\n//  2. if no view was return, search the namespace for a view\n//  3. if no view was found, use the default\nvar ViewClass=optionalViewClass.prototype instanceof Backbone.View?namespaceViewClass||optionalViewClass:optionalViewClass.call(this,cell)||namespaceViewClass||defaultViewClass;return new ViewClass({model:cell,interactive:options.interactive,labelsLayer:options.labelsLayer===true?LayersNames.LABELS:options.labelsLayer});},removeView:function(cell){var id=cell.id;var ref=this;var _views=ref._views;var _updates=ref._updates;var view=_views[id];if(view){var cid=view.cid;var mounted=_updates.mounted;var unmounted=_updates.unmounted;view.remove();delete _views[id];delete mounted[cid];delete unmounted[cid];}return view;},renderView:function(cell,opt){var id=cell.id;var views=this._views;var view,flag;var create=true;if(id in views){view=views[id];if(view.model===cell){flag=view.FLAG_INSERT;create=false;}else{// The view for this `id` already exist.\n// The cell is a new instance of the model with identical id\n// We simply remove the existing view and create a new one\nthis.removeView(cell);}}if(create){view=views[id]=this.createViewForModel(cell);view.paper=this;flag=this.registerUnmountedView(view)|view.getFlag(result(view,'initFlag'));}this.requestViewUpdate(view,flag,view.UPDATE_PRIORITY,opt);return view;},onImageDragStart:function(){// This is the only way to prevent image dragging in Firefox that works.\n// Setting -moz-user-select: none, draggable=\"false\" attribute or user-drag: none didn't help.\nreturn false;},resetViews:function(cells,opt){opt||(opt={});cells||(cells=[]);this._resetUpdates();// clearing views removes any event listeners\nthis.removeViews();this.freeze({key:'reset'});for(var i=0,n=cells.length;i<n;i++){this.renderView(cells[i],opt);}this.unfreeze({key:'reset'});this.sortViews();},removeViews:function(){invoke(this._views,'remove');this._views={};},sortViews:function(){if(!this.isExactSorting()){// noop\nreturn;}if(this.isFrozen()){// sort views once unfrozen\nthis._updates.sort=true;return;}this.sortViewsExact();},sortViewsExact:function(){// Run insertion sort algorithm in order to efficiently sort DOM elements according to their\n// associated model `z` attribute.\nvar $cells=$(this.cells).children('[model-id]');var cells=this.model.get('cells');sortElements($cells,function(a,b){var cellA=cells.get(a.getAttribute('model-id'));var cellB=cells.get(b.getAttribute('model-id'));var zA=cellA.attributes.z||0;var zB=cellB.attributes.z||0;return zA===zB?0:zA<zB?-1:1;});},insertView:function(view){var layerView=this.getLayerView(LayersNames.CELLS);var el=view.el;var model=view.model;switch(this.options.sorting){case sortingTypes.APPROX:layerView.insertSortedNode(el,model.get('z'));break;case sortingTypes.EXACT:default:layerView.insertNode(el);break;}view.onMount();},scale:function(sx,sy,ox,oy){// getter\nif(sx===undefined){return V.matrixToScale(this.matrix());}// setter\nif(sy===undefined){sy=sx;}if(ox===undefined){ox=0;oy=0;}var translate=this.translate();if(ox||oy||translate.tx||translate.ty){var newTx=translate.tx-ox*(sx-1);var newTy=translate.ty-oy*(sy-1);this.translate(newTx,newTy);}sx=Math.max(sx||0,this.MIN_SCALE);sy=Math.max(sy||0,this.MIN_SCALE);var ctm=this.matrix();ctm.a=sx;ctm.d=sy;this.matrix(ctm);this.trigger('scale',sx,sy,ox,oy);return this;},// Experimental - do not use in production.\nrotate:function(angle,cx,cy){// getter\nif(angle===undefined){return V.matrixToRotate(this.matrix());}// setter\n// If the origin is not set explicitely, rotate around the center. Note that\n// we must use the plain bounding box (`this.el.getBBox()` instead of the one that gives us\n// the real bounding box (`bbox()`) including transformations).\nif(cx===undefined){var bbox=this.cells.getBBox();cx=bbox.width/2;cy=bbox.height/2;}var ctm=this.matrix().translate(cx,cy).rotate(angle).translate(-cx,-cy);this.matrix(ctm);return this;},translate:function(tx,ty){// getter\nif(tx===undefined){return V.matrixToTranslate(this.matrix());}var ref=this;var options=ref.options;var origin=options.origin;var drawGrid=options.drawGrid;// setter\ntx||(tx=0);ty||(ty=0);var ctm=this.matrix();if(ctm.e===tx&&ctm.f===ty){return this;}ctm.e=tx;ctm.f=ty;this.matrix(ctm);var ref$1=this.translate();var ox=ref$1.tx;var oy=ref$1.ty;origin.x=ox;origin.y=oy;this.trigger('translate',ox,oy);if(drawGrid){this.drawGrid();}return this;},// Find the first view climbing up the DOM tree starting at element `el`. Note that `el` can also\n// be a selector or a jQuery object.\nfindView:function($el){var el=isString($el)?this.cells.querySelector($el):$el instanceof $?$el[0]:$el;var id=this.findAttribute('model-id',el);if(id){return this._views[id];}return undefined;},// Find a view for a model `cell`. `cell` can also be a string or number representing a model `id`.\nfindViewByModel:function(cell){var id=isString(cell)||isNumber(cell)?cell:cell&&cell.id;return this._views[id];},// Find all views at given point\nfindViewsFromPoint:function(p){p=new Point(p);var views=this.model.getElements().map(this.findViewByModel,this);return views.filter(function(view){return view&&view.vel.getBBox({target:this.cells}).containsPoint(p);},this);},// Find all views in given area\nfindViewsInArea:function(rect,opt){opt=defaults(opt||{},{strict:false});rect=new Rect(rect);var views=this.model.getElements().map(this.findViewByModel,this);var method=opt.strict?'containsRect':'intersect';return views.filter(function(view){return view&&rect[method](view.vel.getBBox({target:this.cells}));},this);},removeTools:function(){this.dispatchToolsEvent('remove');return this;},hideTools:function(){this.dispatchToolsEvent('hide');return this;},showTools:function(){this.dispatchToolsEvent('show');return this;},dispatchToolsEvent:function(event){var ref;var args=[],len=arguments.length-1;while(len-->0)args[len]=arguments[len+1];if(typeof event!=='string'){return;}(ref=this).trigger.apply(ref,['tools:event',event].concat(args));},getModelById:function(id){return this.model.getCell(id);},snapToGrid:function(x,y){// Convert global coordinates to the local ones of the `viewport`. Otherwise,\n// improper transformation would be applied when the viewport gets transformed (scaled/rotated).\nreturn this.clientToLocalPoint(x,y).snapToGrid(this.options.gridSize);},localToPaperPoint:function(x,y){// allow `x` to be a point and `y` undefined\nvar localPoint=new Point(x,y);var paperPoint=V.transformPoint(localPoint,this.matrix());return paperPoint;},localToPaperRect:function(x,y,width,height){// allow `x` to be a rectangle and rest arguments undefined\nvar localRect=new Rect(x,y,width,height);var paperRect=V.transformRect(localRect,this.matrix());return paperRect;},paperToLocalPoint:function(x,y){// allow `x` to be a point and `y` undefined\nvar paperPoint=new Point(x,y);var localPoint=V.transformPoint(paperPoint,this.matrix().inverse());return localPoint;},paperToLocalRect:function(x,y,width,height){// allow `x` to be a rectangle and rest arguments undefined\nvar paperRect=new Rect(x,y,width,height);var localRect=V.transformRect(paperRect,this.matrix().inverse());return localRect;},localToClientPoint:function(x,y){// allow `x` to be a point and `y` undefined\nvar localPoint=new Point(x,y);var clientPoint=V.transformPoint(localPoint,this.clientMatrix());return clientPoint;},localToClientRect:function(x,y,width,height){// allow `x` to be a point and `y` undefined\nvar localRect=new Rect(x,y,width,height);var clientRect=V.transformRect(localRect,this.clientMatrix());return clientRect;},// Transform client coordinates to the paper local coordinates.\n// Useful when you have a mouse event object and you'd like to get coordinates\n// inside the paper that correspond to `evt.clientX` and `evt.clientY` point.\n// Example: var localPoint = paper.clientToLocalPoint({ x: evt.clientX, y: evt.clientY });\nclientToLocalPoint:function(x,y){// allow `x` to be a point and `y` undefined\nvar clientPoint=new Point(x,y);var localPoint=V.transformPoint(clientPoint,this.clientMatrix().inverse());return localPoint;},clientToLocalRect:function(x,y,width,height){// allow `x` to be a point and `y` undefined\nvar clientRect=new Rect(x,y,width,height);var localRect=V.transformRect(clientRect,this.clientMatrix().inverse());return localRect;},localToPagePoint:function(x,y){return this.localToPaperPoint(x,y).offset(this.pageOffset());},localToPageRect:function(x,y,width,height){return this.localToPaperRect(x,y,width,height).offset(this.pageOffset());},pageToLocalPoint:function(x,y){var pagePoint=new Point(x,y);var paperPoint=pagePoint.difference(this.pageOffset());return this.paperToLocalPoint(paperPoint);},pageToLocalRect:function(x,y,width,height){var pageOffset=this.pageOffset();var paperRect=new Rect(x,y,width,height);paperRect.x-=pageOffset.x;paperRect.y-=pageOffset.y;return this.paperToLocalRect(paperRect);},clientOffset:function(){var clientRect=this.svg.getBoundingClientRect();return new Point(clientRect.left,clientRect.top);},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY);},linkAllowed:function(linkView){if(!(linkView instanceof LinkView)){throw new Error('Must provide a linkView.');}var link=linkView.model;var paperOptions=this.options;var graph=this.model;var ns=graph.constructor.validations;if(!paperOptions.multiLinks){if(!ns.multiLinks.call(this,graph,link)){return false;}}if(!paperOptions.linkPinning){// Link pinning is not allowed and the link is not connected to the target.\nif(!ns.linkPinning.call(this,graph,link)){return false;}}if(typeof paperOptions.allowLink==='function'){if(!paperOptions.allowLink.call(this,linkView,this)){return false;}}return true;},getDefaultLink:function(cellView,magnet){return isFunction(this.options.defaultLink)// default link is a function producing link model\n?this.options.defaultLink.call(this,cellView,magnet)// default link is the Backbone model\n:this.options.defaultLink.clone();},// Cell highlighting.\n// ------------------\nresolveHighlighter:function(opt){if(opt===void 0)opt={};var highlighterDef=opt.highlighter;var type=opt.type;var ref=this.options;var highlighting=ref.highlighting;var highlighterNamespace=ref.highlighterNamespace;/*\n\t            Expecting opt.highlighter to have the following structure:\n\t            {\n\t                name: 'highlighter-name',\n\t                options: {\n\t                    some: 'value'\n\t                }\n\t            }\n\t        */if(highlighterDef===undefined){// Is highlighting disabled?\nif(!highlighting){return false;}// check for built-in types\nif(type){highlighterDef=highlighting[type];// Is a specific type highlight disabled?\nif(highlighterDef===false){return false;}}if(!highlighterDef){// Type not defined use default highlight\nhighlighterDef=highlighting['default'];}}// Do nothing if opt.highlighter is falsy.\n// This allows the case to not highlight cell(s) in certain cases.\n// For example, if you want to NOT highlight when embedding elements\n// or use a custom highlighter.\nif(!highlighterDef){return false;}// Allow specifying a highlighter by name.\nif(isString(highlighterDef)){highlighterDef={name:highlighterDef};}var name=highlighterDef.name;var highlighter=highlighterNamespace[name];// Highlighter validation\nif(!highlighter){throw new Error('Unknown highlighter (\"'+name+'\")');}if(typeof highlighter.highlight!=='function'){throw new Error('Highlighter (\"'+name+'\") is missing required highlight() method');}if(typeof highlighter.unhighlight!=='function'){throw new Error('Highlighter (\"'+name+'\") is missing required unhighlight() method');}return{highlighter:highlighter,options:highlighterDef.options||{},name:name};},onCellHighlight:function(cellView,magnetEl,opt){var highlighterDescriptor=this.resolveHighlighter(opt);if(!highlighterDescriptor){return;}var highlighter=highlighterDescriptor.highlighter;var options=highlighterDescriptor.options;highlighter.highlight(cellView,magnetEl,options);},onCellUnhighlight:function(cellView,magnetEl,opt){var highlighterDescriptor=this.resolveHighlighter(opt);if(!highlighterDescriptor){return;}var highlighter=highlighterDescriptor.highlighter;var options=highlighterDescriptor.options;highlighter.unhighlight(cellView,magnetEl,options);},// Interaction.\n// ------------\npointerdblclick:function(evt){evt.preventDefault();// magnetpointerdblclick can stop propagation\nevt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);if(view){view.pointerdblclick(evt,localPoint.x,localPoint.y);}else{this.trigger('blank:pointerdblclick',evt,localPoint.x,localPoint.y);}},pointerclick:function(evt){// magnetpointerclick can stop propagation\nvar data=this.eventData(evt);// Trigger event only if mouse has not moved.\nif(data.mousemoved<=this.options.clickThreshold){evt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);if(view){view.pointerclick(evt,localPoint.x,localPoint.y);}else{this.trigger('blank:pointerclick',evt,localPoint.x,localPoint.y);}}},contextmenu:function(evt){if(this.options.preventContextMenu){evt.preventDefault();}evt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);if(view){view.contextmenu(evt,localPoint.x,localPoint.y);}else{this.trigger('blank:contextmenu',evt,localPoint.x,localPoint.y);}},pointerdown:function(evt){// onmagnet stops propagation when `addLinkFromMagnet` is allowed\n// onevent can stop propagation\nevt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);if(view){evt.preventDefault();view.pointerdown(evt,localPoint.x,localPoint.y);}else{if(this.options.preventDefaultBlankAction){evt.preventDefault();}this.trigger('blank:pointerdown',evt,localPoint.x,localPoint.y);}this.delegateDragEvents(view,evt.data);},pointermove:function(evt){// mouse moved counter\nvar data=this.eventData(evt);data.mousemoved||(data.mousemoved=0);var mousemoved=++data.mousemoved;if(mousemoved<=this.options.moveThreshold){return;}evt=normalizeEvent(evt);var localPoint=this.snapToGrid(evt.clientX,evt.clientY);var view=data.sourceView;if(view){view.pointermove(evt,localPoint.x,localPoint.y);}else{this.trigger('blank:pointermove',evt,localPoint.x,localPoint.y);}this.eventData(evt,data);},pointerup:function(evt){this.undelegateDocumentEvents();var normalizedEvt=normalizeEvent(evt);var localPoint=this.snapToGrid(normalizedEvt.clientX,normalizedEvt.clientY);var view=this.eventData(evt).sourceView;if(view){view.pointerup(normalizedEvt,localPoint.x,localPoint.y);}else{this.trigger('blank:pointerup',normalizedEvt,localPoint.x,localPoint.y);}if(!normalizedEvt.isPropagationStopped()){this.pointerclick($.Event(evt,{type:'click',data:evt.data}));}evt.stopImmediatePropagation();this.delegateEvents();},mouseover:function(evt){evt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}if(view){view.mouseover(evt);}else{if(this.el===evt.target){return;}// prevent border of paper from triggering this\nthis.trigger('blank:mouseover',evt);}},mouseout:function(evt){evt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}if(view){view.mouseout(evt);}else{if(this.el===evt.target){return;}// prevent border of paper from triggering this\nthis.trigger('blank:mouseout',evt);}},mouseenter:function(evt){evt=normalizeEvent(evt);var target=evt.target;var relatedTarget=evt.relatedTarget;var currentTarget=evt.currentTarget;var view=this.findView(target);if(this.guard(evt,view)){return;}var relatedView=this.findView(relatedTarget);if(view){if(relatedView===view){// Mouse left a cell tool\nreturn;}view.mouseenter(evt);if(this.el.contains(relatedTarget)){// The pointer remains inside the paper.\nreturn;}}if(relatedView){return;}// prevent double `mouseenter` event if the `relatedTarget` is outside the paper\n// (mouseenter method would be fired twice)\nif(currentTarget===this.el){// `paper` (more descriptive), not `blank`\nthis.trigger('paper:mouseenter',evt);}},mouseleave:function(evt){evt=normalizeEvent(evt);var target=evt.target;var relatedTarget=evt.relatedTarget;var currentTarget=evt.currentTarget;var view=this.findView(target);if(this.guard(evt,view)){return;}var relatedView=this.findView(relatedTarget);if(view){if(relatedView===view){// Mouse entered a cell tool\nreturn;}view.mouseleave(evt);if(this.el.contains(relatedTarget)){// The pointer has exited a cellView. The pointer is still inside of the paper.\nreturn;}}if(relatedView){// The pointer has entered a new cellView\nreturn;}// prevent double `mouseleave` event if the `relatedTarget` is outside the paper\n// (mouseleave method would be fired twice)\nif(currentTarget===this.el){// There is no cellView under the pointer, nor the blank area of the paper\nthis.trigger('paper:mouseleave',evt);}},mousewheel:function(evt){evt=normalizeEvent(evt);var view=this.findView(evt.target);if(this.guard(evt,view)){return;}var originalEvent=evt.originalEvent;var localPoint=this.snapToGrid(originalEvent.clientX,originalEvent.clientY);var delta=Math.max(-1,Math.min(1,originalEvent.wheelDelta));if(view){view.mousewheel(evt,localPoint.x,localPoint.y,delta);}else{this.trigger('blank:mousewheel',evt,localPoint.x,localPoint.y,delta);}},onevent:function(evt){var eventNode=evt.currentTarget;var eventName=eventNode.getAttribute('event');if(eventName){var view=this.findView(eventNode);if(view){evt=normalizeEvent(evt);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);view.onevent(evt,eventName,localPoint.x,localPoint.y);}}},magnetEvent:function(evt,handler){var magnetNode=evt.currentTarget;var magnetValue=magnetNode.getAttribute('magnet');if(magnetValue){var view=this.findView(magnetNode);if(view){evt=normalizeEvent(evt);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);handler.call(this,view,evt,magnetNode,localPoint.x,localPoint.y);}}},onmagnet:function(evt){this.magnetEvent(evt,function(view,evt,_,x,y){view.onmagnet(evt,x,y);});},magnetpointerdblclick:function(evt){this.magnetEvent(evt,function(view,evt,magnet,x,y){view.magnetpointerdblclick(evt,magnet,x,y);});},magnetcontextmenu:function(evt){if(this.options.preventContextMenu){evt.preventDefault();}this.magnetEvent(evt,function(view,evt,magnet,x,y){view.magnetcontextmenu(evt,magnet,x,y);});},onlabel:function(evt){var labelNode=evt.currentTarget;var view=this.findView(labelNode);if(view){evt=normalizeEvent(evt);if(this.guard(evt,view)){return;}var localPoint=this.snapToGrid(evt.clientX,evt.clientY);view.onlabel(evt,localPoint.x,localPoint.y);}},getPointerArgs:function getPointerArgs(evt){var normalizedEvt=normalizeEvent(evt);var ref=this.snapToGrid(normalizedEvt.clientX,normalizedEvt.clientY);var x=ref.x;var y=ref.y;return[normalizedEvt,x,y];},delegateDragEvents:function(view,data){data||(data={});this.eventData({data:data},{sourceView:view||null,mousemoved:0});this.delegateDocumentEvents(null,data);this.undelegateEvents();},// Guard the specified event. If the event is not interesting, guard returns `true`.\n// Otherwise, it returns `false`.\nguard:function(evt,view){if(evt.type==='mousedown'&&evt.button===2){// handled as `contextmenu` type\nreturn true;}if(this.options.guard&&this.options.guard(evt,view)){return true;}if(evt.data&&evt.data.guarded!==undefined){return evt.data.guarded;}if(view&&view.model&&view.model instanceof Cell){return false;}if(this.svg===evt.target||this.el===evt.target||$.contains(this.svg,evt.target)){return false;}return true;// Event guarded. Paper should not react on it in any way.\n},setGridSize:function(gridSize){this.options.gridSize=gridSize;if(this.options.drawGrid){this.drawGrid();}return this;},clearGrid:function(){if(this.$grid){this.$grid.css('backgroundImage','none');}return this;},_getGridRefs:function(){if(!this._gridCache){this._gridCache={root:V('svg',{width:'100%',height:'100%'},V('defs')),patterns:{},add:function(id,vel){V(this.root.node.childNodes[0]).append(vel);this.patterns[id]=vel;this.root.append(V('rect',{width:'100%',height:'100%',fill:'url(#'+id+')'}));},get:function(id){return this.patterns[id];},exist:function(id){return this.patterns[id]!==undefined;}};}return this._gridCache;},setGrid:function(drawGrid){this.clearGrid();this._gridCache=null;this._gridSettings=[];var optionsList=Array.isArray(drawGrid)?drawGrid:[drawGrid||{}];optionsList.forEach(function(item){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(item));},this);return this;},_resolveDrawGridOption:function(opt){var namespace=this.constructor.gridPatterns;if(isString(opt)&&Array.isArray(namespace[opt])){return namespace[opt].map(function(item){return assign({},item);});}var options=opt||{args:[{}]};var isArray=Array.isArray(options);var name=options.name;if(!isArray&&!name&&!options.markup){name='dot';}if(name&&Array.isArray(namespace[name])){var pattern=namespace[name].map(function(item){return assign({},item);});var args=Array.isArray(options.args)?options.args:[options.args||{}];defaults(args[0],omit(opt,'args'));for(var i=0;i<args.length;i++){if(pattern[i]){assign(pattern[i],args[i]);}}return pattern;}return isArray?options:[options];},drawGrid:function(opt){var gridSize=this.options.gridSize;if(gridSize<=1){return this.clearGrid();}var localOptions=Array.isArray(opt)?opt:[opt];var ctm=this.matrix();var refs=this._getGridRefs();this._gridSettings.forEach(function(gridLayerSetting,index){var id='pattern_'+index;var options=merge(gridLayerSetting,localOptions[index],{sx:ctm.a||1,sy:ctm.d||1,ox:ctm.e||0,oy:ctm.f||0});options.width=gridSize*(ctm.a||1)*(options.scaleFactor||1);options.height=gridSize*(ctm.d||1)*(options.scaleFactor||1);if(!refs.exist(id)){refs.add(id,V('pattern',{id:id,patternUnits:'userSpaceOnUse'},V(options.markup)));}var patternDefVel=refs.get(id);if(isFunction(options.update)){options.update(patternDefVel.node.childNodes[0],options);}var x=options.ox%options.width;if(x<0){x+=options.width;}var y=options.oy%options.height;if(y<0){y+=options.height;}patternDefVel.attr({x:x,y:y,width:options.width,height:options.height});});var patternUri=new XMLSerializer().serializeToString(refs.root.node);patternUri='url(data:image/svg+xml;base64,'+btoa(patternUri)+')';this.$grid.css('backgroundImage',patternUri);return this;},updateBackgroundImage:function(opt){opt=opt||{};var backgroundPosition=opt.position||'center';var backgroundSize=opt.size||'auto auto';var currentScale=this.scale();var currentTranslate=this.translate();// backgroundPosition\nif(isObject$1(backgroundPosition)){var x=currentTranslate.tx+currentScale.sx*(backgroundPosition.x||0);var y=currentTranslate.ty+currentScale.sy*(backgroundPosition.y||0);backgroundPosition=x+'px '+y+'px';}// backgroundSize\nif(isObject$1(backgroundSize)){backgroundSize=new Rect(backgroundSize).scale(currentScale.sx,currentScale.sy);backgroundSize=backgroundSize.width+'px '+backgroundSize.height+'px';}this.$background.css({backgroundSize:backgroundSize,backgroundPosition:backgroundPosition});},drawBackgroundImage:function(img,opt){// Clear the background image if no image provided\nif(!(img instanceof HTMLImageElement)){this.$background.css('backgroundImage','');return;}if(!this._background||this._background.id!==opt.id){// Draw only the last image requested (see drawBackground())\nreturn;}opt=opt||{};var backgroundImage;var backgroundSize=opt.size;var backgroundRepeat=opt.repeat||'no-repeat';var backgroundOpacity=opt.opacity||1;var backgroundQuality=Math.abs(opt.quality)||1;var backgroundPattern=this.constructor.backgroundPatterns[camelCase(backgroundRepeat)];if(isFunction(backgroundPattern)){// 'flip-x', 'flip-y', 'flip-xy', 'watermark' and custom\nimg.width*=backgroundQuality;img.height*=backgroundQuality;var canvas=backgroundPattern(img,opt);if(!(canvas instanceof HTMLCanvasElement)){throw new Error('dia.Paper: background pattern must return an HTML Canvas instance');}backgroundImage=canvas.toDataURL('image/png');backgroundRepeat='repeat';if(isObject$1(backgroundSize)){// recalculate the tile size if an object passed in\nbackgroundSize.width*=canvas.width/img.width;backgroundSize.height*=canvas.height/img.height;}else if(backgroundSize===undefined){// calculate the tile size if no provided\nopt.size={width:canvas.width/backgroundQuality,height:canvas.height/backgroundQuality};}}else{// backgroundRepeat:\n// no-repeat', 'round', 'space', 'repeat', 'repeat-x', 'repeat-y'\nbackgroundImage=img.src;if(backgroundSize===undefined){// pass the image size for  the backgroundSize if no size provided\nopt.size={width:img.width,height:img.height};}}this.$background.css({opacity:backgroundOpacity,backgroundRepeat:backgroundRepeat,backgroundImage:'url('+backgroundImage+')'});this.updateBackgroundImage(opt);},updateBackgroundColor:function(color){this.$el.css('backgroundColor',color||'');},drawBackground:function(opt){opt=opt||{};this.updateBackgroundColor(opt.color);if(opt.image){opt=this._background=cloneDeep(opt);guid(opt);var img=document.createElement('img');img.onload=this.drawBackgroundImage.bind(this,img,opt);img.src=opt.image;}else{this.drawBackgroundImage(null);this._background=null;}return this;},setInteractivity:function(value){this.options.interactive=value;invoke(this._views,'setInteractivity',value);},// Paper definitions.\n// ------------------\nisDefined:function(defId){return!!this.svg.getElementById(defId);},defineFilter:function(filter$1){if(!isObject$1(filter$1)){throw new TypeError('dia.Paper: defineFilter() requires 1. argument to be an object.');}var filterId=filter$1.id;var name=filter$1.name;// Generate a hash code from the stringified filter definition. This gives us\n// a unique filter ID for different definitions.\nif(!filterId){filterId=name+this.svg.id+hashCode(JSON.stringify(filter$1));}// If the filter already exists in the document,\n// we're done and we can just use it (reference it using `url()`).\n// If not, create one.\nif(!this.isDefined(filterId)){var namespace=filter;var filterSVGString=namespace[name]&&namespace[name](filter$1.args||{});if(!filterSVGString){throw new Error('Non-existing filter '+name);}// Set the filter area to be 3x the bounding box of the cell\n// and center the filter around the cell.\nvar filterAttrs=assign({filterUnits:'objectBoundingBox',x:-1,y:-1,width:3,height:3},filter$1.attrs,{id:filterId});V(filterSVGString,filterAttrs).appendTo(this.defs);}return filterId;},defineGradient:function(gradient){if(!isObject$1(gradient)){throw new TypeError('dia.Paper: defineGradient() requires 1. argument to be an object.');}var ref=this;var svg=ref.svg;var defs=ref.defs;var type=gradient.type;var id=gradient.id;if(id===void 0)id=type+svg.id+hashCode(JSON.stringify(gradient));var stops=gradient.stops;var attrs=gradient.attrs;if(attrs===void 0)attrs={};// If the gradient already exists in the document,\n// we're done and we can just use it (reference it using `url()`).\nif(this.isDefined(id)){return id;}// If not, create one.\nvar stopVEls=toArray(stops).map(function(ref){var offset=ref.offset;var color=ref.color;var opacity=ref.opacity;return V('stop').attr({'offset':offset,'stop-color':color,'stop-opacity':Number.isFinite(opacity)?opacity:1});});var gradientVEl=V(type,attrs,stopVEls);gradientVEl.id=id;gradientVEl.appendTo(defs);return id;},definePattern:function(pattern){if(!isObject$1(pattern)){throw new TypeError('dia.Paper: definePattern() requires 1. argument to be an object.');}var ref=this;var svg=ref.svg;var defs=ref.defs;var id=pattern.id;if(id===void 0)id=svg.id+hashCode(JSON.stringify(pattern));var markup=pattern.markup;var attrs=pattern.attrs;if(attrs===void 0)attrs={};if(!markup){throw new TypeError('dia.Paper: definePattern() requires markup.');}// If the gradient already exists in the document,\n// we're done and we can just use it (reference it using `url()`).\nif(this.isDefined(id)){return id;}// If not, create one.\nvar patternVEl=V('pattern',{patternUnits:'userSpaceOnUse'});patternVEl.id=id;patternVEl.attr(attrs);if(typeof markup==='string'){patternVEl.append(V(markup));}else{var ref$1=parseDOMJSON(markup);var fragment=ref$1.fragment;patternVEl.append(fragment);}patternVEl.appendTo(defs);return id;},defineMarker:function(marker){if(!isObject$1(marker)){throw new TypeError('dia.Paper: defineMarker() requires 1. argument to be an object.');}var ref=this;var svg=ref.svg;var defs=ref.defs;var id=marker.id;if(id===void 0)id=svg.id+hashCode(JSON.stringify(marker));var markup=marker.markup;var attrs=marker.attrs;if(attrs===void 0)attrs={};var markerUnits=marker.markerUnits;if(markerUnits===void 0)markerUnits='userSpaceOnUse';// If the marker already exists in the document,\n// we're done and we can just use it (reference it using `url()`).\nif(this.isDefined(id)){return id;}// If not, create one.\nvar markerVEl=V('marker',{orient:'auto',overflow:'visible',markerUnits:markerUnits});markerVEl.id=id;markerVEl.attr(attrs);if(markup){if(typeof markup==='string'){markerVEl.append(V(markup));}else{var ref$1=parseDOMJSON(markup);var fragment=ref$1.fragment;markerVEl.append(fragment);}}else{// marker object is a flat structure\nvar type=marker.type;if(type===void 0)type='path';var markerContentVEl=V(type,omit(marker,'type','id','markup','attrs','markerUnits'));markerVEl.append(markerContentVEl);}markerVEl.appendTo(defs);return id;}},{sorting:sortingTypes,Layers:LayersNames,backgroundPatterns:{flipXy:function(img){// d b\n// q p\nvar canvas=document.createElement('canvas');var imgWidth=img.width;var imgHeight=img.height;canvas.width=2*imgWidth;canvas.height=2*imgHeight;var ctx=canvas.getContext('2d');// top-left image\nctx.drawImage(img,0,0,imgWidth,imgHeight);// xy-flipped bottom-right image\nctx.setTransform(-1,0,0,-1,canvas.width,canvas.height);ctx.drawImage(img,0,0,imgWidth,imgHeight);// x-flipped top-right image\nctx.setTransform(-1,0,0,1,canvas.width,0);ctx.drawImage(img,0,0,imgWidth,imgHeight);// y-flipped bottom-left image\nctx.setTransform(1,0,0,-1,0,canvas.height);ctx.drawImage(img,0,0,imgWidth,imgHeight);return canvas;},flipX:function(img){// d b\n// d b\nvar canvas=document.createElement('canvas');var imgWidth=img.width;var imgHeight=img.height;canvas.width=imgWidth*2;canvas.height=imgHeight;var ctx=canvas.getContext('2d');// left image\nctx.drawImage(img,0,0,imgWidth,imgHeight);// flipped right image\nctx.translate(2*imgWidth,0);ctx.scale(-1,1);ctx.drawImage(img,0,0,imgWidth,imgHeight);return canvas;},flipY:function(img){// d d\n// q q\nvar canvas=document.createElement('canvas');var imgWidth=img.width;var imgHeight=img.height;canvas.width=imgWidth;canvas.height=imgHeight*2;var ctx=canvas.getContext('2d');// top image\nctx.drawImage(img,0,0,imgWidth,imgHeight);// flipped bottom image\nctx.translate(0,2*imgHeight);ctx.scale(1,-1);ctx.drawImage(img,0,0,imgWidth,imgHeight);return canvas;},watermark:function(img,opt){//   d\n// d\nopt=opt||{};var imgWidth=img.width;var imgHeight=img.height;var canvas=document.createElement('canvas');canvas.width=imgWidth*3;canvas.height=imgHeight*3;var ctx=canvas.getContext('2d');var angle=isNumber(opt.watermarkAngle)?-opt.watermarkAngle:-20;var radians=toRad(angle);var stepX=canvas.width/4;var stepY=canvas.height/4;for(var i=0;i<4;i++){for(var j=0;j<4;j++){if((i+j)%2>0){// reset the current transformations\nctx.setTransform(1,0,0,1,(2*i-1)*stepX,(2*j-1)*stepY);ctx.rotate(radians);ctx.drawImage(img,-imgWidth/2,-imgHeight/2,imgWidth,imgHeight);}}}return canvas;}},gridPatterns:{dot:[{color:'#AAAAAA',thickness:1,markup:'rect',update:function(el,opt){V(el).attr({width:opt.thickness*opt.sx,height:opt.thickness*opt.sy,fill:opt.color});}}],fixedDot:[{color:'#AAAAAA',thickness:1,markup:'rect',update:function(el,opt){var size=opt.sx<=1?opt.thickness*opt.sx:opt.thickness;V(el).attr({width:size,height:size,fill:opt.color});}}],mesh:[{color:'#AAAAAA',thickness:1,markup:'path',update:function(el,opt){var d;var width=opt.width;var height=opt.height;var thickness=opt.thickness;if(width-thickness>=0&&height-thickness>=0){d=['M',width,0,'H0 M0 0 V0',height].join(' ');}else{d='M 0 0 0 0';}V(el).attr({'d':d,stroke:opt.color,'stroke-width':opt.thickness});}}],doubleMesh:[{color:'#AAAAAA',thickness:1,markup:'path',update:function(el,opt){var d;var width=opt.width;var height=opt.height;var thickness=opt.thickness;if(width-thickness>=0&&height-thickness>=0){d=['M',width,0,'H0 M0 0 V0',height].join(' ');}else{d='M 0 0 0 0';}V(el).attr({'d':d,stroke:opt.color,'stroke-width':opt.thickness});}},{color:'#000000',thickness:3,scaleFactor:4,markup:'path',update:function(el,opt){var d;var width=opt.width;var height=opt.height;var thickness=opt.thickness;if(width-thickness>=0&&height-thickness>=0){d=['M',width,0,'H0 M0 0 V0',height].join(' ');}else{d='M 0 0 0 0';}V(el).attr({'d':d,stroke:opt.color,'stroke-width':opt.thickness});}}]}});var ToolView=View.extend({name:null,tagName:'g',className:'tool',svgElement:true,_visible:true,init:function(){var name=this.name;if(name){this.vel.attr('data-tool-name',name);}},configure:function(view,toolsView){this.relatedView=view;this.paper=view.paper;this.parentView=toolsView;this.simulateRelatedView(this.el);// Delegate events in case the ToolView was removed from the DOM and reused.\nthis.delegateEvents();return this;},simulateRelatedView:function(el){if(el){el.setAttribute('model-id',this.relatedView.model.id);}},getName:function(){return this.name;},show:function(){this.el.style.display='';this._visible=true;},hide:function(){this.el.style.display='none';this._visible=false;},isVisible:function(){return!!this._visible;},focus:function(){var opacity=this.options.focusOpacity;if(isFinite(opacity)){this.el.style.opacity=opacity;}this.parentView.focusTool(this);},blur:function(){this.el.style.opacity='';this.parentView.blurTool(this);},update:function(){// to be overridden\n},guard:function(evt){// Let the context-menu event bubble up to the relatedView\nvar ref=this;var paper=ref.paper;var relatedView=ref.relatedView;if(!paper||!relatedView){return true;}return paper.guard(evt,relatedView);}});var ToolsView=View.extend({tagName:'g',className:'tools',svgElement:true,tools:null,isRendered:false,options:{tools:null,relatedView:null,name:null// layer?: LayersNames.TOOLS\n// z?: number\n},configure:function(options){options=assign(this.options,options);var tools=options.tools;if(!Array.isArray(tools)){return this;}var relatedView=options.relatedView;if(!(relatedView instanceof CellView)){return this;}var views=this.tools=[];for(var i=0,n=tools.length;i<n;i++){var tool=tools[i];if(!(tool instanceof ToolView)){continue;}tool.configure(relatedView,this);this.vel.append(tool.el);views.push(tool);}this.isRendered=false;relatedView.requestUpdate(relatedView.getFlag('TOOLS'));return this;},getName:function(){return this.options.name;},update:function(opt){opt||(opt={});var tools=this.tools;if(!tools){return this;}var isRendered=this.isRendered;for(var i=0,n=tools.length;i<n;i++){var tool=tools[i];if(!isRendered){// First update executes render()\ntool.render();}else if(opt.tool!==tool.cid&&tool.isVisible()){tool.update();}}if(!isRendered){this.mount();// Make sure tools are visible (if they were hidden and the tool removed)\nthis.blurTool();this.isRendered=true;}return this;},focusTool:function(focusedTool){var tools=this.tools;if(!tools){return this;}for(var i=0,n=tools.length;i<n;i++){var tool=tools[i];if(focusedTool===tool){tool.show();}else{tool.hide();}}return this;},blurTool:function(blurredTool){var tools=this.tools;if(!tools){return this;}for(var i=0,n=tools.length;i<n;i++){var tool=tools[i];if(tool!==blurredTool&&!tool.isVisible()){tool.show();tool.update();}}return this;},hide:function(){return this.focusTool(null);},show:function(){return this.blurTool(null);},onRemove:function(){var tools=this.tools;if(!tools){return this;}for(var i=0,n=tools.length;i<n;i++){tools[i].remove();}this.tools=null;},mount:function(){var ref=this;var options=ref.options;var el=ref.el;var relatedView=options.relatedView;var layer=options.layer;if(layer===void 0)layer=LayersNames.TOOLS;var z=options.z;if(relatedView){if(layer){relatedView.paper.getLayerView(layer).insertSortedNode(el,z);}else{relatedView.el.appendChild(el);}}return this;}});var index$2={Graph:Graph,attributes:attributes,LayersNames:LayersNames,PaperLayer:PaperLayer,Cell:Cell,CellView:CellView,Element:Element$1,ElementView:ElementView,Link:Link,LinkView:LinkView,Paper:Paper,ToolView:ToolView,ToolsView:ToolsView,HighlighterView:HighlighterView};var DirectedGraph={exportElement:function(element){// The width and height of the element.\nreturn element.size();},exportLink:function(link){var labelSize=link.get('labelSize')||{};var edge={// The number of ranks to keep between the source and target of the edge.\nminLen:link.get('minLen')||1,// The weight to assign edges. Higher weight edges are generally\n// made shorter and straighter than lower weight edges.\nweight:link.get('weight')||1,// Where to place the label relative to the edge.\n// l = left, c = center r = right.\nlabelpos:link.get('labelPosition')||'c',// How many pixels to move the label away from the edge.\n// Applies only when labelpos is l or r.\nlabeloffset:link.get('labelOffset')||0,// The width of the edge label in pixels.\nwidth:labelSize.width||0,// The height of the edge label in pixels.\nheight:labelSize.height||0};return edge;},importElement:function(opt,v,gl){var element=this.getCell(v);var glNode=gl.node(v);if(opt.setPosition){opt.setPosition(element,glNode);}else{element.set('position',{x:glNode.x-glNode.width/2,y:glNode.y-glNode.height/2});}},importLink:function(opt,edgeObj,gl){var SIMPLIFY_THRESHOLD=0.001;var link=this.getCell(edgeObj.name);var glEdge=gl.edge(edgeObj);var points=glEdge.points||[];var polyline=new Polyline(points);// check the `setLinkVertices` here for backwards compatibility\nif(opt.setVertices||opt.setLinkVertices){if(isFunction(opt.setVertices)){opt.setVertices(link,points);}else{// simplify the `points` polyline\npolyline.simplify({threshold:SIMPLIFY_THRESHOLD});var polylinePoints=polyline.points.map(function(point){return point.toJSON();});// JSON of points after simplification\nvar numPolylinePoints=polylinePoints.length;// number of points after simplification\n// set simplified polyline points as link vertices\n// remove first and last polyline points (= source/target sonnectionPoints)\nlink.set('vertices',polylinePoints.slice(1,numPolylinePoints-1));}}if(opt.setLabels&&'x'in glEdge&&'y'in glEdge){var labelPosition={x:glEdge.x,y:glEdge.y};if(isFunction(opt.setLabels)){opt.setLabels(link,labelPosition,points);}else{// convert the absolute label position to a relative position\n// towards the closest point on the edge\nvar length=polyline.closestPointLength(labelPosition);var closestPoint=polyline.pointAtLength(length);var distance=length/polyline.length();var offset=new Point(labelPosition).difference(closestPoint).toJSON();link.label(0,{position:{distance:distance,offset:offset}});}}},layout:function(graphOrCells,opt){var graph;if(graphOrCells instanceof Graph){graph=graphOrCells;}else{// Reset cells in dry mode so the graph reference is not stored on the cells.\n// `sort: false` to prevent elements to change their order based on the z-index\ngraph=new Graph().resetCells(graphOrCells,{dry:true,sort:false});}// This is not needed anymore.\ngraphOrCells=null;opt=defaults(opt||{},{resizeClusters:true,clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink});/* eslint-disable no-undef */var dagreUtil=opt.dagre||(typeof dagre!=='undefined'?dagre:undefined);/* eslint-enable no-undef */if(dagreUtil===undefined){throw new Error('The the \"dagre\" utility is a mandatory dependency.');}// create a graphlib.Graph that represents the joint.dia.Graph\n// var glGraph = graph.toGraphLib({\nvar glGraph=DirectedGraph.toGraphLib(graph,{graphlib:opt.graphlib,directed:true,// We are about to use edge naming feature.\nmultigraph:true,// We are able to layout graphs with embeds.\ncompound:true,setNodeLabel:opt.exportElement,setEdgeLabel:opt.exportLink,setEdgeName:function(link){// Graphlib edges have no ids. We use edge name property\n// to store and retrieve ids instead.\nreturn link.id;}});var glLabel={};var marginX=opt.marginX||0;var marginY=opt.marginY||0;// Dagre layout accepts options as lower case.\n// Direction for rank nodes. Can be TB, BT, LR, or RL\nif(opt.rankDir){glLabel.rankdir=opt.rankDir;}// Alignment for rank nodes. Can be UL, UR, DL, or DR\nif(opt.align){glLabel.align=opt.align;}// Number of pixels that separate nodes horizontally in the layout.\nif(opt.nodeSep){glLabel.nodesep=opt.nodeSep;}// Number of pixels that separate edges horizontally in the layout.\nif(opt.edgeSep){glLabel.edgesep=opt.edgeSep;}// Number of pixels between each rank in the layout.\nif(opt.rankSep){glLabel.ranksep=opt.rankSep;}// Type of algorithm to assign a rank to each node in the input graph.\n// Possible values: network-simplex, tight-tree or longest-path\nif(opt.ranker){glLabel.ranker=opt.ranker;}// Number of pixels to use as a margin around the left and right of the graph.\nif(marginX){glLabel.marginx=marginX;}// Number of pixels to use as a margin around the top and bottom of the graph.\nif(marginY){glLabel.marginy=marginY;}// Set the option object for the graph label.\nglGraph.setGraph(glLabel);// Executes the layout.\ndagreUtil.layout(glGraph,{debugTiming:!!opt.debugTiming});// Wrap all graph changes into a batch.\ngraph.startBatch('layout');DirectedGraph.fromGraphLib(glGraph,{importNode:this.importElement.bind(graph,opt),importEdge:this.importLink.bind(graph,opt)});// // Update the graph.\n// graph.fromGraphLib(glGraph, {\n//     importNode: this.importElement.bind(graph, opt),\n//     importEdge: this.importLink.bind(graph, opt)\n// });\nif(opt.resizeClusters){// Resize and reposition cluster elements (parents of other elements)\n// to fit their children.\n// 1. filter clusters only\n// 2. map id on cells\n// 3. sort cells by their depth (the deepest first)\n// 4. resize cell to fit their direct children only.\nvar clusters=glGraph.nodes().filter(function(v){return glGraph.children(v).length>0;}).map(graph.getCell.bind(graph)).sort(function(aCluster,bCluster){return bCluster.getAncestors().length-aCluster.getAncestors().length;});invoke(clusters,'fitEmbeds',{padding:opt.clusterPadding});}graph.stopBatch('layout');// Width and height of the graph extended by margins.\nvar glSize=glGraph.graph();// Return the bounding box of the graph after the layout.\nreturn new Rect(marginX,marginY,Math.abs(glSize.width-2*marginX),Math.abs(glSize.height-2*marginY));},fromGraphLib:function(glGraph,opt){opt=opt||{};var importNode=opt.importNode||noop;var importEdge=opt.importEdge||noop;var graph=this instanceof Graph?this:new Graph();// Import all nodes.\nglGraph.nodes().forEach(function(node){importNode.call(graph,node,glGraph,graph,opt);});// Import all edges.\nglGraph.edges().forEach(function(edge){importEdge.call(graph,edge,glGraph,graph,opt);});return graph;},// Create new graphlib graph from existing JointJS graph.\ntoGraphLib:function(graph,opt){opt=opt||{};/* eslint-disable no-undef */var graphlibUtil=opt.graphlib||(typeof graphlib!=='undefined'?graphlib:undefined);/* eslint-enable no-undef */if(graphlibUtil===undefined){throw new Error('The the \"graphlib\" utility is a mandatory dependency.');}var glGraphType=pick(opt,'directed','compound','multigraph');var glGraph=new graphlibUtil.Graph(glGraphType);var setNodeLabel=opt.setNodeLabel||noop;var setEdgeLabel=opt.setEdgeLabel||noop;var setEdgeName=opt.setEdgeName||noop;var collection=graph.get('cells');for(var i=0,n=collection.length;i<n;i++){var cell=collection.at(i);if(cell.isLink()){var source=cell.get('source');var target=cell.get('target');// Links that end at a point are ignored.\nif(!source.id||!target.id){break;}// Note that if we are creating a multigraph we can name the edges. If\n// we try to name edges on a non-multigraph an exception is thrown.\nglGraph.setEdge(source.id,target.id,setEdgeLabel(cell),setEdgeName(cell));}else{glGraph.setNode(cell.id,setNodeLabel(cell));// For the compound graphs we have to take embeds into account.\nif(glGraph.isCompound()&&cell.has('parent')){var parentId=cell.get('parent');if(collection.has(parentId)){// Make sure the parent cell is included in the graph (this can\n// happen when the layout is run on part of the graph only).\nglGraph.setParent(cell.id,parentId);}}}}return glGraph;}};Graph.prototype.toGraphLib=function(opt){return DirectedGraph.toGraphLib(this,opt);};Graph.prototype.fromGraphLib=function(glGraph,opt){return DirectedGraph.fromGraphLib.call(this,glGraph,opt);};var env={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS('http://www.w3.org/2000/svg','foreignObject')));}},addTest:function(name,fn){return this._tests[name]=fn;},test:function(name){var fn=this._tests[name];if(!fn){throw new Error('Test not defined (\"'+name+'\"). Use `joint.env.addTest(name, fn) to add a new test.`');}var result=this._results[name];if(typeof result!=='undefined'){return result;}try{result=fn();}catch(error){result=false;}// Cache the test result.\nthis._results[name]=result;return result;}};var Generic=Element$1.define('basic.Generic',{attrs:{'.':{fill:'#ffffff',stroke:'none'}}});var Rect$1=Generic.define('basic.Rect',{attrs:{'rect':{fill:'#ffffff',stroke:'#000000',width:100,height:60},'text':{fill:'#000000',text:'','font-size':14,'ref-x':.5,'ref-y':.5,'text-anchor':'middle','y-alignment':'middle','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><rect/></g><text/></g>'});var TextView=ElementView.extend({presentationAttributes:ElementView.addPresentationAttributes({// The element view is not automatically re-scaled to fit the model size\n// when the attribute 'attrs' is changed.\nattrs:['SCALE']}),confirmUpdate:function(){var flags=ElementView.prototype.confirmUpdate.apply(this,arguments);if(this.hasFlag(flags,'SCALE')){this.resize();flags=this.removeFlag(flags,'SCALE');}return flags;}});var Text=Generic.define('basic.Text',{attrs:{'text':{'font-size':18,fill:'#000000'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><text/></g></g>'});var Circle=Generic.define('basic.Circle',{size:{width:60,height:60},attrs:{'circle':{fill:'#ffffff',stroke:'#000000',r:30,cx:30,cy:30},'text':{'font-size':14,text:'','text-anchor':'middle','ref-x':.5,'ref-y':.5,'y-alignment':'middle',fill:'#000000','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><circle/></g><text/></g>'});var Ellipse$1=Generic.define('basic.Ellipse',{size:{width:60,height:40},attrs:{'ellipse':{fill:'#ffffff',stroke:'#000000',rx:30,ry:20,cx:30,cy:20},'text':{'font-size':14,text:'','text-anchor':'middle','ref-x':.5,'ref-y':.5,'y-alignment':'middle',fill:'#000000','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><ellipse/></g><text/></g>'});var Polygon$1=Generic.define('basic.Polygon',{size:{width:60,height:40},attrs:{'polygon':{fill:'#ffffff',stroke:'#000000'},'text':{'font-size':14,text:'','text-anchor':'middle','ref-x':.5,'ref-dy':20,'y-alignment':'middle',fill:'#000000','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><polygon/></g><text/></g>'});var Polyline$1=Generic.define('basic.Polyline',{size:{width:60,height:40},attrs:{'polyline':{fill:'#ffffff',stroke:'#000000'},'text':{'font-size':14,text:'','text-anchor':'middle','ref-x':.5,'ref-dy':20,'y-alignment':'middle',fill:'#000000','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><polyline/></g><text/></g>'});var Image=Generic.define('basic.Image',{attrs:{'text':{'font-size':14,text:'','text-anchor':'middle','ref-x':.5,'ref-dy':20,'y-alignment':'middle',fill:'#000000','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><image/></g><text/></g>'});var Path$1=Generic.define('basic.Path',{size:{width:60,height:60},attrs:{'path':{fill:'#ffffff',stroke:'#000000'},'text':{'font-size':14,text:'','text-anchor':'middle','ref':'path','ref-x':.5,'ref-dy':10,fill:'#000000','font-family':'Arial, helvetica, sans-serif'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><path/></g><text/></g>'});var Rhombus=Path$1.define('basic.Rhombus',{attrs:{'path':{d:'M 30 0 L 60 30 30 60 0 30 z'},'text':{'ref-y':.5,'ref-dy':null,'y-alignment':'middle'}}});var svgForeignObjectSupported=env.test('svgforeignobject');var TextBlock=Generic.define('basic.TextBlock',{// see joint.css for more element styles\nattrs:{rect:{fill:'#ffffff',stroke:'#000000',width:80,height:100},text:{fill:'#000000','font-size':14,'font-family':'Arial, helvetica, sans-serif'},'.content':{text:'','ref-x':.5,'ref-y':.5,'y-alignment':'middle','x-alignment':'middle'}},content:''},{markup:['<g class=\"rotatable\">','<g class=\"scalable\"><rect/></g>',svgForeignObjectSupported?'<foreignObject class=\"fobj\"><body xmlns=\"http://www.w3.org/1999/xhtml\"><div class=\"content\"/></body></foreignObject>':'<text class=\"content\"/>','</g>'].join(''),initialize:function(){this.listenTo(this,'change:size',this.updateSize);this.listenTo(this,'change:content',this.updateContent);this.updateSize(this,this.get('size'));this.updateContent(this,this.get('content'));Generic.prototype.initialize.apply(this,arguments);},updateSize:function(cell,size){// Selector `foreignObject' doesn't work across all browsers, we're using class selector instead.\n// We have to clone size as we don't want attributes.div.style to be same object as attributes.size.\nthis.attr({'.fobj':assign({},size),div:{style:assign({},size)}});},updateContent:function(cell,content){if(svgForeignObjectSupported){// Content element is a <div> element.\nthis.attr({'.content':{html:sanitizeHTML(content)}});}else{// Content element is a <text> element.\n// SVG elements don't have innerHTML attribute.\nthis.attr({'.content':{text:content}});}},// Here for backwards compatibility:\nsetForeignObjectSize:function(){this.updateSize.apply(this,arguments);},// Here for backwards compatibility:\nsetDivContent:function(){this.updateContent.apply(this,arguments);}});// TextBlockView implements the fallback for IE when no foreignObject exists and\n// the text needs to be manually broken.\nvar TextBlockView=ElementView.extend({presentationAttributes:svgForeignObjectSupported?ElementView.prototype.presentationAttributes:ElementView.addPresentationAttributes({content:['CONTENT'],size:['CONTENT']}),initFlag:['RENDER','CONTENT'],confirmUpdate:function(){var flags=ElementView.prototype.confirmUpdate.apply(this,arguments);if(this.hasFlag(flags,'CONTENT')){this.updateContent(this.model);flags=this.removeFlag(flags,'CONTENT');}return flags;},update:function(_,renderingOnlyAttrs){var model=this.model;if(!svgForeignObjectSupported){// Update everything but the content first.\nvar noTextAttrs=omit(renderingOnlyAttrs||model.get('attrs'),'.content');ElementView.prototype.update.call(this,model,noTextAttrs);if(!renderingOnlyAttrs||has$2(renderingOnlyAttrs,'.content')){// Update the content itself.\nthis.updateContent(model,renderingOnlyAttrs);}}else{ElementView.prototype.update.call(this,model,renderingOnlyAttrs);}},updateContent:function(cell,renderingOnlyAttrs){// Create copy of the text attributes\nvar textAttrs=merge({},(renderingOnlyAttrs||cell.get('attrs'))['.content']);textAttrs=omit(textAttrs,'text');// Break the content to fit the element size taking into account the attributes\n// set on the model.\nvar text=breakText(cell.get('content'),cell.get('size'),textAttrs,{// measuring sandbox svg document\nsvgDocument:this.paper.svg});// Create a new attrs with same structure as the model attrs { text: { *textAttributes* }}\nvar attrs=setByPath({},'.content',textAttrs,'/');// Replace text attribute with the one we just processed.\nattrs['.content'].text=text;// Update the view using renderingOnlyAttributes parameter.\nElementView.prototype.update.call(this,cell,attrs);}});var basic={Generic:Generic,Rect:Rect$1,TextView:TextView,Text:Text,Circle:Circle,Ellipse:Ellipse$1,Polygon:Polygon$1,Polyline:Polyline$1,Image:Image,Path:Path$1,Rhombus:Rhombus,TextBlock:TextBlock,TextBlockView:TextBlockView};// ELEMENTS\nvar Rectangle=Element$1.define('standard.Rectangle',{attrs:{body:{refWidth:'100%',refHeight:'100%',strokeWidth:2,stroke:'#000000',fill:'#FFFFFF'},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',fontSize:14,fill:'#333333'}}},{markup:[{tagName:'rect',selector:'body'},{tagName:'text',selector:'label'}]});var Circle$1=Element$1.define('standard.Circle',{attrs:{body:{refCx:'50%',refCy:'50%',refR:'50%',strokeWidth:2,stroke:'#333333',fill:'#FFFFFF'},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',fontSize:14,fill:'#333333'}}},{markup:[{tagName:'circle',selector:'body'},{tagName:'text',selector:'label'}]});var Ellipse$2=Element$1.define('standard.Ellipse',{attrs:{body:{refCx:'50%',refCy:'50%',refRx:'50%',refRy:'50%',strokeWidth:2,stroke:'#333333',fill:'#FFFFFF'},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',fontSize:14,fill:'#333333'}}},{markup:[{tagName:'ellipse',selector:'body'},{tagName:'text',selector:'label'}]});var Path$2=Element$1.define('standard.Path',{attrs:{body:{refD:'M 0 0 L 10 0 10 10 0 10 Z',strokeWidth:2,stroke:'#333333',fill:'#FFFFFF'},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',fontSize:14,fill:'#333333'}}},{markup:[{tagName:'path',selector:'body'},{tagName:'text',selector:'label'}]});var Polygon$2=Element$1.define('standard.Polygon',{attrs:{body:{refPoints:'0 0 10 0 10 10 0 10',strokeWidth:2,stroke:'#333333',fill:'#FFFFFF'},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',fontSize:14,fill:'#333333'}}},{markup:[{tagName:'polygon',selector:'body'},{tagName:'text',selector:'label'}]});var Polyline$2=Element$1.define('standard.Polyline',{attrs:{body:{refPoints:'0 0 10 0 10 10 0 10 0 0',strokeWidth:2,stroke:'#333333',fill:'#FFFFFF'},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',fontSize:14,fill:'#333333'}}},{markup:[{tagName:'polyline',selector:'body'},{tagName:'text',selector:'label'}]});var Image$1=Element$1.define('standard.Image',{attrs:{image:{refWidth:'100%',refHeight:'100%'// xlinkHref: '[URL]'\n},label:{textVerticalAnchor:'top',textAnchor:'middle',refX:'50%',refY:'100%',refY2:10,fontSize:14,fill:'#333333'}}},{markup:[{tagName:'image',selector:'image'},{tagName:'text',selector:'label'}]});var BorderedImage=Element$1.define('standard.BorderedImage',{attrs:{border:{refWidth:'100%',refHeight:'100%',stroke:'#333333',strokeWidth:2},background:{refWidth:-1,refHeight:-1,x:0.5,y:0.5,fill:'#FFFFFF'},image:{// xlinkHref: '[URL]'\nrefWidth:-1,refHeight:-1,x:0.5,y:0.5},label:{textVerticalAnchor:'top',textAnchor:'middle',refX:'50%',refY:'100%',refY2:10,fontSize:14,fill:'#333333'}}},{markup:[{tagName:'rect',selector:'background',attributes:{'stroke':'none'}},{tagName:'image',selector:'image'},{tagName:'rect',selector:'border',attributes:{'fill':'none'}},{tagName:'text',selector:'label'}]});var EmbeddedImage=Element$1.define('standard.EmbeddedImage',{attrs:{body:{refWidth:'100%',refHeight:'100%',stroke:'#333333',fill:'#FFFFFF',strokeWidth:2},image:{// xlinkHref: '[URL]'\nrefWidth:'30%',refHeight:-20,x:10,y:10,preserveAspectRatio:'xMidYMin'},label:{textVerticalAnchor:'top',textAnchor:'left',refX:'30%',refX2:20,// 10 + 10\nrefY:10,fontSize:14,fill:'#333333'}}},{markup:[{tagName:'rect',selector:'body'},{tagName:'image',selector:'image'},{tagName:'text',selector:'label'}]});var InscribedImage=Element$1.define('standard.InscribedImage',{attrs:{border:{refRx:'50%',refRy:'50%',refCx:'50%',refCy:'50%',stroke:'#333333',strokeWidth:2},background:{refRx:'50%',refRy:'50%',refCx:'50%',refCy:'50%',fill:'#FFFFFF'},image:{// The image corners touch the border when its size is Math.sqrt(2) / 2 = 0.707.. ~= 70%\nrefWidth:'68%',refHeight:'68%',// The image offset is calculated as (100% - 68%) / 2\nrefX:'16%',refY:'16%',preserveAspectRatio:'xMidYMid'// xlinkHref: '[URL]'\n},label:{textVerticalAnchor:'top',textAnchor:'middle',refX:'50%',refY:'100%',refY2:10,fontSize:14,fill:'#333333'}}},{markup:[{tagName:'ellipse',selector:'background'},{tagName:'image',selector:'image'},{tagName:'ellipse',selector:'border',attributes:{'fill':'none'}},{tagName:'text',selector:'label'}]});var HeaderedRectangle=Element$1.define('standard.HeaderedRectangle',{attrs:{body:{refWidth:'100%',refHeight:'100%',strokeWidth:2,stroke:'#000000',fill:'#FFFFFF'},header:{refWidth:'100%',height:30,strokeWidth:2,stroke:'#000000',fill:'#FFFFFF'},headerText:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:15,fontSize:16,fill:'#333333'},bodyText:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'50%',refY2:15,fontSize:14,fill:'#333333'}}},{markup:[{tagName:'rect',selector:'body'},{tagName:'rect',selector:'header'},{tagName:'text',selector:'headerText'},{tagName:'text',selector:'bodyText'}]});var CYLINDER_TILT=10;var Cylinder=Element$1.define('standard.Cylinder',{attrs:{body:{lateralArea:CYLINDER_TILT,fill:'#FFFFFF',stroke:'#333333',strokeWidth:2},top:{refCx:'50%',cy:CYLINDER_TILT,refRx:'50%',ry:CYLINDER_TILT,fill:'#FFFFFF',stroke:'#333333',strokeWidth:2},label:{textVerticalAnchor:'middle',textAnchor:'middle',refX:'50%',refY:'100%',refY2:15,fontSize:14,fill:'#333333'}}},{markup:[{tagName:'path',selector:'body'},{tagName:'ellipse',selector:'top'},{tagName:'text',selector:'label'}],topRy:function(t,opt){// getter\nif(t===undefined){return this.attr('body/lateralArea');}// setter\nvar isPercentageSetter=isPercentage(t);var bodyAttrs={lateralArea:t};var topAttrs=isPercentageSetter?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:bodyAttrs,top:topAttrs},opt);}},{attributes:{lateralArea:{set:function(t,refBBox){var isPercentageSetter=isPercentage(t);if(isPercentageSetter){t=parseFloat(t)/100;}var x=refBBox.x;var y=refBBox.y;var w=refBBox.width;var h=refBBox.height;// curve control point variables\nvar rx=w/2;var ry=isPercentageSetter?h*t:t;var kappa=V.KAPPA;var cx=kappa*rx;var cy=kappa*(isPercentageSetter?h*t:t);// shape variables\nvar xLeft=x;var xCenter=x+w/2;var xRight=x+w;var ySideTop=y+ry;var yCurveTop=ySideTop-ry;var ySideBottom=y+h-ry;var yCurveBottom=y+h;// return calculated shape\nvar data=['M',xLeft,ySideTop,'L',xLeft,ySideBottom,'C',x,ySideBottom+cy,xCenter-cx,yCurveBottom,xCenter,yCurveBottom,'C',xCenter+cx,yCurveBottom,xRight,ySideBottom+cy,xRight,ySideBottom,'L',xRight,ySideTop,'C',xRight,ySideTop-cy,xCenter+cx,yCurveTop,xCenter,yCurveTop,'C',xCenter-cx,yCurveTop,xLeft,ySideTop-cy,xLeft,ySideTop,'Z'];return{d:data.join(' ')};}}}});var foLabelMarkup={tagName:'foreignObject',selector:'foreignObject',attributes:{'overflow':'hidden'},children:[{tagName:'div',namespaceURI:'http://www.w3.org/1999/xhtml',selector:'label',style:{width:'100%',height:'100%',position:'static',backgroundColor:'transparent',textAlign:'center',margin:0,padding:'0px 5px',boxSizing:'border-box',display:'flex',alignItems:'center',justifyContent:'center'}}]};var svgLabelMarkup={tagName:'text',selector:'label',attributes:{'text-anchor':'middle'}};var labelMarkup=env.test('svgforeignobject')?foLabelMarkup:svgLabelMarkup;var TextBlock$1=Element$1.define('standard.TextBlock',{attrs:{body:{refWidth:'100%',refHeight:'100%',stroke:'#333333',fill:'#ffffff',strokeWidth:2},foreignObject:{refWidth:'100%',refHeight:'100%'},label:{style:{fontSize:14}}}},{markup:[{tagName:'rect',selector:'body'},labelMarkup]},{attributes:{text:{set:function(text,refBBox,node,attrs){if(node instanceof HTMLElement){node.textContent=text;}else{// No foreign object\nvar style=attrs.style||{};var wrapValue={text:text,width:-5,height:'100%'};var wrapAttrs=assign({textVerticalAnchor:'middle'},style);attributes.textWrap.set.call(this,wrapValue,refBBox,node,wrapAttrs);return{fill:style.color||null};}},position:function(text,refBBox,node){// No foreign object\nif(node instanceof SVGElement){return refBBox.center();}}}}});// LINKS\nvar Link$1=Link.define('standard.Link',{attrs:{line:{connection:true,stroke:'#333333',strokeWidth:2,strokeLinejoin:'round',targetMarker:{'type':'path','d':'M 10 -5 0 0 10 5 z'}},wrapper:{connection:true,strokeWidth:10,strokeLinejoin:'round'}}},{markup:[{tagName:'path',selector:'wrapper',attributes:{'fill':'none','cursor':'pointer','stroke':'transparent','stroke-linecap':'round'}},{tagName:'path',selector:'line',attributes:{'fill':'none','pointer-events':'none'}}]});var DoubleLink=Link.define('standard.DoubleLink',{attrs:{line:{connection:true,stroke:'#DDDDDD',strokeWidth:4,strokeLinejoin:'round',targetMarker:{type:'path',stroke:'#000000',d:'M 10 -3 10 -10 -2 0 10 10 10 3'}},outline:{connection:true,stroke:'#000000',strokeWidth:6,strokeLinejoin:'round'}}},{markup:[{tagName:'path',selector:'outline',attributes:{'fill':'none'}},{tagName:'path',selector:'line',attributes:{'fill':'none'}}]});var ShadowLink=Link.define('standard.ShadowLink',{attrs:{line:{connection:true,stroke:'#FF0000',strokeWidth:20,strokeLinejoin:'round',targetMarker:{'type':'path','stroke':'none','d':'M 0 -10 -10 0 0 10 z'},sourceMarker:{'type':'path','stroke':'none','d':'M -10 -10 0 0 -10 10 0 10 0 -10 z'}},shadow:{connection:true,refX:3,refY:6,stroke:'#000000',strokeOpacity:0.2,strokeWidth:20,strokeLinejoin:'round',targetMarker:{'type':'path','d':'M 0 -10 -10 0 0 10 z','stroke':'none'},sourceMarker:{'type':'path','stroke':'none','d':'M -10 -10 0 0 -10 10 0 10 0 -10 z'}}}},{markup:[{tagName:'path',selector:'shadow',attributes:{'fill':'none'}},{tagName:'path',selector:'line',attributes:{'fill':'none'}}]});var standard={Rectangle:Rectangle,Circle:Circle$1,Ellipse:Ellipse$2,Path:Path$2,Polygon:Polygon$2,Polyline:Polyline$2,Image:Image$1,BorderedImage:BorderedImage,EmbeddedImage:EmbeddedImage,InscribedImage:InscribedImage,HeaderedRectangle:HeaderedRectangle,Cylinder:Cylinder,TextBlock:TextBlock$1,Link:Link$1,DoubleLink:DoubleLink,ShadowLink:ShadowLink};/**\n\t * @deprecated use the port api instead\n\t */var Model=Generic.define('devs.Model',{inPorts:[],outPorts:[],size:{width:80,height:80},attrs:{'.':{magnet:false},'.label':{text:'Model','ref-x':.5,'ref-y':10,'font-size':18,'text-anchor':'middle',fill:'#000'},'.body':{'ref-width':'100%','ref-height':'100%',stroke:'#000'}},ports:{groups:{'in':{position:{name:'left'},attrs:{'.port-label':{fill:'#000'},'.port-body':{fill:'#fff',stroke:'#000',r:10,magnet:true}},label:{position:{name:'left',args:{y:10}}}},'out':{position:{name:'right'},attrs:{'.port-label':{fill:'#000'},'.port-body':{fill:'#fff',stroke:'#000',r:10,magnet:true}},label:{position:{name:'right',args:{y:10}}}}}}},{markup:'<g class=\"rotatable\"><rect class=\"body\"/><text class=\"label\"/></g>',portMarkup:'<circle class=\"port-body\"/>',portLabelMarkup:'<text class=\"port-label\"/>',initialize:function(){Generic.prototype.initialize.apply(this,arguments);this.on('change:inPorts change:outPorts',this.updatePortItems,this);this.updatePortItems();},updatePortItems:function(model,changed,opt){// Make sure all ports are unique.\nvar inPorts=uniq(this.get('inPorts'));var outPorts=difference(uniq(this.get('outPorts')),inPorts);var inPortItems=this.createPortItems('in',inPorts);var outPortItems=this.createPortItems('out',outPorts);this.prop('ports/items',inPortItems.concat(outPortItems),assign({rewrite:true},opt));},createPortItem:function(group,port){return{id:port,group:group,attrs:{'.port-label':{text:port}}};},createPortItems:function(group,ports){return toArray(ports).map(this.createPortItem.bind(this,group));},_addGroupPort:function(port,group,opt){var ports=this.get(group);return this.set(group,Array.isArray(ports)?ports.concat(port):[port],opt);},addOutPort:function(port,opt){return this._addGroupPort(port,'outPorts',opt);},addInPort:function(port,opt){return this._addGroupPort(port,'inPorts',opt);},_removeGroupPort:function(port,group,opt){return this.set(group,without(this.get(group),port),opt);},removeOutPort:function(port,opt){return this._removeGroupPort(port,'outPorts',opt);},removeInPort:function(port,opt){return this._removeGroupPort(port,'inPorts',opt);},_changeGroup:function(group,properties,opt){return this.prop('ports/groups/'+group,isObject$1(properties)?properties:{},opt);},changeInGroup:function(properties,opt){return this._changeGroup('in',properties,opt);},changeOutGroup:function(properties,opt){return this._changeGroup('out',properties,opt);}});var Atomic=Model.define('devs.Atomic',{size:{width:80,height:80},attrs:{'.label':{text:'Atomic'}}});var Coupled=Model.define('devs.Coupled',{size:{width:200,height:300},attrs:{'.label':{text:'Coupled'}}});var Link$2=Link.define('devs.Link',{attrs:{'.connection':{'stroke-width':2}}});var devs={Model:Model,Atomic:Atomic,Coupled:Coupled,Link:Link$2};var Gate=Generic.define('logic.Gate',{size:{width:80,height:40},attrs:{'.':{magnet:false},'.body':{width:100,height:50},circle:{r:7,stroke:'black',fill:'transparent','stroke-width':2}}},{operation:function(){return true;}});var IO=Gate.define('logic.IO',{size:{width:60,height:30},attrs:{'.body':{fill:'white',stroke:'black','stroke-width':2},'.wire':{ref:'.body','ref-y':.5,stroke:'black'},text:{fill:'black',ref:'.body','ref-x':.5,'ref-y':.5,'y-alignment':'middle','text-anchor':'middle','font-weight':'bold','font-variant':'small-caps','text-transform':'capitalize','font-size':'14px'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"body\"/></g><path class=\"wire\"/><circle/><text/></g>'});var Input=IO.define('logic.Input',{attrs:{'.wire':{'ref-dx':0,d:'M 0 0 L 23 0'},circle:{ref:'.body','ref-dx':30,'ref-y':0.5,magnet:true,'class':'output',port:'out'},text:{text:'input'}}});var Output=IO.define('logic.Output',{attrs:{'.wire':{'ref-x':0,d:'M 0 0 L -23 0'},circle:{ref:'.body','ref-x':-30,'ref-y':0.5,magnet:'passive','class':'input',port:'in'},text:{text:'output'}}});var Gate11=Gate.define('logic.Gate11',{attrs:{'.input':{ref:'.body','ref-x':-2,'ref-y':0.5,magnet:'passive',port:'in'},'.output':{ref:'.body','ref-dx':2,'ref-y':0.5,magnet:true,port:'out'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><image class=\"body\"/></g><circle class=\"input\"/><circle class=\"output\"/></g>'});var Gate21=Gate.define('logic.Gate21',{attrs:{'.input1':{ref:'.body','ref-x':-2,'ref-y':0.3,magnet:'passive',port:'in1'},'.input2':{ref:'.body','ref-x':-2,'ref-y':0.7,magnet:'passive',port:'in2'},'.output':{ref:'.body','ref-dx':2,'ref-y':0.5,magnet:true,port:'out'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><image class=\"body\"/></g><circle class=\"input input1\"/><circle  class=\"input input2\"/><circle class=\"output\"/></g>'});var Repeater=Gate11.define('logic.Repeater',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo='}}},{operation:function(input){return input;}});var Not=Gate11.define('logic.Not',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K'}}},{operation:function(input){return!input;}});var Or=Gate21.define('logic.Or',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo='}}},{operation:function(input1,input2){return input1||input2;}});var And=Gate21.define('logic.And',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=='}}},{operation:function(input1,input2){return input1&&input2;}});var Nor=Gate21.define('logic.Nor',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K'}}},{operation:function(input1,input2){return!(input1||input2);}});var Nand=Gate21.define('logic.Nand',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=='}}},{operation:function(input1,input2){return!(input1&&input2);}});var Xor=Gate21.define('logic.Xor',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K'}}},{operation:function(input1,input2){return(!input1||input2)&&(input1||!input2);}});var Xnor=Gate21.define('logic.Xnor',{attrs:{image:{'xlink:href':'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=='}}},{operation:function(input1,input2){return(!input1||!input2)&&(input1||input2);}});var Wire=Link.define('logic.Wire',{attrs:{'.connection':{'stroke-width':2},'.marker-vertex':{r:7}},router:{name:'orthogonal'},connector:{name:'rounded',args:{radius:10}}},{arrowheadMarkup:['<g class=\"marker-arrowhead-group marker-arrowhead-group-<%= end %>\">','<circle class=\"marker-arrowhead\" end=\"<%= end %>\" r=\"7\"/>','</g>'].join(''),vertexMarkup:['<g class=\"marker-vertex-group\" transform=\"translate(<%= x %>, <%= y %>)\">','<circle class=\"marker-vertex\" idx=\"<%= idx %>\" r=\"10\" />','<g class=\"marker-vertex-remove-group\">','<path class=\"marker-vertex-remove-area\" idx=\"<%= idx %>\" d=\"M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z\" transform=\"translate(5, -33)\"/>','<path class=\"marker-vertex-remove\" idx=\"<%= idx %>\" transform=\"scale(.8) translate(9.5, -37)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\">','<title>Remove vertex.</title>','</path>','</g>','</g>'].join('')});var logic={Gate:Gate,IO:IO,Input:Input,Output:Output,Gate11:Gate11,Gate21:Gate21,Repeater:Repeater,Not:Not,Or:Or,And:And,Nor:Nor,Nand:Nand,Xor:Xor,Xnor:Xnor,Wire:Wire};var KingWhite=Generic.define('chess.KingWhite',{size:{width:42,height:38}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\"><path      d=\"M 22.5,11.63 L 22.5,6\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path      d=\"M 20,8 L 25,8\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path      d=\"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\"      style=\"fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;\" />    <path      d=\"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z \"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 11.5,30 C 17,27 27,27 32.5,30\"      style=\"fill:none; stroke:#000000;\" />    <path      d=\"M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5\"      style=\"fill:none; stroke:#000000;\" />    <path      d=\"M 11.5,37 C 17,34 27,34 32.5,37\"      style=\"fill:none; stroke:#000000;\" />  </g></g></g>'});var KingBlack=Generic.define('chess.KingBlack',{size:{width:42,height:38}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path       d=\"M 22.5,11.63 L 22.5,6\"       style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\"       id=\"path6570\" />    <path       d=\"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\"       style=\"fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;\" />    <path       d=\"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z \"       style=\"fill:#000000; stroke:#000000;\" />    <path       d=\"M 20,8 L 25,8\"       style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path       d=\"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37\"       style=\"fill:none; stroke:#ffffff;\" />  </g></g></g>'});var QueenWhite=Generic.define('chess.QueenWhite',{size:{width:42,height:38}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(-1,-1)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(15.5,-5.5)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(32,-1)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(7,-4.5)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(24,-4)\" />    <path      d=\"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11.5,30 C 15,29 30,29 33.5,30\"      style=\"fill:none;\" />    <path      d=\"M 12,33.5 C 18,32.5 27,32.5 33,33.5\"      style=\"fill:none;\" />  </g></g></g>'});var QueenBlack=Generic.define('chess.QueenBlack',{size:{width:42,height:38}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#000000; stroke:none;\">      <circle cx=\"6\"    cy=\"12\" r=\"2.75\" />      <circle cx=\"14\"   cy=\"9\"  r=\"2.75\" />      <circle cx=\"22.5\" cy=\"8\"  r=\"2.75\" />      <circle cx=\"31\"   cy=\"9\"  r=\"2.75\" />      <circle cx=\"39\"   cy=\"12\" r=\"2.75\" />    </g>    <path       d=\"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"       style=\"stroke-linecap:butt; stroke:#000000;\" />    <path       d=\"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"       style=\"stroke-linecap:butt;\" />    <path       d=\"M 11,38.5 A 35,35 1 0 0 34,38.5\"       style=\"fill:none; stroke:#000000; stroke-linecap:butt;\" />    <path       d=\"M 11,29 A 35,35 1 0 1 34,29\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 12.5,31.5 L 32.5,31.5\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"       style=\"fill:none; stroke:#ffffff;\" />  </g></g></g>'});var RookWhite=Generic.define('chess.RookWhite',{size:{width:32,height:34}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 34,14 L 31,17 L 14,17 L 11,14\" />    <path      d=\"M 31,17 L 31,29.5 L 14,29.5 L 14,17\"      style=\"stroke-linecap:butt; stroke-linejoin:miter;\" />    <path      d=\"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\" />    <path      d=\"M 11,14 L 34,14\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />  </g></g></g>'});var RookBlack=Generic.define('chess.RookBlack',{size:{width:32,height:34}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \"      style=\"stroke-linecap:butt;stroke-linejoin:miter;\" />    <path      d=\"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,35.5 L 33,35.5 L 33,35.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 13,31.5 L 32,31.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 14,29.5 L 31,29.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 14,16.5 L 31,16.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 11,14 L 34,14\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />  </g></g></g>'});var BishopWhite=Generic.define('chess.BishopWhite',{size:{width:38,height:38}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#ffffff; stroke:#000000; stroke-linecap:butt;\">       <path        d=\"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z\" />      <path        d=\"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\" />      <path        d=\"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\" />    </g>    <path      d=\"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />  </g></g></g>'});var BishopBlack=Generic.define('chess.BishopBlack',{size:{width:38,height:38}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#000000; stroke:#000000; stroke-linecap:butt;\">       <path        d=\"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z\" />      <path        d=\"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\" />      <path        d=\"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\" />    </g>    <path       d=\"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\"       style=\"fill:none; stroke:#ffffff; stroke-linejoin:miter;\" />  </g></g></g>'});var KnightWhite=Generic.define('chess.KnightWhite',{size:{width:38,height:37}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\"      transform=\"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\"      style=\"fill:#000000; stroke:#000000;\" />  </g></g></g>'});var KnightBlack=Generic.define('chess.KnightBlack',{size:{width:38,height:37}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\"      style=\"fill:#ffffff; stroke:#ffffff;\" />    <path      d=\"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\"      transform=\"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\"      style=\"fill:#ffffff; stroke:#ffffff;\" />    <path      d=\"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \"      style=\"fill:#ffffff; stroke:none;\" />  </g></g></g>'});var PawnWhite=Generic.define('chess.PawnWhite',{size:{width:28,height:33}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><path d=\"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z \"  style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\" /></g></g>'});var PawnBlack=Generic.define('chess.PawnBlack',{size:{width:28,height:33}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><path d=\"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z \"  style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\" /></g></g>'});var chess={KingWhite:KingWhite,KingBlack:KingBlack,QueenWhite:QueenWhite,QueenBlack:QueenBlack,RookWhite:RookWhite,RookBlack:RookBlack,BishopWhite:BishopWhite,BishopBlack:BishopBlack,KnightWhite:KnightWhite,KnightBlack:KnightBlack,PawnWhite:PawnWhite,PawnBlack:PawnBlack};var Entity=Element$1.define('erd.Entity',{size:{width:150,height:60},attrs:{'.outer':{fill:'#2ECC71',stroke:'#27AE60','stroke-width':2,points:'100,0 100,60 0,60 0,0'},'.inner':{fill:'#2ECC71',stroke:'#27AE60','stroke-width':2,points:'95,5 95,55 5,55 5,5',display:'none'},text:{text:'Entity','font-family':'Arial','font-size':14,'ref-x':.5,'ref-y':.5,'y-alignment':'middle','text-anchor':'middle'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><polygon class=\"outer\"/><polygon class=\"inner\"/></g><text/></g>'});var WeakEntity=Entity.define('erd.WeakEntity',{attrs:{'.inner':{display:'auto'},text:{text:'Weak Entity'}}});var Relationship=Element$1.define('erd.Relationship',{size:{width:80,height:80},attrs:{'.outer':{fill:'#3498DB',stroke:'#2980B9','stroke-width':2,points:'40,0 80,40 40,80 0,40'},'.inner':{fill:'#3498DB',stroke:'#2980B9','stroke-width':2,points:'40,5 75,40 40,75 5,40',display:'none'},text:{text:'Relationship','font-family':'Arial','font-size':12,'ref-x':.5,'ref-y':.5,'y-alignment':'middle','text-anchor':'middle'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><polygon class=\"outer\"/><polygon class=\"inner\"/></g><text/></g>'});var IdentifyingRelationship=Relationship.define('erd.IdentifyingRelationship',{attrs:{'.inner':{display:'auto'},text:{text:'Identifying'}}});var Attribute=Element$1.define('erd.Attribute',{size:{width:100,height:50},attrs:{'ellipse':{transform:'translate(50, 25)'},'.outer':{stroke:'#D35400','stroke-width':2,cx:0,cy:0,rx:50,ry:25,fill:'#E67E22'},'.inner':{stroke:'#D35400','stroke-width':2,cx:0,cy:0,rx:45,ry:20,fill:'#E67E22',display:'none'},text:{'font-family':'Arial','font-size':14,'ref-x':.5,'ref-y':.5,'y-alignment':'middle','text-anchor':'middle'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><ellipse class=\"outer\"/><ellipse class=\"inner\"/></g><text/></g>'});var Multivalued=Attribute.define('erd.Multivalued',{attrs:{'.inner':{display:'block'},text:{text:'multivalued'}}});var Derived=Attribute.define('erd.Derived',{attrs:{'.outer':{'stroke-dasharray':'3,5'},text:{text:'derived'}}});var Key=Attribute.define('erd.Key',{attrs:{ellipse:{'stroke-width':4},text:{text:'key','font-weight':'800','text-decoration':'underline'}}});var Normal=Attribute.define('erd.Normal',{attrs:{text:{text:'Normal'}}});var ISA=Element$1.define('erd.ISA',{type:'erd.ISA',size:{width:100,height:50},attrs:{polygon:{points:'0,0 50,50 100,0',fill:'#F1C40F',stroke:'#F39C12','stroke-width':2},text:{text:'ISA','font-size':18,'ref-x':.5,'ref-y':.3,'y-alignment':'middle','text-anchor':'middle'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><polygon/></g><text/></g>'});var Line$1=Link.define('erd.Line',{},{cardinality:function(value){this.set('labels',[{position:-20,attrs:{text:{dy:-8,text:value}}}]);}});var erd={Entity:Entity,WeakEntity:WeakEntity,Relationship:Relationship,IdentifyingRelationship:IdentifyingRelationship,Attribute:Attribute,Multivalued:Multivalued,Derived:Derived,Key:Key,Normal:Normal,ISA:ISA,Line:Line$1};var State=Circle.define('fsa.State',{attrs:{circle:{'stroke-width':3},text:{'font-weight':'800'}}});var StartState=Element$1.define('fsa.StartState',{size:{width:20,height:20},attrs:{circle:{transform:'translate(10, 10)',r:10,fill:'#000000'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><circle/></g></g>'});var EndState=Element$1.define('fsa.EndState',{size:{width:20,height:20},attrs:{'.outer':{transform:'translate(10, 10)',r:10,fill:'#ffffff',stroke:'#000000'},'.inner':{transform:'translate(10, 10)',r:6,fill:'#000000'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"outer\"/><circle class=\"inner\"/></g></g>'});var Arrow=Link.define('fsa.Arrow',{attrs:{'.marker-target':{d:'M 10 0 L 0 5 L 10 10 z'}},smooth:true});var fsa={State:State,StartState:StartState,EndState:EndState,Arrow:Arrow};var Member=Element$1.define('org.Member',{size:{width:180,height:70},attrs:{rect:{width:170,height:60},'.card':{fill:'#FFFFFF',stroke:'#000000','stroke-width':2,'pointer-events':'visiblePainted',rx:10,ry:10},image:{width:48,height:48,ref:'.card','ref-x':10,'ref-y':5},'.rank':{'text-decoration':'underline',ref:'.card','ref-x':0.9,'ref-y':0.2,'font-family':'Courier New','font-size':14,'text-anchor':'end'},'.name':{'font-weight':'800',ref:'.card','ref-x':0.9,'ref-y':0.6,'font-family':'Courier New','font-size':14,'text-anchor':'end'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"card\"/><image/></g><text class=\"rank\"/><text class=\"name\"/></g>'});var Arrow$1=Link.define('org.Arrow',{source:{selector:'.card'},target:{selector:'.card'},attrs:{'.connection':{stroke:'#585858','stroke-width':3}},z:-1});var org={Member:Member,Arrow:Arrow$1};var Place=Generic.define('pn.Place',{size:{width:50,height:50},attrs:{'.root':{r:25,fill:'#ffffff',stroke:'#000000',transform:'translate(25, 25)'},'.label':{'text-anchor':'middle','ref-x':.5,'ref-y':-20,ref:'.root',fill:'#000000','font-size':12},'.tokens > circle':{fill:'#000000',r:5},'.tokens.one > circle':{transform:'translate(25, 25)'},'.tokens.two > circle:nth-child(1)':{transform:'translate(19, 25)'},'.tokens.two > circle:nth-child(2)':{transform:'translate(31, 25)'},'.tokens.three > circle:nth-child(1)':{transform:'translate(18, 29)'},'.tokens.three > circle:nth-child(2)':{transform:'translate(25, 19)'},'.tokens.three > circle:nth-child(3)':{transform:'translate(32, 29)'},'.tokens.alot > text':{transform:'translate(25, 18)','text-anchor':'middle',fill:'#000000'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"root\"/><g class=\"tokens\" /></g><text class=\"label\"/></g>'});var PlaceView=ElementView.extend({presentationAttributes:ElementView.addPresentationAttributes({tokens:['TOKENS']}),initFlag:ElementView.prototype.initFlag.concat(['TOKENS']),confirmUpdate:function(){var ref;var args=[],len=arguments.length;while(len--)args[len]=arguments[len];var flags=(ref=ElementView.prototype.confirmUpdate).call.apply(ref,[this].concat(args));if(this.hasFlag(flags,'TOKENS')){this.renderTokens();this.update();flags=this.removeFlag(flags,'TOKENS');}return flags;},renderTokens:function(){var vTokens=this.vel.findOne('.tokens').empty();['one','two','three','alot'].forEach(function(className){vTokens.removeClass(className);});var tokens=this.model.get('tokens');if(!tokens){return;}switch(tokens){case 1:vTokens.addClass('one');vTokens.append(V('circle'));break;case 2:vTokens.addClass('two');vTokens.append([V('circle'),V('circle')]);break;case 3:vTokens.addClass('three');vTokens.append([V('circle'),V('circle'),V('circle')]);break;default:vTokens.addClass('alot');vTokens.append(V('text').text(tokens+''));break;}}});var Transition=Generic.define('pn.Transition',{size:{width:12,height:50},attrs:{'rect':{width:12,height:50,fill:'#000000',stroke:'#000000'},'.label':{'text-anchor':'middle','ref-x':.5,'ref-y':-20,ref:'rect',fill:'#000000','font-size':12}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"root\"/></g></g><text class=\"label\"/>'});var Link$3=Link.define('pn.Link',{attrs:{'.marker-target':{d:'M 10 0 L 0 5 L 10 10 z'}}});var pn={Place:Place,PlaceView:PlaceView,Transition:Transition,Link:Link$3};var Class=Generic.define('uml.Class',{attrs:{rect:{'width':200},'.uml-class-name-rect':{'stroke':'black','stroke-width':2,'fill':'#3498db'},'.uml-class-attrs-rect':{'stroke':'black','stroke-width':2,'fill':'#2980b9'},'.uml-class-methods-rect':{'stroke':'black','stroke-width':2,'fill':'#2980b9'},'.uml-class-name-text':{'ref':'.uml-class-name-rect','ref-y':.5,'ref-x':.5,'text-anchor':'middle','y-alignment':'middle','font-weight':'bold','fill':'black','font-size':12,'font-family':'Times New Roman'},'.uml-class-attrs-text':{'ref':'.uml-class-attrs-rect','ref-y':5,'ref-x':5,'fill':'black','font-size':12,'font-family':'Times New Roman'},'.uml-class-methods-text':{'ref':'.uml-class-methods-rect','ref-y':5,'ref-x':5,'fill':'black','font-size':12,'font-family':'Times New Roman'}},name:[],attributes:[],methods:[]},{markup:['<g class=\"rotatable\">','<g class=\"scalable\">','<rect class=\"uml-class-name-rect\"/><rect class=\"uml-class-attrs-rect\"/><rect class=\"uml-class-methods-rect\"/>','</g>','<text class=\"uml-class-name-text\"/><text class=\"uml-class-attrs-text\"/><text class=\"uml-class-methods-text\"/>','</g>'].join(''),initialize:function(){this.on('change:name change:attributes change:methods',function(){this.updateRectangles();this.trigger('uml-update');},this);this.updateRectangles();Generic.prototype.initialize.apply(this,arguments);},getClassName:function(){return this.get('name');},updateRectangles:function(){var attrs=this.get('attrs');var rects=[{type:'name',text:this.getClassName()},{type:'attrs',text:this.get('attributes')},{type:'methods',text:this.get('methods')}];var offsetY=0;rects.forEach(function(rect){var lines=Array.isArray(rect.text)?rect.text:[rect.text];var rectHeight=lines.length*20+20;attrs['.uml-class-'+rect.type+'-text'].text=lines.join('\\n');attrs['.uml-class-'+rect.type+'-rect'].height=rectHeight;attrs['.uml-class-'+rect.type+'-rect'].transform='translate(0,'+offsetY+')';offsetY+=rectHeight;});}});var ClassView=ElementView.extend({initialize:function(){ElementView.prototype.initialize.apply(this,arguments);this.listenTo(this.model,'uml-update',function(){this.update();this.resize();});}});var Abstract=Class.define('uml.Abstract',{attrs:{'.uml-class-name-rect':{fill:'#e74c3c'},'.uml-class-attrs-rect':{fill:'#c0392b'},'.uml-class-methods-rect':{fill:'#c0392b'}}},{getClassName:function(){return['<<Abstract>>',this.get('name')];}});var AbstractView=ClassView;var Interface=Class.define('uml.Interface',{attrs:{'.uml-class-name-rect':{fill:'#f1c40f'},'.uml-class-attrs-rect':{fill:'#f39c12'},'.uml-class-methods-rect':{fill:'#f39c12'}}},{getClassName:function(){return['<<Interface>>',this.get('name')];}});var InterfaceView=ClassView;var Generalization=Link.define('uml.Generalization',{attrs:{'.marker-target':{d:'M 20 0 L 0 10 L 20 20 z',fill:'white'}}});var Implementation=Link.define('uml.Implementation',{attrs:{'.marker-target':{d:'M 20 0 L 0 10 L 20 20 z',fill:'white'},'.connection':{'stroke-dasharray':'3,3'}}});var Aggregation=Link.define('uml.Aggregation',{attrs:{'.marker-target':{d:'M 40 10 L 20 20 L 0 10 L 20 0 z',fill:'white'}}});var Composition=Link.define('uml.Composition',{attrs:{'.marker-target':{d:'M 40 10 L 20 20 L 0 10 L 20 0 z',fill:'black'}}});var Association=Link.define('uml.Association');// Statechart\nvar State$1=Generic.define('uml.State',{attrs:{'.uml-state-body':{'width':200,'height':200,'rx':10,'ry':10,'fill':'#ecf0f1','stroke':'#bdc3c7','stroke-width':3},'.uml-state-separator':{'stroke':'#bdc3c7','stroke-width':2},'.uml-state-name':{'ref':'.uml-state-body','ref-x':.5,'ref-y':5,'text-anchor':'middle','fill':'#000000','font-family':'Courier New','font-size':14},'.uml-state-events':{'ref':'.uml-state-separator','ref-x':5,'ref-y':5,'fill':'#000000','font-family':'Courier New','font-size':14}},name:'State',events:[]},{markup:['<g class=\"rotatable\">','<g class=\"scalable\">','<rect class=\"uml-state-body\"/>','</g>','<path class=\"uml-state-separator\"/>','<text class=\"uml-state-name\"/>','<text class=\"uml-state-events\"/>','</g>'].join(''),initialize:function(){this.on({'change:name':this.updateName,'change:events':this.updateEvents,'change:size':this.updatePath},this);this.updateName();this.updateEvents();this.updatePath();Generic.prototype.initialize.apply(this,arguments);},updateName:function(){this.attr('.uml-state-name/text',this.get('name'));},updateEvents:function(){this.attr('.uml-state-events/text',this.get('events').join('\\n'));},updatePath:function(){var d='M 0 20 L '+this.get('size').width+' 20';// We are using `silent: true` here because updatePath() is meant to be called\n// on resize and there's no need to to update the element twice (`change:size`\n// triggers also an update).\nthis.attr('.uml-state-separator/d',d,{silent:true});}});var StartState$1=Circle.define('uml.StartState',{type:'uml.StartState',attrs:{circle:{'fill':'#34495e','stroke':'#2c3e50','stroke-width':2,'rx':1}}});var EndState$1=Generic.define('uml.EndState',{size:{width:20,height:20},attrs:{'circle.outer':{transform:'translate(10, 10)',r:10,fill:'#ffffff',stroke:'#2c3e50'},'circle.inner':{transform:'translate(10, 10)',r:6,fill:'#34495e'}}},{markup:'<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"outer\"/><circle class=\"inner\"/></g></g>'});var Transition$1=Link.define('uml.Transition',{attrs:{'.marker-target':{d:'M 10 0 L 0 5 L 10 10 z',fill:'#34495e',stroke:'#2c3e50'},'.connection':{stroke:'#2c3e50'}}});var uml={Class:Class,ClassView:ClassView,Abstract:Abstract,AbstractView:AbstractView,Interface:Interface,InterfaceView:InterfaceView,Generalization:Generalization,Implementation:Implementation,Aggregation:Aggregation,Composition:Composition,Association:Association,State:State$1,StartState:StartState$1,EndState:EndState$1,Transition:Transition$1};var index$3={basic:basic,standard:standard,devs:devs,logic:logic,chess:chess,erd:erd,fsa:fsa,org:org,pn:pn,uml:uml};function abs2rel(absolute,max){if(max===0){return'0%';}// round to 3 decimal places\nvar dp=1000;var relative=Math.round(absolute/max*100*dp)/dp;return relative+\"%\";}function pin(relative){return function(end,view,magnet,coords){var fn=view.isNodeConnection(magnet)?pinnedLinkEnd:pinnedElementEnd;return fn(relative,end,view,magnet,coords);};}function pinnedElementEnd(relative,end,view,magnet,coords){var angle=view.model.angle();var bbox=view.getNodeUnrotatedBBox(magnet);var origin=view.model.getBBox().center();coords.rotate(origin,angle);var dx=coords.x-bbox.x;var dy=coords.y-bbox.y;if(relative){dx=abs2rel(dx,bbox.width);dy=abs2rel(dy,bbox.height);}end.anchor={name:'topLeft',args:{dx:dx,dy:dy,rotate:true}};return end;}function pinnedLinkEnd(relative,end,view,_magnet,coords){var connection=view.getConnection();if(!connection){return end;}var length=connection.closestPointLength(coords);if(relative){var totalLength=connection.length();end.anchor={name:'connectionRatio',args:{ratio:length/totalLength}};}else{end.anchor={name:'connectionLength',args:{length:length}};}return end;}var useDefaults=noop;var pinAbsolute=pin(false);var pinRelative=pin(true);var index$4={useDefaults:useDefaults,pinAbsolute:pinAbsolute,pinRelative:pinRelative};function getAnchor(coords,view,magnet){// take advantage of an existing logic inside of the\n// pin relative connection strategy\nvar end=pinRelative.call(this.paper,{},view,magnet,coords,this.model);return end.anchor;}function snapAnchor(coords,view,magnet,type,relatedView,toolView){var snapRadius=toolView.options.snapRadius;var isSource=type==='source';var refIndex=isSource?0:-1;var ref=this.model.vertex(refIndex)||this.getEndAnchor(isSource?'target':'source');if(ref){if(Math.abs(ref.x-coords.x)<snapRadius){coords.x=ref.x;}if(Math.abs(ref.y-coords.y)<snapRadius){coords.y=ref.y;}}return coords;}function getViewBBox(view,useModelGeometry){var model=view.model;if(useModelGeometry){return model.getBBox();}return model.isLink()?view.getConnection().bbox():view.getNodeUnrotatedBBox(view.el);}// Vertex Handles\nvar VertexHandle=View.extend({tagName:'circle',svgElement:true,className:'marker-vertex',events:{mousedown:'onPointerDown',touchstart:'onPointerDown',dblclick:'onDoubleClick',dbltap:'onDoubleClick'},documentEvents:{mousemove:'onPointerMove',touchmove:'onPointerMove',mouseup:'onPointerUp',touchend:'onPointerUp',touchcancel:'onPointerUp'},attributes:{'r':6,'fill':'#33334F','stroke':'#FFFFFF','stroke-width':2,'cursor':'move'},position:function(x,y){this.vel.attr({cx:x,cy:y});},onPointerDown:function(evt){if(this.options.guard(evt)){return;}evt.stopPropagation();evt.preventDefault();this.options.paper.undelegateEvents();this.delegateDocumentEvents(null,evt.data);this.trigger('will-change',this,evt);},onPointerMove:function(evt){this.trigger('changing',this,evt);},onDoubleClick:function(evt){this.trigger('remove',this,evt);},onPointerUp:function(evt){this.trigger('changed',this,evt);this.undelegateDocumentEvents();this.options.paper.delegateEvents();}});var Vertices=ToolView.extend({name:'vertices',options:{handleClass:VertexHandle,snapRadius:20,redundancyRemoval:true,vertexAdding:true,stopPropagation:true},children:[{tagName:'path',selector:'connection',className:'joint-vertices-path',attributes:{'fill':'none','stroke':'transparent','stroke-width':10,'cursor':'cell'}}],handles:null,events:{'mousedown .joint-vertices-path':'onPathPointerDown','touchstart .joint-vertices-path':'onPathPointerDown'},onRender:function(){if(this.options.vertexAdding){this.renderChildren();this.updatePath();}this.resetHandles();this.renderHandles();return this;},update:function(){var relatedView=this.relatedView;var vertices=relatedView.model.vertices();if(vertices.length===this.handles.length){this.updateHandles();}else{this.resetHandles();this.renderHandles();}if(this.options.vertexAdding){this.updatePath();}return this;},resetHandles:function(){var handles=this.handles;this.handles=[];this.stopListening();if(!Array.isArray(handles)){return;}for(var i=0,n=handles.length;i<n;i++){handles[i].remove();}},renderHandles:function(){var this$1=this;var relatedView=this.relatedView;var vertices=relatedView.model.vertices();for(var i=0,n=vertices.length;i<n;i++){var vertex=vertices[i];var handle=new this.options.handleClass({index:i,paper:this.paper,guard:function(evt){return this$1.guard(evt);}});handle.render();handle.position(vertex.x,vertex.y);this.simulateRelatedView(handle.el);handle.vel.appendTo(this.el);this.handles.push(handle);this.startHandleListening(handle);}},updateHandles:function(){var relatedView=this.relatedView;var vertices=relatedView.model.vertices();for(var i=0,n=vertices.length;i<n;i++){var vertex=vertices[i];var handle=this.handles[i];if(!handle){return;}handle.position(vertex.x,vertex.y);}},updatePath:function(){var connection=this.childNodes.connection;if(connection){connection.setAttribute('d',this.relatedView.getSerializedConnection());}},startHandleListening:function(handle){var relatedView=this.relatedView;if(relatedView.can('vertexMove')){this.listenTo(handle,'will-change',this.onHandleWillChange);this.listenTo(handle,'changing',this.onHandleChanging);this.listenTo(handle,'changed',this.onHandleChanged);}if(relatedView.can('vertexRemove')){this.listenTo(handle,'remove',this.onHandleRemove);}},getNeighborPoints:function(index){var linkView=this.relatedView;var vertices=linkView.model.vertices();var prev=index>0?vertices[index-1]:linkView.sourceAnchor;var next=index<vertices.length-1?vertices[index+1]:linkView.targetAnchor;return{prev:new Point(prev),next:new Point(next)};},onHandleWillChange:function(_handle,evt){this.focus();var ref=this;var relatedView=ref.relatedView;var options=ref.options;relatedView.model.startBatch('vertex-move',{ui:true,tool:this.cid});if(!options.stopPropagation){relatedView.notifyPointerdown.apply(relatedView,relatedView.paper.getPointerArgs(evt));}},onHandleChanging:function(handle,evt){var ref=this;var options=ref.options;var linkView=ref.relatedView;var index=handle.options.index;var ref$1=linkView.paper.getPointerArgs(evt);var normalizedEvent=ref$1[0];var x=ref$1[1];var y=ref$1[2];var vertex={x:x,y:y};this.snapVertex(vertex,index);linkView.model.vertex(index,vertex,{ui:true,tool:this.cid});handle.position(vertex.x,vertex.y);if(!options.stopPropagation){linkView.notifyPointermove(normalizedEvent,x,y);}},onHandleChanged:function(_handle,evt){var ref=this;var options=ref.options;var linkView=ref.relatedView;if(options.vertexAdding){this.updatePath();}if(!options.redundancyRemoval){return;}var verticesRemoved=linkView.removeRedundantLinearVertices({ui:true,tool:this.cid});if(verticesRemoved){this.render();}this.blur();linkView.model.stopBatch('vertex-move',{ui:true,tool:this.cid});if(this.eventData(evt).vertexAdded){linkView.model.stopBatch('vertex-add',{ui:true,tool:this.cid});}var ref$1=linkView.paper.getPointerArgs(evt);var normalizedEvt=ref$1[0];var x=ref$1[1];var y=ref$1[2];if(!options.stopPropagation){linkView.notifyPointerup(normalizedEvt,x,y);}linkView.checkMouseleave(normalizedEvt);},snapVertex:function(vertex,index){var snapRadius=this.options.snapRadius;if(snapRadius>0){var neighbors=this.getNeighborPoints(index);var prev=neighbors.prev;var next=neighbors.next;if(Math.abs(vertex.x-prev.x)<snapRadius){vertex.x=prev.x;}else if(Math.abs(vertex.x-next.x)<snapRadius){vertex.x=next.x;}if(Math.abs(vertex.y-prev.y)<snapRadius){vertex.y=neighbors.prev.y;}else if(Math.abs(vertex.y-next.y)<snapRadius){vertex.y=next.y;}}},onHandleRemove:function(handle,evt){var index$1=handle.options.index;var linkView=this.relatedView;linkView.model.removeVertex(index$1,{ui:true});if(this.options.vertexAdding){this.updatePath();}linkView.checkMouseleave(normalizeEvent(evt));},onPathPointerDown:function(evt){if(this.guard(evt)){return;}evt.stopPropagation();evt.preventDefault();var normalizedEvent=normalizeEvent(evt);var vertex=this.paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY).toJSON();var relatedView=this.relatedView;relatedView.model.startBatch('vertex-add',{ui:true,tool:this.cid});var index$1=relatedView.getVertexIndex(vertex.x,vertex.y);this.snapVertex(vertex,index$1);relatedView.model.insertVertex(index$1,vertex,{ui:true,tool:this.cid});this.update();var handle=this.handles[index$1];this.eventData(normalizedEvent,{vertexAdded:true});handle.onPointerDown(normalizedEvent);},onRemove:function(){this.resetHandles();}},{VertexHandle:VertexHandle// keep as class property\n});var SegmentHandle=View.extend({tagName:'g',svgElement:true,className:'marker-segment',events:{mousedown:'onPointerDown',touchstart:'onPointerDown'},documentEvents:{mousemove:'onPointerMove',touchmove:'onPointerMove',mouseup:'onPointerUp',touchend:'onPointerUp',touchcancel:'onPointerUp'},children:[{tagName:'line',selector:'line',attributes:{'stroke':'#33334F','stroke-width':2,'fill':'none','pointer-events':'none'}},{tagName:'rect',selector:'handle',attributes:{'width':20,'height':8,'x':-10,'y':-4,'rx':4,'ry':4,'fill':'#33334F','stroke':'#FFFFFF','stroke-width':2}}],onRender:function(){this.renderChildren();},position:function(x,y,angle,view){var matrix=V.createSVGMatrix().translate(x,y).rotate(angle);var handle=this.childNodes.handle;handle.setAttribute('transform',V.matrixToTransformString(matrix));handle.setAttribute('cursor',angle%180===0?'row-resize':'col-resize');var viewPoint=view.getClosestPoint(new Point(x,y));var line=this.childNodes.line;line.setAttribute('x1',x);line.setAttribute('y1',y);line.setAttribute('x2',viewPoint.x);line.setAttribute('y2',viewPoint.y);},onPointerDown:function(evt){if(this.options.guard(evt)){return;}this.trigger('change:start',this,evt);evt.stopPropagation();evt.preventDefault();this.options.paper.undelegateEvents();this.delegateDocumentEvents(null,evt.data);},onPointerMove:function(evt){this.trigger('changing',this,evt);},onPointerUp:function(evt){this.undelegateDocumentEvents();this.options.paper.delegateEvents();this.trigger('change:end',this,evt);},show:function(){this.el.style.display='';},hide:function(){this.el.style.display='none';}});var Segments=ToolView.extend({name:'segments',precision:.5,options:{handleClass:SegmentHandle,segmentLengthThreshold:40,redundancyRemoval:true,anchor:getAnchor,snapRadius:10,snapHandle:true,stopPropagation:true},handles:null,onRender:function(){this.resetHandles();var relatedView=this.relatedView;var vertices=relatedView.model.vertices();vertices.unshift(relatedView.sourcePoint);vertices.push(relatedView.targetPoint);for(var i=0,n=vertices.length;i<n-1;i++){var vertex=vertices[i];var nextVertex=vertices[i+1];var handle=this.renderHandle(vertex,nextVertex);this.simulateRelatedView(handle.el);this.handles.push(handle);handle.options.index=i;}return this;},renderHandle:function(vertex,nextVertex){var this$1=this;var handle=new this.options.handleClass({paper:this.paper,guard:function(evt){return this$1.guard(evt);}});handle.render();this.updateHandle(handle,vertex,nextVertex);handle.vel.appendTo(this.el);this.startHandleListening(handle);return handle;},update:function(){this.render();return this;},startHandleListening:function(handle){this.listenTo(handle,'change:start',this.onHandleChangeStart);this.listenTo(handle,'changing',this.onHandleChanging);this.listenTo(handle,'change:end',this.onHandleChangeEnd);},resetHandles:function(){var handles=this.handles;this.handles=[];this.stopListening();if(!Array.isArray(handles)){return;}for(var i=0,n=handles.length;i<n;i++){handles[i].remove();}},shiftHandleIndexes:function(value){var handles=this.handles;for(var i=0,n=handles.length;i<n;i++){handles[i].options.index+=value;}},resetAnchor:function(type,anchor){var relatedModel=this.relatedView.model;if(anchor){relatedModel.prop([type,'anchor'],anchor,{rewrite:true,ui:true,tool:this.cid});}else{relatedModel.removeProp([type,'anchor'],{ui:true,tool:this.cid});}},snapHandle:function(handle,position,data){var index=handle.options.index;var linkView=this.relatedView;var link=linkView.model;var vertices=link.vertices();var axis=handle.options.axis;var prev=vertices[index-2]||data.sourceAnchor;var next=vertices[index+1]||data.targetAnchor;var snapRadius=this.options.snapRadius;if(Math.abs(position[axis]-prev[axis])<snapRadius){position[axis]=prev[axis];}else if(Math.abs(position[axis]-next[axis])<snapRadius){position[axis]=next[axis];}return position;},onHandleChanging:function(handle,evt){var ref=this;var options=ref.options;var data=this.eventData(evt);var relatedView=this.relatedView;var paper=relatedView.paper;var index$1=handle.options.index-1;var normalizedEvent=normalizeEvent(evt);var coords=paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);var position=this.snapHandle(handle,coords.clone(),data);var axis=handle.options.axis;var offset=this.options.snapHandle?0:coords[axis]-position[axis];var link=relatedView.model;var vertices=cloneDeep(link.vertices());var vertex=vertices[index$1];var nextVertex=vertices[index$1+1];var anchorFn=this.options.anchor;if(typeof anchorFn!=='function'){anchorFn=null;}// First Segment\nvar sourceView=relatedView.sourceView;var sourceBBox=relatedView.sourceBBox;var changeSourceAnchor=false;var deleteSourceAnchor=false;if(!vertex){vertex=relatedView.sourceAnchor.toJSON();vertex[axis]=position[axis];if(sourceBBox.containsPoint(vertex)){vertex[axis]=position[axis];changeSourceAnchor=true;}else{// we left the area of the source magnet for the first time\nvertices.unshift(vertex);this.shiftHandleIndexes(1);deleteSourceAnchor=true;}}else if(index$1===0){if(sourceBBox.containsPoint(vertex)){vertices.shift();this.shiftHandleIndexes(-1);changeSourceAnchor=true;}else{vertex[axis]=position[axis];deleteSourceAnchor=true;}}else{vertex[axis]=position[axis];}if(anchorFn&&sourceView){if(changeSourceAnchor){var sourceAnchorPosition=data.sourceAnchor.clone();sourceAnchorPosition[axis]=position[axis];var sourceAnchor=anchorFn.call(relatedView,sourceAnchorPosition,sourceView,relatedView.sourceMagnet||sourceView.el,'source',relatedView);this.resetAnchor('source',sourceAnchor);}if(deleteSourceAnchor){this.resetAnchor('source',data.sourceAnchorDef);}}// Last segment\nvar targetView=relatedView.targetView;var targetBBox=relatedView.targetBBox;var changeTargetAnchor=false;var deleteTargetAnchor=false;if(!nextVertex){nextVertex=relatedView.targetAnchor.toJSON();nextVertex[axis]=position[axis];if(targetBBox.containsPoint(nextVertex)){changeTargetAnchor=true;}else{// we left the area of the target magnet for the first time\nvertices.push(nextVertex);deleteTargetAnchor=true;}}else if(index$1===vertices.length-2){if(targetBBox.containsPoint(nextVertex)){vertices.pop();changeTargetAnchor=true;}else{nextVertex[axis]=position[axis];deleteTargetAnchor=true;}}else{nextVertex[axis]=position[axis];}if(anchorFn&&targetView){if(changeTargetAnchor){var targetAnchorPosition=data.targetAnchor.clone();targetAnchorPosition[axis]=position[axis];var targetAnchor=anchorFn.call(relatedView,targetAnchorPosition,targetView,relatedView.targetMagnet||targetView.el,'target',relatedView);this.resetAnchor('target',targetAnchor);}if(deleteTargetAnchor){this.resetAnchor('target',data.targetAnchorDef);}}link.vertices(vertices,{ui:true,tool:this.cid});this.updateHandle(handle,vertex,nextVertex,offset);if(!options.stopPropagation){relatedView.notifyPointermove(normalizedEvent,coords.x,coords.y);}},onHandleChangeStart:function(handle,evt){var ref=this;var options=ref.options;var handles=ref.handles;var linkView=ref.relatedView;var model=linkView.model;var paper=linkView.paper;var index$1=handle.options.index;if(!Array.isArray(handles)){return;}for(var i=0,n=handles.length;i<n;i++){if(i!==index$1){handles[i].hide();}}this.focus();this.eventData(evt,{sourceAnchor:linkView.sourceAnchor.clone(),targetAnchor:linkView.targetAnchor.clone(),sourceAnchorDef:clone(model.prop(['source','anchor'])),targetAnchorDef:clone(model.prop(['target','anchor']))});model.startBatch('segment-move',{ui:true,tool:this.cid});if(!options.stopPropagation){linkView.notifyPointerdown.apply(linkView,paper.getPointerArgs(evt));}},onHandleChangeEnd:function(_handle,evt){var ref=this;var options=ref.options;var linkView=ref.relatedView;var paper=linkView.paper;var model=linkView.model;if(options.redundancyRemoval){linkView.removeRedundantLinearVertices({ui:true,tool:this.cid});}var normalizedEvent=normalizeEvent(evt);var coords=paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);this.render();this.blur();model.stopBatch('segment-move',{ui:true,tool:this.cid});if(!options.stopPropagation){linkView.notifyPointerup(normalizedEvent,coords.x,coords.y);}linkView.checkMouseleave(normalizedEvent);},updateHandle:function(handle,vertex,nextVertex,offset){var vertical=Math.abs(vertex.x-nextVertex.x)<this.precision;var horizontal=Math.abs(vertex.y-nextVertex.y)<this.precision;if(vertical||horizontal){var segmentLine=new Line(vertex,nextVertex);var length=segmentLine.length();if(length<this.options.segmentLengthThreshold){handle.hide();}else{var position=segmentLine.midpoint();var axis=vertical?'x':'y';position[axis]+=offset||0;var angle=segmentLine.vector().vectorAngle(new Point(1,0));handle.position(position.x,position.y,angle,this.relatedView);handle.show();handle.options.axis=axis;}}else{handle.hide();}},onRemove:function(){this.resetHandles();}},{SegmentHandle:SegmentHandle// keep as class property\n});// End Markers\nvar Arrowhead=ToolView.extend({tagName:'path',xAxisVector:new Point(1,0),events:{mousedown:'onPointerDown',touchstart:'onPointerDown'},documentEvents:{mousemove:'onPointerMove',touchmove:'onPointerMove',mouseup:'onPointerUp',touchend:'onPointerUp',touchcancel:'onPointerUp'},onRender:function(){this.update();},update:function(){var ratio=this.ratio;var view=this.relatedView;var tangent=view.getTangentAtRatio(ratio);var position,angle;if(tangent){position=tangent.start;angle=tangent.vector().vectorAngle(this.xAxisVector)||0;}else{position=view.getPointAtRatio(ratio);angle=0;}if(!position){return this;}var matrix=V.createSVGMatrix().translate(position.x,position.y).rotate(angle);this.vel.transform(matrix,{absolute:true});return this;},onPointerDown:function(evt){if(this.guard(evt)){return;}evt.stopPropagation();evt.preventDefault();var relatedView=this.relatedView;relatedView.model.startBatch('arrowhead-move',{ui:true,tool:this.cid});if(relatedView.can('arrowheadMove')){relatedView.startArrowheadMove(this.arrowheadType);this.delegateDocumentEvents();relatedView.paper.undelegateEvents();}this.focus();this.el.style.pointerEvents='none';},onPointerMove:function(evt){var normalizedEvent=normalizeEvent(evt);var coords=this.paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);this.relatedView.pointermove(normalizedEvent,coords.x,coords.y);},onPointerUp:function(evt){this.undelegateDocumentEvents();var relatedView=this.relatedView;var paper=relatedView.paper;var normalizedEvent=normalizeEvent(evt);var coords=paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);relatedView.pointerup(normalizedEvent,coords.x,coords.y);paper.delegateEvents();this.blur();this.el.style.pointerEvents='';relatedView.model.stopBatch('arrowhead-move',{ui:true,tool:this.cid});}});var TargetArrowhead=Arrowhead.extend({name:'target-arrowhead',ratio:1,arrowheadType:'target',attributes:{'d':'M -10 -8 10 0 -10 8 Z','fill':'#33334F','stroke':'#FFFFFF','stroke-width':2,'cursor':'move','class':'target-arrowhead'}});var SourceArrowhead=Arrowhead.extend({name:'source-arrowhead',ratio:0,arrowheadType:'source',attributes:{'d':'M 10 -8 -10 0 10 8 Z','fill':'#33334F','stroke':'#FFFFFF','stroke-width':2,'cursor':'move','class':'source-arrowhead'}});var Button=ToolView.extend({name:'button',events:{'mousedown':'onPointerDown','touchstart':'onPointerDown'},options:{distance:0,offset:0,rotate:false},onRender:function(){this.renderChildren(this.options.markup);this.update();},update:function(){this.position();return this;},position:function(){var ref=this;var view=ref.relatedView;var vel=ref.vel;var matrix=view.model.isLink()?this.getLinkMatrix():this.getElementMatrix();vel.transform(matrix,{absolute:true});},getElementMatrix:function getElementMatrix(){var ref=this;var view=ref.relatedView;var options=ref.options;var x=options.x;if(x===void 0)x=0;var y=options.y;if(y===void 0)y=0;var offset=options.offset;if(offset===void 0)offset={};var useModelGeometry=options.useModelGeometry;var rotate=options.rotate;var bbox=getViewBBox(view,useModelGeometry);var angle=view.model.angle();if(!rotate){bbox=bbox.bbox(angle);}var offsetX=offset.x;if(offsetX===void 0)offsetX=0;var offsetY=offset.y;if(offsetY===void 0)offsetY=0;if(isPercentage(x)){x=parseFloat(x)/100*bbox.width;}if(isPercentage(y)){y=parseFloat(y)/100*bbox.height;}var matrix=V.createSVGMatrix().translate(bbox.x+bbox.width/2,bbox.y+bbox.height/2);if(rotate){matrix=matrix.rotate(angle);}matrix=matrix.translate(x+offsetX-bbox.width/2,y+offsetY-bbox.height/2);return matrix;},getLinkMatrix:function getLinkMatrix(){var ref=this;var view=ref.relatedView;var options=ref.options;var offset=options.offset;if(offset===void 0)offset=0;var distance=options.distance;if(distance===void 0)distance=0;var rotate=options.rotate;var tangent,position,angle;if(isPercentage(distance)){tangent=view.getTangentAtRatio(parseFloat(distance)/100);}else{tangent=view.getTangentAtLength(distance);}if(tangent){position=tangent.start;angle=tangent.vector().vectorAngle(new Point(1,0))||0;}else{position=view.getConnection().start;angle=0;}var matrix=V.createSVGMatrix().translate(position.x,position.y).rotate(angle).translate(0,offset);if(!rotate){matrix=matrix.rotate(-angle);}return matrix;},onPointerDown:function(evt){if(this.guard(evt)){return;}evt.stopPropagation();evt.preventDefault();var actionFn=this.options.action;if(typeof actionFn==='function'){actionFn.call(this.relatedView,evt,this.relatedView,this);}}});var Remove=Button.extend({children:[{tagName:'circle',selector:'button',attributes:{'r':7,'fill':'#FF1D00','cursor':'pointer'}},{tagName:'path',selector:'icon',attributes:{'d':'M -3 -3 3 3 M -3 3 3 -3','fill':'none','stroke':'#FFFFFF','stroke-width':2,'pointer-events':'none'}}],options:{distance:60,offset:0,action:function(evt,view,tool){view.model.remove({ui:true,tool:tool.cid});}}});var Connect=Button.extend({name:'connect',documentEvents:{mousemove:'drag',touchmove:'drag',mouseup:'dragend',touchend:'dragend',touchcancel:'dragend'},children:[{tagName:'circle',selector:'button',attributes:{'r':7,'fill':'#333333','cursor':'pointer'}},{tagName:'path',selector:'icon',attributes:{'d':'M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z','fill':'#FFFFFF','stroke':'none','stroke-width':2,'pointer-events':'none'}}],options:{distance:80,offset:0,magnet:function(view){return view.el;},action:function(evt,_view,tool){return tool.dragstart(evt);}},getMagnetNode:function(){var assign;var ref=this;var options=ref.options;var relatedView=ref.relatedView;var magnet=options.magnet;var magnetNode;switch(typeof magnet){case'function':{magnetNode=magnet.call(this,relatedView,this);break;}case'string':{assign=relatedView.findBySelector(magnet),magnetNode=assign[0];break;}default:{magnetNode=magnet;break;}}if(!magnetNode){magnetNode=relatedView.el;}if(magnetNode instanceof SVGElement){return magnetNode;}throw new Error('Connect: magnet must be an SVGElement');},dragstart:function(evt){var ref=this;var paper=ref.paper;var relatedView=ref.relatedView;var normalizedEvent=normalizeEvent(evt);var ref$1=paper.clientToLocalPoint(normalizedEvent.clientX,normalizedEvent.clientY);var x=ref$1.x;var y=ref$1.y;relatedView.dragLinkStart(normalizedEvent,this.getMagnetNode(),x,y);paper.undelegateEvents();this.delegateDocumentEvents(null,evt.data);this.focus();},drag:function(evt){var ref=this;var paper=ref.paper;var relatedView=ref.relatedView;var normalizedEvent=normalizeEvent(evt);var ref$1=paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);var x=ref$1.x;var y=ref$1.y;relatedView.dragLink(normalizedEvent,x,y);},dragend:function(evt){var ref=this;var paper=ref.paper;var relatedView=ref.relatedView;var normalizedEvent=normalizeEvent(evt);var ref$1=paper.snapToGrid(normalizedEvent.clientX,normalizedEvent.clientY);var x=ref$1.x;var y=ref$1.y;relatedView.dragLinkEnd(normalizedEvent,x,y);this.undelegateDocumentEvents();paper.delegateEvents();this.blur();relatedView.checkMouseleave(normalizedEvent);}});var Boundary=ToolView.extend({name:'boundary',tagName:'rect',options:{padding:10,useModelGeometry:false},attributes:{'fill':'none','stroke':'#33334F','stroke-width':.5,'stroke-dasharray':'5, 5','pointer-events':'none'},onRender:function(){this.update();},update:function(){var ref=this;var view=ref.relatedView;var options=ref.options;var vel=ref.vel;var useModelGeometry=options.useModelGeometry;var rotate=options.rotate;var padding=normalizeSides(options.padding);var bbox=getViewBBox(view,useModelGeometry).moveAndExpand({x:-padding.left,y:-padding.top,width:padding.left+padding.right,height:padding.top+padding.bottom});var model=view.model;if(model.isElement()){var angle=model.angle();if(angle){if(rotate){var origin=model.getBBox().center();vel.rotate(angle,origin.x,origin.y,{absolute:true});}else{bbox=bbox.bbox(angle);}}}vel.attr(bbox.toJSON());return this;}});var Anchor=ToolView.extend({tagName:'g',type:null,children:[{tagName:'circle',selector:'anchor',attributes:{'cursor':'pointer'}},{tagName:'rect',selector:'area',attributes:{'pointer-events':'none','fill':'none','stroke':'#33334F','stroke-dasharray':'2,4','rx':5,'ry':5}}],events:{mousedown:'onPointerDown',touchstart:'onPointerDown',dblclick:'onPointerDblClick',dbltap:'onPointerDblClick'},documentEvents:{mousemove:'onPointerMove',touchmove:'onPointerMove',mouseup:'onPointerUp',touchend:'onPointerUp',touchcancel:'onPointerUp'},options:{snap:snapAnchor,anchor:getAnchor,resetAnchor:true,customAnchorAttributes:{'stroke-width':4,'stroke':'#33334F','fill':'#FFFFFF','r':5},defaultAnchorAttributes:{'stroke-width':2,'stroke':'#FFFFFF','fill':'#33334F','r':6},areaPadding:6,snapRadius:10,restrictArea:true,redundancyRemoval:true},onRender:function(){this.renderChildren();this.toggleArea(false);this.update();},update:function(){var type=this.type;var relatedView=this.relatedView;var view=relatedView.getEndView(type);if(view){this.updateAnchor();this.updateArea();this.el.style.display='';}else{this.el.style.display='none';}return this;},updateAnchor:function(){var childNodes=this.childNodes;if(!childNodes){return;}var anchorNode=childNodes.anchor;if(!anchorNode){return;}var relatedView=this.relatedView;var type=this.type;var position=relatedView.getEndAnchor(type);var options=this.options;var customAnchor=relatedView.model.prop([type,'anchor']);anchorNode.setAttribute('transform','translate('+position.x+','+position.y+')');var anchorAttributes=customAnchor?options.customAnchorAttributes:options.defaultAnchorAttributes;for(var attrName in anchorAttributes){anchorNode.setAttribute(attrName,anchorAttributes[attrName]);}},updateArea:function(){var childNodes=this.childNodes;if(!childNodes){return;}var areaNode=childNodes.area;if(!areaNode){return;}var relatedView=this.relatedView;var type=this.type;var view=relatedView.getEndView(type);var model=view.model;var magnet=relatedView.getEndMagnet(type);var padding=this.options.areaPadding;if(!isFinite(padding)){padding=0;}var bbox,angle,center;if(view.isNodeConnection(magnet)){bbox=view.getBBox();angle=0;center=bbox.center();}else{bbox=view.getNodeUnrotatedBBox(magnet);angle=model.angle();center=bbox.center();if(angle){center.rotate(model.getBBox().center(),-angle);}// TODO: get the link's magnet rotation into account\n}bbox.inflate(padding);areaNode.setAttribute('x',-bbox.width/2);areaNode.setAttribute('y',-bbox.height/2);areaNode.setAttribute('width',bbox.width);areaNode.setAttribute('height',bbox.height);areaNode.setAttribute('transform','translate('+center.x+','+center.y+') rotate('+angle+')');},toggleArea:function(visible){this.childNodes.area.style.display=visible?'':'none';},onPointerDown:function(evt){if(this.guard(evt)){return;}evt.stopPropagation();evt.preventDefault();this.paper.undelegateEvents();this.delegateDocumentEvents();this.focus();this.toggleArea(this.options.restrictArea);this.relatedView.model.startBatch('anchor-move',{ui:true,tool:this.cid});},resetAnchor:function(anchor){var type=this.type;var relatedModel=this.relatedView.model;if(anchor){relatedModel.prop([type,'anchor'],anchor,{rewrite:true,ui:true,tool:this.cid});}else{relatedModel.removeProp([type,'anchor'],{ui:true,tool:this.cid});}},onPointerMove:function(evt){var relatedView=this.relatedView;var type=this.type;var view=relatedView.getEndView(type);var model=view.model;var magnet=relatedView.getEndMagnet(type);var normalizedEvent=normalizeEvent(evt);var coords=this.paper.clientToLocalPoint(normalizedEvent.clientX,normalizedEvent.clientY);var snapFn=this.options.snap;if(typeof snapFn==='function'){coords=snapFn.call(relatedView,coords,view,magnet,type,relatedView,this);coords=new Point(coords);}if(this.options.restrictArea){if(view.isNodeConnection(magnet)){// snap coords to the link's connection\nvar pointAtConnection=view.getClosestPoint(coords);if(pointAtConnection){coords=pointAtConnection;}}else{// snap coords within node bbox\nvar bbox=view.getNodeUnrotatedBBox(magnet);var angle=model.angle();var origin=model.getBBox().center();var rotatedCoords=coords.clone().rotate(origin,angle);if(!bbox.containsPoint(rotatedCoords)){coords=bbox.pointNearestToPoint(rotatedCoords).rotate(origin,-angle);}}}var anchor;var anchorFn=this.options.anchor;if(typeof anchorFn==='function'){anchor=anchorFn.call(relatedView,coords,view,magnet,type,relatedView);}this.resetAnchor(anchor);this.update();},onPointerUp:function(evt){this.paper.delegateEvents();this.undelegateDocumentEvents();this.blur();this.toggleArea(false);var linkView=this.relatedView;if(this.options.redundancyRemoval){linkView.removeRedundantLinearVertices({ui:true,tool:this.cid});}linkView.model.stopBatch('anchor-move',{ui:true,tool:this.cid});},onPointerDblClick:function(){var anchor=this.options.resetAnchor;if(anchor===false){return;}// reset anchor disabled\nif(anchor===true){anchor=null;}// remove the current anchor\nthis.resetAnchor(cloneDeep(anchor));this.update();}});var SourceAnchor=Anchor.extend({name:'source-anchor',type:'source'});var TargetAnchor=Anchor.extend({name:'target-anchor',type:'target'});var index$5={Vertices:Vertices,Segments:Segments,SourceArrowhead:SourceArrowhead,TargetArrowhead:TargetArrowhead,SourceAnchor:SourceAnchor,TargetAnchor:TargetAnchor,Button:Button,Remove:Remove,Connect:Connect,Boundary:Boundary};var Control=ToolView.extend({tagName:'g',children:[{tagName:'circle',selector:'handle',attributes:{'cursor':'pointer','stroke-width':2,'stroke':'#FFFFFF','fill':'#33334F','r':6}},{tagName:'rect',selector:'extras',attributes:{'pointer-events':'none','fill':'none','stroke':'#33334F','stroke-dasharray':'2,4','rx':5,'ry':5}}],events:{mousedown:'onPointerDown',touchstart:'onPointerDown',dblclick:'onPointerDblClick',dbltap:'onPointerDblClick'},documentEvents:{mousemove:'onPointerMove',touchmove:'onPointerMove',mouseup:'onPointerUp',touchend:'onPointerUp',touchcancel:'onPointerUp'},options:{handleAttributes:null,selector:'root',padding:6},getPosition:function(){// To be overridden\n},setPosition:function(){// To be overridden\n},resetPosition:function(){// To be overridden\n},onRender:function(){this.renderChildren();this.toggleExtras(false);this.update();},update:function(){var ref=this.childNodes;var handle=ref.handle;var extras=ref.extras;if(handle){this.updateHandle(handle);}else{throw new Error('Control: markup selector `handle` is required');}if(extras){this.updateExtras(extras);}return this;},updateHandle:function(handleNode){var ref=this;var relatedView=ref.relatedView;var options=ref.options;var model=relatedView.model;var relativePos=this.getPosition(relatedView,this);var absolutePos=model.getAbsolutePointFromRelative(relativePos);handleNode.setAttribute('transform',\"translate(\"+absolutePos.x+\",\"+absolutePos.y+\")\");var handleAttributes=options.handleAttributes;if(handleAttributes){for(var attrName in handleAttributes){handleNode.setAttribute(attrName,handleAttributes[attrName]);}}},updateExtras:function(extrasNode){var ref=this;var relatedView=ref.relatedView;var options=ref.options;var ref$1=this.options;var selector=ref$1.selector;if(!selector){this.toggleExtras(false);return;}var ref$2=relatedView.findBySelector(selector);var magnet=ref$2[0];if(!magnet){throw new Error('Control: invalid selector.');}var padding=options.padding;if(!isFinite(padding)){padding=0;}var bbox=relatedView.getNodeUnrotatedBBox(magnet);var model=relatedView.model;var angle=model.angle();var center=bbox.center();if(angle){center.rotate(model.getBBox().center(),-angle);}bbox.inflate(padding);extrasNode.setAttribute('x',-bbox.width/2);extrasNode.setAttribute('y',-bbox.height/2);extrasNode.setAttribute('width',bbox.width);extrasNode.setAttribute('height',bbox.height);extrasNode.setAttribute('transform',\"translate(\"+center.x+\",\"+center.y+\") rotate(\"+angle+\")\");},toggleExtras:function(visible){var ref=this.childNodes;var extras=ref.extras;if(!extras){return;}extras.style.display=visible?'':'none';},onPointerDown:function(evt){var ref=this;var relatedView=ref.relatedView;var paper=ref.paper;if(this.guard(evt)){return;}evt.stopPropagation();evt.preventDefault();paper.undelegateEvents();this.delegateDocumentEvents();this.focus();this.toggleExtras(true);relatedView.model.startBatch('control-move',{ui:true,tool:this.cid});},onPointerMove:function(evt){var ref=this;var relatedView=ref.relatedView;var paper=ref.paper;var model=relatedView.model;var ref$1=normalizeEvent(evt);var clientX=ref$1.clientX;var clientY=ref$1.clientY;var coords=paper.clientToLocalPoint(clientX,clientY);var relativeCoords=model.getRelativePointFromAbsolute(coords);this.setPosition(relatedView,relativeCoords,this);this.update();},onPointerUp:function(_evt){var ref=this;var relatedView=ref.relatedView;var paper=ref.paper;paper.delegateEvents();this.undelegateDocumentEvents();this.blur();this.toggleExtras(false);relatedView.model.stopBatch('control-move',{ui:true,tool:this.cid});},onPointerDblClick:function(){var ref=this;var relatedView=ref.relatedView;this.resetPosition(relatedView,this);this.update();}});var index$6={Button:Button,Remove:Remove,Connect:Connect,Boundary:Boundary,Control:Control};var version=\"3.5.5\";var Vectorizer=V;var layout={PortLabel:PortLabel,Port:Port};var setTheme=function(theme,opt){opt=opt||{};invoke(views,'setTheme',theme,opt);// Update the default theme on the view prototype.\nView.prototype.defaultTheme=theme;};var layout$1={DirectedGraph:DirectedGraph,PortLabel:PortLabel,Port:Port};// export empty namespaces - backward compatibility\nvar format$1={};var ui={};exports.V=V;exports.Vectorizer=Vectorizer;exports.anchors=anchors;exports.config=config;exports.connectionPoints=connectionPoints;exports.connectionStrategies=index$4;exports.connectors=connectors;exports.dia=index$2;exports.elementTools=index$6;exports.env=env;exports.format=format$1;exports.g=g;exports.highlighters=highlighters;exports.layout=layout$1;exports.linkAnchors=linkAnchors;exports.linkTools=index$5;exports.mvc=index$1;exports.routers=routers;exports.setTheme=setTheme;exports.shapes=index$3;exports.ui=ui;exports.util=index;exports.version=version;Object.defineProperty(exports,'__esModule',{value:true});});if(typeof joint!=='undefined'){var g=joint.g,V=joint.V,Vectorizer=joint.V;}","map":{"version":3,"names":["global","factory","exports","module","require","define","amd","self","joint","Backbone","_","$","hasOwnProperty","commonjsGlobal","window","commonjsRequire","Error","unwrapExports","x","__esModule","Object","prototype","call","default","createCommonjsModule","fn","getCjsExportFromNamespace","n","check","it","Math","global_1","globalThis","Function","fails","exec","error","descriptors","defineProperty","get","nativePropertyIsEnumerable","propertyIsEnumerable","getOwnPropertyDescriptor","NASHORN_BUG","f","V","descriptor","enumerable","objectPropertyIsEnumerable","createPropertyDescriptor","bitmap","value","configurable","writable","toString","classofRaw","slice","split","indexedObject","requireObjectCoercible","undefined","TypeError","toIndexedObject","isObject","toPrimitive","input","PREFERRED_STRING","val","valueOf","has","key","document$1","document","EXISTS","createElement","documentCreateElement","ie8DomDefine","a","nativeGetOwnPropertyDescriptor","f$1","O","P","objectGetOwnPropertyDescriptor","anObject","String","nativeDefineProperty","f$2","Attributes","objectDefineProperty","createNonEnumerableProperty","object","setGlobal","SHARED","store","sharedStore","functionToString","inspectSource","WeakMap","nativeWeakMap","test","isPure","shared","push","version","mode","copyright","id","postfix","random","uid","keys","sharedKey","hiddenKeys","WeakMap$1","set","has$1","enforce","getterFor","TYPE","state","type","store$1","wmget","wmhas","wmset","metadata","facade","STATE","internalState","internalState_1","internalState_2","internalState_3","internalState_4","internalState_5","redefine","getInternalState","enforceInternalState","TEMPLATE","options","unsafe","simple","noTargetGet","source","join","path","aFunction","variable","getBuiltIn","namespace","method","arguments","length","ceil","floor","toInteger","argument","isNaN","min","toLength","max","min$1","toAbsoluteIndex","index","integer","createMethod","IS_INCLUDES","$this","el","fromIndex","arrayIncludes","includes","indexOf","arrayIncludes_1","arrayIncludes_2","objectKeysInternal","names","i","result","enumBugKeys","hiddenKeys$1","concat","f$3","getOwnPropertyNames","objectGetOwnPropertyNames","f$4","getOwnPropertySymbols","objectGetOwnPropertySymbols","ownKeys","copyConstructorProperties","target","replacement","isForced","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","isForced_1","getOwnPropertyDescriptor$1","_export","TARGET","GLOBAL","STATIC","stat","FORCED","targetProperty","sourceProperty","forced","sham","nativeSymbol","Symbol","useSymbolAsUid","iterator","WellKnownSymbolsStore","Symbol$1","createWellKnownSymbol","withoutSetter","wellKnownSymbol","name","objectKeys","objectDefineProperties","defineProperties","Properties","html","GT","LT","PROTOTYPE","SCRIPT","IE_PROTO","EmptyConstructor","scriptTag","content","NullProtoObjectViaActiveX","activeXDocument","write","close","temp","parentWindow","NullProtoObjectViaIFrame","iframe","JS","iframeDocument","style","display","appendChild","src","contentWindow","open","F","NullProtoObject","domain","ActiveXObject","objectCreate","create","UNSCOPABLES","ArrayPrototype","Array","addToUnscopables","cache","thrower","arrayMethodUsesToLength","METHOD_NAME","ACCESSORS","argument0","argument1","$includes","USES_TO_LENGTH","proto","es_array_includes","aFunction$1","functionBindContext","that","b","c","apply","entryUnbind","CONSTRUCTOR","METHOD","includes$1","toObject","isArray","arg","SPECIES","arraySpeciesCreate","originalArray","C","constructor","createMethod$1","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","IS_FILTER_OUT","NO_HOLES","callbackfn","specificCreate","boundFunction","arrayIteration","forEach","map","filter","some","every","find","findIndex","filterOut","arrayIteration_1","arrayIteration_2","arrayIteration_3","arrayIteration_4","arrayIteration_5","arrayIteration_6","arrayIteration_7","arrayIteration_8","$find","FIND","SKIPS_HOLES","USES_TO_LENGTH$1","es_array_find","find$1","createMethod$2","CONVERT_TO_STRING","pos","S","position","size","first","second","charCodeAt","charAt","stringMultibyte","codeAt","stringMultibyte_1","stringMultibyte_2","correctPrototypeGetter","getPrototypeOf","IE_PROTO$1","ObjectPrototype","objectGetPrototypeOf","ITERATOR","BUGGY_SAFARI_ITERATORS","returnThis","IteratorPrototype","PrototypeOfArrayIteratorPrototype","arrayIterator","NEW_ITERATOR_PROTOTYPE","iteratorsCore","iteratorsCore_1","iteratorsCore_2","defineProperty$1","TO_STRING_TAG","setToStringTag","TAG","iterators","IteratorPrototype$1","returnThis$1","createIteratorConstructor","IteratorConstructor","NAME","next","aPossiblePrototype","objectSetPrototypeOf","setPrototypeOf","CORRECT_SETTER","setter","__proto__","IteratorPrototype$2","BUGGY_SAFARI_ITERATORS$1","ITERATOR$1","KEYS","VALUES","ENTRIES","returnThis$2","defineIterator","Iterable","DEFAULT","IS_SET","getIterationMethod","KIND","defaultIterator","IterablePrototype","values","entries","INCORRECT_VALUES_NAME","nativeIterator","anyNativeIterator","CurrentIteratorPrototype","methods","KEY","STRING_ITERATOR","setInternalState","iterated","point","done","es_string_iterator","iteratorClose","returnMethod","callWithSafeIterationClosing","ITERATOR$2","ArrayPrototype$1","isArrayIteratorMethod","createProperty","propertyKey","TO_STRING_TAG$1","toStringTagSupport","TO_STRING_TAG$2","CORRECT_ARGUMENTS","tryGet","classof","tag","callee","ITERATOR$3","getIteratorMethod","arrayFrom","from","arrayLike","argumentsLength","mapfn","mapping","iteratorMethod","step","ITERATOR$4","SAFE_CLOSING","called","iteratorWithReturn","checkCorrectnessOfIteration","SKIP_CLOSING","ITERATION_SUPPORT","INCORRECT_ITERATION","iterable","es_array_from","from_1","from_1$1","$findIndex","FIND_INDEX","SKIPS_HOLES$1","USES_TO_LENGTH$2","es_array_findIndex","findIndex$1","base64","chars","InvalidCharacterError","message","btoa","str","block","charCode","idx","output","atob","bc","bs","buffer","fromCharCode","number","es_number_isNan","isNan","Number","isNan$1","globalIsFinite","isFinite","numberIsFinite","es_number_isFinite","_isFinite","_isFinite$1","MATCH","isRegexp","isRegExp","notARegexp","MATCH$1","correctIsRegexpLogic","regexp","error1","error2","searchString","es_string_includes","includes$2","includes$3","getOwnPropertyDescriptor$2","nativeStartsWith","startsWith","min$2","CORRECT_IS_REGEXP_LOGIC","MDN_POLYFILL_BUG","search","es_string_startsWith","startsWith$1","Uint8Array","subarray","start","end","set_","array","offset","TypedArray","arg1","byteLength","Uint32Array","Int32Array","round","floor$1","PI","scale","linear","range","domainSpan","rangeSpan","normalizeAngle","angle","snapToGrid","gridSize","toDeg","rad","toRad","deg","over360","cos","sin","atan2","bearing","p","q","lat1","y","lat2","lon1","lon2","dLon","brng","bearings","parseInt","squaredLength","x0","y0","x1","y1","sqrt","types","Point","Line","Ellipse","Rect","Polyline","Polygon","Curve","Path","abs","cos$1","sin$1","min$3","max$1","atan2$1","round$1","pow","PI$1","xy","parseFloat","fromPolar","distance","origin","x2","y2","chooseClosest","points","closest","minSqrDistance","Infinity","sqrDistance","squaredDistance","adhereToRect","r","containsPoint","width","height","angleBetween","p1","p2","equals","NaN","theta","changeInAngle","dx","dy","ref","clone","cross","difference","dot","lerp","t","magnitude","manhattanDistance","move","reflection","rotate","cosAngle","sinAngle","precision","sx","sy","gx","gy","toJSON","toPolar","o","serialize","update","vectorAngle","zero","translate","max$2","min$4","horizontalPoint","bbox","left","top","right","bottom","closestPoint","pointAt","closestPointNormalizedLength","closestPointLength","product","vector","cpNormalizedLength","closestPointTangent","tangentAt","divideAt","ratio","dividerPoint","divideAtLength","pointAtLength","l","intersect","shape","opt","intersectionWithLine","intersection","line","pt1Dir","pt2Dir","det","deltaPt","alpha","beta","isDifferentiable","midpoint","parallel","eRef","sRef","fromStart","lineLength","pointOffset","determinant","setLength","currentLength","scaleFactor","tangentStart","tangentLine","tangentAtLength","tx","ty","sqrt$1","round$2","pow$1","fromRect","rect","center","normalizedDistance","ellipse","inflate","intersections","a1","a2","rx","ry","dir","diff","mDir","mDiff","d","root","ta","tb","intersectionWithLineFromCenterToPoint","pointNearestToPoint","m","mSquared","aSquared","bSquared","tangentTheta","refPointDelta","q1","q3","abs$1","cos$2","sin$2","min$5","max$3","round$3","pow$2","w","h","fromEllipse","e","fromPointUnion","len","minX","minY","maxX","maxY","fromRectUnion","rects","mX","mY","rotateAroundCenter","st","ct","bottomLeft","bottomLine","bottomRight","bottomMiddle","containsRect","r0","r1","w0","h0","w1","h1","corner","mr","nr","myOrigin","myCorner","rOrigin","rCorner","rectLines","topLine","rightLine","leftLine","dedupeArr","pt","sides","connector","topLeft","leftMiddle","maxRectScaleToFit","sx1","sx2","sx3","sx4","sy1","sy2","sy3","sy4","ox","oy","p3","topRight","p4","maxRectUniformScaleToFit","moveAndExpand","newx","newy","newwidth","newheight","side","sideNearestToPoint","rightMiddle","distToLeft","distToRight","distToTop","distToBottom","topMiddle","union","parsePoints","svgString","trim","coords","clonePoints","numPoints","newPoints","convexHull","startPoint","sortedPointRecords","entry","sort","record1","record2","sortOutput","startPointRecord","unshift","insidePoints","hullPointRecords","currentPointRecord","currentPoint","lastHullPointRecord","lastHullPoint","secondLastHullPointRecord","secondLastHullPoint","pop","correctTurnFound","crossProduct","THRESHOLD","lowestHullIndex","indexOfLowestHullIndexRecord","currentHullIndex","hullPointRecordsReordered","newFirstChunk","newSecondChunk","hullPoints","parse","cpLength","lengthPoints","cp","startIndex","endIndex","numIntersections","segment","ray","rayEnd","xDifference","otherPoints","otherPoint","l2","int","polylineLength","lastPoint","simplify","threshold","currentIndex","firstIndex","middleIndex","lastIndex","firstPoint","middlePoint","chord","closestPointDistance","splice","lastValidLine","abs$2","sqrt$2","min$6","max$4","pow$3","controlPoint1","controlPoint2","throughPoints","getCurveControlPoints","knots","firstControlPoints","secondControlPoints","rhs","getFirstControlPoints","tmp","controlPoints","curves","x3","y3","tvalues","bounds","t1","t2","b2ac","sqrtb2ac","j","jlen","mt","X","Y","pointAtT","closestPointT","PRECISION","subdivisions","getSubdivisions","localOpt","lengthAtT","investigatedSubdivision","investigatedSubdivisionStartT","investigatedSubdivisionEndT","distFromStart","distFromEnd","chordLength","minSumDist","subdivisionSize","currentSubdivision","startDist","endDist","sumDist","precisionRatio","startPrecisionRatio","endPrecisionRatio","hasRequiredPrecision","hasMinimalStartDistance","hasMinimalEndDistance","hasMinimalDistance","divided","divide","startDist1","endDist1","sumDist1","startDist2","endDist2","sumDist2","tangentAtT","polyline","toPolyline","divideAtT","tAt","tAtLength","dividerPoints","getSkeletonPoints","startControl1","startControlPoint1","startControl2","startControlPoint2","divider","dividerControl1","dividerControlPoint1","dividerControl2","dividerControlPoint2","endpointDistance","control1","control2","midpoint1","midpoint2","midpoint3","subControl1","subControl2","previousLength","iteration","newSubdivisions","numSubdivisions","numNewSubdivisions","currentNewSubdivision","observedPrecisionRatio","subCurve","subCurveLength","skeletonPoints","curveLength","baselinePointDistFromStart","baselinePointDistFromEnd","newBaselinePointDistFromStart","newBaselinePointDistFromEnd","baseline1Length","baseline2Length","toPoints","extend","obj","arguments$1","args","child","inheritedProperty","segments","reduce","acc","isSegment","appendSegment","previousObj","createSegment","pathData","commandRe","commands","match","numCommands","command","argRe","segmentConstructor","segmentTypes","applyToNew","numSegments","currentSegment","previousSegment","nextSegment","prepareSegment","currentArg","isVisible","segmentBBox","lastSegment","segmentSubdivisions","getSegmentSubdivisions","minSquaredDistance","segmentClosestPointT","segmentClosestPoint","segmentIndex","polylines","toPolylines","numPolylines","pathLength","dividedSegmentIndex","lastValidSegment","lastValidSegmentIndex","getSegment","pathCopy","replaceSegment","divisionStartIndex","divisionMidIndex","divisionEndIndex","removeSegment","movetoEnd","insertSegment","secondPathSegmentIndexConversion","originalSegment","subpathStartSegment","convertedSegment","firstPath","secondPath","otherSegments","otherSegment","getSubpaths","validatedPath","validate","subpaths","isSubpathStart","polylineIntersection","isValid","tValue","precisison","lastVisibleSegment","updateSubpathStart","updateSubpathStartSegment","removedSegment","replacedSegment","segmentAt","segmentIndexAt","segmentAtLength","segmentIndexAtLength","lastVisibleSegmentIndex","partialPoints","currentSegmentSubdivisions","subdivisionPoints","curve","argsArray","bind","segmentPrototype","Lineto","outputArray","segmentCoords","segmentPoint","linetoPrototype","Curveto","segmentPoints","curvetoPrototype","c1","c2","Moveto","movetoPrototype","Closepath","closepathPrototype","L","M","Z","z","regexSupportedData","RegExp","isDataSupported","bezier","curveThroughPoints","console","warn","getCurveDivider","p0","divideCurve","getInversionSolver","solveInversion","exists","shape1","shape2","shape1opt","shape2opt","lineWithLine","ellipseWithLine","ellipseWithEllipse","rectWithLine","rectWithEllipse","rectWithRect","polylineWithLine","polylineWithEllipse","polylineWithRect","polylineWithPolyline","polygonWithLine","polygonWithEllipse","polygonWithRect","polygonWithPolyline","polygonWithPolygon","pathWithLine","pathWithEllipse","pathWithRect","pathWithPolyline","pathWithPolygon","pathWithPath","line1","line2","x4","y4","s1x","s1y","s2x","s2y","s3x","s3y","s","rex","rey","xe","ye","rex_2","rey_2","A","B","D","ellipse1","ellipse2","_ellipsesIntersection","rect1","rect2","_polylineWithLine","interior","_polylineWithEllipse","_polylineWithRect","polyline1","polyline2","_polylineWithPolyline","polygon","polygon1","polygon2","_polylineWithPolygon","pathOpt","subpath","ref$1","_pathWithPolyline","path1","path2","pathOpt1","pathOpt2","thisPoints","thisPolyline","e1","e2","w2","sinW1","cosW1","sinW2","cosW2","sinW1s","cosW1s","sinCos1","sinW2s","cosW2s","sinCos2","a1s","b1s","a2s","b2s","A1","A2","B1","B2","C1","C2","D1","D2","E1","E2","F1","F2","l3","det3","l0","l1","delta1","det2","delta2","delta3","dP","_intersection","g","hasSvg","SVGAngle","implementation","hasFeature","ns","svg","xmlns","xml","xlink","xhtml","SVGVersion","math","attrs","children","isV","node","isString","createSvgDocument","svgDoc","childNodes","arrayOfVels","childNode","importNode","firstChild","createElementNS","ensureId","setAttributes","append","VPrototype","getTransformToElement","isSVGGraphicsElement","targetCTM","toNode","getScreenCTM","nodeCTM","inverse","multiply","createSVGMatrix","transform","matrix","isUndefined","transformStringToMatrix","attr","absolute","matrixToTransformString","svgTransform","createSVGTransform","baseVal","appendItem","transformAttr","parseTransformString","newTx","newTy","newTranslate","cx","cy","newAngle","newOrigin","newRotate","newScale","withoutTransformations","box","ownerSVGElement","getBBox","clientLeft","clientTop","clientWidth","clientHeight","transformRect","outputBBox","recursive","currentChild","childBBox","createTextPathNode","vel","textPathElement","linkedPath","appendTo","defs","annotateTextLine","lineNode","lineAnnotations","includeAnnotationIndices","eol","lineHeight","baseSize","maxFontSize","fontMetrics","lastJ","annotation","fontSize","annotationAttrs","vTSpan","tspanNode","textContent","annotationClass","addClass","annotations","createTextNode","emRegex","convertEmToPx","em","numerical","calculateDY","alignment","linesMetrics","baseSizePx","lineMetrics","flMaxFont","rLineHeights","lineHeightPx","iLineHeight","llMaxFont","text","sanitizeText","displayEmpty","textPath","verticalAnchor","textVerticalAnchor","namedVerticalAnchor","iai","defaultLineHeight","autoLineHeight","empty","doc","containerNode","createDocumentFragment","lines","annotatedY","lastI","lineClassName","annotateString","lineNodeStyle","fillOpacity","strokeOpacity","setAttribute","className","rh","removeAttr","qualifiedName","qualifyAttr","hasAttributeNS","local","removeAttributeNS","hasAttribute","removeAttribute","attributes","getAttribute","attrName","normalizePath","tagName","normalizePathData","remove","parentNode","removeChild","els","prepend","before","parent","insertBefore","SVGSVGElement","toUpperCase","context","defsNode","getElementsByTagName","cloneNode","uniqueId","findOne","selector","found","querySelector","vels","nodes","querySelectorAll","nodeType","previousSibling","findParentByClass","terminator","hasClass","contains","bup","compareDocumentPosition","toLocalPoint","createSVGPoint","globalPoint","matrixTransform","globalToLocalMatrix","translateCenterToPoint","translateAndAutoOrient","reference","translateToOrigin","setTranslate","rotateAroundOrigin","setRotate","translateFromOrigin","finalPosition","ctm","setMatrix","animateAlongPath","animateMotion","mpath","beginElement","documentElement","animation","animators","animationID","id2anim","targets","getTargets","animator","Animator","register","prevClasses","removeClass","newClasses","toggleClass","toAdd","toRemove","sample","interval","getTotalLength","samples","getPointAtLength","convertToPath","convertToPathData","convertLineToPathData","convertPolygonToPathData","convertPolylineToPathData","convertEllipseToPathData","convertCircleToPathData","convertRectToPathData","toGeometryShape","getPointsFromSvgNode","findIntersection","spot","gRect","rectMatrix","rectMatrixComponents","decomposeMatrix","resetRotation","rotation","pathNode","minDistance","closestSamples","gp","centerDistance","refDistance","setAttributeNS","XMLString","parseXML","async","createSVGStyle","stylesheet","createCDATASection","createDocument","idCounter","nodeName","parser","DOMParser","parseFromString","combinedKey","transformRegex","transformSeparatorRegex","transformationListRegex","transformationMatrix","matches","transformationString","transformationMatch","scaleNonUniform","skewX","skewY","separator","decomposedMatrix","translateX","translateY","scaleX","scaleY","transformations","translateMatch","rotateMatch","scaleMatch","deltaTransformPoint","px","py","matrixToScale","matrixToRotate","matrixToTranslate","isVElement","SVGElement","svgDocument","svgMatrix","component","SVGMatrix","createSVGTransformFromMatrix","corner1","corner2","corner3","corner4","transformPoint","transformLine","transformPolyline","inPoints","outPoints","styleToObject","styleString","ret","styles","pair","createSlicePathData","innerRadius","outerRadius","startAngle","endAngle","svgArcMax","a0","da","df","c0","s0","s1","mergeAttrs","compacted","batch","item","prev","JSON","stringify","findAnnotationsAtIndex","findAnnotationsBetweenIndexes","shiftAnnotations","svgPointsToPath","nodePoints","numberOfItems","getItem","KAPPA","circle","cd","cdx","cdy","rectToPath","topRx","bottomRx","topRy","bottomRy","spaces","pathCommand","pathValues","tan","asin","q2c","ax","ay","_13","_23","a2c","large_arc_flag","sweep_flag","_120","res","rx2","ry2","k","f1","toFixed","f2","f2old","x2old","y2old","s2","hx","hy","m1","m2","m3","m4","newres","ii","parsePathString","pathString","paramCounts","v","params","pathToAbsolute","pathArray","mx","my","pa0","pa","jj","kk","bx","by","qx","qy","processPath","pcom","nx","ny","T","Q","fixArc","pp","shift","pi","pcoms","pfirst","seg","seglen","config","useCSSSelectors","classNamePrefix","defaultTheme","doubleTapInterval","addClassNamePrefix","_className","substr","removeClassNamePrefix","parseDOMJSON","json","selectors","groupSelectors","svgNamespace","fragment","queue","siblingsDef","nodeDef","namespaceURI","wrapper","css","nodeSelector","nodeGroups","groupSelector","nodeGroup","group","childrenDef","hashCode","hash","getByPath","delimiter","isGetSafe","setByPath","last","diver","value$1","unsetByPath","flattenObject","delim","stop","shouldGoDeeper","flatObject","flatKey","uuid","guid","toKebabCase","normalizeEvent","evt","normalizedEvent","touchEvt","originalEvent","changedTouches","property","useElement","correspondingUseElement","nextFrame","raf","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","lastTime","callback","currTime","Date","getTime","timeToCall","setTimeout","rest","cancelFrame","caf","client","cancelAnimationFrame","webkitCancelAnimationFrame","webkitCancelRequestAnimationFrame","msCancelAnimationFrame","msCancelRequestAnimationFrame","oCancelAnimationFrame","oCancelRequestAnimationFrame","mozCancelAnimationFrame","mozCancelRequestAnimationFrame","clearTimeout","shapePerimeterConnectionPoint","linkView","view","magnet","scalable","rotatable","paper","cells","model","isPercentage","parseCssNumeric","restrictUnits","getUnit","validUnitExp","unit","breakText","textSpan","textElement","textNode","opacity","body","hyphen","maxLineCount","isNumber","words","full","word","isEol","eolWords","jl","getComputedTextLength","partition","substring","hyphenIndex","lastL","heightValue","ellipsis","lastLine","lastLineWithOmission","lastChar","separatorChar","sanitizeHTML","parseHTML","each","currentNode","currentAttribute","attrValue","downloadBlob","blob","fileName","navigator","msSaveBlob","url","URL","createObjectURL","link","href","download","click","revokeObjectURL","downloadDataUri","dataUri","dataUriToBlob","decodeURIComponent","firstCommaIndex","dataTypeString","mimeString","decodedString","unescape","encodeURIComponent","ia","Blob","imageToDataUri","modernHandler","xhr","status","reader","FileReader","onload","onerror","readAsDataURL","response","legacyHandler","Uint8ToString","u8a","CHUNK_SZ","bytes","suffix","meta","b64encoded","XMLHttpRequest","addEventListener","responseType","send","getElementBBox","$el","element","ownerDocument","clientBBox","getBoundingClientRect","strokeWidthX","strokeWidthY","pageXOffset","offsetLeft","pageYOffset","offsetTop","sortElements","elements","comparator","$elements","placements","sortElement","nextSibling","setAttributesBySelector","$element","forIn","addBack","has$2","omit","normalizeSides","vertical","horizontal","timing","quad","cubic","inout","t3","exponential","bounce","reverse","reflect","clamp","back","elastic","interpolate","hexColor","ca","cb","ra","rd","ga","gd","ba","bd","ma","mb","u","outline","tpl","margin","template","color","highlight","blur","stdDeviation","dropShadow","grayscale","amount","sepia","saturate","hueRotate","invert","amount2","brightness","contrast","format","specifier","locale","currency","decimal","thousands","grouping","re","fill","align","sign","symbol","zfill","comma","prefix","zcomma","negative","fullSuffix","convert","lastIndexOf","after","formatGroup","padding","formatString","fieldDelimiterIndex","fieldDelimiter","endPlaceholder","formattedStringArray","pieceFormattedString","formatSpec","fieldName","toPrecision","toExponential","log","LN10","prefixes","regex","_attr","attrArray","toggleFullScreen","topDocument","prefixedResult","prop","propName","isFunction","mixin","assign","supplement","defaults","deepMixin","deepSupplement","defaultsDeep","invoke","invokeMap","sortedIndex","sortedIndexBy","uniq","uniqBy","cloneDeep","isEmpty","isEqual","isPlainObject","toArray","debounce","groupBy","sortBy","flattenDeep","without","intersection$1","pick","bindAll","camelCase","merge","mergeWith","customizer","noop","customResult","isBoolean","isObject$1","cloneCells","cloneMap","cell","isLink","embeds","newEmbeds","embed","props","minimum","maximum","diagonal","propsList","numberPattern","findSpacesRegex","parseExpressionRegExp","throwInvalid","expression","evalCalcExpression","add","evalAddExpression","addExpression","isCalcAttribute","calcStart","calcStartOffset","evalCalcAttribute","attributeValue","refBBox","startSearchIndex","calcIndex","calcEndIndex","brackets","findClosingBracket","calcValue","setWrapper","dimension","isValuePercentage","positionWrapper","axis","valuePercentage","delta","refOrigin","offsetWrapper","nodeBBox","shapeWrapper","shapeConstructor","cacheName","resetOffset","$node","cachedShape","shapeBBox","shapeOrigin","fitScale","dWrapper","pathConstructor","pointsWrapper","atConnectionWrapper","zeroVector","tangent","setIfChangedWrapper","attribute","setIfChanged","isTextInUse","_value","_node","isLinkView","contextMarker","marker","stroke","setPaintURL","def","definePattern","defineGradient","attributesNS","xlinkShow","xlinkRole","xlinkType","xlinkArcrole","xlinkTitle","xlinkActuate","xmlSpace","xmlBase","xmlLang","preserveAspectRatio","requiredExtension","requiredFeatures","systemLanguage","externalResourcesRequired","xlinkHref","qualify","defineFilter","sourceMarker","defineMarker","targetMarker","vertexMarker","_text","textWrap","textAttrs","textHash","pathSelector","findBySelector","SVGPathElement","wrappedText","fontWeight","fontFamily","letterSpacing","title","titleNode","port","refX","refY","refDx","refDy","refWidth","refHeight","refRx","refRy","refRInscribed","widthFn","heightFn","refRCircumscribed","diagonalLength","rValue","refCx","refCy","xAlignment","yAlignment","refDResetOffset","refDKeepOffset","refPointsResetOffset","refPointsKeepOffset","connection","stubs","getConnectionLength","getConnection","sourceParts","targetParts","getSerializedConnection","atConnectionLengthKeepGradient","atConnectionLengthIgnoreGradient","atConnectionRatioKeepGradient","atConnectionRatioIgnoreGradient","setCalcAttribute","refR","refD","refPoints","atConnectionLength","atConnectionRatio","refX2","refY2","refWidth2","refHeight2","Cell","Model","preinitialize","cid","collection","changed","initialize","defaultAttrs","finalAttrs","defaultAttr","value2","name2","idAttribute","getIdAttribute","generateId","silent","_transitionIds","_scheduledTransitionIds","processPorts","on","previousPorts","ports","removedPorts","graph","inboundLinks","getConnectedLinks","inbound","outboundLinks","outbound","startBatch","parentCell","getParentCell","unembed","embeddedCells","getEmbeddedCells","trigger","stopBatch","toFront","maxZIndex","deep","breadthFirst","shouldUpdate","toBack","minZIndex","canEmbed","_embedCells","_unembedCells","this$1","isEmbeddedIn","batchName","unset","parentId","getCell","getAncestors","ancestors","cellId","isEmbedded","_isString","pathArrayLength","propertyPath","propertyValue","propertyPathArray","initializer","prevProperty","pathItem","isArrayIndex","baseAttributes","rewrite","removeProp","dirty","nestedPath","transition","duration","delay","timingFunction","valueFunction","firstFrameTime","interpolatingFunction","runtime","progress","transitionId","initialId","initiator","stopPendingTransitions","getTransitions","stopScheduledTransitions","transitions","transitionIds","stopTransitions","addTo","addCell","findView","findViewByModel","isElement","getChangeFlag","flag","hasChanged","getPointFromConnectedLink","getPointRotatedAroundCenter","getAbsolutePointFromRelative","getRelativePointFromAbsolute","getAttributeDefinition","defNS","globalDefNS","protoProps","staticProps","shapes","wrapWith","wrappers","portTransformAttrs","trans","lineLayout","ellipseLayout","elBBox","stepFn","compensateRotation","dr","argPoint","line$1","ellipseSpread","stepAngle","ellipse$1","count","Port","labelAttributes","opt1","opt2","outsideLayout","portPosition","autoOrient","getBBoxAngles","textAnchor","orientAngle","tl","bl","br","tr","insideLayout","bBoxAngles","radialLayout","portCenterOffset","manual","left$1","right$1","top$1","bottom$1","outsideOriented","outside","insideOriented","inside","radial","radialOriented","PortLabel","Link","markup","toolMarkup","doubleToolMarkup","vertexMarkup","arrowheadMarkup","defaultLabel","labelMarkup","_builtins","pointerEvents","disconnect","setSource","setOpt","isCellProvided","isPointProvided","setTarget","router","isRouterProvided","localRouter","isConnectorProvided","localConnector","label","labels","hasLabels","insertLabel","appendLabel","removeLabel","vertex","vertices","setVertex","_normalizeVertex","setVertices","insertVertex","removeVertex","translateBy","applyToPoints","getSourcePoint","sourceCell","getSourceCell","getTargetPoint","targetCell","getTargetCell","getPolyline","reparent","newParent","getSourceElement","getTargetElement","prevParent","getCommonAncestor","hasLoop","sourceId","targetId","loop","sourceElement","targetElement","visited","getRelationshipAncestor","connectionAncestor","isRelationshipEmbeddedIn","ancestor","_getDefaultLabel","endsEqual","portsEqual","PortData","clonedData","groups","portLayoutNamespace","portLabelLayoutNamespace","_init","getPorts","getGroup","getPortsByGroup","groupName","getGroupPortsMetrics","groupPosition","groupPositionName","groupArgs","portsArgs","groupPortTransformations","accumulator","portTransformation","portId","labelTransformation","_getPortLabelLayout","portAttrs","portSize","labelSize","labelPosition","_evaluateGroup","items","_evaluatePort","_getPosition","_getLabel","evaluated","_createPositionNode","_getZIndex","setDefault","positionName","setDefaults","elementPortPrototype","_initializePorts","_createPortData","_processRemovedPort","current","currentItemsMap","previous","removed","hasPorts","hasPort","getPortIndex","getGroupPorts","groupPorts","getPort","getPortsPositions","portsMetrics","_portSettingsData","positions","metrics","transformation","_isValidPortId","addPort","insertPort","index$1","portProp","_validatePorts","portsAttr","errorMessages","generatePortId","addPorts","removePort","removePorts","portsForRemoval","newPorts","this","currentPorts","rp","rpId","err","prevPortData","curPortData","added","prevPort","curPort","elementViewPortPrototype","portContainerMarkup","portMarkup","portLabelMarkup","_portElementsCache","_cleanPortsCache","_refreshPorts","_removePorts","_renderPorts","elementReferences","elem","_getContainerElement","portsGropsByZ","withoutZKey","portElement","_getPortElement","groupNames","_appendPorts","_updatePorts","rotatableNode","refs","containerElement","portElements","_createPortElement","findPortNode","portCache","portRoot","portContentElement","portSelectors","portContentSelectors","_updatePortGroup","groupsNames","labelElement","labelSelectors","portContainerElement","_getPortMarkup","portDoc","portFragment","labelMarkupDef","_getPortLabelMarkup","childCount","portContainerSelectors","portLabelElement","portLabelSelectors","elementBBox","cached","applyPortTransform","updateDOMSubtreeAttributes","rootBBox","transformData","initialAngle","Element$1","isSetter","parentRelative","restrictedArea","parentPosition","elementPosition","newPosition","translatedPosition","currentSize","resize","direction","quadrant","fixedPoint","imageFixedPoint","radius","atan","scaledBBox","fitEmbeds","ref$2","getCellsBBox","attributes_position","attributes_size","endType","endDef","portGroup","portsPositions","portCenter","GraphCells","Collection","models","cellNamespace","ModelClass","dry","Graph","cellModel","_sortOnChangeZ","_out","_in","_nodes","_edges","_batches","_restructureOnAdd","_restructureOnRemove","_restructureOnReset","_restructureOnChangeSource","_restructureOnChangeTarget","_removeCell","prevSource","prevTarget","getOutboundEdges","getInboundEdges","fromJSON","resetCells","clear","_prepareCell","firstCell","lastCell","addCells","maxPosition","preparedCells","reset","removeCells","disconnectLinks","removeLinks","getCells","getElements","getLinks","getFirstCell","getLastCell","indirect","links","edges","addOutbounds","addInbounds","edge","outCell","inCell","embeddedElements","edgeCell","includeEnclosed","getNeighbors","neighbors","cellsAncestors","commonAncestor","cellAncestors","getSuccessors","cloneSubgraph","subgraph","getSubgraph","cellMap","getPredecessors","iteratee","bfs","dfs","neighbor","getSources","sources","getSinks","sinks","isSource","isSink","isSuccessor","elementA","elementB","isPredecessor","isNeighbor","findModelsFromPoint","findModelsInArea","strict","findModelsUnderElement","searchBy","memo","resizeCells","hasActiveBatch","batches","validations","multiLinks","sourceModel","connectedLinks","sameLinks","_link","_source","_target","linkPinning","_graph","views","View","theme","themeClassNamePrefix","requireSetThemeOverride","DETACHABLE","UPDATE_PRIORITY","FLAG_INSERT","FLAG_REMOVE","setTheme","init","unmount","svgElement","renderChildren","isSVG","findAttribute","attributeName","_ensureElement","setElement","_createElement","_setAttributes","_setStyle","_ensureElClassName","_setElement","prefixedClassName","onRender","confirmUpdate","override","removeThemeClassName","addThemeClassName","onSetTheme","oldTheme","newTheme","onRemove","undelegateDocumentEvents","getEventNamespace","delegateElementEvents","events","eventNS","eventName","undelegateElementEvents","off","delegateDocumentEvents","eventData","currentData","stopPropagation","propagationStopped","isPropagationStopped","renderFn","render","__render__","DoubleTapEventName","event","special","maxDelay","minDelay","bindType","delegateType","handle","handleObj","targetData","now","lastTouch","origType","handler","LayersNames","CELLS","BACK","FRONT","TOOLS","LABELS","PaperLayer","pivotNodes","insertSortedNode","insertPivot","insertNode","pivotNode","createComment","neighborZ","currentZ","neighborPivot","removePivots","toArray$1","HighlighterView","HIGHLIGHT_FLAG","UPDATABLE","MOUNTABLE","cellView","updateRequested","transformGroup","requestUpdate","requestViewUpdate","mount","findNode","assign$1","findLabelNode","cellViewRoot","layerName","layer","vGroup","getLayerView","translateMatrix","getRootTranslateMatrix","rotateMatrix","getRootRotateMatrix","transformMatrix","prevNode","unhighlight","notify","_removeRef","_cellView","_views","hid","previousView","_addRef","HighlightingTypes","EMBEDDING","CONNECTING","MAGNET_AVAILABILITY","ELEMENT_AVAILABILITY","CellView","classNames","list","_presentationAttributes","_flags","setFlags","flags","presentationAttributes","initFlag","hasFlag","getFlag","removeFlag","cleanNodesCache","startListening","onMount","listenTo","onAttributesChange","updateHandled","tool","rootSelector","can","interactive","useModelGeometry","getNodeBBox","localToPaperRect","getNodeBoundingRect","magnetMatrix","getNodeMatrix","getNodeUnrotatedBBox","_notifyHighlight","rootNode","partial","embedding","connecting","magnetAvailability","elementAvailability","findMagnet","magnetAttribute","isMagnetRoot","findProxyNode","proxyNode","getSelector","prevSelector","nthChild","addLinkFromMagnet","getDefaultLink","getLinkEnd","ui","customizeLinkEnd","connectionStrategy","strategy","getMagnetFromLinkEnd","dragLinkStart","notifyPointerdown","startArrowheadMove","whenNotAllowed","dragLink","pointermove","magnetThreshold","currentTarget","getEventTarget","targetMagnet","mousemoved","dragLinkEnd","pointerup","setNodeAttributes","processNodeAttributes","attrVal","normalAttrs","setAttrs","positionAttrs","offsetAttrs","relatives","raw","normal","updateRelativeAttributes","rawAttrs","nodeAttrs","setResult","HTMLElement","nodeTransform","nodeMatrix","nodePosition","translation","nodeScale","getNodeScale","scalableNode","positioned","offseted","nodeBoundingRect","nodeCache","getNodeData","boundingRect","getNodeShape","geometryShape","isNodeConnection","findNodesAttributes","selectorCache","nodeId","nodesAttrs","mergeIds","selected","unique","prevNodeAttrs","selectedLength","sortIndex","clientX","clientY","fromPoint","elementFromPoint","bboxCache","relativeItems","relativeRefItems","nodeData","processedAttrs","roAttrs","roAttributes","nodesAllAttrs","nodeAllAttrs","refSelector","refNode","processedAttributes","allAttributes","itemIndex","rotatableMatrix","vRotatable","refNodeId","isRefNodeRotatable","unrotatedRefBBox","transformationTarget","mergeProcessedAttributes","roProcessedAttrs","removeTools","removeHighlighters","_toolsView","hasTools","toolsView","getName","addTools","configure","relatedView","onToolEvent","updateTools","hideTools","hide","showTools","show","updateHighlighters","transformHighlighters","pointerdblclick","pointerclick","contextmenu","pointerdown","mouseover","mouseout","mouseenter","mouseleave","mousewheel","onevent","onmagnet","magnetpointerdblclick","magnetcontextmenu","checkMouseleave","isAsync","dumpView","setInteractivity","Highlighting","addPresentationAttributes","Flags","UPDATE","TRANSLATE","RESIZE","PORTS","ROTATE","RENDER","ElementView","renderingOnlyAttrs","modelAttrs","rotatableSelector","scalableSelector","renderMarkup","renderJSONMarkup","renderStringMarkup","updateTransformation","sgResize","rgTranslate","rgRotate","getTranslateString","rotateString","getRotateString","scalableBBox","rotatableBBox","prepareEmbedding","initialZIndices","maxZ","initialParentId","processEmbedding","findParentBy","frontParentOnly","validateEmbedding","candidates","newCandidateView","prevCandidateView","candidateEmbedView","candidate","clearEmbedding","candidateView","finalizeEmbedding","validateUnembedding","_disallowUnembed","initialPosition","getDelegatedView","proxyPortNode","notifyPointermove","notifyPointerup","dragStart","action","dragMagnet","delegatedView","drag","dragMagnetEnd","dragEnd","magnetpointerclick","dragMagnetStart","pointerOffset","getRestrictedArea","validateMagnet","delegateDragEvents","grid","elX","elY","embeddingMode","clickThreshold","oneSide","sourceBBox","targetBBox","sourcePoint","targetPoint","coordinate","opposites","N","E","W","radians","freeJoin","getBBoxSize","getBearing","to","getPointBox","getPaddingBox","elementPadding","getSourceBBox","getTargetBBox","getSourceAnchor","sourceAnchor","getTargetAnchor","targetAnchor","vertexVertex","d1","d2","opposite","elementVertex","fromBBox","vertexElement","toBBox","route","freePoints","freeBearingPoints","elementElement","fromBorder","toBorder","mid","startRoute","endRoute","insideElement","boundary","reversed","orthogonal","orthogonalVertices","isOrthogonal","isOrthogonalLoop","config$1","maximumLoops","maxAllowedDirectionChange","perpendicular","excludeEnds","excludeTypes","startDirections","endDirections","directionMap","cost","directions","offsetX","offsetY","penalties","paddingBox","isPointObstacle","fallbackRouter","fallbackRoute","draggingRoute","ObstacleMap","mapGridSize","build","excludedEnds","excludedAncestors","isExcludedType","isExcludedEnd","excluded","isExcludedAncestor","isExcluded","gridKey","isPointAccessible","mapKey","obstacle","SortedSet","OPEN","CLOSE","isOpen","isClose","getSourceBBox$1","getTargetBBox$1","getSourceAnchor$1","getTargetAnchor$1","getDirectionAngle","numDirections","angleTheta","fixAngleEnd","normalizedAngle","diffX","diffY","gridStepsX","gridStepsY","distanceX","distanceY","getDirectionChange","angle1","angle2","directionChange","getGridOffsets","gridOffsetX","gridOffsetY","getGrid","getGridDimension","absDiff","numSteps","roundedDiff","remainder","stepCorrection","snapToGrid$1","snappedX","snappedY","round$4","getKey","normalizePoint","reconstructRoute","parents","tailPoint","prevDiff","currentKey","leadPoint","fromDiff","estimateCost","endPoints","getRectPoints","anchor","directionList","anchorCenterVector","dirList","rectPoints","endpoint","intersectionLine","farthestIntersectionDistance","farthestIntersection","currentIntersection","findRoute","startPoints","openSet","costs","previousRouteDirectionAngle","previousDirectionAngle","isPathBeginning","endPointsKeys","endPoint","loopsRemaining","currentParent","currentCost","isRouteBeginning","isStart","samePoints","skipEndCheck","directionAngle","neighborPoint","neighborKey","isNeighborEnd","endDirectionAngle","endDirectionChange","neighborCost","neighborPenalty","costFromStart","resolveOptions","point1","point2","oldVertices","newVertices","partialRoute","isEndingAtPoint","dragFrom","dragTo","manhattan","config$2","diagonalCost","intersectionPoint","directionFrom","metro","routers","JUMP_SIZE","JUMP_TYPES","RADIUS","CLOSE_PROXIMITY_PADDING","IGNORED_CONNECTORS","createLines","resultLines","nextPoint","setupUpdating","jumpOverLinkView","updateList","_jumpOverUpdateList","updateJumpOver","listenToOnce","updateFlag","CONNECTOR","findLineIntersections","crossCheckLines","crossCheckLine","sortPoints","createJumps","jumpSize","point$1","skip","jumpStart","jumpEnd","endDistance","startDistance","jumpLine","isJump","buildPath","jumpType","xAxisRotate","centerLine","halfLine","xOffset","yOffset","nextLine","buildRoundedSegment","curr","prevDistance","nextDistance","startMove","endMove","roundedStart","roundedEnd","jumpover","jump","ignoreConnectors","allLinks","thisModel","thisIndex","defaultConnector","linkViews","thisLines","linkLines","jumpingLines","thisLine","lineIntersections","normal$1","rounded","smooth","controlPointX","controlPointY","Directions","AUTO","HORIZONTAL","VERTICAL","CLOSEST_POINT","OUTWARDS","TangentDirections","UP","DOWN","LEFT","RIGHT","Boolean","coeff","distanceCoefficient","angleTangentCoefficient","tau","tension","sourceTangent","targetTangent","sourceDirection","targetDirection","completeRoute","getSourceTangentDirection","tangentLength","pointsVector","angleBetweenVectors","updatedLength","getTargetTangentDirection","tangentLength$1","pointsVector$1","angle$1","updatedLength$1","catmullRomCurves","createCatmullRomCurves","bezierCurves","catmullRomToBezier","getHorizontalSourceDirection","sourceSide","getHorizontalTargetDirection","targetSide","getVerticalSourceDirection","getVerticalTargetDirection","getAutoSourceDirection","getAutoTargetDirection","getClosestPointSourceDirection","getClosestPointTargetDirection","getOutwardsSourceDirection","sourceCenter","getOutwardsTargetDirection","targetCenter","rotateVector","v1","v2","acos","distances","tangents","i$1","tpPrev","tpNext","vAngle","rot","vectorDeterminant","pointsDeterminant","scaleFactor1","scaleFactor2","i$2","bcp1","bcp2","connectors","Flags$1","LEGACY_TOOLS","VERTICES","SOURCE","LinkView","shortLinkLength","doubleLinkTools","longLinkLength","linkToolsOffset","doubleLinkToolsOffset","sampleInterval","_labelCache","_labelSelectors","_markerCache","_V","_dragData","decimalsRounding","updateEndProperties","sourceView","targetView","isViewMounted","renderVertexMarkers","updateLabels","updateLegacyTools","onLabelsChange","renderTools","updateAll","updateConnector","updatePath","updateDOM","updateLabelPositions","updateToolsPosition","requestConnectionUpdate","isLabelsRenderRequired","previousLabels","labelExists","_labels","renderLabels","unmountLabels","renderArrowheadMarkers","_getLabelMarkup","_getLabelStringMarkup","_normalizeLabelMarkup","DocumentFragment","hasChildNodes","vNode","vLabels","labelCache","labelsCount","labelsLayer","labelNode","builtinDefaultLabel","builtinDefaultLabelMarkup","defaultLabelMarkup","defaultMarkup","mountLabels","labelIndex","labelRoot","_mergeLabelAttrs","hasCustomMarkup","labelAttrs","defaultLabelAttrs","builtinDefaultLabelAttrs","canLabelMove","linkTools","$tools","toolTemplate","_toolCache","tool2","_tool2Cache","markerVertices","$markerVertices","markupTemplate","markerArrowheads","$markerArrowheads","sourceArrowhead","targetArrowhead","removeRedundantLinearVertices","SIMPLIFY_THRESHOLD","routePoints","numRoutePoints","polylinePoints","numPolylinePoints","updateDefaultConnectionPath","connectionWrap","markerSource","markerTarget","_translateAndAutoOrientArrows","getEndView","getEndAnchor","getEndConnectionPoint","getEndMagnet","sourceMagnet","updateRoute","_translateConnectionPoints","updateArrowheadMarkers","anchors","findAnchors","connectionPoints","findConnectionPoints","markerPoints","findMarkerPoints","findPath","firstWaypoint","lastWaypoint","sourceMarkerPoint","targetMarkerPoint","findAnchorsOrdered","firstEndType","firstRef","secondEndType","secondRef","firstAnchor","secondAnchor","firstAnchorRef","secondAnchorRef","firstDef","secondDef","firstView","secondView","firstMagnet","secondMagnet","getAnchor","firstVertex","lastVertex","priority","sourceDef","targetDef","paperOptions","sourceConnectionPointDef","connectionPoint","defaultConnectionPoint","sourcePointRef","sourceLine","getConnectionPoint","targetConnectionPointDef","targetPointRef","targetLine","anchorDef","isConnection","defaultLinkAnchor","perpendicularLinks","defaultAnchor","anchorFn","anchorName","anchorNamespace","connectionPointDef","linkConnectionPoint","linkConnectionMagnet","connectionPointFn","connectionPointName","connectionPointNamespace","_normalizeLabelPosition","builtinDefaultLabelPosition","defaultLabelPosition","defaultPosition","_getLabelTransformationMatrix","_cleanLabelMatrices","connectionLength","toolPosition","endViewProperty","endId","updateEndMagnet","endModel","getModelById","endView","endMagnetProperty","connectedMagnet","sourceArrow","targetArrow","_getLabelPositionAngle","_getLabelPositionArgs","_getDefaultLabelPositionArgs","_mergeLabelPositionArgs","labelPositionArgs","defaultLabelPositionArgs","addLabel","localX","localY","localAngle","positionArgs","getLabelPosition","addVertex","getVertexIndex","sendToken","token","onAnimationEnd","vToken","isReversed","animationAttributes","dur","repeatCount","calcMode","keyPoints","keyTimes","routerNamespace","defaultRouter","routerFn","connectorNamespace","connectorFn","getConnectionSubdivisions","getPointAtRatio","getTangentAtLength","getTangentAtRatio","getClosestPoint","getClosestPointLength","getClosestPointRatio","isDistanceRelative","absoluteDistance","isDistanceAbsoluteReverse","reverseDistance","isOffsetAbsolute","absoluteOffset","labelPoint","labelDistance","labelOffset","labelOffsetDiff","labelAngle","labelOffsetCoordinates","positionOffset","isKeepGradient","keepGradient","isEnsureLegibility","ensureLegibility","getLabelCoordinates","vertexLength","currentVertex","currentVertexLength","dragVertexStart","dragVertexRemoveStart","dragArrowheadStart","dragConnectionStart","dragData","dragVertex","dragLabel","dragArrowhead","dragVertexEnd","dragLabelEnd","dragArrowheadEnd","linkTool","onlabel","dragLabelStart","vertexIdx","_x","_y","labelIdx","positionAngle","vertexNode","removeNode","arrowheadNode","arrowheadType","ignoreBackwardsCompatibility","snapLabels","snapLinks","_snapArrowhead","_connectArrowhead","_snapArrowheadEnd","_connectArrowheadEnd","linkAllowed","_disallow","_finishEmbedding","_notifyConnectEvent","_afterArrowheadMove","arrowhead","initialEnd","currentEnd","endChanged","initialMagnet","magnetUnderPointer","viewsInArea","findViewsInArea","prevClosestView","closestView","prevClosestMagnet","closestMagnet","prevMagnetProxy","magnetProxy","MAX_VALUE","pointer","isAlreadyValidated","validateConnection","validateConnectionArgs","newClosestMagnet","snapping","prevEnd","prevX","prevY","eventTarget","viewUnderPointer","_beforeArrowheadMove","markAvailable","_markAvailableMagnets","_unmarkAvailableMagnets","_createValidateConnectionArgs","oppositeArrowhead","isMagnetAvailable","marked","magnets","availableMagnets","markedKeys","markedMagnets","useFirstSubpath","getPathData","secondSubpathIndex","highlightConnection","highlightNode","highlightMatrix","paddingMatrix","MASK_CLIP","forEachDescendant","descendants","descendant","mask","maskClip","VISIBLE","INVISIBLE","MASK_ROOT_ATTRIBUTE_BLACKLIST","MASK_CHILD_ATTRIBUTE_BLACKLIST","MASK_REPLACE_TAGS","MASK_REMOVE_TAGS","transformMaskChild","childEl","childTagName","originalChild","originalNode","transformMaskRoot","rootEl","getMaskShape","maskRoot","maskChild","getMaskId","getMask","strokeWidth","hasNodeFill","magnetStrokeWidth","minStrokeWidth","maxStrokeWidth","maskEl","removeMask","maskNode","getElementById","addMask","highlighterBBox","opacityClassName","highlighters","connectionRatio","_magnet","_refPoint","_connectionPerpendicular","refPoint","OFFSET","verticalLine","horizontalLine","verticalIntersections","horizontalIntersections","getPointAtLink","fallbackAt","connectionClosest","_connectionClosest","_opt","resolveRef","Element","refView","fixedAt","parsedValue","connectionPerpendicular","linkAnchors","offsetPoint","stroke$1","alignLine","anchorConnectionPoint","_view","alignOffset","bboxIntersection","rectangleIntersection","bboxWORotation","lineWORotation","findShapeNode","firstElementChild","nextElementSibling","BNDR_SUBDIVISIONS","BNDR_SHAPE_BBOX","boundaryIntersection","localShape","targetMatrix","localMatrix","localLine","localRef","insideout","localBBox","extrapolate","sticky","cpOffset","rectangle","bboxWrapper","dxPercentage","dyPercentage","_perpendicular","_midSide","_modelCenter","top$2","bottom$2","left$2","right$2","midSide","modelCenter","sortingTypes","NONE","APPROX","EXACT","MOUNT_BATCH_SIZE","UPDATE_BATCH_SIZE","MIN_PRIORITY","HighlightingTypes$1","defaultHighlighting","defaultLayers","Paper","drawGrid","background","elementView","guard","highlighting","preventContextMenu","preventDefaultBlankAction","restrictTranslate","defaultLink","_evt","cellViewS","_magnetS","cellViewT","_magnetT","_linkView","childView","parentView","labelMove","allowLink","moveThreshold","sorting","frozen","onViewUpdate","mounting","isolate","requestConnectedLinksUpdate","onViewPostponed","forcePostponedViewUpdate","beforeRender","afterRender","viewport","cellViewNamespace","highlighterNamespace","linkAnchorNamespace","documentEvents","tools","$background","layers","$grid","$document","_viewportMatrix","_viewportTransformString","_updates","_layers","SORT_DELAYING_BATCHES","UPDATE_DELAYING_BATCHES","MIN_SCALE","setGrid","cloneOptions","_setDimensions","resetViews","isFrozen","updateViewsAsync","_resetUpdates","priorities","unmountedCids","mountedCids","unmounted","mounted","keyFrozen","freezeKey","onCellAdded","onCellRemoved","onCellChange","onGraphReset","onGraphSort","onGraphBatchStop","onCellHighlight","onCellUnhighlight","renderView","freeze","unfreeze","resetLayers","sortViews","updateDelayingBatches","updateViews","sortDelayingBatches","hasLayerView","getLayerNode","renderLayers","drawBackground","removeLayers","sorted","layerView","cellsLayerView","toolsLayerView","labelsLayerView","_background","updateBackgroundImage","transformString","getCTM","ctmString","clientMatrix","flagLabels","nextPriority","scheduleViewUpdate","sourceFlag","targetFlag","stats","notifyAfterRender","updates","priorityUpdates","prevPriorityUpdates","currentType","viewUpdateFn","dumpViewUpdate","registerMountedView","updateView","removeView","insertView","requireView","registerUnmountedView","dumpViews","passingOpt","checkViewport","notifyBeforeRender","batchStats","updateCount","batchCount","updateViewsBatch","updated","hasScheduledUpdates","priorityIndexes","_key","processed","mountBatchSize","unmountBatchSize","checkStats","unmountCount","mountCount","total","progressFn","beforeFn","afterFn","batchSize","postponeCount","maxPriority","viewportFn","postponeViewFn","main","currentFlag","isDetached","leftoverFlag","postponed","getUnmountedViews","unmountedViews","getMountedViews","mountedViews","checkUnmountedViews","checkMountedViews","unmountedCount","mountedCount","isExactSorting","removeViews","getComputedSize","setDimensions","currentWidth","currentHeight","computedSize","setOrigin","fitToContent","gridWidth","gridHeight","getFitToContentArea","minWidth","minHeight","maxWidth","maxHeight","allowNewOrigin","area","contentArea","getContentArea","calcWidth","calcHeight","allowNegativeBottomRight","scaleContentToFit","contentBBox","contentLocalOrigin","getContentBBox","paperToLocalPoint","scaleGrid","minScale","maxScale","minScaleX","maxScaleX","minScaleY","maxScaleY","fittingBBox","currentTranslate","currentScale","newSx","newSy","newOx","newOy","getArea","paperToLocalRect","createViewForModel","optionalViewClass","defaultViewClass","namespaceViewClass","ViewClass","onImageDragStart","sortViewsExact","$cells","cellA","cellB","zA","zB","findViewsFromPoint","dispatchToolsEvent","clientToLocalPoint","localToPaperPoint","localPoint","paperPoint","localRect","paperRect","localToClientPoint","clientPoint","localToClientRect","clientRect","clientToLocalRect","localToPagePoint","pageOffset","localToPageRect","pageToLocalPoint","pagePoint","pageToLocalRect","clientOffset","scrollX","scrollY","resolveHighlighter","highlighterDef","highlighter","magnetEl","highlighterDescriptor","preventDefault","normalizedEvt","Event","stopImmediatePropagation","delegateEvents","relatedTarget","wheelDelta","eventNode","magnetEvent","magnetNode","magnetValue","getPointerArgs","undelegateEvents","button","guarded","setGridSize","clearGrid","_getGridRefs","_gridCache","patterns","exist","_gridSettings","optionsList","_resolveDrawGridOption","gridPatterns","pattern","localOptions","gridLayerSetting","patternUnits","patternDefVel","patternUri","XMLSerializer","serializeToString","backgroundPosition","backgroundSize","drawBackgroundImage","img","HTMLImageElement","backgroundImage","backgroundRepeat","repeat","backgroundOpacity","backgroundQuality","quality","backgroundPattern","backgroundPatterns","canvas","HTMLCanvasElement","toDataURL","updateBackgroundColor","image","isDefined","defId","filter$1","filterId","filterSVGString","filterAttrs","filterUnits","gradient","stops","stopVEls","gradientVEl","patternVEl","markerUnits","markerVEl","orient","overflow","markerContentVEl","Layers","flipXy","imgWidth","imgHeight","ctx","getContext","drawImage","setTransform","flipX","flipY","watermark","watermarkAngle","stepX","stepY","thickness","fixedDot","mesh","doubleMesh","ToolView","_visible","simulateRelatedView","focus","focusOpacity","focusTool","blurTool","ToolsView","isRendered","focusedTool","blurredTool","index$2","DirectedGraph","exportElement","exportLink","minLen","weight","labelpos","labeloffset","importElement","gl","glNode","setPosition","importLink","edgeObj","glEdge","setLinkVertices","setLabels","layout","graphOrCells","resizeClusters","clusterPadding","dagreUtil","dagre","glGraph","toGraphLib","graphlib","directed","multigraph","compound","setNodeLabel","setEdgeLabel","setEdgeName","glLabel","marginX","marginY","rankDir","rankdir","nodeSep","nodesep","edgeSep","edgesep","rankSep","ranksep","ranker","marginx","marginy","setGraph","debugTiming","fromGraphLib","importEdge","clusters","aCluster","bCluster","glSize","graphlibUtil","glGraphType","at","setEdge","setNode","isCompound","setParent","env","_results","_tests","svgforeignobject","addTest","Generic","Rect$1","TextView","Text","Circle","Ellipse$1","Polygon$1","Polyline$1","Image","Path$1","Rhombus","svgForeignObjectSupported","TextBlock","updateSize","updateContent","div","setForeignObjectSize","setDivContent","TextBlockView","noTextAttrs","basic","Rectangle","Circle$1","Ellipse$2","Path$2","Polygon$2","Polyline$2","Image$1","BorderedImage","border","EmbeddedImage","InscribedImage","HeaderedRectangle","header","headerText","bodyText","CYLINDER_TILT","Cylinder","lateralArea","isPercentageSetter","bodyAttrs","topAttrs","kappa","xLeft","xCenter","xRight","ySideTop","yCurveTop","ySideBottom","yCurveBottom","foLabelMarkup","backgroundColor","textAlign","boxSizing","alignItems","justifyContent","svgLabelMarkup","TextBlock$1","foreignObject","wrapValue","wrapAttrs","Link$1","strokeLinejoin","DoubleLink","ShadowLink","shadow","standard","inPorts","outPorts","updatePortItems","inPortItems","createPortItems","outPortItems","createPortItem","_addGroupPort","addOutPort","addInPort","_removeGroupPort","removeOutPort","removeInPort","_changeGroup","properties","changeInGroup","changeOutGroup","Atomic","Coupled","Link$2","devs","Gate","operation","IO","Input","Output","Gate11","Gate21","Repeater","Not","Or","input1","input2","And","Nor","Nand","Xor","Xnor","Wire","logic","KingWhite","KingBlack","QueenWhite","QueenBlack","RookWhite","RookBlack","BishopWhite","BishopBlack","KnightWhite","KnightBlack","PawnWhite","PawnBlack","chess","Entity","WeakEntity","Relationship","IdentifyingRelationship","Attribute","Multivalued","Derived","Key","Normal","ISA","Line$1","cardinality","erd","State","StartState","EndState","Arrow","fsa","Member","Arrow$1","org","Place","PlaceView","tokens","renderTokens","vTokens","Transition","Link$3","pn","Class","updateRectangles","getClassName","rectHeight","ClassView","Abstract","AbstractView","Interface","InterfaceView","Generalization","Implementation","Aggregation","Composition","Association","State$1","updateName","updateEvents","StartState$1","EndState$1","Transition$1","uml","index$3","abs2rel","dp","relative","pin","pinnedLinkEnd","pinnedElementEnd","totalLength","useDefaults","pinAbsolute","pinRelative","index$4","snapAnchor","toolView","snapRadius","refIndex","getViewBBox","VertexHandle","mousedown","touchstart","dblclick","dbltap","mousemove","touchmove","mouseup","touchend","touchcancel","onPointerDown","onPointerMove","onDoubleClick","onPointerUp","Vertices","handleClass","redundancyRemoval","vertexAdding","handles","resetHandles","renderHandles","updateHandles","stopListening","startHandleListening","onHandleWillChange","onHandleChanging","onHandleChanged","onHandleRemove","getNeighborPoints","_handle","snapVertex","verticesRemoved","vertexAdded","onPathPointerDown","SegmentHandle","viewPoint","Segments","segmentLengthThreshold","snapHandle","nextVertex","renderHandle","updateHandle","onHandleChangeStart","onHandleChangeEnd","shiftHandleIndexes","resetAnchor","relatedModel","changeSourceAnchor","deleteSourceAnchor","sourceAnchorPosition","sourceAnchorDef","changeTargetAnchor","deleteTargetAnchor","targetAnchorPosition","targetAnchorDef","segmentLine","Arrowhead","xAxisVector","TargetArrowhead","SourceArrowhead","Button","getLinkMatrix","getElementMatrix","actionFn","Remove","Connect","dragstart","getMagnetNode","dragend","Boundary","Anchor","snap","customAnchorAttributes","defaultAnchorAttributes","areaPadding","restrictArea","toggleArea","updateAnchor","updateArea","anchorNode","customAnchor","anchorAttributes","areaNode","visible","snapFn","pointAtConnection","rotatedCoords","onPointerDblClick","SourceAnchor","TargetAnchor","index$5","Control","handleAttributes","getPosition","resetPosition","toggleExtras","extras","updateExtras","handleNode","relativePos","absolutePos","extrasNode","relativeCoords","index$6","Vectorizer","layout$1","format$1","connectionStrategies","dia","elementTools","mvc","util"],"sources":["C:/Users/Admin/dataflow-test/node_modules/jointjs/dist/joint.js"],"sourcesContent":["/*! JointJS v3.5.5 (2022-04-08) - JavaScript diagramming library\n\n\nThis Source Code Form is subject to the terms of the Mozilla Public\nLicense, v. 2.0. If a copy of the MPL was not distributed with this\nfile, You can obtain one at http://mozilla.org/MPL/2.0/.\n*/\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('backbone'), require('lodash'), require('jquery')) :\n\ttypeof define === 'function' && define.amd ? define(['exports', 'backbone', 'lodash', 'jquery'], factory) :\n\t(global = global || self, factory(global.joint = {}, global.Backbone, global._, global.$));\n}(this, function (exports, Backbone, _, $) { 'use strict';\n\n\tBackbone = Backbone && Backbone.hasOwnProperty('default') ? Backbone['default'] : Backbone;\n\t_ = _ && _.hasOwnProperty('default') ? _['default'] : _;\n\t$ = $ && $.hasOwnProperty('default') ? $['default'] : $;\n\n\tvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\tfunction commonjsRequire () {\n\t\tthrow new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n\t}\n\n\tfunction unwrapExports (x) {\n\t\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x.default : x;\n\t}\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tfunction getCjsExportFromNamespace (n) {\n\t\treturn n && n.default || n;\n\t}\n\n\tvar check = function (it) {\n\t  return it && it.Math == Math && it;\n\t};\n\n\t// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\n\tvar global_1 =\n\t  // eslint-disable-next-line no-undef\n\t  check(typeof globalThis == 'object' && globalThis) ||\n\t  check(typeof window == 'object' && window) ||\n\t  check(typeof self == 'object' && self) ||\n\t  check(typeof commonjsGlobal == 'object' && commonjsGlobal) ||\n\t  // eslint-disable-next-line no-new-func\n\t  (function () { return this; })() || Function('return this')();\n\n\tvar fails = function (exec) {\n\t  try {\n\t    return !!exec();\n\t  } catch (error) {\n\t    return true;\n\t  }\n\t};\n\n\t// Detect IE8's incomplete defineProperty implementation\n\tvar descriptors = !fails(function () {\n\t  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n\t});\n\n\t'use strict';\n\tvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\n\tvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n\t// Nashorn ~ JDK8 bug\n\tvar NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\n\t// `Object.prototype.propertyIsEnumerable` method implementation\n\t// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\n\tvar f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n\t  var descriptor = getOwnPropertyDescriptor(this, V);\n\t  return !!descriptor && descriptor.enumerable;\n\t} : nativePropertyIsEnumerable;\n\n\tvar objectPropertyIsEnumerable = {\n\t\tf: f\n\t};\n\n\tvar createPropertyDescriptor = function (bitmap, value) {\n\t  return {\n\t    enumerable: !(bitmap & 1),\n\t    configurable: !(bitmap & 2),\n\t    writable: !(bitmap & 4),\n\t    value: value\n\t  };\n\t};\n\n\tvar toString = {}.toString;\n\n\tvar classofRaw = function (it) {\n\t  return toString.call(it).slice(8, -1);\n\t};\n\n\tvar split = ''.split;\n\n\t// fallback for non-array-like ES3 and non-enumerable old V8 strings\n\tvar indexedObject = fails(function () {\n\t  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n\t  // eslint-disable-next-line no-prototype-builtins\n\t  return !Object('z').propertyIsEnumerable(0);\n\t}) ? function (it) {\n\t  return classofRaw(it) == 'String' ? split.call(it, '') : Object(it);\n\t} : Object;\n\n\t// `RequireObjectCoercible` abstract operation\n\t// https://tc39.es/ecma262/#sec-requireobjectcoercible\n\tvar requireObjectCoercible = function (it) {\n\t  if (it == undefined) { throw TypeError(\"Can't call method on \" + it); }\n\t  return it;\n\t};\n\n\t// toObject with fallback for non-array-like ES3 strings\n\n\n\n\tvar toIndexedObject = function (it) {\n\t  return indexedObject(requireObjectCoercible(it));\n\t};\n\n\tvar isObject = function (it) {\n\t  return typeof it === 'object' ? it !== null : typeof it === 'function';\n\t};\n\n\t// `ToPrimitive` abstract operation\n\t// https://tc39.es/ecma262/#sec-toprimitive\n\t// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n\t// and the second argument - flag - preferred type is a string\n\tvar toPrimitive = function (input, PREFERRED_STRING) {\n\t  if (!isObject(input)) { return input; }\n\t  var fn, val;\n\t  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) { return val; }\n\t  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) { return val; }\n\t  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) { return val; }\n\t  throw TypeError(\"Can't convert object to primitive value\");\n\t};\n\n\tvar hasOwnProperty = {}.hasOwnProperty;\n\n\tvar has = function (it, key) {\n\t  return hasOwnProperty.call(it, key);\n\t};\n\n\tvar document$1 = global_1.document;\n\t// typeof document.createElement is 'object' in old IE\n\tvar EXISTS = isObject(document$1) && isObject(document$1.createElement);\n\n\tvar documentCreateElement = function (it) {\n\t  return EXISTS ? document$1.createElement(it) : {};\n\t};\n\n\t// Thank's IE8 for his funny defineProperty\n\tvar ie8DomDefine = !descriptors && !fails(function () {\n\t  return Object.defineProperty(documentCreateElement('div'), 'a', {\n\t    get: function () { return 7; }\n\t  }).a != 7;\n\t});\n\n\tvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n\t// `Object.getOwnPropertyDescriptor` method\n\t// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\n\tvar f$1 = descriptors ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n\t  O = toIndexedObject(O);\n\t  P = toPrimitive(P, true);\n\t  if (ie8DomDefine) { try {\n\t    return nativeGetOwnPropertyDescriptor(O, P);\n\t  } catch (error) { /* empty */ } }\n\t  if (has(O, P)) { return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(O, P), O[P]); }\n\t};\n\n\tvar objectGetOwnPropertyDescriptor = {\n\t\tf: f$1\n\t};\n\n\tvar anObject = function (it) {\n\t  if (!isObject(it)) {\n\t    throw TypeError(String(it) + ' is not an object');\n\t  } return it;\n\t};\n\n\tvar nativeDefineProperty = Object.defineProperty;\n\n\t// `Object.defineProperty` method\n\t// https://tc39.es/ecma262/#sec-object.defineproperty\n\tvar f$2 = descriptors ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n\t  anObject(O);\n\t  P = toPrimitive(P, true);\n\t  anObject(Attributes);\n\t  if (ie8DomDefine) { try {\n\t    return nativeDefineProperty(O, P, Attributes);\n\t  } catch (error) { /* empty */ } }\n\t  if ('get' in Attributes || 'set' in Attributes) { throw TypeError('Accessors not supported'); }\n\t  if ('value' in Attributes) { O[P] = Attributes.value; }\n\t  return O;\n\t};\n\n\tvar objectDefineProperty = {\n\t\tf: f$2\n\t};\n\n\tvar createNonEnumerableProperty = descriptors ? function (object, key, value) {\n\t  return objectDefineProperty.f(object, key, createPropertyDescriptor(1, value));\n\t} : function (object, key, value) {\n\t  object[key] = value;\n\t  return object;\n\t};\n\n\tvar setGlobal = function (key, value) {\n\t  try {\n\t    createNonEnumerableProperty(global_1, key, value);\n\t  } catch (error) {\n\t    global_1[key] = value;\n\t  } return value;\n\t};\n\n\tvar SHARED = '__core-js_shared__';\n\tvar store = global_1[SHARED] || setGlobal(SHARED, {});\n\n\tvar sharedStore = store;\n\n\tvar functionToString = Function.toString;\n\n\t// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\n\tif (typeof sharedStore.inspectSource != 'function') {\n\t  sharedStore.inspectSource = function (it) {\n\t    return functionToString.call(it);\n\t  };\n\t}\n\n\tvar inspectSource = sharedStore.inspectSource;\n\n\tvar WeakMap = global_1.WeakMap;\n\n\tvar nativeWeakMap = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));\n\n\tvar isPure = false;\n\n\tvar shared = createCommonjsModule(function (module) {\n\t(module.exports = function (key, value) {\n\t  return sharedStore[key] || (sharedStore[key] = value !== undefined ? value : {});\n\t})('versions', []).push({\n\t  version: '3.8.3',\n\t  mode: isPure ? 'pure' : 'global',\n\t  copyright: 'Â© 2021 Denis Pushkarev (zloirock.ru)'\n\t});\n\t});\n\n\tvar id = 0;\n\tvar postfix = Math.random();\n\n\tvar uid = function (key) {\n\t  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n\t};\n\n\tvar keys = shared('keys');\n\n\tvar sharedKey = function (key) {\n\t  return keys[key] || (keys[key] = uid(key));\n\t};\n\n\tvar hiddenKeys = {};\n\n\tvar WeakMap$1 = global_1.WeakMap;\n\tvar set, get, has$1;\n\n\tvar enforce = function (it) {\n\t  return has$1(it) ? get(it) : set(it, {});\n\t};\n\n\tvar getterFor = function (TYPE) {\n\t  return function (it) {\n\t    var state;\n\t    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n\t      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n\t    } return state;\n\t  };\n\t};\n\n\tif (nativeWeakMap) {\n\t  var store$1 = sharedStore.state || (sharedStore.state = new WeakMap$1());\n\t  var wmget = store$1.get;\n\t  var wmhas = store$1.has;\n\t  var wmset = store$1.set;\n\t  set = function (it, metadata) {\n\t    metadata.facade = it;\n\t    wmset.call(store$1, it, metadata);\n\t    return metadata;\n\t  };\n\t  get = function (it) {\n\t    return wmget.call(store$1, it) || {};\n\t  };\n\t  has$1 = function (it) {\n\t    return wmhas.call(store$1, it);\n\t  };\n\t} else {\n\t  var STATE = sharedKey('state');\n\t  hiddenKeys[STATE] = true;\n\t  set = function (it, metadata) {\n\t    metadata.facade = it;\n\t    createNonEnumerableProperty(it, STATE, metadata);\n\t    return metadata;\n\t  };\n\t  get = function (it) {\n\t    return has(it, STATE) ? it[STATE] : {};\n\t  };\n\t  has$1 = function (it) {\n\t    return has(it, STATE);\n\t  };\n\t}\n\n\tvar internalState = {\n\t  set: set,\n\t  get: get,\n\t  has: has$1,\n\t  enforce: enforce,\n\t  getterFor: getterFor\n\t};\n\tvar internalState_1 = internalState.set;\n\tvar internalState_2 = internalState.get;\n\tvar internalState_3 = internalState.has;\n\tvar internalState_4 = internalState.enforce;\n\tvar internalState_5 = internalState.getterFor;\n\n\tvar redefine = createCommonjsModule(function (module) {\n\tvar getInternalState = internalState.get;\n\tvar enforceInternalState = internalState.enforce;\n\tvar TEMPLATE = String(String).split('String');\n\n\t(module.exports = function (O, key, value, options) {\n\t  var unsafe = options ? !!options.unsafe : false;\n\t  var simple = options ? !!options.enumerable : false;\n\t  var noTargetGet = options ? !!options.noTargetGet : false;\n\t  var state;\n\t  if (typeof value == 'function') {\n\t    if (typeof key == 'string' && !has(value, 'name')) {\n\t      createNonEnumerableProperty(value, 'name', key);\n\t    }\n\t    state = enforceInternalState(value);\n\t    if (!state.source) {\n\t      state.source = TEMPLATE.join(typeof key == 'string' ? key : '');\n\t    }\n\t  }\n\t  if (O === global_1) {\n\t    if (simple) { O[key] = value; }\n\t    else { setGlobal(key, value); }\n\t    return;\n\t  } else if (!unsafe) {\n\t    delete O[key];\n\t  } else if (!noTargetGet && O[key]) {\n\t    simple = true;\n\t  }\n\t  if (simple) { O[key] = value; }\n\t  else { createNonEnumerableProperty(O, key, value); }\n\t// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n\t})(Function.prototype, 'toString', function toString() {\n\t  return typeof this == 'function' && getInternalState(this).source || inspectSource(this);\n\t});\n\t});\n\n\tvar path = global_1;\n\n\tvar aFunction = function (variable) {\n\t  return typeof variable == 'function' ? variable : undefined;\n\t};\n\n\tvar getBuiltIn = function (namespace, method) {\n\t  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global_1[namespace])\n\t    : path[namespace] && path[namespace][method] || global_1[namespace] && global_1[namespace][method];\n\t};\n\n\tvar ceil = Math.ceil;\n\tvar floor = Math.floor;\n\n\t// `ToInteger` abstract operation\n\t// https://tc39.es/ecma262/#sec-tointeger\n\tvar toInteger = function (argument) {\n\t  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n\t};\n\n\tvar min = Math.min;\n\n\t// `ToLength` abstract operation\n\t// https://tc39.es/ecma262/#sec-tolength\n\tvar toLength = function (argument) {\n\t  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n\t};\n\n\tvar max = Math.max;\n\tvar min$1 = Math.min;\n\n\t// Helper for a popular repeating case of the spec:\n\t// Let integer be ? ToInteger(index).\n\t// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\n\tvar toAbsoluteIndex = function (index, length) {\n\t  var integer = toInteger(index);\n\t  return integer < 0 ? max(integer + length, 0) : min$1(integer, length);\n\t};\n\n\t// `Array.prototype.{ indexOf, includes }` methods implementation\n\tvar createMethod = function (IS_INCLUDES) {\n\t  return function ($this, el, fromIndex) {\n\t    var O = toIndexedObject($this);\n\t    var length = toLength(O.length);\n\t    var index = toAbsoluteIndex(fromIndex, length);\n\t    var value;\n\t    // Array#includes uses SameValueZero equality algorithm\n\t    // eslint-disable-next-line no-self-compare\n\t    if (IS_INCLUDES && el != el) { while (length > index) {\n\t      value = O[index++];\n\t      // eslint-disable-next-line no-self-compare\n\t      if (value != value) { return true; }\n\t    // Array#indexOf ignores holes, Array#includes - not\n\t    } } else { for (;length > index; index++) {\n\t      if ((IS_INCLUDES || index in O) && O[index] === el) { return IS_INCLUDES || index || 0; }\n\t    } } return !IS_INCLUDES && -1;\n\t  };\n\t};\n\n\tvar arrayIncludes = {\n\t  // `Array.prototype.includes` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.includes\n\t  includes: createMethod(true),\n\t  // `Array.prototype.indexOf` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n\t  indexOf: createMethod(false)\n\t};\n\tvar arrayIncludes_1 = arrayIncludes.includes;\n\tvar arrayIncludes_2 = arrayIncludes.indexOf;\n\n\tvar indexOf = arrayIncludes.indexOf;\n\n\n\tvar objectKeysInternal = function (object, names) {\n\t  var O = toIndexedObject(object);\n\t  var i = 0;\n\t  var result = [];\n\t  var key;\n\t  for (key in O) { !has(hiddenKeys, key) && has(O, key) && result.push(key); }\n\t  // Don't enum bug & hidden keys\n\t  while (names.length > i) { if (has(O, key = names[i++])) {\n\t    ~indexOf(result, key) || result.push(key);\n\t  } }\n\t  return result;\n\t};\n\n\t// IE8- don't enum bug keys\n\tvar enumBugKeys = [\n\t  'constructor',\n\t  'hasOwnProperty',\n\t  'isPrototypeOf',\n\t  'propertyIsEnumerable',\n\t  'toLocaleString',\n\t  'toString',\n\t  'valueOf'\n\t];\n\n\tvar hiddenKeys$1 = enumBugKeys.concat('length', 'prototype');\n\n\t// `Object.getOwnPropertyNames` method\n\t// https://tc39.es/ecma262/#sec-object.getownpropertynames\n\tvar f$3 = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n\t  return objectKeysInternal(O, hiddenKeys$1);\n\t};\n\n\tvar objectGetOwnPropertyNames = {\n\t\tf: f$3\n\t};\n\n\tvar f$4 = Object.getOwnPropertySymbols;\n\n\tvar objectGetOwnPropertySymbols = {\n\t\tf: f$4\n\t};\n\n\t// all object keys, includes non-enumerable and symbols\n\tvar ownKeys = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n\t  var keys = objectGetOwnPropertyNames.f(anObject(it));\n\t  var getOwnPropertySymbols = objectGetOwnPropertySymbols.f;\n\t  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n\t};\n\n\tvar copyConstructorProperties = function (target, source) {\n\t  var keys = ownKeys(source);\n\t  var defineProperty = objectDefineProperty.f;\n\t  var getOwnPropertyDescriptor = objectGetOwnPropertyDescriptor.f;\n\t  for (var i = 0; i < keys.length; i++) {\n\t    var key = keys[i];\n\t    if (!has(target, key)) { defineProperty(target, key, getOwnPropertyDescriptor(source, key)); }\n\t  }\n\t};\n\n\tvar replacement = /#|\\.prototype\\./;\n\n\tvar isForced = function (feature, detection) {\n\t  var value = data[normalize(feature)];\n\t  return value == POLYFILL ? true\n\t    : value == NATIVE ? false\n\t    : typeof detection == 'function' ? fails(detection)\n\t    : !!detection;\n\t};\n\n\tvar normalize = isForced.normalize = function (string) {\n\t  return String(string).replace(replacement, '.').toLowerCase();\n\t};\n\n\tvar data = isForced.data = {};\n\tvar NATIVE = isForced.NATIVE = 'N';\n\tvar POLYFILL = isForced.POLYFILL = 'P';\n\n\tvar isForced_1 = isForced;\n\n\tvar getOwnPropertyDescriptor$1 = objectGetOwnPropertyDescriptor.f;\n\n\n\n\n\n\n\t/*\n\t  options.target      - name of the target object\n\t  options.global      - target is the global object\n\t  options.stat        - export as static methods of target\n\t  options.proto       - export as prototype methods of target\n\t  options.real        - real prototype method for the `pure` version\n\t  options.forced      - export even if the native feature is available\n\t  options.bind        - bind methods to the target, required for the `pure` version\n\t  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n\t  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n\t  options.sham        - add a flag to not completely full polyfills\n\t  options.enumerable  - export as enumerable property\n\t  options.noTargetGet - prevent calling a getter on target\n\t*/\n\tvar _export = function (options, source) {\n\t  var TARGET = options.target;\n\t  var GLOBAL = options.global;\n\t  var STATIC = options.stat;\n\t  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n\t  if (GLOBAL) {\n\t    target = global_1;\n\t  } else if (STATIC) {\n\t    target = global_1[TARGET] || setGlobal(TARGET, {});\n\t  } else {\n\t    target = (global_1[TARGET] || {}).prototype;\n\t  }\n\t  if (target) { for (key in source) {\n\t    sourceProperty = source[key];\n\t    if (options.noTargetGet) {\n\t      descriptor = getOwnPropertyDescriptor$1(target, key);\n\t      targetProperty = descriptor && descriptor.value;\n\t    } else { targetProperty = target[key]; }\n\t    FORCED = isForced_1(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n\t    // contained in target\n\t    if (!FORCED && targetProperty !== undefined) {\n\t      if (typeof sourceProperty === typeof targetProperty) { continue; }\n\t      copyConstructorProperties(sourceProperty, targetProperty);\n\t    }\n\t    // add a flag to not completely full polyfills\n\t    if (options.sham || (targetProperty && targetProperty.sham)) {\n\t      createNonEnumerableProperty(sourceProperty, 'sham', true);\n\t    }\n\t    // extend global\n\t    redefine(target, key, sourceProperty, options);\n\t  } }\n\t};\n\n\tvar nativeSymbol = !!Object.getOwnPropertySymbols && !fails(function () {\n\t  // Chrome 38 Symbol has incorrect toString conversion\n\t  // eslint-disable-next-line no-undef\n\t  return !String(Symbol());\n\t});\n\n\tvar useSymbolAsUid = nativeSymbol\n\t  // eslint-disable-next-line no-undef\n\t  && !Symbol.sham\n\t  // eslint-disable-next-line no-undef\n\t  && typeof Symbol.iterator == 'symbol';\n\n\tvar WellKnownSymbolsStore = shared('wks');\n\tvar Symbol$1 = global_1.Symbol;\n\tvar createWellKnownSymbol = useSymbolAsUid ? Symbol$1 : Symbol$1 && Symbol$1.withoutSetter || uid;\n\n\tvar wellKnownSymbol = function (name) {\n\t  if (!has(WellKnownSymbolsStore, name)) {\n\t    if (nativeSymbol && has(Symbol$1, name)) { WellKnownSymbolsStore[name] = Symbol$1[name]; }\n\t    else { WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name); }\n\t  } return WellKnownSymbolsStore[name];\n\t};\n\n\t// `Object.keys` method\n\t// https://tc39.es/ecma262/#sec-object.keys\n\tvar objectKeys = Object.keys || function keys(O) {\n\t  return objectKeysInternal(O, enumBugKeys);\n\t};\n\n\t// `Object.defineProperties` method\n\t// https://tc39.es/ecma262/#sec-object.defineproperties\n\tvar objectDefineProperties = descriptors ? Object.defineProperties : function defineProperties(O, Properties) {\n\t  anObject(O);\n\t  var keys = objectKeys(Properties);\n\t  var length = keys.length;\n\t  var index = 0;\n\t  var key;\n\t  while (length > index) { objectDefineProperty.f(O, key = keys[index++], Properties[key]); }\n\t  return O;\n\t};\n\n\tvar html = getBuiltIn('document', 'documentElement');\n\n\tvar GT = '>';\n\tvar LT = '<';\n\tvar PROTOTYPE = 'prototype';\n\tvar SCRIPT = 'script';\n\tvar IE_PROTO = sharedKey('IE_PROTO');\n\n\tvar EmptyConstructor = function () { /* empty */ };\n\n\tvar scriptTag = function (content) {\n\t  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n\t};\n\n\t// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\n\tvar NullProtoObjectViaActiveX = function (activeXDocument) {\n\t  activeXDocument.write(scriptTag(''));\n\t  activeXDocument.close();\n\t  var temp = activeXDocument.parentWindow.Object;\n\t  activeXDocument = null; // avoid memory leak\n\t  return temp;\n\t};\n\n\t// Create object with fake `null` prototype: use iframe Object with cleared prototype\n\tvar NullProtoObjectViaIFrame = function () {\n\t  // Thrash, waste and sodomy: IE GC bug\n\t  var iframe = documentCreateElement('iframe');\n\t  var JS = 'java' + SCRIPT + ':';\n\t  var iframeDocument;\n\t  iframe.style.display = 'none';\n\t  html.appendChild(iframe);\n\t  // https://github.com/zloirock/core-js/issues/475\n\t  iframe.src = String(JS);\n\t  iframeDocument = iframe.contentWindow.document;\n\t  iframeDocument.open();\n\t  iframeDocument.write(scriptTag('document.F=Object'));\n\t  iframeDocument.close();\n\t  return iframeDocument.F;\n\t};\n\n\t// Check for document.domain and active x support\n\t// No need to use active x approach when document.domain is not set\n\t// see https://github.com/es-shims/es5-shim/issues/150\n\t// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n\t// avoid IE GC bug\n\tvar activeXDocument;\n\tvar NullProtoObject = function () {\n\t  try {\n\t    /* global ActiveXObject */\n\t    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n\t  } catch (error) { /* ignore */ }\n\t  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n\t  var length = enumBugKeys.length;\n\t  while (length--) { delete NullProtoObject[PROTOTYPE][enumBugKeys[length]]; }\n\t  return NullProtoObject();\n\t};\n\n\thiddenKeys[IE_PROTO] = true;\n\n\t// `Object.create` method\n\t// https://tc39.es/ecma262/#sec-object.create\n\tvar objectCreate = Object.create || function create(O, Properties) {\n\t  var result;\n\t  if (O !== null) {\n\t    EmptyConstructor[PROTOTYPE] = anObject(O);\n\t    result = new EmptyConstructor();\n\t    EmptyConstructor[PROTOTYPE] = null;\n\t    // add \"__proto__\" for Object.getPrototypeOf polyfill\n\t    result[IE_PROTO] = O;\n\t  } else { result = NullProtoObject(); }\n\t  return Properties === undefined ? result : objectDefineProperties(result, Properties);\n\t};\n\n\tvar UNSCOPABLES = wellKnownSymbol('unscopables');\n\tvar ArrayPrototype = Array.prototype;\n\n\t// Array.prototype[@@unscopables]\n\t// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\n\tif (ArrayPrototype[UNSCOPABLES] == undefined) {\n\t  objectDefineProperty.f(ArrayPrototype, UNSCOPABLES, {\n\t    configurable: true,\n\t    value: objectCreate(null)\n\t  });\n\t}\n\n\t// add a key to Array.prototype[@@unscopables]\n\tvar addToUnscopables = function (key) {\n\t  ArrayPrototype[UNSCOPABLES][key] = true;\n\t};\n\n\tvar defineProperty = Object.defineProperty;\n\tvar cache = {};\n\n\tvar thrower = function (it) { throw it; };\n\n\tvar arrayMethodUsesToLength = function (METHOD_NAME, options) {\n\t  if (has(cache, METHOD_NAME)) { return cache[METHOD_NAME]; }\n\t  if (!options) { options = {}; }\n\t  var method = [][METHOD_NAME];\n\t  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n\t  var argument0 = has(options, 0) ? options[0] : thrower;\n\t  var argument1 = has(options, 1) ? options[1] : undefined;\n\n\t  return cache[METHOD_NAME] = !!method && !fails(function () {\n\t    if (ACCESSORS && !descriptors) { return true; }\n\t    var O = { length: -1 };\n\n\t    if (ACCESSORS) { defineProperty(O, 1, { enumerable: true, get: thrower }); }\n\t    else { O[1] = 1; }\n\n\t    method.call(O, argument0, argument1);\n\t  });\n\t};\n\n\t'use strict';\n\n\tvar $includes = arrayIncludes.includes;\n\n\n\n\tvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n\t// `Array.prototype.includes` method\n\t// https://tc39.es/ecma262/#sec-array.prototype.includes\n\t_export({ target: 'Array', proto: true, forced: !USES_TO_LENGTH }, {\n\t  includes: function includes(el /* , fromIndex = 0 */) {\n\t    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n\t  }\n\t});\n\n\t// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\n\taddToUnscopables('includes');\n\n\tvar es_array_includes = {\n\n\t};\n\n\tvar aFunction$1 = function (it) {\n\t  if (typeof it != 'function') {\n\t    throw TypeError(String(it) + ' is not a function');\n\t  } return it;\n\t};\n\n\t// optional / simple context binding\n\tvar functionBindContext = function (fn, that, length) {\n\t  aFunction$1(fn);\n\t  if (that === undefined) { return fn; }\n\t  switch (length) {\n\t    case 0: return function () {\n\t      return fn.call(that);\n\t    };\n\t    case 1: return function (a) {\n\t      return fn.call(that, a);\n\t    };\n\t    case 2: return function (a, b) {\n\t      return fn.call(that, a, b);\n\t    };\n\t    case 3: return function (a, b, c) {\n\t      return fn.call(that, a, b, c);\n\t    };\n\t  }\n\t  return function (/* ...args */) {\n\t    return fn.apply(that, arguments);\n\t  };\n\t};\n\n\tvar call = Function.call;\n\n\tvar entryUnbind = function (CONSTRUCTOR, METHOD, length) {\n\t  return functionBindContext(call, global_1[CONSTRUCTOR].prototype[METHOD], length);\n\t};\n\n\tvar includes = entryUnbind('Array', 'includes');\n\n\tvar includes$1 = includes;\n\n\t// `ToObject` abstract operation\n\t// https://tc39.es/ecma262/#sec-toobject\n\tvar toObject = function (argument) {\n\t  return Object(requireObjectCoercible(argument));\n\t};\n\n\t// `IsArray` abstract operation\n\t// https://tc39.es/ecma262/#sec-isarray\n\tvar isArray = Array.isArray || function isArray(arg) {\n\t  return classofRaw(arg) == 'Array';\n\t};\n\n\tvar SPECIES = wellKnownSymbol('species');\n\n\t// `ArraySpeciesCreate` abstract operation\n\t// https://tc39.es/ecma262/#sec-arrayspeciescreate\n\tvar arraySpeciesCreate = function (originalArray, length) {\n\t  var C;\n\t  if (isArray(originalArray)) {\n\t    C = originalArray.constructor;\n\t    // cross-realm fallback\n\t    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) { C = undefined; }\n\t    else if (isObject(C)) {\n\t      C = C[SPECIES];\n\t      if (C === null) { C = undefined; }\n\t    }\n\t  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n\t};\n\n\tvar push = [].push;\n\n\t// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterOut }` methods implementation\n\tvar createMethod$1 = function (TYPE) {\n\t  var IS_MAP = TYPE == 1;\n\t  var IS_FILTER = TYPE == 2;\n\t  var IS_SOME = TYPE == 3;\n\t  var IS_EVERY = TYPE == 4;\n\t  var IS_FIND_INDEX = TYPE == 6;\n\t  var IS_FILTER_OUT = TYPE == 7;\n\t  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n\t  return function ($this, callbackfn, that, specificCreate) {\n\t    var O = toObject($this);\n\t    var self = indexedObject(O);\n\t    var boundFunction = functionBindContext(callbackfn, that, 3);\n\t    var length = toLength(self.length);\n\t    var index = 0;\n\t    var create = specificCreate || arraySpeciesCreate;\n\t    var target = IS_MAP ? create($this, length) : IS_FILTER || IS_FILTER_OUT ? create($this, 0) : undefined;\n\t    var value, result;\n\t    for (;length > index; index++) { if (NO_HOLES || index in self) {\n\t      value = self[index];\n\t      result = boundFunction(value, index, O);\n\t      if (TYPE) {\n\t        if (IS_MAP) { target[index] = result; } // map\n\t        else if (result) { switch (TYPE) {\n\t          case 3: return true;              // some\n\t          case 5: return value;             // find\n\t          case 6: return index;             // findIndex\n\t          case 2: push.call(target, value); // filter\n\t        } } else { switch (TYPE) {\n\t          case 4: return false;             // every\n\t          case 7: push.call(target, value); // filterOut\n\t        } }\n\t      }\n\t    } }\n\t    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n\t  };\n\t};\n\n\tvar arrayIteration = {\n\t  // `Array.prototype.forEach` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.foreach\n\t  forEach: createMethod$1(0),\n\t  // `Array.prototype.map` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.map\n\t  map: createMethod$1(1),\n\t  // `Array.prototype.filter` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.filter\n\t  filter: createMethod$1(2),\n\t  // `Array.prototype.some` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.some\n\t  some: createMethod$1(3),\n\t  // `Array.prototype.every` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.every\n\t  every: createMethod$1(4),\n\t  // `Array.prototype.find` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.find\n\t  find: createMethod$1(5),\n\t  // `Array.prototype.findIndex` method\n\t  // https://tc39.es/ecma262/#sec-array.prototype.findIndex\n\t  findIndex: createMethod$1(6),\n\t  // `Array.prototype.filterOut` method\n\t  // https://github.com/tc39/proposal-array-filtering\n\t  filterOut: createMethod$1(7)\n\t};\n\tvar arrayIteration_1 = arrayIteration.forEach;\n\tvar arrayIteration_2 = arrayIteration.map;\n\tvar arrayIteration_3 = arrayIteration.filter;\n\tvar arrayIteration_4 = arrayIteration.some;\n\tvar arrayIteration_5 = arrayIteration.every;\n\tvar arrayIteration_6 = arrayIteration.find;\n\tvar arrayIteration_7 = arrayIteration.findIndex;\n\tvar arrayIteration_8 = arrayIteration.filterOut;\n\n\t'use strict';\n\n\tvar $find = arrayIteration.find;\n\n\n\n\tvar FIND = 'find';\n\tvar SKIPS_HOLES = true;\n\n\tvar USES_TO_LENGTH$1 = arrayMethodUsesToLength(FIND);\n\n\t// Shouldn't skip holes\n\tif (FIND in []) { Array(1)[FIND](function () { SKIPS_HOLES = false; }); }\n\n\t// `Array.prototype.find` method\n\t// https://tc39.es/ecma262/#sec-array.prototype.find\n\t_export({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH$1 }, {\n\t  find: function find(callbackfn /* , that = undefined */) {\n\t    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n\t  }\n\t});\n\n\t// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\n\taddToUnscopables(FIND);\n\n\tvar es_array_find = {\n\n\t};\n\n\tvar find = entryUnbind('Array', 'find');\n\n\tvar find$1 = find;\n\n\t// `String.prototype.{ codePointAt, at }` methods implementation\n\tvar createMethod$2 = function (CONVERT_TO_STRING) {\n\t  return function ($this, pos) {\n\t    var S = String(requireObjectCoercible($this));\n\t    var position = toInteger(pos);\n\t    var size = S.length;\n\t    var first, second;\n\t    if (position < 0 || position >= size) { return CONVERT_TO_STRING ? '' : undefined; }\n\t    first = S.charCodeAt(position);\n\t    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n\t      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n\t        ? CONVERT_TO_STRING ? S.charAt(position) : first\n\t        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n\t  };\n\t};\n\n\tvar stringMultibyte = {\n\t  // `String.prototype.codePointAt` method\n\t  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n\t  codeAt: createMethod$2(false),\n\t  // `String.prototype.at` method\n\t  // https://github.com/mathiasbynens/String.prototype.at\n\t  charAt: createMethod$2(true)\n\t};\n\tvar stringMultibyte_1 = stringMultibyte.codeAt;\n\tvar stringMultibyte_2 = stringMultibyte.charAt;\n\n\tvar correctPrototypeGetter = !fails(function () {\n\t  function F() { /* empty */ }\n\t  F.prototype.constructor = null;\n\t  return Object.getPrototypeOf(new F()) !== F.prototype;\n\t});\n\n\tvar IE_PROTO$1 = sharedKey('IE_PROTO');\n\tvar ObjectPrototype = Object.prototype;\n\n\t// `Object.getPrototypeOf` method\n\t// https://tc39.es/ecma262/#sec-object.getprototypeof\n\tvar objectGetPrototypeOf = correctPrototypeGetter ? Object.getPrototypeOf : function (O) {\n\t  O = toObject(O);\n\t  if (has(O, IE_PROTO$1)) { return O[IE_PROTO$1]; }\n\t  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n\t    return O.constructor.prototype;\n\t  } return O instanceof Object ? ObjectPrototype : null;\n\t};\n\n\t'use strict';\n\n\n\n\n\n\n\n\tvar ITERATOR = wellKnownSymbol('iterator');\n\tvar BUGGY_SAFARI_ITERATORS = false;\n\n\tvar returnThis = function () { return this; };\n\n\t// `%IteratorPrototype%` object\n\t// https://tc39.es/ecma262/#sec-%iteratorprototype%-object\n\tvar IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;\n\n\tif ([].keys) {\n\t  arrayIterator = [].keys();\n\t  // Safari 8 has buggy iterators w/o `next`\n\t  if (!('next' in arrayIterator)) { BUGGY_SAFARI_ITERATORS = true; }\n\t  else {\n\t    PrototypeOfArrayIteratorPrototype = objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator));\n\t    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) { IteratorPrototype = PrototypeOfArrayIteratorPrototype; }\n\t  }\n\t}\n\n\tvar NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {\n\t  var test = {};\n\t  // FF44- legacy iterators case\n\t  return IteratorPrototype[ITERATOR].call(test) !== test;\n\t});\n\n\tif (NEW_ITERATOR_PROTOTYPE) { IteratorPrototype = {}; }\n\n\t// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\n\tif ((!isPure || NEW_ITERATOR_PROTOTYPE) && !has(IteratorPrototype, ITERATOR)) {\n\t  createNonEnumerableProperty(IteratorPrototype, ITERATOR, returnThis);\n\t}\n\n\tvar iteratorsCore = {\n\t  IteratorPrototype: IteratorPrototype,\n\t  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS\n\t};\n\tvar iteratorsCore_1 = iteratorsCore.IteratorPrototype;\n\tvar iteratorsCore_2 = iteratorsCore.BUGGY_SAFARI_ITERATORS;\n\n\tvar defineProperty$1 = objectDefineProperty.f;\n\n\n\n\tvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n\n\tvar setToStringTag = function (it, TAG, STATIC) {\n\t  if (it && !has(it = STATIC ? it : it.prototype, TO_STRING_TAG)) {\n\t    defineProperty$1(it, TO_STRING_TAG, { configurable: true, value: TAG });\n\t  }\n\t};\n\n\tvar iterators = {};\n\n\t'use strict';\n\tvar IteratorPrototype$1 = iteratorsCore.IteratorPrototype;\n\n\n\n\n\n\tvar returnThis$1 = function () { return this; };\n\n\tvar createIteratorConstructor = function (IteratorConstructor, NAME, next) {\n\t  var TO_STRING_TAG = NAME + ' Iterator';\n\t  IteratorConstructor.prototype = objectCreate(IteratorPrototype$1, { next: createPropertyDescriptor(1, next) });\n\t  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);\n\t  iterators[TO_STRING_TAG] = returnThis$1;\n\t  return IteratorConstructor;\n\t};\n\n\tvar aPossiblePrototype = function (it) {\n\t  if (!isObject(it) && it !== null) {\n\t    throw TypeError(\"Can't set \" + String(it) + ' as a prototype');\n\t  } return it;\n\t};\n\n\t// `Object.setPrototypeOf` method\n\t// https://tc39.es/ecma262/#sec-object.setprototypeof\n\t// Works with __proto__ only. Old v8 can't work with null proto objects.\n\t/* eslint-disable no-proto */\n\tvar objectSetPrototypeOf = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n\t  var CORRECT_SETTER = false;\n\t  var test = {};\n\t  var setter;\n\t  try {\n\t    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n\t    setter.call(test, []);\n\t    CORRECT_SETTER = test instanceof Array;\n\t  } catch (error) { /* empty */ }\n\t  return function setPrototypeOf(O, proto) {\n\t    anObject(O);\n\t    aPossiblePrototype(proto);\n\t    if (CORRECT_SETTER) { setter.call(O, proto); }\n\t    else { O.__proto__ = proto; }\n\t    return O;\n\t  };\n\t}() : undefined);\n\n\t'use strict';\n\n\n\n\n\n\n\n\n\n\n\n\n\tvar IteratorPrototype$2 = iteratorsCore.IteratorPrototype;\n\tvar BUGGY_SAFARI_ITERATORS$1 = iteratorsCore.BUGGY_SAFARI_ITERATORS;\n\tvar ITERATOR$1 = wellKnownSymbol('iterator');\n\tvar KEYS = 'keys';\n\tvar VALUES = 'values';\n\tvar ENTRIES = 'entries';\n\n\tvar returnThis$2 = function () { return this; };\n\n\tvar defineIterator = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {\n\t  createIteratorConstructor(IteratorConstructor, NAME, next);\n\n\t  var getIterationMethod = function (KIND) {\n\t    if (KIND === DEFAULT && defaultIterator) { return defaultIterator; }\n\t    if (!BUGGY_SAFARI_ITERATORS$1 && KIND in IterablePrototype) { return IterablePrototype[KIND]; }\n\t    switch (KIND) {\n\t      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };\n\t      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };\n\t      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };\n\t    } return function () { return new IteratorConstructor(this); };\n\t  };\n\n\t  var TO_STRING_TAG = NAME + ' Iterator';\n\t  var INCORRECT_VALUES_NAME = false;\n\t  var IterablePrototype = Iterable.prototype;\n\t  var nativeIterator = IterablePrototype[ITERATOR$1]\n\t    || IterablePrototype['@@iterator']\n\t    || DEFAULT && IterablePrototype[DEFAULT];\n\t  var defaultIterator = !BUGGY_SAFARI_ITERATORS$1 && nativeIterator || getIterationMethod(DEFAULT);\n\t  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;\n\t  var CurrentIteratorPrototype, methods, KEY;\n\n\t  // fix native\n\t  if (anyNativeIterator) {\n\t    CurrentIteratorPrototype = objectGetPrototypeOf(anyNativeIterator.call(new Iterable()));\n\t    if (IteratorPrototype$2 !== Object.prototype && CurrentIteratorPrototype.next) {\n\t      if (!isPure && objectGetPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype$2) {\n\t        if (objectSetPrototypeOf) {\n\t          objectSetPrototypeOf(CurrentIteratorPrototype, IteratorPrototype$2);\n\t        } else if (typeof CurrentIteratorPrototype[ITERATOR$1] != 'function') {\n\t          createNonEnumerableProperty(CurrentIteratorPrototype, ITERATOR$1, returnThis$2);\n\t        }\n\t      }\n\t      // Set @@toStringTag to native iterators\n\t      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);\n\t      if (isPure) { iterators[TO_STRING_TAG] = returnThis$2; }\n\t    }\n\t  }\n\n\t  // fix Array#{values, @@iterator}.name in V8 / FF\n\t  if (DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {\n\t    INCORRECT_VALUES_NAME = true;\n\t    defaultIterator = function values() { return nativeIterator.call(this); };\n\t  }\n\n\t  // define iterator\n\t  if ((!isPure || FORCED) && IterablePrototype[ITERATOR$1] !== defaultIterator) {\n\t    createNonEnumerableProperty(IterablePrototype, ITERATOR$1, defaultIterator);\n\t  }\n\t  iterators[NAME] = defaultIterator;\n\n\t  // export additional methods\n\t  if (DEFAULT) {\n\t    methods = {\n\t      values: getIterationMethod(VALUES),\n\t      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),\n\t      entries: getIterationMethod(ENTRIES)\n\t    };\n\t    if (FORCED) { for (KEY in methods) {\n\t      if (BUGGY_SAFARI_ITERATORS$1 || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {\n\t        redefine(IterablePrototype, KEY, methods[KEY]);\n\t      }\n\t    } } else { _export({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS$1 || INCORRECT_VALUES_NAME }, methods); }\n\t  }\n\n\t  return methods;\n\t};\n\n\t'use strict';\n\tvar charAt = stringMultibyte.charAt;\n\n\n\n\tvar STRING_ITERATOR = 'String Iterator';\n\tvar setInternalState = internalState.set;\n\tvar getInternalState = internalState.getterFor(STRING_ITERATOR);\n\n\t// `String.prototype[@@iterator]` method\n\t// https://tc39.es/ecma262/#sec-string.prototype-@@iterator\n\tdefineIterator(String, 'String', function (iterated) {\n\t  setInternalState(this, {\n\t    type: STRING_ITERATOR,\n\t    string: String(iterated),\n\t    index: 0\n\t  });\n\t// `%StringIteratorPrototype%.next` method\n\t// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next\n\t}, function next() {\n\t  var state = getInternalState(this);\n\t  var string = state.string;\n\t  var index = state.index;\n\t  var point;\n\t  if (index >= string.length) { return { value: undefined, done: true }; }\n\t  point = charAt(string, index);\n\t  state.index += point.length;\n\t  return { value: point, done: false };\n\t});\n\n\tvar es_string_iterator = {\n\n\t};\n\n\tvar iteratorClose = function (iterator) {\n\t  var returnMethod = iterator['return'];\n\t  if (returnMethod !== undefined) {\n\t    return anObject(returnMethod.call(iterator)).value;\n\t  }\n\t};\n\n\t// call something on iterator step with safe closing on error\n\tvar callWithSafeIterationClosing = function (iterator, fn, value, ENTRIES) {\n\t  try {\n\t    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n\t  // 7.4.6 IteratorClose(iterator, completion)\n\t  } catch (error) {\n\t    iteratorClose(iterator);\n\t    throw error;\n\t  }\n\t};\n\n\tvar ITERATOR$2 = wellKnownSymbol('iterator');\n\tvar ArrayPrototype$1 = Array.prototype;\n\n\t// check on default Array iterator\n\tvar isArrayIteratorMethod = function (it) {\n\t  return it !== undefined && (iterators.Array === it || ArrayPrototype$1[ITERATOR$2] === it);\n\t};\n\n\t'use strict';\n\n\n\n\n\tvar createProperty = function (object, key, value) {\n\t  var propertyKey = toPrimitive(key);\n\t  if (propertyKey in object) { objectDefineProperty.f(object, propertyKey, createPropertyDescriptor(0, value)); }\n\t  else { object[propertyKey] = value; }\n\t};\n\n\tvar TO_STRING_TAG$1 = wellKnownSymbol('toStringTag');\n\tvar test = {};\n\n\ttest[TO_STRING_TAG$1] = 'z';\n\n\tvar toStringTagSupport = String(test) === '[object z]';\n\n\tvar TO_STRING_TAG$2 = wellKnownSymbol('toStringTag');\n\t// ES3 wrong here\n\tvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n\t// fallback for IE11 Script Access Denied error\n\tvar tryGet = function (it, key) {\n\t  try {\n\t    return it[key];\n\t  } catch (error) { /* empty */ }\n\t};\n\n\t// getting tag from ES6+ `Object.prototype.toString`\n\tvar classof = toStringTagSupport ? classofRaw : function (it) {\n\t  var O, tag, result;\n\t  return it === undefined ? 'Undefined' : it === null ? 'Null'\n\t    // @@toStringTag case\n\t    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG$2)) == 'string' ? tag\n\t    // builtinTag case\n\t    : CORRECT_ARGUMENTS ? classofRaw(O)\n\t    // ES3 arguments fallback\n\t    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n\t};\n\n\tvar ITERATOR$3 = wellKnownSymbol('iterator');\n\n\tvar getIteratorMethod = function (it) {\n\t  if (it != undefined) { return it[ITERATOR$3]\n\t    || it['@@iterator']\n\t    || iterators[classof(it)]; }\n\t};\n\n\t'use strict';\n\n\n\n\n\n\n\n\n\t// `Array.from` method implementation\n\t// https://tc39.es/ecma262/#sec-array.from\n\tvar arrayFrom = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n\t  var O = toObject(arrayLike);\n\t  var C = typeof this == 'function' ? this : Array;\n\t  var argumentsLength = arguments.length;\n\t  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n\t  var mapping = mapfn !== undefined;\n\t  var iteratorMethod = getIteratorMethod(O);\n\t  var index = 0;\n\t  var length, result, step, iterator, next, value;\n\t  if (mapping) { mapfn = functionBindContext(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2); }\n\t  // if the target is not iterable or it's an array with the default iterator - use a simple case\n\t  if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {\n\t    iterator = iteratorMethod.call(O);\n\t    next = iterator.next;\n\t    result = new C();\n\t    for (;!(step = next.call(iterator)).done; index++) {\n\t      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n\t      createProperty(result, index, value);\n\t    }\n\t  } else {\n\t    length = toLength(O.length);\n\t    result = new C(length);\n\t    for (;length > index; index++) {\n\t      value = mapping ? mapfn(O[index], index) : O[index];\n\t      createProperty(result, index, value);\n\t    }\n\t  }\n\t  result.length = index;\n\t  return result;\n\t};\n\n\tvar ITERATOR$4 = wellKnownSymbol('iterator');\n\tvar SAFE_CLOSING = false;\n\n\ttry {\n\t  var called = 0;\n\t  var iteratorWithReturn = {\n\t    next: function () {\n\t      return { done: !!called++ };\n\t    },\n\t    'return': function () {\n\t      SAFE_CLOSING = true;\n\t    }\n\t  };\n\t  iteratorWithReturn[ITERATOR$4] = function () {\n\t    return this;\n\t  };\n\t  // eslint-disable-next-line no-throw-literal\n\t  Array.from(iteratorWithReturn, function () { throw 2; });\n\t} catch (error) { /* empty */ }\n\n\tvar checkCorrectnessOfIteration = function (exec, SKIP_CLOSING) {\n\t  if (!SKIP_CLOSING && !SAFE_CLOSING) { return false; }\n\t  var ITERATION_SUPPORT = false;\n\t  try {\n\t    var object = {};\n\t    object[ITERATOR$4] = function () {\n\t      return {\n\t        next: function () {\n\t          return { done: ITERATION_SUPPORT = true };\n\t        }\n\t      };\n\t    };\n\t    exec(object);\n\t  } catch (error) { /* empty */ }\n\t  return ITERATION_SUPPORT;\n\t};\n\n\tvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n\t  Array.from(iterable);\n\t});\n\n\t// `Array.from` method\n\t// https://tc39.es/ecma262/#sec-array.from\n\t_export({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n\t  from: arrayFrom\n\t});\n\n\tvar es_array_from = {\n\n\t};\n\n\tvar from_1 = path.Array.from;\n\n\tvar from_1$1 = from_1;\n\n\t'use strict';\n\n\tvar $findIndex = arrayIteration.findIndex;\n\n\n\n\tvar FIND_INDEX = 'findIndex';\n\tvar SKIPS_HOLES$1 = true;\n\n\tvar USES_TO_LENGTH$2 = arrayMethodUsesToLength(FIND_INDEX);\n\n\t// Shouldn't skip holes\n\tif (FIND_INDEX in []) { Array(1)[FIND_INDEX](function () { SKIPS_HOLES$1 = false; }); }\n\n\t// `Array.prototype.findIndex` method\n\t// https://tc39.es/ecma262/#sec-array.prototype.findindex\n\t_export({ target: 'Array', proto: true, forced: SKIPS_HOLES$1 || !USES_TO_LENGTH$2 }, {\n\t  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n\t    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n\t  }\n\t});\n\n\t// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\n\taddToUnscopables(FIND_INDEX);\n\n\tvar es_array_findIndex = {\n\n\t};\n\n\tvar findIndex = entryUnbind('Array', 'findIndex');\n\n\tvar findIndex$1 = findIndex;\n\n\tvar base64 = createCommonjsModule(function (module, exports) {\n\t(function() {\n\n\t    /**\n\t     * version: 0.3.0\n\t     * git://github.com/davidchambers/Base64.js.git\n\t     */\n\n\t    var object = 'object' != 'undefined' ? exports : this; // #8: web workers\n\t    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\n\t    function InvalidCharacterError(message) {\n\t        this.message = message;\n\t    }\n\n\t    InvalidCharacterError.prototype = new Error;\n\t    InvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\n\t    // encoder\n\t    // [https://gist.github.com/999166] by [https://github.com/nignag]\n\t    object.btoa || (\n\t        object.btoa = function(input) {\n\t            var str = String(input);\n\t            for (\n\t                // initialize result and counter\n\t                var block, charCode, idx = 0, map = chars, output = '';\n\t                // if the next str index does not exist:\n\t                //   change the mapping table to \"=\"\n\t                //   check if d has no fractional digits\n\t                str.charAt(idx | 0) || (map = '=', idx % 1);\n\t                // \"8 - idx % 1 * 8\" generates the sequence 2, 4, 6, 8\n\t                output += map.charAt(63 & block >> 8 - idx % 1 * 8)\n\t            ) {\n\t                charCode = str.charCodeAt(idx += 3 / 4);\n\t                if (charCode > 0xFF) {\n\t                    throw new InvalidCharacterError('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n\t                }\n\t                block = block << 8 | charCode;\n\t            }\n\t            return output;\n\t        });\n\n\t    // decoder\n\t    // [https://gist.github.com/1020396] by [https://github.com/atk]\n\t    object.atob || (\n\t        object.atob = function(input) {\n\t            var str = String(input).replace(/=+$/, '');\n\t            if (str.length % 4 == 1) {\n\t                throw new InvalidCharacterError('\\'atob\\' failed: The string to be decoded is not correctly encoded.');\n\t            }\n\t            for (\n\t                // initialize result and counters\n\t                var bc = 0, bs, buffer, idx = 0, output = '';\n\t                // get next character\n\t                // eslint-disable-next-line no-cond-assign\n\t                buffer = str.charAt(idx++);\n\t                // character found in table? initialize bit storage and add its ascii value;\n\t                ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,\n\t                // and if not first of each 4 characters,\n\t                // convert the first 8 bits to one ascii character\n\t                bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0\n\t            ) {\n\t                // try to find character in table (0-63, not found => -1)\n\t                buffer = chars.indexOf(buffer);\n\t            }\n\t            return output;\n\t        });\n\n\t}());\n\t});\n\n\t// `Number.isNaN` method\n\t// https://tc39.es/ecma262/#sec-number.isnan\n\t_export({ target: 'Number', stat: true }, {\n\t  isNaN: function isNaN(number) {\n\t    // eslint-disable-next-line no-self-compare\n\t    return number != number;\n\t  }\n\t});\n\n\tvar es_number_isNan = {\n\n\t};\n\n\tvar isNan = path.Number.isNaN;\n\n\tvar isNan$1 = isNan;\n\n\tvar globalIsFinite = global_1.isFinite;\n\n\t// `Number.isFinite` method\n\t// https://tc39.es/ecma262/#sec-number.isfinite\n\tvar numberIsFinite = Number.isFinite || function isFinite(it) {\n\t  return typeof it == 'number' && globalIsFinite(it);\n\t};\n\n\t// `Number.isFinite` method\n\t// https://tc39.es/ecma262/#sec-number.isfinite\n\t_export({ target: 'Number', stat: true }, { isFinite: numberIsFinite });\n\n\tvar es_number_isFinite = {\n\n\t};\n\n\tvar _isFinite = path.Number.isFinite;\n\n\tvar _isFinite$1 = _isFinite;\n\n\tvar MATCH = wellKnownSymbol('match');\n\n\t// `IsRegExp` abstract operation\n\t// https://tc39.es/ecma262/#sec-isregexp\n\tvar isRegexp = function (it) {\n\t  var isRegExp;\n\t  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classofRaw(it) == 'RegExp');\n\t};\n\n\tvar notARegexp = function (it) {\n\t  if (isRegexp(it)) {\n\t    throw TypeError(\"The method doesn't accept regular expressions\");\n\t  } return it;\n\t};\n\n\tvar MATCH$1 = wellKnownSymbol('match');\n\n\tvar correctIsRegexpLogic = function (METHOD_NAME) {\n\t  var regexp = /./;\n\t  try {\n\t    '/./'[METHOD_NAME](regexp);\n\t  } catch (error1) {\n\t    try {\n\t      regexp[MATCH$1] = false;\n\t      return '/./'[METHOD_NAME](regexp);\n\t    } catch (error2) { /* empty */ }\n\t  } return false;\n\t};\n\n\t'use strict';\n\n\n\n\n\n\t// `String.prototype.includes` method\n\t// https://tc39.es/ecma262/#sec-string.prototype.includes\n\t_export({ target: 'String', proto: true, forced: !correctIsRegexpLogic('includes') }, {\n\t  includes: function includes(searchString /* , position = 0 */) {\n\t    return !!~String(requireObjectCoercible(this))\n\t      .indexOf(notARegexp(searchString), arguments.length > 1 ? arguments[1] : undefined);\n\t  }\n\t});\n\n\tvar es_string_includes = {\n\n\t};\n\n\tvar includes$2 = entryUnbind('String', 'includes');\n\n\tvar includes$3 = includes$2;\n\n\t'use strict';\n\n\tvar getOwnPropertyDescriptor$2 = objectGetOwnPropertyDescriptor.f;\n\n\n\n\n\n\n\tvar nativeStartsWith = ''.startsWith;\n\tvar min$2 = Math.min;\n\n\tvar CORRECT_IS_REGEXP_LOGIC = correctIsRegexpLogic('startsWith');\n\t// https://github.com/zloirock/core-js/pull/702\n\tvar MDN_POLYFILL_BUG = !isPure && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n\t  var descriptor = getOwnPropertyDescriptor$2(String.prototype, 'startsWith');\n\t  return descriptor && !descriptor.writable;\n\t}();\n\n\t// `String.prototype.startsWith` method\n\t// https://tc39.es/ecma262/#sec-string.prototype.startswith\n\t_export({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n\t  startsWith: function startsWith(searchString /* , position = 0 */) {\n\t    var that = String(requireObjectCoercible(this));\n\t    notARegexp(searchString);\n\t    var index = toLength(min$2(arguments.length > 1 ? arguments[1] : undefined, that.length));\n\t    var search = String(searchString);\n\t    return nativeStartsWith\n\t      ? nativeStartsWith.call(that, search, index)\n\t      : that.slice(index, index + search.length) === search;\n\t  }\n\t});\n\n\tvar es_string_startsWith = {\n\n\t};\n\n\tvar startsWith = entryUnbind('String', 'startsWith');\n\n\tvar startsWith$1 = startsWith;\n\n\t(function() {\n\n\t    if (typeof Uint8Array !== 'undefined' || typeof window === 'undefined') {\n\t        return;\n\t    }\n\n\t    function subarray(start, end) {\n\t        return this.slice(start, end);\n\t    }\n\n\t    function set_(array, offset) {\n\n\t        if (arguments.length < 2) {\n\t            offset = 0;\n\t        }\n\t        for (var i = 0, n = array.length; i < n; ++i, ++offset) {\n\t            this[offset] = array[i] & 0xFF;\n\t        }\n\t    }\n\n\t    // we need typed arrays\n\t    function TypedArray(arg1) {\n\n\t        var result;\n\t        if (typeof arg1 === 'number') {\n\t            result = new Array(arg1);\n\t            for (var i = 0; i < arg1; ++i) {\n\t                result[i] = 0;\n\t            }\n\t        } else {\n\t            result = arg1.slice(0);\n\t        }\n\t        result.subarray = subarray;\n\t        result.buffer = result;\n\t        result.byteLength = result.length;\n\t        result.set = set_;\n\t        if (typeof arg1 === 'object' && arg1.buffer) {\n\t            result.buffer = arg1.buffer;\n\t        }\n\n\t        return result;\n\t    }\n\n\t    window.Uint8Array = TypedArray;\n\t    window.Uint32Array = TypedArray;\n\t    window.Int32Array = TypedArray;\n\t})();\n\n\t// Declare shorthands to the most used math functions.\n\tvar round = Math.round;\n\tvar floor$1 = Math.floor;\n\tvar PI = Math.PI;\n\n\tvar scale = {\n\n\t    // Return the `value` from the `domain` interval scaled to the `range` interval.\n\t    linear: function(domain, range, value) {\n\n\t        var domainSpan = domain[1] - domain[0];\n\t        var rangeSpan = range[1] - range[0];\n\t        return (((value - domain[0]) / domainSpan) * rangeSpan + range[0]) || 0;\n\t    }\n\t};\n\n\tvar normalizeAngle = function(angle) {\n\n\t    return (angle % 360) + (angle < 0 ? 360 : 0);\n\t};\n\n\tvar snapToGrid = function(value, gridSize) {\n\n\t    return gridSize * round(value / gridSize);\n\t};\n\n\tvar toDeg = function(rad) {\n\n\t    return (180 * rad / PI) % 360;\n\t};\n\n\tvar toRad = function(deg, over360) {\n\n\t    over360 = over360 || false;\n\t    deg = over360 ? deg : (deg % 360);\n\t    return deg * PI / 180;\n\t};\n\n\t// Return a random integer from the interval [min,max], inclusive.\n\tvar random = function(min, max) {\n\n\t    if (max === undefined) {\n\t        // use first argument as max, min is 0\n\t        max = (min === undefined) ? 1 : min;\n\t        min = 0;\n\n\t    } else if (max < min) {\n\t        // switch max and min\n\t        var temp = min;\n\t        min = max;\n\t        max = temp;\n\t    }\n\n\t    return floor$1((Math.random() * (max - min + 1)) + min);\n\t};\n\n\t// @return the bearing (cardinal direction) of the line. For example N, W, or SE.\n\n\tvar cos = Math.cos;\n\tvar sin = Math.sin;\n\tvar atan2 = Math.atan2;\n\n\tvar bearing = function(p, q) {\n\n\t    var lat1 = toRad(p.y);\n\t    var lat2 = toRad(q.y);\n\t    var lon1 = p.x;\n\t    var lon2 = q.x;\n\t    var dLon = toRad(lon2 - lon1);\n\t    var y = sin(dLon) * cos(lat2);\n\t    var x = cos(lat1) * sin(lat2) - sin(lat1) * cos(lat2) * cos(dLon);\n\t    var brng = toDeg(atan2(y, x));\n\n\t    var bearings = ['NE', 'E', 'SE', 'S', 'SW', 'W', 'NW', 'N'];\n\n\t    var index = brng - 22.5;\n\t    if (index < 0)\n\t        { index += 360; }\n\t    index = parseInt(index / 45);\n\n\t    return bearings[index];\n\t};\n\n\t// @return {integer} length without sqrt\n\t// @note for applications where the exact length is not necessary (e.g. compare only)\n\tvar squaredLength = function(start, end) {\n\n\t    var x0 = start.x;\n\t    var y0 = start.y;\n\t    var x1 = end.x;\n\t    var y1 = end.y;\n\t    return (x0 -= x1) * x0 + (y0 -= y1) * y0;\n\t};\n\n\tvar length = function(start, end) {\n\t    return Math.sqrt(squaredLength(start, end));\n\t};\n\n\tvar types = {\n\t    Point: 1,\n\t    Line: 2,\n\t    Ellipse: 3,\n\t    Rect: 4,\n\t    Polyline: 5,\n\t    Polygon: 6,\n\t    Curve: 7,\n\t    Path: 8\n\t};\n\n\t/*\n\t    Point is the most basic object consisting of x/y coordinate.\n\n\t    Possible instantiations are:\n\t    * `Point(10, 20)`\n\t    * `new Point(10, 20)`\n\t    * `Point('10 20')`\n\t    * `Point(Point(10, 20))`\n\t*/\n\n\tvar abs = Math.abs;\n\tvar cos$1 = Math.cos;\n\tvar sin$1 = Math.sin;\n\tvar sqrt = Math.sqrt;\n\tvar min$3 = Math.min;\n\tvar max$1 = Math.max;\n\tvar atan2$1 = Math.atan2;\n\tvar round$1 = Math.round;\n\tvar pow = Math.pow;\n\tvar PI$1 = Math.PI;\n\n\tvar Point = function(x, y) {\n\n\t    if (!(this instanceof Point)) {\n\t        return new Point(x, y);\n\t    }\n\n\t    if (typeof x === 'string') {\n\t        var xy = x.split(x.indexOf('@') === -1 ? ' ' : '@');\n\t        x = parseFloat(xy[0]);\n\t        y = parseFloat(xy[1]);\n\n\t    } else if (Object(x) === x) {\n\t        y = x.y;\n\t        x = x.x;\n\t    }\n\n\t    this.x = x === undefined ? 0 : x;\n\t    this.y = y === undefined ? 0 : y;\n\t};\n\n\t// Alternative constructor, from polar coordinates.\n\t// @param {number} Distance.\n\t// @param {number} Angle in radians.\n\t// @param {point} [optional] Origin.\n\tPoint.fromPolar = function(distance, angle, origin) {\n\n\t    origin = new Point(origin);\n\t    var x = abs(distance * cos$1(angle));\n\t    var y = abs(distance * sin$1(angle));\n\t    var deg = normalizeAngle(toDeg(angle));\n\n\t    if (deg < 90) {\n\t        y = -y;\n\n\t    } else if (deg < 180) {\n\t        x = -x;\n\t        y = -y;\n\n\t    } else if (deg < 270) {\n\t        x = -x;\n\t    }\n\n\t    return new Point(origin.x + x, origin.y + y);\n\t};\n\n\t// Create a point with random coordinates that fall into the range `[x1, x2]` and `[y1, y2]`.\n\tPoint.random = function(x1, x2, y1, y2) {\n\n\t    return new Point(random(x1, x2), random(y1, y2));\n\t};\n\n\tPoint.prototype = {\n\n\t    type: types.Point,\n\n\t    chooseClosest: function(points) {\n\n\t        var n = points.length;\n\t        if (n === 1) { return new Point(points[0]); }\n\t        var closest = null;\n\t        var minSqrDistance = Infinity;\n\t        for (var i = 0; i < n; i++) {\n\t            var p = new Point(points[i]);\n\t            var sqrDistance = this.squaredDistance(p);\n\t            if (sqrDistance < minSqrDistance) {\n\t                closest = p;\n\t                minSqrDistance = sqrDistance;\n\t            }\n\t        }\n\t        return closest;\n\t    },\n\n\t    // If point lies outside rectangle `r`, return the nearest point on the boundary of rect `r`,\n\t    // otherwise return point itself.\n\t    // (see Squeak Smalltalk, Point>>adhereTo:)\n\t    adhereToRect: function(r) {\n\n\t        if (r.containsPoint(this)) {\n\t            return this;\n\t        }\n\n\t        this.x = min$3(max$1(this.x, r.x), r.x + r.width);\n\t        this.y = min$3(max$1(this.y, r.y), r.y + r.height);\n\t        return this;\n\t    },\n\n\t    // Compute the angle between vector from me to p1 and the vector from me to p2.\n\t    // ordering of points p1 and p2 is important!\n\t    // theta function's angle convention:\n\t    // returns angles between 0 and 180 when the angle is counterclockwise\n\t    // returns angles between 180 and 360 to convert clockwise angles into counterclockwise ones\n\t    // returns NaN if any of the points p1, p2 is coincident with this point\n\t    angleBetween: function(p1, p2) {\n\n\t        var angleBetween = (this.equals(p1) || this.equals(p2)) ? NaN : (this.theta(p2) - this.theta(p1));\n\n\t        if (angleBetween < 0) {\n\t            angleBetween += 360; // correction to keep angleBetween between 0 and 360\n\t        }\n\n\t        return angleBetween;\n\t    },\n\n\t    // Return the bearing between me and the given point.\n\t    bearing: function(point) {\n\t        return bearing(this, point);\n\t    },\n\n\t    // Returns change in angle from my previous position (-dx, -dy) to my new position\n\t    // relative to ref point.\n\t    changeInAngle: function(dx, dy, ref) {\n\n\t        // Revert the translation and measure the change in angle around x-axis.\n\t        return this.clone().offset(-dx, -dy).theta(ref) - this.theta(ref);\n\t    },\n\n\t    clone: function() {\n\n\t        return new Point(this);\n\t    },\n\n\t    // Returns the cross product of this point relative to two other points\n\t    // this point is the common point\n\t    // point p1 lies on the first vector, point p2 lies on the second vector\n\t    // watch out for the ordering of points p1 and p2!\n\t    // positive result indicates a clockwise (\"right\") turn from first to second vector\n\t    // negative result indicates a counterclockwise (\"left\") turn from first to second vector\n\t    // zero indicates that the first and second vector are collinear\n\t    // note that the above directions are reversed from the usual answer on the Internet\n\t    // that is because we are in a left-handed coord system (because the y-axis points downward)\n\t    cross: function(p1, p2) {\n\n\t        return (p1 && p2) ? (((p2.x - this.x) * (p1.y - this.y)) - ((p2.y - this.y) * (p1.x - this.x))) : NaN;\n\t    },\n\n\t    difference: function(dx, dy) {\n\n\t        if ((Object(dx) === dx)) {\n\t            dy = dx.y;\n\t            dx = dx.x;\n\t        }\n\n\t        return new Point(this.x - (dx || 0), this.y - (dy || 0));\n\t    },\n\n\t    // Returns distance between me and point `p`.\n\t    distance: function(p) {\n\t        return length(this, p);\n\t    },\n\n\t    // Returns the dot product of this point with given other point\n\t    dot: function(p) {\n\n\t        return p ? (this.x * p.x + this.y * p.y) : NaN;\n\t    },\n\n\t    equals: function(p) {\n\n\t        return !!p &&\n\t            this.x === p.x &&\n\t            this.y === p.y;\n\t    },\n\n\t    // Linear interpolation\n\t    lerp: function(p, t) {\n\n\t        var x = this.x;\n\t        var y = this.y;\n\t        return new Point((1 - t) * x + t * p.x, (1 - t) * y + t * p.y);\n\t    },\n\n\t    magnitude: function() {\n\n\t        return sqrt((this.x * this.x) + (this.y * this.y)) || 0.01;\n\t    },\n\n\t    // Returns a manhattan (taxi-cab) distance between me and point `p`.\n\t    manhattanDistance: function(p) {\n\n\t        return abs(p.x - this.x) + abs(p.y - this.y);\n\t    },\n\n\t    // Move point on line starting from ref ending at me by\n\t    // distance distance.\n\t    move: function(ref, distance) {\n\n\t        var theta = toRad((new Point(ref)).theta(this));\n\t        var offset = this.offset(cos$1(theta) * distance, -sin$1(theta) * distance);\n\t        return offset;\n\t    },\n\n\t    // Scales x and y such that the distance between the point and the origin (0,0) is equal to the given length.\n\t    normalize: function(length) {\n\n\t        var scale = (length || 1) / this.magnitude();\n\t        return this.scale(scale, scale);\n\t    },\n\n\t    // Offset me by the specified amount.\n\t    offset: function(dx, dy) {\n\n\t        if ((Object(dx) === dx)) {\n\t            dy = dx.y;\n\t            dx = dx.x;\n\t        }\n\n\t        this.x += dx || 0;\n\t        this.y += dy || 0;\n\t        return this;\n\t    },\n\n\t    // Returns a point that is the reflection of me with\n\t    // the center of inversion in ref point.\n\t    reflection: function(ref) {\n\n\t        return (new Point(ref)).move(this, this.distance(ref));\n\t    },\n\n\t    // Rotate point by angle around origin.\n\t    // Angle is flipped because this is a left-handed coord system (y-axis points downward).\n\t    rotate: function(origin, angle) {\n\n\t        if (angle === 0) { return this; }\n\n\t        origin = origin || new Point(0, 0);\n\n\t        angle = toRad(normalizeAngle(-angle));\n\t        var cosAngle = cos$1(angle);\n\t        var sinAngle = sin$1(angle);\n\n\t        var x = (cosAngle * (this.x - origin.x)) - (sinAngle * (this.y - origin.y)) + origin.x;\n\t        var y = (sinAngle * (this.x - origin.x)) + (cosAngle * (this.y - origin.y)) + origin.y;\n\n\t        this.x = x;\n\t        this.y = y;\n\t        return this;\n\t    },\n\n\t    round: function(precision) {\n\n\t        var f = 1; // case 0\n\t        if (precision) {\n\t            switch (precision) {\n\t                case 1: f = 10; break;\n\t                case 2: f = 100; break;\n\t                case 3: f = 1000; break;\n\t                default: f = pow(10, precision); break;\n\t            }\n\t        }\n\n\t        this.x = round$1(this.x * f) / f;\n\t        this.y = round$1(this.y * f) / f;\n\t        return this;\n\t    },\n\n\t    // Scale point with origin.\n\t    scale: function(sx, sy, origin) {\n\n\t        origin = (origin && new Point(origin)) || new Point(0, 0);\n\t        this.x = origin.x + sx * (this.x - origin.x);\n\t        this.y = origin.y + sy * (this.y - origin.y);\n\t        return this;\n\t    },\n\n\t    snapToGrid: function(gx, gy) {\n\n\t        this.x = snapToGrid(this.x, gx);\n\t        this.y = snapToGrid(this.y, gy || gx);\n\t        return this;\n\t    },\n\n\t    squaredDistance: function(p) {\n\t        return squaredLength(this, p);\n\t    },\n\n\t    // Compute the angle between me and `p` and the x axis.\n\t    // (cartesian-to-polar coordinates conversion)\n\t    // Return theta angle in degrees.\n\t    theta: function(p) {\n\n\t        p = new Point(p);\n\n\t        // Invert the y-axis.\n\t        var y = -(p.y - this.y);\n\t        var x = p.x - this.x;\n\t        var rad = atan2$1(y, x); // defined for all 0 corner cases\n\n\t        // Correction for III. and IV. quadrant.\n\t        if (rad < 0) {\n\t            rad = 2 * PI$1 + rad;\n\t        }\n\n\t        return 180 * rad / PI$1;\n\t    },\n\n\t    toJSON: function() {\n\n\t        return { x: this.x, y: this.y };\n\t    },\n\n\t    // Converts rectangular to polar coordinates.\n\t    // An origin can be specified, otherwise it's 0@0.\n\t    toPolar: function(o) {\n\n\t        o = (o && new Point(o)) || new Point(0, 0);\n\t        var x = this.x;\n\t        var y = this.y;\n\t        this.x = sqrt((x - o.x) * (x - o.x) + (y - o.y) * (y - o.y)); // r\n\t        this.y = toRad(o.theta(new Point(x, y)));\n\t        return this;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.x + '@' + this.y;\n\t    },\n\n\t    serialize: function() {\n\n\t        return this.x + ',' + this.y;\n\t    },\n\n\t    update: function(x, y) {\n\n\t        if ((Object(x) === x)) {\n\t            y = x.y;\n\t            x = x.x;\n\t        }\n\n\t        this.x = x || 0;\n\t        this.y = y || 0;\n\t        return this;\n\t    },\n\n\t    // Compute the angle between the vector from 0,0 to me and the vector from 0,0 to p.\n\t    // Returns NaN if p is at 0,0.\n\t    vectorAngle: function(p) {\n\n\t        var zero = new Point(0, 0);\n\t        return zero.angleBetween(this, p);\n\t    }\n\t};\n\n\tPoint.prototype.translate = Point.prototype.offset;\n\n\t// For backwards compatibility:\n\tvar point = Point;\n\n\tvar max$2 = Math.max;\n\tvar min$4 = Math.min;\n\n\tvar Line = function(p1, p2) {\n\n\t    if (!(this instanceof Line)) {\n\t        return new Line(p1, p2);\n\t    }\n\n\t    if (p1 instanceof Line) {\n\t        return new Line(p1.start, p1.end);\n\t    }\n\n\t    this.start = new Point(p1);\n\t    this.end = new Point(p2);\n\t};\n\n\tLine.prototype = {\n\n\t    type: types.Line,\n\n\t    // @returns the angle of incline of the line.\n\t    angle: function() {\n\n\t        var horizontalPoint = new Point(this.start.x + 1, this.start.y);\n\t        return this.start.angleBetween(this.end, horizontalPoint);\n\t    },\n\n\t    bbox: function() {\n\n\t        var left = min$4(this.start.x, this.end.x);\n\t        var top = min$4(this.start.y, this.end.y);\n\t        var right = max$2(this.start.x, this.end.x);\n\t        var bottom = max$2(this.start.y, this.end.y);\n\n\t        return new Rect(left, top, (right - left), (bottom - top));\n\t    },\n\n\t    // @return the bearing (cardinal direction) of the line. For example N, W, or SE.\n\t    // @returns {String} One of the following bearings : NE, E, SE, S, SW, W, NW, N.\n\t    bearing: function() {\n\t        return bearing(this.start, this.end);\n\t    },\n\n\t    clone: function() {\n\n\t        return new Line(this.start, this.end);\n\t    },\n\n\t    // @return {point} the closest point on the line to point `p`\n\t    closestPoint: function(p) {\n\n\t        return this.pointAt(this.closestPointNormalizedLength(p));\n\t    },\n\n\t    closestPointLength: function(p) {\n\n\t        return this.closestPointNormalizedLength(p) * this.length();\n\t    },\n\n\t    // @return {number} the normalized length of the closest point on the line to point `p`\n\t    closestPointNormalizedLength: function(p) {\n\n\t        var product = this.vector().dot((new Line(this.start, p)).vector());\n\t        var cpNormalizedLength = min$4(1, max$2(0, product / this.squaredLength()));\n\n\t        // cpNormalizedLength returns `NaN` if this line has zero length\n\t        // we can work with that - if `NaN`, return 0\n\t        if (cpNormalizedLength !== cpNormalizedLength) { return 0; } // condition evaluates to `true` if and only if cpNormalizedLength is `NaN`\n\t        // (`NaN` is the only value that is not equal to itself)\n\n\t        return cpNormalizedLength;\n\t    },\n\n\t    closestPointTangent: function(p) {\n\n\t        return this.tangentAt(this.closestPointNormalizedLength(p));\n\t    },\n\n\t    // Returns `true` if the point lies on the line.\n\t    containsPoint: function(p) {\n\n\t        var start = this.start;\n\t        var end = this.end;\n\n\t        if (start.cross(p, end) !== 0) { return false; }\n\t        // else: cross product of 0 indicates that this line and the vector to `p` are collinear\n\n\t        var length = this.length();\n\t        if ((new Line(start, p)).length() > length) { return false; }\n\t        if ((new Line(p, end)).length() > length) { return false; }\n\t        // else: `p` lies between start and end of the line\n\n\t        return true;\n\t    },\n\n\t    // Divides the line into two at requested `ratio` between 0 and 1.\n\t    divideAt: function(ratio) {\n\n\t        var dividerPoint = this.pointAt(ratio);\n\n\t        // return array with two lines\n\t        return [\n\t            new Line(this.start, dividerPoint),\n\t            new Line(dividerPoint, this.end)\n\t        ];\n\t    },\n\n\t    // Divides the line into two at requested `length`.\n\t    divideAtLength: function(length) {\n\n\t        var dividerPoint = this.pointAtLength(length);\n\n\t        // return array with two new lines\n\t        return [\n\t            new Line(this.start, dividerPoint),\n\t            new Line(dividerPoint, this.end)\n\t        ];\n\t    },\n\n\t    equals: function(l) {\n\n\t        return !!l &&\n\t            this.start.x === l.start.x &&\n\t            this.start.y === l.start.y &&\n\t            this.end.x === l.end.x &&\n\t            this.end.y === l.end.y;\n\t    },\n\n\t    // @return {point} Point where I'm intersecting a line.\n\t    // @return [point] Points where I'm intersecting a rectangle.\n\t    // @see Squeak Smalltalk, LineSegment>>intersectionWith:\n\t    intersect: function(shape, opt) {\n\n\t        if (shape && shape.intersectionWithLine) {\n\t            var intersection = shape.intersectionWithLine(this, opt);\n\n\t            // Backwards compatibility\n\t            if (intersection && (shape instanceof Line)) {\n\t                intersection = intersection[0];\n\t            }\n\n\t            return intersection;\n\t        }\n\n\t        return null;\n\t    },\n\n\t    intersectionWithLine: function(line) {\n\n\t        var pt1Dir = new Point(this.end.x - this.start.x, this.end.y - this.start.y);\n\t        var pt2Dir = new Point(line.end.x - line.start.x, line.end.y - line.start.y);\n\t        var det = (pt1Dir.x * pt2Dir.y) - (pt1Dir.y * pt2Dir.x);\n\t        var deltaPt = new Point(line.start.x - this.start.x, line.start.y - this.start.y);\n\t        var alpha = (deltaPt.x * pt2Dir.y) - (deltaPt.y * pt2Dir.x);\n\t        var beta = (deltaPt.x * pt1Dir.y) - (deltaPt.y * pt1Dir.x);\n\n\t        if (det === 0 || alpha * det < 0 || beta * det < 0) {\n\t            // No intersection found.\n\t            return null;\n\t        }\n\n\t        if (det > 0) {\n\t            if (alpha > det || beta > det) {\n\t                return null;\n\t            }\n\n\t        } else {\n\t            if (alpha < det || beta < det) {\n\t                return null;\n\t            }\n\t        }\n\n\t        return [new Point(\n\t            this.start.x + (alpha * pt1Dir.x / det),\n\t            this.start.y + (alpha * pt1Dir.y / det)\n\t        )];\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        return !this.start.equals(this.end);\n\t    },\n\n\t    // @return {double} length of the line\n\t    length: function() {\n\t        return length(this.start, this.end);\n\t    },\n\n\t    // @return {point} my midpoint\n\t    midpoint: function() {\n\n\t        return new Point(\n\t            (this.start.x + this.end.x) / 2,\n\t            (this.start.y + this.end.y) / 2\n\t        );\n\t    },\n\n\t    parallel: function(distance) {\n\t        var l = this.clone();\n\t        if (!this.isDifferentiable()) { return l; }\n\t        var start = l.start;\n\t        var end = l.end;\n\t        var eRef = start.clone().rotate(end, 270);\n\t        var sRef = end.clone().rotate(start, 90);\n\t        start.move(sRef, distance);\n\t        end.move(eRef, distance);\n\t        return l;\n\t    },\n\n\t    // @return {point} my point at 't' <0,1>\n\t    pointAt: function(t) {\n\n\t        var start = this.start;\n\t        var end = this.end;\n\n\t        if (t <= 0) { return start.clone(); }\n\t        if (t >= 1) { return end.clone(); }\n\n\t        return start.lerp(end, t);\n\t    },\n\n\t    pointAtLength: function(length) {\n\n\t        var start = this.start;\n\t        var end = this.end;\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        var lineLength = this.length();\n\t        if (length >= lineLength) { return (fromStart ? end.clone() : start.clone()); }\n\n\t        return this.pointAt((fromStart ? (length) : (lineLength - length)) / lineLength);\n\t    },\n\n\t    // @return {number} the offset of the point `p` from the line. + if the point `p` is on the right side of the line, - if on the left and 0 if on the line.\n\t    pointOffset: function(p) {\n\n\t        // Find the sign of the determinant of vectors (start,end), where p is the query point.\n\t        p = new Point(p);\n\t        var start = this.start;\n\t        var end = this.end;\n\t        var determinant = ((end.x - start.x) * (p.y - start.y) - (end.y - start.y) * (p.x - start.x));\n\n\t        return determinant / this.length();\n\t    },\n\n\t    rotate: function(origin, angle) {\n\n\t        this.start.rotate(origin, angle);\n\t        this.end.rotate(origin, angle);\n\t        return this;\n\t    },\n\n\t    round: function(precision) {\n\n\t        this.start.round(precision);\n\t        this.end.round(precision);\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        this.start.scale(sx, sy, origin);\n\t        this.end.scale(sx, sy, origin);\n\t        return this;\n\t    },\n\n\t    // @return {number} scale the line so that it has the requested length\n\t    setLength: function(length) {\n\n\t        var currentLength = this.length();\n\t        if (!currentLength) { return this; }\n\n\t        var scaleFactor = length / currentLength;\n\t        return this.scale(scaleFactor, scaleFactor, this.start);\n\t    },\n\n\t    // @return {integer} length without sqrt\n\t    // @note for applications where the exact length is not necessary (e.g. compare only)\n\t    squaredLength: function() {\n\t        return squaredLength(this.start, this.end);\n\t    },\n\n\t    tangentAt: function(t) {\n\n\t        if (!this.isDifferentiable()) { return null; }\n\n\t        var start = this.start;\n\t        var end = this.end;\n\n\t        var tangentStart = this.pointAt(t); // constrains `t` between 0 and 1\n\n\t        var tangentLine = new Line(start, end);\n\t        tangentLine.translate(tangentStart.x - start.x, tangentStart.y - start.y); // move so that tangent line starts at the point requested\n\n\t        return tangentLine;\n\t    },\n\n\t    tangentAtLength: function(length) {\n\n\t        if (!this.isDifferentiable()) { return null; }\n\n\t        var start = this.start;\n\t        var end = this.end;\n\n\t        var tangentStart = this.pointAtLength(length);\n\n\t        var tangentLine = new Line(start, end);\n\t        tangentLine.translate(tangentStart.x - start.x, tangentStart.y - start.y); // move so that tangent line starts at the point requested\n\n\t        return tangentLine;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.start.toString() + ' ' + this.end.toString();\n\t    },\n\n\t    serialize: function() {\n\n\t        return this.start.serialize() + ' ' + this.end.serialize();\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        this.start.translate(tx, ty);\n\t        this.end.translate(tx, ty);\n\t        return this;\n\t    },\n\n\t    // @return vector {point} of the line\n\t    vector: function() {\n\n\t        return new Point(this.end.x - this.start.x, this.end.y - this.start.y);\n\t    }\n\t};\n\n\t// For backwards compatibility:\n\tLine.prototype.intersection = Line.prototype.intersect;\n\n\n\t// For backwards compatibility:\n\tvar line = Line;\n\n\tvar sqrt$1 = Math.sqrt;\n\tvar round$2 = Math.round;\n\tvar pow$1 = Math.pow;\n\n\tvar Ellipse = function(c, a, b) {\n\n\t    if (!(this instanceof Ellipse)) {\n\t        return new Ellipse(c, a, b);\n\t    }\n\n\t    if (c instanceof Ellipse) {\n\t        return new Ellipse(new Point(c.x, c.y), c.a, c.b);\n\t    }\n\n\t    c = new Point(c);\n\t    this.x = c.x;\n\t    this.y = c.y;\n\t    this.a = a;\n\t    this.b = b;\n\t};\n\n\tEllipse.fromRect = function(rect) {\n\n\t    rect = new Rect(rect);\n\t    return new Ellipse(rect.center(), rect.width / 2, rect.height / 2);\n\t};\n\n\tEllipse.prototype = {\n\n\t    type: types.Ellipse,\n\n\t    bbox: function() {\n\n\t        return new Rect(this.x - this.a, this.y - this.b, 2 * this.a, 2 * this.b);\n\t    },\n\n\t    /**\n\t     * @returns {g.Point}\n\t     */\n\t    center: function() {\n\n\t        return new Point(this.x, this.y);\n\t    },\n\n\t    clone: function() {\n\n\t        return new Ellipse(this);\n\t    },\n\n\t    /**\n\t     * @param {g.Point} p\n\t     * @returns {boolean}\n\t     */\n\t    containsPoint: function(p) {\n\n\t        return this.normalizedDistance(p) <= 1;\n\t    },\n\n\t    equals: function(ellipse) {\n\n\t        return !!ellipse &&\n\t            ellipse.x === this.x &&\n\t            ellipse.y === this.y &&\n\t            ellipse.a === this.a &&\n\t            ellipse.b === this.b;\n\t    },\n\n\t    // inflate by dx and dy\n\t    // @param dx {delta_x} representing additional size to x\n\t    // @param dy {delta_y} representing additional size to y -\n\t    // dy param is not required -> in that case y is sized by dx\n\t    inflate: function(dx, dy) {\n\t        if (dx === undefined) {\n\t            dx = 0;\n\t        }\n\n\t        if (dy === undefined) {\n\t            dy = dx;\n\t        }\n\n\t        this.a += 2 * dx;\n\t        this.b += 2 * dy;\n\n\t        return this;\n\t    },\n\n\t    intersectionWithLine: function(line) {\n\n\t        var intersections = [];\n\t        var a1 = line.start;\n\t        var a2 = line.end;\n\t        var rx = this.a;\n\t        var ry = this.b;\n\t        var dir = line.vector();\n\t        var diff = a1.difference(new Point(this));\n\t        var mDir = new Point(dir.x / (rx * rx), dir.y / (ry * ry));\n\t        var mDiff = new Point(diff.x / (rx * rx), diff.y / (ry * ry));\n\n\t        var a = dir.dot(mDir);\n\t        var b = dir.dot(mDiff);\n\t        var c = diff.dot(mDiff) - 1.0;\n\t        var d = b * b - a * c;\n\n\t        if (d < 0) {\n\t            return null;\n\t        } else if (d > 0) {\n\t            var root = sqrt$1(d);\n\t            var ta = (-b - root) / a;\n\t            var tb = (-b + root) / a;\n\n\t            if ((ta < 0 || 1 < ta) && (tb < 0 || 1 < tb)) {\n\t                // if ((ta < 0 && tb < 0) || (ta > 1 && tb > 1)) outside else inside\n\t                return null;\n\t            } else {\n\t                if (0 <= ta && ta <= 1) { intersections.push(a1.lerp(a2, ta)); }\n\t                if (0 <= tb && tb <= 1) { intersections.push(a1.lerp(a2, tb)); }\n\t            }\n\t        } else {\n\t            var t = -b / a;\n\t            if (0 <= t && t <= 1) {\n\t                intersections.push(a1.lerp(a2, t));\n\t            } else {\n\t                // outside\n\t                return null;\n\t            }\n\t        }\n\n\t        return intersections;\n\t    },\n\n\t    // Find point on me where line from my center to\n\t    // point p intersects my boundary.\n\t    // @param {number} angle If angle is specified, intersection with rotated ellipse is computed.\n\t    intersectionWithLineFromCenterToPoint: function(p, angle) {\n\n\t        p = new Point(p);\n\n\t        if (angle) { p.rotate(new Point(this.x, this.y), angle); }\n\n\t        var dx = p.x - this.x;\n\t        var dy = p.y - this.y;\n\t        var result;\n\n\t        if (dx === 0) {\n\t            result = this.bbox().pointNearestToPoint(p);\n\t            if (angle) { return result.rotate(new Point(this.x, this.y), -angle); }\n\t            return result;\n\t        }\n\n\t        var m = dy / dx;\n\t        var mSquared = m * m;\n\t        var aSquared = this.a * this.a;\n\t        var bSquared = this.b * this.b;\n\n\t        var x = sqrt$1(1 / ((1 / aSquared) + (mSquared / bSquared)));\n\t        x = dx < 0 ? -x : x;\n\n\t        var y = m * x;\n\t        result = new Point(this.x + x, this.y + y);\n\n\t        if (angle) { return result.rotate(new Point(this.x, this.y), -angle); }\n\t        return result;\n\t    },\n\n\t    /**\n\t     * @param {g.Point} point\n\t     * @returns {number} result < 1 - inside ellipse, result == 1 - on ellipse boundary, result > 1 - outside\n\t     */\n\t    normalizedDistance: function(point) {\n\n\t        var x0 = point.x;\n\t        var y0 = point.y;\n\t        var a = this.a;\n\t        var b = this.b;\n\t        var x = this.x;\n\t        var y = this.y;\n\n\t        return ((x0 - x) * (x0 - x)) / (a * a) + ((y0 - y) * (y0 - y)) / (b * b);\n\t    },\n\n\t    round: function(precision) {\n\n\t        var f = 1; // case 0\n\t        if (precision) {\n\t            switch (precision) {\n\t                case 1: f = 10; break;\n\t                case 2: f = 100; break;\n\t                case 3: f = 1000; break;\n\t                default: f = pow$1(10, precision); break;\n\t            }\n\t        }\n\n\t        this.x = round$2(this.x * f) / f;\n\t        this.y = round$2(this.y * f) / f;\n\t        this.a = round$2(this.a * f) / f;\n\t        this.b = round$2(this.b * f) / f;\n\t        return this;\n\t    },\n\n\t    /** Compute angle between tangent and x axis\n\t     * @param {g.Point} p Point of tangency, it has to be on ellipse boundaries.\n\t     * @returns {number} angle between tangent and x axis\n\t     */\n\t    tangentTheta: function(p) {\n\n\t        var refPointDelta = 30;\n\t        var x0 = p.x;\n\t        var y0 = p.y;\n\t        var a = this.a;\n\t        var b = this.b;\n\t        var center = this.bbox().center();\n\t        var m = center.x;\n\t        var n = center.y;\n\n\t        var q1 = x0 > center.x + a / 2;\n\t        var q3 = x0 < center.x - a / 2;\n\n\t        var y, x;\n\t        if (q1 || q3) {\n\t            y = x0 > center.x ? y0 - refPointDelta : y0 + refPointDelta;\n\t            x = (a * a / (x0 - m)) - (a * a * (y0 - n) * (y - n)) / (b * b * (x0 - m)) + m;\n\n\t        } else {\n\t            x = y0 > center.y ? x0 + refPointDelta : x0 - refPointDelta;\n\t            y = (b * b / (y0 - n)) - (b * b * (x0 - m) * (x - m)) / (a * a * (y0 - n)) + n;\n\t        }\n\n\t        return (new Point(x, y)).theta(p);\n\n\t    },\n\n\t    toString: function() {\n\n\t        return (new Point(this.x, this.y)).toString() + ' ' + this.a + ' ' + this.b;\n\t    }\n\t};\n\n\t// For backwards compatibility:\n\tvar ellipse = Ellipse;\n\n\tvar abs$1 = Math.abs;\n\tvar cos$2 = Math.cos;\n\tvar sin$2 = Math.sin;\n\tvar min$5 = Math.min;\n\tvar max$3 = Math.max;\n\tvar round$3 = Math.round;\n\tvar pow$2 = Math.pow;\n\n\tvar Rect = function(x, y, w, h) {\n\n\t    if (!(this instanceof Rect)) {\n\t        return new Rect(x, y, w, h);\n\t    }\n\n\t    if ((Object(x) === x)) {\n\t        y = x.y;\n\t        w = x.width;\n\t        h = x.height;\n\t        x = x.x;\n\t    }\n\n\t    this.x = x === undefined ? 0 : x;\n\t    this.y = y === undefined ? 0 : y;\n\t    this.width = w === undefined ? 0 : w;\n\t    this.height = h === undefined ? 0 : h;\n\t};\n\n\tRect.fromEllipse = function(e) {\n\n\t    e = new Ellipse(e);\n\t    return new Rect(e.x - e.a, e.y - e.b, 2 * e.a, 2 * e.b);\n\t};\n\n\tRect.fromPointUnion = function() {\n\t    var points = [], len = arguments.length;\n\t    while ( len-- ) points[ len ] = arguments[ len ];\n\n\n\t    if (points.length === 0) { return null; }\n\n\t    var p = new Point();\n\t    var minX, minY, maxX, maxY;\n\t    minX = minY = Infinity;\n\t    maxX = maxY = -Infinity;\n\n\t    for (var i = 0; i < points.length; i++) {\n\t        p.update(points[i]);\n\t        var x = p.x;\n\t        var y = p.y;\n\n\t        if (x < minX) { minX = x; }\n\t        if (x > maxX) { maxX = x; }\n\t        if (y < minY) { minY = y; }\n\t        if (y > maxY) { maxY = y; }\n\t    }\n\n\t    return new Rect(minX, minY, maxX - minX, maxY - minY);\n\t};\n\n\tRect.fromRectUnion = function() {\n\t    var rects = [], len = arguments.length;\n\t    while ( len-- ) rects[ len ] = arguments[ len ];\n\n\n\t    if (rects.length === 0) { return null; }\n\n\t    var r = new Rect();\n\t    var minX, minY, maxX, maxY;\n\t    minX = minY = Infinity;\n\t    maxX = maxY = -Infinity;\n\n\t    for (var i = 0; i < rects.length; i++) {\n\t        r.update(rects[i]);\n\t        var x = r.x;\n\t        var y = r.y;\n\t        var mX = x + r.width;\n\t        var mY = y + r.height;\n\n\t        if (x < minX) { minX = x; }\n\t        if (mX > maxX) { maxX = mX; }\n\t        if (y < minY) { minY = y; }\n\t        if (mY > maxY) { maxY = mY; }\n\t    }\n\n\t    return new Rect(minX, minY, maxX - minX, maxY - minY);\n\t};\n\n\tRect.prototype = {\n\n\t    type: types.Rect,\n\n\t    // Find my bounding box when I'm rotated with the center of rotation in the center of me.\n\t    // @return r {rectangle} representing a bounding box\n\t    bbox: function(angle) {\n\t        return this.clone().rotateAroundCenter(angle);\n\t    },\n\n\t    rotateAroundCenter: function(angle) {\n\t        if (!angle) { return this; }\n\t        var ref = this;\n\t        var width = ref.width;\n\t        var height = ref.height;\n\t        var theta = toRad(angle);\n\t        var st = abs$1(sin$2(theta));\n\t        var ct = abs$1(cos$2(theta));\n\t        var w = width * ct + height * st;\n\t        var h = width * st + height * ct;\n\t        this.x += (width - w) / 2;\n\t        this.y += (height - h) / 2;\n\t        this.width = w;\n\t        this.height = h;\n\t        return this;\n\t    },\n\n\t    bottomLeft: function() {\n\n\t        return new Point(this.x, this.y + this.height);\n\t    },\n\n\t    bottomLine: function() {\n\n\t        return new Line(this.bottomLeft(), this.bottomRight());\n\t    },\n\n\t    bottomMiddle: function() {\n\n\t        return new Point(this.x + this.width / 2, this.y + this.height);\n\t    },\n\n\t    center: function() {\n\n\t        return new Point(this.x + this.width / 2, this.y + this.height / 2);\n\t    },\n\n\t    clone: function() {\n\n\t        return new Rect(this);\n\t    },\n\n\t    // @return {bool} true if point p is inside me.\n\t    containsPoint: function(p) {\n\t        p = new Point(p);\n\t        return p.x >= this.x && p.x <= this.x + this.width && p.y >= this.y && p.y <= this.y + this.height;\n\t    },\n\n\t    // @return {bool} true if rectangle `r` is inside me.\n\t    containsRect: function(r) {\n\n\t        var r0 = new Rect(this).normalize();\n\t        var r1 = new Rect(r).normalize();\n\t        var w0 = r0.width;\n\t        var h0 = r0.height;\n\t        var w1 = r1.width;\n\t        var h1 = r1.height;\n\n\t        if (!w0 || !h0 || !w1 || !h1) {\n\t            // At least one of the dimensions is 0\n\t            return false;\n\t        }\n\n\t        var x0 = r0.x;\n\t        var y0 = r0.y;\n\t        var x1 = r1.x;\n\t        var y1 = r1.y;\n\n\t        w1 += x1;\n\t        w0 += x0;\n\t        h1 += y1;\n\t        h0 += y0;\n\n\t        return x0 <= x1 && w1 <= w0 && y0 <= y1 && h1 <= h0;\n\t    },\n\n\t    corner: function() {\n\n\t        return new Point(this.x + this.width, this.y + this.height);\n\t    },\n\n\t    // @return {boolean} true if rectangles are equal.\n\t    equals: function(r) {\n\n\t        var mr = (new Rect(this)).normalize();\n\t        var nr = (new Rect(r)).normalize();\n\t        return mr.x === nr.x && mr.y === nr.y && mr.width === nr.width && mr.height === nr.height;\n\t    },\n\n\t    // inflate by dx and dy, recompute origin [x, y]\n\t    // @param dx {delta_x} representing additional size to x\n\t    // @param dy {delta_y} representing additional size to y -\n\t    // dy param is not required -> in that case y is sized by dx\n\t    inflate: function(dx, dy) {\n\n\t        if (dx === undefined) {\n\t            dx = 0;\n\t        }\n\n\t        if (dy === undefined) {\n\t            dy = dx;\n\t        }\n\n\t        this.x -= dx;\n\t        this.y -= dy;\n\t        this.width += 2 * dx;\n\t        this.height += 2 * dy;\n\n\t        return this;\n\t    },\n\n\t    // @return {rect} if rectangles intersect, {null} if not.\n\t    intersect: function(r) {\n\n\t        var myOrigin = this.origin();\n\t        var myCorner = this.corner();\n\t        var rOrigin = r.origin();\n\t        var rCorner = r.corner();\n\n\t        // No intersection found\n\t        if (rCorner.x <= myOrigin.x ||\n\t            rCorner.y <= myOrigin.y ||\n\t            rOrigin.x >= myCorner.x ||\n\t            rOrigin.y >= myCorner.y) { return null; }\n\n\t        var x = max$3(myOrigin.x, rOrigin.x);\n\t        var y = max$3(myOrigin.y, rOrigin.y);\n\n\t        return new Rect(x, y, min$5(myCorner.x, rCorner.x) - x, min$5(myCorner.y, rCorner.y) - y);\n\t    },\n\n\t    intersectionWithLine: function(line) {\n\n\t        var r = this;\n\t        var rectLines = [r.topLine(), r.rightLine(), r.bottomLine(), r.leftLine()];\n\t        var points = [];\n\t        var dedupeArr = [];\n\t        var pt, i;\n\n\t        var n = rectLines.length;\n\t        for (i = 0; i < n; i++) {\n\n\t            pt = line.intersect(rectLines[i]);\n\t            if (pt !== null && dedupeArr.indexOf(pt.toString()) < 0) {\n\t                points.push(pt);\n\t                dedupeArr.push(pt.toString());\n\t            }\n\t        }\n\n\t        return points.length > 0 ? points : null;\n\t    },\n\n\t    // Find point on my boundary where line starting\n\t    // from my center ending in point p intersects me.\n\t    // @param {number} angle If angle is specified, intersection with rotated rectangle is computed.\n\t    intersectionWithLineFromCenterToPoint: function(p, angle) {\n\n\t        p = new Point(p);\n\t        var center = new Point(this.x + this.width / 2, this.y + this.height / 2);\n\t        var result;\n\n\t        if (angle) { p.rotate(center, angle); }\n\n\t        // (clockwise, starting from the top side)\n\t        var sides = [\n\t            this.topLine(),\n\t            this.rightLine(),\n\t            this.bottomLine(),\n\t            this.leftLine()\n\t        ];\n\t        var connector = new Line(center, p);\n\n\t        for (var i = sides.length - 1; i >= 0; --i) {\n\t            var intersection = sides[i].intersection(connector);\n\t            if (intersection !== null) {\n\t                result = intersection;\n\t                break;\n\t            }\n\t        }\n\t        if (result && angle) { result.rotate(center, -angle); }\n\t        return result;\n\t    },\n\n\t    leftLine: function() {\n\n\t        return new Line(this.topLeft(), this.bottomLeft());\n\t    },\n\n\t    leftMiddle: function() {\n\n\t        return new Point(this.x, this.y + this.height / 2);\n\t    },\n\n\t    maxRectScaleToFit: function(rect, origin) {\n\n\t        rect = new Rect(rect);\n\t        origin || (origin = rect.center());\n\n\t        var sx1, sx2, sx3, sx4, sy1, sy2, sy3, sy4;\n\t        var ox = origin.x;\n\t        var oy = origin.y;\n\n\t        // Here we find the maximal possible scale for all corner points (for x and y axis) of the rectangle,\n\t        // so when the scale is applied the point is still inside the rectangle.\n\n\t        sx1 = sx2 = sx3 = sx4 = sy1 = sy2 = sy3 = sy4 = Infinity;\n\n\t        // Top Left\n\t        var p1 = rect.topLeft();\n\t        if (p1.x < ox) {\n\t            sx1 = (this.x - ox) / (p1.x - ox);\n\t        }\n\t        if (p1.y < oy) {\n\t            sy1 = (this.y - oy) / (p1.y - oy);\n\t        }\n\t        // Bottom Right\n\t        var p2 = rect.bottomRight();\n\t        if (p2.x > ox) {\n\t            sx2 = (this.x + this.width - ox) / (p2.x - ox);\n\t        }\n\t        if (p2.y > oy) {\n\t            sy2 = (this.y + this.height - oy) / (p2.y - oy);\n\t        }\n\t        // Top Right\n\t        var p3 = rect.topRight();\n\t        if (p3.x > ox) {\n\t            sx3 = (this.x + this.width - ox) / (p3.x - ox);\n\t        }\n\t        if (p3.y < oy) {\n\t            sy3 = (this.y - oy) / (p3.y - oy);\n\t        }\n\t        // Bottom Left\n\t        var p4 = rect.bottomLeft();\n\t        if (p4.x < ox) {\n\t            sx4 = (this.x - ox) / (p4.x - ox);\n\t        }\n\t        if (p4.y > oy) {\n\t            sy4 = (this.y + this.height - oy) / (p4.y - oy);\n\t        }\n\n\t        return {\n\t            sx: min$5(sx1, sx2, sx3, sx4),\n\t            sy: min$5(sy1, sy2, sy3, sy4)\n\t        };\n\t    },\n\n\t    maxRectUniformScaleToFit: function(rect, origin) {\n\n\t        var scale = this.maxRectScaleToFit(rect, origin);\n\t        return min$5(scale.sx, scale.sy);\n\t    },\n\n\t    // Move and expand me.\n\t    // @param r {rectangle} representing deltas\n\t    moveAndExpand: function(r) {\n\n\t        this.x += r.x || 0;\n\t        this.y += r.y || 0;\n\t        this.width += r.width || 0;\n\t        this.height += r.height || 0;\n\t        return this;\n\t    },\n\n\t    // Normalize the rectangle; i.e., make it so that it has a non-negative width and height.\n\t    // If width < 0 the function swaps the left and right corners,\n\t    // and it swaps the top and bottom corners if height < 0\n\t    // like in http://qt-project.org/doc/qt-4.8/qrectf.html#normalized\n\t    normalize: function() {\n\n\t        var newx = this.x;\n\t        var newy = this.y;\n\t        var newwidth = this.width;\n\t        var newheight = this.height;\n\t        if (this.width < 0) {\n\t            newx = this.x + this.width;\n\t            newwidth = -this.width;\n\t        }\n\t        if (this.height < 0) {\n\t            newy = this.y + this.height;\n\t            newheight = -this.height;\n\t        }\n\t        this.x = newx;\n\t        this.y = newy;\n\t        this.width = newwidth;\n\t        this.height = newheight;\n\t        return this;\n\t    },\n\n\t    // Offset me by the specified amount.\n\t    offset: function(dx, dy) {\n\n\t        // pretend that this is a point and call offset()\n\t        // rewrites x and y according to dx and dy\n\t        return Point.prototype.offset.call(this, dx, dy);\n\t    },\n\n\t    origin: function() {\n\n\t        return new Point(this.x, this.y);\n\t    },\n\n\t    // @return {point} a point on my boundary nearest to the given point.\n\t    // @see Squeak Smalltalk, Rectangle>>pointNearestTo:\n\t    pointNearestToPoint: function(point) {\n\n\t        point = new Point(point);\n\t        if (this.containsPoint(point)) {\n\t            var side = this.sideNearestToPoint(point);\n\t            switch (side) {\n\t                case 'right':\n\t                    return new Point(this.x + this.width, point.y);\n\t                case 'left':\n\t                    return new Point(this.x, point.y);\n\t                case 'bottom':\n\t                    return new Point(point.x, this.y + this.height);\n\t                case 'top':\n\t                    return new Point(point.x, this.y);\n\t            }\n\t        }\n\t        return point.adhereToRect(this);\n\t    },\n\n\t    rightLine: function() {\n\n\t        return new Line(this.topRight(), this.bottomRight());\n\t    },\n\n\t    rightMiddle: function() {\n\n\t        return new Point(this.x + this.width, this.y + this.height / 2);\n\t    },\n\n\t    round: function(precision) {\n\n\t        var f = 1; // case 0\n\t        if (precision) {\n\t            switch (precision) {\n\t                case 1: f = 10; break;\n\t                case 2: f = 100; break;\n\t                case 3: f = 1000; break;\n\t                default: f = pow$2(10, precision); break;\n\t            }\n\t        }\n\n\t        this.x = round$3(this.x * f) / f;\n\t        this.y = round$3(this.y * f) / f;\n\t        this.width = round$3(this.width * f) / f;\n\t        this.height = round$3(this.height * f) / f;\n\t        return this;\n\t    },\n\n\t    // Scale rectangle with origin.\n\t    scale: function(sx, sy, origin) {\n\n\t        origin = this.origin().scale(sx, sy, origin);\n\t        this.x = origin.x;\n\t        this.y = origin.y;\n\t        this.width *= sx;\n\t        this.height *= sy;\n\t        return this;\n\t    },\n\n\t    // @return {string} (left|right|top|bottom) side which is nearest to point\n\t    // @see Squeak Smalltalk, Rectangle>>sideNearestTo:\n\t    sideNearestToPoint: function(point) {\n\n\t        point = new Point(point);\n\t        var distToLeft = point.x - this.x;\n\t        var distToRight = (this.x + this.width) - point.x;\n\t        var distToTop = point.y - this.y;\n\t        var distToBottom = (this.y + this.height) - point.y;\n\t        var closest = distToLeft;\n\t        var side = 'left';\n\n\t        if (distToRight < closest) {\n\t            closest = distToRight;\n\t            side = 'right';\n\t        }\n\t        if (distToTop < closest) {\n\t            closest = distToTop;\n\t            side = 'top';\n\t        }\n\t        if (distToBottom < closest) {\n\t            // closest = distToBottom;\n\t            side = 'bottom';\n\t        }\n\t        return side;\n\t    },\n\n\t    snapToGrid: function(gx, gy) {\n\n\t        var origin = this.origin().snapToGrid(gx, gy);\n\t        var corner = this.corner().snapToGrid(gx, gy);\n\t        this.x = origin.x;\n\t        this.y = origin.y;\n\t        this.width = corner.x - origin.x;\n\t        this.height = corner.y - origin.y;\n\t        return this;\n\t    },\n\n\t    toJSON: function() {\n\n\t        return { x: this.x, y: this.y, width: this.width, height: this.height };\n\t    },\n\n\t    topLine: function() {\n\n\t        return new Line(this.topLeft(), this.topRight());\n\t    },\n\n\t    topMiddle: function() {\n\n\t        return new Point(this.x + this.width / 2, this.y);\n\t    },\n\n\t    topRight: function() {\n\n\t        return new Point(this.x + this.width, this.y);\n\t    },\n\n\t    toString: function() {\n\n\t        return this.origin().toString() + ' ' + this.corner().toString();\n\t    },\n\n\t    // @return {rect} representing the union of both rectangles.\n\t    union: function(rect) {\n\n\t        return Rect.fromRectUnion(this, rect);\n\t    },\n\n\t    update: function(x, y, w, h) {\n\n\t        if ((Object(x) === x)) {\n\t            y = x.y;\n\t            w = x.width;\n\t            h = x.height;\n\t            x = x.x;\n\t        }\n\n\t        this.x = x || 0;\n\t        this.y = y || 0;\n\t        this.width = w || 0;\n\t        this.height = h || 0;\n\t        return this;\n\t    }\n\t};\n\n\tRect.prototype.bottomRight = Rect.prototype.corner;\n\n\tRect.prototype.topLeft = Rect.prototype.origin;\n\n\tRect.prototype.translate = Rect.prototype.offset;\n\n\t// For backwards compatibility:\n\tvar rect = Rect;\n\n\tfunction parsePoints(svgString) {\n\t    svgString = svgString.trim();\n\t    if (svgString === '') { return []; }\n\t    var points = [];\n\t    var coords = svgString.split(/\\s*,\\s*|\\s+/);\n\t    var n = coords.length;\n\t    for (var i = 0; i < n; i += 2) {\n\t        points.push({ x: +coords[i], y: +coords[i + 1] });\n\t    }\n\t    return points;\n\t}\n\n\tfunction clonePoints(points) {\n\t    var numPoints = points.length;\n\t    if (numPoints === 0) { return []; }\n\t    var newPoints = [];\n\t    for (var i = 0; i < numPoints; i++) {\n\t        var point = points[i].clone();\n\t        newPoints.push(point);\n\t    }\n\t    return newPoints;\n\t}\n\n\t// Returns a convex-hull polyline from this polyline.\n\t// Implements the Graham scan (https://en.wikipedia.org/wiki/Graham_scan).\n\t// Output polyline starts at the first element of the original polyline that is on the hull, then continues clockwise.\n\t// Minimal polyline is found (only vertices of the hull are reported, no collinear points).\n\tfunction convexHull(points) {\n\n\t    var abs = Math.abs;\n\n\t    var i;\n\t    var n;\n\n\t    var numPoints = points.length;\n\t    if (numPoints === 0) { return []; } // if points array is empty\n\n\t    // step 1: find the starting point - point with the lowest y (if equality, highest x)\n\t    var startPoint;\n\t    for (i = 0; i < numPoints; i++) {\n\t        if (startPoint === undefined) {\n\t            // if this is the first point we see, set it as start point\n\t            startPoint = points[i];\n\n\t        } else if (points[i].y < startPoint.y) {\n\t            // start point should have lowest y from all points\n\t            startPoint = points[i];\n\n\t        } else if ((points[i].y === startPoint.y) && (points[i].x > startPoint.x)) {\n\t            // if two points have the lowest y, choose the one that has highest x\n\t            // there are no points to the right of startPoint - no ambiguity about theta 0\n\t            // if there are several coincident start point candidates, first one is reported\n\t            startPoint = points[i];\n\t        }\n\t    }\n\n\t    // step 2: sort the list of points\n\t    // sorting by angle between line from startPoint to point and the x-axis (theta)\n\n\t    // step 2a: create the point records = [point, originalIndex, angle]\n\t    var sortedPointRecords = [];\n\t    for (i = 0; i < numPoints; i++) {\n\n\t        var angle = startPoint.theta(points[i]);\n\t        if (angle === 0) {\n\t            angle = 360; // give highest angle to start point\n\t            // the start point will end up at end of sorted list\n\t            // the start point will end up at beginning of hull points list\n\t        }\n\n\t        var entry = [points[i], i, angle];\n\t        sortedPointRecords.push(entry);\n\t    }\n\n\t    // step 2b: sort the list in place\n\t    sortedPointRecords.sort(function(record1, record2) {\n\t        // returning a negative number here sorts record1 before record2\n\t        // if first angle is smaller than second, first angle should come before second\n\n\t        var sortOutput = record1[2] - record2[2];  // negative if first angle smaller\n\t        if (sortOutput === 0) {\n\t            // if the two angles are equal, sort by originalIndex\n\t            sortOutput = record2[1] - record1[1]; // negative if first index larger\n\t            // coincident points will be sorted in reverse-numerical order\n\t            // so the coincident points with lower original index will be considered first\n\t        }\n\n\t        return sortOutput;\n\t    });\n\n\t    // step 2c: duplicate start record from the top of the stack to the bottom of the stack\n\t    if (sortedPointRecords.length > 2) {\n\t        var startPointRecord = sortedPointRecords[sortedPointRecords.length - 1];\n\t        sortedPointRecords.unshift(startPointRecord);\n\t    }\n\n\t    // step 3a: go through sorted points in order and find those with right turns\n\t    // we want to get our results in clockwise order\n\t    var insidePoints = {}; // dictionary of points with left turns - cannot be on the hull\n\t    var hullPointRecords = []; // stack of records with right turns - hull point candidates\n\n\t    var currentPointRecord;\n\t    var currentPoint;\n\t    var lastHullPointRecord;\n\t    var lastHullPoint;\n\t    var secondLastHullPointRecord;\n\t    var secondLastHullPoint;\n\t    while (sortedPointRecords.length !== 0) {\n\n\t        currentPointRecord = sortedPointRecords.pop();\n\t        currentPoint = currentPointRecord[0];\n\n\t        // check if point has already been discarded\n\t        // keys for insidePoints are stored in the form 'point.x@point.y@@originalIndex'\n\t        if (insidePoints.hasOwnProperty(currentPointRecord[0] + '@@' + currentPointRecord[1])) {\n\t            // this point had an incorrect turn at some previous iteration of this loop\n\t            // this disqualifies it from possibly being on the hull\n\t            continue;\n\t        }\n\n\t        var correctTurnFound = false;\n\t        while (!correctTurnFound) {\n\n\t            if (hullPointRecords.length < 2) {\n\t                // not enough points for comparison, just add current point\n\t                hullPointRecords.push(currentPointRecord);\n\t                correctTurnFound = true;\n\n\t            } else {\n\t                lastHullPointRecord = hullPointRecords.pop();\n\t                lastHullPoint = lastHullPointRecord[0];\n\t                secondLastHullPointRecord = hullPointRecords.pop();\n\t                secondLastHullPoint = secondLastHullPointRecord[0];\n\n\t                var crossProduct = secondLastHullPoint.cross(lastHullPoint, currentPoint);\n\n\t                if (crossProduct < 0) {\n\t                    // found a right turn\n\t                    hullPointRecords.push(secondLastHullPointRecord);\n\t                    hullPointRecords.push(lastHullPointRecord);\n\t                    hullPointRecords.push(currentPointRecord);\n\t                    correctTurnFound = true;\n\n\t                } else if (crossProduct === 0) {\n\t                    // the three points are collinear\n\t                    // three options:\n\t                    // there may be a 180 or 0 degree angle at lastHullPoint\n\t                    // or two of the three points are coincident\n\t                    var THRESHOLD = 1e-10; // we have to take rounding errors into account\n\t                    var angleBetween = lastHullPoint.angleBetween(secondLastHullPoint, currentPoint);\n\t                    if (abs(angleBetween - 180) < THRESHOLD) { // rounding around 180 to 180\n\t                        // if the cross product is 0 because the angle is 180 degrees\n\t                        // discard last hull point (add to insidePoints)\n\t                        //insidePoints.unshift(lastHullPoint);\n\t                        insidePoints[lastHullPointRecord[0] + '@@' + lastHullPointRecord[1]] = lastHullPoint;\n\t                        // reenter second-to-last hull point (will be last at next iter)\n\t                        hullPointRecords.push(secondLastHullPointRecord);\n\t                        // do not do anything with current point\n\t                        // correct turn not found\n\n\t                    } else if (lastHullPoint.equals(currentPoint) || secondLastHullPoint.equals(lastHullPoint)) {\n\t                        // if the cross product is 0 because two points are the same\n\t                        // discard last hull point (add to insidePoints)\n\t                        //insidePoints.unshift(lastHullPoint);\n\t                        insidePoints[lastHullPointRecord[0] + '@@' + lastHullPointRecord[1]] = lastHullPoint;\n\t                        // reenter second-to-last hull point (will be last at next iter)\n\t                        hullPointRecords.push(secondLastHullPointRecord);\n\t                        // do not do anything with current point\n\t                        // correct turn not found\n\n\t                    } else if (abs(((angleBetween + 1) % 360) - 1) < THRESHOLD) { // rounding around 0 and 360 to 0\n\t                        // if the cross product is 0 because the angle is 0 degrees\n\t                        // remove last hull point from hull BUT do not discard it\n\t                        // reenter second-to-last hull point (will be last at next iter)\n\t                        hullPointRecords.push(secondLastHullPointRecord);\n\t                        // put last hull point back into the sorted point records list\n\t                        sortedPointRecords.push(lastHullPointRecord);\n\t                        // we are switching the order of the 0deg and 180deg points\n\t                        // correct turn not found\n\t                    }\n\n\t                } else {\n\t                    // found a left turn\n\t                    // discard last hull point (add to insidePoints)\n\t                    //insidePoints.unshift(lastHullPoint);\n\t                    insidePoints[lastHullPointRecord[0] + '@@' + lastHullPointRecord[1]] = lastHullPoint;\n\t                    // reenter second-to-last hull point (will be last at next iter of loop)\n\t                    hullPointRecords.push(secondLastHullPointRecord);\n\t                    // do not do anything with current point\n\t                    // correct turn not found\n\t                }\n\t            }\n\t        }\n\t    }\n\t    // at this point, hullPointRecords contains the output points in clockwise order\n\t    // the points start with lowest-y,highest-x startPoint, and end at the same point\n\n\t    // step 3b: remove duplicated startPointRecord from the end of the array\n\t    if (hullPointRecords.length > 2) {\n\t        hullPointRecords.pop();\n\t    }\n\n\t    // step 4: find the lowest originalIndex record and put it at the beginning of hull\n\t    var lowestHullIndex; // the lowest originalIndex on the hull\n\t    var indexOfLowestHullIndexRecord = -1; // the index of the record with lowestHullIndex\n\t    n = hullPointRecords.length;\n\t    for (i = 0; i < n; i++) {\n\n\t        var currentHullIndex = hullPointRecords[i][1];\n\n\t        if (lowestHullIndex === undefined || currentHullIndex < lowestHullIndex) {\n\t            lowestHullIndex = currentHullIndex;\n\t            indexOfLowestHullIndexRecord = i;\n\t        }\n\t    }\n\n\t    var hullPointRecordsReordered = [];\n\t    if (indexOfLowestHullIndexRecord > 0) {\n\t        var newFirstChunk = hullPointRecords.slice(indexOfLowestHullIndexRecord);\n\t        var newSecondChunk = hullPointRecords.slice(0, indexOfLowestHullIndexRecord);\n\t        hullPointRecordsReordered = newFirstChunk.concat(newSecondChunk);\n\n\t    } else {\n\t        hullPointRecordsReordered = hullPointRecords;\n\t    }\n\n\t    var hullPoints = [];\n\t    n = hullPointRecordsReordered.length;\n\t    for (i = 0; i < n; i++) {\n\t        hullPoints.push(hullPointRecordsReordered[i][0]);\n\t    }\n\n\t    return hullPoints;\n\t}\n\n\tvar Polyline = function(points) {\n\n\t    if (!(this instanceof Polyline)) {\n\t        return new Polyline(points);\n\t    }\n\n\t    if (typeof points === 'string') {\n\t        return new Polyline.parse(points);\n\t    }\n\n\t    this.points = (Array.isArray(points) ? points.map(Point) : []);\n\t};\n\n\tPolyline.parse = function(svgString) {\n\t    return new Polyline(parsePoints(svgString));\n\t};\n\n\tPolyline.fromRect = function(rect) {\n\t    return new Polyline([\n\t        rect.topLeft(),\n\t        rect.topRight(),\n\t        rect.bottomRight(),\n\t        rect.bottomLeft(),\n\t        rect.topLeft() ]);\n\t};\n\n\tPolyline.prototype = {\n\n\t    type: types.Polyline,\n\n\t    bbox: function() {\n\n\t        var x1 = Infinity;\n\t        var x2 = -Infinity;\n\t        var y1 = Infinity;\n\t        var y2 = -Infinity;\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\n\t        for (var i = 0; i < numPoints; i++) {\n\n\t            var point = points[i];\n\t            var x = point.x;\n\t            var y = point.y;\n\n\t            if (x < x1) { x1 = x; }\n\t            if (x > x2) { x2 = x; }\n\t            if (y < y1) { y1 = y; }\n\t            if (y > y2) { y2 = y; }\n\t        }\n\n\t        return new Rect(x1, y1, x2 - x1, y2 - y1);\n\t    },\n\n\t    clone: function() {\n\t        return new Polyline(clonePoints(this.points));\n\t    },\n\n\t    closestPoint: function(p) {\n\n\t        var cpLength = this.closestPointLength(p);\n\n\t        return this.pointAtLength(cpLength);\n\t    },\n\n\t    closestPointLength: function(p) {\n\n\t        var points = this.lengthPoints();\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return 0; } // if points array is empty\n\t        if (numPoints === 1) { return 0; } // if there is only one point\n\n\t        var cpLength;\n\t        var minSqrDistance = Infinity;\n\t        var length = 0;\n\t        var n = numPoints - 1;\n\t        for (var i = 0; i < n; i++) {\n\n\t            var line = new Line(points[i], points[i + 1]);\n\t            var lineLength = line.length();\n\n\t            var cpNormalizedLength = line.closestPointNormalizedLength(p);\n\t            var cp = line.pointAt(cpNormalizedLength);\n\n\t            var sqrDistance = cp.squaredDistance(p);\n\t            if (sqrDistance < minSqrDistance) {\n\t                minSqrDistance = sqrDistance;\n\t                cpLength = length + (cpNormalizedLength * lineLength);\n\t            }\n\n\t            length += lineLength;\n\t        }\n\n\t        return cpLength;\n\t    },\n\n\t    closestPointNormalizedLength: function(p) {\n\n\t        var cpLength = this.closestPointLength(p);\n\t        if (cpLength === 0) { return 0; } // shortcut\n\n\t        var length = this.length();\n\t        if (length === 0) { return 0; } // prevents division by zero\n\n\t        return cpLength / length;\n\t    },\n\n\t    closestPointTangent: function(p) {\n\n\t        var cpLength = this.closestPointLength(p);\n\n\t        return this.tangentAtLength(cpLength);\n\t    },\n\n\t    // Returns `true` if the area surrounded by the polyline contains the point `p`.\n\t    // Implements the even-odd SVG algorithm (self-intersections are \"outside\").\n\t    // (Uses horizontal rays to the right of `p` to look for intersections.)\n\t    // Closes open polylines (always imagines a final closing segment).\n\t    containsPoint: function(p) {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return false; } // shortcut (this polyline has no points)\n\n\t        var x = p.x;\n\t        var y = p.y;\n\n\t        // initialize a final closing segment by creating one from last-first points on polyline\n\t        var startIndex = numPoints - 1; // start of current polyline segment\n\t        var endIndex = 0; // end of current polyline segment\n\t        var numIntersections = 0;\n\t        var segment = new Line();\n\t        var ray = new Line();\n\t        var rayEnd = new Point();\n\t        for (; endIndex < numPoints; endIndex++) {\n\t            var start = points[startIndex];\n\t            var end = points[endIndex];\n\t            if (p.equals(start)) { return true; } // shortcut (`p` is a point on polyline)\n\t            // current polyline segment\n\t            segment.start = start;\n\t            segment.end = end;\n\t            if (segment.containsPoint(p)) { return true; } // shortcut (`p` lies on a polyline segment)\n\n\t            // do we have an intersection?\n\t            if (((y <= start.y) && (y > end.y)) || ((y > start.y) && (y <= end.y))) {\n\t                // this conditional branch IS NOT entered when `segment` is collinear/coincident with `ray`\n\t                // (when `y === start.y === end.y`)\n\t                // this conditional branch IS entered when `segment` touches `ray` at only one point\n\t                // (e.g. when `y === start.y !== end.y`)\n\t                // since this branch is entered again for the following segment, the two touches cancel out\n\n\t                var xDifference = (((start.x - x) > (end.x - x)) ? (start.x - x) : (end.x - x));\n\t                if (xDifference >= 0) {\n\t                    // segment lies at least partially to the right of `p`\n\t                    rayEnd.x = x + xDifference;\n\t                    rayEnd.y = y; // right\n\t                    ray.start = p;\n\t                    ray.end = rayEnd;\n\t                    if (segment.intersect(ray)) {\n\t                        // an intersection was detected to the right of `p`\n\t                        numIntersections++;\n\t                    }\n\t                } // else: `segment` lies completely to the left of `p` (i.e. no intersection to the right)\n\t            }\n\n\t            // move to check the next polyline segment\n\t            startIndex = endIndex;\n\t        }\n\n\t        // returns `true` for odd numbers of intersections (even-odd algorithm)\n\t        return ((numIntersections % 2) === 1);\n\t    },\n\n\t    close: function() {\n\t        var ref = this;\n\t        var start = ref.start;\n\t        var end = ref.end;\n\t        var points = ref.points;\n\t        if (start && end && !start.equals(end)) {\n\t            points.push(start.clone());\n\t        }\n\t        return this;\n\t    },\n\n\t    lengthPoints: function() {\n\t        return this.points;\n\t    },\n\n\t    convexHull: function() {\n\t        return new Polyline(convexHull(this.points));\n\t    },\n\n\t    // Checks whether two polylines are exactly the same.\n\t    // If `p` is undefined or null, returns false.\n\t    equals: function(p) {\n\n\t        if (!p) { return false; }\n\n\t        var points = this.points;\n\t        var otherPoints = p.points;\n\n\t        var numPoints = points.length;\n\t        if (otherPoints.length !== numPoints) { return false; } // if the two polylines have different number of points, they cannot be equal\n\n\t        for (var i = 0; i < numPoints; i++) {\n\n\t            var point = points[i];\n\t            var otherPoint = p.points[i];\n\n\t            // as soon as an inequality is found in points, return false\n\t            if (!point.equals(otherPoint)) { return false; }\n\t        }\n\n\t        // if no inequality found in points, return true\n\t        return true;\n\t    },\n\n\t    intersectionWithLine: function(l) {\n\t        var line = new Line(l);\n\t        var intersections = [];\n\t        var points = this.lengthPoints();\n\t        var l2 = new Line();\n\t        for (var i = 0, n = points.length - 1; i < n; i++) {\n\t            l2.start = points[i];\n\t            l2.end = points[i + 1];\n\t            var int = line.intersectionWithLine(l2);\n\t            if (int) { intersections.push(int[0]); }\n\t        }\n\t        return (intersections.length > 0) ? intersections : null;\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return false; }\n\n\t        var line = new Line();\n\t        var n = numPoints - 1;\n\t        for (var i = 0; i < n; i++) {\n\t            line.start = points[i];\n\t            line.end = points[i + 1];\n\t            // as soon as a differentiable line is found between two points, return true\n\t            if (line.isDifferentiable()) { return true; }\n\t        }\n\n\t        // if no differentiable line is found between pairs of points, return false\n\t        return false;\n\t    },\n\n\t    length: function() {\n\n\t        var points = this.lengthPoints();\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return 0; } // if points array is empty\n\n\t        var length = 0;\n\t        var n = numPoints - 1;\n\t        for (var i = 0; i < n; i++) {\n\t            length += points[i].distance(points[i + 1]);\n\t        }\n\n\t        return length;\n\t    },\n\n\t    pointAt: function(ratio) {\n\n\t        var points = this.lengthPoints();\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\t        if (numPoints === 1) { return points[0].clone(); } // if there is only one point\n\n\t        if (ratio <= 0) { return points[0].clone(); }\n\t        if (ratio >= 1) { return points[numPoints - 1].clone(); }\n\n\t        var polylineLength = this.length();\n\t        var length = polylineLength * ratio;\n\n\t        return this.pointAtLength(length);\n\t    },\n\n\t    pointAtLength: function(length) {\n\n\t        var points = this.lengthPoints();\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\t        if (numPoints === 1) { return points[0].clone(); } // if there is only one point\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        var l = 0;\n\t        var n = numPoints - 1;\n\t        for (var i = 0; i < n; i++) {\n\t            var index = (fromStart ? i : (n - 1 - i));\n\n\t            var a = points[index];\n\t            var b = points[index + 1];\n\t            var line = new Line(a, b);\n\t            var d = a.distance(b);\n\n\t            if (length <= (l + d)) {\n\t                return line.pointAtLength((fromStart ? 1 : -1) * (length - l));\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        // if length requested is higher than the length of the polyline, return last endpoint\n\t        var lastPoint = (fromStart ? points[numPoints - 1] : points[0]);\n\t        return lastPoint.clone();\n\t    },\n\n\t    round: function(precision) {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\n\t        for (var i = 0; i < numPoints; i++) {\n\t            points[i].round(precision);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\n\t        for (var i = 0; i < numPoints; i++) {\n\t            points[i].scale(sx, sy, origin);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    simplify: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        var points = this.points;\n\t        if (points.length < 3) { return this; } // we need at least 3 points\n\n\t        // TODO: we may also accept startIndex and endIndex to specify where to start and end simplification\n\t        var threshold = opt.threshold || 0; // = max distance of middle point from chord to be simplified\n\n\t        // start at the beginning of the polyline and go forward\n\t        var currentIndex = 0;\n\t        // we need at least one intermediate point (3 points) in every iteration\n\t        // as soon as that stops being true, we know we reached the end of the polyline\n\t        while (points[currentIndex + 2]) {\n\t            var firstIndex = currentIndex;\n\t            var middleIndex = (currentIndex + 1);\n\t            var lastIndex = (currentIndex + 2);\n\n\t            var firstPoint = points[firstIndex];\n\t            var middlePoint = points[middleIndex];\n\t            var lastPoint = points[lastIndex];\n\n\t            var chord = new Line(firstPoint, lastPoint); // = connection between first and last point\n\t            var closestPoint = chord.closestPoint(middlePoint); // = closest point on chord from middle point\n\t            var closestPointDistance = closestPoint.distance(middlePoint);\n\t            if (closestPointDistance <= threshold) {\n\t                // middle point is close enough to the chord = simplify\n\t                // 1) remove middle point:\n\t                points.splice(middleIndex, 1);\n\t                // 2) in next iteration, investigate the newly-created triplet of points\n\t                //    - do not change `currentIndex`\n\t                //    = (first point stays, point after removed point becomes middle point)\n\t            } else {\n\t                // middle point is far from the chord\n\t                // 1) preserve middle point\n\t                // 2) in next iteration, move `currentIndex` by one step:\n\t                currentIndex += 1;\n\t                //    = (point after first point becomes first point)\n\t            }\n\t        }\n\n\t        // `points` array was modified in-place\n\t        return this;\n\t    },\n\n\t    tangentAt: function(ratio) {\n\n\t        var points = this.lengthPoints();\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\t        if (numPoints === 1) { return null; } // if there is only one point\n\n\t        if (ratio < 0) { ratio = 0; }\n\t        if (ratio > 1) { ratio = 1; }\n\n\t        var polylineLength = this.length();\n\t        var length = polylineLength * ratio;\n\n\t        return this.tangentAtLength(length);\n\t    },\n\n\t    tangentAtLength: function(length) {\n\n\t        var points = this.lengthPoints();\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\t        if (numPoints === 1) { return null; } // if there is only one point\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        var lastValidLine; // differentiable (with a tangent)\n\t        var l = 0; // length so far\n\t        var n = numPoints - 1;\n\t        for (var i = 0; i < n; i++) {\n\t            var index = (fromStart ? i : (n - 1 - i));\n\n\t            var a = points[index];\n\t            var b = points[index + 1];\n\t            var line = new Line(a, b);\n\t            var d = a.distance(b);\n\n\t            if (line.isDifferentiable()) { // has a tangent line (line length is not 0)\n\t                if (length <= (l + d)) {\n\t                    return line.tangentAtLength((fromStart ? 1 : -1) * (length - l));\n\t                }\n\n\t                lastValidLine = line;\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        // if length requested is higher than the length of the polyline, return last valid endpoint\n\t        if (lastValidLine) {\n\t            var ratio = (fromStart ? 1 : 0);\n\t            return lastValidLine.tangentAt(ratio);\n\t        }\n\n\t        // if no valid line, return null\n\t        return null;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.points + '';\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\n\t        for (var i = 0; i < numPoints; i++) {\n\t            points[i].translate(tx, ty);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    // Return svgString that can be used to recreate this line.\n\t    serialize: function() {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return ''; } // if points array is empty\n\n\t        var output = '';\n\t        for (var i = 0; i < numPoints; i++) {\n\n\t            var point = points[i];\n\t            output += point.x + ',' + point.y + ' ';\n\t        }\n\n\t        return output.trim();\n\t    }\n\t};\n\n\tObject.defineProperty(Polyline.prototype, 'start', {\n\t    // Getter for the first point of the polyline.\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\n\t        return this.points[0];\n\t    },\n\t});\n\n\tObject.defineProperty(Polyline.prototype, 'end', {\n\t    // Getter for the last point of the polyline.\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        var points = this.points;\n\t        var numPoints = points.length;\n\t        if (numPoints === 0) { return null; } // if points array is empty\n\n\t        return this.points[numPoints - 1];\n\t    },\n\t});\n\n\tvar abs$2 = Math.abs;\n\tvar sqrt$2 = Math.sqrt;\n\tvar min$6 = Math.min;\n\tvar max$4 = Math.max;\n\tvar pow$3 = Math.pow;\n\n\tvar Curve = function(p1, p2, p3, p4) {\n\n\t    if (!(this instanceof Curve)) {\n\t        return new Curve(p1, p2, p3, p4);\n\t    }\n\n\t    if (p1 instanceof Curve) {\n\t        return new Curve(p1.start, p1.controlPoint1, p1.controlPoint2, p1.end);\n\t    }\n\n\t    this.start = new Point(p1);\n\t    this.controlPoint1 = new Point(p2);\n\t    this.controlPoint2 = new Point(p3);\n\t    this.end = new Point(p4);\n\t};\n\n\t// Curve passing through points.\n\t// Ported from C# implementation by Oleg V. Polikarpotchkin and Peter Lee (http://www.codeproject.com/KB/graphics/BezierSpline.aspx).\n\t// @param {array} points Array of points through which the smooth line will go.\n\t// @return {array} curves.\n\tCurve.throughPoints = (function() {\n\n\t    // Get open-ended Bezier Spline Control Points.\n\t    // @param knots Input Knot Bezier spline points (At least two points!).\n\t    // @param firstControlPoints Output First Control points. Array of knots.length - 1 length.\n\t    // @param secondControlPoints Output Second Control points. Array of knots.length - 1 length.\n\t    function getCurveControlPoints(knots) {\n\n\t        var firstControlPoints = [];\n\t        var secondControlPoints = [];\n\t        var n = knots.length - 1;\n\t        var i;\n\n\t        // Special case: Bezier curve should be a straight line.\n\t        if (n == 1) {\n\t            // 3P1 = 2P0 + P3\n\t            firstControlPoints[0] = new Point(\n\t                (2 * knots[0].x + knots[1].x) / 3,\n\t                (2 * knots[0].y + knots[1].y) / 3\n\t            );\n\n\t            // P2 = 2P1 â P0\n\t            secondControlPoints[0] = new Point(\n\t                2 * firstControlPoints[0].x - knots[0].x,\n\t                2 * firstControlPoints[0].y - knots[0].y\n\t            );\n\n\t            return [firstControlPoints, secondControlPoints];\n\t        }\n\n\t        // Calculate first Bezier control points.\n\t        // Right hand side vector.\n\t        var rhs = [];\n\n\t        // Set right hand side X values.\n\t        for (i = 1; i < n - 1; i++) {\n\t            rhs[i] = 4 * knots[i].x + 2 * knots[i + 1].x;\n\t        }\n\n\t        rhs[0] = knots[0].x + 2 * knots[1].x;\n\t        rhs[n - 1] = (8 * knots[n - 1].x + knots[n].x) / 2.0;\n\n\t        // Get first control points X-values.\n\t        var x = getFirstControlPoints(rhs);\n\n\t        // Set right hand side Y values.\n\t        for (i = 1; i < n - 1; ++i) {\n\t            rhs[i] = 4 * knots[i].y + 2 * knots[i + 1].y;\n\t        }\n\n\t        rhs[0] = knots[0].y + 2 * knots[1].y;\n\t        rhs[n - 1] = (8 * knots[n - 1].y + knots[n].y) / 2.0;\n\n\t        // Get first control points Y-values.\n\t        var y = getFirstControlPoints(rhs);\n\n\t        // Fill output arrays.\n\t        for (i = 0; i < n; i++) {\n\t            // First control point.\n\t            firstControlPoints.push(new Point(x[i], y[i]));\n\n\t            // Second control point.\n\t            if (i < n - 1) {\n\t                secondControlPoints.push(new Point(\n\t                    2 * knots [i + 1].x - x[i + 1],\n\t                    2 * knots[i + 1].y - y[i + 1]\n\t                ));\n\n\t            } else {\n\t                secondControlPoints.push(new Point(\n\t                    (knots[n].x + x[n - 1]) / 2,\n\t                    (knots[n].y + y[n - 1]) / 2\n\t                ));\n\t            }\n\t        }\n\n\t        return [firstControlPoints, secondControlPoints];\n\t    }\n\n\t    // Solves a tridiagonal system for one of coordinates (x or y) of first Bezier control points.\n\t    // @param rhs Right hand side vector.\n\t    // @return Solution vector.\n\t    function getFirstControlPoints(rhs) {\n\n\t        var n = rhs.length;\n\t        // `x` is a solution vector.\n\t        var x = [];\n\t        var tmp = [];\n\t        var b = 2.0;\n\n\t        x[0] = rhs[0] / b;\n\n\t        // Decomposition and forward substitution.\n\t        for (var i = 1; i < n; i++) {\n\t            tmp[i] = 1 / b;\n\t            b = (i < n - 1 ? 4.0 : 3.5) - tmp[i];\n\t            x[i] = (rhs[i] - x[i - 1]) / b;\n\t        }\n\n\t        for (i = 1; i < n; i++) {\n\t            // Backsubstitution.\n\t            x[n - i - 1] -= tmp[n - i] * x[n - i];\n\t        }\n\n\t        return x;\n\t    }\n\n\t    return function(points) {\n\n\t        if (!points || (Array.isArray(points) && points.length < 2)) {\n\t            throw new Error('At least 2 points are required');\n\t        }\n\n\t        var controlPoints = getCurveControlPoints(points);\n\n\t        var curves = [];\n\t        var n = controlPoints[0].length;\n\t        for (var i = 0; i < n; i++) {\n\n\t            var controlPoint1 = new Point(controlPoints[0][i].x, controlPoints[0][i].y);\n\t            var controlPoint2 = new Point(controlPoints[1][i].x, controlPoints[1][i].y);\n\n\t            curves.push(new Curve(points[i], controlPoint1, controlPoint2, points[i + 1]));\n\t        }\n\n\t        return curves;\n\t    };\n\t})();\n\n\tCurve.prototype = {\n\n\t    type: types.Curve,\n\n\t    // Returns a bbox that tightly envelops the curve.\n\t    bbox: function() {\n\n\t        var start = this.start;\n\t        var controlPoint1 = this.controlPoint1;\n\t        var controlPoint2 = this.controlPoint2;\n\t        var end = this.end;\n\n\t        var x0 = start.x;\n\t        var y0 = start.y;\n\t        var x1 = controlPoint1.x;\n\t        var y1 = controlPoint1.y;\n\t        var x2 = controlPoint2.x;\n\t        var y2 = controlPoint2.y;\n\t        var x3 = end.x;\n\t        var y3 = end.y;\n\n\t        var points = new Array(); // local extremes\n\t        var tvalues = new Array(); // t values of local extremes\n\t        var bounds = [new Array(), new Array()];\n\n\t        var a, b, c, t;\n\t        var t1, t2;\n\t        var b2ac, sqrtb2ac;\n\n\t        for (var i = 0; i < 2; ++i) {\n\n\t            if (i === 0) {\n\t                b = 6 * x0 - 12 * x1 + 6 * x2;\n\t                a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n\t                c = 3 * x1 - 3 * x0;\n\n\t            } else {\n\t                b = 6 * y0 - 12 * y1 + 6 * y2;\n\t                a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n\t                c = 3 * y1 - 3 * y0;\n\t            }\n\n\t            if (abs$2(a) < 1e-12) { // Numerical robustness\n\t                if (abs$2(b) < 1e-12) { // Numerical robustness\n\t                    continue;\n\t                }\n\n\t                t = -c / b;\n\t                if ((0 < t) && (t < 1)) { tvalues.push(t); }\n\n\t                continue;\n\t            }\n\n\t            b2ac = b * b - 4 * c * a;\n\t            sqrtb2ac = sqrt$2(b2ac);\n\n\t            if (b2ac < 0) { continue; }\n\n\t            t1 = (-b + sqrtb2ac) / (2 * a);\n\t            if ((0 < t1) && (t1 < 1)) { tvalues.push(t1); }\n\n\t            t2 = (-b - sqrtb2ac) / (2 * a);\n\t            if ((0 < t2) && (t2 < 1)) { tvalues.push(t2); }\n\t        }\n\n\t        var j = tvalues.length;\n\t        var jlen = j;\n\t        var mt;\n\t        var x, y;\n\n\t        while (j--) {\n\t            t = tvalues[j];\n\t            mt = 1 - t;\n\n\t            x = (mt * mt * mt * x0) + (3 * mt * mt * t * x1) + (3 * mt * t * t * x2) + (t * t * t * x3);\n\t            bounds[0][j] = x;\n\n\t            y = (mt * mt * mt * y0) + (3 * mt * mt * t * y1) + (3 * mt * t * t * y2) + (t * t * t * y3);\n\t            bounds[1][j] = y;\n\n\t            points[j] = { X: x, Y: y };\n\t        }\n\n\t        tvalues[jlen] = 0;\n\t        tvalues[jlen + 1] = 1;\n\n\t        points[jlen] = { X: x0, Y: y0 };\n\t        points[jlen + 1] = { X: x3, Y: y3 };\n\n\t        bounds[0][jlen] = x0;\n\t        bounds[1][jlen] = y0;\n\n\t        bounds[0][jlen + 1] = x3;\n\t        bounds[1][jlen + 1] = y3;\n\n\t        tvalues.length = jlen + 2;\n\t        bounds[0].length = jlen + 2;\n\t        bounds[1].length = jlen + 2;\n\t        points.length = jlen + 2;\n\n\t        var left = min$6.apply(null, bounds[0]);\n\t        var top = min$6.apply(null, bounds[1]);\n\t        var right = max$4.apply(null, bounds[0]);\n\t        var bottom = max$4.apply(null, bounds[1]);\n\n\t        return new Rect(left, top, (right - left), (bottom - top));\n\t    },\n\n\t    clone: function() {\n\n\t        return new Curve(this.start, this.controlPoint1, this.controlPoint2, this.end);\n\t    },\n\n\t    // Returns the point on the curve closest to point `p`\n\t    closestPoint: function(p, opt) {\n\n\t        return this.pointAtT(this.closestPointT(p, opt));\n\t    },\n\n\t    closestPointLength: function(p, opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        var localOpt = { precision: precision, subdivisions: subdivisions };\n\n\t        return this.lengthAtT(this.closestPointT(p, localOpt), localOpt);\n\t    },\n\n\t    closestPointNormalizedLength: function(p, opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        var localOpt = { precision: precision, subdivisions: subdivisions };\n\n\t        var cpLength = this.closestPointLength(p, localOpt);\n\t        if (!cpLength) { return 0; }\n\n\t        var length = this.length(localOpt);\n\t        if (length === 0) { return 0; }\n\n\t        return cpLength / length;\n\t    },\n\n\t    // Returns `t` of the point on the curve closest to point `p`\n\t    closestPointT: function(p, opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        // does not use localOpt\n\n\t        // identify the subdivision that contains the point:\n\t        var investigatedSubdivision;\n\t        var investigatedSubdivisionStartT; // assume that subdivisions are evenly spaced\n\t        var investigatedSubdivisionEndT;\n\t        var distFromStart; // distance of point from start of baseline\n\t        var distFromEnd; // distance of point from end of baseline\n\t        var chordLength; // distance between start and end of the subdivision\n\t        var minSumDist; // lowest observed sum of the two distances\n\t        var n = subdivisions.length;\n\t        var subdivisionSize = (n ? (1 / n) : 0);\n\t        for (var i = 0; i < n; i++) {\n\n\t            var currentSubdivision = subdivisions[i];\n\n\t            var startDist = currentSubdivision.start.distance(p);\n\t            var endDist = currentSubdivision.end.distance(p);\n\t            var sumDist = startDist + endDist;\n\n\t            // check that the point is closest to current subdivision and not any other\n\t            if (!minSumDist || (sumDist < minSumDist)) {\n\t                investigatedSubdivision = currentSubdivision;\n\n\t                investigatedSubdivisionStartT = i * subdivisionSize;\n\t                investigatedSubdivisionEndT = (i + 1) * subdivisionSize;\n\n\t                distFromStart = startDist;\n\t                distFromEnd = endDist;\n\n\t                chordLength = currentSubdivision.start.distance(currentSubdivision.end);\n\n\t                minSumDist = sumDist;\n\t            }\n\t        }\n\n\t        var precisionRatio = pow$3(10, -precision);\n\n\t        // recursively divide investigated subdivision:\n\t        // until distance between baselinePoint and closest path endpoint is within 10^(-precision)\n\t        // then return the closest endpoint of that final subdivision\n\t        while (true) {\n\n\t            // check if we have reached at least one required observed precision\n\t            // - calculated as: the difference in distances from point to start and end divided by the distance\n\t            // - note that this function is not monotonic = it doesn't converge stably but has \"teeth\"\n\t            // - the function decreases while one of the endpoints is fixed but \"jumps\" whenever we switch\n\t            // - this criterion works well for points lying far away from the curve\n\t            var startPrecisionRatio = (distFromStart ? (abs$2(distFromStart - distFromEnd) / distFromStart) : 0);\n\t            var endPrecisionRatio = (distFromEnd ? (abs$2(distFromStart - distFromEnd) / distFromEnd) : 0);\n\t            var hasRequiredPrecision = ((startPrecisionRatio < precisionRatio) || (endPrecisionRatio < precisionRatio));\n\n\t            // check if we have reached at least one required minimal distance\n\t            // - calculated as: the subdivision chord length multiplied by precisionRatio\n\t            // - calculation is relative so it will work for arbitrarily large/small curves and their subdivisions\n\t            // - this is a backup criterion that works well for points lying \"almost at\" the curve\n\t            var hasMinimalStartDistance = (distFromStart ? (distFromStart < (chordLength * precisionRatio)) : true);\n\t            var hasMinimalEndDistance = (distFromEnd ? (distFromEnd < (chordLength * precisionRatio)) : true);\n\t            var hasMinimalDistance = (hasMinimalStartDistance || hasMinimalEndDistance);\n\n\t            // do we stop now?\n\t            if (hasRequiredPrecision || hasMinimalDistance) {\n\t                return ((distFromStart <= distFromEnd) ? investigatedSubdivisionStartT : investigatedSubdivisionEndT);\n\t            }\n\n\t            // otherwise, set up for next iteration\n\t            var divided = investigatedSubdivision.divide(0.5);\n\t            subdivisionSize /= 2;\n\n\t            var startDist1 = divided[0].start.distance(p);\n\t            var endDist1 = divided[0].end.distance(p);\n\t            var sumDist1 = startDist1 + endDist1;\n\n\t            var startDist2 = divided[1].start.distance(p);\n\t            var endDist2 = divided[1].end.distance(p);\n\t            var sumDist2 = startDist2 + endDist2;\n\n\t            if (sumDist1 <= sumDist2) {\n\t                investigatedSubdivision = divided[0];\n\n\t                investigatedSubdivisionEndT -= subdivisionSize; // subdivisionSize was already halved\n\n\t                distFromStart = startDist1;\n\t                distFromEnd = endDist1;\n\n\t            } else {\n\t                investigatedSubdivision = divided[1];\n\n\t                investigatedSubdivisionStartT += subdivisionSize; // subdivisionSize was already halved\n\n\t                distFromStart = startDist2;\n\t                distFromEnd = endDist2;\n\t            }\n\t        }\n\t    },\n\n\t    closestPointTangent: function(p, opt) {\n\n\t        return this.tangentAtT(this.closestPointT(p, opt));\n\t    },\n\n\t    // Returns `true` if the area surrounded by the curve contains the point `p`.\n\t    // Implements the even-odd algorithm (self-intersections are \"outside\").\n\t    // Closes open curves (always imagines a closing segment).\n\t    // Precision may be adjusted by passing an `opt` object.\n\t    containsPoint: function(p, opt) {\n\n\t        var polyline = this.toPolyline(opt);\n\t        return polyline.containsPoint(p);\n\t    },\n\n\t    // Divides the curve into two at requested `ratio` between 0 and 1 with precision better than `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    // For a function that uses `t`, use Curve.divideAtT().\n\t    divideAt: function(ratio, opt) {\n\n\t        if (ratio <= 0) { return this.divideAtT(0); }\n\t        if (ratio >= 1) { return this.divideAtT(1); }\n\n\t        var t = this.tAt(ratio, opt);\n\n\t        return this.divideAtT(t);\n\t    },\n\n\t    // Divides the curve into two at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    divideAtLength: function(length, opt) {\n\n\t        var t = this.tAtLength(length, opt);\n\n\t        return this.divideAtT(t);\n\t    },\n\n\t    // Divides the curve into two at point defined by `t` between 0 and 1.\n\t    // Using de Casteljau's algorithm (http://math.stackexchange.com/a/317867).\n\t    // Additional resource: https://pomax.github.io/bezierinfo/#decasteljau\n\t    divideAtT: function(t) {\n\n\t        var start = this.start;\n\t        var controlPoint1 = this.controlPoint1;\n\t        var controlPoint2 = this.controlPoint2;\n\t        var end = this.end;\n\n\t        // shortcuts for `t` values that are out of range\n\t        if (t <= 0) {\n\t            return [\n\t                new Curve(start, start, start, start),\n\t                new Curve(start, controlPoint1, controlPoint2, end)\n\t            ];\n\t        }\n\n\t        if (t >= 1) {\n\t            return [\n\t                new Curve(start, controlPoint1, controlPoint2, end),\n\t                new Curve(end, end, end, end)\n\t            ];\n\t        }\n\n\t        var dividerPoints = this.getSkeletonPoints(t);\n\n\t        var startControl1 = dividerPoints.startControlPoint1;\n\t        var startControl2 = dividerPoints.startControlPoint2;\n\t        var divider = dividerPoints.divider;\n\t        var dividerControl1 = dividerPoints.dividerControlPoint1;\n\t        var dividerControl2 = dividerPoints.dividerControlPoint2;\n\n\t        // return array with two new curves\n\t        return [\n\t            new Curve(start, startControl1, startControl2, divider),\n\t            new Curve(divider, dividerControl1, dividerControl2, end)\n\t        ];\n\t    },\n\n\t    // Returns the distance between the curve's start and end points.\n\t    endpointDistance: function() {\n\n\t        return this.start.distance(this.end);\n\t    },\n\n\t    // Checks whether two curves are exactly the same.\n\t    equals: function(c) {\n\n\t        return !!c &&\n\t            this.start.x === c.start.x &&\n\t            this.start.y === c.start.y &&\n\t            this.controlPoint1.x === c.controlPoint1.x &&\n\t            this.controlPoint1.y === c.controlPoint1.y &&\n\t            this.controlPoint2.x === c.controlPoint2.x &&\n\t            this.controlPoint2.y === c.controlPoint2.y &&\n\t            this.end.x === c.end.x &&\n\t            this.end.y === c.end.y;\n\t    },\n\n\t    // Returns five helper points necessary for curve division.\n\t    getSkeletonPoints: function(t) {\n\n\t        var start = this.start;\n\t        var control1 = this.controlPoint1;\n\t        var control2 = this.controlPoint2;\n\t        var end = this.end;\n\n\t        // shortcuts for `t` values that are out of range\n\t        if (t <= 0) {\n\t            return {\n\t                startControlPoint1: start.clone(),\n\t                startControlPoint2: start.clone(),\n\t                divider: start.clone(),\n\t                dividerControlPoint1: control1.clone(),\n\t                dividerControlPoint2: control2.clone()\n\t            };\n\t        }\n\n\t        if (t >= 1) {\n\t            return {\n\t                startControlPoint1: control1.clone(),\n\t                startControlPoint2: control2.clone(),\n\t                divider: end.clone(),\n\t                dividerControlPoint1: end.clone(),\n\t                dividerControlPoint2: end.clone()\n\t            };\n\t        }\n\n\t        var midpoint1 = (new Line(start, control1)).pointAt(t);\n\t        var midpoint2 = (new Line(control1, control2)).pointAt(t);\n\t        var midpoint3 = (new Line(control2, end)).pointAt(t);\n\n\t        var subControl1 = (new Line(midpoint1, midpoint2)).pointAt(t);\n\t        var subControl2 = (new Line(midpoint2, midpoint3)).pointAt(t);\n\n\t        var divider = (new Line(subControl1, subControl2)).pointAt(t);\n\n\t        var output = {\n\t            startControlPoint1: midpoint1,\n\t            startControlPoint2: subControl1,\n\t            divider: divider,\n\t            dividerControlPoint1: subControl2,\n\t            dividerControlPoint2: midpoint3\n\t        };\n\n\t        return output;\n\t    },\n\n\t    // Returns a list of curves whose flattened length is better than `opt.precision`.\n\t    // That is, observed difference in length between recursions is less than 10^(-3) = 0.001 = 0.1%\n\t    // (Observed difference is not real precision, but close enough as long as special cases are covered)\n\t    // (That is why skipping iteration 1 is important)\n\t    // As a rule of thumb, increasing `precision` by 1 requires two more division operations\n\t    // - Precision 0 (endpointDistance) - total of 2^0 - 1 = 0 operations (1 subdivision)\n\t    // - Precision 1 (<10% error) - total of 2^2 - 1 = 3 operations (4 subdivisions)\n\t    // - Precision 2 (<1% error) - total of 2^4 - 1 = 15 operations requires 4 division operations on all elements (15 operations total) (16 subdivisions)\n\t    // - Precision 3 (<0.1% error) - total of 2^6 - 1 = 63 operations - acceptable when drawing (64 subdivisions)\n\t    // - Precision 4 (<0.01% error) - total of 2^8 - 1 = 255 operations - high resolution, can be used to interpolate `t` (256 subdivisions)\n\t    // (Variation of 1 recursion worse or better is possible depending on the curve, doubling/halving the number of operations accordingly)\n\t    getSubdivisions: function(opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        // not using opt.subdivisions\n\t        // not using localOpt\n\n\t        var subdivisions = [new Curve(this.start, this.controlPoint1, this.controlPoint2, this.end)];\n\t        if (precision === 0) { return subdivisions; }\n\n\t        var previousLength = this.endpointDistance();\n\n\t        var precisionRatio = pow$3(10, -precision);\n\n\t        // recursively divide curve at `t = 0.5`\n\t        // until the difference between observed length at subsequent iterations is lower than precision\n\t        var iteration = 0;\n\t        while (true) {\n\t            iteration += 1;\n\n\t            // divide all subdivisions\n\t            var newSubdivisions = [];\n\t            var numSubdivisions = subdivisions.length;\n\t            for (var i = 0; i < numSubdivisions; i++) {\n\n\t                var currentSubdivision = subdivisions[i];\n\t                var divided = currentSubdivision.divide(0.5); // dividing at t = 0.5 (not at middle length!)\n\t                newSubdivisions.push(divided[0], divided[1]);\n\t            }\n\n\t            // measure new length\n\t            var length = 0;\n\t            var numNewSubdivisions = newSubdivisions.length;\n\t            for (var j = 0; j < numNewSubdivisions; j++) {\n\n\t                var currentNewSubdivision = newSubdivisions[j];\n\t                length += currentNewSubdivision.endpointDistance();\n\t            }\n\n\t            // check if we have reached required observed precision\n\t            // sine-like curves may have the same observed length in iteration 0 and 1 - skip iteration 1\n\t            // not a problem for further iterations because cubic curves cannot have more than two local extrema\n\t            // (i.e. cubic curves cannot intersect the baseline more than once)\n\t            // therefore two subsequent iterations cannot produce sampling with equal length\n\t            var observedPrecisionRatio = ((length !== 0) ? ((length - previousLength) / length) : 0);\n\t            if (iteration > 1 && observedPrecisionRatio < precisionRatio) {\n\t                return newSubdivisions;\n\t            }\n\n\t            // otherwise, set up for next iteration\n\t            subdivisions = newSubdivisions;\n\t            previousLength = length;\n\t        }\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        var start = this.start;\n\t        var control1 = this.controlPoint1;\n\t        var control2 = this.controlPoint2;\n\t        var end = this.end;\n\n\t        return !(start.equals(control1) && control1.equals(control2) && control2.equals(end));\n\t    },\n\n\t    // Returns flattened length of the curve with precision better than `opt.precision`; or using `opt.subdivisions` provided.\n\t    length: function(opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision; // opt.precision only used in getSubdivisions() call\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        // not using localOpt\n\n\t        var length = 0;\n\t        var n = subdivisions.length;\n\t        for (var i = 0; i < n; i++) {\n\n\t            var currentSubdivision = subdivisions[i];\n\t            length += currentSubdivision.endpointDistance();\n\t        }\n\n\t        return length;\n\t    },\n\n\t    // Returns distance along the curve up to `t` with precision better than requested `opt.precision`. (Not using `opt.subdivisions`.)\n\t    lengthAtT: function(t, opt) {\n\n\t        if (t <= 0) { return 0; }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        // not using opt.subdivisions\n\t        // not using localOpt\n\n\t        var subCurve = this.divide(t)[0];\n\t        var subCurveLength = subCurve.length({ precision: precision });\n\n\t        return subCurveLength;\n\t    },\n\n\t    // Returns point at requested `ratio` between 0 and 1 with precision better than `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    // Mirrors Line.pointAt() function.\n\t    // For a function that tracks `t`, use Curve.pointAtT().\n\t    pointAt: function(ratio, opt) {\n\n\t        if (ratio <= 0) { return this.start.clone(); }\n\t        if (ratio >= 1) { return this.end.clone(); }\n\n\t        var t = this.tAt(ratio, opt);\n\n\t        return this.pointAtT(t);\n\t    },\n\n\t    // Returns point at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    pointAtLength: function(length, opt) {\n\n\t        var t = this.tAtLength(length, opt);\n\n\t        return this.pointAtT(t);\n\t    },\n\n\t    // Returns the point at provided `t` between 0 and 1.\n\t    // `t` does not track distance along curve as it does in Line objects.\n\t    // Non-linear relationship, speeds up and slows down as curve warps!\n\t    // For linear length-based solution, use Curve.pointAt().\n\t    pointAtT: function(t) {\n\n\t        if (t <= 0) { return this.start.clone(); }\n\t        if (t >= 1) { return this.end.clone(); }\n\n\t        return this.getSkeletonPoints(t).divider;\n\t    },\n\n\t    // Default precision\n\t    PRECISION: 3,\n\n\t    round: function(precision) {\n\n\t        this.start.round(precision);\n\t        this.controlPoint1.round(precision);\n\t        this.controlPoint2.round(precision);\n\t        this.end.round(precision);\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        this.start.scale(sx, sy, origin);\n\t        this.controlPoint1.scale(sx, sy, origin);\n\t        this.controlPoint2.scale(sx, sy, origin);\n\t        this.end.scale(sx, sy, origin);\n\t        return this;\n\t    },\n\n\t    // Returns a tangent line at requested `ratio` with precision better than requested `opt.precision`; or using `opt.subdivisions` provided.\n\t    tangentAt: function(ratio, opt) {\n\n\t        if (!this.isDifferentiable()) { return null; }\n\n\t        if (ratio < 0) { ratio = 0; }\n\t        else if (ratio > 1) { ratio = 1; }\n\n\t        var t = this.tAt(ratio, opt);\n\n\t        return this.tangentAtT(t);\n\t    },\n\n\t    // Returns a tangent line at requested `length` with precision better than requested `opt.precision`; or using `opt.subdivisions` provided.\n\t    tangentAtLength: function(length, opt) {\n\n\t        if (!this.isDifferentiable()) { return null; }\n\n\t        var t = this.tAtLength(length, opt);\n\n\t        return this.tangentAtT(t);\n\t    },\n\n\t    // Returns a tangent line at requested `t`.\n\t    tangentAtT: function(t) {\n\n\t        if (!this.isDifferentiable()) { return null; }\n\n\t        if (t < 0) { t = 0; }\n\t        else if (t > 1) { t = 1; }\n\n\t        var skeletonPoints = this.getSkeletonPoints(t);\n\n\t        var p1 = skeletonPoints.startControlPoint2;\n\t        var p2 = skeletonPoints.dividerControlPoint1;\n\n\t        var tangentStart = skeletonPoints.divider;\n\n\t        var tangentLine = new Line(p1, p2);\n\t        tangentLine.translate(tangentStart.x - p1.x, tangentStart.y - p1.y); // move so that tangent line starts at the point requested\n\n\t        return tangentLine;\n\t    },\n\n\t    // Returns `t` at requested `ratio` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    tAt: function(ratio, opt) {\n\n\t        if (ratio <= 0) { return 0; }\n\t        if (ratio >= 1) { return 1; }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        var localOpt = { precision: precision, subdivisions: subdivisions };\n\n\t        var curveLength = this.length(localOpt);\n\t        var length = curveLength * ratio;\n\n\t        return this.tAtLength(length, localOpt);\n\t    },\n\n\t    // Returns `t` at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    // Uses `precision` to approximate length within `precision` (always underestimates)\n\t    // Then uses a binary search to find the `t` of a subdivision endpoint that is close (within `precision`) to the `length`, if the curve was as long as approximated\n\t    // As a rule of thumb, increasing `precision` by 1 causes the algorithm to go 2^(precision - 1) deeper\n\t    // - Precision 0 (chooses one of the two endpoints) - 0 levels\n\t    // - Precision 1 (chooses one of 5 points, <10% error) - 1 level\n\t    // - Precision 2 (<1% error) - 3 levels\n\t    // - Precision 3 (<0.1% error) - 7 levels\n\t    // - Precision 4 (<0.01% error) - 15 levels\n\t    tAtLength: function(length, opt) {\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        var localOpt = { precision: precision, subdivisions: subdivisions };\n\n\t        // identify the subdivision that contains the point at requested `length`:\n\t        var investigatedSubdivision;\n\t        var investigatedSubdivisionStartT; // assume that subdivisions are evenly spaced\n\t        var investigatedSubdivisionEndT;\n\t        //var baseline; // straightened version of subdivision to investigate\n\t        //var baselinePoint; // point on the baseline that is the requested distance away from start\n\t        var baselinePointDistFromStart; // distance of baselinePoint from start of baseline\n\t        var baselinePointDistFromEnd; // distance of baselinePoint from end of baseline\n\t        var l = 0; // length so far\n\t        var n = subdivisions.length;\n\t        var subdivisionSize = 1 / n;\n\t        for (var i = 0; i < n; i++) {\n\t            var index = (fromStart ? i : (n - 1 - i));\n\n\t            var currentSubdivision = subdivisions[i];\n\t            var d = currentSubdivision.endpointDistance(); // length of current subdivision\n\n\t            if (length <= (l + d)) {\n\t                investigatedSubdivision = currentSubdivision;\n\n\t                investigatedSubdivisionStartT = index * subdivisionSize;\n\t                investigatedSubdivisionEndT = (index + 1) * subdivisionSize;\n\n\t                baselinePointDistFromStart = (fromStart ? (length - l) : ((d + l) - length));\n\t                baselinePointDistFromEnd = (fromStart ? ((d + l) - length) : (length - l));\n\n\t                break;\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        if (!investigatedSubdivision) { return (fromStart ? 1 : 0); } // length requested is out of range - return maximum t\n\t        // note that precision affects what length is recorded\n\t        // (imprecise measurements underestimate length by up to 10^(-precision) of the precise length)\n\t        // e.g. at precision 1, the length may be underestimated by up to 10% and cause this function to return 1\n\n\t        var curveLength = this.length(localOpt);\n\n\t        var precisionRatio = pow$3(10, -precision);\n\n\t        // recursively divide investigated subdivision:\n\t        // until distance between baselinePoint and closest path endpoint is within 10^(-precision)\n\t        // then return the closest endpoint of that final subdivision\n\t        while (true) {\n\n\t            // check if we have reached required observed precision\n\t            var observedPrecisionRatio;\n\n\t            observedPrecisionRatio = ((curveLength !== 0) ? (baselinePointDistFromStart / curveLength) : 0);\n\t            if (observedPrecisionRatio < precisionRatio) { return investigatedSubdivisionStartT; }\n\t            observedPrecisionRatio = ((curveLength !== 0) ? (baselinePointDistFromEnd / curveLength) : 0);\n\t            if (observedPrecisionRatio < precisionRatio) { return investigatedSubdivisionEndT; }\n\n\t            // otherwise, set up for next iteration\n\t            var newBaselinePointDistFromStart;\n\t            var newBaselinePointDistFromEnd;\n\n\t            var divided = investigatedSubdivision.divide(0.5);\n\t            subdivisionSize /= 2;\n\n\t            var baseline1Length = divided[0].endpointDistance();\n\t            var baseline2Length = divided[1].endpointDistance();\n\n\t            if (baselinePointDistFromStart <= baseline1Length) { // point at requested length is inside divided[0]\n\t                investigatedSubdivision = divided[0];\n\n\t                investigatedSubdivisionEndT -= subdivisionSize; // sudivisionSize was already halved\n\n\t                newBaselinePointDistFromStart = baselinePointDistFromStart;\n\t                newBaselinePointDistFromEnd = baseline1Length - newBaselinePointDistFromStart;\n\n\t            } else { // point at requested length is inside divided[1]\n\t                investigatedSubdivision = divided[1];\n\n\t                investigatedSubdivisionStartT += subdivisionSize; // subdivisionSize was already halved\n\n\t                newBaselinePointDistFromStart = baselinePointDistFromStart - baseline1Length;\n\t                newBaselinePointDistFromEnd = baseline2Length - newBaselinePointDistFromStart;\n\t            }\n\n\t            baselinePointDistFromStart = newBaselinePointDistFromStart;\n\t            baselinePointDistFromEnd = newBaselinePointDistFromEnd;\n\t        }\n\t    },\n\n\t    // Returns an array of points that represents the curve when flattened, up to `opt.precision`; or using `opt.subdivisions` provided.\n\t    // Flattened length is no more than 10^(-precision) away from real curve length.\n\t    toPoints: function(opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision; // opt.precision only used in getSubdivisions() call\n\t        var subdivisions = (opt.subdivisions === undefined) ? this.getSubdivisions({ precision: precision }) : opt.subdivisions;\n\t        // not using localOpt\n\n\t        var points = [subdivisions[0].start.clone()];\n\t        var n = subdivisions.length;\n\t        for (var i = 0; i < n; i++) {\n\n\t            var currentSubdivision = subdivisions[i];\n\t            points.push(currentSubdivision.end.clone());\n\t        }\n\n\t        return points;\n\t    },\n\n\t    // Returns a polyline that represents the curve when flattened, up to `opt.precision`; or using `opt.subdivisions` provided.\n\t    // Flattened length is no more than 10^(-precision) away from real curve length.\n\t    toPolyline: function(opt) {\n\n\t        return new Polyline(this.toPoints(opt));\n\t    },\n\n\t    toString: function() {\n\n\t        return this.start + ' ' + this.controlPoint1 + ' ' + this.controlPoint2 + ' ' + this.end;\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        this.start.translate(tx, ty);\n\t        this.controlPoint1.translate(tx, ty);\n\t        this.controlPoint2.translate(tx, ty);\n\t        this.end.translate(tx, ty);\n\t        return this;\n\t    }\n\t};\n\n\tCurve.prototype.divide = Curve.prototype.divideAtT;\n\n\t// Local helper function.\n\t// Add properties from arguments on top of properties from `obj`.\n\t// This allows for rudimentary inheritance.\n\t// - The `obj` argument acts as parent.\n\t// - This function creates a new object that inherits all `obj` properties and adds/replaces those that are present in arguments.\n\t// - A high-level example: calling `extend(Vehicle, Car)` would be akin to declaring `class Car extends Vehicle`.\n\tfunction extend(obj) {\n\t    var arguments$1 = arguments;\n\n\t    // In JavaScript, the combination of a constructor function (e.g. `g.Line = function(...) {...}`) and prototype (e.g. `g.Line.prototype = {...}) is akin to a C++ class.\n\t    // - When inheritance is not necessary, we can leave it at that. (This would be akin to calling extend with only `obj`.)\n\t    // - But, what if we wanted the `g.Line` quasiclass to inherit from another quasiclass (let's call it `g.GeometryObject`) in JavaScript?\n\t    // - First, realize that both of those quasiclasses would still have their own separate constructor function.\n\t    // - So what we are actually saying is that we want the `g.Line` prototype to inherit from `g.GeometryObject` prototype.\n\t    // - This method provides a way to do exactly that.\n\t    // - It copies parent prototype's properties, then adds extra ones from child prototype/overrides parent prototype properties with child prototype properties.\n\t    // - Therefore, to continue with the example above:\n\t    //   - `g.Line.prototype = extend(g.GeometryObject.prototype, linePrototype)`\n\t    //   - Where `linePrototype` is a properties object that looks just like `g.Line.prototype` does right now.\n\t    //   - Then, `g.Line` would allow the programmer to access to all methods currently in `g.Line.Prototype`, plus any non-overridden methods from `g.GeometryObject.prototype`.\n\t    //   - In that aspect, `g.GeometryObject` would then act like the parent of `g.Line`.\n\t    // - Multiple inheritance is also possible, if multiple arguments are provided.\n\t    // - What if we wanted to add another level of abstraction between `g.GeometryObject` and `g.Line` (let's call it `g.LinearObject`)?\n\t    //   - `g.Line.prototype = extend(g.GeometryObject.prototype, g.LinearObject.prototype, linePrototype)`\n\t    //   - The ancestors are applied in order of appearance.\n\t    //   - That means that `g.Line` would have inherited from `g.LinearObject` that would have inherited from `g.GeometryObject`.\n\t    //   - Any number of ancestors may be provided.\n\t    // - Note that neither `obj` nor any of the arguments need to actually be prototypes of any JavaScript quasiclass, that was just a simplified explanation.\n\t    // - We can create a new object composed from the properties of any number of other objects (since they do not have a constructor, we can think of those as interfaces).\n\t    //   - `extend({ a: 1, b: 2 }, { b: 10, c: 20 }, { c: 100, d: 200 })` gives `{ a: 1, b: 10, c: 100, d: 200 }`.\n\t    //   - Basically, with this function, we can emulate the `extends` keyword as well as the `implements` keyword.\n\t    // - Therefore, both of the following are valid:\n\t    //   - `Lineto.prototype = extend(Line.prototype, segmentPrototype, linetoPrototype)`\n\t    //   - `Moveto.prototype = extend(segmentPrototype, movetoPrototype)`\n\n\t    var i;\n\t    var n;\n\n\t    var args = [];\n\t    n = arguments.length;\n\t    for (i = 1; i < n; i++) { // skip over obj\n\t        args.push(arguments$1[i]);\n\t    }\n\n\t    if (!obj) { throw new Error('Missing a parent object.'); }\n\t    var child = Object.create(obj);\n\n\t    n = args.length;\n\t    for (i = 0; i < n; i++) {\n\n\t        var src = args[i];\n\n\t        var inheritedProperty;\n\t        var key;\n\t        for (key in src) {\n\n\t            if (src.hasOwnProperty(key)) {\n\t                delete child[key]; // delete property inherited from parent\n\t                inheritedProperty = Object.getOwnPropertyDescriptor(src, key); // get new definition of property from src\n\t                Object.defineProperty(child, key, inheritedProperty); // re-add property with new definition (includes getter/setter methods)\n\t            }\n\t        }\n\t    }\n\n\t    return child;\n\t}\n\n\t// Accepts path data string, array of segments, array of Curves and/or Lines, or a Polyline.\n\tvar Path = function(arg) {\n\n\t    if (!(this instanceof Path)) {\n\t        return new Path(arg);\n\t    }\n\n\t    if (typeof arg === 'string') { // create from a path data string\n\t        return new Path.parse(arg);\n\t    }\n\n\t    this.segments = [];\n\n\t    var i;\n\t    var n;\n\n\t    if (!arg) {\n\t        // don't do anything\n\n\t    } else if (Array.isArray(arg) && arg.length !== 0) { // if arg is a non-empty array\n\t        // flatten one level deep\n\t        // so we can chain arbitrary Path.createSegment results\n\t        arg = arg.reduce(function(acc, val) {\n\t            return acc.concat(val);\n\t        }, []);\n\n\t        n = arg.length;\n\t        if (arg[0].isSegment) { // create from an array of segments\n\t            for (i = 0; i < n; i++) {\n\n\t                var segment = arg[i];\n\n\t                this.appendSegment(segment);\n\t            }\n\n\t        } else { // create from an array of Curves and/or Lines\n\t            var previousObj = null;\n\t            for (i = 0; i < n; i++) {\n\n\t                var obj = arg[i];\n\n\t                if (!((obj instanceof Line) || (obj instanceof Curve))) {\n\t                    throw new Error('Cannot construct a path segment from the provided object.');\n\t                }\n\n\t                if (i === 0) { this.appendSegment(Path.createSegment('M', obj.start)); }\n\n\t                // if objects do not link up, moveto segments are inserted to cover the gaps\n\t                if (previousObj && !previousObj.end.equals(obj.start)) { this.appendSegment(Path.createSegment('M', obj.start)); }\n\n\t                if (obj instanceof Line) {\n\t                    this.appendSegment(Path.createSegment('L', obj.end));\n\n\t                } else if (obj instanceof Curve) {\n\t                    this.appendSegment(Path.createSegment('C', obj.controlPoint1, obj.controlPoint2, obj.end));\n\t                }\n\n\t                previousObj = obj;\n\t            }\n\t        }\n\n\t    } else if (arg.isSegment) { // create from a single segment\n\t        this.appendSegment(arg);\n\n\t    } else if (arg instanceof Line) { // create from a single Line\n\t        this.appendSegment(Path.createSegment('M', arg.start));\n\t        this.appendSegment(Path.createSegment('L', arg.end));\n\n\t    } else if (arg instanceof Curve) { // create from a single Curve\n\t        this.appendSegment(Path.createSegment('M', arg.start));\n\t        this.appendSegment(Path.createSegment('C', arg.controlPoint1, arg.controlPoint2, arg.end));\n\n\t    } else if (arg instanceof Polyline) { // create from a Polyline\n\t        if (!(arg.points && (arg.points.length !== 0))) { return; } // if Polyline has no points, leave Path empty\n\n\t        n = arg.points.length;\n\t        for (i = 0; i < n; i++) {\n\n\t            var point = arg.points[i];\n\n\t            if (i === 0) { this.appendSegment(Path.createSegment('M', point)); }\n\t            else { this.appendSegment(Path.createSegment('L', point)); }\n\t        }\n\n\t    } else { // unknown object\n\t        throw new Error('Cannot construct a path from the provided object.');\n\t    }\n\t};\n\n\t// More permissive than V.normalizePathData and Path.prototype.serialize.\n\t// Allows path data strings that do not start with a Moveto command (unlike SVG specification).\n\t// Does not require spaces between elements; commas are allowed, separators may be omitted when unambiguous (e.g. 'ZM10,10', 'L1.6.8', 'M100-200').\n\t// Allows for command argument chaining.\n\t// Throws an error if wrong number of arguments is provided with a command.\n\t// Throws an error if an unrecognized path command is provided (according to Path.segmentTypes). Only a subset of SVG commands is currently supported (L, C, M, Z).\n\tPath.parse = function(pathData) {\n\n\t    if (!pathData) { return new Path(); }\n\n\t    var path = new Path();\n\n\t    var commandRe = /(?:[a-zA-Z] *)(?:(?:-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)? *,? *)|(?:-?\\.\\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\\d|-|\\.)/g;\n\t    var commands = pathData.match(commandRe);\n\n\t    var numCommands = commands.length;\n\t    for (var i = 0; i < numCommands; i++) {\n\n\t        var command = commands[i];\n\t        var argRe = /(?:[a-zA-Z])|(?:(?:-?\\d+(?:\\.\\d+)?(?:e[-+]?\\d+)?))|(?:(?:-?\\.\\d+))/g;\n\t        var args = command.match(argRe);\n\n\t        var segment = Path.createSegment.apply(this, args); // args = [type, coordinate1, coordinate2...]\n\t        path.appendSegment(segment);\n\t    }\n\n\t    return path;\n\t};\n\n\t// Create a segment or an array of segments.\n\t// Accepts unlimited points/coords arguments after `type`.\n\tPath.createSegment = function(type) {\n\t    var arguments$1 = arguments;\n\n\n\t    if (!type) { throw new Error('Type must be provided.'); }\n\n\t    var segmentConstructor = Path.segmentTypes[type];\n\t    if (!segmentConstructor) { throw new Error(type + ' is not a recognized path segment type.'); }\n\n\t    var args = [];\n\t    var n = arguments.length;\n\t    for (var i = 1; i < n; i++) { // do not add first element (`type`) to args array\n\t        args.push(arguments$1[i]);\n\t    }\n\n\t    return applyToNew(segmentConstructor, args);\n\t};\n\n\tPath.prototype = {\n\n\t    type: types.Path,\n\n\t    // Accepts one segment or an array of segments as argument.\n\t    // Throws an error if argument is not a segment or an array of segments.\n\t    appendSegment: function(arg) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        // works even if path has no segments\n\n\t        var currentSegment;\n\n\t        var previousSegment = ((numSegments !== 0) ? segments[numSegments - 1] : null); // if we are appending to an empty path, previousSegment is null\n\t        var nextSegment = null;\n\n\t        if (!Array.isArray(arg)) { // arg is a segment\n\t            if (!arg || !arg.isSegment) { throw new Error('Segment required.'); }\n\n\t            currentSegment = this.prepareSegment(arg, previousSegment, nextSegment);\n\t            segments.push(currentSegment);\n\n\t        } else { // arg is an array of segments\n\t            // flatten one level deep\n\t            // so we can chain arbitrary Path.createSegment results\n\t            arg = arg.reduce(function(acc, val) {\n\t                return acc.concat(val);\n\t            }, []);\n\n\t            if (!arg[0].isSegment) { throw new Error('Segments required.'); }\n\n\t            var n = arg.length;\n\t            for (var i = 0; i < n; i++) {\n\n\t                var currentArg = arg[i];\n\t                currentSegment = this.prepareSegment(currentArg, previousSegment, nextSegment);\n\t                segments.push(currentSegment);\n\t                previousSegment = currentSegment;\n\t            }\n\t        }\n\t    },\n\n\t    // Returns the bbox of the path.\n\t    // If path has no segments, returns null.\n\t    // If path has only invisible segments, returns bbox of the end point of last segment.\n\t    bbox: function() {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        var bbox;\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            if (segment.isVisible) {\n\t                var segmentBBox = segment.bbox();\n\t                bbox = bbox ? bbox.union(segmentBBox) : segmentBBox;\n\t            }\n\t        }\n\n\t        if (bbox) { return bbox; }\n\n\t        // if the path has only invisible elements, return end point of last segment\n\t        var lastSegment = segments[numSegments - 1];\n\t        return new Rect(lastSegment.end.x, lastSegment.end.y, 0, 0);\n\t    },\n\n\t    // Returns a new path that is a clone of this path.\n\t    clone: function() {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        // works even if path has no segments\n\n\t        var path = new Path();\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i].clone();\n\t            path.appendSegment(segment);\n\t        }\n\n\t        return path;\n\t    },\n\n\t    closestPoint: function(p, opt) {\n\n\t        var t = this.closestPointT(p, opt);\n\t        if (!t) { return null; }\n\n\t        return this.pointAtT(t);\n\t    },\n\n\t    closestPointLength: function(p, opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        var localOpt = { precision: precision, segmentSubdivisions: segmentSubdivisions };\n\n\t        var t = this.closestPointT(p, localOpt);\n\t        if (!t) { return 0; }\n\n\t        return this.lengthAtT(t, localOpt);\n\t    },\n\n\t    closestPointNormalizedLength: function(p, opt) {\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        var localOpt = { precision: precision, segmentSubdivisions: segmentSubdivisions };\n\n\t        var cpLength = this.closestPointLength(p, localOpt);\n\t        if (cpLength === 0) { return 0; } // shortcut\n\n\t        var length = this.length(localOpt);\n\t        if (length === 0) { return 0; } // prevents division by zero\n\n\t        return cpLength / length;\n\t    },\n\n\t    // Private function.\n\t    closestPointT: function(p, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var closestPointT;\n\t        var minSquaredDistance = Infinity;\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            var subdivisions = segmentSubdivisions[i];\n\n\t            if (segment.isVisible) {\n\t                var segmentClosestPointT = segment.closestPointT(p, {\n\t                    precision: precision,\n\t                    subdivisions: subdivisions\n\t                });\n\t                var segmentClosestPoint = segment.pointAtT(segmentClosestPointT);\n\t                var squaredDistance = (new Line(segmentClosestPoint, p)).squaredLength();\n\n\t                if (squaredDistance < minSquaredDistance) {\n\t                    closestPointT = { segmentIndex: i, value: segmentClosestPointT };\n\t                    minSquaredDistance = squaredDistance;\n\t                }\n\t            }\n\t        }\n\n\t        if (closestPointT) { return closestPointT; }\n\n\t        // if no visible segment, return end of last segment\n\t        return { segmentIndex: numSegments - 1, value: 1 };\n\t    },\n\n\t    closestPointTangent: function(p, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var closestPointTangent;\n\t        var minSquaredDistance = Infinity;\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            var subdivisions = segmentSubdivisions[i];\n\n\t            if (segment.isDifferentiable()) {\n\t                var segmentClosestPointT = segment.closestPointT(p, {\n\t                    precision: precision,\n\t                    subdivisions: subdivisions\n\t                });\n\t                var segmentClosestPoint = segment.pointAtT(segmentClosestPointT);\n\t                var squaredDistance = (new Line(segmentClosestPoint, p)).squaredLength();\n\n\t                if (squaredDistance < minSquaredDistance) {\n\t                    closestPointTangent = segment.tangentAtT(segmentClosestPointT);\n\t                    minSquaredDistance = squaredDistance;\n\t                }\n\t            }\n\t        }\n\n\t        if (closestPointTangent) { return closestPointTangent; }\n\n\t        // if no valid segment, return null\n\t        return null;\n\t    },\n\n\t    // Returns `true` if the area surrounded by the path contains the point `p`.\n\t    // Implements the even-odd algorithm (self-intersections are \"outside\").\n\t    // Closes open paths (always imagines a final closing segment).\n\t    // Precision may be adjusted by passing an `opt` object.\n\t    containsPoint: function(p, opt) {\n\n\t        var polylines = this.toPolylines(opt);\n\t        if (!polylines) { return false; } // shortcut (this path has no polylines)\n\n\t        var numPolylines = polylines.length;\n\n\t        // how many component polylines does `p` lie within?\n\t        var numIntersections = 0;\n\t        for (var i = 0; i < numPolylines; i++) {\n\t            var polyline = polylines[i];\n\t            if (polyline.containsPoint(p)) {\n\t                // `p` lies within this polyline\n\t                numIntersections++;\n\t            }\n\t        }\n\n\t        // returns `true` for odd numbers of intersections (even-odd algorithm)\n\t        return ((numIntersections % 2) === 1);\n\t    },\n\n\t    // Divides the path into two at requested `ratio` between 0 and 1 with precision better than `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    divideAt: function(ratio, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        if (ratio < 0) { ratio = 0; }\n\t        if (ratio > 1) { ratio = 1; }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        var localOpt = { precision: precision, segmentSubdivisions: segmentSubdivisions };\n\n\t        var pathLength = this.length(localOpt);\n\t        var length = pathLength * ratio;\n\n\t        return this.divideAtLength(length, localOpt);\n\t    },\n\n\t    // Divides the path into two at requested `length` with precision better than requested `opt.precision`; optionally using `opt.subdivisions` provided.\n\t    divideAtLength: function(length, opt) {\n\n\t        var numSegments = this.segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var i;\n\t        var segment;\n\n\t        // identify the segment to divide:\n\n\t        var l = 0; // length so far\n\t        var divided;\n\t        var dividedSegmentIndex;\n\t        var lastValidSegment; // visible AND differentiable\n\t        var lastValidSegmentIndex;\n\t        var t;\n\t        for (i = 0; i < numSegments; i++) {\n\t            var index = (fromStart ? i : (numSegments - 1 - i));\n\n\t            segment = this.getSegment(index);\n\t            var subdivisions = segmentSubdivisions[index];\n\t            var d = segment.length({ precision: precision, subdivisions: subdivisions });\n\n\t            if (segment.isDifferentiable()) { // segment is not just a point\n\t                lastValidSegment = segment;\n\t                lastValidSegmentIndex = index;\n\n\t                if (length <= (l + d)) {\n\t                    dividedSegmentIndex = index;\n\t                    divided = segment.divideAtLength(((fromStart ? 1 : -1) * (length - l)), {\n\t                        precision: precision,\n\t                        subdivisions: subdivisions\n\t                    });\n\t                    break;\n\t                }\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        if (!lastValidSegment) { // no valid segment found\n\t            return null;\n\t        }\n\n\t        // else: the path contains at least one valid segment\n\n\t        if (!divided) { // the desired length is greater than the length of the path\n\t            dividedSegmentIndex = lastValidSegmentIndex;\n\t            t = (fromStart ? 1 : 0);\n\t            divided = lastValidSegment.divideAtT(t);\n\t        }\n\n\t        // create a copy of this path and replace the identified segment with its two divided parts:\n\n\t        var pathCopy = this.clone();\n\t        pathCopy.replaceSegment(dividedSegmentIndex, divided);\n\n\t        var divisionStartIndex = dividedSegmentIndex;\n\t        var divisionMidIndex = dividedSegmentIndex + 1;\n\t        var divisionEndIndex = dividedSegmentIndex + 2;\n\n\t        // do not insert the part if it looks like a point\n\t        if (!divided[0].isDifferentiable()) {\n\t            pathCopy.removeSegment(divisionStartIndex);\n\t            divisionMidIndex -= 1;\n\t            divisionEndIndex -= 1;\n\t        }\n\n\t        // insert a Moveto segment to ensure secondPath will be valid:\n\t        var movetoEnd = pathCopy.getSegment(divisionMidIndex).start;\n\t        pathCopy.insertSegment(divisionMidIndex, Path.createSegment('M', movetoEnd));\n\t        divisionEndIndex += 1;\n\n\t        // do not insert the part if it looks like a point\n\t        if (!divided[1].isDifferentiable()) {\n\t            pathCopy.removeSegment(divisionEndIndex - 1);\n\t            divisionEndIndex -= 1;\n\t        }\n\n\t        // ensure that Closepath segments in secondPath will be assigned correct subpathStartSegment:\n\n\t        var secondPathSegmentIndexConversion = divisionEndIndex - divisionStartIndex - 1;\n\t        for (i = divisionEndIndex; i < pathCopy.segments.length; i++) {\n\n\t            var originalSegment = this.getSegment(i - secondPathSegmentIndexConversion);\n\t            segment = pathCopy.getSegment(i);\n\n\t            if ((segment.type === 'Z') && !originalSegment.subpathStartSegment.end.equals(segment.subpathStartSegment.end)) {\n\t                // pathCopy segment's subpathStartSegment is different from original segment's one\n\t                // convert this Closepath segment to a Lineto and replace it in pathCopy\n\t                var convertedSegment = Path.createSegment('L', originalSegment.end);\n\t                pathCopy.replaceSegment(i, convertedSegment);\n\t            }\n\t        }\n\n\t        // distribute pathCopy segments into two paths and return those:\n\n\t        var firstPath = new Path(pathCopy.segments.slice(0, divisionMidIndex));\n\t        var secondPath = new Path(pathCopy.segments.slice(divisionMidIndex));\n\n\t        return [firstPath, secondPath];\n\t    },\n\n\t    // Checks whether two paths are exactly the same.\n\t    // If `p` is undefined or null, returns false.\n\t    equals: function(p) {\n\n\t        if (!p) { return false; }\n\n\t        var segments = this.segments;\n\t        var otherSegments = p.segments;\n\n\t        var numSegments = segments.length;\n\t        if (otherSegments.length !== numSegments) { return false; } // if the two paths have different number of segments, they cannot be equal\n\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            var otherSegment = otherSegments[i];\n\n\t            // as soon as an inequality is found in segments, return false\n\t            if ((segment.type !== otherSegment.type) || (!segment.equals(otherSegment))) { return false; }\n\t        }\n\n\t        // if no inequality found in segments, return true\n\t        return true;\n\t    },\n\n\t    // Accepts negative indices.\n\t    // Throws an error if path has no segments.\n\t    // Throws an error if index is out of range.\n\t    getSegment: function(index) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { throw new Error('Path has no segments.'); }\n\n\t        if (index < 0) { index = numSegments + index; } // convert negative indices to positive\n\t        if (index >= numSegments || index < 0) { throw new Error('Index out of range.'); }\n\n\t        return segments[index];\n\t    },\n\n\t    // Returns an array of segment subdivisions, with precision better than requested `opt.precision`.\n\t    getSegmentSubdivisions: function(opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        // works even if path has no segments\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        // not using opt.segmentSubdivisions\n\t        // not using localOpt\n\n\t        var segmentSubdivisions = [];\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            var subdivisions = segment.getSubdivisions({ precision: precision });\n\t            segmentSubdivisions.push(subdivisions);\n\t        }\n\n\t        return segmentSubdivisions;\n\t    },\n\n\t    // Returns an array of subpaths of this path.\n\t    // Invalid paths are validated first.\n\t    // Returns `[]` if path has no segments.\n\t    getSubpaths: function() {\n\n\t        var validatedPath = this.clone().validate();\n\n\t        var segments = validatedPath.segments;\n\t        var numSegments = segments.length;\n\n\t        var subpaths = [];\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            if (segment.isSubpathStart) {\n\t                // we encountered a subpath start segment\n\t                // create a new path for segment, and push it to list of subpaths\n\t                subpaths.push(new Path(segment));\n\n\t            } else {\n\t                // append current segment to the last subpath\n\t                subpaths[subpaths.length - 1].appendSegment(segment);\n\t            }\n\t        }\n\n\t        return subpaths;\n\t    },\n\n\t    // Insert `arg` at given `index`.\n\t    // `index = 0` means insert at the beginning.\n\t    // `index = segments.length` means insert at the end.\n\t    // Accepts negative indices, from `-1` to `-(segments.length + 1)`.\n\t    // Accepts one segment or an array of segments as argument.\n\t    // Throws an error if index is out of range.\n\t    // Throws an error if argument is not a segment or an array of segments.\n\t    insertSegment: function(index, arg) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        // works even if path has no segments\n\n\t        // note that these are incremented compared to getSegments()\n\t        // we can insert after last element (note that this changes the meaning of index -1)\n\t        if (index < 0) { index = numSegments + index + 1; } // convert negative indices to positive\n\t        if (index > numSegments || index < 0) { throw new Error('Index out of range.'); }\n\n\t        var currentSegment;\n\n\t        var previousSegment = null;\n\t        var nextSegment = null;\n\n\t        if (numSegments !== 0) {\n\t            if (index >= 1) {\n\t                previousSegment = segments[index - 1];\n\t                nextSegment = previousSegment.nextSegment; // if we are inserting at end, nextSegment is null\n\n\t            } else { // if index === 0\n\t                // previousSegment is null\n\t                nextSegment = segments[0];\n\t            }\n\t        }\n\n\t        if (!Array.isArray(arg)) {\n\t            if (!arg || !arg.isSegment) { throw new Error('Segment required.'); }\n\n\t            currentSegment = this.prepareSegment(arg, previousSegment, nextSegment);\n\t            segments.splice(index, 0, currentSegment);\n\n\t        } else {\n\t            // flatten one level deep\n\t            // so we can chain arbitrary Path.createSegment results\n\t            arg = arg.reduce(function(acc, val) {\n\t                return acc.concat(val);\n\t            }, []);\n\n\t            if (!arg[0].isSegment) { throw new Error('Segments required.'); }\n\n\t            var n = arg.length;\n\t            for (var i = 0; i < n; i++) {\n\n\t                var currentArg = arg[i];\n\t                currentSegment = this.prepareSegment(currentArg, previousSegment, nextSegment);\n\t                segments.splice((index + i), 0, currentSegment); // incrementing index to insert subsequent segments after inserted segments\n\t                previousSegment = currentSegment;\n\t            }\n\t        }\n\t    },\n\n\t    intersectionWithLine: function(line, opt) {\n\n\t        var intersection = null;\n\t        var polylines = this.toPolylines(opt);\n\t        if (!polylines) { return null; }\n\t        for (var i = 0, n = polylines.length; i < n; i++) {\n\t            var polyline = polylines[i];\n\t            var polylineIntersection = line.intersect(polyline);\n\t            if (polylineIntersection) {\n\t                intersection || (intersection = []);\n\t                if (Array.isArray(polylineIntersection)) {\n\t                    Array.prototype.push.apply(intersection, polylineIntersection);\n\t                } else {\n\t                    intersection.push(polylineIntersection);\n\t                }\n\t            }\n\t        }\n\n\t        return intersection;\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            // as soon as a differentiable segment is found in segments, return true\n\t            if (segment.isDifferentiable()) { return true; }\n\t        }\n\n\t        // if no differentiable segment is found in segments, return false\n\t        return false;\n\t    },\n\n\t    // Checks whether current path segments are valid.\n\t    // Note that d is allowed to be empty - should disable rendering of the path.\n\t    isValid: function() {\n\n\t        var segments = this.segments;\n\t        var isValid = (segments.length === 0) || (segments[0].type === 'M'); // either empty or first segment is a Moveto\n\t        return isValid;\n\t    },\n\n\t    // Returns length of the path, with precision better than requested `opt.precision`; or using `opt.segmentSubdivisions` provided.\n\t    // If path has no segments, returns 0.\n\t    length: function(opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return 0; } // if segments is an empty array\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision; // opt.precision only used in getSegmentSubdivisions() call\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var length = 0;\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            var subdivisions = segmentSubdivisions[i];\n\t            length += segment.length({ subdivisions: subdivisions });\n\t        }\n\n\t        return length;\n\t    },\n\n\t    // Private function.\n\t    lengthAtT: function(t, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return 0; } // if segments is an empty array\n\n\t        var segmentIndex = t.segmentIndex;\n\t        if (segmentIndex < 0) { return 0; } // regardless of t.value\n\n\t        var tValue = t.value;\n\t        if (segmentIndex >= numSegments) {\n\t            segmentIndex = numSegments - 1;\n\t            tValue = 1;\n\t        } else if (tValue < 0) { tValue = 0; }\n\t        else if (tValue > 1) { tValue = 1; }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var subdivisions;\n\t        var length = 0;\n\t        for (var i = 0; i < segmentIndex; i++) {\n\n\t            var segment = segments[i];\n\t            subdivisions = segmentSubdivisions[i];\n\t            length += segment.length({ precisison: precision, subdivisions: subdivisions });\n\t        }\n\n\t        segment = segments[segmentIndex];\n\t        subdivisions = segmentSubdivisions[segmentIndex];\n\t        length += segment.lengthAtT(tValue, { precisison: precision, subdivisions: subdivisions });\n\n\t        return length;\n\t    },\n\n\t    // Returns point at requested `ratio` between 0 and 1, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\n\t    pointAt: function(ratio, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        if (ratio <= 0) { return this.start.clone(); }\n\t        if (ratio >= 1) { return this.end.clone(); }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        var localOpt = { precision: precision, segmentSubdivisions: segmentSubdivisions };\n\n\t        var pathLength = this.length(localOpt);\n\t        var length = pathLength * ratio;\n\n\t        return this.pointAtLength(length, localOpt);\n\t    },\n\n\t    // Returns point at requested `length`, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\n\t    // Accepts negative length.\n\t    pointAtLength: function(length, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        if (length === 0) { return this.start.clone(); }\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var lastVisibleSegment;\n\t        var l = 0; // length so far\n\t        for (var i = 0; i < numSegments; i++) {\n\t            var index = (fromStart ? i : (numSegments - 1 - i));\n\n\t            var segment = segments[index];\n\t            var subdivisions = segmentSubdivisions[index];\n\t            var d = segment.length({ precision: precision, subdivisions: subdivisions });\n\n\t            if (segment.isVisible) {\n\t                if (length <= (l + d)) {\n\t                    return segment.pointAtLength(((fromStart ? 1 : -1) * (length - l)), {\n\t                        precision: precision,\n\t                        subdivisions: subdivisions\n\t                    });\n\t                }\n\n\t                lastVisibleSegment = segment;\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        // if length requested is higher than the length of the path, return last visible segment endpoint\n\t        if (lastVisibleSegment) { return (fromStart ? lastVisibleSegment.end : lastVisibleSegment.start); }\n\n\t        // if no visible segment, return last segment end point (no matter if fromStart or no)\n\t        var lastSegment = segments[numSegments - 1];\n\t        return lastSegment.end.clone();\n\t    },\n\n\t    // Private function.\n\t    pointAtT: function(t) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        var segmentIndex = t.segmentIndex;\n\t        if (segmentIndex < 0) { return segments[0].pointAtT(0); }\n\t        if (segmentIndex >= numSegments) { return segments[numSegments - 1].pointAtT(1); }\n\n\t        var tValue = t.value;\n\t        if (tValue < 0) { tValue = 0; }\n\t        else if (tValue > 1) { tValue = 1; }\n\n\t        return segments[segmentIndex].pointAtT(tValue);\n\t    },\n\n\t    // Default precision\n\t    PRECISION: 3,\n\n\t    // Helper method for adding segments.\n\t    prepareSegment: function(segment, previousSegment, nextSegment) {\n\n\t        // insert after previous segment and before previous segment's next segment\n\t        segment.previousSegment = previousSegment;\n\t        segment.nextSegment = nextSegment;\n\t        if (previousSegment) { previousSegment.nextSegment = segment; }\n\t        if (nextSegment) { nextSegment.previousSegment = segment; }\n\n\t        var updateSubpathStart = segment;\n\t        if (segment.isSubpathStart) {\n\t            segment.subpathStartSegment = segment; // assign self as subpath start segment\n\t            updateSubpathStart = nextSegment; // start updating from next segment\n\t        }\n\n\t        // assign previous segment's subpath start (or self if it is a subpath start) to subsequent segments\n\t        if (updateSubpathStart) { this.updateSubpathStartSegment(updateSubpathStart); }\n\n\t        return segment;\n\t    },\n\n\t    // Remove the segment at `index`.\n\t    // Accepts negative indices, from `-1` to `-segments.length`.\n\t    // Throws an error if path has no segments.\n\t    // Throws an error if index is out of range.\n\t    removeSegment: function(index) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { throw new Error('Path has no segments.'); }\n\n\t        if (index < 0) { index = numSegments + index; } // convert negative indices to positive\n\t        if (index >= numSegments || index < 0) { throw new Error('Index out of range.'); }\n\n\t        var removedSegment = segments.splice(index, 1)[0];\n\t        var previousSegment = removedSegment.previousSegment;\n\t        var nextSegment = removedSegment.nextSegment;\n\n\t        // link the previous and next segments together (if present)\n\t        if (previousSegment) { previousSegment.nextSegment = nextSegment; } // may be null\n\t        if (nextSegment) { nextSegment.previousSegment = previousSegment; } // may be null\n\n\t        // if removed segment used to start a subpath, update all subsequent segments until another subpath start segment is reached\n\t        if (removedSegment.isSubpathStart && nextSegment) { this.updateSubpathStartSegment(nextSegment); }\n\t    },\n\n\t    // Replace the segment at `index` with `arg`.\n\t    // Accepts negative indices, from `-1` to `-segments.length`.\n\t    // Accepts one segment or an array of segments as argument.\n\t    // Throws an error if path has no segments.\n\t    // Throws an error if index is out of range.\n\t    // Throws an error if argument is not a segment or an array of segments.\n\t    replaceSegment: function(index, arg) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { throw new Error('Path has no segments.'); }\n\n\t        if (index < 0) { index = numSegments + index; } // convert negative indices to positive\n\t        if (index >= numSegments || index < 0) { throw new Error('Index out of range.'); }\n\n\t        var currentSegment;\n\n\t        var replacedSegment = segments[index];\n\t        var previousSegment = replacedSegment.previousSegment;\n\t        var nextSegment = replacedSegment.nextSegment;\n\n\t        var updateSubpathStart = replacedSegment.isSubpathStart; // boolean: is an update of subpath starts necessary?\n\n\t        if (!Array.isArray(arg)) {\n\t            if (!arg || !arg.isSegment) { throw new Error('Segment required.'); }\n\n\t            currentSegment = this.prepareSegment(arg, previousSegment, nextSegment);\n\t            segments.splice(index, 1, currentSegment); // directly replace\n\n\t            if (updateSubpathStart && currentSegment.isSubpathStart) { updateSubpathStart = false; } // already updated by `prepareSegment`\n\n\t        } else {\n\t            // flatten one level deep\n\t            // so we can chain arbitrary Path.createSegment results\n\t            arg = arg.reduce(function(acc, val) {\n\t                return acc.concat(val);\n\t            }, []);\n\n\t            if (!arg[0].isSegment) { throw new Error('Segments required.'); }\n\n\t            segments.splice(index, 1);\n\n\t            var n = arg.length;\n\t            for (var i = 0; i < n; i++) {\n\n\t                var currentArg = arg[i];\n\t                currentSegment = this.prepareSegment(currentArg, previousSegment, nextSegment);\n\t                segments.splice((index + i), 0, currentSegment); // incrementing index to insert subsequent segments after inserted segments\n\t                previousSegment = currentSegment;\n\n\t                if (updateSubpathStart && currentSegment.isSubpathStart) { updateSubpathStart = false; } // already updated by `prepareSegment`\n\t            }\n\t        }\n\n\t        // if replaced segment used to start a subpath and no new subpath start was added, update all subsequent segments until another subpath start segment is reached\n\t        if (updateSubpathStart && nextSegment) { this.updateSubpathStartSegment(nextSegment); }\n\t    },\n\n\t    round: function(precision) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            segment.round(precision);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            segment.scale(sx, sy, origin);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    segmentAt: function(ratio, opt) {\n\n\t        var index = this.segmentIndexAt(ratio, opt);\n\t        if (!index) { return null; }\n\n\t        return this.getSegment(index);\n\t    },\n\n\t    // Accepts negative length.\n\t    segmentAtLength: function(length, opt) {\n\n\t        var index = this.segmentIndexAtLength(length, opt);\n\t        if (!index) { return null; }\n\n\t        return this.getSegment(index);\n\t    },\n\n\t    segmentIndexAt: function(ratio, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        if (ratio < 0) { ratio = 0; }\n\t        if (ratio > 1) { ratio = 1; }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        var localOpt = { precision: precision, segmentSubdivisions: segmentSubdivisions };\n\n\t        var pathLength = this.length(localOpt);\n\t        var length = pathLength * ratio;\n\n\t        return this.segmentIndexAtLength(length, localOpt);\n\t    },\n\n\t    // Accepts negative length.\n\t    segmentIndexAtLength: function(length, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var lastVisibleSegmentIndex = null;\n\t        var l = 0; // length so far\n\t        for (var i = 0; i < numSegments; i++) {\n\t            var index = (fromStart ? i : (numSegments - 1 - i));\n\n\t            var segment = segments[index];\n\t            var subdivisions = segmentSubdivisions[index];\n\t            var d = segment.length({ precision: precision, subdivisions: subdivisions });\n\n\t            if (segment.isVisible) {\n\t                if (length <= (l + d)) { return index; }\n\t                lastVisibleSegmentIndex = index;\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        // if length requested is higher than the length of the path, return last visible segment index\n\t        // if no visible segment, return null\n\t        return lastVisibleSegmentIndex;\n\t    },\n\n\t    // Returns a string that can be used to reconstruct the path.\n\t    // Additional error checking compared to toString (must start with M segment).\n\t    serialize: function() {\n\n\t        if (!this.isValid()) { throw new Error('Invalid path segments.'); }\n\n\t        return this.toString();\n\t    },\n\n\t    // Returns tangent line at requested `ratio` between 0 and 1, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\n\t    tangentAt: function(ratio, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        if (ratio < 0) { ratio = 0; }\n\t        if (ratio > 1) { ratio = 1; }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        var localOpt = { precision: precision, segmentSubdivisions: segmentSubdivisions };\n\n\t        var pathLength = this.length(localOpt);\n\t        var length = pathLength * ratio;\n\n\t        return this.tangentAtLength(length, localOpt);\n\t    },\n\n\t    // Returns tangent line at requested `length`, with precision better than requested `opt.precision`; optionally using `opt.segmentSubdivisions` provided.\n\t    // Accepts negative length.\n\t    tangentAtLength: function(length, opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        var fromStart = true;\n\t        if (length < 0) {\n\t            fromStart = false; // negative lengths mean start calculation from end point\n\t            length = -length; // absolute value\n\t        }\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\t        // not using localOpt\n\n\t        var lastValidSegment; // visible AND differentiable (with a tangent)\n\t        var l = 0; // length so far\n\t        for (var i = 0; i < numSegments; i++) {\n\t            var index = (fromStart ? i : (numSegments - 1 - i));\n\n\t            var segment = segments[index];\n\t            var subdivisions = segmentSubdivisions[index];\n\t            var d = segment.length({ precision: precision, subdivisions: subdivisions });\n\n\t            if (segment.isDifferentiable()) {\n\t                if (length <= (l + d)) {\n\t                    return segment.tangentAtLength(((fromStart ? 1 : -1) * (length - l)), {\n\t                        precision: precision,\n\t                        subdivisions: subdivisions\n\t                    });\n\t                }\n\n\t                lastValidSegment = segment;\n\t            }\n\n\t            l += d;\n\t        }\n\n\t        // if length requested is higher than the length of the path, return tangent of endpoint of last valid segment\n\t        if (lastValidSegment) {\n\t            var t = (fromStart ? 1 : 0);\n\t            return lastValidSegment.tangentAtT(t);\n\t        }\n\n\t        // if no valid segment, return null\n\t        return null;\n\t    },\n\n\t    // Private function.\n\t    tangentAtT: function(t) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        var segmentIndex = t.segmentIndex;\n\t        if (segmentIndex < 0) { return segments[0].tangentAtT(0); }\n\t        if (segmentIndex >= numSegments) { return segments[numSegments - 1].tangentAtT(1); }\n\n\t        var tValue = t.value;\n\t        if (tValue < 0) { tValue = 0; }\n\t        else if (tValue > 1) { tValue = 1; }\n\n\t        return segments[segmentIndex].tangentAtT(tValue);\n\t    },\n\n\t    toPoints: function(opt) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; } // if segments is an empty array\n\n\t        opt = opt || {};\n\t        var precision = (opt.precision === undefined) ? this.PRECISION : opt.precision;\n\t        var segmentSubdivisions = (opt.segmentSubdivisions === undefined) ? this.getSegmentSubdivisions({ precision: precision }) : opt.segmentSubdivisions;\n\n\t        var points = [];\n\t        var partialPoints = [];\n\t        for (var i = 0; i < numSegments; i++) {\n\t            var segment = segments[i];\n\t            if (segment.isVisible) {\n\t                var currentSegmentSubdivisions = segmentSubdivisions[i];\n\t                if (currentSegmentSubdivisions.length > 0) {\n\t                    var subdivisionPoints = currentSegmentSubdivisions.map(function(curve) {\n\t                        return curve.start;\n\t                    });\n\t                    Array.prototype.push.apply(partialPoints, subdivisionPoints);\n\t                } else {\n\t                    partialPoints.push(segment.start);\n\t                }\n\t            } else if (partialPoints.length > 0) {\n\t                partialPoints.push(segments[i - 1].end);\n\t                points.push(partialPoints);\n\t                partialPoints = [];\n\t            }\n\t        }\n\n\t        if (partialPoints.length > 0) {\n\t            partialPoints.push(this.end);\n\t            points.push(partialPoints);\n\t        }\n\t        return points;\n\t    },\n\n\t    toPolylines: function(opt) {\n\n\t        var polylines = [];\n\t        var points = this.toPoints(opt);\n\t        if (!points) { return null; }\n\t        for (var i = 0, n = points.length; i < n; i++) {\n\t            polylines.push(new Polyline(points[i]));\n\t        }\n\n\t        return polylines;\n\t    },\n\n\t    toString: function() {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\n\t        var pathData = '';\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            pathData += segment.serialize() + ' ';\n\t        }\n\n\t        return pathData.trim();\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            segment.translate(tx, ty);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    // Helper method for updating subpath start of segments, starting with the one provided.\n\t    updateSubpathStartSegment: function(segment) {\n\n\t        var previousSegment = segment.previousSegment; // may be null\n\t        while (segment && !segment.isSubpathStart) {\n\n\t            // assign previous segment's subpath start segment to this segment\n\t            if (previousSegment) { segment.subpathStartSegment = previousSegment.subpathStartSegment; } // may be null\n\t            else { segment.subpathStartSegment = null; } // if segment had no previous segment, assign null - creates an invalid path!\n\n\t            previousSegment = segment;\n\t            segment = segment.nextSegment; // move on to the segment after etc.\n\t        }\n\t    },\n\n\t    // If the path is not valid, insert M 0 0 at the beginning.\n\t    // Path with no segments is considered valid, so nothing is inserted.\n\t    validate: function() {\n\n\t        if (!this.isValid()) { this.insertSegment(0, Path.createSegment('M', 0, 0)); }\n\t        return this;\n\t    }\n\t};\n\n\tObject.defineProperty(Path.prototype, 'start', {\n\t    // Getter for the first visible endpoint of the path.\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; }\n\n\t        for (var i = 0; i < numSegments; i++) {\n\n\t            var segment = segments[i];\n\t            if (segment.isVisible) { return segment.start; }\n\t        }\n\n\t        // if no visible segment, return last segment end point\n\t        return segments[numSegments - 1].end;\n\t    }\n\t});\n\n\tObject.defineProperty(Path.prototype, 'end', {\n\t    // Getter for the last visible endpoint of the path.\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        var segments = this.segments;\n\t        var numSegments = segments.length;\n\t        if (numSegments === 0) { return null; }\n\n\t        for (var i = numSegments - 1; i >= 0; i--) {\n\n\t            var segment = segments[i];\n\t            if (segment.isVisible) { return segment.end; }\n\t        }\n\n\t        // if no visible segment, return last segment end point\n\t        return segments[numSegments - 1].end;\n\t    }\n\t});\n\n\n\t// Local helper function.\n\t// Use an array of arguments to call a constructor (function called with `new`).\n\t// Adapted from https://stackoverflow.com/a/8843181/2263595\n\t// It is not necessary to use this function if the arguments can be passed separately (i.e. if the number of arguments is limited).\n\t// - If that is the case, use `new constructor(arg1, arg2)`, for example.\n\t// It is not necessary to use this function if the function that needs an array of arguments is not supposed to be used as a constructor.\n\t// - If that is the case, use `f.apply(thisArg, [arg1, arg2...])`, for example.\n\tfunction applyToNew(constructor, argsArray) {\n\t    // The `new` keyword can only be applied to functions that take a limited number of arguments.\n\t    // - We can fake that with .bind().\n\t    // - It calls a function (`constructor`, here) with the arguments that were provided to it - effectively transforming an unlimited number of arguments into limited.\n\t    // - So `new (constructor.bind(thisArg, arg1, arg2...))`\n\t    // - `thisArg` can be anything (e.g. null) because `new` keyword resets context to the constructor object.\n\t    // We need to pass in a variable number of arguments to the bind() call.\n\t    // - We can use .apply().\n\t    // - So `new (constructor.bind.apply(constructor, [thisArg, arg1, arg2...]))`\n\t    // - `thisArg` can still be anything because `new` overwrites it.\n\t    // Finally, to make sure that constructor.bind overwriting is not a problem, we switch to `Function.prototype.bind`.\n\t    // - So, the final version is `new (Function.prototype.bind.apply(constructor, [thisArg, arg1, arg2...]))`\n\n\t    // The function expects `argsArray[0]` to be `thisArg`.\n\t    // - This means that whatever is sent as the first element will be ignored.\n\t    // - The constructor will only see arguments starting from argsArray[1].\n\t    // - So, a new dummy element is inserted at the start of the array.\n\t    argsArray.unshift(null);\n\n\t    return new (Function.prototype.bind.apply(constructor, argsArray));\n\t}\n\n\t// Path segment interface:\n\tvar segmentPrototype = {\n\n\t    // virtual\n\t    bbox: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    clone: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    closestPoint: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    closestPointLength: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    closestPointNormalizedLength: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // Redirect calls to closestPointNormalizedLength() function if closestPointT() is not defined for segment.\n\t    closestPointT: function(p) {\n\n\t        if (this.closestPointNormalizedLength) { return this.closestPointNormalizedLength(p); }\n\n\t        throw new Error('Neither closestPointT() nor closestPointNormalizedLength() function is implemented.');\n\t    },\n\n\t    // virtual\n\t    closestPointTangent: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    divideAt: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    divideAtLength: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // Redirect calls to divideAt() function if divideAtT() is not defined for segment.\n\t    divideAtT: function(t) {\n\n\t        if (this.divideAt) { return this.divideAt(t); }\n\n\t        throw new Error('Neither divideAtT() nor divideAt() function is implemented.');\n\t    },\n\n\t    // virtual\n\t    equals: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    getSubdivisions: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    isDifferentiable: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    isSegment: true,\n\n\t    isSubpathStart: false, // true for Moveto segments\n\n\t    isVisible: true, // false for Moveto segments\n\n\t    // virtual\n\t    length: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // Return a fraction of result of length() function if lengthAtT() is not defined for segment.\n\t    lengthAtT: function(t) {\n\n\t        if (t <= 0) { return 0; }\n\n\t        var length = this.length();\n\n\t        if (t >= 1) { return length; }\n\n\t        return length * t;\n\t    },\n\n\t    nextSegment: null, // needed for subpath start segment updating\n\n\t    // virtual\n\t    pointAt: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    pointAtLength: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // Redirect calls to pointAt() function if pointAtT() is not defined for segment.\n\t    pointAtT: function(t) {\n\n\t        if (this.pointAt) { return this.pointAt(t); }\n\n\t        throw new Error('Neither pointAtT() nor pointAt() function is implemented.');\n\t    },\n\n\t    previousSegment: null, // needed to get segment start property\n\n\t    // virtual\n\t    round: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    subpathStartSegment: null, // needed to get Closepath segment end property\n\n\t    // virtual\n\t    scale: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    serialize: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    tangentAt: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    tangentAtLength: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // Redirect calls to tangentAt() function if tangentAtT() is not defined for segment.\n\t    tangentAtT: function(t) {\n\n\t        if (this.tangentAt) { return this.tangentAt(t); }\n\n\t        throw new Error('Neither tangentAtT() nor tangentAt() function is implemented.');\n\t    },\n\n\t    // virtual\n\t    toString: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    },\n\n\t    // virtual\n\t    translate: function() {\n\n\t        throw new Error('Declaration missing for virtual function.');\n\t    }\n\t};\n\n\t// usually directly assigned\n\t// getter for Closepath\n\tObject.defineProperty(segmentPrototype, 'end', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    writable: true\n\t});\n\n\t// always a getter\n\t// always throws error for Moveto\n\tObject.defineProperty(segmentPrototype, 'start', {\n\t    // get a reference to the end point of previous segment\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        if (!this.previousSegment) { throw new Error('Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)'); }\n\n\t        return this.previousSegment.end;\n\t    }\n\t});\n\n\t// virtual\n\tObject.defineProperty(segmentPrototype, 'type', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        throw new Error('Bad segment declaration. No type specified.');\n\t    }\n\t});\n\n\t// Path segment implementations:\n\tvar Lineto = function() {\n\t    var arguments$1 = arguments;\n\n\n\t    var args = [];\n\t    var n = arguments.length;\n\t    for (var i = 0; i < n; i++) {\n\t        args.push(arguments$1[i]);\n\t    }\n\n\t    if (!(this instanceof Lineto)) { // switching context of `this` to Lineto when called without `new`\n\t        return applyToNew(Lineto, args);\n\t    }\n\n\t    if (n === 0) {\n\t        throw new Error('Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).');\n\t    }\n\n\t    var outputArray;\n\n\t    if (args[0] instanceof Line) { // lines provided\n\t        if (n === 1) {\n\t            this.end = args[0].end.clone();\n\t            return this;\n\n\t        } else {\n\t            throw new Error('Lineto constructor expects a line, 1 point, or 2 coordinates (' + n + ' lines provided).');\n\t        }\n\n\t    } else if (typeof args[0] === 'string' || typeof args[0] === 'number') { // coordinates provided\n\t        if (n === 2) {\n\t            this.end = new Point(+args[0], +args[1]);\n\t            return this;\n\n\t        } else if (n < 2) {\n\t            throw new Error('Lineto constructor expects a line, 1 point, or 2 coordinates (' + n + ' coordinates provided).');\n\n\t        } else { // this is a poly-line segment\n\t            var segmentCoords;\n\t            outputArray = [];\n\t            for (i = 0; i < n; i += 2) { // coords come in groups of two\n\n\t                segmentCoords = args.slice(i, i + 2); // will send one coord if args.length not divisible by 2\n\t                outputArray.push(applyToNew(Lineto, segmentCoords));\n\t            }\n\t            return outputArray;\n\t        }\n\n\t    } else { // points provided (needs to be last to also cover plain objects with x and y)\n\t        if (n === 1) {\n\t            this.end = new Point(args[0]);\n\t            return this;\n\n\t        } else { // this is a poly-line segment\n\t            var segmentPoint;\n\t            outputArray = [];\n\t            for (i = 0; i < n; i += 1) {\n\n\t                segmentPoint = args[i];\n\t                outputArray.push(new Lineto(segmentPoint));\n\t            }\n\t            return outputArray;\n\t        }\n\t    }\n\t};\n\n\tvar linetoPrototype = {\n\n\t    clone: function() {\n\n\t        return new Lineto(this.end);\n\t    },\n\n\t    divideAt: function(ratio) {\n\n\t        var line = new Line(this.start, this.end);\n\t        var divided = line.divideAt(ratio);\n\t        return [\n\t            new Lineto(divided[0]),\n\t            new Lineto(divided[1])\n\t        ];\n\t    },\n\n\t    divideAtLength: function(length) {\n\n\t        var line = new Line(this.start, this.end);\n\t        var divided = line.divideAtLength(length);\n\t        return [\n\t            new Lineto(divided[0]),\n\t            new Lineto(divided[1])\n\t        ];\n\t    },\n\n\t    getSubdivisions: function() {\n\n\t        return [];\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        if (!this.previousSegment) { return false; }\n\n\t        return !this.start.equals(this.end);\n\t    },\n\n\t    round: function(precision) {\n\n\t        this.end.round(precision);\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        this.end.scale(sx, sy, origin);\n\t        return this;\n\t    },\n\n\t    serialize: function() {\n\n\t        var end = this.end;\n\t        return this.type + ' ' + end.x + ' ' + end.y;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.type + ' ' + this.start + ' ' + this.end;\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        this.end.translate(tx, ty);\n\t        return this;\n\t    }\n\t};\n\n\tObject.defineProperty(linetoPrototype, 'type', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    value: 'L'\n\t});\n\n\tLineto.prototype = extend(segmentPrototype, Line.prototype, linetoPrototype);\n\n\tvar Curveto = function() {\n\t    var arguments$1 = arguments;\n\n\n\t    var args = [];\n\t    var n = arguments.length;\n\t    for (var i = 0; i < n; i++) {\n\t        args.push(arguments$1[i]);\n\t    }\n\n\t    if (!(this instanceof Curveto)) { // switching context of `this` to Curveto when called without `new`\n\t        return applyToNew(Curveto, args);\n\t    }\n\n\t    if (n === 0) {\n\t        throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).');\n\t    }\n\n\t    var outputArray;\n\n\t    if (args[0] instanceof Curve) { // curves provided\n\t        if (n === 1) {\n\t            this.controlPoint1 = args[0].controlPoint1.clone();\n\t            this.controlPoint2 = args[0].controlPoint2.clone();\n\t            this.end = args[0].end.clone();\n\t            return this;\n\n\t        } else {\n\t            throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates (' + n + ' curves provided).');\n\t        }\n\n\t    } else if (typeof args[0] === 'string' || typeof args[0] === 'number') { // coordinates provided\n\t        if (n === 6) {\n\t            this.controlPoint1 = new Point(+args[0], +args[1]);\n\t            this.controlPoint2 = new Point(+args[2], +args[3]);\n\t            this.end = new Point(+args[4], +args[5]);\n\t            return this;\n\n\t        } else if (n < 6) {\n\t            throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates (' + n + ' coordinates provided).');\n\n\t        } else { // this is a poly-bezier segment\n\t            var segmentCoords;\n\t            outputArray = [];\n\t            for (i = 0; i < n; i += 6) { // coords come in groups of six\n\n\t                segmentCoords = args.slice(i, i + 6); // will send fewer than six coords if args.length not divisible by 6\n\t                outputArray.push(applyToNew(Curveto, segmentCoords));\n\t            }\n\t            return outputArray;\n\t        }\n\n\t    } else { // points provided (needs to be last to also cover plain objects with x and y)\n\t        if (n === 3) {\n\t            this.controlPoint1 = new Point(args[0]);\n\t            this.controlPoint2 = new Point(args[1]);\n\t            this.end = new Point(args[2]);\n\t            return this;\n\n\t        } else if (n < 3) {\n\t            throw new Error('Curveto constructor expects a curve, 3 points, or 6 coordinates (' + n + ' points provided).');\n\n\t        } else { // this is a poly-bezier segment\n\t            var segmentPoints;\n\t            outputArray = [];\n\t            for (i = 0; i < n; i += 3) { // points come in groups of three\n\n\t                segmentPoints = args.slice(i, i + 3); // will send fewer than three points if args.length is not divisible by 3\n\t                outputArray.push(applyToNew(Curveto, segmentPoints));\n\t            }\n\t            return outputArray;\n\t        }\n\t    }\n\t};\n\n\tvar curvetoPrototype = {\n\n\t    clone: function() {\n\n\t        return new Curveto(this.controlPoint1, this.controlPoint2, this.end);\n\t    },\n\n\t    divideAt: function(ratio, opt) {\n\n\t        var curve = new Curve(this.start, this.controlPoint1, this.controlPoint2, this.end);\n\t        var divided = curve.divideAt(ratio, opt);\n\t        return [\n\t            new Curveto(divided[0]),\n\t            new Curveto(divided[1])\n\t        ];\n\t    },\n\n\t    divideAtLength: function(length, opt) {\n\n\t        var curve = new Curve(this.start, this.controlPoint1, this.controlPoint2, this.end);\n\t        var divided = curve.divideAtLength(length, opt);\n\t        return [\n\t            new Curveto(divided[0]),\n\t            new Curveto(divided[1])\n\t        ];\n\t    },\n\n\t    divideAtT: function(t) {\n\n\t        var curve = new Curve(this.start, this.controlPoint1, this.controlPoint2, this.end);\n\t        var divided = curve.divideAtT(t);\n\t        return [\n\t            new Curveto(divided[0]),\n\t            new Curveto(divided[1])\n\t        ];\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        if (!this.previousSegment) { return false; }\n\n\t        var start = this.start;\n\t        var control1 = this.controlPoint1;\n\t        var control2 = this.controlPoint2;\n\t        var end = this.end;\n\n\t        return !(start.equals(control1) && control1.equals(control2) && control2.equals(end));\n\t    },\n\n\t    round: function(precision) {\n\n\t        this.controlPoint1.round(precision);\n\t        this.controlPoint2.round(precision);\n\t        this.end.round(precision);\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        this.controlPoint1.scale(sx, sy, origin);\n\t        this.controlPoint2.scale(sx, sy, origin);\n\t        this.end.scale(sx, sy, origin);\n\t        return this;\n\t    },\n\n\t    serialize: function() {\n\n\t        var c1 = this.controlPoint1;\n\t        var c2 = this.controlPoint2;\n\t        var end = this.end;\n\t        return this.type + ' ' + c1.x + ' ' + c1.y + ' ' + c2.x + ' ' + c2.y + ' ' + end.x + ' ' + end.y;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.type + ' ' + this.start + ' ' + this.controlPoint1 + ' ' + this.controlPoint2 + ' ' + this.end;\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        this.controlPoint1.translate(tx, ty);\n\t        this.controlPoint2.translate(tx, ty);\n\t        this.end.translate(tx, ty);\n\t        return this;\n\t    }\n\t};\n\n\tObject.defineProperty(curvetoPrototype, 'type', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    value: 'C'\n\t});\n\n\tCurveto.prototype = extend(segmentPrototype, Curve.prototype, curvetoPrototype);\n\n\tvar Moveto = function() {\n\t    var arguments$1 = arguments;\n\n\n\t    var args = [];\n\t    var n = arguments.length;\n\t    for (var i = 0; i < n; i++) {\n\t        args.push(arguments$1[i]);\n\t    }\n\n\t    if (!(this instanceof Moveto)) { // switching context of `this` to Moveto when called without `new`\n\t        return applyToNew(Moveto, args);\n\t    }\n\n\t    if (n === 0) {\n\t        throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).');\n\t    }\n\n\t    var outputArray;\n\n\t    if (args[0] instanceof Line) { // lines provided\n\t        if (n === 1) {\n\t            this.end = args[0].end.clone();\n\t            return this;\n\n\t        } else {\n\t            throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (' + n + ' lines provided).');\n\t        }\n\n\t    } else if (args[0] instanceof Curve) { // curves provided\n\t        if (n === 1) {\n\t            this.end = args[0].end.clone();\n\t            return this;\n\n\t        } else {\n\t            throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (' + n + ' curves provided).');\n\t        }\n\n\t    } else if (typeof args[0] === 'string' || typeof args[0] === 'number') { // coordinates provided\n\t        if (n === 2) {\n\t            this.end = new Point(+args[0], +args[1]);\n\t            return this;\n\n\t        } else if (n < 2) {\n\t            throw new Error('Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (' + n + ' coordinates provided).');\n\n\t        } else { // this is a moveto-with-subsequent-poly-line segment\n\t            var segmentCoords;\n\t            outputArray = [];\n\t            for (i = 0; i < n; i += 2) { // coords come in groups of two\n\n\t                segmentCoords = args.slice(i, i + 2); // will send one coord if args.length not divisible by 2\n\t                if (i === 0) { outputArray.push(applyToNew(Moveto, segmentCoords)); }\n\t                else { outputArray.push(applyToNew(Lineto, segmentCoords)); }\n\t            }\n\t            return outputArray;\n\t        }\n\n\t    } else { // points provided (needs to be last to also cover plain objects with x and y)\n\t        if (n === 1) {\n\t            this.end = new Point(args[0]);\n\t            return this;\n\n\t        } else { // this is a moveto-with-subsequent-poly-line segment\n\t            var segmentPoint;\n\t            outputArray = [];\n\t            for (i = 0; i < n; i += 1) { // points come one by one\n\n\t                segmentPoint = args[i];\n\t                if (i === 0) { outputArray.push(new Moveto(segmentPoint)); }\n\t                else { outputArray.push(new Lineto(segmentPoint)); }\n\t            }\n\t            return outputArray;\n\t        }\n\t    }\n\t};\n\n\tvar movetoPrototype = {\n\n\t    bbox: function() {\n\n\t        return null;\n\t    },\n\n\t    clone: function() {\n\n\t        return new Moveto(this.end);\n\t    },\n\n\t    closestPoint: function() {\n\n\t        return this.end.clone();\n\t    },\n\n\t    closestPointNormalizedLength: function() {\n\n\t        return 0;\n\t    },\n\n\t    closestPointLength: function() {\n\n\t        return 0;\n\t    },\n\n\t    closestPointT: function() {\n\n\t        return 1;\n\t    },\n\n\t    closestPointTangent: function() {\n\n\t        return null;\n\t    },\n\n\t    divideAt: function() {\n\n\t        return [\n\t            this.clone(),\n\t            this.clone()\n\t        ];\n\t    },\n\n\t    divideAtLength: function() {\n\n\t        return [\n\t            this.clone(),\n\t            this.clone()\n\t        ];\n\t    },\n\n\t    equals: function(m) {\n\n\t        return this.end.equals(m.end);\n\t    },\n\n\t    getSubdivisions: function() {\n\n\t        return [];\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        return false;\n\t    },\n\n\t    isSubpathStart: true,\n\n\t    isVisible: false,\n\n\t    length: function() {\n\n\t        return 0;\n\t    },\n\n\t    lengthAtT: function() {\n\n\t        return 0;\n\t    },\n\n\t    pointAt: function() {\n\n\t        return this.end.clone();\n\t    },\n\n\t    pointAtLength: function() {\n\n\t        return this.end.clone();\n\t    },\n\n\t    pointAtT: function() {\n\n\t        return this.end.clone();\n\t    },\n\n\t    round: function(precision) {\n\n\t        this.end.round(precision);\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin) {\n\n\t        this.end.scale(sx, sy, origin);\n\t        return this;\n\t    },\n\n\t    serialize: function() {\n\n\t        var end = this.end;\n\t        return this.type + ' ' + end.x + ' ' + end.y;\n\t    },\n\n\t    tangentAt: function() {\n\n\t        return null;\n\t    },\n\n\t    tangentAtLength: function() {\n\n\t        return null;\n\t    },\n\n\t    tangentAtT: function() {\n\n\t        return null;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.type + ' ' + this.end;\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        this.end.translate(tx, ty);\n\t        return this;\n\t    }\n\t};\n\n\tObject.defineProperty(movetoPrototype, 'start', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        throw new Error('Illegal access. Moveto segments should not need a start property.');\n\t    }\n\t});\n\n\tObject.defineProperty(movetoPrototype, 'type', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    value: 'M'\n\t});\n\n\tMoveto.prototype = extend(segmentPrototype, movetoPrototype); // does not inherit from any other geometry object\n\n\tvar Closepath = function() {\n\t    var arguments$1 = arguments;\n\n\n\t    var args = [];\n\t    var n = arguments.length;\n\t    for (var i = 0; i < n; i++) {\n\t        args.push(arguments$1[i]);\n\t    }\n\n\t    if (!(this instanceof Closepath)) { // switching context of `this` to Closepath when called without `new`\n\t        return applyToNew(Closepath, args);\n\t    }\n\n\t    if (n > 0) {\n\t        throw new Error('Closepath constructor expects no arguments.');\n\t    }\n\n\t    return this;\n\t};\n\n\tvar closepathPrototype = {\n\n\t    clone: function() {\n\n\t        return new Closepath();\n\t    },\n\n\t    divideAt: function(ratio) {\n\n\t        var line = new Line(this.start, this.end);\n\t        var divided = line.divideAt(ratio);\n\t        return [\n\t            // if we didn't actually cut into the segment, first divided part can stay as Z\n\t            (divided[1].isDifferentiable() ? new Lineto(divided[0]) : this.clone()),\n\t            new Lineto(divided[1])\n\t        ];\n\t    },\n\n\t    divideAtLength: function(length) {\n\n\t        var line = new Line(this.start, this.end);\n\t        var divided = line.divideAtLength(length);\n\t        return [\n\t            // if we didn't actually cut into the segment, first divided part can stay as Z\n\t            (divided[1].isDifferentiable() ? new Lineto(divided[0]) : this.clone()),\n\t            new Lineto(divided[1])\n\t        ];\n\t    },\n\n\t    getSubdivisions: function() {\n\n\t        return [];\n\t    },\n\n\t    isDifferentiable: function() {\n\n\t        if (!this.previousSegment || !this.subpathStartSegment) { return false; }\n\n\t        return !this.start.equals(this.end);\n\t    },\n\n\t    round: function() {\n\n\t        return this;\n\t    },\n\n\t    scale: function() {\n\n\t        return this;\n\t    },\n\n\t    serialize: function() {\n\n\t        return this.type;\n\t    },\n\n\t    toString: function() {\n\n\t        return this.type + ' ' + this.start + ' ' + this.end;\n\t    },\n\n\t    translate: function() {\n\n\t        return this;\n\t    }\n\t};\n\n\tObject.defineProperty(closepathPrototype, 'end', {\n\t    // get a reference to the end point of subpath start segment\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    get: function() {\n\n\t        if (!this.subpathStartSegment) { throw new Error('Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)'); }\n\n\t        return this.subpathStartSegment.end;\n\t    }\n\t});\n\n\tObject.defineProperty(closepathPrototype, 'type', {\n\n\t    configurable: true,\n\n\t    enumerable: true,\n\n\t    value: 'Z'\n\t});\n\n\tClosepath.prototype = extend(segmentPrototype, Line.prototype, closepathPrototype);\n\n\tvar segmentTypes = Path.segmentTypes = {\n\t    L: Lineto,\n\t    C: Curveto,\n\t    M: Moveto,\n\t    Z: Closepath,\n\t    z: Closepath\n\t};\n\n\tPath.regexSupportedData = new RegExp('^[\\\\s\\\\d' + Object.keys(segmentTypes).join('') + ',.]*$');\n\n\tPath.isDataSupported = function(data) {\n\n\t    if (typeof data !== 'string') { return false; }\n\t    return this.regexSupportedData.test(data);\n\t};\n\n\tvar bezier = {\n\n\t    // Cubic Bezier curve path through points.\n\t    // @deprecated\n\t    // @param {array} points Array of points through which the smooth line will go.\n\t    // @return {array} SVG Path commands as an array\n\t    curveThroughPoints: function(points) {\n\n\t        console.warn('deprecated');\n\n\t        return new Path(Curve.throughPoints(points)).serialize();\n\t    },\n\n\t    // Get open-ended Bezier Spline Control Points.\n\t    // @deprecated\n\t    // @param knots Input Knot Bezier spline points (At least two points!).\n\t    // @param firstControlPoints Output First Control points. Array of knots.length - 1 length.\n\t    // @param secondControlPoints Output Second Control points. Array of knots.length - 1 length.\n\t    getCurveControlPoints: function(knots) {\n\n\t        console.warn('deprecated');\n\n\t        var firstControlPoints = [];\n\t        var secondControlPoints = [];\n\t        var n = knots.length - 1;\n\t        var i;\n\n\t        // Special case: Bezier curve should be a straight line.\n\t        if (n == 1) {\n\t            // 3P1 = 2P0 + P3\n\t            firstControlPoints[0] = new Point(\n\t                (2 * knots[0].x + knots[1].x) / 3,\n\t                (2 * knots[0].y + knots[1].y) / 3\n\t            );\n\n\t            // P2 = 2P1 â P0\n\t            secondControlPoints[0] = new Point(\n\t                2 * firstControlPoints[0].x - knots[0].x,\n\t                2 * firstControlPoints[0].y - knots[0].y\n\t            );\n\n\t            return [firstControlPoints, secondControlPoints];\n\t        }\n\n\t        // Calculate first Bezier control points.\n\t        // Right hand side vector.\n\t        var rhs = [];\n\n\t        // Set right hand side X values.\n\t        for (i = 1; i < n - 1; i++) {\n\t            rhs[i] = 4 * knots[i].x + 2 * knots[i + 1].x;\n\t        }\n\n\t        rhs[0] = knots[0].x + 2 * knots[1].x;\n\t        rhs[n - 1] = (8 * knots[n - 1].x + knots[n].x) / 2.0;\n\n\t        // Get first control points X-values.\n\t        var x = this.getFirstControlPoints(rhs);\n\n\t        // Set right hand side Y values.\n\t        for (i = 1; i < n - 1; ++i) {\n\t            rhs[i] = 4 * knots[i].y + 2 * knots[i + 1].y;\n\t        }\n\n\t        rhs[0] = knots[0].y + 2 * knots[1].y;\n\t        rhs[n - 1] = (8 * knots[n - 1].y + knots[n].y) / 2.0;\n\n\t        // Get first control points Y-values.\n\t        var y = this.getFirstControlPoints(rhs);\n\n\t        // Fill output arrays.\n\t        for (i = 0; i < n; i++) {\n\t            // First control point.\n\t            firstControlPoints.push(new Point(x[i], y[i]));\n\n\t            // Second control point.\n\t            if (i < n - 1) {\n\t                secondControlPoints.push(new Point(\n\t                    2 * knots [i + 1].x - x[i + 1],\n\t                    2 * knots[i + 1].y - y[i + 1]\n\t                ));\n\n\t            } else {\n\t                secondControlPoints.push(new Point(\n\t                    (knots[n].x + x[n - 1]) / 2,\n\t                    (knots[n].y + y[n - 1]) / 2)\n\t                );\n\t            }\n\t        }\n\n\t        return [firstControlPoints, secondControlPoints];\n\t    },\n\n\t    // Divide a Bezier curve into two at point defined by value 't' <0,1>.\n\t    // Using deCasteljau algorithm. http://math.stackexchange.com/a/317867\n\t    // @deprecated\n\t    // @param control points (start, control start, control end, end)\n\t    // @return a function that accepts t and returns 2 curves.\n\t    getCurveDivider: function(p0, p1, p2, p3) {\n\n\t        console.warn('deprecated');\n\n\t        var curve = new Curve(p0, p1, p2, p3);\n\n\t        return function divideCurve(t) {\n\n\t            var divided = curve.divide(t);\n\n\t            return [{\n\t                p0: divided[0].start,\n\t                p1: divided[0].controlPoint1,\n\t                p2: divided[0].controlPoint2,\n\t                p3: divided[0].end\n\t            }, {\n\t                p0: divided[1].start,\n\t                p1: divided[1].controlPoint1,\n\t                p2: divided[1].controlPoint2,\n\t                p3: divided[1].end\n\t            }];\n\t        };\n\t    },\n\n\t    // Solves a tridiagonal system for one of coordinates (x or y) of first Bezier control points.\n\t    // @deprecated\n\t    // @param rhs Right hand side vector.\n\t    // @return Solution vector.\n\t    getFirstControlPoints: function(rhs) {\n\n\t        console.warn('deprecated');\n\n\t        var n = rhs.length;\n\t        // `x` is a solution vector.\n\t        var x = [];\n\t        var tmp = [];\n\t        var b = 2.0;\n\n\t        x[0] = rhs[0] / b;\n\n\t        // Decomposition and forward substitution.\n\t        for (var i = 1; i < n; i++) {\n\t            tmp[i] = 1 / b;\n\t            b = (i < n - 1 ? 4.0 : 3.5) - tmp[i];\n\t            x[i] = (rhs[i] - x[i - 1]) / b;\n\t        }\n\n\t        for (i = 1; i < n; i++) {\n\t            // Backsubstitution.\n\t            x[n - i - 1] -= tmp[n - i] * x[n - i];\n\t        }\n\n\t        return x;\n\t    },\n\n\t    // Solves an inversion problem -- Given the (x, y) coordinates of a point which lies on\n\t    // a parametric curve x = x(t)/w(t), y = y(t)/w(t), ï¬nd the parameter value t\n\t    // which corresponds to that point.\n\t    // @deprecated\n\t    // @param control points (start, control start, control end, end)\n\t    // @return a function that accepts a point and returns t.\n\t    getInversionSolver: function(p0, p1, p2, p3) {\n\n\t        console.warn('deprecated');\n\n\t        var curve = new Curve(p0, p1, p2, p3);\n\n\t        return function solveInversion(p) {\n\n\t            return curve.closestPointT(p);\n\t        };\n\t    }\n\t};\n\n\tvar Polygon = function(points) {\n\n\t    if (!(this instanceof Polygon)) {\n\t        return new Polygon(points);\n\t    }\n\n\t    if (typeof points === 'string') {\n\t        return new Polygon.parse(points);\n\t    }\n\n\t    this.points = (Array.isArray(points) ? points.map(Point) : []);\n\t};\n\n\tPolygon.parse = function(svgString) {\n\t    return new Polygon(parsePoints(svgString));\n\t};\n\n\tPolygon.fromRect = function(rect) {\n\t    return new Polygon([\n\t        rect.topLeft(),\n\t        rect.topRight(),\n\t        rect.bottomRight(),\n\t        rect.bottomLeft()\n\t    ]);\n\t};\n\n\tPolygon.prototype = extend(Polyline.prototype, {\n\n\t    type: types.Polygon,\n\n\t    clone: function() {\n\t        return new Polygon(clonePoints(this.points));\n\t    },\n\n\t    convexHull: function() {\n\t        return new Polygon(convexHull(this.points));\n\t    },\n\n\t    lengthPoints: function() {\n\t        var ref = this;\n\t        var start = ref.start;\n\t        var end = ref.end;\n\t        var points = ref.points;\n\t        if (points.length <= 1 || start.equals(end)) { return points; }\n\t        return points.concat( [start.clone()]);\n\t    }\n\n\t});\n\n\tfunction exists(shape1, shape2, shape1opt, shape2opt) {\n\t    switch (shape1.type) {\n\t        case types.Line: {\n\t            switch (shape2.type) {\n\t                case types.Line: {\n\t                    return lineWithLine(shape1, shape2);\n\t                }\n\t            }\n\t            break;\n\t        }\n\t        case types.Ellipse: {\n\t            switch (shape2.type) {\n\t                case types.Line: {\n\t                    return ellipseWithLine(shape1, shape2);\n\t                }\n\t                case types.Ellipse: {\n\t                    return ellipseWithEllipse(shape1, shape2);\n\t                }\n\t            }\n\t            break;\n\t        }\n\t        case types.Rect: {\n\t            switch (shape2.type) {\n\t                case types.Line: {\n\t                    return rectWithLine(shape1, shape2);\n\t                }\n\t                case types.Ellipse: {\n\t                    return rectWithEllipse(shape1, shape2);\n\t                }\n\t                case types.Rect: {\n\t                    return rectWithRect(shape1, shape2);\n\t                }\n\t            }\n\t            break;\n\t        }\n\t        case types.Polyline: {\n\t            switch (shape2.type) {\n\t                case types.Line: {\n\t                    return polylineWithLine(shape1, shape2);\n\t                }\n\t                case types.Ellipse: {\n\t                    return polylineWithEllipse(shape1, shape2);\n\t                }\n\t                case types.Rect: {\n\t                    return polylineWithRect(shape1, shape2);\n\t                }\n\t                case types.Polyline: {\n\t                    return polylineWithPolyline(shape1, shape2);\n\t                }\n\t            }\n\t            break;\n\t        }\n\t        case types.Polygon: {\n\t            switch (shape2.type) {\n\t                case types.Line: {\n\t                    return polygonWithLine(shape1, shape2);\n\t                }\n\t                case types.Ellipse: {\n\t                    return polygonWithEllipse(shape1, shape2);\n\t                }\n\t                case types.Rect: {\n\t                    return polygonWithRect(shape1, shape2);\n\t                }\n\t                case types.Polyline: {\n\t                    return polygonWithPolyline(shape1, shape2);\n\t                }\n\t                case types.Polygon: {\n\t                    return polygonWithPolygon(shape1, shape2);\n\t                }\n\t            }\n\t            break;\n\t        }\n\t        case types.Path: {\n\t            switch (shape2.type) {\n\t                case types.Line: {\n\t                    return pathWithLine(shape1, shape2, shape1opt);\n\t                }\n\t                case types.Ellipse: {\n\t                    return pathWithEllipse(shape1, shape2, shape1opt);\n\t                }\n\t                case types.Rect: {\n\t                    return pathWithRect(shape1, shape2, shape1opt);\n\t                }\n\t                case types.Polyline: {\n\t                    return pathWithPolyline(shape1, shape2, shape1opt);\n\t                }\n\t                case types.Polygon: {\n\t                    return pathWithPolygon(shape1, shape2, shape1opt);\n\t                }\n\t                case types.Path: {\n\t                    return pathWithPath(shape1, shape2, shape1opt, shape2opt);\n\t                }\n\t            }\n\t            break;\n\t        }\n\t    }\n\t    // None of the cases above\n\t    switch (shape2.type) {\n\t        case types.Ellipse:\n\t        case types.Rect:\n\t        case types.Polyline:\n\t        case types.Polygon:\n\t        case types.Path: {\n\t            return exists(shape2, shape1, shape2opt, shape1opt);\n\t        }\n\t        default: {\n\t            throw Error((\"The intersection for \" + shape1 + \" and \" + shape2 + \" could not be found.\"));\n\t        }\n\t    }\n\t}\n\n\t/* Line */\n\n\tfunction lineWithLine(line1, line2) {\n\t    var x1 = line1.start.x;\n\t    var y1 = line1.start.y;\n\t    var x2 = line1.end.x;\n\t    var y2 = line1.end.y;\n\t    var x3 = line2.start.x;\n\t    var y3 = line2.start.y;\n\t    var x4 = line2.end.x;\n\t    var y4 = line2.end.y;\n\t    var s1x = x2 - x1;\n\t    var s1y = y2 - y1;\n\t    var s2x = x4 - x3;\n\t    var s2y = y4 - y3;\n\t    var s3x = x1 - x3;\n\t    var s3y = y1 - y3;\n\t    var p = s1x * s2y - s2x * s1y;\n\t    var s = (s1x * s3y - s1y * s3x) / p;\n\t    var t = (s2x * s3y - s2y * s3x) / p;\n\t    return s >= 0 && s <= 1 && t >= 0 && t <= 1;\n\t}\n\n\t/* Ellipse */\n\n\tfunction ellipseWithLine(ellipse, line) {\n\t    var rex = ellipse.a;\n\t    var rey = ellipse.b;\n\t    var xe = ellipse.x;\n\t    var ye = ellipse.y;\n\t    var x1 = line.start.x - xe;\n\t    var x2 = line.end.x - xe;\n\t    var y1 = line.start.y - ye;\n\t    var y2 = line.end.y - ye;\n\t    var rex_2 = rex * rex;\n\t    var rey_2 = rey * rey;\n\t    var dx = x2 - x1;\n\t    var dy = y2 - y1;\n\t    var A = dx * dx / rex_2 + dy * dy / rey_2;\n\t    var B = 2 * x1 * dx / rex_2 + 2 * y1 * dy / rey_2;\n\t    var C = x1 * x1 / rex_2 + y1 * y1 / rey_2 - 1;\n\t    var D = B * B - 4 * A * C;\n\t    if (D === 0) {\n\t        var t = -B / 2 / A;\n\t        return t >= 0 && t <= 1;\n\t    } else if (D > 0) {\n\t        var sqrt = Math.sqrt(D);\n\t        var t1 = (-B + sqrt) / 2 / A;\n\t        var t2 = (-B - sqrt) / 2 / A;\n\t        return (t1 >= 0 && t1 <= 1) || (t2 >= 0 && t2 <= 1);\n\t    }\n\t    return false;\n\t}\n\n\tfunction ellipseWithEllipse(ellipse1, ellipse2) {\n\t    return _ellipsesIntersection(ellipse1, 0, ellipse2, 0);\n\t}\n\n\t/* Rect */\n\n\tfunction rectWithLine(rect, line) {\n\t    var start = line.start;\n\t    var end = line.end;\n\t    var x = rect.x;\n\t    var y = rect.y;\n\t    var width = rect.width;\n\t    var height = rect.height;\n\t    if (\n\t        (start.x > x + width && end.x > x + width)\n\t        || (start.x < x && end.x < x)\n\t        || (start.y > y + height && end.y > y + height)\n\t        || (start.y < y && end.y < y)\n\t    ) {\n\t        return false;\n\t    }\n\t    if (rect.containsPoint(line.start) || rect.containsPoint(line.end)) {\n\t        return true;\n\t    }\n\t    return lineWithLine(rect.topLine(), line)\n\t        || lineWithLine(rect.rightLine(), line)\n\t        || lineWithLine(rect.bottomLine(), line)\n\t        || lineWithLine(rect.leftLine(), line);\n\t}\n\n\tfunction rectWithEllipse(rect, ellipse) {\n\t    if (!rectWithRect(rect, Rect.fromEllipse(ellipse))) { return false; }\n\t    return polygonWithEllipse(Polygon.fromRect(rect), ellipse);\n\t}\n\n\tfunction rectWithRect(rect1, rect2) {\n\t    return rect1.x < rect2.x + rect2.width\n\t        && rect1.x + rect1.width > rect2.x\n\t        && rect1.y < rect2.y + rect2.height\n\t        && rect1.y + rect1.height > rect2.y;\n\t}\n\n\t/* Polyline */\n\n\tfunction polylineWithLine(polyline, line) {\n\t    return _polylineWithLine(polyline, line, { interior: false });\n\t}\n\n\tfunction polylineWithEllipse(polyline, ellipse) {\n\t    return _polylineWithEllipse(polyline, ellipse, { interior: false });\n\t}\n\n\tfunction polylineWithRect(polyline, rect) {\n\t    return _polylineWithRect(polyline, rect, { interior: false });\n\t}\n\n\tfunction polylineWithPolyline(polyline1, polyline2) {\n\t    return _polylineWithPolyline(polyline1, polyline2, { interior: false });\n\t}\n\n\t/* Polygon */\n\n\tfunction polygonWithLine(polygon, line) {\n\t    return _polylineWithLine(polygon, line, { interior: true });\n\t}\n\n\tfunction polygonWithEllipse(polygon, ellipse) {\n\t    return _polylineWithEllipse(polygon, ellipse, { interior: true });\n\t}\n\n\tfunction polygonWithRect(polygon, rect) {\n\t    return _polylineWithRect(polygon, rect, { interior: true });\n\t}\n\n\tfunction polygonWithPolyline(polygon, polyline) {\n\t    return _polylineWithPolyline(polygon, polyline, { interior: true });\n\t}\n\n\tfunction polygonWithPolygon(polygon1, polygon2) {\n\t    return _polylineWithPolygon(polygon1, polygon2, { interior: true });\n\t}\n\n\t/* Path */\n\n\tfunction pathWithLine(path, line, pathOpt) {\n\t    return path.getSubpaths().some(function (subpath) {\n\t        var ref = subpath.toPolylines(pathOpt);\n\t        var polyline = ref[0];\n\t        var ref$1 = subpath.getSegment(-1);\n\t        var type = ref$1.type;\n\t        if (type === 'Z') {\n\t            return polygonWithLine(polyline, line);\n\t        } else {\n\t            return polylineWithLine(polyline, line);\n\t        }\n\t    });\n\t}\n\n\tfunction pathWithEllipse(path, ellipse, pathOpt) {\n\t    return path.getSubpaths().some(function (subpath) {\n\t        var ref = subpath.toPolylines(pathOpt);\n\t        var polyline = ref[0];\n\t        var ref$1 = subpath.getSegment(-1);\n\t        var type = ref$1.type;\n\t        if (type === 'Z') {\n\t            return polygonWithEllipse(polyline, ellipse);\n\t        } else {\n\t            return polylineWithEllipse(polyline, ellipse);\n\t        }\n\t    });\n\t}\n\n\tfunction pathWithRect(path, rect, pathOpt) {\n\t    return pathWithPolygon(path, Polygon.fromRect(rect), pathOpt);\n\t}\n\n\tfunction pathWithPolyline(path, polyline, pathOpt) {\n\t    return _pathWithPolyline(path, polyline, pathOpt, { interior: false });\n\t}\n\n\tfunction pathWithPolygon(path, polygon, pathOpt) {\n\t    return _pathWithPolyline(path, polygon, pathOpt, { interior: true });\n\t}\n\n\tfunction pathWithPath(path1, path2, pathOpt1, pathOpt2) {\n\t    return path1.getSubpaths().some(function (subpath) {\n\t        var ref = subpath.toPolylines(pathOpt1);\n\t        var polyline1 = ref[0];\n\t        var ref$1 = subpath.getSegment(-1);\n\t        var type = ref$1.type;\n\t        if (type === 'Z') {\n\t            return pathWithPolygon(path2, polyline1, pathOpt2);\n\t        } else {\n\t            return pathWithPolyline(path2, polyline1, pathOpt2);\n\t        }\n\t    });\n\t}\n\n\tfunction _polylineWithLine(polyline, line, opt) {\n\t    if ( opt === void 0 ) opt = {};\n\n\t    var interior = opt.interior; if ( interior === void 0 ) interior = false;\n\t    var thisPoints;\n\t    if (interior) {\n\t        if (polyline.containsPoint(line.start)) {\n\t            // If any point of the polyline lies inside this polygon (interior = true)\n\t            // there is an intersection (we've chosen the start point)\n\t            return true;\n\t        }\n\t        var start = polyline.start;\n\t        var end = polyline.end;\n\t        var points = polyline.points;\n\t        thisPoints = end.equals(start) ? points : points.concat( [start]);\n\t    } else {\n\t        thisPoints = polyline.points;\n\t    }\n\t    var length = thisPoints.length;\n\t    var segment = new Line();\n\t    for (var i = 0; i < length - 1; i++) {\n\t        segment.start = thisPoints[i];\n\t        segment.end = thisPoints[i + 1];\n\t        if (lineWithLine(line, segment)) {\n\t            return true;\n\t        }\n\t    }\n\t    return false;\n\t}\n\n\tfunction _polylineWithEllipse(polyline, ellipse, opt) {\n\t    if ( opt === void 0 ) opt = {};\n\n\t    var start = polyline.start;\n\t    var end = polyline.end;\n\t    var points = polyline.points;\n\t    if (ellipse.containsPoint(start)) {\n\t        return true;\n\t    }\n\t    var thisPoints;\n\t    var interior = opt.interior; if ( interior === void 0 ) interior = false;\n\t    if (interior) {\n\t        if (polyline.containsPoint(ellipse.center())) {\n\t            // If any point of the ellipse lies inside this polygon (interior = true)\n\t            // there is an intersection (we've chosen the center point)\n\t            return true;\n\t        }\n\t        thisPoints = end.equals(start) ? points : points.concat( [start]);\n\t    } else {\n\t        thisPoints = points;\n\t    }\n\n\t    var length = thisPoints.length;\n\t    var segment = new Line();\n\t    for (var i = 0; i < length - 1; i++) {\n\t        segment.start = thisPoints[i];\n\t        segment.end = thisPoints[i + 1];\n\t        if (ellipseWithLine(ellipse, segment)) {\n\t            return true;\n\t        }\n\t    }\n\t    return false;\n\t}\n\n\tfunction _polylineWithRect(polyline, rect, opt) {\n\t    var polygon = Polygon.fromRect(rect);\n\t    return _polylineWithPolygon(polyline, polygon, opt);\n\t}\n\n\tfunction _pathWithPolyline(path, polyline1, pathOpt, opt) {\n\t    return path.getSubpaths().some(function (subpath) {\n\t        var ref = subpath.toPolylines(pathOpt);\n\t        var polyline2 = ref[0];\n\t        var ref$1 = subpath.getSegment(-1);\n\t        var type = ref$1.type;\n\t        if (type === 'Z') {\n\t            return _polylineWithPolygon(polyline1, polyline2, opt);\n\t        } else {\n\t            return _polylineWithPolyline(polyline1, polyline2, opt);\n\t        }\n\t    });\n\t}\n\n\tfunction _polylineWithPolyline(polyline1, polyline2, opt) {\n\t    if ( opt === void 0 ) opt = {};\n\n\t    var interior = opt.interior; if ( interior === void 0 ) interior = false;\n\t    var thisPolyline;\n\t    if (interior) {\n\t        var start = polyline2.start;\n\t        if (polyline1.containsPoint(start)) {\n\t            // If any point of the polyline lies inside this polygon (interior = true)\n\t            // there is an intersection (we've chosen the start point)\n\t            return true;\n\t        }\n\t        thisPolyline = polyline1.clone().close();\n\t    } else {\n\t        thisPolyline = polyline1;\n\t    }\n\t    var otherPoints = polyline2.points;\n\t    var length = otherPoints.length;\n\t    var segment = new Line();\n\t    for (var i = 0; i < length - 1; i++) {\n\t        segment.start = otherPoints[i];\n\t        segment.end = otherPoints[i + 1];\n\t        if (polylineWithLine(thisPolyline, segment)) {\n\t            return true;\n\t        }\n\t    }\n\t    return false;\n\t}\n\n\tfunction _polylineWithPolygon(polyline, polygon, opt) {\n\t    return polygon.containsPoint(polyline.start) || _polylineWithPolyline(polyline, polygon.clone().close(), opt);\n\t}\n\n\tfunction _ellipsesIntersection(e1, w1, e2, w2) {\n\t    var cos = Math.cos;\n\t    var sin = Math.sin;\n\t    var sinW1 = sin(w1);\n\t    var cosW1 = cos(w1);\n\t    var sinW2 = sin(w2);\n\t    var cosW2 = cos(w2);\n\t    var sinW1s = sinW1 * sinW1;\n\t    var cosW1s = cosW1 * cosW1;\n\t    var sinCos1 = sinW1 * cosW1;\n\t    var sinW2s = sinW2 * sinW2;\n\t    var cosW2s = cosW2 * cosW2;\n\t    var sinCos2 = sinW2 * cosW2;\n\t    var a1s = e1.a * e1.a;\n\t    var b1s = e1.b * e1.b;\n\t    var a2s = e2.a * e2.a;\n\t    var b2s = e2.b * e2.b;\n\t    var A1 = a1s * sinW1s + b1s * cosW1s;\n\t    var A2 = a2s * sinW2s + b2s * cosW2s;\n\t    var B1 = a1s * cosW1s + b1s * sinW1s;\n\t    var B2 = a2s * cosW2s + b2s * sinW2s;\n\t    var C1 = 2 * (b1s - a1s) * sinCos1;\n\t    var C2 = 2 * (b2s - a2s) * sinCos2;\n\t    var D1 = (-2 * A1 * e1.x - C1 * e1.y);\n\t    var D2 = (-2 * A2 * e2.x - C2 * e2.y);\n\t    var E1 = (-C1 * e1.x - 2 * B1 * e1.y);\n\t    var E2 = (-C2 * e2.x - 2 * B2 * e2.y);\n\t    var F1 = A1 * e1.x * e1.x + B1 * e1.y * e1.y + C1 * e1.x * e1.y - a1s * b1s;\n\t    var F2 = A2 * e2.x * e2.x + B2 * e2.y * e2.y + C2 * e2.x * e2.y - a2s * b2s;\n\n\t    C1 = C1 / 2;\n\t    C2 = C2 / 2;\n\t    D1 = D1 / 2;\n\t    D2 = D2 / 2;\n\t    E1 = E1 / 2;\n\t    E2 = E2 / 2;\n\n\t    var l3 = det3([\n\t        [A1, C1, D1],\n\t        [C1, B1, E1],\n\t        [D1, E1, F1]\n\t    ]);\n\t    var l0 = det3([\n\t        [A2, C2, D2],\n\t        [C2, B2, E2],\n\t        [D2, E2, F2]\n\t    ]);\n\t    var l2 = 0.33333333 * (det3([\n\t        [A2, C1, D1],\n\t        [C2, B1, E1],\n\t        [D2, E1, F1]\n\t    ]) + det3([\n\t        [A1, C2, D1],\n\t        [C1, B2, E1],\n\t        [D1, E2, F1]\n\t    ]) + det3([\n\t        [A1, C1, D2],\n\t        [C1, B1, E2],\n\t        [D1, E1, F2]\n\t    ]));\n\t    var l1 = 0.33333333 * (det3([\n\t        [A1, C2, D2],\n\t        [C1, B2, E2],\n\t        [D1, E2, F2]\n\t    ]) + det3([\n\t        [A2, C1, D2],\n\t        [C2, B1, E2],\n\t        [D2, E1, F2]\n\t    ]) + det3([\n\t        [A2, C2, D1],\n\t        [C2, B2, E1],\n\t        [D2, E2, F1]\n\t    ]));\n\n\t    var delta1 = det2([\n\t        [l3, l2],\n\t        [l2, l1]\n\t    ]);\n\t    var delta2 = det2([\n\t        [l3, l1],\n\t        [l2, l0]\n\t    ]);\n\t    var delta3 = det2([\n\t        [l2, l1],\n\t        [l1, l0]\n\t    ]);\n\n\t    var dP = det2([\n\t        [2 * delta1, delta2],\n\t        [delta2, 2 * delta3]\n\t    ]);\n\n\t    if (dP > 0 && (l1 > 0 || l2 > 0)) {\n\t        return false;\n\t    }\n\t    return true;\n\t}\n\n\tfunction det2(m) {\n\t    return m[0][0] * m[1][1] - m[0][1] * m[1][0];\n\t}\n\n\tfunction det3(m) {\n\t    return m[0][0] * m[1][1] * m[2][2] -\n\t        m[0][0] * m[1][2] * m[2][1] -\n\t        m[0][1] * m[1][0] * m[2][2] +\n\t        m[0][1] * m[1][2] * m[2][0] +\n\t        m[0][2] * m[1][0] * m[2][1] -\n\t        m[0][2] * m[1][1] * m[2][0];\n\t}\n\n\tvar _intersection = ({\n\t\texists: exists,\n\t\tlineWithLine: lineWithLine,\n\t\tellipseWithLine: ellipseWithLine,\n\t\tellipseWithEllipse: ellipseWithEllipse,\n\t\trectWithLine: rectWithLine,\n\t\trectWithEllipse: rectWithEllipse,\n\t\trectWithRect: rectWithRect,\n\t\tpolylineWithLine: polylineWithLine,\n\t\tpolylineWithEllipse: polylineWithEllipse,\n\t\tpolylineWithRect: polylineWithRect,\n\t\tpolylineWithPolyline: polylineWithPolyline,\n\t\tpolygonWithLine: polygonWithLine,\n\t\tpolygonWithEllipse: polygonWithEllipse,\n\t\tpolygonWithRect: polygonWithRect,\n\t\tpolygonWithPolyline: polygonWithPolyline,\n\t\tpolygonWithPolygon: polygonWithPolygon,\n\t\tpathWithLine: pathWithLine,\n\t\tpathWithEllipse: pathWithEllipse,\n\t\tpathWithRect: pathWithRect,\n\t\tpathWithPolyline: pathWithPolyline,\n\t\tpathWithPolygon: pathWithPolygon,\n\t\tpathWithPath: pathWithPath\n\t});\n\n\t// Geometry library.\n\tvar intersection = _intersection;\n\n\tvar g = ({\n\t\tintersection: intersection,\n\t\tscale: scale,\n\t\tnormalizeAngle: normalizeAngle,\n\t\tsnapToGrid: snapToGrid,\n\t\ttoDeg: toDeg,\n\t\ttoRad: toRad,\n\t\trandom: random,\n\t\tbezier: bezier,\n\t\tCurve: Curve,\n\t\tEllipse: Ellipse,\n\t\tellipse: ellipse,\n\t\tLine: Line,\n\t\tline: line,\n\t\tPath: Path,\n\t\tPoint: Point,\n\t\tpoint: point,\n\t\tPolyline: Polyline,\n\t\tPolygon: Polygon,\n\t\tRect: Rect,\n\t\trect: rect,\n\t\ttypes: types\n\t});\n\n\t// Vectorizer.\n\n\tvar V = (function() {\n\n\t    var hasSvg = typeof window === 'object' &&\n\t        !!(\n\t            window.SVGAngle ||\n\t            document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n\t        );\n\n\t    // SVG support is required.\n\t    if (!hasSvg) {\n\n\t        // Return a function that throws an error when it is used.\n\t        return function() {\n\t            throw new Error('SVG is required to use Vectorizer.');\n\t        };\n\t    }\n\n\t    // XML namespaces.\n\t    var ns = {\n\t        svg: 'http://www.w3.org/2000/svg',\n\t        xmlns: 'http://www.w3.org/2000/xmlns/',\n\t        xml: 'http://www.w3.org/XML/1998/namespace',\n\t        xlink: 'http://www.w3.org/1999/xlink',\n\t        xhtml: 'http://www.w3.org/1999/xhtml'\n\t    };\n\n\t    var SVGVersion = '1.1';\n\n\t    // Declare shorthands to the most used math functions.\n\t    var math = Math;\n\t    var PI = math.PI;\n\t    var atan2 = math.atan2;\n\t    var sqrt = math.sqrt;\n\t    var min = math.min;\n\t    var max = math.max;\n\t    var cos = math.cos;\n\t    var sin = math.sin;\n\n\t    var V = function(el, attrs, children) {\n\n\t        // This allows using V() without the new keyword.\n\t        if (!(this instanceof V)) {\n\t            return V.apply(Object.create(V.prototype), arguments);\n\t        }\n\n\t        if (!el) { return; }\n\n\t        if (V.isV(el)) {\n\t            el = el.node;\n\t        }\n\n\t        attrs = attrs || {};\n\n\t        if (V.isString(el)) {\n\n\t            el = el.trim();\n\n\t            if (el.toLowerCase() === 'svg') {\n\n\t                // Create a new SVG canvas.\n\t                el = V.createSvgDocument();\n\n\t            } else if (el[0] === '<') {\n\n\t                // Create element from an SVG string.\n\t                // Allows constructs of type: `document.appendChild(V('<rect></rect>').node)`.\n\n\t                var svgDoc = V.createSvgDocument(el);\n\n\t                // Note that `V()` might also return an array should the SVG string passed as\n\t                // the first argument contain more than one root element.\n\t                if (svgDoc.childNodes.length > 1) {\n\n\t                    // Map child nodes to `V`s.\n\t                    var arrayOfVels = [];\n\t                    var i, len;\n\n\t                    for (i = 0, len = svgDoc.childNodes.length; i < len; i++) {\n\n\t                        var childNode = svgDoc.childNodes[i];\n\t                        arrayOfVels.push(new V(document.importNode(childNode, true)));\n\t                    }\n\n\t                    return arrayOfVels;\n\t                }\n\n\t                el = document.importNode(svgDoc.firstChild, true);\n\n\t            } else {\n\n\t                el = document.createElementNS(ns.svg, el);\n\t            }\n\n\t            V.ensureId(el);\n\t        }\n\n\t        this.node = el;\n\n\t        this.setAttributes(attrs);\n\n\t        if (children) {\n\t            this.append(children);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    var VPrototype = V.prototype;\n\n\t    Object.defineProperty(VPrototype, 'id', {\n\t        enumerable: true,\n\t        get: function() {\n\t            return this.node.id;\n\t        },\n\t        set: function(id) {\n\t            this.node.id = id;\n\t        }\n\t    });\n\n\t    /**\n\t     * @param {SVGGElement} toElem\n\t     * @returns {SVGMatrix}\n\t     */\n\t    VPrototype.getTransformToElement = function(target) {\n\t        var node = this.node;\n\t        if (V.isSVGGraphicsElement(target) && V.isSVGGraphicsElement(node)) {\n\t            var targetCTM = V.toNode(target).getScreenCTM();\n\t            var nodeCTM = node.getScreenCTM();\n\t            if (targetCTM && nodeCTM) {\n\t                return targetCTM.inverse().multiply(nodeCTM);\n\t            }\n\t        }\n\t        // Could not get actual transformation matrix\n\t        return V.createSVGMatrix();\n\t    };\n\n\t    /**\n\t     * @param {SVGMatrix} matrix\n\t     * @param {Object=} opt\n\t     * @returns {Vectorizer|SVGMatrix} Setter / Getter\n\t     */\n\t    VPrototype.transform = function(matrix, opt) {\n\n\t        var node = this.node;\n\t        if (V.isUndefined(matrix)) {\n\t            return V.transformStringToMatrix(this.attr('transform'));\n\t        }\n\n\t        if (opt && opt.absolute) {\n\t            return this.attr('transform', V.matrixToTransformString(matrix));\n\t        }\n\n\t        var svgTransform = V.createSVGTransform(matrix);\n\t        node.transform.baseVal.appendItem(svgTransform);\n\t        return this;\n\t    };\n\n\t    VPrototype.translate = function(tx, ty, opt) {\n\n\t        opt = opt || {};\n\t        ty = ty || 0;\n\n\t        var transformAttr = this.attr('transform') || '';\n\t        var transform = V.parseTransformString(transformAttr);\n\t        transformAttr = transform.value;\n\t        // Is it a getter?\n\t        if (V.isUndefined(tx)) {\n\t            return transform.translate;\n\t        }\n\n\t        transformAttr = transformAttr.replace(/translate\\([^)]*\\)/g, '').trim();\n\n\t        var newTx = opt.absolute ? tx : transform.translate.tx + tx;\n\t        var newTy = opt.absolute ? ty : transform.translate.ty + ty;\n\t        var newTranslate = 'translate(' + newTx + ',' + newTy + ')';\n\n\t        // Note that `translate()` is always the first transformation. This is\n\t        // usually the desired case.\n\t        this.attr('transform', (newTranslate + ' ' + transformAttr).trim());\n\t        return this;\n\t    };\n\n\t    VPrototype.rotate = function(angle, cx, cy, opt) {\n\n\t        opt = opt || {};\n\n\t        var transformAttr = this.attr('transform') || '';\n\t        var transform = V.parseTransformString(transformAttr);\n\t        transformAttr = transform.value;\n\n\t        // Is it a getter?\n\t        if (V.isUndefined(angle)) {\n\t            return transform.rotate;\n\t        }\n\n\t        transformAttr = transformAttr.replace(/rotate\\([^)]*\\)/g, '').trim();\n\n\t        angle %= 360;\n\n\t        var newAngle = opt.absolute ? angle : transform.rotate.angle + angle;\n\t        var newOrigin = (cx !== undefined && cy !== undefined) ? ',' + cx + ',' + cy : '';\n\t        var newRotate = 'rotate(' + newAngle + newOrigin + ')';\n\n\t        this.attr('transform', (transformAttr + ' ' + newRotate).trim());\n\t        return this;\n\t    };\n\n\t    // Note that `scale` as the only transformation does not combine with previous values.\n\t    VPrototype.scale = function(sx, sy) {\n\n\t        sy = V.isUndefined(sy) ? sx : sy;\n\n\t        var transformAttr = this.attr('transform') || '';\n\t        var transform = V.parseTransformString(transformAttr);\n\t        transformAttr = transform.value;\n\n\t        // Is it a getter?\n\t        if (V.isUndefined(sx)) {\n\t            return transform.scale;\n\t        }\n\n\t        transformAttr = transformAttr.replace(/scale\\([^)]*\\)/g, '').trim();\n\n\t        var newScale = 'scale(' + sx + ',' + sy + ')';\n\n\t        this.attr('transform', (transformAttr + ' ' + newScale).trim());\n\t        return this;\n\t    };\n\n\t    // Get SVGRect that contains coordinates and dimension of the real bounding box,\n\t    // i.e. after transformations are applied.\n\t    // If `target` is specified, bounding box will be computed relatively to `target` element.\n\t    VPrototype.bbox = function(withoutTransformations, target) {\n\n\t        var box;\n\t        var node = this.node;\n\t        var ownerSVGElement = node.ownerSVGElement;\n\n\t        // If the element is not in the live DOM, it does not have a bounding box defined and\n\t        // so fall back to 'zero' dimension element.\n\t        if (!ownerSVGElement) {\n\t            return new Rect(0, 0, 0, 0);\n\t        }\n\n\t        try {\n\n\t            box = node.getBBox();\n\n\t        } catch (e) {\n\n\t            // Fallback for IE.\n\t            box = {\n\t                x: node.clientLeft,\n\t                y: node.clientTop,\n\t                width: node.clientWidth,\n\t                height: node.clientHeight\n\t            };\n\t        }\n\n\t        if (withoutTransformations) {\n\t            return new Rect(box);\n\t        }\n\n\t        var matrix = this.getTransformToElement(target || ownerSVGElement);\n\n\t        return V.transformRect(box, matrix);\n\t    };\n\n\t    // Returns an SVGRect that contains coordinates and dimensions of the real bounding box,\n\t    // i.e. after transformations are applied.\n\t    // Fixes a browser implementation bug that returns incorrect bounding boxes for groups of svg elements.\n\t    // Takes an (Object) `opt` argument (optional) with the following attributes:\n\t    // (Object) `target` (optional): if not undefined, transform bounding boxes relative to `target`; if undefined, transform relative to this\n\t    // (Boolean) `recursive` (optional): if true, recursively enter all groups and get a union of element bounding boxes (svg bbox fix); if false or undefined, return result of native function this.node.getBBox();\n\t    VPrototype.getBBox = function(opt) {\n\n\t        var options = {};\n\n\t        var outputBBox;\n\t        var node = this.node;\n\t        var ownerSVGElement = node.ownerSVGElement;\n\n\t        // If the element is not in the live DOM, it does not have a bounding box defined and\n\t        // so fall back to 'zero' dimension element.\n\t        // If the element is not an SVGGraphicsElement, we could not measure the bounding box either\n\t        if (!ownerSVGElement || !V.isSVGGraphicsElement(node)) {\n\t            return new Rect(0, 0, 0, 0);\n\t        }\n\n\t        if (opt) {\n\t            if (opt.target) { // check if target exists\n\t                options.target = V.toNode(opt.target); // works for V objects, jquery objects, and node objects\n\t            }\n\t            if (opt.recursive) {\n\t                options.recursive = opt.recursive;\n\t            }\n\t        }\n\n\t        if (!options.recursive) {\n\t            try {\n\t                outputBBox = node.getBBox();\n\t            } catch (e) {\n\t                // Fallback for IE.\n\t                outputBBox = {\n\t                    x: node.clientLeft,\n\t                    y: node.clientTop,\n\t                    width: node.clientWidth,\n\t                    height: node.clientHeight\n\t                };\n\t            }\n\n\t            if (!options.target) {\n\t                // transform like this (that is, not at all)\n\t                return new Rect(outputBBox);\n\t            } else {\n\t                // transform like target\n\t                var matrix = this.getTransformToElement(options.target);\n\t                return V.transformRect(outputBBox, matrix);\n\t            }\n\t        } else { // if we want to calculate the bbox recursively\n\t            // browsers report correct bbox around svg elements (one that envelops the path lines tightly)\n\t            // but some browsers fail to report the same bbox when the elements are in a group (returning a looser bbox that also includes control points, like node.getClientRect())\n\t            // this happens even if we wrap a single svg element into a group!\n\t            // this option setting makes the function recursively enter all the groups from this and deeper, get bboxes of the elements inside, then return a union of those bboxes\n\n\t            var children = this.children();\n\t            var n = children.length;\n\n\t            if (n === 0) {\n\t                return this.getBBox({ target: options.target, recursive: false });\n\t            }\n\n\t            // recursion's initial pass-through setting:\n\t            // recursive passes-through just keep the target as whatever was set up here during the initial pass-through\n\t            if (!options.target) {\n\t                // transform children/descendants like this (their parent/ancestor)\n\t                options.target = this;\n\t            } // else transform children/descendants like target\n\n\t            for (var i = 0; i < n; i++) {\n\t                var currentChild = children[i];\n\n\t                var childBBox;\n\n\t                // if currentChild is not a group element, get its bbox with a nonrecursive call\n\t                if (currentChild.children().length === 0) {\n\t                    childBBox = currentChild.getBBox({ target: options.target, recursive: false });\n\t                } else {\n\t                    // if currentChild is a group element (determined by checking the number of children), enter it with a recursive call\n\t                    childBBox = currentChild.getBBox({ target: options.target, recursive: true });\n\t                }\n\n\t                if (!outputBBox) {\n\t                    // if this is the first iteration\n\t                    outputBBox = childBBox;\n\t                } else {\n\t                    // make a new bounding box rectangle that contains this child's bounding box and previous bounding box\n\t                    outputBBox = outputBBox.union(childBBox);\n\t                }\n\t            }\n\n\t            return outputBBox;\n\t        }\n\t    };\n\n\t    // Text() helpers\n\n\t    function createTextPathNode(attrs, vel) {\n\t        attrs || (attrs = {});\n\t        var textPathElement = V('textPath');\n\t        var d = attrs.d;\n\t        if (d && attrs['xlink:href'] === undefined) {\n\t            // If `opt.attrs` is a plain string, consider it to be directly the\n\t            // SVG path data for the text to go along (this is a shortcut).\n\t            // Otherwise if it is an object and contains the `d` property, then this is our path.\n\t            // Wrap the text in the SVG <textPath> element that points\n\t            // to a path defined by `opt.attrs` inside the `<defs>` element.\n\t            var linkedPath = V('path').attr('d', d).appendTo(vel.defs());\n\t            textPathElement.attr('xlink:href', '#' + linkedPath.id);\n\t        }\n\t        if (V.isObject(attrs)) {\n\t            // Set attributes on the `<textPath>`. The most important one\n\t            // is the `xlink:href` that points to our newly created `<path/>` element in `<defs/>`.\n\t            // Note that we also allow the following construct:\n\t            // `t.text('my text', { textPath: { 'xlink:href': '#my-other-path' } })`.\n\t            // In other words, one can completely skip the auto-creation of the path\n\t            // and use any other arbitrary path that is in the document.\n\t            textPathElement.attr(attrs);\n\t        }\n\t        return textPathElement.node;\n\t    }\n\n\t    function annotateTextLine(lineNode, lineAnnotations, opt) {\n\t        opt || (opt = {});\n\t        var includeAnnotationIndices = opt.includeAnnotationIndices;\n\t        var eol = opt.eol;\n\t        var lineHeight = opt.lineHeight;\n\t        var baseSize = opt.baseSize;\n\t        var maxFontSize = 0;\n\t        var fontMetrics = {};\n\t        var lastJ = lineAnnotations.length - 1;\n\t        for (var j = 0; j <= lastJ; j++) {\n\t            var annotation = lineAnnotations[j];\n\t            var fontSize = null;\n\t            if (V.isObject(annotation)) {\n\t                var annotationAttrs = annotation.attrs;\n\t                var vTSpan = V('tspan', annotationAttrs);\n\t                var tspanNode = vTSpan.node;\n\t                var t = annotation.t;\n\t                if (eol && j === lastJ) { t += eol; }\n\t                tspanNode.textContent = t;\n\t                // Per annotation className\n\t                var annotationClass = annotationAttrs['class'];\n\t                if (annotationClass) { vTSpan.addClass(annotationClass); }\n\t                // If `opt.includeAnnotationIndices` is `true`,\n\t                // set the list of indices of all the applied annotations\n\t                // in the `annotations` attribute. This list is a comma\n\t                // separated list of indices.\n\t                if (includeAnnotationIndices) { vTSpan.attr('annotations', annotation.annotations); }\n\t                // Check for max font size\n\t                fontSize = parseFloat(annotationAttrs['font-size']);\n\t                if (!isFinite(fontSize)) { fontSize = baseSize; }\n\t                if (fontSize && fontSize > maxFontSize) { maxFontSize = fontSize; }\n\t            } else {\n\t                if (eol && j === lastJ) { annotation += eol; }\n\t                tspanNode = document.createTextNode(annotation || ' ');\n\t                if (baseSize && baseSize > maxFontSize) { maxFontSize = baseSize; }\n\t            }\n\t            lineNode.appendChild(tspanNode);\n\t        }\n\n\t        if (maxFontSize) { fontMetrics.maxFontSize = maxFontSize; }\n\t        if (lineHeight) {\n\t            fontMetrics.lineHeight = lineHeight;\n\t        } else if (maxFontSize) {\n\t            fontMetrics.lineHeight = (maxFontSize * 1.2);\n\t        }\n\t        return fontMetrics;\n\t    }\n\n\t    var emRegex = /em$/;\n\n\t    function convertEmToPx(em, fontSize) {\n\t        var numerical = parseFloat(em);\n\t        if (emRegex.test(em)) { return numerical * fontSize; }\n\t        return numerical;\n\t    }\n\n\t    function calculateDY(alignment, linesMetrics, baseSizePx, lineHeight) {\n\t        if (!Array.isArray(linesMetrics)) { return 0; }\n\t        var n = linesMetrics.length;\n\t        if (!n) { return 0; }\n\t        var lineMetrics = linesMetrics[0];\n\t        var flMaxFont = convertEmToPx(lineMetrics.maxFontSize, baseSizePx) || baseSizePx;\n\t        var rLineHeights = 0;\n\t        var lineHeightPx = convertEmToPx(lineHeight, baseSizePx);\n\t        for (var i = 1; i < n; i++) {\n\t            lineMetrics = linesMetrics[i];\n\t            var iLineHeight = convertEmToPx(lineMetrics.lineHeight, baseSizePx) || lineHeightPx;\n\t            rLineHeights += iLineHeight;\n\t        }\n\t        var llMaxFont = convertEmToPx(lineMetrics.maxFontSize, baseSizePx) || baseSizePx;\n\t        var dy;\n\t        switch (alignment) {\n\t            case 'middle':\n\t                dy = (flMaxFont / 2) - (0.15 * llMaxFont) - (rLineHeights / 2);\n\t                break;\n\t            case 'bottom':\n\t                dy = -(0.25 * llMaxFont) - rLineHeights;\n\t                break;\n\t            default:\n\t            case 'top':\n\t                dy = (0.8 * flMaxFont);\n\t                break;\n\t        }\n\t        return dy;\n\t    }\n\n\t    VPrototype.text = function(content, opt) {\n\n\t        if (content && typeof content !== 'string') { throw new Error('Vectorizer: text() expects the first argument to be a string.'); }\n\n\t        // Replace all spaces with the Unicode No-break space (http://www.fileformat.info/info/unicode/char/a0/index.htm).\n\t        // IE would otherwise collapse all spaces into one.\n\t        content = V.sanitizeText(content);\n\t        opt || (opt = {});\n\t        // Should we allow the text to be selected?\n\t        var displayEmpty = opt.displayEmpty;\n\t        // End of Line character\n\t        var eol = opt.eol;\n\t        // Text along path\n\t        var textPath = opt.textPath;\n\t        // Vertical shift\n\t        var verticalAnchor = opt.textVerticalAnchor;\n\t        var namedVerticalAnchor = (verticalAnchor === 'middle' || verticalAnchor === 'bottom' || verticalAnchor === 'top');\n\t        // Horizontal shift applied to all the lines but the first.\n\t        var x = opt.x;\n\t        if (x === undefined) { x = this.attr('x') || 0; }\n\t        // Annotations\n\t        var iai = opt.includeAnnotationIndices;\n\t        var annotations = opt.annotations;\n\t        if (annotations && !V.isArray(annotations)) { annotations = [annotations]; }\n\t        // Shift all the <tspan> but first by one line (`1em`)\n\t        var defaultLineHeight = opt.lineHeight;\n\t        var autoLineHeight = (defaultLineHeight === 'auto');\n\t        var lineHeight = (autoLineHeight) ? '1.5em' : (defaultLineHeight || '1em');\n\t        // Clearing the element\n\t        this.empty();\n\t        this.attr({\n\t            // Preserve spaces. In other words, we do not want consecutive spaces to get collapsed to one.\n\t            'xml:space': 'preserve',\n\t            // An empty text gets rendered into the DOM in webkit-based browsers.\n\t            // In order to unify this behaviour across all browsers\n\t            // we rather hide the text element when it's empty.\n\t            'display': (content || displayEmpty) ? null : 'none'\n\t        });\n\n\t        // Set default font-size if none\n\t        var fontSize = parseFloat(this.attr('font-size'));\n\t        if (!fontSize) {\n\t            fontSize = 16;\n\t            if (namedVerticalAnchor || annotations) { this.attr('font-size', fontSize); }\n\t        }\n\n\t        var doc = document;\n\t        var containerNode;\n\t        if (textPath) {\n\t            // Now all the `<tspan>`s will be inside the `<textPath>`.\n\t            if (typeof textPath === 'string') { textPath = { d: textPath }; }\n\t            containerNode = createTextPathNode(textPath, this);\n\t        } else {\n\t            containerNode = doc.createDocumentFragment();\n\t        }\n\t        var offset = 0;\n\t        var lines = content.split('\\n');\n\t        var linesMetrics = [];\n\t        var annotatedY;\n\t        for (var i = 0, lastI = lines.length - 1; i <= lastI; i++) {\n\t            var dy = lineHeight;\n\t            var lineClassName = 'v-line';\n\t            var lineNode = doc.createElementNS(ns.svg, 'tspan');\n\t            var line = lines[i];\n\t            var lineMetrics;\n\t            if (line) {\n\t                if (annotations) {\n\t                    // Find the *compacted* annotations for this line.\n\t                    var lineAnnotations = V.annotateString(line, annotations, {\n\t                        offset: -offset,\n\t                        includeAnnotationIndices: iai\n\t                    });\n\t                    lineMetrics = annotateTextLine(lineNode, lineAnnotations, {\n\t                        includeAnnotationIndices: iai,\n\t                        eol: (i !== lastI && eol),\n\t                        lineHeight: (autoLineHeight) ? null : lineHeight,\n\t                        baseSize: fontSize\n\t                    });\n\t                    // Get the line height based on the biggest font size in the annotations for this line.\n\t                    var iLineHeight = lineMetrics.lineHeight;\n\t                    if (iLineHeight && autoLineHeight && i !== 0) { dy = iLineHeight; }\n\t                    if (i === 0) { annotatedY = lineMetrics.maxFontSize * 0.8; }\n\t                } else {\n\t                    if (eol && i !== lastI) { line += eol; }\n\t                    lineNode.textContent = line;\n\t                }\n\t            } else {\n\t                // Make sure the textContent is never empty. If it is, add a dummy\n\t                // character and make it invisible, making the following lines correctly\n\t                // relatively positioned. `dy=1em` won't work with empty lines otherwise.\n\t                lineNode.textContent = '-';\n\t                lineClassName += ' v-empty-line';\n\t                // 'opacity' needs to be specified with fill, stroke. Opacity without specification\n\t                // is not applied in Firefox\n\t                var lineNodeStyle = lineNode.style;\n\t                lineNodeStyle.fillOpacity = 0;\n\t                lineNodeStyle.strokeOpacity = 0;\n\t                if (annotations) { lineMetrics = {}; }\n\t            }\n\t            if (lineMetrics) { linesMetrics.push(lineMetrics); }\n\t            if (i > 0) { lineNode.setAttribute('dy', dy); }\n\t            // Firefox requires 'x' to be set on the first line when inside a text path\n\t            if (i > 0 || textPath) { lineNode.setAttribute('x', x); }\n\t            lineNode.className.baseVal = lineClassName;\n\t            containerNode.appendChild(lineNode);\n\t            offset += line.length + 1;      // + 1 = newline character.\n\t        }\n\t        // Y Alignment calculation\n\t        if (namedVerticalAnchor) {\n\t            if (annotations) {\n\t                dy = calculateDY(verticalAnchor, linesMetrics, fontSize, lineHeight);\n\t            } else if (verticalAnchor === 'top') {\n\t                // A shortcut for top alignment. It does not depend on font-size nor line-height\n\t                dy = '0.8em';\n\t            } else {\n\t                var rh; // remaining height\n\t                if (lastI > 0) {\n\t                    rh = parseFloat(lineHeight) || 1;\n\t                    rh *= lastI;\n\t                    if (!emRegex.test(lineHeight)) { rh /= fontSize; }\n\t                } else {\n\t                    // Single-line text\n\t                    rh = 0;\n\t                }\n\t                switch (verticalAnchor) {\n\t                    case 'middle':\n\t                        dy = (0.3 - (rh / 2)) + 'em';\n\t                        break;\n\t                    case 'bottom':\n\t                        dy = (-rh - 0.3) + 'em';\n\t                        break;\n\t                }\n\t            }\n\t        } else {\n\t            if (verticalAnchor === 0) {\n\t                dy = '0em';\n\t            } else if (verticalAnchor) {\n\t                dy = verticalAnchor;\n\t            } else {\n\t                // No vertical anchor is defined\n\t                dy = 0;\n\t                // Backwards compatibility - we change the `y` attribute instead of `dy`.\n\t                if (this.attr('y') === null) { this.attr('y', annotatedY || '0.8em'); }\n\t            }\n\t        }\n\t        containerNode.firstChild.setAttribute('dy', dy);\n\t        // Appending lines to the element.\n\t        this.append(containerNode);\n\t        return this;\n\t    };\n\n\t    /**\n\t     * @public\n\t     * @param {string} name\n\t     * @returns {Vectorizer}\n\t     */\n\t    VPrototype.removeAttr = function(name) {\n\n\t        var qualifiedName = V.qualifyAttr(name);\n\t        var el = this.node;\n\n\t        if (qualifiedName.ns) {\n\t            if (el.hasAttributeNS(qualifiedName.ns, qualifiedName.local)) {\n\t                el.removeAttributeNS(qualifiedName.ns, qualifiedName.local);\n\t            }\n\t        } else if (el.hasAttribute(name)) {\n\t            el.removeAttribute(name);\n\t        }\n\t        return this;\n\t    };\n\n\t    VPrototype.attr = function(name, value) {\n\n\t        if (V.isUndefined(name)) {\n\n\t            // Return all attributes.\n\t            var attributes = this.node.attributes;\n\t            var attrs = {};\n\n\t            for (var i = 0; i < attributes.length; i++) {\n\t                attrs[attributes[i].name] = attributes[i].value;\n\t            }\n\n\t            return attrs;\n\t        }\n\n\t        if (V.isString(name) && V.isUndefined(value)) {\n\t            return this.node.getAttribute(name);\n\t        }\n\n\t        if (typeof name === 'object') {\n\n\t            for (var attrName in name) {\n\t                if (name.hasOwnProperty(attrName)) {\n\t                    this.setAttribute(attrName, name[attrName]);\n\t                }\n\t            }\n\n\t        } else {\n\n\t            this.setAttribute(name, value);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.normalizePath = function() {\n\n\t        var tagName = this.tagName();\n\t        if (tagName === 'PATH') {\n\t            this.attr('d', V.normalizePathData(this.attr('d')));\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.remove = function() {\n\n\t        if (this.node.parentNode) {\n\t            this.node.parentNode.removeChild(this.node);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.empty = function() {\n\n\t        while (this.node.firstChild) {\n\t            this.node.removeChild(this.node.firstChild);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    /**\n\t     * @private\n\t     * @param {object} attrs\n\t     * @returns {Vectorizer}\n\t     */\n\t    VPrototype.setAttributes = function(attrs) {\n\n\t        for (var key in attrs) {\n\t            if (attrs.hasOwnProperty(key)) {\n\t                this.setAttribute(key, attrs[key]);\n\t            }\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.append = function(els) {\n\n\t        if (!V.isArray(els)) {\n\t            els = [els];\n\t        }\n\n\t        for (var i = 0, len = els.length; i < len; i++) {\n\t            this.node.appendChild(V.toNode(els[i])); // lgtm [js/xss-through-dom]\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.prepend = function(els) {\n\n\t        var child = this.node.firstChild;\n\t        return child ? V(child).before(els) : this.append(els);\n\t    };\n\n\t    VPrototype.before = function(els) {\n\n\t        var node = this.node;\n\t        var parent = node.parentNode;\n\n\t        if (parent) {\n\n\t            if (!V.isArray(els)) {\n\t                els = [els];\n\t            }\n\n\t            for (var i = 0, len = els.length; i < len; i++) {\n\t                parent.insertBefore(V.toNode(els[i]), node);\n\t            }\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.appendTo = function(node) {\n\t        V.toNode(node).appendChild(this.node); // lgtm [js/xss-through-dom]\n\t        return this;\n\t    };\n\n\t    VPrototype.svg = function() {\n\n\t        return this.node instanceof window.SVGSVGElement ? this : V(this.node.ownerSVGElement);\n\t    };\n\n\t    VPrototype.tagName = function() {\n\n\t        return this.node.tagName.toUpperCase();\n\t    };\n\n\t    VPrototype.defs = function() {\n\t        var context = this.svg() || this;\n\t        var defsNode = context.node.getElementsByTagName('defs')[0];\n\t        if (defsNode) { return V(defsNode); }\n\t        return V('defs').appendTo(context);\n\t    };\n\n\t    VPrototype.clone = function() {\n\n\t        var clone = V(this.node.cloneNode(true/* deep */));\n\t        // Note that clone inherits also ID. Therefore, we need to change it here.\n\t        clone.node.id = V.uniqueId();\n\t        return clone;\n\t    };\n\n\t    VPrototype.findOne = function(selector) {\n\n\t        var found = this.node.querySelector(selector);\n\t        return found ? V(found) : undefined;\n\t    };\n\n\t    VPrototype.find = function(selector) {\n\n\t        var vels = [];\n\t        var nodes = this.node.querySelectorAll(selector);\n\n\t        if (nodes) {\n\n\t            // Map DOM elements to `V`s.\n\t            for (var i = 0; i < nodes.length; i++) {\n\t                vels.push(V(nodes[i]));\n\t            }\n\t        }\n\n\t        return vels;\n\t    };\n\n\t    // Returns an array of V elements made from children of this.node.\n\t    VPrototype.children = function() {\n\n\t        var children = this.node.childNodes;\n\n\t        var outputArray = [];\n\t        for (var i = 0; i < children.length; i++) {\n\t            var currentChild = children[i];\n\t            if (currentChild.nodeType === 1) {\n\t                outputArray.push(V(children[i]));\n\t            }\n\t        }\n\t        return outputArray;\n\t    };\n\n\t    // Returns the V element from parentNode of this.node.\n\t    VPrototype.parent = function() {\n\t        return V(this.node.parentNode) || null;\n\t    },\n\n\t    // Find an index of an element inside its container.\n\t    VPrototype.index = function() {\n\n\t        var index = 0;\n\t        var node = this.node.previousSibling;\n\n\t        while (node) {\n\t            // nodeType 1 for ELEMENT_NODE\n\t            if (node.nodeType === 1) { index++; }\n\t            node = node.previousSibling;\n\t        }\n\n\t        return index;\n\t    };\n\n\t    VPrototype.findParentByClass = function(className, terminator) {\n\n\t        var ownerSVGElement = this.node.ownerSVGElement;\n\t        var node = this.node.parentNode;\n\n\t        while (node && node !== terminator && node !== ownerSVGElement) {\n\n\t            var vel = V(node);\n\t            if (vel.hasClass(className)) {\n\t                return vel;\n\t            }\n\n\t            node = node.parentNode;\n\t        }\n\n\t        return null;\n\t    };\n\n\t    // https://jsperf.com/get-common-parent\n\t    VPrototype.contains = function(el) {\n\n\t        var a = this.node;\n\t        var b = V.toNode(el);\n\t        var bup = b && b.parentNode;\n\n\t        return (a === bup) || !!(bup && bup.nodeType === 1 && (a.compareDocumentPosition(bup) & 16));\n\t    };\n\n\t    // Convert global point into the coordinate space of this element.\n\t    VPrototype.toLocalPoint = function(x, y) {\n\n\t        var svg = this.svg().node;\n\n\t        var p = svg.createSVGPoint();\n\t        p.x = x;\n\t        p.y = y;\n\n\t        try {\n\n\t            var globalPoint = p.matrixTransform(svg.getScreenCTM().inverse());\n\t            var globalToLocalMatrix = this.getTransformToElement(svg).inverse();\n\n\t        } catch (e) {\n\t            // IE9 throws an exception in odd cases. (`Unexpected call to method or property access`)\n\t            // We have to make do with the original coordianates.\n\t            return p;\n\t        }\n\n\t        return globalPoint.matrixTransform(globalToLocalMatrix);\n\t    };\n\n\t    VPrototype.translateCenterToPoint = function(p) {\n\n\t        var bbox = this.getBBox({ target: this.svg() });\n\t        var center = bbox.center();\n\n\t        this.translate(p.x - center.x, p.y - center.y);\n\t        return this;\n\t    };\n\n\t    // Efficiently auto-orient an element. This basically implements the orient=auto attribute\n\t    // of markers. The easiest way of understanding on what this does is to imagine the element is an\n\t    // arrowhead. Calling this method on the arrowhead makes it point to the `position` point while\n\t    // being auto-oriented (properly rotated) towards the `reference` point.\n\t    // `target` is the element relative to which the transformations are applied. Usually a viewport.\n\t    VPrototype.translateAndAutoOrient = function(position, reference, target) {\n\n\t        position = new Point(position);\n\t        reference =  new Point(reference);\n\t        target || (target = this.svg());\n\n\t        // Clean-up previously set transformations except the scale. If we didn't clean up the\n\t        // previous transformations then they'd add up with the old ones. Scale is an exception as\n\t        // it doesn't add up, consider: `this.scale(2).scale(2).scale(2)`. The result is that the\n\t        // element is scaled by the factor 2, not 8.\n\t        var scale = this.scale();\n\t        this.attr('transform', '');\n\t        var bbox = this.getBBox({ target: target }).scale(scale.sx, scale.sy);\n\n\t        // 1. Translate to origin.\n\t        var translateToOrigin = V.createSVGTransform();\n\t        translateToOrigin.setTranslate(-bbox.x - bbox.width / 2, -bbox.y - bbox.height / 2);\n\n\t        // 2. Rotate around origin.\n\t        var rotateAroundOrigin = V.createSVGTransform();\n\t        var angle = position.angleBetween(reference, position.clone().offset(1, 0));\n\t        if (angle) { rotateAroundOrigin.setRotate(angle, 0, 0); }\n\n\t        // 3. Translate to the `position` + the offset (half my width) towards the `reference` point.\n\t        var translateFromOrigin = V.createSVGTransform();\n\t        var finalPosition = position.clone().move(reference, bbox.width / 2);\n\t        translateFromOrigin.setTranslate(2 * position.x - finalPosition.x, 2 * position.y - finalPosition.y);\n\n\t        // 4. Get the current transformation matrix of this node\n\t        var ctm = this.getTransformToElement(target);\n\n\t        // 5. Apply transformations and the scale\n\t        var transform = V.createSVGTransform();\n\t        transform.setMatrix(\n\t            translateFromOrigin.matrix.multiply(\n\t                rotateAroundOrigin.matrix.multiply(\n\t                    translateToOrigin.matrix.multiply(\n\t                        ctm.scale(scale.sx, scale.sy)))));\n\n\t        this.attr('transform', V.matrixToTransformString(transform.matrix));\n\n\t        return this;\n\t    };\n\n\t    VPrototype.animateAlongPath = function(attrs, path) {\n\n\t        path = V.toNode(path);\n\n\t        var id = V.ensureId(path);\n\t        var animateMotion = V('animateMotion', attrs);\n\t        var mpath = V('mpath', { 'xlink:href': '#' + id });\n\n\t        animateMotion.append(mpath);\n\n\t        this.append(animateMotion);\n\t        try {\n\t            animateMotion.node.beginElement();\n\t        } catch (e) {\n\t            // Fallback for IE 9.\n\t            // Run the animation programmatically if FakeSmile (`http://leunen.me/fakesmile/`) present\n\t            if (document.documentElement.getAttribute('smiling') === 'fake') {\n\t                /* global getTargets:true, Animator:true, animators:true id2anim:true */\n\t                // Register the animation. (See `https://answers.launchpad.net/smil/+question/203333`)\n\t                var animation = animateMotion.node;\n\t                animation.animators = [];\n\n\t                var animationID = animation.getAttribute('id');\n\t                if (animationID) { id2anim[animationID] = animation; }\n\n\t                var targets = getTargets(animation);\n\t                for (var i = 0, len = targets.length; i < len; i++) {\n\t                    var target = targets[i];\n\t                    var animator = new Animator(animation, target, i);\n\t                    animators.push(animator);\n\t                    animation.animators[i] = animator;\n\t                    animator.register();\n\t                }\n\t            }\n\t        }\n\t        return this;\n\t    };\n\n\t    VPrototype.hasClass = function(className) {\n\n\t        return new RegExp('(\\\\s|^)' + className + '(\\\\s|$)').test(this.node.getAttribute('class'));\n\t    };\n\n\t    VPrototype.addClass = function(className) {\n\n\t        if (className && !this.hasClass(className)) {\n\t            var prevClasses = this.node.getAttribute('class') || '';\n\t            this.node.setAttribute('class', (prevClasses + ' ' + className).trim());\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.removeClass = function(className) {\n\n\t        if (className && this.hasClass(className)) {\n\t            var newClasses = this.node.getAttribute('class').replace(new RegExp('(\\\\s|^)' + className + '(\\\\s|$)', 'g'), '$2');\n\t            this.node.setAttribute('class', newClasses);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    VPrototype.toggleClass = function(className, toAdd) {\n\n\t        var toRemove = V.isUndefined(toAdd) ? this.hasClass(className) : !toAdd;\n\n\t        if (toRemove) {\n\t            this.removeClass(className);\n\t        } else {\n\t            this.addClass(className);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    // Interpolate path by discrete points. The precision of the sampling\n\t    // is controlled by `interval`. In other words, `sample()` will generate\n\t    // a point on the path starting at the beginning of the path going to the end\n\t    // every `interval` pixels.\n\t    // The sampler can be very useful for e.g. finding intersection between two\n\t    // paths (finding the two closest points from two samples).\n\t    VPrototype.sample = function(interval) {\n\n\t        interval = interval || 1;\n\t        var node = this.node;\n\t        var length = node.getTotalLength();\n\t        var samples = [];\n\t        var distance = 0;\n\t        var sample;\n\t        while (distance < length) {\n\t            sample = node.getPointAtLength(distance);\n\t            samples.push({ x: sample.x, y: sample.y, distance: distance });\n\t            distance += interval;\n\t        }\n\t        return samples;\n\t    };\n\n\t    VPrototype.convertToPath = function() {\n\n\t        var path = V('path');\n\t        path.attr(this.attr());\n\t        var d = this.convertToPathData();\n\t        if (d) {\n\t            path.attr('d', d);\n\t        }\n\t        return path;\n\t    };\n\n\t    VPrototype.convertToPathData = function() {\n\n\t        var tagName = this.tagName();\n\n\t        switch (tagName) {\n\t            case 'PATH':\n\t                return this.attr('d');\n\t            case 'LINE':\n\t                return V.convertLineToPathData(this.node);\n\t            case 'POLYGON':\n\t                return V.convertPolygonToPathData(this.node);\n\t            case 'POLYLINE':\n\t                return V.convertPolylineToPathData(this.node);\n\t            case 'ELLIPSE':\n\t                return V.convertEllipseToPathData(this.node);\n\t            case 'CIRCLE':\n\t                return V.convertCircleToPathData(this.node);\n\t            case 'RECT':\n\t                return V.convertRectToPathData(this.node);\n\t        }\n\n\t        throw new Error(tagName + ' cannot be converted to PATH.');\n\t    };\n\n\t    V.prototype.toGeometryShape = function() {\n\t        var x, y, width, height, cx, cy, r, rx, ry, points, d, x1, x2, y1, y2;\n\t        switch (this.tagName()) {\n\n\t            case 'RECT':\n\t                x = parseFloat(this.attr('x')) || 0;\n\t                y = parseFloat(this.attr('y')) || 0;\n\t                width = parseFloat(this.attr('width')) || 0;\n\t                height = parseFloat(this.attr('height')) || 0;\n\t                return new Rect(x, y, width, height);\n\n\t            case 'CIRCLE':\n\t                cx = parseFloat(this.attr('cx')) || 0;\n\t                cy = parseFloat(this.attr('cy')) || 0;\n\t                r = parseFloat(this.attr('r')) || 0;\n\t                return new Ellipse({ x: cx, y: cy }, r, r);\n\n\t            case 'ELLIPSE':\n\t                cx = parseFloat(this.attr('cx')) || 0;\n\t                cy = parseFloat(this.attr('cy')) || 0;\n\t                rx = parseFloat(this.attr('rx')) || 0;\n\t                ry = parseFloat(this.attr('ry')) || 0;\n\t                return new Ellipse({ x: cx, y: cy }, rx, ry);\n\n\t            case 'POLYLINE':\n\t                points = V.getPointsFromSvgNode(this);\n\t                return new Polyline(points);\n\n\t            case 'POLYGON':\n\t                points = V.getPointsFromSvgNode(this);\n\t                if (points.length > 1) { points.push(points[0]); }\n\t                return new Polyline(points);\n\n\t            case 'PATH':\n\t                d = this.attr('d');\n\t                if (!Path.isDataSupported(d)) { d = V.normalizePathData(d); }\n\t                return new Path(d);\n\n\t            case 'LINE':\n\t                x1 = parseFloat(this.attr('x1')) || 0;\n\t                y1 = parseFloat(this.attr('y1')) || 0;\n\t                x2 = parseFloat(this.attr('x2')) || 0;\n\t                y2 = parseFloat(this.attr('y2')) || 0;\n\t                return new Line({ x: x1, y: y1 }, { x: x2, y: y2 });\n\t        }\n\n\t        // Anything else is a rectangle\n\t        return this.getBBox();\n\t    };\n\n\t    // Find the intersection of a line starting in the center\n\t    // of the SVG `node` ending in the point `ref`.\n\t    // `target` is an SVG element to which `node`s transformations are relative to.\n\t    // Note that `ref` point must be in the coordinate system of the `target` for this function to work properly.\n\t    // Returns a point in the `target` coordinate system (the same system as `ref` is in) if\n\t    // an intersection is found. Returns `undefined` otherwise.\n\t    VPrototype.findIntersection = function(ref, target) {\n\n\t        var svg = this.svg().node;\n\t        target = target || svg;\n\t        var bbox = this.getBBox({ target: target });\n\t        var center = bbox.center();\n\n\t        if (!bbox.intersectionWithLineFromCenterToPoint(ref)) { return undefined; }\n\n\t        var spot;\n\t        var tagName = this.tagName();\n\n\t        // Little speed up optimization for `<rect>` element. We do not do conversion\n\t        // to path element and sampling but directly calculate the intersection through\n\t        // a transformed geometrical rectangle.\n\t        if (tagName === 'RECT') {\n\n\t            var gRect = new Rect(\n\t                parseFloat(this.attr('x') || 0),\n\t                parseFloat(this.attr('y') || 0),\n\t                parseFloat(this.attr('width')),\n\t                parseFloat(this.attr('height'))\n\t            );\n\t            // Get the rect transformation matrix with regards to the SVG document.\n\t            var rectMatrix = this.getTransformToElement(target);\n\t            // Decompose the matrix to find the rotation angle.\n\t            var rectMatrixComponents = V.decomposeMatrix(rectMatrix);\n\t            // Now we want to rotate the rectangle back so that we\n\t            // can use `intersectionWithLineFromCenterToPoint()` passing the angle as the second argument.\n\t            var resetRotation = svg.createSVGTransform();\n\t            resetRotation.setRotate(-rectMatrixComponents.rotation, center.x, center.y);\n\t            var rect = V.transformRect(gRect, resetRotation.matrix.multiply(rectMatrix));\n\t            spot = (new Rect(rect)).intersectionWithLineFromCenterToPoint(ref, rectMatrixComponents.rotation);\n\n\t        } else if (tagName === 'PATH' || tagName === 'POLYGON' || tagName === 'POLYLINE' || tagName === 'CIRCLE' || tagName === 'ELLIPSE') {\n\n\t            var pathNode = (tagName === 'PATH') ? this : this.convertToPath();\n\t            var samples = pathNode.sample();\n\t            var minDistance = Infinity;\n\t            var closestSamples = [];\n\n\t            var i, sample, gp, centerDistance, refDistance, distance;\n\n\t            for (i = 0; i < samples.length; i++) {\n\n\t                sample = samples[i];\n\t                // Convert the sample point in the local coordinate system to the global coordinate system.\n\t                gp = V.createSVGPoint(sample.x, sample.y);\n\t                gp = gp.matrixTransform(this.getTransformToElement(target));\n\t                sample = new Point(gp);\n\t                centerDistance = sample.distance(center);\n\t                // Penalize a higher distance to the reference point by 10%.\n\t                // This gives better results. This is due to\n\t                // inaccuracies introduced by rounding errors and getPointAtLength() returns.\n\t                refDistance = sample.distance(ref) * 1.1;\n\t                distance = centerDistance + refDistance;\n\n\t                if (distance < minDistance) {\n\t                    minDistance = distance;\n\t                    closestSamples = [{ sample: sample, refDistance: refDistance }];\n\t                } else if (distance < minDistance + 1) {\n\t                    closestSamples.push({ sample: sample, refDistance: refDistance });\n\t                }\n\t            }\n\n\t            closestSamples.sort(function(a, b) {\n\t                return a.refDistance - b.refDistance;\n\t            });\n\n\t            if (closestSamples[0]) {\n\t                spot = closestSamples[0].sample;\n\t            }\n\t        }\n\n\t        return spot;\n\t    };\n\n\t    /**\n\t     * @private\n\t     * @param {string} name\n\t     * @param {string} value\n\t     * @returns {Vectorizer}\n\t     */\n\t    VPrototype.setAttribute = function(name, value) {\n\n\t        var el = this.node;\n\n\t        if (value === null) {\n\t            this.removeAttr(name);\n\t            return this;\n\t        }\n\n\t        var qualifiedName = V.qualifyAttr(name);\n\n\t        if (qualifiedName.ns) {\n\t            // Attribute names can be namespaced. E.g. `image` elements\n\t            // have a `xlink:href` attribute to set the source of the image.\n\t            el.setAttributeNS(qualifiedName.ns, name, value);\n\t        } else if (name === 'id') {\n\t            el.id = value;\n\t        } else {\n\t            el.setAttribute(name, value);\n\t        }\n\n\t        return this;\n\t    };\n\n\t    // Create an SVG document element.\n\t    // If `content` is passed, it will be used as the SVG content of the `<svg>` root element.\n\t    V.createSvgDocument = function(content) {\n\n\t        if (content) {\n\t            var XMLString = \"<svg xmlns=\\\"\" + (ns.svg) + \"\\\" xmlns:xlink=\\\"\" + (ns.xlink) + \"\\\" version=\\\"\" + SVGVersion + \"\\\">\" + content + \"</svg>\";\n\t            var ref = V.parseXML(XMLString, { async: false });\n\t            var documentElement = ref.documentElement;\n\t            return documentElement;\n\t        }\n\n\t        var svg = document.createElementNS(ns.svg, 'svg');\n\t        svg.setAttributeNS(ns.xmlns, 'xmlns:xlink', ns.xlink);\n\t        svg.setAttribute('version', SVGVersion);\n\t        return svg;\n\t    };\n\n\t    V.createSVGStyle = function(stylesheet) {\n\t        var ref = V('style', { type: 'text/css' }, [\n\t            V.createCDATASection(stylesheet)\n\t        ]);\n\t        var node = ref.node;\n\t        return node;\n\t    },\n\n\t    V.createCDATASection = function(data) {\n\t        if ( data === void 0 ) data = '';\n\n\t        var xml = document.implementation.createDocument(null, 'xml', null);\n\t        return xml.createCDATASection(data);\n\t    };\n\n\t    V.idCounter = 0;\n\n\t    // A function returning a unique identifier for this client session with every call.\n\t    V.uniqueId = function() {\n\n\t        return 'v-' + (++V.idCounter);\n\t    };\n\n\t    V.toNode = function(el) {\n\n\t        return V.isV(el) ? el.node : (el.nodeName && el || el[0]);\n\t    };\n\n\t    V.ensureId = function(node) {\n\n\t        node = V.toNode(node);\n\t        return node.id || (node.id = V.uniqueId());\n\t    };\n\n\t    // Replace all spaces with the Unicode No-break space (http://www.fileformat.info/info/unicode/char/a0/index.htm).\n\t    // IE would otherwise collapse all spaces into one. This is used in the text() method but it is\n\t    // also exposed so that the programmer can use it in case he needs to. This is useful e.g. in tests\n\t    // when you want to compare the actual DOM text content without having to add the unicode character in\n\t    // the place of all spaces.\n\t    V.sanitizeText = function(text) {\n\n\t        return (text || '').replace(/ /g, '\\u00A0');\n\t    };\n\n\t    V.isUndefined = function(value) {\n\n\t        return typeof value === 'undefined';\n\t    };\n\n\t    V.isString = function(value) {\n\n\t        return typeof value === 'string';\n\t    };\n\n\t    V.isObject = function(value) {\n\n\t        return value && (typeof value === 'object');\n\t    };\n\n\t    V.isArray = Array.isArray;\n\n\t    V.parseXML = function(data, opt) {\n\n\t        opt = opt || {};\n\n\t        var xml;\n\n\t        try {\n\t            var parser = new DOMParser();\n\n\t            if (!V.isUndefined(opt.async)) {\n\t                parser.async = opt.async;\n\t            }\n\n\t            xml = parser.parseFromString(data, 'text/xml');\n\t        } catch (error) {\n\t            xml = undefined;\n\t        }\n\n\t        if (!xml || xml.getElementsByTagName('parsererror').length) {\n\t            throw new Error('Invalid XML: ' + data);\n\t        }\n\n\t        return xml;\n\t    };\n\n\t    /**\n\t     * @param {string} name\n\t     * @returns {{ns: string|null, local: string}} namespace and attribute name\n\t     */\n\t    V.qualifyAttr = function(name) {\n\n\t        if (name.indexOf(':') !== -1) {\n\t            var combinedKey = name.split(':');\n\t            return {\n\t                ns: ns[combinedKey[0]],\n\t                local: combinedKey[1]\n\t            };\n\t        }\n\n\t        return {\n\t            ns: null,\n\t            local: name\n\t        };\n\t    };\n\n\t    V.transformRegex = /(\\w+)\\(([^,)]+),?([^)]+)?\\)/gi;\n\t    V.transformSeparatorRegex = /[ ,]+/;\n\t    V.transformationListRegex = /^(\\w+)\\((.*)\\)/;\n\n\t    V.transformStringToMatrix = function(transform) {\n\n\t        var transformationMatrix = V.createSVGMatrix();\n\t        var matches = transform && transform.match(V.transformRegex);\n\t        if (!matches) {\n\t            return transformationMatrix;\n\t        }\n\n\t        for (var i = 0, n = matches.length; i < n; i++) {\n\t            var transformationString = matches[i];\n\n\t            var transformationMatch = transformationString.match(V.transformationListRegex);\n\t            if (transformationMatch) {\n\t                var sx, sy, tx, ty, angle;\n\t                var ctm = V.createSVGMatrix();\n\t                var args = transformationMatch[2].split(V.transformSeparatorRegex);\n\t                switch (transformationMatch[1].toLowerCase()) {\n\t                    case 'scale':\n\t                        sx = parseFloat(args[0]);\n\t                        sy = (args[1] === undefined) ? sx : parseFloat(args[1]);\n\t                        ctm = ctm.scaleNonUniform(sx, sy);\n\t                        break;\n\t                    case 'translate':\n\t                        tx = parseFloat(args[0]);\n\t                        ty = parseFloat(args[1]);\n\t                        ctm = ctm.translate(tx, ty);\n\t                        break;\n\t                    case 'rotate':\n\t                        angle = parseFloat(args[0]);\n\t                        tx = parseFloat(args[1]) || 0;\n\t                        ty = parseFloat(args[2]) || 0;\n\t                        if (tx !== 0 || ty !== 0) {\n\t                            ctm = ctm.translate(tx, ty).rotate(angle).translate(-tx, -ty);\n\t                        } else {\n\t                            ctm = ctm.rotate(angle);\n\t                        }\n\t                        break;\n\t                    case 'skewx':\n\t                        angle = parseFloat(args[0]);\n\t                        ctm = ctm.skewX(angle);\n\t                        break;\n\t                    case 'skewy':\n\t                        angle = parseFloat(args[0]);\n\t                        ctm = ctm.skewY(angle);\n\t                        break;\n\t                    case 'matrix':\n\t                        ctm.a = parseFloat(args[0]);\n\t                        ctm.b = parseFloat(args[1]);\n\t                        ctm.c = parseFloat(args[2]);\n\t                        ctm.d = parseFloat(args[3]);\n\t                        ctm.e = parseFloat(args[4]);\n\t                        ctm.f = parseFloat(args[5]);\n\t                        break;\n\t                    default:\n\t                        continue;\n\t                }\n\n\t                transformationMatrix = transformationMatrix.multiply(ctm);\n\t            }\n\n\t        }\n\t        return transformationMatrix;\n\t    };\n\n\t    V.matrixToTransformString = function(matrix) {\n\t        matrix || (matrix = true);\n\n\t        return 'matrix(' +\n\t            (matrix.a !== undefined ? matrix.a : 1) + ',' +\n\t            (matrix.b !== undefined ? matrix.b : 0) + ',' +\n\t            (matrix.c !== undefined ? matrix.c : 0) + ',' +\n\t            (matrix.d !== undefined ? matrix.d : 1) + ',' +\n\t            (matrix.e !== undefined ? matrix.e : 0) + ',' +\n\t            (matrix.f !== undefined ? matrix.f : 0) +\n\t            ')';\n\t    };\n\n\t    V.parseTransformString = function(transform) {\n\n\t        var translate, rotate, scale;\n\n\t        if (transform) {\n\n\t            var separator = V.transformSeparatorRegex;\n\n\t            // Allow reading transform string with a single matrix\n\t            if (transform.trim().indexOf('matrix') >= 0) {\n\n\t                var matrix = V.transformStringToMatrix(transform);\n\t                var decomposedMatrix = V.decomposeMatrix(matrix);\n\n\t                translate = [decomposedMatrix.translateX, decomposedMatrix.translateY];\n\t                scale = [decomposedMatrix.scaleX, decomposedMatrix.scaleY];\n\t                rotate = [decomposedMatrix.rotation];\n\n\t                var transformations = [];\n\t                if (translate[0] !== 0 || translate[1] !== 0) {\n\t                    transformations.push('translate(' + translate + ')');\n\t                }\n\t                if (scale[0] !== 1 || scale[1] !== 1) {\n\t                    transformations.push('scale(' + scale + ')');\n\t                }\n\t                if (rotate[0] !== 0) {\n\t                    transformations.push('rotate(' + rotate + ')');\n\t                }\n\t                transform = transformations.join(' ');\n\n\t            } else {\n\n\t                var translateMatch = transform.match(/translate\\((.*?)\\)/);\n\t                if (translateMatch) {\n\t                    translate = translateMatch[1].split(separator);\n\t                }\n\t                var rotateMatch = transform.match(/rotate\\((.*?)\\)/);\n\t                if (rotateMatch) {\n\t                    rotate = rotateMatch[1].split(separator);\n\t                }\n\t                var scaleMatch = transform.match(/scale\\((.*?)\\)/);\n\t                if (scaleMatch) {\n\t                    scale = scaleMatch[1].split(separator);\n\t                }\n\t            }\n\t        }\n\n\t        var sx = (scale && scale[0]) ? parseFloat(scale[0]) : 1;\n\n\t        return {\n\t            value: transform,\n\t            translate: {\n\t                tx: (translate && translate[0]) ? parseInt(translate[0], 10) : 0,\n\t                ty: (translate && translate[1]) ? parseInt(translate[1], 10) : 0\n\t            },\n\t            rotate: {\n\t                angle: (rotate && rotate[0]) ? parseInt(rotate[0], 10) : 0,\n\t                cx: (rotate && rotate[1]) ? parseInt(rotate[1], 10) : undefined,\n\t                cy: (rotate && rotate[2]) ? parseInt(rotate[2], 10) : undefined\n\t            },\n\t            scale: {\n\t                sx: sx,\n\t                sy: (scale && scale[1]) ? parseFloat(scale[1]) : sx\n\t            }\n\t        };\n\t    };\n\n\t    V.deltaTransformPoint = function(matrix, point) {\n\n\t        var dx = point.x * matrix.a + point.y * matrix.c + 0;\n\t        var dy = point.x * matrix.b + point.y * matrix.d + 0;\n\t        return { x: dx, y: dy };\n\t    };\n\n\t    V.decomposeMatrix = function(matrix) {\n\n\t        // @see https://gist.github.com/2052247\n\n\t        // calculate delta transform point\n\t        var px = V.deltaTransformPoint(matrix, { x: 0, y: 1 });\n\t        var py = V.deltaTransformPoint(matrix, { x: 1, y: 0 });\n\n\t        // calculate skew\n\t        var skewX = ((180 / PI) * atan2(px.y, px.x) - 90);\n\t        var skewY = ((180 / PI) * atan2(py.y, py.x));\n\n\t        return {\n\n\t            translateX: matrix.e,\n\t            translateY: matrix.f,\n\t            scaleX: sqrt(matrix.a * matrix.a + matrix.b * matrix.b),\n\t            scaleY: sqrt(matrix.c * matrix.c + matrix.d * matrix.d),\n\t            skewX: skewX,\n\t            skewY: skewY,\n\t            rotation: skewX // rotation is the same as skew x\n\t        };\n\t    };\n\n\t    // Return the `scale` transformation from the following equation:\n\t    // `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`\n\t    V.matrixToScale = function(matrix) {\n\n\t        var a, b, c, d;\n\t        if (matrix) {\n\t            a = V.isUndefined(matrix.a) ? 1 : matrix.a;\n\t            d = V.isUndefined(matrix.d) ? 1 : matrix.d;\n\t            b = matrix.b;\n\t            c = matrix.c;\n\t        } else {\n\t            a = d = 1;\n\t        }\n\t        return {\n\t            sx: b ? sqrt(a * a + b * b) : a,\n\t            sy: c ? sqrt(c * c + d * d) : d\n\t        };\n\t    };\n\n\t    // Return the `rotate` transformation from the following equation:\n\t    // `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`\n\t    V.matrixToRotate = function(matrix) {\n\n\t        var p = { x: 0, y: 1 };\n\t        if (matrix) {\n\t            p = V.deltaTransformPoint(matrix, p);\n\t        }\n\n\t        return {\n\t            angle: normalizeAngle(toDeg(atan2(p.y, p.x)) - 90)\n\t        };\n\t    };\n\n\t    // Return the `translate` transformation from the following equation:\n\t    // `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`\n\t    V.matrixToTranslate = function(matrix) {\n\n\t        return {\n\t            tx: (matrix && matrix.e) || 0,\n\t            ty: (matrix && matrix.f) || 0\n\t        };\n\t    };\n\n\t    V.isV = function(object) {\n\n\t        return object instanceof V;\n\t    };\n\n\t    // For backwards compatibility:\n\t    V.isVElement = V.isV;\n\n\t    // Element implements `getBBox()`, `getCTM()` and `getScreenCTM()`\n\t    // https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement\n\t    V.isSVGGraphicsElement = function(node) {\n\t        if (!node) { return false; }\n\t        node = V.toNode(node);\n\t        // IE/Edge does not implement SVGGraphicsElement interface, thus check for `getScreenCTM` below\n\t        return node instanceof SVGElement && typeof node.getScreenCTM === 'function';\n\t    };\n\n\t    var svgDocument = V('svg').node;\n\n\t    V.createSVGMatrix = function(matrix) {\n\n\t        var svgMatrix = svgDocument.createSVGMatrix();\n\t        for (var component in matrix) {\n\t            svgMatrix[component] = matrix[component];\n\t        }\n\n\t        return svgMatrix;\n\t    };\n\n\t    V.createSVGTransform = function(matrix) {\n\n\t        if (!V.isUndefined(matrix)) {\n\n\t            if (!(matrix instanceof SVGMatrix)) {\n\t                matrix = V.createSVGMatrix(matrix);\n\t            }\n\n\t            return svgDocument.createSVGTransformFromMatrix(matrix);\n\t        }\n\n\t        return svgDocument.createSVGTransform();\n\t    };\n\n\t    V.createSVGPoint = function(x, y) {\n\n\t        var p = svgDocument.createSVGPoint();\n\t        p.x = x;\n\t        p.y = y;\n\t        return p;\n\t    };\n\n\t    V.transformRect = function(r, matrix) {\n\n\t        var p = svgDocument.createSVGPoint();\n\n\t        p.x = r.x;\n\t        p.y = r.y;\n\t        var corner1 = p.matrixTransform(matrix);\n\n\t        p.x = r.x + r.width;\n\t        p.y = r.y;\n\t        var corner2 = p.matrixTransform(matrix);\n\n\t        p.x = r.x + r.width;\n\t        p.y = r.y + r.height;\n\t        var corner3 = p.matrixTransform(matrix);\n\n\t        p.x = r.x;\n\t        p.y = r.y + r.height;\n\t        var corner4 = p.matrixTransform(matrix);\n\n\t        var minX = min(corner1.x, corner2.x, corner3.x, corner4.x);\n\t        var maxX = max(corner1.x, corner2.x, corner3.x, corner4.x);\n\t        var minY = min(corner1.y, corner2.y, corner3.y, corner4.y);\n\t        var maxY = max(corner1.y, corner2.y, corner3.y, corner4.y);\n\n\t        return new Rect(minX, minY, maxX - minX, maxY - minY);\n\t    };\n\n\t    V.transformPoint = function(p, matrix) {\n\n\t        return new Point(V.createSVGPoint(p.x, p.y).matrixTransform(matrix));\n\t    };\n\n\t    V.transformLine = function(l, matrix) {\n\n\t        return new Line(\n\t            V.transformPoint(l.start, matrix),\n\t            V.transformPoint(l.end, matrix)\n\t        );\n\t    };\n\n\t    V.transformPolyline = function(p, matrix) {\n\n\t        var inPoints = (p instanceof Polyline) ? p.points : p;\n\t        if (!V.isArray(inPoints)) { inPoints = []; }\n\t        var outPoints = [];\n\t        for (var i = 0, n = inPoints.length; i < n; i++) { outPoints[i] = V.transformPoint(inPoints[i], matrix); }\n\t        return new Polyline(outPoints);\n\t    };\n\n\t    // Convert a style represented as string (e.g. `'fill=\"blue\"; stroke=\"red\"'`) to\n\t    // an object (`{ fill: 'blue', stroke: 'red' }`).\n\t    V.styleToObject = function(styleString) {\n\t        var ret = {};\n\t        var styles = styleString.split(';');\n\t        for (var i = 0; i < styles.length; i++) {\n\t            var style = styles[i];\n\t            var pair = style.split('=');\n\t            ret[pair[0].trim()] = pair[1].trim();\n\t        }\n\t        return ret;\n\t    };\n\n\t    // Inspired by d3.js https://github.com/mbostock/d3/blob/master/src/svg/arc.js\n\t    V.createSlicePathData = function(innerRadius, outerRadius, startAngle, endAngle) {\n\n\t        var svgArcMax = 2 * PI - 1e-6;\n\t        var r0 = innerRadius;\n\t        var r1 = outerRadius;\n\t        var a0 = startAngle;\n\t        var a1 = endAngle;\n\t        var da = (a1 < a0 && (da = a0, a0 = a1, a1 = da), a1 - a0);\n\t        var df = da < PI ? '0' : '1';\n\t        var c0 = cos(a0);\n\t        var s0 = sin(a0);\n\t        var c1 = cos(a1);\n\t        var s1 = sin(a1);\n\n\t        return (da >= svgArcMax)\n\t            ? (r0\n\t                ? 'M0,' + r1\n\t                + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + (-r1)\n\t                + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + r1\n\t                + 'M0,' + r0\n\t                + 'A' + r0 + ',' + r0 + ' 0 1,0 0,' + (-r0)\n\t                + 'A' + r0 + ',' + r0 + ' 0 1,0 0,' + r0\n\t                + 'Z'\n\t                : 'M0,' + r1\n\t                + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + (-r1)\n\t                + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + r1\n\t                + 'Z')\n\t            : (r0\n\t                ? 'M' + r1 * c0 + ',' + r1 * s0\n\t                + 'A' + r1 + ',' + r1 + ' 0 ' + df + ',1 ' + r1 * c1 + ',' + r1 * s1\n\t                + 'L' + r0 * c1 + ',' + r0 * s1\n\t                + 'A' + r0 + ',' + r0 + ' 0 ' + df + ',0 ' + r0 * c0 + ',' + r0 * s0\n\t                + 'Z'\n\t                : 'M' + r1 * c0 + ',' + r1 * s0\n\t                + 'A' + r1 + ',' + r1 + ' 0 ' + df + ',1 ' + r1 * c1 + ',' + r1 * s1\n\t                + 'L0,0'\n\t                + 'Z');\n\t    };\n\n\t    // Merge attributes from object `b` with attributes in object `a`.\n\t    // Note that this modifies the object `a`.\n\t    // Also important to note that attributes are merged but CSS classes are concatenated.\n\t    V.mergeAttrs = function(a, b) {\n\n\t        for (var attr in b) {\n\n\t            if (attr === 'class') {\n\t                // Concatenate classes.\n\t                a[attr] = a[attr] ? a[attr] + ' ' + b[attr] : b[attr];\n\t            } else if (attr === 'style') {\n\t                // `style` attribute can be an object.\n\t                if (V.isObject(a[attr]) && V.isObject(b[attr])) {\n\t                    // `style` stored in `a` is an object.\n\t                    a[attr] = V.mergeAttrs(a[attr], b[attr]);\n\t                } else if (V.isObject(a[attr])) {\n\t                    // `style` in `a` is an object but it's a string in `b`.\n\t                    // Convert the style represented as a string to an object in `b`.\n\t                    a[attr] = V.mergeAttrs(a[attr], V.styleToObject(b[attr]));\n\t                } else if (V.isObject(b[attr])) {\n\t                    // `style` in `a` is a string, in `b` it's an object.\n\t                    a[attr] = V.mergeAttrs(V.styleToObject(a[attr]), b[attr]);\n\t                } else {\n\t                    // Both styles are strings.\n\t                    a[attr] = V.mergeAttrs(V.styleToObject(a[attr]), V.styleToObject(b[attr]));\n\t                }\n\t            } else {\n\t                a[attr] = b[attr];\n\t            }\n\t        }\n\n\t        return a;\n\t    };\n\n\t    V.annotateString = function(t, annotations, opt) {\n\n\t        annotations = annotations || [];\n\t        opt = opt || {};\n\n\t        var offset = opt.offset || 0;\n\t        var compacted = [];\n\t        var batch;\n\t        var ret = [];\n\t        var item;\n\t        var prev;\n\n\t        for (var i = 0; i < t.length; i++) {\n\n\t            item = ret[i] = t[i];\n\n\t            for (var j = 0; j < annotations.length; j++) {\n\n\t                var annotation = annotations[j];\n\t                var start = annotation.start + offset;\n\t                var end = annotation.end + offset;\n\n\t                if (i >= start && i < end) {\n\t                    // Annotation applies.\n\t                    if (V.isObject(item)) {\n\t                        // There is more than one annotation to be applied => Merge attributes.\n\t                        item.attrs = V.mergeAttrs(V.mergeAttrs({}, item.attrs), annotation.attrs);\n\t                    } else {\n\t                        item = ret[i] = { t: t[i], attrs: annotation.attrs };\n\t                    }\n\t                    if (opt.includeAnnotationIndices) {\n\t                        (item.annotations || (item.annotations = [])).push(j);\n\t                    }\n\t                }\n\t            }\n\n\t            prev = ret[i - 1];\n\n\t            if (!prev) {\n\n\t                batch = item;\n\n\t            } else if (V.isObject(item) && V.isObject(prev)) {\n\t                // Both previous item and the current one are annotations. If the attributes\n\t                // didn't change, merge the text.\n\t                if (JSON.stringify(item.attrs) === JSON.stringify(prev.attrs)) {\n\t                    batch.t += item.t;\n\t                } else {\n\t                    compacted.push(batch);\n\t                    batch = item;\n\t                }\n\n\t            } else if (V.isObject(item)) {\n\t                // Previous item was a string, current item is an annotation.\n\t                compacted.push(batch);\n\t                batch = item;\n\n\t            } else if (V.isObject(prev)) {\n\t                // Previous item was an annotation, current item is a string.\n\t                compacted.push(batch);\n\t                batch = item;\n\n\t            } else {\n\t                // Both previous and current item are strings.\n\t                batch = (batch || '') + item;\n\t            }\n\t        }\n\n\t        if (batch) {\n\t            compacted.push(batch);\n\t        }\n\n\t        return compacted;\n\t    };\n\n\t    V.findAnnotationsAtIndex = function(annotations, index) {\n\n\t        var found = [];\n\n\t        if (annotations) {\n\n\t            annotations.forEach(function(annotation) {\n\n\t                if (annotation.start < index && index <= annotation.end) {\n\t                    found.push(annotation);\n\t                }\n\t            });\n\t        }\n\n\t        return found;\n\t    };\n\n\t    V.findAnnotationsBetweenIndexes = function(annotations, start, end) {\n\n\t        var found = [];\n\n\t        if (annotations) {\n\n\t            annotations.forEach(function(annotation) {\n\n\t                if ((start >= annotation.start && start < annotation.end) || (end > annotation.start && end <= annotation.end) || (annotation.start >= start && annotation.end < end)) {\n\t                    found.push(annotation);\n\t                }\n\t            });\n\t        }\n\n\t        return found;\n\t    };\n\n\t    // Shift all the text annotations after character `index` by `offset` positions.\n\t    V.shiftAnnotations = function(annotations, index, offset) {\n\n\t        if (annotations) {\n\n\t            annotations.forEach(function(annotation) {\n\n\t                if (annotation.start < index && annotation.end >= index) {\n\t                    annotation.end += offset;\n\t                } else if (annotation.start >= index) {\n\t                    annotation.start += offset;\n\t                    annotation.end += offset;\n\t                }\n\t            });\n\t        }\n\n\t        return annotations;\n\t    };\n\n\t    V.convertLineToPathData = function(line) {\n\n\t        line = V(line);\n\t        var d = [\n\t            'M', line.attr('x1'), line.attr('y1'),\n\t            'L', line.attr('x2'), line.attr('y2')\n\t        ].join(' ');\n\t        return d;\n\t    };\n\n\t    V.convertPolygonToPathData = function(polygon) {\n\n\t        var points = V.getPointsFromSvgNode(polygon);\n\t        if (points.length === 0) { return null; }\n\n\t        return V.svgPointsToPath(points) + ' Z';\n\t    };\n\n\t    V.convertPolylineToPathData = function(polyline) {\n\n\t        var points = V.getPointsFromSvgNode(polyline);\n\t        if (points.length === 0) { return null; }\n\n\t        return V.svgPointsToPath(points);\n\t    };\n\n\t    V.svgPointsToPath = function(points) {\n\n\t        for (var i = 0, n = points.length; i < n; i++) {\n\t            points[i] = points[i].x + ' ' + points[i].y;\n\t        }\n\n\t        return 'M ' + points.join(' L');\n\t    };\n\n\t    V.getPointsFromSvgNode = function(node) {\n\n\t        node = V.toNode(node);\n\t        var points = [];\n\t        var nodePoints = node.points;\n\t        if (nodePoints) {\n\t            for (var i = 0, n = nodePoints.numberOfItems; i < n; i++) {\n\t                points.push(nodePoints.getItem(i));\n\t            }\n\t        }\n\n\t        return points;\n\t    };\n\n\t    V.KAPPA = 0.551784;\n\n\t    V.convertCircleToPathData = function(circle) {\n\n\t        circle = V(circle);\n\t        var cx = parseFloat(circle.attr('cx')) || 0;\n\t        var cy = parseFloat(circle.attr('cy')) || 0;\n\t        var r = parseFloat(circle.attr('r'));\n\t        var cd = r * V.KAPPA; // Control distance.\n\n\t        var d = [\n\t            'M', cx, cy - r,    // Move to the first point.\n\t            'C', cx + cd, cy - r, cx + r, cy - cd, cx + r, cy, // I. Quadrant.\n\t            'C', cx + r, cy + cd, cx + cd, cy + r, cx, cy + r, // II. Quadrant.\n\t            'C', cx - cd, cy + r, cx - r, cy + cd, cx - r, cy, // III. Quadrant.\n\t            'C', cx - r, cy - cd, cx - cd, cy - r, cx, cy - r, // IV. Quadrant.\n\t            'Z'\n\t        ].join(' ');\n\t        return d;\n\t    };\n\n\t    V.convertEllipseToPathData = function(ellipse) {\n\n\t        ellipse = V(ellipse);\n\t        var cx = parseFloat(ellipse.attr('cx')) || 0;\n\t        var cy = parseFloat(ellipse.attr('cy')) || 0;\n\t        var rx = parseFloat(ellipse.attr('rx'));\n\t        var ry = parseFloat(ellipse.attr('ry')) || rx;\n\t        var cdx = rx * V.KAPPA; // Control distance x.\n\t        var cdy = ry * V.KAPPA; // Control distance y.\n\n\t        var d = [\n\t            'M', cx, cy - ry,    // Move to the first point.\n\t            'C', cx + cdx, cy - ry, cx + rx, cy - cdy, cx + rx, cy, // I. Quadrant.\n\t            'C', cx + rx, cy + cdy, cx + cdx, cy + ry, cx, cy + ry, // II. Quadrant.\n\t            'C', cx - cdx, cy + ry, cx - rx, cy + cdy, cx - rx, cy, // III. Quadrant.\n\t            'C', cx - rx, cy - cdy, cx - cdx, cy - ry, cx, cy - ry, // IV. Quadrant.\n\t            'Z'\n\t        ].join(' ');\n\t        return d;\n\t    };\n\n\t    V.convertRectToPathData = function(rect) {\n\n\t        rect = V(rect);\n\n\t        return V.rectToPath({\n\t            x: parseFloat(rect.attr('x')) || 0,\n\t            y: parseFloat(rect.attr('y')) || 0,\n\t            width: parseFloat(rect.attr('width')) || 0,\n\t            height: parseFloat(rect.attr('height')) || 0,\n\t            rx: parseFloat(rect.attr('rx')) || 0,\n\t            ry: parseFloat(rect.attr('ry')) || 0\n\t        });\n\t    };\n\n\t    // Convert a rectangle to SVG path commands. `r` is an object of the form:\n\t    // `{ x: [number], y: [number], width: [number], height: [number], top-ry: [number], top-ry: [number], bottom-rx: [number], bottom-ry: [number] }`,\n\t    // where `x, y, width, height` are the usual rectangle attributes and [top-/bottom-]rx/ry allows for\n\t    // specifying radius of the rectangle for all its sides (as opposed to the built-in SVG rectangle\n\t    // that has only `rx` and `ry` attributes).\n\t    V.rectToPath = function(r) {\n\n\t        var d;\n\t        var x = r.x;\n\t        var y = r.y;\n\t        var width = r.width;\n\t        var height = r.height;\n\t        var topRx = min(r.rx || r['top-rx'] || 0, width / 2);\n\t        var bottomRx = min(r.rx || r['bottom-rx'] || 0, width / 2);\n\t        var topRy = min(r.ry || r['top-ry'] || 0, height / 2);\n\t        var bottomRy = min(r.ry || r['bottom-ry'] || 0, height / 2);\n\n\t        if (topRx || bottomRx || topRy || bottomRy) {\n\t            d = [\n\t                'M', x, y + topRy,\n\t                'v', height - topRy - bottomRy,\n\t                'a', bottomRx, bottomRy, 0, 0, 0, bottomRx, bottomRy,\n\t                'h', width - 2 * bottomRx,\n\t                'a', bottomRx, bottomRy, 0, 0, 0, bottomRx, -bottomRy,\n\t                'v', -(height - bottomRy - topRy),\n\t                'a', topRx, topRy, 0, 0, 0, -topRx, -topRy,\n\t                'h', -(width - 2 * topRx),\n\t                'a', topRx, topRy, 0, 0, 0, -topRx, topRy,\n\t                'Z'\n\t            ];\n\t        } else {\n\t            d = [\n\t                'M', x, y,\n\t                'H', x + width,\n\t                'V', y + height,\n\t                'H', x,\n\t                'V', y,\n\t                'Z'\n\t            ];\n\t        }\n\n\t        return d.join(' ');\n\t    };\n\n\t    // Take a path data string\n\t    // Return a normalized path data string\n\t    // If data cannot be parsed, return 'M 0 0'\n\t    // Adapted from Rappid normalizePath polyfill\n\t    // Highly inspired by Raphael Library (www.raphael.com)\n\t    V.normalizePathData = (function() {\n\n\t        var spaces = '\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029';\n\t        var pathCommand = new RegExp('([a-z])[' + spaces + ',]*((-?\\\\d*\\\\.?\\\\d*(?:e[\\\\-+]?\\\\d+)?[' + spaces + ']*,?[' + spaces + ']*)+)', 'ig');\n\t        var pathValues = new RegExp('(-?\\\\d*\\\\.?\\\\d*(?:e[\\\\-+]?\\\\d+)?)[' + spaces + ']*,?[' + spaces + ']*', 'ig');\n\n\t        var math = Math;\n\t        var PI = math.PI;\n\t        var sin = math.sin;\n\t        var cos = math.cos;\n\t        var tan = math.tan;\n\t        var asin = math.asin;\n\t        var sqrt = math.sqrt;\n\t        var abs = math.abs;\n\n\t        function q2c(x1, y1, ax, ay, x2, y2) {\n\n\t            var _13 = 1 / 3;\n\t            var _23 = 2 / 3;\n\t            return [(_13 * x1) + (_23 * ax), (_13 * y1) + (_23 * ay), (_13 * x2) + (_23 * ax), (_13 * y2) + (_23 * ay), x2, y2];\n\t        }\n\n\t        function rotate(x, y, rad) {\n\n\t            var X = (x * cos(rad)) - (y * sin(rad));\n\t            var Y = (x * sin(rad)) + (y * cos(rad));\n\t            return { x: X, y: Y };\n\t        }\n\n\t        function a2c(x1, y1, rx, ry, angle, large_arc_flag, sweep_flag, x2, y2, recursive) {\n\t            // for more information of where this math came from visit:\n\t            // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n\t            var _120 = (PI * 120) / 180;\n\t            var rad = (PI / 180) * (+angle || 0);\n\t            var res = [];\n\t            var xy;\n\n\t            if (!recursive) {\n\t                xy = rotate(x1, y1, -rad);\n\t                x1 = xy.x;\n\t                y1 = xy.y;\n\n\t                xy = rotate(x2, y2, -rad);\n\t                x2 = xy.x;\n\t                y2 = xy.y;\n\n\t                var x = (x1 - x2) / 2;\n\t                var y = (y1 - y2) / 2;\n\t                var h = ((x * x) / (rx * rx)) + ((y * y) / (ry * ry));\n\n\t                if (h > 1) {\n\t                    h = sqrt(h);\n\t                    rx = h * rx;\n\t                    ry = h * ry;\n\t                }\n\n\t                var rx2 = rx * rx;\n\t                var ry2 = ry * ry;\n\n\t                var k = ((large_arc_flag == sweep_flag) ? -1 : 1) * sqrt(abs(((rx2 * ry2) - (rx2 * y * y) - (ry2 * x * x)) / ((rx2 * y * y) + (ry2 * x * x))));\n\n\t                var cx = ((k * rx * y) / ry) + ((x1 + x2) / 2);\n\t                var cy = ((k * -ry * x) / rx) + ((y1 + y2) / 2);\n\n\t                var f1 = asin(((y1 - cy) / ry).toFixed(9));\n\t                var f2 = asin(((y2 - cy) / ry).toFixed(9));\n\n\t                f1 = ((x1 < cx) ? (PI - f1) : f1);\n\t                f2 = ((x2 < cx) ? (PI - f2) : f2);\n\n\t                if (f1 < 0) { f1 = (PI * 2) + f1; }\n\t                if (f2 < 0) { f2 = (PI * 2) + f2; }\n\n\t                if (sweep_flag && (f1 > f2)) { f1 = f1 - (PI * 2); }\n\t                if (!sweep_flag && (f2 > f1)) { f2 = f2 - (PI * 2); }\n\n\t            } else {\n\t                f1 = recursive[0];\n\t                f2 = recursive[1];\n\t                cx = recursive[2];\n\t                cy = recursive[3];\n\t            }\n\n\t            var df = f2 - f1;\n\t            if (abs(df) > _120) {\n\t                var f2old = f2;\n\t                var x2old = x2;\n\t                var y2old = y2;\n\t                f2 = f1 + (_120 * ((sweep_flag && (f2 > f1)) ? 1 : -1));\n\t                x2 = cx + (rx * cos(f2));\n\t                y2 = cy + (ry * sin(f2));\n\t                res = a2c(x2, y2, rx, ry, angle, 0, sweep_flag, x2old, y2old, [f2, f2old, cx, cy]);\n\t            }\n\n\t            df = f2 - f1;\n\n\t            var c1 = cos(f1);\n\t            var s1 = sin(f1);\n\t            var c2 = cos(f2);\n\t            var s2 = sin(f2);\n\t            var t = tan(df / 4);\n\t            var hx = (4 / 3) * (rx * t);\n\t            var hy = (4 / 3) * (ry * t);\n\t            var m1 = [x1, y1];\n\t            var m2 = [x1 + (hx * s1), y1 - (hy * c1)];\n\t            var m3 = [x2 + (hx * s2), y2 - (hy * c2)];\n\t            var m4 = [x2, y2];\n\n\t            m2[0] = (2 * m1[0]) - m2[0];\n\t            m2[1] = (2 * m1[1]) - m2[1];\n\n\t            if (recursive) {\n\t                return [m2, m3, m4].concat(res);\n\t            } else {\n\t                res = [m2, m3, m4].concat(res).join().split(',');\n\t                var newres = [];\n\t                var ii = res.length;\n\t                for (var i = 0; i < ii; i++) {\n\t                    newres[i] = (i % 2) ? rotate(res[i - 1], res[i], rad).y : rotate(res[i], res[i + 1], rad).x;\n\t                }\n\t                return newres;\n\t            }\n\t        }\n\n\t        function parsePathString(pathString) {\n\n\t            if (!pathString) { return null; }\n\n\t            var paramCounts = { a: 7, c: 6, h: 1, l: 2, m: 2, q: 4, s: 4, t: 2, v: 1, z: 0 };\n\t            var data = [];\n\n\t            String(pathString).replace(pathCommand, function(a, b, c) {\n\n\t                var params = [];\n\t                var name = b.toLowerCase();\n\t                c.replace(pathValues, function(a, b) {\n\t                    if (b) { params.push(+b); }\n\t                });\n\n\t                if ((name === 'm') && (params.length > 2)) {\n\t                    data.push([b].concat(params.splice(0, 2)));\n\t                    name = 'l';\n\t                    b = ((b === 'm') ? 'l' : 'L');\n\t                }\n\n\t                while (params.length >= paramCounts[name]) {\n\t                    data.push([b].concat(params.splice(0, paramCounts[name])));\n\t                    if (!paramCounts[name]) { break; }\n\t                }\n\t            });\n\n\t            return data;\n\t        }\n\n\t        function pathToAbsolute(pathArray) {\n\n\t            if (!Array.isArray(pathArray) || !Array.isArray(pathArray && pathArray[0])) { // rough assumption\n\t                pathArray = parsePathString(pathArray);\n\t            }\n\n\t            // if invalid string, return 'M 0 0'\n\t            if (!pathArray || !pathArray.length) { return [['M', 0, 0]]; }\n\n\t            var res = [];\n\t            var x = 0;\n\t            var y = 0;\n\t            var mx = 0;\n\t            var my = 0;\n\t            var start = 0;\n\t            var pa0;\n\n\t            var ii = pathArray.length;\n\t            for (var i = start; i < ii; i++) {\n\n\t                var r = [];\n\t                res.push(r);\n\n\t                var pa = pathArray[i];\n\t                pa0 = pa[0];\n\n\t                if (pa0 != pa0.toUpperCase()) {\n\t                    r[0] = pa0.toUpperCase();\n\n\t                    var jj;\n\t                    var j;\n\t                    switch (r[0]) {\n\t                        case 'A':\n\t                            r[1] = pa[1];\n\t                            r[2] = pa[2];\n\t                            r[3] = pa[3];\n\t                            r[4] = pa[4];\n\t                            r[5] = pa[5];\n\t                            r[6] = +pa[6] + x;\n\t                            r[7] = +pa[7] + y;\n\t                            break;\n\n\t                        case 'V':\n\t                            r[1] = +pa[1] + y;\n\t                            break;\n\n\t                        case 'H':\n\t                            r[1] = +pa[1] + x;\n\t                            break;\n\n\t                        case 'M':\n\t                            mx = +pa[1] + x;\n\t                            my = +pa[2] + y;\n\n\t                            jj = pa.length;\n\t                            for (j = 1; j < jj; j++) {\n\t                                r[j] = +pa[j] + ((j % 2) ? x : y);\n\t                            }\n\t                            break;\n\n\t                        default:\n\t                            jj = pa.length;\n\t                            for (j = 1; j < jj; j++) {\n\t                                r[j] = +pa[j] + ((j % 2) ? x : y);\n\t                            }\n\t                            break;\n\t                    }\n\t                } else {\n\t                    var kk = pa.length;\n\t                    for (var k = 0; k < kk; k++) {\n\t                        r[k] = pa[k];\n\t                    }\n\t                }\n\n\t                switch (r[0]) {\n\t                    case 'Z':\n\t                        x = +mx;\n\t                        y = +my;\n\t                        break;\n\n\t                    case 'H':\n\t                        x = r[1];\n\t                        break;\n\n\t                    case 'V':\n\t                        y = r[1];\n\t                        break;\n\n\t                    case 'M':\n\t                        mx = r[r.length - 2];\n\t                        my = r[r.length - 1];\n\t                        x = r[r.length - 2];\n\t                        y = r[r.length - 1];\n\t                        break;\n\n\t                    default:\n\t                        x = r[r.length - 2];\n\t                        y = r[r.length - 1];\n\t                        break;\n\t                }\n\t            }\n\n\t            return res;\n\t        }\n\n\t        function normalize(path) {\n\n\t            var p = pathToAbsolute(path);\n\t            var attrs = { x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null };\n\n\t            function processPath(path, d, pcom) {\n\n\t                var nx, ny;\n\n\t                if (!path) { return ['C', d.x, d.y, d.x, d.y, d.x, d.y]; }\n\n\t                if (!(path[0] in { T: 1, Q: 1 })) {\n\t                    d.qx = null;\n\t                    d.qy = null;\n\t                }\n\n\t                switch (path[0]) {\n\t                    case 'M':\n\t                        d.X = path[1];\n\t                        d.Y = path[2];\n\t                        break;\n\n\t                    case 'A':\n\t                        if (parseFloat(path[1]) === 0 || parseFloat(path[2]) === 0) {\n\t                            // https://www.w3.org/TR/SVG/paths.html#ArcOutOfRangeParameters\n\t                            // \"If either rx or ry is 0, then this arc is treated as a\n\t                            // straight line segment (a \"lineto\") joining the endpoints.\"\n\t                            path = ['L', path[6], path[7]];\n\t                        } else {\n\t                            path = ['C'].concat(a2c.apply(0, [d.x, d.y].concat(path.slice(1))));\n\t                        }\n\t                        break;\n\n\t                    case 'S':\n\t                        if (pcom === 'C' || pcom === 'S') { // In 'S' case we have to take into account, if the previous command is C/S.\n\t                            nx = (d.x * 2) - d.bx;          // And reflect the previous\n\t                            ny = (d.y * 2) - d.by;          // command's control point relative to the current point.\n\t                        } else {                            // or some else or nothing\n\t                            nx = d.x;\n\t                            ny = d.y;\n\t                        }\n\t                        path = ['C', nx, ny].concat(path.slice(1));\n\t                        break;\n\n\t                    case 'T':\n\t                        if (pcom === 'Q' || pcom === 'T') { // In 'T' case we have to take into account, if the previous command is Q/T.\n\t                            d.qx = (d.x * 2) - d.qx;        // And make a reflection similar\n\t                            d.qy = (d.y * 2) - d.qy;        // to case 'S'.\n\t                        } else {                            // or something else or nothing\n\t                            d.qx = d.x;\n\t                            d.qy = d.y;\n\t                        }\n\t                        path = ['C'].concat(q2c(d.x, d.y, d.qx, d.qy, path[1], path[2]));\n\t                        break;\n\n\t                    case 'Q':\n\t                        d.qx = path[1];\n\t                        d.qy = path[2];\n\t                        path = ['C'].concat(q2c(d.x, d.y, path[1], path[2], path[3], path[4]));\n\t                        break;\n\n\t                    case 'H':\n\t                        path = ['L'].concat(path[1], d.y);\n\t                        break;\n\n\t                    case 'V':\n\t                        path = ['L'].concat(d.x, path[1]);\n\t                        break;\n\n\t                    case 'L':\n\t                        break;\n\n\t                    case 'Z':\n\t                        break;\n\t                }\n\n\t                return path;\n\t            }\n\n\t            function fixArc(pp, i) {\n\n\t                if (pp[i].length > 7) {\n\n\t                    pp[i].shift();\n\t                    var pi = pp[i];\n\n\t                    while (pi.length) {\n\t                        pcoms[i] = 'A'; // if created multiple 'C's, their original seg is saved\n\t                        pp.splice(i++, 0, ['C'].concat(pi.splice(0, 6)));\n\t                    }\n\n\t                    pp.splice(i, 1);\n\t                    ii = p.length;\n\t                }\n\t            }\n\n\t            var pcoms = []; // path commands of original path p\n\t            var pfirst = ''; // temporary holder for original path command\n\t            var pcom = ''; // holder for previous path command of original path\n\n\t            var ii = p.length;\n\t            for (var i = 0; i < ii; i++) {\n\t                if (p[i]) { pfirst = p[i][0]; } // save current path command\n\n\t                if (pfirst !== 'C') { // C is not saved yet, because it may be result of conversion\n\t                    pcoms[i] = pfirst; // Save current path command\n\t                    if (i > 0) { pcom = pcoms[i - 1]; } // Get previous path command pcom\n\t                }\n\n\t                p[i] = processPath(p[i], attrs, pcom); // Previous path command is inputted to processPath\n\n\t                if (pcoms[i] !== 'A' && pfirst === 'C') { pcoms[i] = 'C'; } // 'A' is the only command\n\t                // which may produce multiple 'C's\n\t                // so we have to make sure that 'C' is also 'C' in original path\n\n\t                fixArc(p, i); // fixArc adds also the right amount of 'A's to pcoms\n\n\t                var seg = p[i];\n\t                var seglen = seg.length;\n\n\t                attrs.x = seg[seglen - 2];\n\t                attrs.y = seg[seglen - 1];\n\n\t                attrs.bx = parseFloat(seg[seglen - 4]) || attrs.x;\n\t                attrs.by = parseFloat(seg[seglen - 3]) || attrs.y;\n\t            }\n\n\t            // make sure normalized path data string starts with an M segment\n\t            if (!p[0][0] || p[0][0] !== 'M') {\n\t                p.unshift(['M', 0, 0]);\n\t            }\n\n\t            return p;\n\t        }\n\n\t        return function(pathData) {\n\t            return normalize(pathData).join(',').split(',').join(' ');\n\t        };\n\t    })();\n\n\t    V.namespace = ns;\n\n\t    V.g = g;\n\n\t    return V;\n\n\t})();\n\n\tvar config = {\n\t    // When set to `true` the cell selectors could be defined as CSS selectors.\n\t    // If not, only JSON Markup selectors are taken into account.\n\t    // export let useCSSSelectors = true;\n\t    useCSSSelectors: true,\n\t    // The class name prefix config is for advanced use only.\n\t    // Be aware that if you change the prefix, the JointJS CSS will no longer function properly.\n\t    // export let classNamePrefix = 'joint-';\n\t    // export let defaultTheme = 'default';\n\t    classNamePrefix: 'joint-',\n\t    defaultTheme: 'default',\n\t    // The maximum delay required for two consecutive touchend events to be interpreted\n\t    // as a double-tap.\n\t    doubleTapInterval: 300\n\t};\n\n\tvar addClassNamePrefix = function(className) {\n\n\t    if (!className) { return className; }\n\n\t    return className.toString().split(' ').map(function(_className) {\n\n\t        if (_className.substr(0, config.classNamePrefix.length) !== config.classNamePrefix) {\n\t            _className = config.classNamePrefix + _className;\n\t        }\n\n\t        return _className;\n\n\t    }).join(' ');\n\t};\n\n\tvar removeClassNamePrefix = function(className) {\n\n\t    if (!className) { return className; }\n\n\t    return className.toString().split(' ').map(function(_className) {\n\n\t        if (_className.substr(0, config.classNamePrefix.length) === config.classNamePrefix) {\n\t            _className = _className.substr(config.classNamePrefix.length);\n\t        }\n\n\t        return _className;\n\n\t    }).join(' ');\n\t};\n\n\tvar parseDOMJSON = function(json, namespace) {\n\n\t    var selectors = {};\n\t    var groupSelectors = {};\n\t    var svgNamespace = V.namespace.svg;\n\n\t    var ns = namespace || svgNamespace;\n\t    var fragment = document.createDocumentFragment();\n\t    var queue = [json, fragment, ns];\n\t    while (queue.length > 0) {\n\t        ns = queue.pop();\n\t        var parentNode = queue.pop();\n\t        var siblingsDef = queue.pop();\n\t        for (var i = 0, n = siblingsDef.length; i < n; i++) {\n\t            var nodeDef = siblingsDef[i];\n\t            // TagName\n\t            if (!nodeDef.hasOwnProperty('tagName')) { throw new Error('json-dom-parser: missing tagName'); }\n\t            var tagName = nodeDef.tagName;\n\t            // Namespace URI\n\t            if (nodeDef.hasOwnProperty('namespaceURI')) { ns = nodeDef.namespaceURI; }\n\t            var node = document.createElementNS(ns, tagName);\n\t            var svg = (ns === svgNamespace);\n\n\t            var wrapper = (svg) ? V : $;\n\t            // Attributes\n\t            var attributes = nodeDef.attributes;\n\t            if (attributes) { wrapper(node).attr(attributes); }\n\t            // Style\n\t            var style = nodeDef.style;\n\t            if (style) { $(node).css(style); }\n\t            // ClassName\n\t            if (nodeDef.hasOwnProperty('className')) {\n\t                var className = nodeDef.className;\n\t                if (svg) {\n\t                    node.className.baseVal = className;\n\t                } else {\n\t                    node.className = className;\n\t                }\n\t            }\n\t            // TextContent\n\t            if (nodeDef.hasOwnProperty('textContent')) {\n\t                node.textContent = nodeDef.textContent;\n\t            }\n\t            // Selector\n\t            if (nodeDef.hasOwnProperty('selector')) {\n\t                var nodeSelector = nodeDef.selector;\n\t                if (selectors[nodeSelector]) { throw new Error('json-dom-parser: selector must be unique'); }\n\t                selectors[nodeSelector] = node;\n\t                wrapper(node).attr('joint-selector', nodeSelector);\n\t            }\n\t            // Groups\n\t            if (nodeDef.hasOwnProperty('groupSelector')) {\n\t                var nodeGroups = nodeDef.groupSelector;\n\t                if (!Array.isArray(nodeGroups)) { nodeGroups = [nodeGroups]; }\n\t                for (var j = 0, m = nodeGroups.length; j < m; j++) {\n\t                    var nodeGroup = nodeGroups[j];\n\t                    var group = groupSelectors[nodeGroup];\n\t                    if (!group) { group = groupSelectors[nodeGroup] = []; }\n\t                    group.push(node);\n\t                }\n\t            }\n\t            parentNode.appendChild(node);\n\t            // Children\n\t            var childrenDef = nodeDef.children;\n\t            if (Array.isArray(childrenDef)) { queue.push(childrenDef, node, ns); }\n\t        }\n\t    }\n\t    return {\n\t        fragment: fragment,\n\t        selectors: selectors,\n\t        groupSelectors: groupSelectors\n\t    };\n\t};\n\n\t// Return a simple hash code from a string. See http://werxltd.com/wp/2010/05/13/javascript-implementation-of-javas-string-hashcode-method/.\n\tvar hashCode = function(str) {\n\n\t    var hash = 0;\n\t    if (str.length === 0) { return hash; }\n\t    for (var i = 0; i < str.length; i++) {\n\t        var c = str.charCodeAt(i);\n\t        hash = ((hash << 5) - hash) + c;\n\t        hash = hash & hash; // Convert to 32bit integer\n\t    }\n\t    return hash;\n\t};\n\n\tvar getByPath = function(obj, path, delimiter) {\n\n\t    var keys = Array.isArray(path) ? path : path.split(delimiter || '/');\n\t    var key;\n\t    var i = 0;\n\t    var length = keys.length;\n\t    while (i < length) {\n\t        key = keys[i++];\n\t        if (Object(obj) === obj && key in obj) {\n\t            obj = obj[key];\n\t        } else {\n\t            return undefined;\n\t        }\n\t    }\n\t    return obj;\n\t};\n\n\tvar isGetSafe = function(obj, key) {\n\t    // Prevent prototype pollution\n\t    // https://snyk.io/vuln/SNYK-JS-JSON8MERGEPATCH-1038399\n\t    if (typeof key !== 'string' && typeof key !== 'number') {\n\t        key = String(key);\n\t    }\n\t    if (key === 'constructor' && typeof obj[key] === 'function') {\n\t        return false;\n\t    }\n\t    if (key === '__proto__') {\n\t        return false;\n\t    }\n\t    return true;\n\t};\n\n\tvar setByPath = function(obj, path, value, delimiter) {\n\n\t    var keys = Array.isArray(path) ? path : path.split(delimiter || '/');\n\t    var last = keys.length - 1;\n\t    var diver = obj;\n\t    var i = 0;\n\n\t    for (; i < last; i++) {\n\t        var key = keys[i];\n\t        if (!isGetSafe(diver, key)) { return obj; }\n\t        var value$1 = diver[key];\n\t        // diver creates an empty object if there is no nested object under such a key.\n\t        // This means that one can populate an empty nested object with setByPath().\n\t        diver = value$1 || (diver[key] = {});\n\t    }\n\n\t    diver[keys[last]] = value;\n\n\t    return obj;\n\t};\n\n\tvar unsetByPath = function(obj, path, delimiter) {\n\n\t    var keys = Array.isArray(path) ? path : path.split(delimiter || '/');\n\t    var last = keys.length - 1;\n\t    var diver = obj;\n\t    var i = 0;\n\n\t    for (; i < last; i++) {\n\t        var key = keys[i];\n\t        if (!isGetSafe(diver, key)) { return obj; }\n\t        var value = diver[key];\n\t        if (!value) { return obj; }\n\t        diver = value;\n\t    }\n\n\t    delete diver[keys[last]];\n\n\t    return obj;\n\t};\n\n\tvar flattenObject = function(obj, delim, stop) {\n\n\t    delim = delim || '/';\n\t    var ret = {};\n\n\t    for (var key in obj) {\n\n\t        if (!obj.hasOwnProperty(key)) { continue; }\n\n\t        var shouldGoDeeper = typeof obj[key] === 'object';\n\t        if (shouldGoDeeper && stop && stop(obj[key])) {\n\t            shouldGoDeeper = false;\n\t        }\n\n\t        if (shouldGoDeeper) {\n\n\t            var flatObject = flattenObject(obj[key], delim, stop);\n\n\t            for (var flatKey in flatObject) {\n\t                if (!flatObject.hasOwnProperty(flatKey)) { continue; }\n\t                ret[key + delim + flatKey] = flatObject[flatKey];\n\t            }\n\n\t        } else {\n\n\t            ret[key] = obj[key];\n\t        }\n\t    }\n\n\t    return ret;\n\t};\n\n\tvar uuid = function() {\n\n\t    // credit: http://stackoverflow.com/posts/2117523/revisions\n\n\t    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t        var r = (Math.random() * 16) | 0;\n\t        var v = (c === 'x') ? r : (r & 0x3 | 0x8);\n\t        return v.toString(16);\n\t    });\n\t};\n\n\t// Generate global unique id for obj and store it as a property of the object.\n\tvar guid = function(obj) {\n\n\t    guid.id = guid.id || 1;\n\t    obj.id = (obj.id === undefined ? 'j_' + guid.id++ : obj.id);\n\t    return obj.id;\n\t};\n\n\tvar toKebabCase = function(string) {\n\n\t    return string.replace(/[A-Z]/g, '-$&').toLowerCase();\n\t};\n\n\tvar normalizeEvent = function(evt) {\n\n\t    var normalizedEvent = evt;\n\t    var touchEvt = evt.originalEvent && evt.originalEvent.changedTouches && evt.originalEvent.changedTouches[0];\n\t    if (touchEvt) {\n\t        for (var property in evt) {\n\t            // copy all the properties from the input event that are not\n\t            // defined on the touch event (functions included).\n\t            if (touchEvt[property] === undefined) {\n\t                touchEvt[property] = evt[property];\n\t            }\n\t        }\n\t        normalizedEvent = touchEvt;\n\t    }\n\n\t    // IE: evt.target could be set to SVGElementInstance for SVGUseElement\n\t    var target = normalizedEvent.target;\n\t    if (target) {\n\t        var useElement = target.correspondingUseElement;\n\t        if (useElement) { normalizedEvent.target = useElement; }\n\t    }\n\n\t    return normalizedEvent;\n\t};\n\n\tvar nextFrame = (function() {\n\n\t    var raf;\n\n\t    if (typeof window !== 'undefined') {\n\n\t        raf = window.requestAnimationFrame ||\n\t            window.webkitRequestAnimationFrame ||\n\t            window.mozRequestAnimationFrame ||\n\t            window.oRequestAnimationFrame ||\n\t            window.msRequestAnimationFrame;\n\t    }\n\n\t    if (!raf) {\n\n\t        var lastTime = 0;\n\n\t        raf = function(callback) {\n\n\t            var currTime = new Date().getTime();\n\t            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t            var id = setTimeout(function() {\n\t                callback(currTime + timeToCall);\n\t            }, timeToCall);\n\n\t            lastTime = currTime + timeToCall;\n\n\t            return id;\n\t        };\n\t    }\n\n\t    return function(callback, context) {\n\t        var rest = [], len = arguments.length - 2;\n\t        while ( len-- > 0 ) rest[ len ] = arguments[ len + 2 ];\n\n\t        return (context !== undefined)\n\t            ? raf(callback.bind.apply(callback, [ context ].concat( rest )))\n\t            : raf(callback);\n\t    };\n\n\t})();\n\n\tvar cancelFrame = (function() {\n\n\t    var caf;\n\t    var client = typeof window != 'undefined';\n\n\t    if (client) {\n\n\t        caf = window.cancelAnimationFrame ||\n\t            window.webkitCancelAnimationFrame ||\n\t            window.webkitCancelRequestAnimationFrame ||\n\t            window.msCancelAnimationFrame ||\n\t            window.msCancelRequestAnimationFrame ||\n\t            window.oCancelAnimationFrame ||\n\t            window.oCancelRequestAnimationFrame ||\n\t            window.mozCancelAnimationFrame ||\n\t            window.mozCancelRequestAnimationFrame;\n\t    }\n\n\t    caf = caf || clearTimeout;\n\n\t    return client ? caf.bind(window) : caf;\n\n\t})();\n\n\t/**\n\t * @deprecated\n\t */\n\tvar shapePerimeterConnectionPoint = function(linkView, view, magnet, reference) {\n\n\t    var bbox;\n\t    var spot;\n\n\t    if (!magnet) {\n\n\t        // There is no magnet, try to make the best guess what is the\n\t        // wrapping SVG element. This is because we want this \"smart\"\n\t        // connection points to work out of the box without the\n\t        // programmer to put magnet marks to any of the subelements.\n\t        // For example, we want the function to work on basic.Path elements\n\t        // without any special treatment of such elements.\n\t        // The code below guesses the wrapping element based on\n\t        // one simple assumption. The wrapping elemnet is the\n\t        // first child of the scalable group if such a group exists\n\t        // or the first child of the rotatable group if not.\n\t        // This makese sense because usually the wrapping element\n\t        // is below any other sub element in the shapes.\n\t        var scalable = view.$('.scalable')[0];\n\t        var rotatable = view.$('.rotatable')[0];\n\n\t        if (scalable && scalable.firstChild) {\n\n\t            magnet = scalable.firstChild;\n\n\t        } else if (rotatable && rotatable.firstChild) {\n\n\t            magnet = rotatable.firstChild;\n\t        }\n\t    }\n\n\t    if (magnet) {\n\n\t        spot = V(magnet).findIntersection(reference, linkView.paper.cells);\n\t        if (!spot) {\n\t            bbox = V(magnet).getBBox({ target: linkView.paper.cells });\n\t        }\n\n\t    } else {\n\n\t        bbox = view.model.getBBox();\n\t        spot = bbox.intersectionWithLineFromCenterToPoint(reference);\n\t    }\n\t    return spot || bbox.center();\n\t};\n\n\tvar isPercentage = function(val) {\n\n\t    return isString(val) && val.slice(-1) === '%';\n\t};\n\n\tvar parseCssNumeric = function(val, restrictUnits) {\n\n\t    function getUnit(validUnitExp) {\n\n\t        // one or more numbers, followed by\n\t        // any number of (\n\t        //  `.`, followed by\n\t        //  one or more numbers\n\t        // ), followed by\n\t        // `validUnitExp`, followed by\n\t        // end of string\n\t        var matches = new RegExp('(?:\\\\d+(?:\\\\.\\\\d+)*)(' + validUnitExp + ')$').exec(val);\n\n\t        if (!matches) { return null; }\n\t        return matches[1];\n\t    }\n\n\t    var number = parseFloat(val);\n\n\t    // if `val` cannot be parsed as a number, return `null`\n\t    if (Number.isNaN(number)) { return null; }\n\n\t    // else: we know `output.value`\n\t    var output = {};\n\t    output.value = number;\n\n\t    // determine the unit\n\t    var validUnitExp;\n\t    if (restrictUnits == null) {\n\t        // no restriction\n\t        // accept any unit, as well as no unit\n\t        validUnitExp = '[A-Za-z]*';\n\n\t    } else if (Array.isArray(restrictUnits)) {\n\t        // if this is an empty array, top restriction - return `null`\n\t        if (restrictUnits.length === 0) { return null; }\n\n\t        // else: restriction - an array of valid unit strings\n\t        validUnitExp = restrictUnits.join('|');\n\n\t    } else if (isString(restrictUnits)) {\n\t        // restriction - a single valid unit string\n\t        validUnitExp = restrictUnits;\n\t    }\n\t    var unit = getUnit(validUnitExp);\n\n\t    // if we found no matches for `restrictUnits`, return `null`\n\t    if (unit === null) { return null; }\n\n\t    // else: we know the unit\n\t    output.unit = unit;\n\t    return output;\n\t};\n\n\tvar breakText = function(text, size, styles, opt) {\n\t    if ( styles === void 0 ) styles = {};\n\t    if ( opt === void 0 ) opt = {};\n\n\n\t    var width = size.width;\n\t    var height = size.height;\n\n\t    var svgDocument = opt.svgDocument || V('svg').node;\n\t    var textSpan = V('tspan').node;\n\t    var textElement = V('text').attr(styles).append(textSpan).node;\n\t    var textNode = document.createTextNode('');\n\n\t    // Prevent flickering\n\t    textElement.style.opacity = 0;\n\t    // Prevent FF from throwing an uncaught exception when `getBBox()`\n\t    // called on element that is not in the render tree (is not measurable).\n\t    // <tspan>.getComputedTextLength() returns always 0 in this case.\n\t    // Note that the `textElement` resp. `textSpan` can become hidden\n\t    // when it's appended to the DOM and a `display: none` CSS stylesheet\n\t    // rule gets applied.\n\t    textElement.style.display = 'block';\n\t    textSpan.style.display = 'block';\n\n\t    textSpan.appendChild(textNode);\n\t    svgDocument.appendChild(textElement); // lgtm [js/xss-through-dom]\n\n\t    if (!opt.svgDocument) {\n\n\t        document.body.appendChild(svgDocument);\n\t    }\n\n\t    var separator = opt.separator || ' ';\n\t    var eol = opt.eol || '\\n';\n\t    var hyphen = opt.hyphen ? new RegExp(opt.hyphen) : /[^\\w\\d]/;\n\t    var maxLineCount = opt.maxLineCount;\n\t    if (!isNumber(maxLineCount)) { maxLineCount = Infinity; }\n\n\t    var words = text.split(separator);\n\t    var full = [];\n\t    var lines = [];\n\t    var p, h;\n\t    var lineHeight;\n\n\t    for (var i = 0, l = 0, len = words.length; i < len; i++) {\n\n\t        var word = words[i];\n\n\t        if (!word) { continue; }\n\n\t        var isEol = false;\n\t        if (eol && word.indexOf(eol) >= 0) {\n\t            // word contains end-of-line character\n\t            if (word.length > 1) {\n\t                // separate word and continue cycle\n\t                var eolWords = word.split(eol);\n\t                for (var j = 0, jl = eolWords.length - 1; j < jl; j++) {\n\t                    eolWords.splice(2 * j + 1, 0, eol);\n\t                }\n\t                words.splice.apply(words, [ i, 1 ].concat( eolWords.filter(function (word) { return word !== ''; }) ));\n\t                i--;\n\t                len = words.length;\n\t                continue;\n\t            } else {\n\t                // creates a new line\n\t                lines[++l] = '';\n\t                isEol = true;\n\t            }\n\t        }\n\n\t        if (!isEol) {\n\t            textNode.data = lines[l] ? lines[l] + ' ' + word : word;\n\n\t            if (textSpan.getComputedTextLength() <= width) {\n\n\t                // the current line fits\n\t                lines[l] = textNode.data;\n\n\t                if (p || h) {\n\t                // We were partitioning. Put rest of the word onto next line\n\t                    full[l++] = true;\n\n\t                    // cancel partitioning and splitting by hyphens\n\t                    p = 0;\n\t                    h = 0;\n\t                }\n\n\t            } else {\n\n\t                if (!lines[l] || p) {\n\n\t                    var partition = !!p;\n\n\t                    p = word.length - 1;\n\n\t                    if (partition || !p) {\n\n\t                        // word has only one character.\n\t                        if (!p) {\n\n\t                            if (!lines[l]) {\n\n\t                                // we won't fit this text within our rect\n\t                                lines = [];\n\n\t                                break;\n\t                            }\n\n\t                            // partitioning didn't help on the non-empty line\n\t                            // try again, but this time start with a new line\n\n\t                            // cancel partitions created\n\t                            words.splice(i, 2, word + words[i + 1]);\n\n\t                            // adjust word length\n\t                            len--;\n\n\t                            full[l++] = true;\n\t                            i--;\n\n\t                            continue;\n\t                        }\n\n\t                        // move last letter to the beginning of the next word\n\t                        words[i] = word.substring(0, p);\n\t                        words[i + 1] = word.substring(p) + (words[i + 1] === undefined ? '' : words[i + 1]);\n\n\t                    } else {\n\n\t                        if (h) {\n\t                        // cancel splitting and put the words together again\n\t                            words.splice(i, 2, words[i] + words[i + 1]);\n\t                            h = 0;\n\t                        } else {\n\t                            var hyphenIndex = word.search(hyphen);\n\t                            if (hyphenIndex > -1 && hyphenIndex !== word.length - 1 && hyphenIndex !== 0) {\n\t                                h = hyphenIndex + 1;\n\t                                p = 0;\n\t                            }\n\n\t                            // We initiate partitioning or splitting\n\t                            // split the long word into two words\n\t                            words.splice(i, 1, word.substring(0, h || p), word.substring(h|| p));\n\t                            // adjust words length\n\t                            len++;\n\n\t                        }\n\n\t                        if (l && !full[l - 1]) {\n\t                        // if the previous line is not full, try to fit max part of\n\t                        // the current word there\n\t                            l--;\n\t                        }\n\t                    }\n\n\t                    i--;\n\n\t                    continue;\n\t                }\n\n\t                l++;\n\t                i--;\n\t            }\n\t        }\n\t        var lastL = null;\n\n\t        if (lines.length > maxLineCount) {\n\n\t            lastL = maxLineCount - 1;\n\n\t        } else if (height !== undefined) {\n\n\t            // if size.height is defined we have to check whether the height of the entire\n\t            // text exceeds the rect height\n\n\t            if (lineHeight === undefined) {\n\n\t                var heightValue;\n\n\t                // use the same defaults as in V.prototype.text\n\t                if (styles.lineHeight === 'auto') {\n\t                    heightValue = { value: 1.5, unit: 'em' };\n\t                } else {\n\t                    heightValue = parseCssNumeric(styles.lineHeight, ['em']) || { value: 1, unit: 'em' };\n\t                }\n\n\t                lineHeight = heightValue.value;\n\t                if (heightValue.unit === 'em') {\n\t                    lineHeight *= textElement.getBBox().height;\n\t                }\n\t            }\n\n\t            if (lineHeight * lines.length > height) {\n\n\t                // remove overflowing lines\n\t                lastL = Math.floor(height / lineHeight) - 1;\n\t            }\n\t        }\n\n\t        if (lastL !== null) {\n\n\t            lines.splice(lastL + 1);\n\n\t            // add ellipsis\n\t            var ellipsis = opt.ellipsis;\n\t            if (!ellipsis || lastL < 0) { break; }\n\t            if (typeof ellipsis !== 'string') { ellipsis = '\\u2026'; }\n\n\t            var lastLine = lines[lastL];\n\t            if (!lastLine && !isEol) { break; }\n\t            var k = lastLine.length;\n\t            var lastLineWithOmission, lastChar, separatorChar;\n\t            do {\n\t                lastChar = lastLine[k];\n\t                lastLineWithOmission = lastLine.substring(0, k);\n\t                if (!lastChar) {\n\t                    separatorChar = (typeof separator === 'string') ? separator : ' ';\n\t                    lastLineWithOmission += separatorChar;\n\t                } else if (lastChar.match(separator)) {\n\t                    lastLineWithOmission += lastChar;\n\t                }\n\t                lastLineWithOmission += ellipsis;\n\t                textNode.data = lastLineWithOmission;\n\t                if (textSpan.getComputedTextLength() <= width) {\n\t                    lines[lastL] = lastLineWithOmission;\n\t                    break;\n\t                }\n\t                k--;\n\t            } while (k >= 0);\n\t            break;\n\t        }\n\t    }\n\n\t    if (opt.svgDocument) {\n\n\t        // svg document was provided, remove the text element only\n\t        svgDocument.removeChild(textElement);\n\n\t    } else {\n\n\t        // clean svg document\n\t        document.body.removeChild(svgDocument);\n\t    }\n\n\t    return lines.join(eol);\n\t};\n\n\t// Sanitize HTML\n\t// Based on https://gist.github.com/ufologist/5a0da51b2b9ef1b861c30254172ac3c9\n\t// Parses a string into an array of DOM nodes.\n\t// Then outputs it back as a string.\n\tvar sanitizeHTML = function(html) {\n\n\t    // Ignores tags that are invalid inside a <div> tag (e.g. <body>, <head>)\n\n\t    // If documentContext (second parameter) is not specified or given as `null` or `undefined`, a new document is used.\n\t    // Inline events will not execute when the HTML is parsed; this includes, for example, sending GET requests for images.\n\n\t    // If keepScripts (last parameter) is `false`, scripts are not executed.\n\t    var output = $($.parseHTML('<div>' + html + '</div>', null, false));\n\n\t    output.find('*').each(function() { // for all nodes\n\t        var currentNode = this;\n\n\t        $.each(currentNode.attributes, function() { // for all attributes in each node\n\t            var currentAttribute = this;\n\n\t            var attrName = currentAttribute.name;\n\t            var attrValue = currentAttribute.value;\n\n\t            // Remove attribute names that start with \"on\" (e.g. onload, onerror...).\n\t            // Remove attribute values that start with \"javascript:\" pseudo protocol (e.g. `href=\"javascript:alert(1)\"`).\n\t            if (attrName.startsWith('on') || attrValue.startsWith('javascript:') || attrValue.startsWith('data:') || attrValue.startsWith('vbscript:')) {\n\t                $(currentNode).removeAttr(attrName);\n\t            }\n\t        });\n\t    });\n\n\t    return output.html();\n\t};\n\n\t// Download `blob` as file with `fileName`.\n\t// Does not work in IE9.\n\tvar downloadBlob = function(blob, fileName) {\n\n\t    if (window.navigator.msSaveBlob) { // requires IE 10+\n\t        // pulls up a save dialog\n\t        window.navigator.msSaveBlob(blob, fileName);\n\n\t    } else { // other browsers\n\t        // downloads directly in Chrome and Safari\n\n\t        // presents a save/open dialog in Firefox\n\t        // Firefox bug: `from` field in save dialog always shows `from:blob:`\n\t        // https://bugzilla.mozilla.org/show_bug.cgi?id=1053327\n\n\t        var url = window.URL.createObjectURL(blob);\n\t        var link = document.createElement('a');\n\n\t        link.href = url;\n\t        link.download = fileName;\n\t        document.body.appendChild(link);\n\n\t        link.click();\n\n\t        document.body.removeChild(link);\n\t        window.URL.revokeObjectURL(url); // mark the url for garbage collection\n\t    }\n\t};\n\n\t// Download `dataUri` as file with `fileName`.\n\t// Does not work in IE9.\n\tvar downloadDataUri = function(dataUri, fileName) {\n\n\t    var blob = dataUriToBlob(dataUri);\n\t    downloadBlob(blob, fileName);\n\t};\n\n\t// Convert an uri-encoded data component (possibly also base64-encoded) to a blob.\n\tvar dataUriToBlob = function(dataUri) {\n\n\t    // first, make sure there are no newlines in the data uri\n\t    dataUri = dataUri.replace(/\\s/g, '');\n\t    dataUri = decodeURIComponent(dataUri);\n\n\t    var firstCommaIndex = dataUri.indexOf(','); // split dataUri as `dataTypeString`,`data`\n\n\t    var dataTypeString = dataUri.slice(0, firstCommaIndex); // e.g. 'data:image/jpeg;base64'\n\t    var mimeString = dataTypeString.split(':')[1].split(';')[0]; // e.g. 'image/jpeg'\n\n\t    var data = dataUri.slice(firstCommaIndex + 1);\n\t    var decodedString;\n\t    if (dataTypeString.indexOf('base64') >= 0) { // data may be encoded in base64\n\t        decodedString = atob(data); // decode data\n\t    } else {\n\t        // convert the decoded string to UTF-8\n\t        decodedString = unescape(encodeURIComponent(data));\n\t    }\n\t    // write the bytes of the string to a typed array\n\t    var ia = new Uint8Array(decodedString.length);\n\t    for (var i = 0; i < decodedString.length; i++) {\n\t        ia[i] = decodedString.charCodeAt(i);\n\t    }\n\n\t    return new Blob([ia], { type: mimeString }); // return the typed array as Blob\n\t};\n\n\t// Read an image at `url` and return it as base64-encoded data uri.\n\t// The mime type of the image is inferred from the `url` file extension.\n\t// If data uri is provided as `url`, it is returned back unchanged.\n\t// `callback` is a method with `err` as first argument and `dataUri` as second argument.\n\t// Works with IE9.\n\tvar imageToDataUri = function(url, callback) {\n\n\t    if (!url || url.substr(0, 'data:'.length) === 'data:') {\n\t        // No need to convert to data uri if it is already in data uri.\n\n\t        // This not only convenient but desired. For example,\n\t        // IE throws a security error if data:image/svg+xml is used to render\n\t        // an image to the canvas and an attempt is made to read out data uri.\n\t        // Now if our image is already in data uri, there is no need to render it to the canvas\n\t        // and so we can bypass this error.\n\n\t        // Keep the async nature of the function.\n\t        return setTimeout(function() {\n\t            callback(null, url);\n\t        }, 0);\n\t    }\n\n\t    // chrome, IE10+\n\t    var modernHandler = function(xhr, callback) {\n\n\t        if (xhr.status === 200) {\n\n\t            var reader = new FileReader();\n\n\t            reader.onload = function(evt) {\n\t                var dataUri = evt.target.result;\n\t                callback(null, dataUri);\n\t            };\n\n\t            reader.onerror = function() {\n\t                callback(new Error('Failed to load image ' + url));\n\t            };\n\n\t            reader.readAsDataURL(xhr.response);\n\t        } else {\n\t            callback(new Error('Failed to load image ' + url));\n\t        }\n\t    };\n\n\t    var legacyHandler = function(xhr, callback) {\n\n\t        var Uint8ToString = function(u8a) {\n\t            var CHUNK_SZ = 0x8000;\n\t            var c = [];\n\t            for (var i = 0; i < u8a.length; i += CHUNK_SZ) {\n\t                c.push(String.fromCharCode.apply(null, u8a.subarray(i, i + CHUNK_SZ)));\n\t            }\n\t            return c.join('');\n\t        };\n\n\t        if (xhr.status === 200) {\n\n\t            var bytes = new Uint8Array(xhr.response);\n\n\t            var suffix = (url.split('.').pop()) || 'png';\n\t            var map = {\n\t                'svg': 'svg+xml'\n\t            };\n\t            var meta = 'data:image/' + (map[suffix] || suffix) + ';base64,';\n\t            var b64encoded = meta + btoa(Uint8ToString(bytes));\n\t            callback(null, b64encoded);\n\t        } else {\n\t            callback(new Error('Failed to load image ' + url));\n\t        }\n\t    };\n\n\t    var xhr = new XMLHttpRequest();\n\n\t    xhr.open('GET', url, true);\n\t    xhr.addEventListener('error', function() {\n\t        callback(new Error('Failed to load image ' + url));\n\t    });\n\n\t    xhr.responseType = window.FileReader ? 'blob' : 'arraybuffer';\n\n\t    xhr.addEventListener('load', function() {\n\t        if (window.FileReader) {\n\t            modernHandler(xhr, callback);\n\t        } else {\n\t            legacyHandler(xhr, callback);\n\t        }\n\t    });\n\n\t    xhr.send();\n\t};\n\n\tvar getElementBBox = function(el) {\n\n\t    var $el = $(el);\n\t    if ($el.length === 0) {\n\t        throw new Error('Element not found');\n\t    }\n\n\t    var element = $el[0];\n\t    var doc = element.ownerDocument;\n\t    var clientBBox = element.getBoundingClientRect();\n\n\t    var strokeWidthX = 0;\n\t    var strokeWidthY = 0;\n\n\t    // Firefox correction\n\t    if (element.ownerSVGElement) {\n\n\t        var vel = V(element);\n\t        var bbox = vel.getBBox({ target: vel.svg() });\n\n\t        // if FF getBoundingClientRect includes stroke-width, getBBox doesn't.\n\t        // To unify this across all browsers we need to adjust the final bBox with `stroke-width` value.\n\t        strokeWidthX = (clientBBox.width - bbox.width);\n\t        strokeWidthY = (clientBBox.height - bbox.height);\n\t    }\n\n\t    return {\n\t        x: clientBBox.left + window.pageXOffset - doc.documentElement.offsetLeft + strokeWidthX / 2,\n\t        y: clientBBox.top + window.pageYOffset - doc.documentElement.offsetTop + strokeWidthY / 2,\n\t        width: clientBBox.width - strokeWidthX,\n\t        height: clientBBox.height - strokeWidthY\n\t    };\n\t};\n\n\n\t// Highly inspired by the jquery.sortElements plugin by Padolsey.\n\t// See http://james.padolsey.com/javascript/sorting-elements-with-jquery/.\n\tvar sortElements = function(elements, comparator) {\n\n\t    var $elements = $(elements);\n\t    var placements = $elements.map(function() {\n\n\t        var sortElement = this;\n\t        var parentNode = sortElement.parentNode;\n\t        // Since the element itself will change position, we have\n\t        // to have some way of storing it's original position in\n\t        // the DOM. The easiest way is to have a 'flag' node:\n\t        var nextSibling = parentNode.insertBefore(document.createTextNode(''), sortElement.nextSibling);\n\n\t        return function() {\n\n\t            if (parentNode === this) {\n\t                throw new Error('You can\\'t sort elements if any one is a descendant of another.');\n\t            }\n\n\t            // Insert before flag:\n\t            parentNode.insertBefore(this, nextSibling);\n\t            // Remove flag:\n\t            parentNode.removeChild(nextSibling);\n\t        };\n\t    });\n\n\t    return Array.prototype.sort.call($elements, comparator).each(function(i) {\n\t        placements[i].call(this);\n\t    });\n\t};\n\n\t// Sets attributes on the given element and its descendants based on the selector.\n\t// `attrs` object: { [SELECTOR1]: { attrs1 }, [SELECTOR2]: { attrs2}, ... } e.g. { 'input': { color : 'red' }}\n\tvar setAttributesBySelector = function(element, attrs) {\n\n\t    var $element = $(element);\n\n\t    forIn(attrs, function(attrs, selector) {\n\t        var $elements = $element.find(selector).addBack().filter(selector);\n\t        // Make a special case for setting classes.\n\t        // We do not want to overwrite any existing class.\n\t        if (has$2(attrs, 'class')) {\n\t            $elements.addClass(attrs['class']);\n\t            attrs = omit(attrs, 'class');\n\t        }\n\t        $elements.attr(attrs);\n\t    });\n\t};\n\n\t// Return a new object with all four sides (top, right, bottom, left) in it.\n\t// Value of each side is taken from the given argument (either number or object).\n\t// Default value for a side is 0.\n\t// Examples:\n\t// normalizeSides(5) --> { top: 5, right: 5, bottom: 5, left: 5 }\n\t// normalizeSides({ horizontal: 5 }) --> { top: 0, right: 5, bottom: 0, left: 5 }\n\t// normalizeSides({ left: 5 }) --> { top: 0, right: 0, bottom: 0, left: 5 }\n\t// normalizeSides({ horizontal: 10, left: 5 }) --> { top: 0, right: 10, bottom: 0, left: 5 }\n\t// normalizeSides({ horizontal: 0, left: 5 }) --> { top: 0, right: 0, bottom: 0, left: 5 }\n\tvar normalizeSides = function(box) {\n\n\t    if (Object(box) !== box) { // `box` is not an object\n\t        var val = 0; // `val` left as 0 if `box` cannot be understood as finite number\n\t        if (isFinite(box)) { val = +box; } // actually also accepts string numbers (e.g. '100')\n\n\t        return { top: val, right: val, bottom: val, left: val };\n\t    }\n\n\t    // `box` is an object\n\t    var top, right, bottom, left;\n\t    top = right = bottom = left = 0;\n\n\t    if (isFinite(box.vertical)) { top = bottom = +box.vertical; }\n\t    if (isFinite(box.horizontal)) { right = left = +box.horizontal; }\n\n\t    if (isFinite(box.top)) { top = +box.top; } // overwrite vertical\n\t    if (isFinite(box.right)) { right = +box.right; } // overwrite horizontal\n\t    if (isFinite(box.bottom)) { bottom = +box.bottom; } // overwrite vertical\n\t    if (isFinite(box.left)) { left = +box.left; } // overwrite horizontal\n\n\t    return { top: top, right: right, bottom: bottom, left: left };\n\t};\n\n\tvar timing = {\n\n\t    linear: function(t) {\n\t        return t;\n\t    },\n\n\t    quad: function(t) {\n\t        return t * t;\n\t    },\n\n\t    cubic: function(t) {\n\t        return t * t * t;\n\t    },\n\n\t    inout: function(t) {\n\t        if (t <= 0) { return 0; }\n\t        if (t >= 1) { return 1; }\n\t        var t2 = t * t;\n\t        var t3 = t2 * t;\n\t        return 4 * (t < .5 ? t3 : 3 * (t - t2) + t3 - .75);\n\t    },\n\n\t    exponential: function(t) {\n\t        return Math.pow(2, 10 * (t - 1));\n\t    },\n\n\t    bounce: function(t) {\n\t        for (var a = 0, b = 1; 1; a += b, b /= 2) {\n\t            if (t >= (7 - 4 * a) / 11) {\n\t                var q = (11 - 6 * a - 11 * t) / 4;\n\t                return -q * q + b * b;\n\t            }\n\t        }\n\t    },\n\n\t    reverse: function(f) {\n\t        return function(t) {\n\t            return 1 - f(1 - t);\n\t        };\n\t    },\n\n\t    reflect: function(f) {\n\t        return function(t) {\n\t            return .5 * (t < .5 ? f(2 * t) : (2 - f(2 - 2 * t)));\n\t        };\n\t    },\n\n\t    clamp: function(f, n, x) {\n\t        n = n || 0;\n\t        x = x || 1;\n\t        return function(t) {\n\t            var r = f(t);\n\t            return r < n ? n : r > x ? x : r;\n\t        };\n\t    },\n\n\t    back: function(s) {\n\t        if (!s) { s = 1.70158; }\n\t        return function(t) {\n\t            return t * t * ((s + 1) * t - s);\n\t        };\n\t    },\n\n\t    elastic: function(x) {\n\t        if (!x) { x = 1.5; }\n\t        return function(t) {\n\t            return Math.pow(2, 10 * (t - 1)) * Math.cos(20 * Math.PI * x / 3 * t);\n\t        };\n\t    }\n\t};\n\n\tvar interpolate = {\n\n\t    number: function(a, b) {\n\t        var d = b - a;\n\t        return function(t) {\n\t            return a + d * t;\n\t        };\n\t    },\n\n\t    object: function(a, b) {\n\t        var s = Object.keys(a);\n\t        return function(t) {\n\t            var i, p;\n\t            var r = {};\n\t            for (i = s.length - 1; i != -1; i--) {\n\t                p = s[i];\n\t                r[p] = a[p] + (b[p] - a[p]) * t;\n\t            }\n\t            return r;\n\t        };\n\t    },\n\n\t    hexColor: function(a, b) {\n\n\t        var ca = parseInt(a.slice(1), 16);\n\t        var cb = parseInt(b.slice(1), 16);\n\t        var ra = ca & 0x0000ff;\n\t        var rd = (cb & 0x0000ff) - ra;\n\t        var ga = ca & 0x00ff00;\n\t        var gd = (cb & 0x00ff00) - ga;\n\t        var ba = ca & 0xff0000;\n\t        var bd = (cb & 0xff0000) - ba;\n\n\t        return function(t) {\n\n\t            var r = (ra + rd * t) & 0x000000ff;\n\t            var g = (ga + gd * t) & 0x0000ff00;\n\t            var b = (ba + bd * t) & 0x00ff0000;\n\n\t            return '#' + (1 << 24 | r | g | b).toString(16).slice(1);\n\t        };\n\t    },\n\n\t    unit: function(a, b) {\n\n\t        var r = /(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/;\n\t        var ma = r.exec(a);\n\t        var mb = r.exec(b);\n\t        var p = mb[1].indexOf('.');\n\t        var f = p > 0 ? mb[1].length - p - 1 : 0;\n\t        a = +ma[1];\n\t        var d = +mb[1] - a;\n\t        var u = ma[2];\n\n\t        return function(t) {\n\t            return (a + d * t).toFixed(f) + u;\n\t        };\n\t    }\n\t};\n\n\t// SVG filters.\n\t// (values in parentheses are default values)\n\tvar filter = {\n\n\t    // `color` ... outline color ('blue')\n\t    // `width`... outline width (1)\n\t    // `opacity` ... outline opacity (1)\n\t    // `margin` ... gap between outline and the element (2)\n\t    outline: function(args) {\n\n\t        var tpl = '<filter><feFlood flood-color=\"${color}\" flood-opacity=\"${opacity}\" result=\"colored\"/><feMorphology in=\"SourceAlpha\" result=\"morphedOuter\" operator=\"dilate\" radius=\"${outerRadius}\" /><feMorphology in=\"SourceAlpha\" result=\"morphedInner\" operator=\"dilate\" radius=\"${innerRadius}\" /><feComposite result=\"morphedOuterColored\" in=\"colored\" in2=\"morphedOuter\" operator=\"in\"/><feComposite operator=\"xor\" in=\"morphedOuterColored\" in2=\"morphedInner\" result=\"outline\"/><feMerge><feMergeNode in=\"outline\"/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>';\n\n\t        var margin = Number.isFinite(args.margin) ? args.margin : 2;\n\t        var width = Number.isFinite(args.width) ? args.width : 1;\n\n\t        return template(tpl)({\n\t            color: args.color || 'blue',\n\t            opacity: Number.isFinite(args.opacity) ? args.opacity : 1,\n\t            outerRadius: margin + width,\n\t            innerRadius: margin\n\t        });\n\t    },\n\n\t    // `color` ... color ('red')\n\t    // `width`... width (1)\n\t    // `blur` ... blur (0)\n\t    // `opacity` ... opacity (1)\n\t    highlight: function(args) {\n\n\t        var tpl = '<filter><feFlood flood-color=\"${color}\" flood-opacity=\"${opacity}\" result=\"colored\"/><feMorphology result=\"morphed\" in=\"SourceGraphic\" operator=\"dilate\" radius=\"${width}\"/><feComposite result=\"composed\" in=\"colored\" in2=\"morphed\" operator=\"in\"/><feGaussianBlur result=\"blured\" in=\"composed\" stdDeviation=\"${blur}\"/><feBlend in=\"SourceGraphic\" in2=\"blured\" mode=\"normal\"/></filter>';\n\n\t        return template(tpl)({\n\t            color: args.color || 'red',\n\t            width: Number.isFinite(args.width) ? args.width : 1,\n\t            blur: Number.isFinite(args.blur) ? args.blur : 0,\n\t            opacity: Number.isFinite(args.opacity) ? args.opacity : 1\n\t        });\n\t    },\n\n\t    // `x` ... horizontal blur (2)\n\t    // `y` ... vertical blur (optional)\n\t    blur: function(args) {\n\n\t        var x = Number.isFinite(args.x) ? args.x : 2;\n\n\t        return template('<filter><feGaussianBlur stdDeviation=\"${stdDeviation}\"/></filter>')({\n\t            stdDeviation: Number.isFinite(args.y) ? [x, args.y] : x\n\t        });\n\t    },\n\n\t    // `dx` ... horizontal shift (0)\n\t    // `dy` ... vertical shift (0)\n\t    // `blur` ... blur (4)\n\t    // `color` ... color ('black')\n\t    // `opacity` ... opacity (1)\n\t    dropShadow: function(args) {\n\n\t        var tpl = 'SVGFEDropShadowElement' in window\n\t            ? '<filter><feDropShadow stdDeviation=\"${blur}\" dx=\"${dx}\" dy=\"${dy}\" flood-color=\"${color}\" flood-opacity=\"${opacity}\"/></filter>'\n\t            : '<filter><feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"${blur}\"/><feOffset dx=\"${dx}\" dy=\"${dy}\" result=\"offsetblur\"/><feFlood flood-color=\"${color}\"/><feComposite in2=\"offsetblur\" operator=\"in\"/><feComponentTransfer><feFuncA type=\"linear\" slope=\"${opacity}\"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>';\n\n\t        return template(tpl)({\n\t            dx: args.dx || 0,\n\t            dy: args.dy || 0,\n\t            opacity: Number.isFinite(args.opacity) ? args.opacity : 1,\n\t            color: args.color || 'black',\n\t            blur: Number.isFinite(args.blur) ? args.blur : 4\n\t        });\n\t    },\n\n\t    // `amount` ... the proportion of the conversion (1). A value of 1 (default) is completely grayscale. A value of 0 leaves the input unchanged.\n\t    grayscale: function(args) {\n\n\t        var amount = Number.isFinite(args.amount) ? args.amount : 1;\n\n\t        return template('<filter><feColorMatrix type=\"matrix\" values=\"${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0\"/></filter>')({\n\t            a: 0.2126 + 0.7874 * (1 - amount),\n\t            b: 0.7152 - 0.7152 * (1 - amount),\n\t            c: 0.0722 - 0.0722 * (1 - amount),\n\t            d: 0.2126 - 0.2126 * (1 - amount),\n\t            e: 0.7152 + 0.2848 * (1 - amount),\n\t            f: 0.0722 - 0.0722 * (1 - amount),\n\t            g: 0.2126 - 0.2126 * (1 - amount),\n\t            h: 0.0722 + 0.9278 * (1 - amount)\n\t        });\n\t    },\n\n\t    // `amount` ... the proportion of the conversion (1). A value of 1 (default) is completely sepia. A value of 0 leaves the input unchanged.\n\t    sepia: function(args) {\n\n\t        var amount = Number.isFinite(args.amount) ? args.amount : 1;\n\n\t        return template('<filter><feColorMatrix type=\"matrix\" values=\"${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0\"/></filter>')({\n\t            a: 0.393 + 0.607 * (1 - amount),\n\t            b: 0.769 - 0.769 * (1 - amount),\n\t            c: 0.189 - 0.189 * (1 - amount),\n\t            d: 0.349 - 0.349 * (1 - amount),\n\t            e: 0.686 + 0.314 * (1 - amount),\n\t            f: 0.168 - 0.168 * (1 - amount),\n\t            g: 0.272 - 0.272 * (1 - amount),\n\t            h: 0.534 - 0.534 * (1 - amount),\n\t            i: 0.131 + 0.869 * (1 - amount)\n\t        });\n\t    },\n\n\t    // `amount` ... the proportion of the conversion (1). A value of 0 is completely un-saturated. A value of 1 (default) leaves the input unchanged.\n\t    saturate: function(args) {\n\n\t        var amount = Number.isFinite(args.amount) ? args.amount : 1;\n\n\t        return template('<filter><feColorMatrix type=\"saturate\" values=\"${amount}\"/></filter>')({\n\t            amount: 1 - amount\n\t        });\n\t    },\n\n\t    // `angle` ...  the number of degrees around the color circle the input samples will be adjusted (0).\n\t    hueRotate: function(args) {\n\n\t        return template('<filter><feColorMatrix type=\"hueRotate\" values=\"${angle}\"/></filter>')({\n\t            angle: args.angle || 0\n\t        });\n\t    },\n\n\t    // `amount` ... the proportion of the conversion (1). A value of 1 (default) is completely inverted. A value of 0 leaves the input unchanged.\n\t    invert: function(args) {\n\n\t        var amount = Number.isFinite(args.amount) ? args.amount : 1;\n\n\t        return template('<filter><feComponentTransfer><feFuncR type=\"table\" tableValues=\"${amount} ${amount2}\"/><feFuncG type=\"table\" tableValues=\"${amount} ${amount2}\"/><feFuncB type=\"table\" tableValues=\"${amount} ${amount2}\"/></feComponentTransfer></filter>')({\n\t            amount: amount,\n\t            amount2: 1 - amount\n\t        });\n\t    },\n\n\t    // `amount` ... proportion of the conversion (1). A value of 0 will create an image that is completely black. A value of 1 (default) leaves the input unchanged.\n\t    brightness: function(args) {\n\n\t        return template('<filter><feComponentTransfer><feFuncR type=\"linear\" slope=\"${amount}\"/><feFuncG type=\"linear\" slope=\"${amount}\"/><feFuncB type=\"linear\" slope=\"${amount}\"/></feComponentTransfer></filter>')({\n\t            amount: Number.isFinite(args.amount) ? args.amount : 1\n\t        });\n\t    },\n\n\t    // `amount` ... proportion of the conversion (1). A value of 0 will create an image that is completely black. A value of 1 (default) leaves the input unchanged.\n\t    contrast: function(args) {\n\n\t        var amount = Number.isFinite(args.amount) ? args.amount : 1;\n\n\t        return template('<filter><feComponentTransfer><feFuncR type=\"linear\" slope=\"${amount}\" intercept=\"${amount2}\"/><feFuncG type=\"linear\" slope=\"${amount}\" intercept=\"${amount2}\"/><feFuncB type=\"linear\" slope=\"${amount}\" intercept=\"${amount2}\"/></feComponentTransfer></filter>')({\n\t            amount: amount,\n\t            amount2: .5 - amount / 2\n\t        });\n\t    }\n\t};\n\n\tvar format = {\n\n\t    // Formatting numbers via the Python Format Specification Mini-language.\n\t    // See http://docs.python.org/release/3.1.3/library/string.html#format-specification-mini-language.\n\t    // Heavilly inspired by the D3.js library implementation.\n\t    number: function(specifier, value, locale) {\n\n\t        locale = locale || {\n\n\t            currency: ['$', ''],\n\t            decimal: '.',\n\t            thousands: ',',\n\t            grouping: [3]\n\t        };\n\n\t        // See Python format specification mini-language: http://docs.python.org/release/3.1.3/library/string.html#format-specification-mini-language.\n\t        // [[fill]align][sign][symbol][0][width][,][.precision][type]\n\t        var re = /(?:([^{])?([<>=^]))?([+\\- ])?([$#])?(0)?(\\d+)?(,)?(\\.-?\\d+)?([a-z%])?/i;\n\n\t        var match = re.exec(specifier);\n\t        var fill = match[1] || ' ';\n\t        var align = match[2] || '>';\n\t        var sign = match[3] || '';\n\t        var symbol = match[4] || '';\n\t        var zfill = match[5];\n\t        var width = +match[6];\n\t        var comma = match[7];\n\t        var precision = match[8];\n\t        var type = match[9];\n\t        var scale = 1;\n\t        var prefix = '';\n\t        var suffix = '';\n\t        var integer = false;\n\n\t        if (precision) { precision = +precision.substring(1); }\n\n\t        if (zfill || fill === '0' && align === '=') {\n\t            zfill = fill = '0';\n\t            align = '=';\n\t            if (comma) { width -= Math.floor((width - 1) / 4); }\n\t        }\n\n\t        switch (type) {\n\t            case 'n':\n\t                comma = true;\n\t                type = 'g';\n\t                break;\n\t            case '%':\n\t                scale = 100;\n\t                suffix = '%';\n\t                type = 'f';\n\t                break;\n\t            case 'p':\n\t                scale = 100;\n\t                suffix = '%';\n\t                type = 'r';\n\t                break;\n\t            case 'b':\n\t            case 'o':\n\t            case 'x':\n\t            case 'X':\n\t                if (symbol === '#') { prefix = '0' + type.toLowerCase(); }\n\t                break;\n\t            case 'c':\n\t            case 'd':\n\t                integer = true;\n\t                precision = 0;\n\t                break;\n\t            case 's':\n\t                scale = -1;\n\t                type = 'r';\n\t                break;\n\t        }\n\n\t        if (symbol === '$') {\n\t            prefix = locale.currency[0];\n\t            suffix = locale.currency[1];\n\t        }\n\n\t        // If no precision is specified for `'r'`, fallback to general notation.\n\t        if (type == 'r' && !precision) { type = 'g'; }\n\n\t        // Ensure that the requested precision is in the supported range.\n\t        if (precision != null) {\n\t            if (type == 'g') { precision = Math.max(1, Math.min(21, precision)); }\n\t            else if (type == 'e' || type == 'f') { precision = Math.max(0, Math.min(20, precision)); }\n\t        }\n\n\t        var zcomma = zfill && comma;\n\n\t        // Return the empty string for floats formatted as ints.\n\t        if (integer && (value % 1)) { return ''; }\n\n\t        // Convert negative to positive, and record the sign prefix.\n\t        var negative = value < 0 || value === 0 && 1 / value < 0 ? (value = -value, '-') : sign;\n\n\t        var fullSuffix = suffix;\n\n\t        // Apply the scale, computing it from the value's exponent for si format.\n\t        // Preserve the existing suffix, if any, such as the currency symbol.\n\t        if (scale < 0) {\n\t            var unit = this.prefix(value, precision);\n\t            value = unit.scale(value);\n\t            fullSuffix = unit.symbol + suffix;\n\t        } else {\n\t            value *= scale;\n\t        }\n\n\t        // Convert to the desired precision.\n\t        value = this.convert(type, value, precision);\n\n\t        // Break the value into the integer part (before) and decimal part (after).\n\t        var i = value.lastIndexOf('.');\n\t        var before = i < 0 ? value : value.substring(0, i);\n\t        var after = i < 0 ? '' : locale.decimal + value.substring(i + 1);\n\n\t        function formatGroup(value) {\n\n\t            var i = value.length;\n\t            var t = [];\n\t            var j = 0;\n\t            var g = locale.grouping[0];\n\t            while (i > 0 && g > 0) {\n\t                t.push(value.substring(i -= g, i + g));\n\t                g = locale.grouping[j = (j + 1) % locale.grouping.length];\n\t            }\n\t            return t.reverse().join(locale.thousands);\n\t        }\n\n\t        // If the fill character is not `'0'`, grouping is applied before padding.\n\t        if (!zfill && comma && locale.grouping) {\n\n\t            before = formatGroup(before);\n\t        }\n\n\t        var length = prefix.length + before.length + after.length + (zcomma ? 0 : negative.length);\n\t        var padding = length < width ? new Array(length = width - length + 1).join(fill) : '';\n\n\t        // If the fill character is `'0'`, grouping is applied after padding.\n\t        if (zcomma) { before = formatGroup(padding + before); }\n\n\t        // Apply prefix.\n\t        negative += prefix;\n\n\t        // Rejoin integer and decimal parts.\n\t        value = before + after;\n\n\t        return (align === '<' ? negative + value + padding\n\t            : align === '>' ? padding + negative + value\n\t                : align === '^' ? padding.substring(0, length >>= 1) + negative + value + padding.substring(length)\n\t                    : negative + (zcomma ? value : padding + value)) + fullSuffix;\n\t    },\n\n\t    // Formatting string via the Python Format string.\n\t    // See https://docs.python.org/2/library/string.html#format-string-syntax)\n\t    string: function(formatString, value) {\n\n\t        var fieldDelimiterIndex;\n\t        var fieldDelimiter = '{';\n\t        var endPlaceholder = false;\n\t        var formattedStringArray = [];\n\n\t        while ((fieldDelimiterIndex = formatString.indexOf(fieldDelimiter)) !== -1) {\n\n\t            var pieceFormattedString, formatSpec, fieldName;\n\n\t            pieceFormattedString = formatString.slice(0, fieldDelimiterIndex);\n\n\t            if (endPlaceholder) {\n\t                formatSpec = pieceFormattedString.split(':');\n\t                fieldName = formatSpec.shift().split('.');\n\t                pieceFormattedString = value;\n\n\t                for (var i = 0; i < fieldName.length; i++)\n\t                    { pieceFormattedString = pieceFormattedString[fieldName[i]]; }\n\n\t                if (formatSpec.length)\n\t                    { pieceFormattedString = this.number(formatSpec, pieceFormattedString); }\n\t            }\n\n\t            formattedStringArray.push(pieceFormattedString);\n\n\t            formatString = formatString.slice(fieldDelimiterIndex + 1);\n\t            endPlaceholder = !endPlaceholder;\n\t            fieldDelimiter = (endPlaceholder) ? '}' : '{';\n\t        }\n\t        formattedStringArray.push(formatString);\n\n\t        return formattedStringArray.join('');\n\t    },\n\n\t    convert: function(type, value, precision) {\n\n\t        switch (type) {\n\t            case 'b':\n\t                return value.toString(2);\n\t            case 'c':\n\t                return String.fromCharCode(value);\n\t            case 'o':\n\t                return value.toString(8);\n\t            case 'x':\n\t                return value.toString(16);\n\t            case 'X':\n\t                return value.toString(16).toUpperCase();\n\t            case 'g':\n\t                return value.toPrecision(precision);\n\t            case 'e':\n\t                return value.toExponential(precision);\n\t            case 'f':\n\t                return value.toFixed(precision);\n\t            case 'r':\n\t                return (value = this.round(value, this.precision(value, precision))).toFixed(Math.max(0, Math.min(20, this.precision(value * (1 + 1e-15), precision))));\n\t            default:\n\t                return value + '';\n\t        }\n\t    },\n\n\t    round: function(value, precision) {\n\n\t        return precision\n\t            ? Math.round(value * (precision = Math.pow(10, precision))) / precision\n\t            : Math.round(value);\n\t    },\n\n\t    precision: function(value, precision) {\n\n\t        return precision - (value ? Math.ceil(Math.log(value) / Math.LN10) : 1);\n\t    },\n\n\t    prefix: function(value, precision) {\n\n\t        var prefixes = ['y', 'z', 'a', 'f', 'p', 'n', 'Âµ', 'm', '', 'k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'].map(function(d, i) {\n\t            var k = Math.pow(10, Math.abs(8 - i) * 3);\n\t            return {\n\t                scale: i > 8 ? function(d) {\n\t                    return d / k;\n\t                } : function(d) {\n\t                    return d * k;\n\t                },\n\t                symbol: d\n\t            };\n\t        });\n\n\t        var i = 0;\n\t        if (value) {\n\t            if (value < 0) { value *= -1; }\n\t            if (precision) { value = this.round(value, this.precision(value, precision)); }\n\t            i = 1 + Math.floor(1e-12 + Math.log(value) / Math.LN10);\n\t            i = Math.max(-24, Math.min(24, Math.floor((i <= 0 ? i + 1 : i - 1) / 3) * 3));\n\t        }\n\t        return prefixes[8 + i / 3];\n\t    }\n\t};\n\n\t/*\n\t    Pre-compile the HTML to be used as a template.\n\t*/\n\tvar template = function(html) {\n\n\t    /*\n\t        Must support the variation in templating syntax found here:\n\t        https://lodash.com/docs#template\n\t    */\n\t    var regex = /<%= ([^ ]+) %>|\\$\\{ ?([^{} ]+) ?\\}|\\{\\{([^{} ]+)\\}\\}/g;\n\n\t    return function(data) {\n\n\t        data = data || {};\n\n\t        return html.replace(regex, function(match) {\n\n\t            var args = Array.from(arguments);\n\t            var attr = args.slice(1, 4).find(function(_attr) {\n\t                return !!_attr;\n\t            });\n\n\t            var attrArray = attr.split('.');\n\t            var value = data[attrArray.shift()];\n\n\t            while (value !== undefined && attrArray.length) {\n\t                value = value[attrArray.shift()];\n\t            }\n\n\t            return value !== undefined ? value : '';\n\t        });\n\t    };\n\t};\n\n\t/**\n\t * @param {Element} el Element, which content is intent to display in full-screen mode, 'window.top.document.body' is default.\n\t */\n\tvar toggleFullScreen = function(el) {\n\n\t    var topDocument = window.top.document;\n\t    el = el || topDocument.body;\n\n\t    function prefixedResult(el, prop) {\n\n\t        var prefixes = ['webkit', 'moz', 'ms', 'o', ''];\n\t        for (var i = 0; i < prefixes.length; i++) {\n\t            var prefix = prefixes[i];\n\t            var propName = prefix ? (prefix + prop) : (prop.substr(0, 1).toLowerCase() + prop.substr(1));\n\t            if (el[propName] !== undefined) {\n\t                return isFunction(el[propName]) ? el[propName]() : el[propName];\n\t            }\n\t        }\n\t    }\n\n\t    if (prefixedResult(topDocument, 'FullscreenElement') || prefixedResult(topDocument, 'FullScreenElement')) {\n\t        prefixedResult(topDocument, 'ExitFullscreen') || // Spec.\n\t        prefixedResult(topDocument, 'CancelFullScreen'); // Firefox\n\t    } else {\n\t        prefixedResult(el, 'RequestFullscreen') || // Spec.\n\t        prefixedResult(el, 'RequestFullScreen'); // Firefox\n\t    }\n\t};\n\n\t// Deprecated\n\t// Copy all the properties to the first argument from the following arguments.\n\t// All the properties will be overwritten by the properties from the following\n\t// arguments. Inherited properties are ignored.\n\tvar mixin = _.assign;\n\n\t// Deprecated\n\t// Copy all properties to the first argument from the following\n\t// arguments only in case if they don't exists in the first argument.\n\t// All the function propererties in the first argument will get\n\t// additional property base pointing to the extenders same named\n\t// property function's call method.\n\tvar supplement = _.defaults;\n\n\t// Same as `mixin()` but deep version.\n\tvar deepMixin = mixin;\n\n\t// Deprecated\n\t// Same as `supplement()` but deep version.\n\tvar deepSupplement = _.defaultsDeep;\n\n\t// Replacements for deprecated functions\n\tvar assign = _.assign;\n\tvar defaults = _.defaults;\n\t// no better-named replacement for `deepMixin`\n\tvar defaultsDeep = _.defaultsDeep;\n\n\t// Lodash 3 vs 4 incompatible\n\tvar invoke = _.invokeMap || _.invoke;\n\tvar sortedIndex = _.sortedIndexBy || _.sortedIndex;\n\tvar uniq = _.uniqBy || _.uniq;\n\n\tvar clone = _.clone;\n\tvar cloneDeep = _.cloneDeep;\n\tvar isEmpty = _.isEmpty;\n\tvar isEqual = _.isEqual;\n\tvar isFunction = _.isFunction;\n\tvar isPlainObject = _.isPlainObject;\n\tvar toArray = _.toArray;\n\tvar debounce = _.debounce;\n\tvar groupBy = _.groupBy;\n\tvar sortBy = _.sortBy;\n\tvar flattenDeep = _.flattenDeep;\n\tvar without = _.without;\n\tvar difference = _.difference;\n\tvar intersection$1 = _.intersection;\n\tvar union = _.union;\n\tvar has$2 = _.has;\n\tvar result = _.result;\n\tvar omit = _.omit;\n\tvar pick = _.pick;\n\tvar bindAll = _.bindAll;\n\tvar forIn = _.forIn;\n\tvar camelCase = _.camelCase;\n\tvar uniqueId = _.uniqueId;\n\n\tvar merge = function() {\n\t    if (_.mergeWith) {\n\t        var args = Array.from(arguments);\n\t        var last = args[args.length - 1];\n\n\t        var customizer = isFunction(last) ? last : noop;\n\t        args.push(function(a, b) {\n\t            var customResult = customizer(a, b);\n\t            if (customResult !== undefined) {\n\t                return customResult;\n\t            }\n\n\t            if (Array.isArray(a) && !Array.isArray(b)) {\n\t                return b;\n\t            }\n\t        });\n\n\t        return _.mergeWith.apply(this, args);\n\t    }\n\t    return _.merge.apply(this, arguments);\n\t};\n\n\tvar isBoolean = function(value) {\n\t    var toString = Object.prototype.toString;\n\t    return value === true || value === false || (!!value && typeof value === 'object' && toString.call(value) === '[object Boolean]');\n\t};\n\n\tvar isObject$1 = function(value) {\n\t    return !!value && (typeof value === 'object' || typeof value === 'function');\n\t};\n\n\tvar isNumber = function(value) {\n\t    var toString = Object.prototype.toString;\n\t    return typeof value === 'number' || (!!value && typeof value === 'object' && toString.call(value) === '[object Number]');\n\t};\n\n\tvar isString = function(value) {\n\t    var toString = Object.prototype.toString;\n\t    return typeof value === 'string' || (!!value && typeof value === 'object' && toString.call(value) === '[object String]');\n\t};\n\n\tvar noop = function() {\n\t};\n\n\t// Clone `cells` returning an object that maps the original cell ID to the clone. The number\n\t// of clones is exactly the same as the `cells.length`.\n\t// This function simply clones all the `cells`. However, it also reconstructs\n\t// all the `source/target` and `parent/embed` references within the `cells`.\n\t// This is the main difference from the `cell.clone()` method. The\n\t// `cell.clone()` method works on one single cell only.\n\t// For example, for a graph: `A --- L ---> B`, `cloneCells([A, L, B])`\n\t// returns `[A2, L2, B2]` resulting to a graph: `A2 --- L2 ---> B2`, i.e.\n\t// the source and target of the link `L2` is changed to point to `A2` and `B2`.\n\tfunction cloneCells(cells) {\n\n\t    cells = uniq(cells);\n\n\t    // A map of the form [original cell ID] -> [clone] helping\n\t    // us to reconstruct references for source/target and parent/embeds.\n\t    // This is also the returned value.\n\t    var cloneMap = toArray(cells).reduce(function(map, cell) {\n\t        map[cell.id] = cell.clone();\n\t        return map;\n\t    }, {});\n\n\t    toArray(cells).forEach(function(cell) {\n\n\t        var clone = cloneMap[cell.id];\n\t        // assert(clone exists)\n\n\t        if (clone.isLink()) {\n\t            var source = clone.source();\n\t            var target = clone.target();\n\t            if (source.id && cloneMap[source.id]) {\n\t                // Source points to an element and the element is among the clones.\n\t                // => Update the source of the cloned link.\n\t                clone.prop('source/id', cloneMap[source.id].id);\n\t            }\n\t            if (target.id && cloneMap[target.id]) {\n\t                // Target points to an element and the element is among the clones.\n\t                // => Update the target of the cloned link.\n\t                clone.prop('target/id', cloneMap[target.id].id);\n\t            }\n\t        }\n\n\t        // Find the parent of the original cell\n\t        var parent = cell.get('parent');\n\t        if (parent && cloneMap[parent]) {\n\t            clone.set('parent', cloneMap[parent].id);\n\t        }\n\n\t        // Find the embeds of the original cell\n\t        var embeds = toArray(cell.get('embeds')).reduce(function(newEmbeds, embed) {\n\t            // Embedded cells that are not being cloned can not be carried\n\t            // over with other embedded cells.\n\t            if (cloneMap[embed]) {\n\t                newEmbeds.push(cloneMap[embed].id);\n\t            }\n\t            return newEmbeds;\n\t        }, []);\n\n\t        if (!isEmpty(embeds)) {\n\t            clone.set('embeds', embeds);\n\t        }\n\t    });\n\n\t    return cloneMap;\n\t}\n\n\tvar props = {\n\t    x: 'x',\n\t    y: 'y',\n\t    width: 'w',\n\t    height: 'h',\n\t    minimum: 's',\n\t    maximum: 'l',\n\t    diagonal: 'd'\n\t};\n\tvar propsList = Object.keys(props).map(function (key) { return props[key]; }).join('');\n\tvar numberPattern = '[-+]?[0-9]*\\\\.?[0-9]+(?:[eE][-+]?[0-9]+)?';\n\tvar findSpacesRegex = /\\s/g;\n\tvar parseExpressionRegExp = new RegExp((\"^(\" + numberPattern + \"\\\\*)?([\" + propsList + \"])([-+]{1,2}\" + numberPattern + \")?$\"), 'g');\n\n\tfunction throwInvalid(expression) {\n\t    throw new Error((\"Invalid calc() expression: \" + expression));\n\t}\n\n\tfunction evalCalcExpression(expression, bbox) {\n\t    var match = parseExpressionRegExp.exec(expression.replace(findSpacesRegex, ''));\n\t    if (!match) { throwInvalid(expression); }\n\t    parseExpressionRegExp.lastIndex = 0; // reset regex results for the next run\n\t    var multiply = match[1]; if ( multiply === void 0 ) multiply = 1;\n\t    var property = match[2];\n\t    var add = match[3]; if ( add === void 0 ) add = 0;\n\t    var x = bbox.x;\n\t    var y = bbox.y;\n\t    var width = bbox.width;\n\t    var height = bbox.height;\n\t    var value = 0;\n\t    switch (property) {\n\t        case props.width: {\n\t            value = width;\n\t            break;\n\t        }\n\t        case props.height: {\n\t            value = height;\n\t            break;\n\t        }\n\t        case props.x: {\n\t            value = x;\n\t            break;\n\t        }\n\t        case props.y: {\n\t            value = y;\n\t            break;\n\t        }\n\t        case props.minimum: {\n\t            value = Math.min(height, width);\n\t            break;\n\t        }\n\t        case props.maximum: {\n\t            value = Math.max(height, width);\n\t            break;\n\t        }\n\t        case props.diagonal: {\n\t            value = Math.sqrt((height * height) + (width * width));\n\t            break;\n\t        }\n\t    }\n\t    return parseFloat(multiply) * value + evalAddExpression(add);\n\t}\n\n\tfunction evalAddExpression(addExpression) {\n\t    if (!addExpression) { return 0; }\n\t    var sign = addExpression[0];\n\t    switch (sign) {\n\t        case '+': {\n\t            return parseFloat(addExpression.substr(1));\n\t        }\n\t        case '-': {\n\t            return -parseFloat(addExpression.substr(1));\n\t        }\n\t    }\n\t    return parseFloat(addExpression);\n\t}\n\n\tfunction isCalcAttribute(value) {\n\t    return typeof value === 'string' && value.includes('calc');\n\t}\n\n\tvar calcStart = 'calc(';\n\tvar calcStartOffset = calcStart.length;\n\n\tfunction evalCalcAttribute(attributeValue, refBBox) {\n\t    var value = attributeValue;\n\t    var startSearchIndex = 0;\n\t    do {\n\t        var calcIndex = value.indexOf(calcStart, startSearchIndex);\n\t        if (calcIndex === -1) { return value; }\n\t        var calcEndIndex = calcIndex + calcStartOffset;\n\t        var brackets = 1;\n\t        findClosingBracket: do {\n\t            switch (value[calcEndIndex]) {\n\t                case '(': {\n\t                    brackets++;\n\t                    break;\n\t                }\n\t                case ')': {\n\t                    brackets--;\n\t                    if (brackets === 0) { break findClosingBracket; }\n\t                    break;\n\t                }\n\t                case undefined: {\n\t                    // Could not find the closing bracket.\n\t                    throwInvalid(value);\n\t                }\n\t            }\n\t            calcEndIndex++;\n\t        } while (true);\n\t        // Get the calc() expression without nested calcs (recursion)\n\t        var expression = value.slice(calcIndex + calcStartOffset, calcEndIndex);\n\t        if (isCalcAttribute(expression)) {\n\t            expression = evalCalcAttribute(expression, refBBox);\n\t        }\n\t        // Eval the calc() expression without nested calcs.\n\t        var calcValue = String(evalCalcExpression(expression, refBBox));\n\t        // Replace the calc() expression and continue search\n\t        value = value.slice(0, calcIndex) + calcValue + value.slice(calcEndIndex + 1);\n\t        startSearchIndex = calcIndex + calcValue.length;\n\t    } while (true);\n\t}\n\n\tfunction setWrapper(attrName, dimension) {\n\t    return function(value, refBBox) {\n\t        var isValuePercentage = isPercentage(value);\n\t        value = parseFloat(value);\n\t        if (isValuePercentage) {\n\t            value /= 100;\n\t        }\n\n\t        var attrs = {};\n\t        if (isFinite(value)) {\n\t            var attrValue = (isValuePercentage || value >= 0 && value <= 1)\n\t                ? value * refBBox[dimension]\n\t                : Math.max(value + refBBox[dimension], 0);\n\t            attrs[attrName] = attrValue;\n\t        }\n\n\t        return attrs;\n\t    };\n\t}\n\n\tfunction positionWrapper(axis, dimension, origin) {\n\t    return function(value, refBBox) {\n\t        var valuePercentage = isPercentage(value);\n\t        value = parseFloat(value);\n\t        if (valuePercentage) {\n\t            value /= 100;\n\t        }\n\n\t        var delta;\n\t        if (isFinite(value)) {\n\t            var refOrigin = refBBox[origin]();\n\t            if (valuePercentage || value > 0 && value < 1) {\n\t                delta = refOrigin[axis] + refBBox[dimension] * value;\n\t            } else {\n\t                delta = refOrigin[axis] + value;\n\t            }\n\t        }\n\n\t        var point = Point();\n\t        point[axis] = delta || 0;\n\t        return point;\n\t    };\n\t}\n\n\tfunction offsetWrapper(axis, dimension, corner) {\n\t    return function(value, nodeBBox) {\n\t        var delta;\n\t        if (value === 'middle') {\n\t            delta = nodeBBox[dimension] / 2;\n\t        } else if (value === corner) {\n\t            delta = nodeBBox[dimension];\n\t        } else if (isFinite(value)) {\n\t            // TODO: or not to do a breaking change?\n\t            delta = (value > -1 && value < 1) ? (-nodeBBox[dimension] * value) : -value;\n\t        } else if (isPercentage(value)) {\n\t            delta = nodeBBox[dimension] * parseFloat(value) / 100;\n\t        } else {\n\t            delta = 0;\n\t        }\n\n\t        var point = Point();\n\t        point[axis] = -(nodeBBox[axis] + delta);\n\t        return point;\n\t    };\n\t}\n\n\tfunction shapeWrapper(shapeConstructor, opt) {\n\t    var cacheName = 'joint-shape';\n\t    var resetOffset = opt && opt.resetOffset;\n\t    return function(value, refBBox, node) {\n\t        var $node = $(node);\n\t        var cache = $node.data(cacheName);\n\t        if (!cache || cache.value !== value) {\n\t            // only recalculate if value has changed\n\t            var cachedShape = shapeConstructor(value);\n\t            cache = {\n\t                value: value,\n\t                shape: cachedShape,\n\t                shapeBBox: cachedShape.bbox()\n\t            };\n\t            $node.data(cacheName, cache);\n\t        }\n\n\t        var shape = cache.shape.clone();\n\t        var shapeBBox = cache.shapeBBox.clone();\n\t        var shapeOrigin = shapeBBox.origin();\n\t        var refOrigin = refBBox.origin();\n\n\t        shapeBBox.x = refOrigin.x;\n\t        shapeBBox.y = refOrigin.y;\n\n\t        var fitScale = refBBox.maxRectScaleToFit(shapeBBox, refOrigin);\n\t        // `maxRectScaleToFit` can give Infinity if width or height is 0\n\t        var sx = (shapeBBox.width === 0 || refBBox.width === 0) ? 1 : fitScale.sx;\n\t        var sy = (shapeBBox.height === 0 || refBBox.height === 0) ? 1 : fitScale.sy;\n\n\t        shape.scale(sx, sy, shapeOrigin);\n\t        if (resetOffset) {\n\t            shape.translate(-shapeOrigin.x, -shapeOrigin.y);\n\t        }\n\n\t        return shape;\n\t    };\n\t}\n\n\t// `d` attribute for SVGPaths\n\tfunction dWrapper(opt) {\n\t    function pathConstructor(value) {\n\t        return new Path(V.normalizePathData(value));\n\t    }\n\n\t    var shape = shapeWrapper(pathConstructor, opt);\n\t    return function(value, refBBox, node) {\n\t        var path = shape(value, refBBox, node);\n\t        return {\n\t            d: path.serialize()\n\t        };\n\t    };\n\t}\n\n\t// `points` attribute for SVGPolylines and SVGPolygons\n\tfunction pointsWrapper(opt) {\n\t    var shape = shapeWrapper(Polyline, opt);\n\t    return function(value, refBBox, node) {\n\t        var polyline = shape(value, refBBox, node);\n\t        return {\n\t            points: polyline.serialize()\n\t        };\n\t    };\n\t}\n\n\tfunction atConnectionWrapper(method, opt) {\n\t    var zeroVector = new Point(1, 0);\n\t    return function(value) {\n\t        var p, angle;\n\t        var tangent = this[method](value);\n\t        if (tangent) {\n\t            angle = (opt.rotate) ? tangent.vector().vectorAngle(zeroVector) : 0;\n\t            p = tangent.start;\n\t        } else {\n\t            p = this.path.start;\n\t            angle = 0;\n\t        }\n\t        if (angle === 0) { return { transform: 'translate(' + p.x + ',' + p.y + ')' }; }\n\t        return { transform: 'translate(' + p.x + ',' + p.y + ') rotate(' + angle + ')' };\n\t    };\n\t}\n\n\tfunction setIfChangedWrapper(attribute) {\n\t    return function setIfChanged(value, _, node) {\n\t        var vel = V(node);\n\t        if (vel.attr(attribute) === value) { return; }\n\t        vel.attr(attribute, value);\n\t    };\n\t}\n\n\tfunction isTextInUse(_value, _node, attrs) {\n\t    return (attrs.text !== undefined);\n\t}\n\n\tfunction isLinkView() {\n\t    return this.model.isLink();\n\t}\n\n\tfunction contextMarker(context) {\n\t    var marker = {};\n\t    // Stroke\n\t    // The context 'fill' is disregared here. The usual case is to use the marker with a connection\n\t    // (for which 'fill' attribute is set to 'none').\n\t    var stroke = context.stroke;\n\t    if (typeof stroke === 'string') {\n\t        marker['stroke'] = stroke;\n\t        marker['fill'] = stroke;\n\t    }\n\t    // Opacity\n\t    // Again the context 'fill-opacity' is ignored.\n\t    var strokeOpacity = context.strokeOpacity;\n\t    if (strokeOpacity === undefined) { strokeOpacity = context['stroke-opacity']; }\n\t    if (strokeOpacity === undefined) { strokeOpacity = context.opacity; }\n\t    if (strokeOpacity !== undefined) {\n\t        marker['stroke-opacity'] = strokeOpacity;\n\t        marker['fill-opacity'] = strokeOpacity;\n\t    }\n\t    return marker;\n\t}\n\n\tfunction setPaintURL(def) {\n\t    var ref = this;\n\t    var paper = ref.paper;\n\t    var url = (def.type === 'pattern')\n\t        ? paper.definePattern(def)\n\t        : paper.defineGradient(def);\n\t    return (\"url(#\" + url + \")\");\n\t}\n\n\tvar attributesNS = {\n\n\t    xlinkShow: {\n\t        set: 'xlink:show'\n\t    },\n\n\t    xlinkRole: {\n\t        set: 'xlink:role'\n\t    },\n\n\t    xlinkType: {\n\t        set: 'xlink:type'\n\t    },\n\n\t    xlinkArcrole: {\n\t        set: 'xlink:arcrole'\n\t    },\n\n\t    xlinkTitle: {\n\t        set: 'xlink:title'\n\t    },\n\n\t    xlinkActuate: {\n\t        set: 'xlink:actuate'\n\t    },\n\n\t    xmlSpace: {\n\t        set: 'xml:space'\n\t    },\n\n\t    xmlBase: {\n\t        set: 'xml:base'\n\t    },\n\n\t    xmlLang: {\n\t        set: 'xml:lang'\n\t    },\n\n\t    preserveAspectRatio: {\n\t        set: 'preserveAspectRatio'\n\t    },\n\n\t    requiredExtension: {\n\t        set: 'requiredExtension'\n\t    },\n\n\t    requiredFeatures: {\n\t        set: 'requiredFeatures'\n\t    },\n\n\t    systemLanguage: {\n\t        set: 'systemLanguage'\n\t    },\n\n\t    externalResourcesRequired: {\n\t        set: 'externalResourceRequired'\n\t    },\n\n\t    href: {\n\t        set: setIfChangedWrapper('href')\n\t    },\n\n\t    xlinkHref: {\n\t        set: setIfChangedWrapper('xlink:href')\n\t    },\n\n\t    filter: {\n\t        qualify: isPlainObject,\n\t        set: function(filter) {\n\t            return 'url(#' + this.paper.defineFilter(filter) + ')';\n\t        }\n\t    },\n\n\t    fill: {\n\t        qualify: isPlainObject,\n\t        set: setPaintURL\n\t    },\n\n\t    stroke: {\n\t        qualify: isPlainObject,\n\t        set: setPaintURL\n\t    },\n\n\t    sourceMarker: {\n\t        qualify: isPlainObject,\n\t        set: function(marker, refBBox, node, attrs) {\n\t            marker = assign(contextMarker(attrs), marker);\n\t            return { 'marker-start': 'url(#' + this.paper.defineMarker(marker) + ')' };\n\t        }\n\t    },\n\n\t    targetMarker: {\n\t        qualify: isPlainObject,\n\t        set: function(marker, refBBox, node, attrs) {\n\t            marker = assign(contextMarker(attrs), { 'transform': 'rotate(180)' }, marker);\n\t            return { 'marker-end': 'url(#' + this.paper.defineMarker(marker) + ')' };\n\t        }\n\t    },\n\n\t    vertexMarker: {\n\t        qualify: isPlainObject,\n\t        set: function(marker, refBBox, node, attrs) {\n\t            marker = assign(contextMarker(attrs), marker);\n\t            return { 'marker-mid': 'url(#' + this.paper.defineMarker(marker) + ')' };\n\t        }\n\t    },\n\n\t    text: {\n\t        qualify: function(_text, _node, attrs) {\n\t            return !attrs.textWrap || !isPlainObject(attrs.textWrap);\n\t        },\n\t        set: function(text, refBBox, node, attrs) {\n\t            var $node = $(node);\n\t            var cacheName = 'joint-text';\n\t            var cache = $node.data(cacheName);\n\t            var textAttrs = pick(attrs, 'lineHeight', 'annotations', 'textPath', 'x', 'textVerticalAnchor', 'eol', 'displayEmpty');\n\t            // eval `x` if using calc()\n\t            var x = textAttrs.x;\n\t            if (isCalcAttribute(x)) {\n\t                textAttrs.x = evalCalcAttribute(x, refBBox);\n\t            }\n\t            var fontSize = textAttrs.fontSize = attrs['font-size'] || attrs['fontSize'];\n\t            var textHash = JSON.stringify([text, textAttrs]);\n\t            // Update the text only if there was a change in the string\n\t            // or any of its attributes.\n\t            if (cache === undefined || cache !== textHash) {\n\t                // Chrome bug:\n\t                // Tspans positions defined as `em` are not updated\n\t                // when container `font-size` change.\n\t                if (fontSize) { node.setAttribute('font-size', fontSize); }\n\t                // Text Along Path Selector\n\t                var textPath = textAttrs.textPath;\n\t                if (isObject$1(textPath)) {\n\t                    var pathSelector = textPath.selector;\n\t                    if (typeof pathSelector === 'string') {\n\t                        var pathNode = this.findBySelector(pathSelector)[0];\n\t                        if (pathNode instanceof SVGPathElement) {\n\t                            textAttrs.textPath = assign({ 'xlink:href': '#' + pathNode.id }, textPath);\n\t                        }\n\t                    }\n\t                }\n\t                V(node).text('' + text, textAttrs);\n\t                $node.data(cacheName, textHash);\n\t            }\n\t        }\n\t    },\n\n\t    textWrap: {\n\t        qualify: isPlainObject,\n\t        set: function(value, refBBox, node, attrs) {\n\t            // option `width`\n\t            var width = value.width || 0;\n\t            var size = {};\n\t            if (isPercentage(width)) {\n\t                size.width = refBBox.width * parseFloat(width) / 100;\n\t            } else if (width <= 0) {\n\t                size.width = refBBox.width + width;\n\t            } else {\n\t                size.width = width;\n\t            }\n\t            // option `height`\n\t            var height = value.height || 0;\n\t            if (isPercentage(height)) {\n\t                size.height = refBBox.height * parseFloat(height) / 100;\n\t            } else if (height <= 0) {\n\t                size.height = refBBox.height + height;\n\t            } else {\n\t                size.height = height;\n\t            }\n\t            // option `text`\n\t            var wrappedText;\n\t            var text = value.text;\n\t            if (text === undefined) { text = attrs.text; }\n\t            if (text !== undefined) {\n\t                wrappedText = breakText('' + text, size, {\n\t                    'font-weight': attrs['font-weight'] || attrs.fontWeight,\n\t                    'font-size': attrs['font-size'] || attrs.fontSize,\n\t                    'font-family': attrs['font-family'] || attrs.fontFamily,\n\t                    'lineHeight': attrs.lineHeight,\n\t                    'letter-spacing': 'letter-spacing' in attrs ? attrs['letter-spacing'] : attrs.letterSpacing\n\t                }, {\n\t                    // Provide an existing SVG Document here\n\t                    // instead of creating a temporary one over again.\n\t                    svgDocument: this.paper.svg,\n\t                    ellipsis: value.ellipsis,\n\t                    hyphen: value.hyphen,\n\t                    maxLineCount: value.maxLineCount\n\t                });\n\t            } else {\n\t                wrappedText = '';\n\t            }\n\t            attributesNS.text.set.call(this, wrappedText, refBBox, node, attrs);\n\t        }\n\t    },\n\n\t    title: {\n\t        qualify: function(title, node) {\n\t            // HTMLElement title is specified via an attribute (i.e. not an element)\n\t            return node instanceof SVGElement;\n\t        },\n\t        set: function(title, refBBox, node) {\n\t            var $node = $(node);\n\t            var cacheName = 'joint-title';\n\t            var cache = $node.data(cacheName);\n\t            if (cache === undefined || cache !== title) {\n\t                $node.data(cacheName, title);\n\t                // Generally <title> element should be the first child element of its parent.\n\t                var firstChild = node.firstChild;\n\t                if (firstChild && firstChild.tagName.toUpperCase() === 'TITLE') {\n\t                    // Update an existing title\n\t                    firstChild.textContent = title;\n\t                } else {\n\t                    // Create a new title\n\t                    var titleNode = document.createElementNS(node.namespaceURI, 'title');\n\t                    titleNode.textContent = title;\n\t                    node.insertBefore(titleNode, firstChild);\n\t                }\n\t            }\n\t        }\n\t    },\n\n\t    lineHeight: {\n\t        qualify: isTextInUse\n\t    },\n\n\t    textVerticalAnchor: {\n\t        qualify: isTextInUse\n\t    },\n\n\t    textPath: {\n\t        qualify: isTextInUse\n\t    },\n\n\t    annotations: {\n\t        qualify: isTextInUse\n\t    },\n\n\t    eol: {\n\t        qualify: isTextInUse\n\t    },\n\n\t    displayEmpty: {\n\t        qualify: isTextInUse\n\t    },\n\n\t    // `port` attribute contains the `id` of the port that the underlying magnet represents.\n\t    port: {\n\t        set: function(port) {\n\t            return (port === null || port.id === undefined) ? port : port.id;\n\t        }\n\t    },\n\n\t    // `style` attribute is special in the sense that it sets the CSS style of the subelement.\n\t    style: {\n\t        qualify: isPlainObject,\n\t        set: function(styles, refBBox, node) {\n\t            $(node).css(styles);\n\t        }\n\t    },\n\n\t    html: {\n\t        set: function(html, refBBox, node) {\n\t            $(node).html(html + '');\n\t        }\n\t    },\n\n\t    ref: {\n\t        // We do not set `ref` attribute directly on an element.\n\t        // The attribute itself does not qualify for relative positioning.\n\t    },\n\n\t    // if `refX` is in [0, 1] then `refX` is a fraction of bounding box width\n\t    // if `refX` is < 0 then `refX`'s absolute values is the right coordinate of the bounding box\n\t    // otherwise, `refX` is the left coordinate of the bounding box\n\n\t    refX: {\n\t        position: positionWrapper('x', 'width', 'origin')\n\t    },\n\n\t    refY: {\n\t        position: positionWrapper('y', 'height', 'origin')\n\t    },\n\n\t    // `ref-dx` and `ref-dy` define the offset of the subelement relative to the right and/or bottom\n\t    // coordinate of the reference element.\n\n\t    refDx: {\n\t        position: positionWrapper('x', 'width', 'corner')\n\t    },\n\n\t    refDy: {\n\t        position: positionWrapper('y', 'height', 'corner')\n\t    },\n\n\t    // 'ref-width'/'ref-height' defines the width/height of the subelement relatively to\n\t    // the reference element size\n\t    // val in 0..1         ref-width = 0.75 sets the width to 75% of the ref. el. width\n\t    // val < 0 || val > 1  ref-height = -20 sets the height to the ref. el. height shorter by 20\n\n\t    refWidth: {\n\t        set: setWrapper('width', 'width')\n\t    },\n\n\t    refHeight: {\n\t        set: setWrapper('height', 'height')\n\t    },\n\n\t    refRx: {\n\t        set: setWrapper('rx', 'width')\n\t    },\n\n\t    refRy: {\n\t        set: setWrapper('ry', 'height')\n\t    },\n\n\t    refRInscribed: {\n\t        set: (function(attrName) {\n\t            var widthFn = setWrapper(attrName, 'width');\n\t            var heightFn = setWrapper(attrName, 'height');\n\t            return function(value, refBBox) {\n\t                var fn = (refBBox.height > refBBox.width) ? widthFn : heightFn;\n\t                return fn(value, refBBox);\n\t            };\n\t        })('r')\n\t    },\n\n\t    refRCircumscribed: {\n\t        set: function(value, refBBox) {\n\t            var isValuePercentage = isPercentage(value);\n\t            value = parseFloat(value);\n\t            if (isValuePercentage) {\n\t                value /= 100;\n\t            }\n\n\t            var diagonalLength = Math.sqrt((refBBox.height * refBBox.height) + (refBBox.width * refBBox.width));\n\n\t            var rValue;\n\t            if (isFinite(value)) {\n\t                if (isValuePercentage || value >= 0 && value <= 1) { rValue = value * diagonalLength; }\n\t                else { rValue = Math.max(value + diagonalLength, 0); }\n\t            }\n\n\t            return { r: rValue };\n\t        }\n\t    },\n\n\t    refCx: {\n\t        set: setWrapper('cx', 'width')\n\t    },\n\n\t    refCy: {\n\t        set: setWrapper('cy', 'height')\n\t    },\n\n\t    // `x-alignment` when set to `middle` causes centering of the subelement around its new x coordinate.\n\t    // `x-alignment` when set to `right` uses the x coordinate as referenced to the right of the bbox.\n\n\t    xAlignment: {\n\t        offset: offsetWrapper('x', 'width', 'right')\n\t    },\n\n\t    // `y-alignment` when set to `middle` causes centering of the subelement around its new y coordinate.\n\t    // `y-alignment` when set to `bottom` uses the y coordinate as referenced to the bottom of the bbox.\n\n\t    yAlignment: {\n\t        offset: offsetWrapper('y', 'height', 'bottom')\n\t    },\n\n\t    resetOffset: {\n\t        offset: function(val, nodeBBox) {\n\t            return (val)\n\t                ? { x: -nodeBBox.x, y: -nodeBBox.y }\n\t                : { x: 0, y: 0 };\n\t        }\n\n\t    },\n\n\t    refDResetOffset: {\n\t        set: dWrapper({ resetOffset: true })\n\t    },\n\n\t    refDKeepOffset: {\n\t        set: dWrapper({ resetOffset: false })\n\t    },\n\n\t    refPointsResetOffset: {\n\t        set: pointsWrapper({ resetOffset: true })\n\t    },\n\n\t    refPointsKeepOffset: {\n\t        set: pointsWrapper({ resetOffset: false })\n\t    },\n\n\t    // LinkView Attributes\n\n\t    connection: {\n\t        qualify: isLinkView,\n\t        set: function(ref) {\n\t            var stubs = ref.stubs; if ( stubs === void 0 ) stubs = 0;\n\n\t            var d;\n\t            if (isFinite(stubs) && stubs !== 0) {\n\t                var offset;\n\t                if (stubs < 0) {\n\t                    offset = (this.getConnectionLength() + stubs) / 2;\n\t                } else {\n\t                    offset = stubs;\n\t                }\n\t                var path = this.getConnection();\n\t                var sourceParts = path.divideAtLength(offset);\n\t                var targetParts = path.divideAtLength(-offset);\n\t                if (sourceParts && targetParts) {\n\t                    d = (sourceParts[0].serialize()) + \" \" + (targetParts[1].serialize());\n\t                }\n\t            }\n\n\t            return { d: d || this.getSerializedConnection() };\n\t        }\n\t    },\n\n\t    atConnectionLengthKeepGradient: {\n\t        qualify: isLinkView,\n\t        set: atConnectionWrapper('getTangentAtLength', { rotate: true })\n\t    },\n\n\t    atConnectionLengthIgnoreGradient: {\n\t        qualify: isLinkView,\n\t        set: atConnectionWrapper('getTangentAtLength', { rotate: false })\n\t    },\n\n\t    atConnectionRatioKeepGradient: {\n\t        qualify: isLinkView,\n\t        set: atConnectionWrapper('getTangentAtRatio', { rotate: true })\n\t    },\n\n\t    atConnectionRatioIgnoreGradient: {\n\t        qualify: isLinkView,\n\t        set: atConnectionWrapper('getTangentAtRatio', { rotate: false })\n\t    }\n\t};\n\n\tattributesNS['xlink:href'] = attributesNS.xlinkHref;\n\n\t// Support `calc()` with the following SVG attributes\n\t[\n\t    'transform', // g\n\t    'd', // path\n\t    'points', // polyline / polygon\n\t    'width', 'height', // rect / image\n\t    'cx', 'cy', // circle / ellipse\n\t    'r', // circle\n\t    'rx', 'ry', // rect / ellipse\n\t    'x1', 'x2', 'y1', 'y2', // line\n\t    'x', 'y', // rect / text / image\n\t    'dx', 'dy' // text\n\t].forEach(function (attribute) {\n\t    attributesNS[attribute] = {\n\t        qualify: isCalcAttribute,\n\t        set: function setCalcAttribute(value, refBBox) {\n\t            var obj;\n\n\t            return ( obj = {}, obj[attribute] = evalCalcAttribute(value, refBBox), obj );\n\t        }\n\t    };\n\t});\n\n\t// Aliases\n\tattributesNS.refR = attributesNS.refRInscribed;\n\tattributesNS.refD = attributesNS.refDResetOffset;\n\tattributesNS.refPoints = attributesNS.refPointsResetOffset;\n\tattributesNS.atConnectionLength = attributesNS.atConnectionLengthKeepGradient;\n\tattributesNS.atConnectionRatio = attributesNS.atConnectionRatioKeepGradient;\n\n\t// This allows to combine both absolute and relative positioning\n\t// refX: 50%, refX2: 20\n\tattributesNS.refX2 = attributesNS.refX;\n\tattributesNS.refY2 = attributesNS.refY;\n\tattributesNS.refWidth2 = attributesNS.refWidth;\n\tattributesNS.refHeight2 = attributesNS.refHeight;\n\n\t// Aliases for backwards compatibility\n\tattributesNS['ref-x'] = attributesNS.refX;\n\tattributesNS['ref-y'] = attributesNS.refY;\n\tattributesNS['ref-dy'] = attributesNS.refDy;\n\tattributesNS['ref-dx'] = attributesNS.refDx;\n\tattributesNS['ref-width'] = attributesNS.refWidth;\n\tattributesNS['ref-height'] = attributesNS.refHeight;\n\tattributesNS['x-alignment'] = attributesNS.xAlignment;\n\tattributesNS['y-alignment'] = attributesNS.yAlignment;\n\n\tvar attributes = attributesNS;\n\n\t// Cell base model.\n\t// --------------------------\n\n\tvar Cell = Backbone.Model.extend({\n\n\t    // This is the same as Backbone.Model with the only difference that is uses util.merge\n\t    // instead of just _.extend. The reason is that we want to mixin attributes set in upper classes.\n\t    constructor: function(attributes, options) {\n\n\t        var defaults;\n\t        var attrs = attributes || {};\n\t        if (typeof this.preinitialize === 'function') {\n\t            // Check to support an older version of Backbone (prior v1.4)\n\t            this.preinitialize.apply(this, arguments);\n\t        }\n\t        this.cid = uniqueId('c');\n\t        this.attributes = {};\n\t        if (options && options.collection) { this.collection = options.collection; }\n\t        if (options && options.parse) { attrs = this.parse(attrs, options) || {}; }\n\t        if ((defaults = result(this, 'defaults'))) {\n\t            //<custom code>\n\t            // Replaced the call to _.defaults with util.merge.\n\t            attrs = merge({}, defaults, attrs);\n\t            //</custom code>\n\t        }\n\t        this.set(attrs, options);\n\t        this.changed = {};\n\t        this.initialize.apply(this, arguments);\n\t    },\n\n\t    translate: function(dx, dy, opt) {\n\n\t        throw new Error('Must define a translate() method.');\n\t    },\n\n\t    toJSON: function() {\n\n\t        var defaults = result(this.constructor.prototype, 'defaults');\n\t        var defaultAttrs = defaults.attrs || {};\n\t        var attrs = this.attributes.attrs;\n\t        var finalAttrs = {};\n\n\t        // Loop through all the attributes and\n\t        // omit the default attributes as they are implicitly reconstructible by the cell 'type'.\n\t        forIn(attrs, function(attr, selector) {\n\n\t            var defaultAttr = defaultAttrs[selector];\n\n\t            forIn(attr, function(value, name) {\n\n\t                // attr is mainly flat though it might have one more level (consider the `style` attribute).\n\t                // Check if the `value` is object and if yes, go one level deep.\n\t                if (isObject$1(value) && !Array.isArray(value)) {\n\n\t                    forIn(value, function(value2, name2) {\n\n\t                        if (!defaultAttr || !defaultAttr[name] || !isEqual(defaultAttr[name][name2], value2)) {\n\n\t                            finalAttrs[selector] = finalAttrs[selector] || {};\n\t                            (finalAttrs[selector][name] || (finalAttrs[selector][name] = {}))[name2] = value2;\n\t                        }\n\t                    });\n\n\t                } else if (!defaultAttr || !isEqual(defaultAttr[name], value)) {\n\t                    // `value` is not an object, default attribute for such a selector does not exist\n\t                    // or it is different than the attribute value set on the model.\n\n\t                    finalAttrs[selector] = finalAttrs[selector] || {};\n\t                    finalAttrs[selector][name] = value;\n\t                }\n\t            });\n\t        });\n\n\t        var attributes = cloneDeep(omit(this.attributes, 'attrs'));\n\t        attributes.attrs = finalAttrs;\n\n\t        return attributes;\n\t    },\n\n\t    initialize: function(options) {\n\n\t        var idAttribute = this.getIdAttribute();\n\t        if (!options || !(idAttribute in options)) {\n\t            this.set(idAttribute, this.generateId(), { silent: true });\n\t        }\n\n\t        this._transitionIds = {};\n\t        this._scheduledTransitionIds = {};\n\n\t        // Collect ports defined in `attrs` and keep collecting whenever `attrs` object changes.\n\t        this.processPorts();\n\t        this.on('change:attrs', this.processPorts, this);\n\t    },\n\n\t    getIdAttribute: function() {\n\t        return this.idAttribute || 'id';\n\t    },\n\n\t    generateId: function() {\n\t        return uuid();\n\t    },\n\n\t    /**\n\t     * @deprecated\n\t     */\n\t    processPorts: function() {\n\n\t        // Whenever `attrs` changes, we extract ports from the `attrs` object and store it\n\t        // in a more accessible way. Also, if any port got removed and there were links that had `target`/`source`\n\t        // set to that port, we remove those links as well (to follow the same behaviour as\n\t        // with a removed element).\n\n\t        var previousPorts = this.ports;\n\n\t        // Collect ports from the `attrs` object.\n\t        var ports = {};\n\t        forIn(this.get('attrs'), function(attrs, selector) {\n\n\t            if (attrs && attrs.port) {\n\n\t                // `port` can either be directly an `id` or an object containing an `id` (and potentially other data).\n\t                if (attrs.port.id !== undefined) {\n\t                    ports[attrs.port.id] = attrs.port;\n\t                } else {\n\t                    ports[attrs.port] = { id: attrs.port };\n\t                }\n\t            }\n\t        });\n\n\t        // Collect ports that have been removed (compared to the previous ports) - if any.\n\t        // Use hash table for quick lookup.\n\t        var removedPorts = {};\n\t        forIn(previousPorts, function(port, id) {\n\n\t            if (!ports[id]) { removedPorts[id] = true; }\n\t        });\n\n\t        // Remove all the incoming/outgoing links that have source/target port set to any of the removed ports.\n\t        if (this.graph && !isEmpty(removedPorts)) {\n\n\t            var inboundLinks = this.graph.getConnectedLinks(this, { inbound: true });\n\t            inboundLinks.forEach(function(link) {\n\n\t                if (removedPorts[link.get('target').port]) { link.remove(); }\n\t            });\n\n\t            var outboundLinks = this.graph.getConnectedLinks(this, { outbound: true });\n\t            outboundLinks.forEach(function(link) {\n\n\t                if (removedPorts[link.get('source').port]) { link.remove(); }\n\t            });\n\t        }\n\n\t        // Update the `ports` object.\n\t        this.ports = ports;\n\t    },\n\n\t    remove: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        // Store the graph in a variable because `this.graph` won't be accessible\n\t        // after `this.trigger('remove', ...)` down below.\n\t        var ref = this;\n\t        var graph = ref.graph;\n\t        var collection = ref.collection;\n\t        if (!graph) {\n\t            // The collection is a common Backbone collection (not the graph collection).\n\t            if (collection) { collection.remove(this, opt); }\n\t            return this;\n\t        }\n\n\t        graph.startBatch('remove');\n\n\t        // First, unembed this cell from its parent cell if there is one.\n\t        var parentCell = this.getParentCell();\n\t        if (parentCell) {\n\t            parentCell.unembed(this, opt);\n\t        }\n\n\t        // Remove also all the cells, which were embedded into this cell\n\t        var embeddedCells = this.getEmbeddedCells();\n\t        for (var i = 0, n = embeddedCells.length; i < n; i++) {\n\t            var embed = embeddedCells[i];\n\t            if (embed) {\n\t                embed.remove(opt);\n\t            }\n\t        }\n\n\t        this.trigger('remove', this, graph.attributes.cells, opt);\n\n\t        graph.stopBatch('remove');\n\n\t        return this;\n\t    },\n\n\t    toFront: function(opt) {\n\n\t        var graph = this.graph;\n\t        if (graph) {\n\n\t            opt = opt || {};\n\n\t            var z = graph.maxZIndex();\n\n\t            var cells;\n\n\t            if (opt.deep) {\n\t                cells = this.getEmbeddedCells({ deep: true, breadthFirst: opt.breadthFirst !== false });\n\t                cells.unshift(this);\n\t            } else {\n\t                cells = [this];\n\t            }\n\n\t            z = z - cells.length + 1;\n\n\t            var collection = graph.get('cells');\n\t            var shouldUpdate = (collection.indexOf(this) !== (collection.length - cells.length));\n\t            if (!shouldUpdate) {\n\t                shouldUpdate = cells.some(function(cell, index) {\n\t                    return cell.get('z') !== z + index;\n\t                });\n\t            }\n\n\t            if (shouldUpdate) {\n\t                this.startBatch('to-front');\n\n\t                z = z + cells.length;\n\n\t                cells.forEach(function(cell, index) {\n\t                    cell.set('z', z + index, opt);\n\t                });\n\n\t                this.stopBatch('to-front');\n\t            }\n\t        }\n\n\t        return this;\n\t    },\n\n\t    toBack: function(opt) {\n\n\t        var graph = this.graph;\n\t        if (graph) {\n\n\t            opt = opt || {};\n\n\t            var z = graph.minZIndex();\n\n\t            var cells;\n\n\t            if (opt.deep) {\n\t                cells = this.getEmbeddedCells({ deep: true, breadthFirst: opt.breadthFirst !== false });\n\t                cells.unshift(this);\n\t            } else {\n\t                cells = [this];\n\t            }\n\n\t            var collection = graph.get('cells');\n\t            var shouldUpdate = (collection.indexOf(this) !== 0);\n\t            if (!shouldUpdate) {\n\t                shouldUpdate = cells.some(function(cell, index) {\n\t                    return cell.get('z') !== z + index;\n\t                });\n\t            }\n\n\t            if (shouldUpdate) {\n\t                this.startBatch('to-back');\n\n\t                z -= cells.length;\n\n\t                cells.forEach(function(cell, index) {\n\t                    cell.set('z', z + index, opt);\n\t                });\n\n\t                this.stopBatch('to-back');\n\t            }\n\t        }\n\n\t        return this;\n\t    },\n\n\t    parent: function(parent, opt) {\n\n\t        // getter\n\t        if (parent === undefined) { return this.get('parent'); }\n\t        // setter\n\t        return this.set('parent', parent, opt);\n\t    },\n\n\t    embed: function(cell, opt) {\n\t        var cells = Array.isArray(cell) ? cell : [cell];\n\t        if (!this.canEmbed(cells)) {\n\t            throw new Error('Recursive embedding not allowed.');\n\t        }\n\t        this._embedCells(cells, opt);\n\t        return this;\n\t    },\n\n\t    unembed: function(cell, opt) {\n\t        var cells = Array.isArray(cell) ? cell : [cell];\n\t        this._unembedCells(cells, opt);\n\t        return this;\n\t    },\n\n\t    canEmbed: function(cell) {\n\t        var this$1 = this;\n\n\t        var cells = Array.isArray(cell) ? cell : [cell];\n\t        return cells.every(function (c) { return this$1 !== c && !this$1.isEmbeddedIn(c); });\n\t    },\n\n\t    _embedCells: function(cells, opt) {\n\t        var this$1 = this;\n\n\t        var batchName = 'embed';\n\t        this.startBatch(batchName);\n\t        var embeds = assign([], this.get('embeds'));\n\t        cells.forEach(function (cell) {\n\t            // We keep all element ids after link ids.\n\t            embeds[cell.isLink() ? 'unshift' : 'push'](cell.id);\n\t            cell.parent(this$1.id, opt);\n\t        });\n\t        this.set('embeds', uniq(embeds), opt);\n\t        this.stopBatch(batchName);\n\t    },\n\n\t    _unembedCells: function(cells, opt) {\n\t        var batchName = 'unembed';\n\t        this.startBatch(batchName);\n\t        cells.forEach(function (cell) { return cell.unset('parent', opt); });\n\t        this.set('embeds', without.apply(void 0, [ this.get('embeds') ].concat( cells.map(function (cell) { return cell.id; }) )), opt);\n\t        this.stopBatch(batchName);\n\t    },\n\n\t    getParentCell: function() {\n\n\t        // unlike link.source/target, cell.parent stores id directly as a string\n\t        var parentId = this.parent();\n\t        var graph = this.graph;\n\n\t        return (parentId && graph && graph.getCell(parentId)) || null;\n\t    },\n\n\t    // Return an array of ancestor cells.\n\t    // The array is ordered from the parent of the cell\n\t    // to the most distant ancestor.\n\t    getAncestors: function() {\n\n\t        var ancestors = [];\n\n\t        if (!this.graph) {\n\t            return ancestors;\n\t        }\n\n\t        var parentCell = this.getParentCell();\n\t        while (parentCell) {\n\t            ancestors.push(parentCell);\n\t            parentCell = parentCell.getParentCell();\n\t        }\n\n\t        return ancestors;\n\t    },\n\n\t    getEmbeddedCells: function(opt) {\n\n\t        opt = opt || {};\n\n\t        // Cell models can only be retrieved when this element is part of a collection.\n\t        // There is no way this element knows about other cells otherwise.\n\t        // This also means that calling e.g. `translate()` on an element with embeds before\n\t        // adding it to a graph does not translate its embeds.\n\t        if (this.graph) {\n\n\t            var cells;\n\n\t            if (opt.deep) {\n\n\t                if (opt.breadthFirst) {\n\n\t                    // breadthFirst algorithm\n\t                    cells = [];\n\t                    var queue = this.getEmbeddedCells();\n\n\t                    while (queue.length > 0) {\n\n\t                        var parent = queue.shift();\n\t                        cells.push(parent);\n\t                        queue.push.apply(queue, parent.getEmbeddedCells());\n\t                    }\n\n\t                } else {\n\n\t                    // depthFirst algorithm\n\t                    cells = this.getEmbeddedCells();\n\t                    cells.forEach(function(cell) {\n\t                        cells.push.apply(cells, cell.getEmbeddedCells(opt));\n\t                    });\n\t                }\n\n\t            } else {\n\n\t                cells = toArray(this.get('embeds')).map(this.graph.getCell, this.graph);\n\t            }\n\n\t            return cells;\n\t        }\n\t        return [];\n\t    },\n\n\t    isEmbeddedIn: function(cell, opt) {\n\n\t        var cellId = isString(cell) ? cell : cell.id;\n\t        var parentId = this.parent();\n\n\t        opt = defaults({ deep: true }, opt);\n\n\t        // See getEmbeddedCells().\n\t        if (this.graph && opt.deep) {\n\n\t            while (parentId) {\n\t                if (parentId === cellId) {\n\t                    return true;\n\t                }\n\t                parentId = this.graph.getCell(parentId).parent();\n\t            }\n\n\t            return false;\n\n\t        } else {\n\n\t            // When this cell is not part of a collection check\n\t            // at least whether it's a direct child of given cell.\n\t            return parentId === cellId;\n\t        }\n\t    },\n\n\t    // Whether or not the cell is embedded in any other cell.\n\t    isEmbedded: function() {\n\n\t        return !!this.parent();\n\t    },\n\n\t    // Isolated cloning. Isolated cloning has two versions: shallow and deep (pass `{ deep: true }` in `opt`).\n\t    // Shallow cloning simply clones the cell and returns a new cell with different ID.\n\t    // Deep cloning clones the cell and all its embedded cells recursively.\n\t    clone: function(opt) {\n\n\t        opt = opt || {};\n\n\t        if (!opt.deep) {\n\t            // Shallow cloning.\n\n\t            var clone = Backbone.Model.prototype.clone.apply(this, arguments);\n\t            // We don't want the clone to have the same ID as the original.\n\t            clone.set(this.getIdAttribute(), this.generateId());\n\t            // A shallow cloned element does not carry over the original embeds.\n\t            clone.unset('embeds');\n\t            // And can not be embedded in any cell\n\t            // as the clone is not part of the graph.\n\t            clone.unset('parent');\n\n\t            return clone;\n\n\t        } else {\n\t            // Deep cloning.\n\n\t            // For a deep clone, simply call `graph.cloneCells()` with the cell and all its embedded cells.\n\t            return toArray(cloneCells([this].concat(this.getEmbeddedCells({ deep: true }))));\n\t        }\n\t    },\n\n\t    // A convenient way to set nested properties.\n\t    // This method merges the properties you'd like to set with the ones\n\t    // stored in the cell and makes sure change events are properly triggered.\n\t    // You can either set a nested property with one object\n\t    // or use a property path.\n\t    // The most simple use case is:\n\t    // `cell.prop('name/first', 'John')` or\n\t    // `cell.prop({ name: { first: 'John' } })`.\n\t    // Nested arrays are supported too:\n\t    // `cell.prop('series/0/data/0/degree', 50)` or\n\t    // `cell.prop({ series: [ { data: [ { degree: 50 } ] } ] })`.\n\t    prop: function(props, value, opt) {\n\n\t        var delim = '/';\n\t        var _isString = isString(props);\n\n\t        if (_isString || Array.isArray(props)) {\n\t            // Get/set an attribute by a special path syntax that delimits\n\t            // nested objects by the colon character.\n\n\t            if (arguments.length > 1) {\n\n\t                var path;\n\t                var pathArray;\n\n\t                if (_isString) {\n\t                    path = props;\n\t                    pathArray = path.split('/');\n\t                } else {\n\t                    path = props.join(delim);\n\t                    pathArray = props.slice();\n\t                }\n\n\t                var property = pathArray[0];\n\t                var pathArrayLength = pathArray.length;\n\n\t                opt = opt || {};\n\t                opt.propertyPath = path;\n\t                opt.propertyValue = value;\n\t                opt.propertyPathArray = pathArray;\n\n\t                if (pathArrayLength === 1) {\n\t                    // Property is not nested. We can simply use `set()`.\n\t                    return this.set(property, value, opt);\n\t                }\n\n\t                var update = {};\n\t                // Initialize the nested object. Subobjects are either arrays or objects.\n\t                // An empty array is created if the sub-key is an integer. Otherwise, an empty object is created.\n\t                // Note that this imposes a limitation on object keys one can use with Inspector.\n\t                // Pure integer keys will cause issues and are therefore not allowed.\n\t                var initializer = update;\n\t                var prevProperty = property;\n\n\t                for (var i = 1; i < pathArrayLength; i++) {\n\t                    var pathItem = pathArray[i];\n\t                    var isArrayIndex = Number.isFinite(_isString ? Number(pathItem) : pathItem);\n\t                    initializer = initializer[prevProperty] = isArrayIndex ? [] : {};\n\t                    prevProperty = pathItem;\n\t                }\n\n\t                // Fill update with the `value` on `path`.\n\t                update = setByPath(update, pathArray, value, '/');\n\n\t                var baseAttributes = merge({}, this.attributes);\n\t                // if rewrite mode enabled, we replace value referenced by path with\n\t                // the new one (we don't merge).\n\t                opt.rewrite && unsetByPath(baseAttributes, path, '/');\n\n\t                // Merge update with the model attributes.\n\t                var attributes = merge(baseAttributes, update);\n\t                // Finally, set the property to the updated attributes.\n\t                return this.set(property, attributes[property], opt);\n\n\t            } else {\n\n\t                return getByPath(this.attributes, props, delim);\n\t            }\n\t        }\n\n\t        return this.set(merge({}, this.attributes, props), value);\n\t    },\n\n\t    // A convenient way to unset nested properties\n\t    removeProp: function(path, opt) {\n\n\t        opt = opt || {};\n\n\t        var pathArray = Array.isArray(path) ? path : path.split('/');\n\n\t        // Once a property is removed from the `attrs` attribute\n\t        // the cellView will recognize a `dirty` flag and re-render itself\n\t        // in order to remove the attribute from SVG element.\n\t        var property = pathArray[0];\n\t        if (property === 'attrs') { opt.dirty = true; }\n\n\t        if (pathArray.length === 1) {\n\t            // A top level property\n\t            return this.unset(path, opt);\n\t        }\n\n\t        // A nested property\n\t        var nestedPath = pathArray.slice(1);\n\t        var propertyValue = cloneDeep(this.get(property));\n\n\t        unsetByPath(propertyValue, nestedPath, '/');\n\n\t        return this.set(property, propertyValue, opt);\n\t    },\n\n\t    // A convenient way to set nested attributes.\n\t    attr: function(attrs, value, opt) {\n\n\t        var args = Array.from(arguments);\n\t        if (args.length === 0) {\n\t            return this.get('attrs');\n\t        }\n\n\t        if (Array.isArray(attrs)) {\n\t            args[0] = ['attrs'].concat(attrs);\n\t        } else if (isString(attrs)) {\n\t            // Get/set an attribute by a special path syntax that delimits\n\t            // nested objects by the colon character.\n\t            args[0] = 'attrs/' + attrs;\n\n\t        } else {\n\n\t            args[0] = { 'attrs' : attrs };\n\t        }\n\n\t        return this.prop.apply(this, args);\n\t    },\n\n\t    // A convenient way to unset nested attributes\n\t    removeAttr: function(path, opt) {\n\n\t        if (Array.isArray(path)) {\n\n\t            return this.removeProp(['attrs'].concat(path));\n\t        }\n\n\t        return this.removeProp('attrs/' + path, opt);\n\t    },\n\n\t    transition: function(path, value, opt, delim) {\n\t        var this$1 = this;\n\n\n\t        delim = delim || '/';\n\n\t        var defaults = {\n\t            duration: 100,\n\t            delay: 10,\n\t            timingFunction: timing.linear,\n\t            valueFunction: interpolate.number\n\t        };\n\n\t        opt = assign(defaults, opt);\n\n\t        var firstFrameTime = 0;\n\t        var interpolatingFunction;\n\n\t        var setter = function(runtime) {\n\n\t            var id, progress, propertyValue;\n\n\t            firstFrameTime = firstFrameTime || runtime;\n\t            runtime -= firstFrameTime;\n\t            progress = runtime / opt.duration;\n\n\t            if (progress < 1) {\n\t                this._transitionIds[path] = id = nextFrame(setter);\n\t            } else {\n\t                progress = 1;\n\t                delete this._transitionIds[path];\n\t            }\n\n\t            propertyValue = interpolatingFunction(opt.timingFunction(progress));\n\n\t            opt.transitionId = id;\n\n\t            this.prop(path, propertyValue, opt);\n\n\t            if (!id) { this.trigger('transition:end', this, path); }\n\n\t        }.bind(this);\n\n\t        var ref = this;\n\t        var _scheduledTransitionIds = ref._scheduledTransitionIds;\n\t        var initialId;\n\n\t        var initiator = function (callback) {\n\n\t            if (_scheduledTransitionIds[path]) {\n\t                _scheduledTransitionIds[path] = without(_scheduledTransitionIds[path], initialId);\n\t                if (_scheduledTransitionIds[path].length === 0) {\n\t                    delete _scheduledTransitionIds[path];\n\t                }\n\t            }\n\n\t            this$1.stopPendingTransitions(path, delim);\n\n\t            interpolatingFunction = opt.valueFunction(getByPath(this$1.attributes, path, delim), value);\n\n\t            this$1._transitionIds[path] = nextFrame(callback);\n\n\t            this$1.trigger('transition:start', this$1, path);\n\n\t        };\n\n\t        initialId = setTimeout(initiator, opt.delay, setter);\n\n\t        _scheduledTransitionIds[path] || (_scheduledTransitionIds[path] = []);\n\t        _scheduledTransitionIds[path].push(initialId);\n\n\t        return initialId;\n\t    },\n\n\t    getTransitions: function() {\n\t        return union(\n\t            Object.keys(this._transitionIds),\n\t            Object.keys(this._scheduledTransitionIds)\n\t        );\n\t    },\n\n\t    stopScheduledTransitions: function(path, delim) {\n\t        if ( delim === void 0 ) delim = '/';\n\n\t        var ref = this;\n\t        var _scheduledTransitionIds = ref._scheduledTransitionIds; if ( _scheduledTransitionIds === void 0 ) _scheduledTransitionIds = {};\n\t        var transitions = Object.keys(_scheduledTransitionIds);\n\t        if (path) {\n\t            var pathArray = path.split(delim);\n\t            transitions = transitions.filter(function (key) {\n\t                return isEqual(pathArray, key.split(delim).slice(0, pathArray.length));\n\t            });\n\t        }\n\t        transitions.forEach(function (key) {\n\t            var transitionIds = _scheduledTransitionIds[key];\n\t            // stop the initiator\n\t            transitionIds.forEach(function (transitionId) { return clearTimeout(transitionId); });\n\t            delete _scheduledTransitionIds[key];\n\t            // Note: we could trigger transition:cancel` event here\n\t        });\n\t        return this;\n\t    },\n\n\t    stopPendingTransitions: function stopPendingTransitions(path, delim) {\n\t        var this$1 = this;\n\t        if ( delim === void 0 ) delim = '/';\n\n\t        var ref = this;\n\t        var _transitionIds = ref._transitionIds; if ( _transitionIds === void 0 ) _transitionIds = {};\n\t        var transitions = Object.keys(_transitionIds);\n\t        if (path) {\n\t            var pathArray = path.split(delim);\n\t            transitions = transitions.filter(function (key) {\n\t                return isEqual(pathArray, key.split(delim).slice(0, pathArray.length));\n\t            });\n\t        }\n\t        transitions.forEach(function (key) {\n\t            var transitionId = _transitionIds[key];\n\t            // stop the setter\n\t            cancelFrame(transitionId);\n\t            delete _transitionIds[key];\n\t            this$1.trigger('transition:end', this$1, key);\n\t        });\n\t    },\n\n\t    stopTransitions: function(path, delim) {\n\t        if ( delim === void 0 ) delim = '/';\n\n\t        this.stopScheduledTransitions(path, delim);\n\t        this.stopPendingTransitions(path, delim);\n\t        return this;\n\t    },\n\n\t    // A shorcut making it easy to create constructs like the following:\n\t    // `var el = (new joint.shapes.basic.Rect).addTo(graph)`.\n\t    addTo: function(graph, opt) {\n\n\t        graph.addCell(this, opt);\n\t        return this;\n\t    },\n\n\t    // A shortcut for an equivalent call: `paper.findViewByModel(cell)`\n\t    // making it easy to create constructs like the following:\n\t    // `cell.findView(paper).highlight()`\n\t    findView: function(paper) {\n\n\t        return paper.findViewByModel(this);\n\t    },\n\n\t    isElement: function() {\n\n\t        return false;\n\t    },\n\n\t    isLink: function() {\n\n\t        return false;\n\t    },\n\n\t    startBatch: function(name, opt) {\n\n\t        if (this.graph) { this.graph.startBatch(name, assign({}, opt, { cell: this })); }\n\t        return this;\n\t    },\n\n\t    stopBatch: function(name, opt) {\n\n\t        if (this.graph) { this.graph.stopBatch(name, assign({}, opt, { cell: this })); }\n\t        return this;\n\t    },\n\n\t    getChangeFlag: function(attributes) {\n\n\t        var flag = 0;\n\t        if (!attributes) { return flag; }\n\t        for (var key in attributes) {\n\t            if (!attributes.hasOwnProperty(key) || !this.hasChanged(key)) { continue; }\n\t            flag |= attributes[key];\n\t        }\n\t        return flag;\n\t    },\n\n\t    angle: function() {\n\n\t        // To be overridden.\n\t        return 0;\n\t    },\n\n\t    position: function() {\n\n\t        // To be overridden.\n\t        return new Point(0, 0);\n\t    },\n\n\t    getPointFromConnectedLink: function() {\n\n\t        // To be overridden\n\t        return new Point();\n\t    },\n\n\t    getBBox: function() {\n\n\t        // To be overridden\n\t        return new Rect(0, 0, 0, 0);\n\t    },\n\n\t    getPointRotatedAroundCenter: function getPointRotatedAroundCenter(angle, x, y) {\n\t        var point = new Point(x, y);\n\t        if (angle) { point.rotate(this.getBBox().center(), angle); }\n\t        return point;\n\t    },\n\n\t    getAbsolutePointFromRelative: function getAbsolutePointFromRelative(x, y) {\n\t        // Rotate the position to take the model angle into account\n\t        return this.getPointRotatedAroundCenter(\n\t            -this.angle(),\n\t            // Transform the relative position to absolute\n\t            this.position().offset(x, y)\n\t        );\n\t    },\n\n\t    getRelativePointFromAbsolute: function getRelativePointFromAbsolute(x, y) {\n\t        return this\n\t            // Rotate the coordinates to mitigate the element's rotation.\n\t            .getPointRotatedAroundCenter(this.angle(), x, y)\n\t            // Transform the absolute position into relative\n\t            .difference(this.position());\n\t    }\n\n\t}, {\n\n\t    getAttributeDefinition: function(attrName) {\n\n\t        var defNS = this.attributes;\n\t        var globalDefNS = attributes;\n\t        return (defNS && defNS[attrName]) || globalDefNS[attrName];\n\t    },\n\n\t    define: function(type, defaults, protoProps, staticProps) {\n\n\t        protoProps = assign({\n\t            defaults: defaultsDeep({ type: type }, defaults, this.prototype.defaults)\n\t        }, protoProps);\n\n\t        var Cell = this.extend(protoProps, staticProps);\n\t        // es5 backward compatibility\n\t        /* eslint-disable no-undef */\n\t        if (typeof joint !== 'undefined' && has$2(joint, 'shapes')) {\n\t            setByPath(joint.shapes, type, Cell, '.');\n\t        }\n\t        /* eslint-enable no-undef */\n\t        return Cell;\n\t    }\n\t});\n\n\tvar wrapWith = function(object, methods, wrapper) {\n\n\t    if (isString(wrapper)) {\n\n\t        if (!wrappers[wrapper]) {\n\t            throw new Error('Unknown wrapper: \"' + wrapper + '\"');\n\t        }\n\n\t        wrapper = wrappers[wrapper];\n\t    }\n\n\t    if (!isFunction(wrapper)) {\n\t        throw new Error('Wrapper must be a function.');\n\t    }\n\n\t    toArray(methods).forEach(function(method) {\n\t        object[method] = wrapper(object[method]);\n\t    });\n\t};\n\n\tvar wrappers = {\n\n\t    cells: function(fn) {\n\n\t        return function() {\n\n\t            var args = Array.from(arguments);\n\t            var n = args.length;\n\t            var cells = n > 0 && args[0] || [];\n\t            var opt = n > 1 && args[n - 1] || {};\n\n\t            if (!Array.isArray(cells)) {\n\n\t                if (opt instanceof Cell) {\n\t                    cells = args;\n\t                } else if (cells instanceof Cell) {\n\t                    if (args.length > 1) {\n\t                        args.pop();\n\t                    }\n\t                    cells = args;\n\t                }\n\t            }\n\n\t            if (opt instanceof Cell) {\n\t                opt = {};\n\t            }\n\n\t            return fn.call(this, cells, opt);\n\t        };\n\t    }\n\n\t};\n\n\n\n\tvar index = ({\n\t\twrapWith: wrapWith,\n\t\twrappers: wrappers,\n\t\taddClassNamePrefix: addClassNamePrefix,\n\t\tremoveClassNamePrefix: removeClassNamePrefix,\n\t\tparseDOMJSON: parseDOMJSON,\n\t\thashCode: hashCode,\n\t\tgetByPath: getByPath,\n\t\tsetByPath: setByPath,\n\t\tunsetByPath: unsetByPath,\n\t\tflattenObject: flattenObject,\n\t\tuuid: uuid,\n\t\tguid: guid,\n\t\ttoKebabCase: toKebabCase,\n\t\tnormalizeEvent: normalizeEvent,\n\t\tnextFrame: nextFrame,\n\t\tcancelFrame: cancelFrame,\n\t\tshapePerimeterConnectionPoint: shapePerimeterConnectionPoint,\n\t\tisPercentage: isPercentage,\n\t\tparseCssNumeric: parseCssNumeric,\n\t\tbreakText: breakText,\n\t\tsanitizeHTML: sanitizeHTML,\n\t\tdownloadBlob: downloadBlob,\n\t\tdownloadDataUri: downloadDataUri,\n\t\tdataUriToBlob: dataUriToBlob,\n\t\timageToDataUri: imageToDataUri,\n\t\tgetElementBBox: getElementBBox,\n\t\tsortElements: sortElements,\n\t\tsetAttributesBySelector: setAttributesBySelector,\n\t\tnormalizeSides: normalizeSides,\n\t\ttiming: timing,\n\t\tinterpolate: interpolate,\n\t\tfilter: filter,\n\t\tformat: format,\n\t\ttemplate: template,\n\t\ttoggleFullScreen: toggleFullScreen,\n\t\tmixin: mixin,\n\t\tsupplement: supplement,\n\t\tdeepMixin: deepMixin,\n\t\tdeepSupplement: deepSupplement,\n\t\tassign: assign,\n\t\tdefaults: defaults,\n\t\tdefaultsDeep: defaultsDeep,\n\t\tinvoke: invoke,\n\t\tsortedIndex: sortedIndex,\n\t\tuniq: uniq,\n\t\tclone: clone,\n\t\tcloneDeep: cloneDeep,\n\t\tisEmpty: isEmpty,\n\t\tisEqual: isEqual,\n\t\tisFunction: isFunction,\n\t\tisPlainObject: isPlainObject,\n\t\ttoArray: toArray,\n\t\tdebounce: debounce,\n\t\tgroupBy: groupBy,\n\t\tsortBy: sortBy,\n\t\tflattenDeep: flattenDeep,\n\t\twithout: without,\n\t\tdifference: difference,\n\t\tintersection: intersection$1,\n\t\tunion: union,\n\t\thas: has$2,\n\t\tresult: result,\n\t\tomit: omit,\n\t\tpick: pick,\n\t\tbindAll: bindAll,\n\t\tforIn: forIn,\n\t\tcamelCase: camelCase,\n\t\tuniqueId: uniqueId,\n\t\tmerge: merge,\n\t\tisBoolean: isBoolean,\n\t\tisObject: isObject$1,\n\t\tisNumber: isNumber,\n\t\tisString: isString,\n\t\tnoop: noop,\n\t\tcloneCells: cloneCells\n\t});\n\n\tfunction portTransformAttrs(point, angle, opt) {\n\n\t    var trans = point.toJSON();\n\n\t    trans.angle = angle || 0;\n\n\t    return defaults({}, opt, trans);\n\t}\n\n\tfunction lineLayout(ports, p1, p2) {\n\t    return ports.map(function(port, index, ports) {\n\t        var p = this.pointAt(((index + 0.5) / ports.length));\n\t        // `dx`,`dy` per port offset option\n\t        if (port.dx || port.dy) {\n\t            p.offset(port.dx || 0, port.dy || 0);\n\t        }\n\n\t        return portTransformAttrs(p.round(), 0, port);\n\t    }, line(p1, p2));\n\t}\n\n\tfunction ellipseLayout(ports, elBBox, startAngle, stepFn) {\n\n\t    var center = elBBox.center();\n\t    var ratio = elBBox.width / elBBox.height;\n\t    var p1 = elBBox.topMiddle();\n\n\t    var ellipse = Ellipse.fromRect(elBBox);\n\n\t    return ports.map(function(port, index, ports) {\n\n\t        var angle = startAngle + stepFn(index, ports.length);\n\t        var p2 = p1.clone()\n\t            .rotate(center, -angle)\n\t            .scale(ratio, 1, center);\n\n\t        var theta = port.compensateRotation ? -ellipse.tangentTheta(p2) : 0;\n\n\t        // `dx`,`dy` per port offset option\n\t        if (port.dx || port.dy) {\n\t            p2.offset(port.dx || 0, port.dy || 0);\n\t        }\n\n\t        // `dr` delta radius option\n\t        if (port.dr) {\n\t            p2.move(center, port.dr);\n\t        }\n\n\t        return portTransformAttrs(p2.round(), theta, port);\n\t    });\n\t}\n\n\t// Creates a point stored in arguments\n\tfunction argPoint(bbox, args) {\n\n\t    var x = args.x;\n\t    if (isString(x)) {\n\t        x = parseFloat(x) / 100 * bbox.width;\n\t    }\n\n\t    var y = args.y;\n\t    if (isString(y)) {\n\t        y = parseFloat(y) / 100 * bbox.height;\n\t    }\n\n\t    return point(x || 0, y || 0);\n\t}\n\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar absolute = function(ports, elBBox, opt) {\n\t    //TODO v.talas angle\n\t    return ports.map(argPoint.bind(null, elBBox));\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar fn = function(ports, elBBox, opt) {\n\t    return opt.fn(ports, elBBox, opt);\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar line$1 = function(ports, elBBox, opt) {\n\n\t    var start = argPoint(elBBox, opt.start || elBBox.origin());\n\t    var end = argPoint(elBBox, opt.end || elBBox.corner());\n\n\t    return lineLayout(ports, start, end);\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar left = function(ports, elBBox, opt) {\n\t    return lineLayout(ports, elBBox.origin(), elBBox.bottomLeft());\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar right = function(ports, elBBox, opt) {\n\t    return lineLayout(ports, elBBox.topRight(), elBBox.corner());\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar top = function(ports, elBBox, opt) {\n\t    return lineLayout(ports, elBBox.origin(), elBBox.topRight());\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar bottom = function(ports, elBBox, opt) {\n\t    return lineLayout(ports, elBBox.bottomLeft(), elBBox.corner());\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar ellipseSpread = function(ports, elBBox, opt) {\n\n\t    var startAngle = opt.startAngle || 0;\n\t    var stepAngle = opt.step || 360 / ports.length;\n\n\t    return ellipseLayout(ports, elBBox, startAngle, function(index) {\n\t        return index * stepAngle;\n\t    });\n\t};\n\n\t/**\n\t * @param {Array<Object>} ports\n\t * @param {g.Rect} elBBox\n\t * @param {Object=} opt Group options\n\t * @returns {Array<g.Point>}\n\t */\n\tvar ellipse$1 = function(ports, elBBox, opt) {\n\n\t    var startAngle = opt.startAngle || 0;\n\t    var stepAngle = opt.step || 20;\n\n\t    return ellipseLayout(ports, elBBox, startAngle, function(index, count) {\n\t        return (index + 0.5 - count / 2) * stepAngle;\n\t    });\n\t};\n\n\tvar Port = ({\n\t\tabsolute: absolute,\n\t\tfn: fn,\n\t\tline: line$1,\n\t\tleft: left,\n\t\tright: right,\n\t\ttop: top,\n\t\tbottom: bottom,\n\t\tellipseSpread: ellipseSpread,\n\t\tellipse: ellipse$1\n\t});\n\n\tfunction labelAttributes(opt1, opt2) {\n\n\t    return defaultsDeep({}, opt1, opt2, {\n\t        x: 0,\n\t        y: 0,\n\t        angle: 0,\n\t        attrs: {\n\t            '.': {\n\t                y: '0',\n\t                'text-anchor': 'start'\n\t            }\n\t        }\n\t    });\n\t}\n\n\tfunction outsideLayout(portPosition, elBBox, autoOrient, opt) {\n\n\t    opt = defaults({}, opt, { offset: 15 });\n\t    var angle = elBBox.center().theta(portPosition);\n\t    var x = getBBoxAngles(elBBox);\n\n\t    var tx, ty, y, textAnchor;\n\t    var offset = opt.offset;\n\t    var orientAngle = 0;\n\n\t    if (angle < x[1] || angle > x[2]) {\n\t        y = '.3em';\n\t        tx = offset;\n\t        ty = 0;\n\t        textAnchor = 'start';\n\t    } else if (angle < x[0]) {\n\t        y = '0';\n\t        tx = 0;\n\t        ty = -offset;\n\t        if (autoOrient) {\n\t            orientAngle = -90;\n\t            textAnchor = 'start';\n\t        } else {\n\t            textAnchor = 'middle';\n\t        }\n\t    } else if (angle < x[3]) {\n\t        y = '.3em';\n\t        tx = -offset;\n\t        ty = 0;\n\t        textAnchor = 'end';\n\t    } else {\n\t        y = '.6em';\n\t        tx = 0;\n\t        ty = offset;\n\t        if (autoOrient) {\n\t            orientAngle = 90;\n\t            textAnchor = 'start';\n\t        } else {\n\t            textAnchor = 'middle';\n\t        }\n\t    }\n\n\t    var round = Math.round;\n\t    return labelAttributes({\n\t        x: round(tx),\n\t        y: round(ty),\n\t        angle: orientAngle,\n\t        attrs: {\n\t            '.': {\n\t                y: y,\n\t                'text-anchor': textAnchor\n\t            }\n\t        }\n\t    });\n\t}\n\n\tfunction getBBoxAngles(elBBox) {\n\n\t    var center = elBBox.center();\n\n\t    var tl = center.theta(elBBox.origin());\n\t    var bl = center.theta(elBBox.bottomLeft());\n\t    var br = center.theta(elBBox.corner());\n\t    var tr = center.theta(elBBox.topRight());\n\n\t    return [tl, tr, br, bl];\n\t}\n\n\tfunction insideLayout(portPosition, elBBox, autoOrient, opt) {\n\n\t    var angle = elBBox.center().theta(portPosition);\n\t    opt = defaults({}, opt, { offset: 15 });\n\n\t    var tx, ty, y, textAnchor;\n\t    var offset = opt.offset;\n\t    var orientAngle = 0;\n\n\t    var bBoxAngles = getBBoxAngles(elBBox);\n\n\t    if (angle < bBoxAngles[1] || angle > bBoxAngles[2]) {\n\t        y = '.3em';\n\t        tx = -offset;\n\t        ty = 0;\n\t        textAnchor = 'end';\n\t    } else if (angle < bBoxAngles[0]) {\n\t        y = '.6em';\n\t        tx = 0;\n\t        ty = offset;\n\t        if (autoOrient) {\n\t            orientAngle = 90;\n\t            textAnchor = 'start';\n\t        } else {\n\t            textAnchor = 'middle';\n\t        }\n\t    } else if (angle < bBoxAngles[3]) {\n\t        y = '.3em';\n\t        tx = offset;\n\t        ty = 0;\n\t        textAnchor = 'start';\n\t    } else {\n\t        y = '0em';\n\t        tx = 0;\n\t        ty = -offset;\n\t        if (autoOrient) {\n\t            orientAngle = -90;\n\t            textAnchor = 'start';\n\t        } else {\n\t            textAnchor = 'middle';\n\t        }\n\t    }\n\n\t    var round = Math.round;\n\t    return labelAttributes({\n\t        x: round(tx),\n\t        y: round(ty),\n\t        angle: orientAngle,\n\t        attrs: {\n\t            '.': {\n\t                y: y,\n\t                'text-anchor': textAnchor\n\t            }\n\t        }\n\t    });\n\t}\n\n\tfunction radialLayout(portCenterOffset, autoOrient, opt) {\n\n\t    opt = defaults({}, opt, { offset: 20 });\n\n\t    var origin = point(0, 0);\n\t    var angle = -portCenterOffset.theta(origin);\n\t    var orientAngle = angle;\n\t    var offset = portCenterOffset.clone()\n\t        .move(origin, opt.offset)\n\t        .difference(portCenterOffset)\n\t        .round();\n\n\t    var y = '.3em';\n\t    var textAnchor;\n\n\t    if ((angle + 90) % 180 === 0) {\n\t        textAnchor = autoOrient ? 'end' : 'middle';\n\t        if (!autoOrient && angle === -270) {\n\t            y = '0em';\n\t        }\n\t    } else if (angle > -270 && angle < -90) {\n\t        textAnchor = 'start';\n\t        orientAngle = angle - 180;\n\t    } else {\n\t        textAnchor = 'end';\n\t    }\n\n\t    var round = Math.round;\n\t    return labelAttributes({\n\t        x: round(offset.x),\n\t        y: round(offset.y),\n\t        angle: autoOrient ? orientAngle : 0,\n\t        attrs: {\n\t            '.': {\n\t                y: y,\n\t                'text-anchor': textAnchor\n\t            }\n\t        }\n\t    });\n\t}\n\n\tvar manual = function(portPosition, elBBox, opt) {\n\t    return labelAttributes(opt, elBBox);\n\t};\n\n\tvar left$1 = function(portPosition, elBBox, opt) {\n\t    return labelAttributes(opt, { x: -15, attrs: { '.': { y: '.3em', 'text-anchor': 'end' }}});\n\t};\n\n\tvar right$1 = function(portPosition, elBBox, opt) {\n\t    return labelAttributes(opt, { x: 15, attrs: { '.': { y: '.3em', 'text-anchor': 'start' }}});\n\t};\n\n\tvar top$1 = function(portPosition, elBBox, opt) {\n\t    return labelAttributes(opt, { y: -15, attrs: { '.': { 'text-anchor': 'middle' }}});\n\t};\n\n\tvar bottom$1 = function(portPosition, elBBox, opt) {\n\t    return labelAttributes(opt, { y: 15, attrs: { '.': { y: '.6em', 'text-anchor': 'middle' }}});\n\t};\n\n\tvar outsideOriented = function(portPosition, elBBox, opt) {\n\t    return outsideLayout(portPosition, elBBox, true, opt);\n\t};\n\n\tvar outside = function(portPosition, elBBox, opt) {\n\t    return outsideLayout(portPosition, elBBox, false, opt);\n\t};\n\n\tvar insideOriented = function(portPosition, elBBox, opt) {\n\t    return insideLayout(portPosition, elBBox, true, opt);\n\t};\n\n\tvar inside = function(portPosition, elBBox, opt) {\n\t    return insideLayout(portPosition, elBBox, false, opt);\n\t};\n\n\tvar radial = function(portPosition, elBBox, opt) {\n\t    return radialLayout(portPosition.difference(elBBox.center()), false, opt);\n\t};\n\n\tvar radialOriented = function(portPosition, elBBox, opt) {\n\t    return radialLayout(portPosition.difference(elBBox.center()), true, opt);\n\t};\n\n\tvar PortLabel = ({\n\t\tmanual: manual,\n\t\tleft: left$1,\n\t\tright: right$1,\n\t\ttop: top$1,\n\t\tbottom: bottom$1,\n\t\toutsideOriented: outsideOriented,\n\t\toutside: outside,\n\t\tinsideOriented: insideOriented,\n\t\tinside: inside,\n\t\tradial: radial,\n\t\tradialOriented: radialOriented\n\t});\n\n\t// Link base model.\n\t// --------------------------\n\n\tvar Link = Cell.extend({\n\n\t    // The default markup for links.\n\t    markup: [\n\t        '<path class=\"connection\" stroke=\"black\" d=\"M 0 0 0 0\"/>',\n\t        '<path class=\"marker-source\" fill=\"black\" stroke=\"black\" d=\"M 0 0 0 0\"/>',\n\t        '<path class=\"marker-target\" fill=\"black\" stroke=\"black\" d=\"M 0 0 0 0\"/>',\n\t        '<path class=\"connection-wrap\" d=\"M 0 0 0 0\"/>',\n\t        '<g class=\"labels\"/>',\n\t        '<g class=\"marker-vertices\"/>',\n\t        '<g class=\"marker-arrowheads\"/>',\n\t        '<g class=\"link-tools\"/>'\n\t    ].join(''),\n\n\t    toolMarkup: [\n\t        '<g class=\"link-tool\">',\n\t        '<g class=\"tool-remove\" event=\"remove\">',\n\t        '<circle r=\"11\" />',\n\t        '<path transform=\"scale(.8) translate(-16, -16)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\" />',\n\t        '<title>Remove link.</title>',\n\t        '</g>',\n\t        '<g class=\"tool-options\" event=\"link:options\">',\n\t        '<circle r=\"11\" transform=\"translate(25)\"/>',\n\t        '<path fill=\"white\" transform=\"scale(.55) translate(29, -16)\" d=\"M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z\"/>',\n\t        '<title>Link options.</title>',\n\t        '</g>',\n\t        '</g>'\n\t    ].join(''),\n\n\t    doubleToolMarkup: undefined,\n\n\t    // The default markup for showing/removing vertices. These elements are the children of the .marker-vertices element (see `this.markup`).\n\t    // Only .marker-vertex and .marker-vertex-remove element have special meaning. The former is used for\n\t    // dragging vertices (changing their position). The latter is used for removing vertices.\n\t    vertexMarkup: [\n\t        '<g class=\"marker-vertex-group\" transform=\"translate(<%= x %>, <%= y %>)\">',\n\t        '<circle class=\"marker-vertex\" idx=\"<%= idx %>\" r=\"10\" />',\n\t        '<path class=\"marker-vertex-remove-area\" idx=\"<%= idx %>\" d=\"M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z\" transform=\"translate(5, -33)\"/>',\n\t        '<path class=\"marker-vertex-remove\" idx=\"<%= idx %>\" transform=\"scale(.8) translate(9.5, -37)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\">',\n\t        '<title>Remove vertex.</title>',\n\t        '</path>',\n\t        '</g>'\n\t    ].join(''),\n\n\t    arrowheadMarkup: [\n\t        '<g class=\"marker-arrowhead-group marker-arrowhead-group-<%= end %>\">',\n\t        '<path class=\"marker-arrowhead\" end=\"<%= end %>\" d=\"M 26 0 L 0 13 L 26 26 z\" />',\n\t        '</g>'\n\t    ].join(''),\n\n\t    // may be overwritten by user to change default label (its markup, attrs, position)\n\t    defaultLabel: undefined,\n\n\t    // deprecated\n\t    // may be overwritten by user to change default label markup\n\t    // lower priority than defaultLabel.markup\n\t    labelMarkup: undefined,\n\n\t    // private\n\t    _builtins: {\n\t        defaultLabel: {\n\t            // builtin default markup:\n\t            // used if neither defaultLabel.markup\n\t            // nor label.markup is set\n\t            markup: [\n\t                {\n\t                    tagName: 'rect',\n\t                    selector: 'rect' // faster than tagName CSS selector\n\t                }, {\n\t                    tagName: 'text',\n\t                    selector: 'text' // faster than tagName CSS selector\n\t                }\n\t            ],\n\t            // builtin default attributes:\n\t            // applied only if builtin default markup is used\n\t            attrs: {\n\t                text: {\n\t                    fill: '#000000',\n\t                    fontSize: 14,\n\t                    textAnchor: 'middle',\n\t                    yAlignment: 'middle',\n\t                    pointerEvents: 'none'\n\t                },\n\t                rect: {\n\t                    ref: 'text',\n\t                    fill: '#ffffff',\n\t                    rx: 3,\n\t                    ry: 3,\n\t                    refWidth: 1,\n\t                    refHeight: 1,\n\t                    refX: 0,\n\t                    refY: 0\n\t                }\n\t            },\n\t            // builtin default position:\n\t            // used if neither defaultLabel.position\n\t            // nor label.position is set\n\t            position: {\n\t                distance: 0.5\n\t            }\n\t        }\n\t    },\n\n\t    defaults: {\n\t        type: 'link',\n\t        source: {},\n\t        target: {}\n\t    },\n\n\t    isLink: function() {\n\n\t        return true;\n\t    },\n\n\t    disconnect: function(opt) {\n\n\t        return this.set({\n\t            source: { x: 0, y: 0 },\n\t            target: { x: 0, y: 0 }\n\t        }, opt);\n\t    },\n\n\t    source: function(source, args, opt) {\n\n\t        // getter\n\t        if (source === undefined) {\n\t            return clone(this.get('source'));\n\t        }\n\n\t        // setter\n\t        var setSource;\n\t        var setOpt;\n\n\t        // `source` is a cell\n\t        // take only its `id` and combine with `args`\n\t        var isCellProvided = source instanceof Cell;\n\t        if (isCellProvided) { // three arguments\n\t            setSource = clone(args) || {};\n\t            setSource.id = source.id;\n\t            setOpt = opt;\n\t            return this.set('source', setSource, setOpt);\n\t        }\n\n\t        // `source` is a point-like object\n\t        // for example, a g.Point\n\t        // take only its `x` and `y` and combine with `args`\n\t        var isPointProvided = !isPlainObject(source);\n\t        if (isPointProvided) { // three arguments\n\t            setSource = clone(args) || {};\n\t            setSource.x = source.x;\n\t            setSource.y = source.y;\n\t            setOpt = opt;\n\t            return this.set('source', setSource, setOpt);\n\t        }\n\n\t        // `source` is an object\n\t        // no checking\n\t        // two arguments\n\t        setSource = source;\n\t        setOpt = args;\n\t        return this.set('source', setSource, setOpt);\n\t    },\n\n\t    target: function(target, args, opt) {\n\n\t        // getter\n\t        if (target === undefined) {\n\t            return clone(this.get('target'));\n\t        }\n\n\t        // setter\n\t        var setTarget;\n\t        var setOpt;\n\n\t        // `target` is a cell\n\t        // take only its `id` argument and combine with `args`\n\t        var isCellProvided = target instanceof Cell;\n\t        if (isCellProvided) { // three arguments\n\t            setTarget = clone(args) || {};\n\t            setTarget.id = target.id;\n\t            setOpt = opt;\n\t            return this.set('target', setTarget, setOpt);\n\t        }\n\n\t        // `target` is a point-like object\n\t        // for example, a g.Point\n\t        // take only its `x` and `y` and combine with `args`\n\t        var isPointProvided = !isPlainObject(target);\n\t        if (isPointProvided) { // three arguments\n\t            setTarget = clone(args) || {};\n\t            setTarget.x = target.x;\n\t            setTarget.y = target.y;\n\t            setOpt = opt;\n\t            return this.set('target', setTarget, setOpt);\n\t        }\n\n\t        // `target` is an object\n\t        // no checking\n\t        // two arguments\n\t        setTarget = target;\n\t        setOpt = args;\n\t        return this.set('target', setTarget, setOpt);\n\t    },\n\n\t    router: function(name, args, opt) {\n\n\t        // getter\n\t        if (name === undefined) {\n\t            var router = this.get('router');\n\t            if (!router) {\n\t                if (this.get('manhattan')) { return { name: 'orthogonal' }; } // backwards compatibility\n\t                return null;\n\t            }\n\t            if (typeof router === 'object') { return clone(router); }\n\t            return router; // e.g. a function\n\t        }\n\n\t        // setter\n\t        var isRouterProvided = ((typeof name === 'object') || (typeof name === 'function'));\n\t        var localRouter = isRouterProvided ? name : { name: name, args: args };\n\t        var localOpt = isRouterProvided ? args : opt;\n\n\t        return this.set('router', localRouter, localOpt);\n\t    },\n\n\t    connector: function(name, args, opt) {\n\n\t        // getter\n\t        if (name === undefined) {\n\t            var connector = this.get('connector');\n\t            if (!connector) {\n\t                if (this.get('smooth')) { return { name: 'smooth' }; } // backwards compatibility\n\t                return null;\n\t            }\n\t            if (typeof connector === 'object') { return clone(connector); }\n\t            return connector; // e.g. a function\n\t        }\n\n\t        // setter\n\t        var isConnectorProvided = ((typeof name === 'object' || typeof name === 'function'));\n\t        var localConnector = isConnectorProvided ? name : { name: name, args: args };\n\t        var localOpt = isConnectorProvided ? args : opt;\n\n\t        return this.set('connector', localConnector, localOpt);\n\t    },\n\n\t    // Labels API\n\n\t    // A convenient way to set labels. Currently set values will be mixined with `value` if used as a setter.\n\t    label: function(idx, label, opt) {\n\n\t        var labels = this.labels();\n\n\t        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : 0;\n\t        if (idx < 0) { idx = labels.length + idx; }\n\n\t        // getter\n\t        if (arguments.length <= 1) { return this.prop(['labels', idx]); }\n\t        // setter\n\t        return this.prop(['labels', idx], label, opt);\n\t    },\n\n\t    labels: function(labels, opt) {\n\n\t        // getter\n\t        if (arguments.length === 0) {\n\t            labels = this.get('labels');\n\t            if (!Array.isArray(labels)) { return []; }\n\t            return labels.slice();\n\t        }\n\t        // setter\n\t        if (!Array.isArray(labels)) { labels = []; }\n\t        return this.set('labels', labels, opt);\n\t    },\n\n\t    hasLabels: function() {\n\t        var ref = this.attributes;\n\t        var labels = ref.labels;\n\t        return Array.isArray(labels) && labels.length > 0;\n\t    },\n\n\t    insertLabel: function(idx, label, opt) {\n\n\t        if (!label) { throw new Error('dia.Link: no label provided'); }\n\n\t        var labels = this.labels();\n\t        var n = labels.length;\n\t        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : n;\n\t        if (idx < 0) { idx = n + idx + 1; }\n\n\t        labels.splice(idx, 0, label);\n\t        return this.labels(labels, opt);\n\t    },\n\n\t    // convenience function\n\t    // add label to end of labels array\n\t    appendLabel: function(label, opt) {\n\n\t        return this.insertLabel(-1, label, opt);\n\t    },\n\n\t    removeLabel: function(idx, opt) {\n\n\t        var labels = this.labels();\n\t        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : -1;\n\n\t        labels.splice(idx, 1);\n\t        return this.labels(labels, opt);\n\t    },\n\n\t    // Vertices API\n\n\t    vertex: function(idx, vertex, opt) {\n\n\t        var vertices = this.vertices();\n\n\t        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : 0;\n\t        if (idx < 0) { idx = vertices.length + idx; }\n\n\t        // getter\n\t        if (arguments.length <= 1) { return this.prop(['vertices', idx]); }\n\n\t        // setter\n\t        var setVertex = this._normalizeVertex(vertex);\n\t        return this.prop(['vertices', idx], setVertex, opt);\n\t    },\n\n\t    vertices: function(vertices, opt) {\n\n\t        // getter\n\t        if (arguments.length === 0) {\n\t            vertices = this.get('vertices');\n\t            if (!Array.isArray(vertices)) { return []; }\n\t            return vertices.slice();\n\t        }\n\n\t        // setter\n\t        if (!Array.isArray(vertices)) { vertices = []; }\n\t        var setVertices = [];\n\t        for (var i = 0; i < vertices.length; i++) {\n\t            var vertex = vertices[i];\n\t            var setVertex = this._normalizeVertex(vertex);\n\t            setVertices.push(setVertex);\n\t        }\n\t        return this.set('vertices', setVertices, opt);\n\t    },\n\n\t    insertVertex: function(idx, vertex, opt) {\n\n\t        if (!vertex) { throw new Error('dia.Link: no vertex provided'); }\n\n\t        var vertices = this.vertices();\n\t        var n = vertices.length;\n\t        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : n;\n\t        if (idx < 0) { idx = n + idx + 1; }\n\n\t        var setVertex = this._normalizeVertex(vertex);\n\t        vertices.splice(idx, 0, setVertex);\n\t        return this.vertices(vertices, opt);\n\t    },\n\n\t    removeVertex: function(idx, opt) {\n\n\t        var vertices = this.vertices();\n\t        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : -1;\n\n\t        vertices.splice(idx, 1);\n\t        return this.vertices(vertices, opt);\n\t    },\n\n\t    _normalizeVertex: function(vertex) {\n\n\t        // is vertex a point-like object?\n\t        // for example, a g.Point\n\t        var isPointProvided = !isPlainObject(vertex);\n\t        if (isPointProvided) { return { x: vertex.x, y: vertex.y }; }\n\n\t        // else: return vertex unchanged\n\t        return vertex;\n\t    },\n\n\t    // Transformations\n\n\t    translate: function(tx, ty, opt) {\n\n\t        // enrich the option object\n\t        opt = opt || {};\n\t        opt.translateBy = opt.translateBy || this.id;\n\t        opt.tx = tx;\n\t        opt.ty = ty;\n\n\t        return this.applyToPoints(function(p) {\n\t            return { x: (p.x || 0) + tx, y: (p.y || 0) + ty };\n\t        }, opt);\n\t    },\n\n\t    scale: function(sx, sy, origin, opt) {\n\n\t        return this.applyToPoints(function(p) {\n\t            return Point(p).scale(sx, sy, origin).toJSON();\n\t        }, opt);\n\t    },\n\n\t    applyToPoints: function(fn, opt) {\n\n\t        if (!isFunction(fn)) {\n\t            throw new TypeError('dia.Link: applyToPoints expects its first parameter to be a function.');\n\t        }\n\n\t        var attrs = {};\n\n\t        var ref = this.attributes;\n\t        var source = ref.source;\n\t        var target = ref.target;\n\t        if (!source.id) {\n\t            attrs.source = fn(source);\n\t        }\n\t        if (!target.id) {\n\t            attrs.target = fn(target);\n\t        }\n\n\t        var vertices = this.vertices();\n\t        if (vertices.length > 0) {\n\t            attrs.vertices = vertices.map(fn);\n\t        }\n\n\t        return this.set(attrs, opt);\n\t    },\n\n\t    getSourcePoint: function() {\n\t        var sourceCell = this.getSourceCell();\n\t        if (!sourceCell) { return new Point(this.source()); }\n\t        return sourceCell.getPointFromConnectedLink(this, 'source');\n\t    },\n\n\t    getTargetPoint: function() {\n\t        var targetCell = this.getTargetCell();\n\t        if (!targetCell) { return new Point(this.target()); }\n\t        return targetCell.getPointFromConnectedLink(this, 'target');\n\t    },\n\n\t    getPointFromConnectedLink: function(/* link, endType */) {\n\t        return this.getPolyline().pointAt(0.5);\n\t    },\n\n\t    getPolyline: function() {\n\t        var points = [\n\t            this.getSourcePoint() ].concat( this.vertices().map(Point),\n\t            [this.getTargetPoint()]\n\t        );\n\t        return new Polyline(points);\n\t    },\n\n\t    getBBox: function() {\n\t        return this.getPolyline().bbox();\n\t    },\n\n\t    reparent: function(opt) {\n\n\t        var newParent;\n\n\t        if (this.graph) {\n\n\t            var source = this.getSourceElement();\n\t            var target = this.getTargetElement();\n\t            var prevParent = this.getParentCell();\n\n\t            if (source && target) {\n\t                if (source === target || source.isEmbeddedIn(target)) {\n\t                    newParent = target;\n\t                } else if (target.isEmbeddedIn(source)) {\n\t                    newParent = source;\n\t                } else {\n\t                    newParent = this.graph.getCommonAncestor(source, target);\n\t                }\n\t            }\n\n\t            if (prevParent && (!newParent || newParent.id !== prevParent.id)) {\n\t                // Unembed the link if source and target has no common ancestor\n\t                // or common ancestor changed\n\t                prevParent.unembed(this, opt);\n\t            }\n\n\t            if (newParent) {\n\t                newParent.embed(this, opt);\n\t            }\n\t        }\n\n\t        return newParent;\n\t    },\n\n\t    hasLoop: function(opt) {\n\n\t        opt = opt || {};\n\n\t        var ref = this.attributes;\n\t        var source = ref.source;\n\t        var target = ref.target;\n\t        var sourceId = source.id;\n\t        var targetId = target.id;\n\n\t        if (!sourceId || !targetId) {\n\t            // Link \"pinned\" to the paper does not have a loop.\n\t            return false;\n\t        }\n\n\t        var loop = sourceId === targetId;\n\n\t        // Note that there in the deep mode a link can have a loop,\n\t        // even if it connects only a parent and its embed.\n\t        // A loop \"target equals source\" is valid in both shallow and deep mode.\n\t        if (!loop && opt.deep && this.graph) {\n\n\t            var sourceElement = this.getSourceCell();\n\t            var targetElement = this.getTargetCell();\n\n\t            loop = sourceElement.isEmbeddedIn(targetElement) || targetElement.isEmbeddedIn(sourceElement);\n\t        }\n\n\t        return loop;\n\t    },\n\n\t    // unlike source(), this method returns null if source is a point\n\t    getSourceCell: function() {\n\n\t        var ref = this;\n\t        var graph = ref.graph;\n\t        var attributes = ref.attributes;\n\t        var source = attributes.source;\n\t        return (source && source.id && graph && graph.getCell(source.id)) || null;\n\t    },\n\n\t    getSourceElement: function() {\n\t        var cell = this;\n\t        var visited = {};\n\t        do {\n\t            if (visited[cell.id]) { return null; }\n\t            visited[cell.id] = true;\n\t            cell = cell.getSourceCell();\n\t        } while (cell && cell.isLink());\n\t        return cell;\n\t    },\n\n\t    // unlike target(), this method returns null if target is a point\n\t    getTargetCell: function() {\n\n\t        var ref = this;\n\t        var graph = ref.graph;\n\t        var attributes = ref.attributes;\n\t        var target = attributes.target;\n\t        return (target && target.id && graph && graph.getCell(target.id)) || null;\n\t    },\n\n\t    getTargetElement: function() {\n\t        var cell = this;\n\t        var visited = {};\n\t        do {\n\t            if (visited[cell.id]) { return null; }\n\t            visited[cell.id] = true;\n\t            cell = cell.getTargetCell();\n\t        } while (cell && cell.isLink());\n\t        return cell;\n\t    },\n\n\t    // Returns the common ancestor for the source element,\n\t    // target element and the link itself.\n\t    getRelationshipAncestor: function() {\n\n\t        var connectionAncestor;\n\n\t        if (this.graph) {\n\n\t            var cells = [\n\t                this,\n\t                this.getSourceElement(), // null if source is a point\n\t                this.getTargetElement() // null if target is a point\n\t            ].filter(function(item) {\n\t                return !!item;\n\t            });\n\n\t            connectionAncestor = this.graph.getCommonAncestor.apply(this.graph, cells);\n\t        }\n\n\t        return connectionAncestor || null;\n\t    },\n\n\t    // Is source, target and the link itself embedded in a given cell?\n\t    isRelationshipEmbeddedIn: function(cell) {\n\n\t        var cellId = (isString(cell) || isNumber(cell)) ? cell : cell.id;\n\t        var ancestor = this.getRelationshipAncestor();\n\n\t        return !!ancestor && (ancestor.id === cellId || ancestor.isEmbeddedIn(cellId));\n\t    },\n\n\t    // Get resolved default label.\n\t    _getDefaultLabel: function() {\n\n\t        var defaultLabel = this.get('defaultLabel') || this.defaultLabel || {};\n\n\t        var label = {};\n\t        label.markup = defaultLabel.markup || this.get('labelMarkup') || this.labelMarkup;\n\t        label.position = defaultLabel.position;\n\t        label.attrs = defaultLabel.attrs;\n\t        label.size = defaultLabel.size;\n\n\t        return label;\n\t    }\n\t}, {\n\n\t    endsEqual: function(a, b) {\n\n\t        var portsEqual = a.port === b.port || !a.port && !b.port;\n\t        return a.id === b.id && portsEqual;\n\t    }\n\t});\n\n\tvar PortData = function(data) {\n\n\t    var clonedData = cloneDeep(data) || {};\n\t    this.ports = [];\n\t    this.groups = {};\n\t    this.portLayoutNamespace = Port;\n\t    this.portLabelLayoutNamespace = PortLabel;\n\n\t    this._init(clonedData);\n\t};\n\n\tPortData.prototype = {\n\n\t    getPorts: function() {\n\t        return this.ports;\n\t    },\n\n\t    getGroup: function(name) {\n\t        return this.groups[name] || {};\n\t    },\n\n\t    getPortsByGroup: function(groupName) {\n\n\t        return this.ports.filter(function(port) {\n\t            return port.group === groupName;\n\t        });\n\t    },\n\n\t    getGroupPortsMetrics: function(groupName, elBBox) {\n\n\t        var group = this.getGroup(groupName);\n\t        var ports = this.getPortsByGroup(groupName);\n\n\t        var groupPosition = group.position || {};\n\t        var groupPositionName = groupPosition.name;\n\t        var namespace = this.portLayoutNamespace;\n\t        if (!namespace[groupPositionName]) {\n\t            groupPositionName = 'left';\n\t        }\n\n\t        var groupArgs = groupPosition.args || {};\n\t        var portsArgs = ports.map(function(port) {\n\t            return port && port.position && port.position.args;\n\t        });\n\t        var groupPortTransformations = namespace[groupPositionName](portsArgs, elBBox, groupArgs);\n\n\t        var accumulator = {\n\t            ports: ports,\n\t            result: []\n\t        };\n\n\t        toArray(groupPortTransformations).reduce(function(res, portTransformation, index) {\n\t            var port = res.ports[index];\n\t            res.result.push({\n\t                portId: port.id,\n\t                portTransformation: portTransformation,\n\t                labelTransformation: this._getPortLabelLayout(port, Point(portTransformation), elBBox),\n\t                portAttrs: port.attrs,\n\t                portSize: port.size,\n\t                labelSize: port.label.size\n\t            });\n\t            return res;\n\t        }.bind(this), accumulator);\n\n\t        return accumulator.result;\n\t    },\n\n\t    _getPortLabelLayout: function(port, portPosition, elBBox) {\n\n\t        var namespace = this.portLabelLayoutNamespace;\n\t        var labelPosition = port.label.position.name || 'left';\n\n\t        if (namespace[labelPosition]) {\n\t            return namespace[labelPosition](portPosition, elBBox, port.label.position.args);\n\t        }\n\n\t        return null;\n\t    },\n\n\t    _init: function(data) {\n\n\t        // prepare groups\n\t        if (isObject$1(data.groups)) {\n\t            var groups = Object.keys(data.groups);\n\t            for (var i = 0, n = groups.length; i < n; i++) {\n\t                var key = groups[i];\n\t                this.groups[key] = this._evaluateGroup(data.groups[key]);\n\t            }\n\t        }\n\n\t        // prepare ports\n\t        var ports = toArray(data.items);\n\t        for (var j = 0, m = ports.length; j < m; j++) {\n\t            this.ports.push(this._evaluatePort(ports[j]));\n\t        }\n\t    },\n\n\t    _evaluateGroup: function(group) {\n\n\t        return merge(group, {\n\t            position: this._getPosition(group.position, true),\n\t            label: this._getLabel(group, true)\n\t        });\n\t    },\n\n\t    _evaluatePort: function(port) {\n\n\t        var evaluated = assign({}, port);\n\n\t        var group = this.getGroup(port.group);\n\n\t        evaluated.markup = evaluated.markup || group.markup;\n\t        evaluated.attrs = merge({}, group.attrs, evaluated.attrs);\n\t        evaluated.position = this._createPositionNode(group, evaluated);\n\t        evaluated.label = merge({}, group.label, this._getLabel(evaluated));\n\t        evaluated.z = this._getZIndex(group, evaluated);\n\t        evaluated.size = assign({}, group.size, evaluated.size);\n\n\t        return evaluated;\n\t    },\n\n\t    _getZIndex: function(group, port) {\n\n\t        if (isNumber(port.z)) {\n\t            return port.z;\n\t        }\n\t        if (isNumber(group.z) || group.z === 'auto') {\n\t            return group.z;\n\t        }\n\t        return 'auto';\n\t    },\n\n\t    _createPositionNode: function(group, port) {\n\n\t        return merge({\n\t            name: 'left',\n\t            args: {}\n\t        }, group.position, { args: port.args });\n\t    },\n\n\t    _getPosition: function(position, setDefault) {\n\n\t        var args = {};\n\t        var positionName;\n\n\t        if (isFunction(position)) {\n\t            positionName = 'fn';\n\t            args.fn = position;\n\t        } else if (isString(position)) {\n\t            positionName = position;\n\t        } else if (position === undefined) {\n\t            positionName = setDefault ? 'left' : null;\n\t        } else if (Array.isArray(position)) {\n\t            positionName = 'absolute';\n\t            args.x = position[0];\n\t            args.y = position[1];\n\t        } else if (isObject$1(position)) {\n\t            positionName = position.name;\n\t            assign(args, position.args);\n\t        }\n\n\t        var result = { args: args };\n\n\t        if (positionName) {\n\t            result.name = positionName;\n\t        }\n\t        return result;\n\t    },\n\n\t    _getLabel: function(item, setDefaults) {\n\n\t        var label = item.label || {};\n\n\t        var ret = label;\n\t        ret.position = this._getPosition(label.position, setDefaults);\n\n\t        return ret;\n\t    }\n\t};\n\n\tvar elementPortPrototype = {\n\n\t    _initializePorts: function() {\n\n\t        this._createPortData();\n\t        this.on('change:ports', function() {\n\n\t            this._processRemovedPort();\n\t            this._createPortData();\n\t        }, this);\n\t    },\n\n\t    /**\n\t     * remove links tied wiht just removed element\n\t     * @private\n\t     */\n\t    _processRemovedPort: function() {\n\n\t        var current = this.get('ports') || {};\n\t        var currentItemsMap = {};\n\n\t        toArray(current.items).forEach(function(item) {\n\t            currentItemsMap[item.id] = true;\n\t        });\n\n\t        var previous = this.previous('ports') || {};\n\t        var removed = {};\n\n\t        toArray(previous.items).forEach(function(item) {\n\t            if (!currentItemsMap[item.id]) {\n\t                removed[item.id] = true;\n\t            }\n\t        });\n\n\t        var graph = this.graph;\n\t        if (graph && !isEmpty(removed)) {\n\n\t            var inboundLinks = graph.getConnectedLinks(this, { inbound: true });\n\t            inboundLinks.forEach(function(link) {\n\n\t                if (removed[link.get('target').port]) { link.remove(); }\n\t            });\n\n\t            var outboundLinks = graph.getConnectedLinks(this, { outbound: true });\n\t            outboundLinks.forEach(function(link) {\n\n\t                if (removed[link.get('source').port]) { link.remove(); }\n\t            });\n\t        }\n\t    },\n\n\t    /**\n\t     * @returns {boolean}\n\t     */\n\t    hasPorts: function() {\n\n\t        var ports = this.prop('ports/items');\n\t        return Array.isArray(ports) && ports.length > 0;\n\t    },\n\n\t    /**\n\t     * @param {string} id\n\t     * @returns {boolean}\n\t     */\n\t    hasPort: function(id) {\n\n\t        return this.getPortIndex(id) !== -1;\n\t    },\n\n\t    /**\n\t     * @returns {Array<object>}\n\t     */\n\t    getPorts: function() {\n\n\t        return cloneDeep(this.prop('ports/items')) || [];\n\t    },\n\n\t    /**\n\t     * @returns {Array<object>}\n\t     */\n\t    getGroupPorts: function(groupName) {\n\t        var groupPorts = toArray(this.prop(['ports','items'])).filter(function (port) { return port.group === groupName; });\n\t        return cloneDeep(groupPorts);\n\t    },\n\n\t    /**\n\t     * @param {string} id\n\t     * @returns {object}\n\t     */\n\t    getPort: function(id) {\n\n\t        return cloneDeep(toArray(this.prop('ports/items')).find(function(port) {\n\t            return port.id && port.id === id;\n\t        }));\n\t    },\n\n\t    /**\n\t     * @param {string} groupName\n\t     * @returns {Object<portId, {x: number, y: number, angle: number}>}\n\t     */\n\t    getPortsPositions: function(groupName) {\n\n\t        var portsMetrics = this._portSettingsData.getGroupPortsMetrics(groupName, Rect(this.size()));\n\n\t        return portsMetrics.reduce(function(positions, metrics) {\n\t            var transformation = metrics.portTransformation;\n\t            positions[metrics.portId] = {\n\t                x: transformation.x,\n\t                y: transformation.y,\n\t                angle: transformation.angle\n\t            };\n\t            return positions;\n\t        }, {});\n\t    },\n\n\t    /**\n\t     * @param {string|Port} port port id or port\n\t     * @returns {number} port index\n\t     */\n\t    getPortIndex: function(port) {\n\n\t        var id = isObject$1(port) ? port.id : port;\n\n\t        if (!this._isValidPortId(id)) {\n\t            return -1;\n\t        }\n\n\t        return toArray(this.prop('ports/items')).findIndex(function(item) {\n\t            return item.id === id;\n\t        });\n\t    },\n\n\t    /**\n\t     * @param {object} port\n\t     * @param {object} [opt]\n\t     * @returns {joint.dia.Element}\n\t     */\n\t    addPort: function(port, opt) {\n\n\t        if (!isObject$1(port) || Array.isArray(port)) {\n\t            throw new Error('Element: addPort requires an object.');\n\t        }\n\n\t        var ports = assign([], this.prop('ports/items'));\n\t        ports.push(port);\n\t        this.prop('ports/items', ports, opt);\n\n\t        return this;\n\t    },\n\n\t    /**\n\t     * @param {string|Port|number} before\n\t     * @param {object} port\n\t     * @param {object} [opt]\n\t     * @returns {joint.dia.Element}\n\t     */\n\t    insertPort: function(before, port, opt) {\n\t        var index$1 = (typeof before === 'number') ? before : this.getPortIndex(before);\n\n\t        if (!isObject$1(port) || Array.isArray(port)) {\n\t            throw new Error('dia.Element: insertPort requires an object.');\n\t        }\n\n\t        var ports = assign([], this.prop('ports/items'));\n\t        ports.splice(index$1, 0, port);\n\t        this.prop('ports/items', ports, opt);\n\n\t        return this;\n\t    },\n\n\t    /**\n\t     * @param {string} portId\n\t     * @param {string|object=} path\n\t     * @param {*=} value\n\t     * @param {object=} opt\n\t     * @returns {joint.dia.Element}\n\t     */\n\t    portProp: function(portId, path, value, opt) {\n\n\t        var index$1 = this.getPortIndex(portId);\n\n\t        if (index$1 === -1) {\n\t            throw new Error('Element: unable to find port with id ' + portId);\n\t        }\n\n\t        var args = Array.prototype.slice.call(arguments, 1);\n\t        if (Array.isArray(path)) {\n\t            args[0] = ['ports', 'items', index$1].concat(path);\n\t        } else if (isString(path)) {\n\n\t            // Get/set an attribute by a special path syntax that delimits\n\t            // nested objects by the colon character.\n\t            args[0] = ['ports/items/', index$1, '/', path].join('');\n\n\t        } else {\n\n\t            args = ['ports/items/' + index$1];\n\t            if (isPlainObject(path)) {\n\t                args.push(path);\n\t                args.push(value);\n\t            }\n\t        }\n\n\t        return this.prop.apply(this, args);\n\t    },\n\n\t    _validatePorts: function() {\n\n\t        var portsAttr = this.get('ports') || {};\n\n\t        var errorMessages = [];\n\t        portsAttr = portsAttr || {};\n\t        var ports = toArray(portsAttr.items);\n\n\t        ports.forEach(function(p) {\n\n\t            if (typeof p !== 'object') {\n\t                errorMessages.push('Element: invalid port ', p);\n\t            }\n\n\t            if (!this._isValidPortId(p.id)) {\n\t                p.id = this.generatePortId();\n\t            }\n\t        }, this);\n\n\t        if (uniq(ports, 'id').length !== ports.length) {\n\t            errorMessages.push('Element: found id duplicities in ports.');\n\t        }\n\n\t        return errorMessages;\n\t    },\n\n\t    generatePortId: function() {\n\t        return this.generateId();\n\t    },\n\n\t    /**\n\t     * @param {string} id port id\n\t     * @returns {boolean}\n\t     * @private\n\t     */\n\t    _isValidPortId: function(id) {\n\n\t        return id !== null && id !== undefined && !isObject$1(id);\n\t    },\n\n\t    addPorts: function(ports, opt) {\n\n\t        if (ports.length) {\n\t            this.prop('ports/items', assign([], this.prop('ports/items')).concat(ports), opt);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    removePort: function(port, opt) {\n\t        var options = opt || {};\n\t        var index$1 = this.getPortIndex(port);\n\t        if (index$1 !== -1) {\n\t            var ports = assign([], this.prop(['ports', 'items']));\n\t            ports.splice(index$1, 1);\n\t            options.rewrite = true;\n\t            this.startBatch('port-remove');\n\t            this.prop(['ports', 'items'], ports, options);\n\t            this.stopBatch('port-remove');\n\t        }\n\t        return this;\n\t    },\n\n\t    removePorts: function(portsForRemoval, opt) {\n\t        var options, newPorts;\n\t        if (Array.isArray(portsForRemoval)) {\n\t            options = opt || {};\n\t            if (portsForRemoval.length === 0) { return this.this; }\n\t            var currentPorts = assign([], this.prop(['ports', 'items']));\n\t            newPorts = currentPorts.filter(function(cp) {\n\t                return !portsForRemoval.some(function(rp) {\n\t                    var rpId = isObject$1(rp) ? rp.id : rp;\n\t                    return cp.id === rpId;\n\t                });\n\t            });\n\t        } else {\n\t            options = portsForRemoval || {};\n\t            newPorts = [];\n\t        }\n\t        this.startBatch('port-remove');\n\t        options.rewrite = true;\n\t        this.prop(['ports', 'items'], newPorts, options);\n\t        this.stopBatch('port-remove');\n\t        return this;\n\t    },\n\n\t    /**\n\t     * @private\n\t     */\n\t    _createPortData: function() {\n\n\t        var err = this._validatePorts();\n\n\t        if (err.length > 0) {\n\t            this.set('ports', this.previous('ports'));\n\t            throw new Error(err.join(' '));\n\t        }\n\n\t        var prevPortData;\n\n\t        if (this._portSettingsData) {\n\n\t            prevPortData = this._portSettingsData.getPorts();\n\t        }\n\n\t        this._portSettingsData = new PortData(this.get('ports'));\n\n\t        var curPortData = this._portSettingsData.getPorts();\n\n\t        if (prevPortData) {\n\n\t            var added = curPortData.filter(function(item) {\n\t                if (!prevPortData.find(function(prevPort) {\n\t                    return prevPort.id === item.id;\n\t                })) {\n\t                    return item;\n\t                }\n\t            });\n\n\t            var removed = prevPortData.filter(function(item) {\n\t                if (!curPortData.find(function(curPort) {\n\t                    return curPort.id === item.id;\n\t                })) {\n\t                    return item;\n\t                }\n\t            });\n\n\t            if (removed.length > 0) {\n\t                this.trigger('ports:remove', this, removed);\n\t            }\n\n\t            if (added.length > 0) {\n\t                this.trigger('ports:add', this, added);\n\t            }\n\t        }\n\t    }\n\t};\n\n\tvar elementViewPortPrototype = {\n\n\t    portContainerMarkup: 'g',\n\t    portMarkup: [{\n\t        tagName: 'circle',\n\t        selector: 'circle',\n\t        attributes: {\n\t            'r': 10,\n\t            'fill': '#FFFFFF',\n\t            'stroke': '#000000'\n\t        }\n\t    }],\n\t    portLabelMarkup: [{\n\t        tagName: 'text',\n\t        selector: 'text',\n\t        attributes: {\n\t            'fill': '#000000'\n\t        }\n\t    }],\n\t    /** @type {Object<string, {portElement: Vectorizer, portLabelElement: Vectorizer}>} */\n\t    _portElementsCache: null,\n\n\t    /**\n\t     * @private\n\t     */\n\t    _initializePorts: function() {\n\t        this._cleanPortsCache();\n\t    },\n\n\t    /**\n\t     * @typedef {Object} Port\n\t     *\n\t     * @property {string} id\n\t     * @property {Object} position\n\t     * @property {Object} label\n\t     * @property {Object} attrs\n\t     * @property {string} markup\n\t     * @property {string} group\n\t     */\n\n\t    /**\n\t     * @private\n\t     */\n\t    _refreshPorts: function() {\n\n\t        this._removePorts();\n\t        this._cleanPortsCache();\n\t        this._renderPorts();\n\t    },\n\n\t    _cleanPortsCache: function() {\n\t        this._portElementsCache = {};\n\t    },\n\n\t    /**\n\t     * @private\n\t     */\n\t    _renderPorts: function() {\n\n\t        // references to rendered elements without z-index\n\t        var elementReferences = [];\n\t        var elem = this._getContainerElement();\n\n\t        for (var i = 0, count = elem.node.childNodes.length; i < count; i++) {\n\t            elementReferences.push(elem.node.childNodes[i]);\n\t        }\n\n\t        var portsGropsByZ = groupBy(this.model._portSettingsData.getPorts(), 'z');\n\t        var withoutZKey = 'auto';\n\n\t        // render non-z first\n\t        toArray(portsGropsByZ[withoutZKey]).forEach(function(port) {\n\t            var portElement = this._getPortElement(port);\n\t            elem.append(portElement);\n\t            elementReferences.push(portElement);\n\t        }, this);\n\n\t        var groupNames = Object.keys(portsGropsByZ);\n\t        for (var k = 0; k < groupNames.length; k++) {\n\t            var groupName = groupNames[k];\n\t            if (groupName !== withoutZKey) {\n\t                var z = parseInt(groupName, 10);\n\t                this._appendPorts(portsGropsByZ[groupName], z, elementReferences);\n\t            }\n\t        }\n\n\t        this._updatePorts();\n\t    },\n\n\t    /**\n\t     * @returns {V}\n\t     * @private\n\t     */\n\t    _getContainerElement: function() {\n\n\t        return this.rotatableNode || this.vel;\n\t    },\n\n\t    /**\n\t     * @param {Array<Port>}ports\n\t     * @param {number} z\n\t     * @param refs\n\t     * @private\n\t     */\n\t    _appendPorts: function(ports, z, refs) {\n\n\t        var containerElement = this._getContainerElement();\n\t        var portElements = toArray(ports).map(this._getPortElement, this);\n\n\t        if (refs[z] || z < 0) {\n\t            V(refs[Math.max(z, 0)]).before(portElements);\n\t        } else {\n\t            containerElement.append(portElements);\n\t        }\n\t    },\n\n\t    /**\n\t     * Try to get element from cache,\n\t     * @param port\n\t     * @returns {*}\n\t     * @private\n\t     */\n\t    _getPortElement: function(port) {\n\n\t        if (this._portElementsCache[port.id]) {\n\t            return this._portElementsCache[port.id].portElement;\n\t        }\n\t        return this._createPortElement(port);\n\t    },\n\n\t    findPortNode: function(portId, selector) {\n\t        var portCache = this._portElementsCache[portId];\n\t        if (!portCache) { return null; }\n\t        var portRoot = portCache.portContentElement.node;\n\t        var portSelectors = portCache.portContentSelectors;\n\t        var ref = this.findBySelector(selector, portRoot, portSelectors);\n\t        var node = ref[0]; if ( node === void 0 ) node = null;\n\t        return node;\n\t    },\n\n\t    /**\n\t     * @private\n\t     */\n\t    _updatePorts: function() {\n\n\t        // layout ports without group\n\t        this._updatePortGroup(undefined);\n\t        // layout ports with explicit group\n\t        var groupsNames = Object.keys(this.model._portSettingsData.groups);\n\t        groupsNames.forEach(this._updatePortGroup, this);\n\t    },\n\n\t    /**\n\t     * @private\n\t     */\n\t    _removePorts: function() {\n\t        invoke(this._portElementsCache, 'portElement.remove');\n\t    },\n\n\t    /**\n\t     * @param {Port} port\n\t     * @returns {V}\n\t     * @private\n\t     */\n\t    _createPortElement: function(port) {\n\n\t        var portElement;\n\t        var labelElement;\n\t        var labelSelectors;\n\t        var portSelectors;\n\n\t        var portContainerElement = V(this.portContainerMarkup).addClass('joint-port');\n\n\t        var portMarkup = this._getPortMarkup(port);\n\t        if (Array.isArray(portMarkup)) {\n\t            var portDoc = this.parseDOMJSON(portMarkup, portContainerElement.node);\n\t            var portFragment = portDoc.fragment;\n\t            if (portFragment.childNodes.length > 1) {\n\t                portElement = V('g').append(portFragment);\n\t            } else {\n\t                portElement = V(portFragment.firstChild);\n\t            }\n\t            portSelectors = portDoc.selectors;\n\t        } else {\n\t            portElement = V(portMarkup);\n\t            if (Array.isArray(portElement)) {\n\t                portElement = V('g').append(portElement);\n\t            }\n\t        }\n\n\t        if (!portElement) {\n\t            throw new Error('ElementView: Invalid port markup.');\n\t        }\n\n\t        portElement.attr({\n\t            'port': port.id,\n\t            'port-group': port.group\n\t        });\n\n\t        var labelMarkupDef = this._getPortLabelMarkup(port.label);\n\t        if (Array.isArray(labelMarkupDef)) {\n\t            // JSON Markup\n\t            var ref = this.parseDOMJSON(labelMarkupDef, portContainerElement.node);\n\t            var fragment = ref.fragment;\n\t            var selectors = ref.selectors;\n\t            var childCount = fragment.childNodes.length;\n\t            if (childCount > 0) {\n\t                labelSelectors = selectors;\n\t                labelElement = (childCount === 1) ? V(fragment.firstChild) : V('g').append(fragment);\n\t            }\n\t        } else {\n\t            // String Markup\n\t            labelElement = V(labelMarkupDef);\n\t            if (Array.isArray(labelElement)) {\n\t                labelElement = V('g').append(labelElement);\n\t            }\n\t        }\n\n\t        var portContainerSelectors;\n\t        if (portSelectors && labelSelectors) {\n\t            for (var key in labelSelectors) {\n\t                if (portSelectors[key] && key !== this.selector) { throw new Error('ElementView: selectors within port must be unique.'); }\n\t            }\n\t            portContainerSelectors = assign({}, portSelectors, labelSelectors);\n\t        } else {\n\t            portContainerSelectors = portSelectors || labelSelectors;\n\t        }\n\n\t        portContainerElement.append(portElement.addClass('joint-port-body'));\n\t        if (labelElement) {\n\t            portContainerElement.append(labelElement.addClass('joint-port-label'));\n\t        }\n\n\t        this._portElementsCache[port.id] = {\n\t            portElement: portContainerElement,\n\t            portLabelElement: labelElement,\n\t            portSelectors: portContainerSelectors,\n\t            portLabelSelectors: labelSelectors,\n\t            portContentElement: portElement,\n\t            portContentSelectors: portSelectors\n\t        };\n\n\t        return portContainerElement;\n\t    },\n\n\t    /**\n\t     * @param {string=} groupName\n\t     * @private\n\t     */\n\t    _updatePortGroup: function(groupName) {\n\n\t        var elementBBox = Rect(this.model.size());\n\t        var portsMetrics = this.model._portSettingsData.getGroupPortsMetrics(groupName, elementBBox);\n\n\t        for (var i = 0, n = portsMetrics.length; i < n; i++) {\n\t            var metrics = portsMetrics[i];\n\t            var portId = metrics.portId;\n\t            var cached = this._portElementsCache[portId] || {};\n\t            var portTransformation = metrics.portTransformation;\n\t            this.applyPortTransform(cached.portElement, portTransformation);\n\t            this.updateDOMSubtreeAttributes(cached.portElement.node, metrics.portAttrs, {\n\t                rootBBox: new Rect(metrics.portSize),\n\t                selectors: cached.portSelectors\n\t            });\n\n\t            var labelTransformation = metrics.labelTransformation;\n\t            if (labelTransformation && cached.portLabelElement) {\n\t                this.applyPortTransform(cached.portLabelElement, labelTransformation, (-portTransformation.angle || 0));\n\t                this.updateDOMSubtreeAttributes(cached.portLabelElement.node, labelTransformation.attrs, {\n\t                    rootBBox: new Rect(metrics.labelSize),\n\t                    selectors: cached.portLabelSelectors\n\t                });\n\t            }\n\t        }\n\t    },\n\n\t    /**\n\t     * @param {Vectorizer} element\n\t     * @param {{dx:number, dy:number, angle: number, attrs: Object, x:number: y:number}} transformData\n\t     * @param {number=} initialAngle\n\t     * @constructor\n\t     */\n\t    applyPortTransform: function(element, transformData, initialAngle) {\n\n\t        var matrix = V.createSVGMatrix()\n\t            .rotate(initialAngle || 0)\n\t            .translate(transformData.x || 0, transformData.y || 0)\n\t            .rotate(transformData.angle || 0);\n\n\t        element.transform(matrix, { absolute: true });\n\t    },\n\n\t    /**\n\t     * @param {Port} port\n\t     * @returns {string}\n\t     * @private\n\t     */\n\t    _getPortMarkup: function(port) {\n\n\t        return port.markup || this.model.get('portMarkup') || this.model.portMarkup || this.portMarkup;\n\t    },\n\n\t    /**\n\t     * @param {Object} label\n\t     * @returns {string}\n\t     * @private\n\t     */\n\t    _getPortLabelMarkup: function(label) {\n\n\t        return label.markup || this.model.get('portLabelMarkup') || this.model.portLabelMarkup || this.portLabelMarkup;\n\t    }\n\t};\n\n\t// Element base model.\n\t// -----------------------------\n\n\tvar Element$1 = Cell.extend({\n\n\t    defaults: {\n\t        position: { x: 0, y: 0 },\n\t        size: { width: 1, height: 1 },\n\t        angle: 0\n\t    },\n\n\t    initialize: function() {\n\n\t        this._initializePorts();\n\t        Cell.prototype.initialize.apply(this, arguments);\n\t    },\n\n\t    /**\n\t     * @abstract\n\t     */\n\t    _initializePorts: function() {\n\t        // implemented in ports.js\n\t    },\n\n\t    _refreshPorts: function() {\n\t        // implemented in ports.js\n\t    },\n\n\t    isElement: function() {\n\n\t        return true;\n\t    },\n\n\t    position: function(x, y, opt) {\n\n\t        var isSetter = isNumber(y);\n\t        opt = (isSetter ? opt : x) || {};\n\t        var parentRelative = opt.parentRelative;\n\t        var deep = opt.deep;\n\t        var restrictedArea = opt.restrictedArea;\n\n\n\t        // option `parentRelative` for setting the position relative to the element's parent.\n\t        var parentPosition;\n\t        if (parentRelative) {\n\n\t            // Getting the parent's position requires the collection.\n\t            // Cell.parent() holds cell id only.\n\t            if (!this.graph) { throw new Error('Element must be part of a graph.'); }\n\n\t            var parent = this.getParentCell();\n\t            if (parent && !parent.isLink()) {\n\t                parentPosition = parent.get('position');\n\t            }\n\t        }\n\n\t        if (isSetter) {\n\n\t            if (parentPosition) {\n\t                x += parentPosition.x;\n\t                y += parentPosition.y;\n\t            }\n\n\t            if (deep || restrictedArea) {\n\t                var ref = this.get('position');\n\t                var x0 = ref.x;\n\t                var y0 = ref.y;\n\t                this.translate(x - x0, y - y0, opt);\n\t            } else {\n\t                this.set('position', { x: x, y: y }, opt);\n\t            }\n\n\t            return this;\n\n\t        } else { // Getter returns a geometry point.\n\n\t            var elementPosition = Point(this.get('position'));\n\t            return parentRelative\n\t                ? elementPosition.difference(parentPosition)\n\t                : elementPosition;\n\t        }\n\t    },\n\n\t    translate: function(tx, ty, opt) {\n\n\t        tx = tx || 0;\n\t        ty = ty || 0;\n\n\t        if (tx === 0 && ty === 0) {\n\t            // Like nothing has happened.\n\t            return this;\n\t        }\n\n\t        opt = opt || {};\n\t        // Pass the initiator of the translation.\n\t        opt.translateBy = opt.translateBy || this.id;\n\n\t        var position = this.get('position') || { x: 0, y: 0 };\n\t        var ra = opt.restrictedArea;\n\t        if (ra && opt.translateBy === this.id) {\n\n\t            if (typeof ra === 'function') {\n\n\t                var newPosition = ra.call(this, position.x + tx, position.y + ty, opt);\n\n\t                tx = newPosition.x - position.x;\n\t                ty = newPosition.y - position.y;\n\n\t            } else  {\n\t                // We are restricting the translation for the element itself only. We get\n\t                // the bounding box of the element including all its embeds.\n\t                // All embeds have to be translated the exact same way as the element.\n\t                var bbox = this.getBBox({ deep: true });\n\t                //- - - - - - - - - - - - -> ra.x + ra.width\n\t                // - - - -> position.x      |\n\t                // -> bbox.x\n\t                //                âââââââ   |\n\t                //         ââââââââââââââ\n\t                //         âââââââââ        |\n\t                //   âââââââââââââââ\n\t                //   ââââââââ               |\n\t                //   <-dx->                     | restricted area right border\n\t                //         <-width->        |   â translated element\n\t                //   <- - bbox.width - ->       â embedded element\n\t                var dx = position.x - bbox.x;\n\t                var dy = position.y - bbox.y;\n\t                // Find the maximal/minimal coordinates that the element can be translated\n\t                // while complies the restrictions.\n\t                var x = Math.max(ra.x + dx, Math.min(ra.x + ra.width + dx - bbox.width, position.x + tx));\n\t                var y = Math.max(ra.y + dy, Math.min(ra.y + ra.height + dy - bbox.height, position.y + ty));\n\t                // recalculate the translation taking the restrictions into account.\n\t                tx = x - position.x;\n\t                ty = y - position.y;\n\t            }\n\t        }\n\n\t        var translatedPosition = {\n\t            x: position.x + tx,\n\t            y: position.y + ty\n\t        };\n\n\t        // To find out by how much an element was translated in event 'change:position' handlers.\n\t        opt.tx = tx;\n\t        opt.ty = ty;\n\n\t        if (opt.transition) {\n\n\t            if (!isObject$1(opt.transition)) { opt.transition = {}; }\n\n\t            this.transition('position', translatedPosition, assign({}, opt.transition, {\n\t                valueFunction: interpolate.object\n\t            }));\n\n\t            // Recursively call `translate()` on all the embeds cells.\n\t            invoke(this.getEmbeddedCells(), 'translate', tx, ty, opt);\n\n\t        } else {\n\n\t            this.startBatch('translate', opt);\n\t            this.set('position', translatedPosition, opt);\n\t            invoke(this.getEmbeddedCells(), 'translate', tx, ty, opt);\n\t            this.stopBatch('translate', opt);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    size: function(width, height, opt) {\n\n\t        var currentSize = this.get('size');\n\t        // Getter\n\t        // () signature\n\t        if (width === undefined) {\n\t            return {\n\t                width: currentSize.width,\n\t                height: currentSize.height\n\t            };\n\t        }\n\t        // Setter\n\t        // (size, opt) signature\n\t        if (isObject$1(width)) {\n\t            opt = height;\n\t            height = isNumber(width.height) ? width.height : currentSize.height;\n\t            width = isNumber(width.width) ? width.width : currentSize.width;\n\t        }\n\n\t        return this.resize(width, height, opt);\n\t    },\n\n\t    resize: function(width, height, opt) {\n\n\t        opt = opt || {};\n\n\t        this.startBatch('resize', opt);\n\n\t        if (opt.direction) {\n\n\t            var currentSize = this.get('size');\n\n\t            switch (opt.direction) {\n\n\t                case 'left':\n\t                case 'right':\n\t                    // Don't change height when resizing horizontally.\n\t                    height = currentSize.height;\n\t                    break;\n\n\t                case 'top':\n\t                case 'bottom':\n\t                    // Don't change width when resizing vertically.\n\t                    width = currentSize.width;\n\t                    break;\n\t            }\n\n\t            // Get the angle and clamp its value between 0 and 360 degrees.\n\t            var angle = normalizeAngle(this.get('angle') || 0);\n\n\t            // This is a rectangle in size of the un-rotated element.\n\t            var bbox = this.getBBox();\n\n\t            var origin;\n\n\t            if (angle) {\n\n\t                var quadrant = {\n\t                    'top-right': 0,\n\t                    'right': 0,\n\t                    'top-left': 1,\n\t                    'top': 1,\n\t                    'bottom-left': 2,\n\t                    'left': 2,\n\t                    'bottom-right': 3,\n\t                    'bottom': 3\n\t                }[opt.direction];\n\n\t                if (opt.absolute) {\n\n\t                    // We are taking the element's rotation into account\n\t                    quadrant += Math.floor((angle + 45) / 90);\n\t                    quadrant %= 4;\n\t                }\n\n\t                // Pick the corner point on the element, which meant to stay on its place before and\n\t                // after the rotation.\n\t                var fixedPoint = bbox[['bottomLeft', 'corner', 'topRight', 'origin'][quadrant]]();\n\n\t                // Find  an image of the previous indent point. This is the position, where is the\n\t                // point actually located on the screen.\n\t                var imageFixedPoint = Point(fixedPoint).rotate(bbox.center(), -angle);\n\n\t                // Every point on the element rotates around a circle with the centre of rotation\n\t                // in the middle of the element while the whole element is being rotated. That means\n\t                // that the distance from a point in the corner of the element (supposed its always rect) to\n\t                // the center of the element doesn't change during the rotation and therefore it equals\n\t                // to a distance on un-rotated element.\n\t                // We can find the distance as DISTANCE = (ELEMENTWIDTH/2)^2 + (ELEMENTHEIGHT/2)^2)^0.5.\n\t                var radius = Math.sqrt((width * width) + (height * height)) / 2;\n\n\t                // Now we are looking for an angle between x-axis and the line starting at image of fixed point\n\t                // and ending at the center of the element. We call this angle `alpha`.\n\n\t                // The image of a fixed point is located in n-th quadrant. For each quadrant passed\n\t                // going anti-clockwise we have to add 90 degrees. Note that the first quadrant has index 0.\n\t                //\n\t                // 3 | 2\n\t                // --c-- Quadrant positions around the element's center `c`\n\t                // 0 | 1\n\t                //\n\t                var alpha = quadrant * Math.PI / 2;\n\n\t                // Add an angle between the beginning of the current quadrant (line parallel with x-axis or y-axis\n\t                // going through the center of the element) and line crossing the indent of the fixed point and the center\n\t                // of the element. This is the angle we need but on the un-rotated element.\n\t                alpha += Math.atan(quadrant % 2 == 0 ? height / width : width / height);\n\n\t                // Lastly we have to deduct the original angle the element was rotated by and that's it.\n\t                alpha -= toRad(angle);\n\n\t                // With this angle and distance we can easily calculate the centre of the un-rotated element.\n\t                // Note that fromPolar constructor accepts an angle in radians.\n\t                var center = Point.fromPolar(radius, alpha, imageFixedPoint);\n\n\t                // The top left corner on the un-rotated element has to be half a width on the left\n\t                // and half a height to the top from the center. This will be the origin of rectangle\n\t                // we were looking for.\n\t                origin = Point(center).offset(width / -2, height / -2);\n\n\t            } else {\n\t                // calculation for the origin Point when there is no rotation of the element\n\t                origin = bbox.topLeft();\n\n\t                switch (opt.direction) {\n\t                    case 'top':\n\t                    case 'top-right':\n\t                        origin.offset(0, bbox.height - height);\n\t                        break;\n\t                    case 'left':\n\t                    case 'bottom-left':\n\t                        origin.offset(bbox.width -width, 0);\n\t                        break;\n\t                    case 'top-left':\n\t                        origin.offset(bbox.width - width, bbox.height - height);\n\t                        break;\n\t                }\n\t            }\n\n\t            // Resize the element (before re-positioning it).\n\t            this.set('size', { width: width, height: height }, opt);\n\n\t            // Finally, re-position the element.\n\t            this.position(origin.x, origin.y, opt);\n\n\t        } else {\n\n\t            // Resize the element.\n\t            this.set('size', { width: width, height: height }, opt);\n\t        }\n\n\t        this.stopBatch('resize', opt);\n\n\t        return this;\n\t    },\n\n\t    scale: function(sx, sy, origin, opt) {\n\n\t        var scaledBBox = this.getBBox().scale(sx, sy, origin);\n\t        this.startBatch('scale', opt);\n\t        this.position(scaledBBox.x, scaledBBox.y, opt);\n\t        this.resize(scaledBBox.width, scaledBBox.height, opt);\n\t        this.stopBatch('scale');\n\t        return this;\n\t    },\n\n\t    fitEmbeds: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        // Getting the children's size and position requires the collection.\n\t        // Cell.get('embeds') helds an array of cell ids only.\n\t        var ref = this;\n\t        var graph = ref.graph;\n\t        if (!graph) { throw new Error('Element must be part of a graph.'); }\n\n\t        var embeddedCells = this.getEmbeddedCells().filter(function (cell) { return cell.isElement(); });\n\t        if (embeddedCells.length === 0) { return this; }\n\n\t        this.startBatch('fit-embeds', opt);\n\n\t        if (opt.deep) {\n\t            // Recursively apply fitEmbeds on all embeds first.\n\t            invoke(embeddedCells, 'fitEmbeds', opt);\n\t        }\n\n\t        // Compute cell's size and position based on the children bbox\n\t        // and given padding.\n\t        var ref$1 = normalizeSides(opt.padding);\n\t        var left = ref$1.left;\n\t        var right = ref$1.right;\n\t        var top = ref$1.top;\n\t        var bottom = ref$1.bottom;\n\t        var ref$2 = graph.getCellsBBox(embeddedCells);\n\t        var x = ref$2.x;\n\t        var y = ref$2.y;\n\t        var width = ref$2.width;\n\t        var height = ref$2.height;\n\t        // Apply padding computed above to the bbox.\n\t        x -= left;\n\t        y -= top;\n\t        width += left + right;\n\t        height += bottom + top;\n\n\t        // Set new element dimensions finally.\n\t        this.set({\n\t            position: { x: x, y: y },\n\t            size: { width: width, height: height }\n\t        }, opt);\n\n\t        this.stopBatch('fit-embeds');\n\n\t        return this;\n\t    },\n\n\t    // Rotate element by `angle` degrees, optionally around `origin` point.\n\t    // If `origin` is not provided, it is considered to be the center of the element.\n\t    // If `absolute` is `true`, the `angle` is considered is absolute, i.e. it is not\n\t    // the difference from the previous angle.\n\t    rotate: function(angle, absolute, origin, opt) {\n\n\t        if (origin) {\n\n\t            var center = this.getBBox().center();\n\t            var size = this.get('size');\n\t            var position = this.get('position');\n\t            center.rotate(origin, this.get('angle') - angle);\n\t            var dx = center.x - size.width / 2 - position.x;\n\t            var dy = center.y - size.height / 2 - position.y;\n\t            this.startBatch('rotate', { angle: angle, absolute: absolute, origin: origin });\n\t            this.position(position.x + dx, position.y + dy, opt);\n\t            this.rotate(angle, absolute, null, opt);\n\t            this.stopBatch('rotate');\n\n\t        } else {\n\n\t            this.set('angle', absolute ? angle : (this.get('angle') + angle) % 360, opt);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    angle: function() {\n\t        return normalizeAngle(this.get('angle') || 0);\n\t    },\n\n\t    getBBox: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        var ref = this;\n\t        var graph = ref.graph;\n\t        var attributes = ref.attributes;\n\t        var deep = opt.deep;\n\t        var rotate = opt.rotate;\n\n\t        if (deep && graph) {\n\t            // Get all the embedded elements using breadth first algorithm.\n\t            var elements = this.getEmbeddedCells({ deep: true, breadthFirst: true });\n\t            // Add the model itself.\n\t            elements.push(this);\n\t            // Note: the default of getCellsBBox() is rotate=true and can't be\n\t            // changed without a breaking change\n\t            return graph.getCellsBBox(elements, opt);\n\t        }\n\n\t        var angle = attributes.angle; if ( angle === void 0 ) angle = 0;\n\t        var attributes_position = attributes.position;\n\t        var x = attributes_position.x;\n\t        var y = attributes_position.y;\n\t        var attributes_size = attributes.size;\n\t        var width = attributes_size.width;\n\t        var height = attributes_size.height;\n\t        var bbox = new Rect(x, y, width, height);\n\t        if (rotate) {\n\t            bbox.rotateAroundCenter(angle);\n\t        }\n\t        return bbox;\n\t    },\n\n\t    getPointFromConnectedLink: function(link, endType) {\n\t        // Center of the model\n\t        var bbox = this.getBBox();\n\t        var center = bbox.center();\n\t        // Center of a port\n\t        var endDef = link.get(endType);\n\t        if (!endDef) { return center; }\n\t        var portId = endDef.port;\n\t        if (!portId || !this.hasPort(portId)) { return center; }\n\t        var portGroup = this.portProp(portId, ['group']);\n\t        var portsPositions = this.getPortsPositions(portGroup);\n\t        var portCenter = new Point(portsPositions[portId]).offset(bbox.origin());\n\t        var angle = this.angle();\n\t        if (angle) { portCenter.rotate(center, -angle); }\n\t        return portCenter;\n\t    }\n\t});\n\n\tassign(Element$1.prototype, elementPortPrototype);\n\n\tvar GraphCells = Backbone.Collection.extend({\n\n\t    initialize: function(models, opt) {\n\n\t        // Set the optional namespace where all model classes are defined.\n\t        if (opt.cellNamespace) {\n\t            this.cellNamespace = opt.cellNamespace;\n\t        } else {\n\t            /* eslint-disable no-undef */\n\t            this.cellNamespace = typeof joint !== 'undefined' && has$2(joint, 'shapes') ? joint.shapes : null;\n\t            /* eslint-enable no-undef */\n\t        }\n\n\n\t        this.graph = opt.graph;\n\t    },\n\n\t    model: function(attrs, opt) {\n\n\t        var collection = opt.collection;\n\t        var namespace = collection.cellNamespace;\n\n\t        // Find the model class in the namespace or use the default one.\n\t        var ModelClass = (attrs.type === 'link')\n\t            ? Link\n\t            : getByPath(namespace, attrs.type, '.') || Element$1;\n\n\t        var cell = new ModelClass(attrs, opt);\n\t        // Add a reference to the graph. It is necessary to do this here because this is the earliest place\n\t        // where a new model is created from a plain JS object. For other objects, see `joint.dia.Graph>>_prepareCell()`.\n\t        if (!opt.dry) {\n\t            cell.graph = collection.graph;\n\t        }\n\n\t        return cell;\n\t    },\n\n\t    // `comparator` makes it easy to sort cells based on their `z` index.\n\t    comparator: function(model) {\n\n\t        return model.get('z') || 0;\n\t    }\n\t});\n\n\n\tvar Graph = Backbone.Model.extend({\n\n\t    initialize: function(attrs, opt) {\n\n\t        opt = opt || {};\n\n\t        // Passing `cellModel` function in the options object to graph allows for\n\t        // setting models based on attribute objects. This is especially handy\n\t        // when processing JSON graphs that are in a different than JointJS format.\n\t        var cells = new GraphCells([], {\n\t            model: opt.cellModel,\n\t            cellNamespace: opt.cellNamespace,\n\t            graph: this\n\t        });\n\t        Backbone.Model.prototype.set.call(this, 'cells', cells);\n\n\t        // Make all the events fired in the `cells` collection available.\n\t        // to the outside world.\n\t        cells.on('all', this.trigger, this);\n\n\t        // Backbone automatically doesn't trigger re-sort if models attributes are changed later when\n\t        // they're already in the collection. Therefore, we're triggering sort manually here.\n\t        this.on('change:z', this._sortOnChangeZ, this);\n\n\t        // `joint.dia.Graph` keeps an internal data structure (an adjacency list)\n\t        // for fast graph queries. All changes that affect the structure of the graph\n\t        // must be reflected in the `al` object. This object provides fast answers to\n\t        // questions such as \"what are the neighbours of this node\" or \"what\n\t        // are the sibling links of this link\".\n\n\t        // Outgoing edges per node. Note that we use a hash-table for the list\n\t        // of outgoing edges for a faster lookup.\n\t        // [nodeId] -> Object [edgeId] -> true\n\t        this._out = {};\n\t        // Ingoing edges per node.\n\t        // [nodeId] -> Object [edgeId] -> true\n\t        this._in = {};\n\t        // `_nodes` is useful for quick lookup of all the elements in the graph, without\n\t        // having to go through the whole cells array.\n\t        // [node ID] -> true\n\t        this._nodes = {};\n\t        // `_edges` is useful for quick lookup of all the links in the graph, without\n\t        // having to go through the whole cells array.\n\t        // [edgeId] -> true\n\t        this._edges = {};\n\n\t        this._batches = {};\n\n\t        cells.on('add', this._restructureOnAdd, this);\n\t        cells.on('remove', this._restructureOnRemove, this);\n\t        cells.on('reset', this._restructureOnReset, this);\n\t        cells.on('change:source', this._restructureOnChangeSource, this);\n\t        cells.on('change:target', this._restructureOnChangeTarget, this);\n\t        cells.on('remove', this._removeCell, this);\n\t    },\n\n\t    _sortOnChangeZ: function() {\n\n\t        this.get('cells').sort();\n\t    },\n\n\t    _restructureOnAdd: function(cell) {\n\n\t        if (cell.isLink()) {\n\t            this._edges[cell.id] = true;\n\t            var ref = cell.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\t            if (source.id) {\n\t                (this._out[source.id] || (this._out[source.id] = {}))[cell.id] = true;\n\t            }\n\t            if (target.id) {\n\t                (this._in[target.id] || (this._in[target.id] = {}))[cell.id] = true;\n\t            }\n\t        } else {\n\t            this._nodes[cell.id] = true;\n\t        }\n\t    },\n\n\t    _restructureOnRemove: function(cell) {\n\n\t        if (cell.isLink()) {\n\t            delete this._edges[cell.id];\n\t            var ref = cell.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\t            if (source.id && this._out[source.id] && this._out[source.id][cell.id]) {\n\t                delete this._out[source.id][cell.id];\n\t            }\n\t            if (target.id && this._in[target.id] && this._in[target.id][cell.id]) {\n\t                delete this._in[target.id][cell.id];\n\t            }\n\t        } else {\n\t            delete this._nodes[cell.id];\n\t        }\n\t    },\n\n\t    _restructureOnReset: function(cells) {\n\n\t        // Normalize into an array of cells. The original `cells` is GraphCells Backbone collection.\n\t        cells = cells.models;\n\n\t        this._out = {};\n\t        this._in = {};\n\t        this._nodes = {};\n\t        this._edges = {};\n\n\t        cells.forEach(this._restructureOnAdd, this);\n\t    },\n\n\t    _restructureOnChangeSource: function(link) {\n\n\t        var prevSource = link.previous('source');\n\t        if (prevSource.id && this._out[prevSource.id]) {\n\t            delete this._out[prevSource.id][link.id];\n\t        }\n\t        var source = link.attributes.source;\n\t        if (source.id) {\n\t            (this._out[source.id] || (this._out[source.id] = {}))[link.id] = true;\n\t        }\n\t    },\n\n\t    _restructureOnChangeTarget: function(link) {\n\n\t        var prevTarget = link.previous('target');\n\t        if (prevTarget.id && this._in[prevTarget.id]) {\n\t            delete this._in[prevTarget.id][link.id];\n\t        }\n\t        var target = link.get('target');\n\t        if (target.id) {\n\t            (this._in[target.id] || (this._in[target.id] = {}))[link.id] = true;\n\t        }\n\t    },\n\n\t    // Return all outbound edges for the node. Return value is an object\n\t    // of the form: [edgeId] -> true\n\t    getOutboundEdges: function(node) {\n\n\t        return (this._out && this._out[node]) || {};\n\t    },\n\n\t    // Return all inbound edges for the node. Return value is an object\n\t    // of the form: [edgeId] -> true\n\t    getInboundEdges: function(node) {\n\n\t        return (this._in && this._in[node]) || {};\n\t    },\n\n\t    toJSON: function() {\n\n\t        // Backbone does not recursively call `toJSON()` on attributes that are themselves models/collections.\n\t        // It just clones the attributes. Therefore, we must call `toJSON()` on the cells collection explicitly.\n\t        var json = Backbone.Model.prototype.toJSON.apply(this, arguments);\n\t        json.cells = this.get('cells').toJSON();\n\t        return json;\n\t    },\n\n\t    fromJSON: function(json, opt) {\n\n\t        if (!json.cells) {\n\n\t            throw new Error('Graph JSON must contain cells array.');\n\t        }\n\n\t        return this.set(json, opt);\n\t    },\n\n\t    set: function(key, val, opt) {\n\n\t        var attrs;\n\n\t        // Handle both `key`, value and {key: value} style arguments.\n\t        if (typeof key === 'object') {\n\t            attrs = key;\n\t            opt = val;\n\t        } else {\n\t            (attrs = {})[key] = val;\n\t        }\n\n\t        // Make sure that `cells` attribute is handled separately via resetCells().\n\t        if (attrs.hasOwnProperty('cells')) {\n\t            this.resetCells(attrs.cells, opt);\n\t            attrs = omit(attrs, 'cells');\n\t        }\n\n\t        // The rest of the attributes are applied via original set method.\n\t        return Backbone.Model.prototype.set.call(this, attrs, opt);\n\t    },\n\n\t    clear: function(opt) {\n\n\t        opt = assign({}, opt, { clear: true });\n\n\t        var collection = this.get('cells');\n\n\t        if (collection.length === 0) { return this; }\n\n\t        this.startBatch('clear', opt);\n\n\t        // The elements come after the links.\n\t        var cells = collection.sortBy(function(cell) {\n\t            return cell.isLink() ? 1 : 2;\n\t        });\n\n\t        do {\n\n\t            // Remove all the cells one by one.\n\t            // Note that all the links are removed first, so it's\n\t            // safe to remove the elements without removing the connected\n\t            // links first.\n\t            cells.shift().remove(opt);\n\n\t        } while (cells.length > 0);\n\n\t        this.stopBatch('clear');\n\n\t        return this;\n\t    },\n\n\t    _prepareCell: function(cell, opt) {\n\n\t        var attrs;\n\t        if (cell instanceof Backbone.Model) {\n\t            attrs = cell.attributes;\n\t            if (!cell.graph && (!opt || !opt.dry)) {\n\t                // An element can not be member of more than one graph.\n\t                // A cell stops being the member of the graph after it's explicitly removed.\n\t                cell.graph = this;\n\t            }\n\t        } else {\n\t            // In case we're dealing with a plain JS object, we have to set the reference\n\t            // to the `graph` right after the actual model is created. This happens in the `model()` function\n\t            // of `joint.dia.GraphCells`.\n\t            attrs = cell;\n\t        }\n\n\t        if (!isString(attrs.type)) {\n\t            throw new TypeError('dia.Graph: cell type must be a string.');\n\t        }\n\n\t        return cell;\n\t    },\n\n\t    minZIndex: function() {\n\n\t        var firstCell = this.get('cells').first();\n\t        return firstCell ? (firstCell.get('z') || 0) : 0;\n\t    },\n\n\t    maxZIndex: function() {\n\n\t        var lastCell = this.get('cells').last();\n\t        return lastCell ? (lastCell.get('z') || 0) : 0;\n\t    },\n\n\t    addCell: function(cell, opt) {\n\n\t        if (Array.isArray(cell)) {\n\n\t            return this.addCells(cell, opt);\n\t        }\n\n\t        if (cell instanceof Backbone.Model) {\n\n\t            if (!cell.has('z')) {\n\t                cell.set('z', this.maxZIndex() + 1);\n\t            }\n\n\t        } else if (cell.z === undefined) {\n\n\t            cell.z = this.maxZIndex() + 1;\n\t        }\n\n\t        this.get('cells').add(this._prepareCell(cell, opt), opt || {});\n\n\t        return this;\n\t    },\n\n\t    addCells: function(cells, opt) {\n\n\t        if (cells.length === 0) { return this; }\n\n\t        cells = flattenDeep(cells);\n\t        opt.maxPosition = opt.position = cells.length - 1;\n\n\t        this.startBatch('add', opt);\n\t        cells.forEach(function(cell) {\n\t            this.addCell(cell, opt);\n\t            opt.position--;\n\t        }, this);\n\t        this.stopBatch('add', opt);\n\n\t        return this;\n\t    },\n\n\t    // When adding a lot of cells, it is much more efficient to\n\t    // reset the entire cells collection in one go.\n\t    // Useful for bulk operations and optimizations.\n\t    resetCells: function(cells, opt) {\n\n\t        var preparedCells = toArray(cells).map(function(cell) {\n\t            return this._prepareCell(cell, opt);\n\t        }, this);\n\t        this.get('cells').reset(preparedCells, opt);\n\n\t        return this;\n\t    },\n\n\t    removeCells: function(cells, opt) {\n\n\t        if (cells.length) {\n\n\t            this.startBatch('remove');\n\t            invoke(cells, 'remove', opt);\n\t            this.stopBatch('remove');\n\t        }\n\n\t        return this;\n\t    },\n\n\t    _removeCell: function(cell, collection, options) {\n\n\t        options = options || {};\n\n\t        if (!options.clear) {\n\t            // Applications might provide a `disconnectLinks` option set to `true` in order to\n\t            // disconnect links when a cell is removed rather then removing them. The default\n\t            // is to remove all the associated links.\n\t            if (options.disconnectLinks) {\n\n\t                this.disconnectLinks(cell, options);\n\n\t            } else {\n\n\t                this.removeLinks(cell, options);\n\t            }\n\t        }\n\t        // Silently remove the cell from the cells collection. Silently, because\n\t        // `joint.dia.Cell.prototype.remove` already triggers the `remove` event which is\n\t        // then propagated to the graph model. If we didn't remove the cell silently, two `remove` events\n\t        // would be triggered on the graph model.\n\t        this.get('cells').remove(cell, { silent: true });\n\n\t        if (cell.graph === this) {\n\t            // Remove the element graph reference only if the cell is the member of this graph.\n\t            cell.graph = null;\n\t        }\n\t    },\n\n\t    // Get a cell by `id`.\n\t    getCell: function(id) {\n\n\t        return this.get('cells').get(id);\n\t    },\n\n\t    getCells: function() {\n\n\t        return this.get('cells').toArray();\n\t    },\n\n\t    getElements: function() {\n\n\t        return this.get('cells').filter(function (cell) { return cell.isElement(); });\n\t    },\n\n\t    getLinks: function() {\n\n\t        return this.get('cells').filter(function (cell) { return cell.isLink(); });\n\t    },\n\n\t    getFirstCell: function() {\n\n\t        return this.get('cells').first();\n\t    },\n\n\t    getLastCell: function() {\n\n\t        return this.get('cells').last();\n\t    },\n\n\t    // Get all inbound and outbound links connected to the cell `model`.\n\t    getConnectedLinks: function(model, opt) {\n\n\t        opt = opt || {};\n\n\t        var indirect = opt.indirect;\n\t        var inbound = opt.inbound;\n\t        var outbound = opt.outbound;\n\t        if ((inbound === undefined) && (outbound === undefined)) {\n\t            inbound = outbound = true;\n\t        }\n\n\t        // the final array of connected link models\n\t        var links = [];\n\t        // a hash table of connected edges of the form: [edgeId] -> true\n\t        // used for quick lookups to check if we already added a link\n\t        var edges = {};\n\n\t        if (outbound) {\n\t            addOutbounds(this, model);\n\t        }\n\t        if (inbound) {\n\t            addInbounds(this, model);\n\t        }\n\n\t        function addOutbounds(graph, model) {\n\t            forIn(graph.getOutboundEdges(model.id), function(_, edge) {\n\t                // skip links that were already added\n\t                // (those must be self-loop links)\n\t                // (because they are inbound and outbound edges of the same two elements)\n\t                if (edges[edge]) { return; }\n\t                var link = graph.getCell(edge);\n\t                links.push(link);\n\t                edges[edge] = true;\n\t                if (indirect) {\n\t                    if (inbound) { addInbounds(graph, link); }\n\t                    if (outbound) { addOutbounds(graph, link); }\n\t                }\n\t            }.bind(graph));\n\t            if (indirect && model.isLink()) {\n\t                var outCell = model.getTargetCell();\n\t                if (outCell && outCell.isLink()) {\n\t                    if (!edges[outCell.id]) {\n\t                        links.push(outCell);\n\t                        addOutbounds(graph, outCell);\n\t                    }\n\t                }\n\t            }\n\t        }\n\n\t        function addInbounds(graph, model) {\n\t            forIn(graph.getInboundEdges(model.id), function(_, edge) {\n\t                // skip links that were already added\n\t                // (those must be self-loop links)\n\t                // (because they are inbound and outbound edges of the same two elements)\n\t                if (edges[edge]) { return; }\n\t                var link = graph.getCell(edge);\n\t                links.push(link);\n\t                edges[edge] = true;\n\t                if (indirect) {\n\t                    if (inbound) { addInbounds(graph, link); }\n\t                    if (outbound) { addOutbounds(graph, link); }\n\t                }\n\t            }.bind(graph));\n\t            if (indirect && model.isLink()) {\n\t                var inCell = model.getSourceCell();\n\t                if (inCell && inCell.isLink()) {\n\t                    if (!edges[inCell.id]) {\n\t                        links.push(inCell);\n\t                        addInbounds(graph, inCell);\n\t                    }\n\t                }\n\t            }\n\t        }\n\n\t        // if `deep` option is `true`, check also all the links that are connected to any of the descendant cells\n\t        if (opt.deep) {\n\n\t            var embeddedCells = model.getEmbeddedCells({ deep: true });\n\n\t            // in the first round, we collect all the embedded elements\n\t            var embeddedElements = {};\n\t            embeddedCells.forEach(function(cell) {\n\t                if (cell.isElement()) {\n\t                    embeddedElements[cell.id] = true;\n\t                }\n\t            });\n\n\t            embeddedCells.forEach(function(cell) {\n\t                if (cell.isLink()) { return; }\n\t                if (outbound) {\n\t                    forIn(this.getOutboundEdges(cell.id), function(exists, edge) {\n\t                        if (!edges[edge]) {\n\t                            var edgeCell = this.getCell(edge);\n\t                            var ref = edgeCell.attributes;\n\t                            var source = ref.source;\n\t                            var target = ref.target;\n\t                            var sourceId = source.id;\n\t                            var targetId = target.id;\n\n\t                            // if `includeEnclosed` option is falsy, skip enclosed links\n\t                            if (!opt.includeEnclosed\n\t                                && (sourceId && embeddedElements[sourceId])\n\t                                && (targetId && embeddedElements[targetId])) {\n\t                                return;\n\t                            }\n\n\t                            links.push(this.getCell(edge));\n\t                            edges[edge] = true;\n\t                        }\n\t                    }.bind(this));\n\t                }\n\t                if (inbound) {\n\t                    forIn(this.getInboundEdges(cell.id), function(exists, edge) {\n\t                        if (!edges[edge]) {\n\t                            var edgeCell = this.getCell(edge);\n\t                            var ref = edgeCell.attributes;\n\t                            var source = ref.source;\n\t                            var target = ref.target;\n\t                            var sourceId = source.id;\n\t                            var targetId = target.id;\n\n\t                            // if `includeEnclosed` option is falsy, skip enclosed links\n\t                            if (!opt.includeEnclosed\n\t                                && (sourceId && embeddedElements[sourceId])\n\t                                && (targetId && embeddedElements[targetId])) {\n\t                                return;\n\t                            }\n\n\t                            links.push(this.getCell(edge));\n\t                            edges[edge] = true;\n\t                        }\n\t                    }.bind(this));\n\t                }\n\t            }, this);\n\t        }\n\n\t        return links;\n\t    },\n\n\t    getNeighbors: function(model, opt) {\n\n\t        opt || (opt = {});\n\n\t        var inbound = opt.inbound;\n\t        var outbound = opt.outbound;\n\t        if (inbound === undefined && outbound === undefined) {\n\t            inbound = outbound = true;\n\t        }\n\n\t        var neighbors = this.getConnectedLinks(model, opt).reduce(function(res, link) {\n\n\t            var ref = link.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\t            var loop = link.hasLoop(opt);\n\n\t            // Discard if it is a point, or if the neighbor was already added.\n\t            if (inbound && has$2(source, 'id') && !res[source.id]) {\n\n\t                var sourceElement = this.getCell(source.id);\n\t                if (sourceElement.isElement()) {\n\t                    if (loop || (sourceElement && sourceElement !== model && (!opt.deep || !sourceElement.isEmbeddedIn(model)))) {\n\t                        res[source.id] = sourceElement;\n\t                    }\n\t                }\n\t            }\n\n\t            // Discard if it is a point, or if the neighbor was already added.\n\t            if (outbound && has$2(target, 'id') && !res[target.id]) {\n\n\t                var targetElement = this.getCell(target.id);\n\t                if (targetElement.isElement()) {\n\t                    if (loop || (targetElement && targetElement !== model && (!opt.deep || !targetElement.isEmbeddedIn(model)))) {\n\t                        res[target.id] = targetElement;\n\t                    }\n\t                }\n\t            }\n\n\t            return res;\n\t        }.bind(this), {});\n\n\t        if (model.isLink()) {\n\t            if (inbound) {\n\t                var sourceCell = model.getSourceCell();\n\t                if (sourceCell && sourceCell.isElement() && !neighbors[sourceCell.id]) {\n\t                    neighbors[sourceCell.id] = sourceCell;\n\t                }\n\t            }\n\t            if (outbound) {\n\t                var targetCell = model.getTargetCell();\n\t                if (targetCell && targetCell.isElement() && !neighbors[targetCell.id]) {\n\t                    neighbors[targetCell.id] = targetCell;\n\t                }\n\t            }\n\t        }\n\n\t        return toArray(neighbors);\n\t    },\n\n\t    getCommonAncestor: function(/* cells */) {\n\n\t        var cellsAncestors = Array.from(arguments).map(function(cell) {\n\n\t            var ancestors = [];\n\t            var parentId = cell.get('parent');\n\n\t            while (parentId) {\n\n\t                ancestors.push(parentId);\n\t                parentId = this.getCell(parentId).get('parent');\n\t            }\n\n\t            return ancestors;\n\n\t        }, this);\n\n\t        cellsAncestors = cellsAncestors.sort(function(a, b) {\n\t            return a.length - b.length;\n\t        });\n\n\t        var commonAncestor = toArray(cellsAncestors.shift()).find(function(ancestor) {\n\t            return cellsAncestors.every(function(cellAncestors) {\n\t                return cellAncestors.includes(ancestor);\n\t            });\n\t        });\n\n\t        return this.getCell(commonAncestor);\n\t    },\n\n\t    // Find the whole branch starting at `element`.\n\t    // If `opt.deep` is `true`, take into account embedded elements too.\n\t    // If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.\n\t    getSuccessors: function(element, opt) {\n\n\t        opt = opt || {};\n\t        var res = [];\n\t        // Modify the options so that it includes the `outbound` neighbors only. In other words, search forwards.\n\t        this.search(element, function(el) {\n\t            if (el !== element) {\n\t                res.push(el);\n\t            }\n\t        }, assign({}, opt, { outbound: true }));\n\t        return res;\n\t    },\n\n\t    cloneCells: cloneCells,\n\t    // Clone the whole subgraph (including all the connected links whose source/target is in the subgraph).\n\t    // If `opt.deep` is `true`, also take into account all the embedded cells of all the subgraph cells.\n\t    // Return a map of the form: [original cell ID] -> [clone].\n\t    cloneSubgraph: function(cells, opt) {\n\n\t        var subgraph = this.getSubgraph(cells, opt);\n\t        return this.cloneCells(subgraph);\n\t    },\n\n\t    // Return `cells` and all the connected links that connect cells in the `cells` array.\n\t    // If `opt.deep` is `true`, return all the cells including all their embedded cells\n\t    // and all the links that connect any of the returned cells.\n\t    // For example, for a single shallow element, the result is that very same element.\n\t    // For two elements connected with a link: `A --- L ---> B`, the result for\n\t    // `getSubgraph([A, B])` is `[A, L, B]`. The same goes for `getSubgraph([L])`, the result is again `[A, L, B]`.\n\t    getSubgraph: function(cells, opt) {\n\n\t        opt = opt || {};\n\n\t        var subgraph = [];\n\t        // `cellMap` is used for a quick lookup of existence of a cell in the `cells` array.\n\t        var cellMap = {};\n\t        var elements = [];\n\t        var links = [];\n\n\t        toArray(cells).forEach(function(cell) {\n\t            if (!cellMap[cell.id]) {\n\t                subgraph.push(cell);\n\t                cellMap[cell.id] = cell;\n\t                if (cell.isLink()) {\n\t                    links.push(cell);\n\t                } else {\n\t                    elements.push(cell);\n\t                }\n\t            }\n\n\t            if (opt.deep) {\n\t                var embeds = cell.getEmbeddedCells({ deep: true });\n\t                embeds.forEach(function(embed) {\n\t                    if (!cellMap[embed.id]) {\n\t                        subgraph.push(embed);\n\t                        cellMap[embed.id] = embed;\n\t                        if (embed.isLink()) {\n\t                            links.push(embed);\n\t                        } else {\n\t                            elements.push(embed);\n\t                        }\n\t                    }\n\t                });\n\t            }\n\t        });\n\n\t        links.forEach(function(link) {\n\t            // For links, return their source & target (if they are elements - not points).\n\t            var ref = link.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\t            if (source.id && !cellMap[source.id]) {\n\t                var sourceElement = this.getCell(source.id);\n\t                subgraph.push(sourceElement);\n\t                cellMap[sourceElement.id] = sourceElement;\n\t                elements.push(sourceElement);\n\t            }\n\t            if (target.id && !cellMap[target.id]) {\n\t                var targetElement = this.getCell(target.id);\n\t                subgraph.push(this.getCell(target.id));\n\t                cellMap[targetElement.id] = targetElement;\n\t                elements.push(targetElement);\n\t            }\n\t        }, this);\n\n\t        elements.forEach(function(element) {\n\t            // For elements, include their connected links if their source/target is in the subgraph;\n\t            var links = this.getConnectedLinks(element, opt);\n\t            links.forEach(function(link) {\n\t                var ref = link.attributes;\n\t                var source = ref.source;\n\t                var target = ref.target;\n\t                if (!cellMap[link.id] && source.id && cellMap[source.id] && target.id && cellMap[target.id]) {\n\t                    subgraph.push(link);\n\t                    cellMap[link.id] = link;\n\t                }\n\t            });\n\t        }, this);\n\n\t        return subgraph;\n\t    },\n\n\t    // Find all the predecessors of `element`. This is a reverse operation of `getSuccessors()`.\n\t    // If `opt.deep` is `true`, take into account embedded elements too.\n\t    // If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.\n\t    getPredecessors: function(element, opt) {\n\n\t        opt = opt || {};\n\t        var res = [];\n\t        // Modify the options so that it includes the `inbound` neighbors only. In other words, search backwards.\n\t        this.search(element, function(el) {\n\t            if (el !== element) {\n\t                res.push(el);\n\t            }\n\t        }, assign({}, opt, { inbound: true }));\n\t        return res;\n\t    },\n\n\t    // Perform search on the graph.\n\t    // If `opt.breadthFirst` is `true`, use the Breadth-first Search algorithm, otherwise use Depth-first search.\n\t    // By setting `opt.inbound` to `true`, you can reverse the direction of the search.\n\t    // If `opt.deep` is `true`, take into account embedded elements too.\n\t    // `iteratee` is a function of the form `function(element) {}`.\n\t    // If `iteratee` explicitly returns `false`, the searching stops.\n\t    search: function(element, iteratee, opt) {\n\n\t        opt = opt || {};\n\t        if (opt.breadthFirst) {\n\t            this.bfs(element, iteratee, opt);\n\t        } else {\n\t            this.dfs(element, iteratee, opt);\n\t        }\n\t    },\n\n\t    // Breadth-first search.\n\t    // If `opt.deep` is `true`, take into account embedded elements too.\n\t    // If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).\n\t    // `iteratee` is a function of the form `function(element, distance) {}`.\n\t    // where `element` is the currently visited element and `distance` is the distance of that element\n\t    // from the root `element` passed the `bfs()`, i.e. the element we started the search from.\n\t    // Note that the `distance` is not the shortest or longest distance, it is simply the number of levels\n\t    // crossed till we visited the `element` for the first time. It is especially useful for tree graphs.\n\t    // If `iteratee` explicitly returns `false`, the searching stops.\n\t    bfs: function(element, iteratee, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        var visited = {};\n\t        var distance = {};\n\t        var queue = [];\n\n\t        queue.push(element);\n\t        distance[element.id] = 0;\n\n\t        while (queue.length > 0) {\n\t            var next = queue.shift();\n\t            if (visited[next.id]) { continue; }\n\t            visited[next.id] = true;\n\t            if (iteratee.call(this, next, distance[next.id]) === false) { continue; }\n\t            var neighbors = this.getNeighbors(next, opt);\n\t            for (var i = 0, n = neighbors.length; i < n; i++) {\n\t                var neighbor = neighbors[i];\n\t                distance[neighbor.id] = distance[next.id] + 1;\n\t                queue.push(neighbor);\n\t            }\n\t        }\n\t    },\n\n\t    // Depth-first search.\n\t    // If `opt.deep` is `true`, take into account embedded elements too.\n\t    // If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).\n\t    // `iteratee` is a function of the form `function(element, distance) {}`.\n\t    // If `iteratee` explicitly returns `false`, the search stops.\n\t    dfs: function(element, iteratee, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        var visited = {};\n\t        var distance = {};\n\t        var queue = [];\n\n\t        queue.push(element);\n\t        distance[element.id] = 0;\n\n\t        while (queue.length > 0) {\n\t            var next = queue.pop();\n\t            if (visited[next.id]) { continue; }\n\t            visited[next.id] = true;\n\t            if (iteratee.call(this, next, distance[next.id]) === false) { continue; }\n\t            var neighbors = this.getNeighbors(next, opt);\n\t            var lastIndex = queue.length;\n\t            for (var i = 0, n = neighbors.length; i < n; i++) {\n\t                var neighbor = neighbors[i];\n\t                distance[neighbor.id] = distance[next.id] + 1;\n\t                queue.splice(lastIndex, 0, neighbor);\n\t            }\n\t        }\n\t    },\n\n\t    // Get all the roots of the graph. Time complexity: O(|V|).\n\t    getSources: function() {\n\n\t        var sources = [];\n\t        forIn(this._nodes, function(exists, node) {\n\t            if (!this._in[node] || isEmpty(this._in[node])) {\n\t                sources.push(this.getCell(node));\n\t            }\n\t        }.bind(this));\n\t        return sources;\n\t    },\n\n\t    // Get all the leafs of the graph. Time complexity: O(|V|).\n\t    getSinks: function() {\n\n\t        var sinks = [];\n\t        forIn(this._nodes, function(exists, node) {\n\t            if (!this._out[node] || isEmpty(this._out[node])) {\n\t                sinks.push(this.getCell(node));\n\t            }\n\t        }.bind(this));\n\t        return sinks;\n\t    },\n\n\t    // Return `true` if `element` is a root. Time complexity: O(1).\n\t    isSource: function(element) {\n\n\t        return !this._in[element.id] || isEmpty(this._in[element.id]);\n\t    },\n\n\t    // Return `true` if `element` is a leaf. Time complexity: O(1).\n\t    isSink: function(element) {\n\n\t        return !this._out[element.id] || isEmpty(this._out[element.id]);\n\t    },\n\n\t    // Return `true` is `elementB` is a successor of `elementA`. Return `false` otherwise.\n\t    isSuccessor: function(elementA, elementB) {\n\n\t        var isSuccessor = false;\n\t        this.search(elementA, function(element) {\n\t            if (element === elementB && element !== elementA) {\n\t                isSuccessor = true;\n\t                return false;\n\t            }\n\t        }, { outbound: true });\n\t        return isSuccessor;\n\t    },\n\n\t    // Return `true` is `elementB` is a predecessor of `elementA`. Return `false` otherwise.\n\t    isPredecessor: function(elementA, elementB) {\n\n\t        var isPredecessor = false;\n\t        this.search(elementA, function(element) {\n\t            if (element === elementB && element !== elementA) {\n\t                isPredecessor = true;\n\t                return false;\n\t            }\n\t        }, { inbound: true });\n\t        return isPredecessor;\n\t    },\n\n\t    // Return `true` is `elementB` is a neighbor of `elementA`. Return `false` otherwise.\n\t    // `opt.deep` controls whether to take into account embedded elements as well. See `getNeighbors()`\n\t    // for more details.\n\t    // If `opt.outbound` is set to `true`, return `true` only if `elementB` is a successor neighbor.\n\t    // Similarly, if `opt.inbound` is set to `true`, return `true` only if `elementB` is a predecessor neighbor.\n\t    isNeighbor: function(elementA, elementB, opt) {\n\n\t        opt = opt || {};\n\n\t        var inbound = opt.inbound;\n\t        var outbound = opt.outbound;\n\t        if ((inbound === undefined) && (outbound === undefined)) {\n\t            inbound = outbound = true;\n\t        }\n\n\t        var isNeighbor = false;\n\n\t        this.getConnectedLinks(elementA, opt).forEach(function(link) {\n\n\t            var ref = link.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\n\t            // Discard if it is a point.\n\t            if (inbound && has$2(source, 'id') && (source.id === elementB.id)) {\n\t                isNeighbor = true;\n\t                return false;\n\t            }\n\n\t            // Discard if it is a point, or if the neighbor was already added.\n\t            if (outbound && has$2(target, 'id') && (target.id === elementB.id)) {\n\t                isNeighbor = true;\n\t                return false;\n\t            }\n\t        });\n\n\t        return isNeighbor;\n\t    },\n\n\t    // Disconnect links connected to the cell `model`.\n\t    disconnectLinks: function(model, opt) {\n\n\t        this.getConnectedLinks(model).forEach(function(link) {\n\n\t            link.set((link.attributes.source.id === model.id ? 'source' : 'target'), { x: 0, y: 0 }, opt);\n\t        });\n\t    },\n\n\t    // Remove links connected to the cell `model` completely.\n\t    removeLinks: function(model, opt) {\n\n\t        invoke(this.getConnectedLinks(model), 'remove', opt);\n\t    },\n\n\t    // Find all elements at given point\n\t    findModelsFromPoint: function(p) {\n\t        return this.getElements().filter(function (el) { return el.getBBox({ rotate: true }).containsPoint(p); });\n\t    },\n\n\t    // Find all elements in given area\n\t    findModelsInArea: function(rect, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        var r = new Rect(rect);\n\t        var strict = opt.strict; if ( strict === void 0 ) strict = false;\n\t        var method = strict ? 'containsRect' : 'intersect';\n\t        return this.getElements().filter(function (el) { return r[method](el.getBBox({ rotate: true })); });\n\t    },\n\n\t    // Find all elements under the given element.\n\t    findModelsUnderElement: function(element, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        var searchBy = opt.searchBy; if ( searchBy === void 0 ) searchBy = 'bbox';\n\t        var bbox = element.getBBox().rotateAroundCenter(element.angle());\n\t        var elements = (searchBy === 'bbox')\n\t            ? this.findModelsInArea(bbox)\n\t            : this.findModelsFromPoint(bbox[searchBy]());\n\t        // don't account element itself or any of its descendants\n\t        return elements.filter(function (el) { return element.id !== el.id && !el.isEmbeddedIn(element); });\n\t    },\n\n\t    // Return bounding box of all elements.\n\t    getBBox: function() {\n\n\t        return this.getCellsBBox(this.getCells());\n\t    },\n\n\t    // Return the bounding box of all cells in array provided.\n\t    getCellsBBox: function(cells, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        var rotate = opt.rotate; if ( rotate === void 0 ) rotate = true;\n\t        return toArray(cells).reduce(function(memo, cell) {\n\t            var rect = cell.getBBox({ rotate: rotate });\n\t            if (!rect) { return memo; }\n\t            if (memo) {\n\t                return memo.union(rect);\n\t            }\n\t            return rect;\n\t        }, null);\n\t    },\n\n\t    translate: function(dx, dy, opt) {\n\n\t        // Don't translate cells that are embedded in any other cell.\n\t        var cells = this.getCells().filter(function(cell) {\n\t            return !cell.isEmbedded();\n\t        });\n\n\t        invoke(cells, 'translate', dx, dy, opt);\n\n\t        return this;\n\t    },\n\n\t    resize: function(width, height, opt) {\n\n\t        return this.resizeCells(width, height, this.getCells(), opt);\n\t    },\n\n\t    resizeCells: function(width, height, cells, opt) {\n\n\t        // `getBBox` method returns `null` if no elements provided.\n\t        // i.e. cells can be an array of links\n\t        var bbox = this.getCellsBBox(cells);\n\t        if (bbox) {\n\t            var sx = Math.max(width / bbox.width, 0);\n\t            var sy = Math.max(height / bbox.height, 0);\n\t            invoke(cells, 'scale', sx, sy, bbox.origin(), opt);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    startBatch: function(name, data) {\n\n\t        data = data || {};\n\t        this._batches[name] = (this._batches[name] || 0) + 1;\n\n\t        return this.trigger('batch:start', assign({}, data, { batchName: name }));\n\t    },\n\n\t    stopBatch: function(name, data) {\n\n\t        data = data || {};\n\t        this._batches[name] = (this._batches[name] || 0) - 1;\n\n\t        return this.trigger('batch:stop', assign({}, data, { batchName: name }));\n\t    },\n\n\t    hasActiveBatch: function(name) {\n\n\t        var batches = this._batches;\n\t        var names;\n\n\t        if (arguments.length === 0) {\n\t            names = Object.keys(batches);\n\t        } else if (Array.isArray(name)) {\n\t            names = name;\n\t        } else {\n\t            names = [name];\n\t        }\n\n\t        return names.some(function (batch) { return batches[batch] > 0; });\n\t    }\n\n\t}, {\n\n\t    validations: {\n\n\t        multiLinks: function(graph, link) {\n\n\t            // Do not allow multiple links to have the same source and target.\n\t            var ref = link.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\n\t            if (source.id && target.id) {\n\n\t                var sourceModel = link.getSourceCell();\n\t                if (sourceModel) {\n\n\t                    var connectedLinks = graph.getConnectedLinks(sourceModel, { outbound: true });\n\t                    var sameLinks = connectedLinks.filter(function(_link) {\n\n\t                        var ref = _link.attributes;\n\t                        var _source = ref.source;\n\t                        var _target = ref.target;\n\t                        return _source && _source.id === source.id &&\n\t                            (!_source.port || (_source.port === source.port)) &&\n\t                            _target && _target.id === target.id &&\n\t                            (!_target.port || (_target.port === target.port));\n\n\t                    });\n\n\t                    if (sameLinks.length > 1) {\n\t                        return false;\n\t                    }\n\t                }\n\t            }\n\n\t            return true;\n\t        },\n\n\t        linkPinning: function(_graph, link) {\n\t            var ref = link.attributes;\n\t            var source = ref.source;\n\t            var target = ref.target;\n\t            return source.id && target.id;\n\t        }\n\t    }\n\n\t});\n\n\twrapWith(Graph.prototype, ['resetCells', 'addCells', 'removeCells'], wrappers.cells);\n\n\tvar views = {};\n\n\tvar View = Backbone.View.extend({\n\n\t    options: {},\n\t    theme: null,\n\t    themeClassNamePrefix: addClassNamePrefix('theme-'),\n\t    requireSetThemeOverride: false,\n\t    defaultTheme: config.defaultTheme,\n\t    children: null,\n\t    childNodes: null,\n\n\t    DETACHABLE: true,\n\t    UPDATE_PRIORITY: 2,\n\t    FLAG_INSERT: 1<<30,\n\t    FLAG_REMOVE: 1<<29,\n\n\t    constructor: function(options) {\n\n\t        this.requireSetThemeOverride = options && !!options.theme;\n\t        this.options = assign({}, this.options, options);\n\n\t        Backbone.View.call(this, options);\n\t    },\n\n\t    initialize: function() {\n\n\t        views[this.cid] = this;\n\n\t        this.setTheme(this.options.theme || this.defaultTheme);\n\t        this.init();\n\t    },\n\n\t    unmount: function() {\n\t        if (this.svgElement) {\n\t            this.vel.remove();\n\t        } else {\n\t            this.$el.remove();\n\t        }\n\t    },\n\n\t    renderChildren: function(children) {\n\t        children || (children = result(this, 'children'));\n\t        if (children) {\n\t            var isSVG = this.svgElement;\n\t            var namespace = V.namespace[isSVG ? 'svg' : 'xhtml'];\n\t            var doc = parseDOMJSON(children, namespace);\n\t            (isSVG ? this.vel : this.$el).empty().append(doc.fragment);\n\t            this.childNodes = doc.selectors;\n\t        }\n\t        return this;\n\t    },\n\n\t    findAttribute: function(attributeName, node) {\n\n\t        var currentNode = node;\n\n\t        while (currentNode && currentNode.nodeType === 1) {\n\t            var attributeValue = currentNode.getAttribute(attributeName);\n\t            // attribute found\n\t            if (attributeValue) { return attributeValue; }\n\t            // do not climb up the DOM\n\t            if (currentNode === this.el) { return null; }\n\t            // try parent node\n\t            currentNode = currentNode.parentNode;\n\t        }\n\n\t        return null;\n\t    },\n\n\t    // Override the Backbone `_ensureElement()` method in order to create an\n\t    // svg element (e.g., `<g>`) node that wraps all the nodes of the Cell view.\n\t    // Expose class name setter as a separate method.\n\t    _ensureElement: function() {\n\t        if (!this.el) {\n\t            var tagName = result(this, 'tagName');\n\t            var attrs = assign({}, result(this, 'attributes'));\n\t            var style = assign({}, result(this, 'style'));\n\t            if (this.id) { attrs.id = result(this, 'id'); }\n\t            this.setElement(this._createElement(tagName));\n\t            this._setAttributes(attrs);\n\t            this._setStyle(style);\n\t        } else {\n\t            this.setElement(result(this, 'el'));\n\t        }\n\t        this._ensureElClassName();\n\t    },\n\n\t    _setAttributes: function(attrs) {\n\t        if (this.svgElement) {\n\t            this.vel.attr(attrs);\n\t        } else {\n\t            this.$el.attr(attrs);\n\t        }\n\t    },\n\n\t    _setStyle: function(style) {\n\t        this.$el.css(style);\n\t    },\n\n\t    _createElement: function(tagName) {\n\t        if (this.svgElement) {\n\t            return document.createElementNS(V.namespace.svg, tagName);\n\t        } else {\n\t            return document.createElement(tagName);\n\t        }\n\t    },\n\n\t    // Utilize an alternative DOM manipulation API by\n\t    // adding an element reference wrapped in Vectorizer.\n\t    _setElement: function(el) {\n\t        this.$el = el instanceof Backbone.$ ? el : Backbone.$(el);\n\t        this.el = this.$el[0];\n\t        if (this.svgElement) { this.vel = V(this.el); }\n\t    },\n\n\t    _ensureElClassName: function() {\n\t        var className = result(this, 'className');\n\t        if (!className) { return; }\n\t        var prefixedClassName = addClassNamePrefix(className);\n\t        // Note: className removal here kept for backwards compatibility only\n\t        if (this.svgElement) {\n\t            this.vel.removeClass(className).addClass(prefixedClassName);\n\t        } else {\n\t            this.$el.removeClass(className).addClass(prefixedClassName);\n\t        }\n\t    },\n\n\t    init: function() {\n\t        // Intentionally empty.\n\t        // This method is meant to be overridden.\n\t    },\n\n\t    onRender: function() {\n\t        // Intentionally empty.\n\t        // This method is meant to be overridden.\n\t    },\n\n\t    confirmUpdate: function() {\n\t        // Intentionally empty.\n\t        // This method is meant to be overridden.\n\t        return 0;\n\t    },\n\n\t    setTheme: function(theme, opt) {\n\n\t        opt = opt || {};\n\n\t        // Theme is already set, override is required, and override has not been set.\n\t        // Don't set the theme.\n\t        if (this.theme && this.requireSetThemeOverride && !opt.override) {\n\t            return this;\n\t        }\n\n\t        this.removeThemeClassName();\n\t        this.addThemeClassName(theme);\n\t        this.onSetTheme(this.theme/* oldTheme */, theme/* newTheme */);\n\t        this.theme = theme;\n\n\t        return this;\n\t    },\n\n\t    addThemeClassName: function(theme) {\n\n\t        theme = theme || this.theme;\n\t        if (!theme) { return this; }\n\n\t        var className = this.themeClassNamePrefix + theme;\n\n\t        if (this.svgElement) {\n\t            this.vel.addClass(className);\n\t        } else {\n\t            this.$el.addClass(className);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    removeThemeClassName: function(theme) {\n\n\t        theme = theme || this.theme;\n\n\t        var className = this.themeClassNamePrefix + theme;\n\n\t        if (this.svgElement) {\n\t            this.vel.removeClass(className);\n\t        } else {\n\t            this.$el.removeClass(className);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    onSetTheme: function(oldTheme, newTheme) {\n\t        // Intentionally empty.\n\t        // This method is meant to be overridden.\n\t    },\n\n\t    remove: function() {\n\n\t        this.onRemove();\n\t        this.undelegateDocumentEvents();\n\n\t        views[this.cid] = null;\n\n\t        Backbone.View.prototype.remove.apply(this, arguments);\n\n\t        return this;\n\t    },\n\n\t    onRemove: function() {\n\t        // Intentionally empty.\n\t        // This method is meant to be overridden.\n\t    },\n\n\t    getEventNamespace: function() {\n\t        // Returns a per-session unique namespace\n\t        return '.joint-event-ns-' + this.cid;\n\t    },\n\n\t    delegateElementEvents: function(element, events, data) {\n\t        if (!events) { return this; }\n\t        data || (data = {});\n\t        var eventNS = this.getEventNamespace();\n\t        for (var eventName in events) {\n\t            var method = events[eventName];\n\t            if (typeof method !== 'function') { method = this[method]; }\n\t            if (!method) { continue; }\n\t            $(element).on(eventName + eventNS, data, method.bind(this));\n\t        }\n\t        return this;\n\t    },\n\n\t    undelegateElementEvents: function(element) {\n\t        $(element).off(this.getEventNamespace());\n\t        return this;\n\t    },\n\n\t    delegateDocumentEvents: function(events, data) {\n\t        events || (events = result(this, 'documentEvents'));\n\t        return this.delegateElementEvents(document, events, data);\n\t    },\n\n\t    undelegateDocumentEvents: function() {\n\t        return this.undelegateElementEvents(document);\n\t    },\n\n\t    eventData: function(evt, data) {\n\t        if (!evt) { throw new Error('eventData(): event object required.'); }\n\t        var currentData = evt.data;\n\t        var key = '__' + this.cid + '__';\n\t        if (data === undefined) {\n\t            if (!currentData) { return {}; }\n\t            return currentData[key] || {};\n\t        }\n\t        currentData || (currentData = evt.data = {});\n\t        currentData[key] || (currentData[key] = {});\n\t        assign(currentData[key], data);\n\t        return this;\n\t    },\n\n\t    stopPropagation: function(evt) {\n\t        this.eventData(evt, { propagationStopped: true });\n\t        return this;\n\t    },\n\n\t    isPropagationStopped: function(evt) {\n\t        return !!this.eventData(evt).propagationStopped;\n\t    }\n\n\t}, {\n\n\t    extend: function() {\n\n\t        var args = Array.from(arguments);\n\n\t        // Deep clone the prototype and static properties objects.\n\t        // This prevents unexpected behavior where some properties are overwritten outside of this function.\n\t        var protoProps = args[0] && assign({}, args[0]) || {};\n\t        var staticProps = args[1] && assign({}, args[1]) || {};\n\n\t        // Need the real render method so that we can wrap it and call it later.\n\t        var renderFn = protoProps.render || (this.prototype && this.prototype.render) || null;\n\n\t        /*\n\t            Wrap the real render method so that:\n\t                .. `onRender` is always called.\n\t                .. `this` is always returned.\n\t        */\n\t        protoProps.render = function() {\n\n\t            if (typeof renderFn === 'function') {\n\t                // Call the original render method.\n\t                renderFn.apply(this, arguments);\n\t            }\n\n\t            if (this.render.__render__ === renderFn) {\n\t                // Should always call onRender() method.\n\t                // Should call it only once when renderFn is actual prototype method i.e. not the wrapper\n\t                this.onRender();\n\t            }\n\n\t            // Should always return itself.\n\t            return this;\n\t        };\n\n\t        protoProps.render.__render__ = renderFn;\n\n\t        return Backbone.View.extend.call(this, protoProps, staticProps);\n\t    }\n\t});\n\n\tvar DoubleTapEventName = 'dbltap';\n\tif ($.event && !(DoubleTapEventName in $.event.special)) {\n\t    var maxDelay = config.doubleTapInterval;\n\t    var minDelay = 30;\n\t    $.event.special[DoubleTapEventName] = {\n\t        bindType: 'touchend',\n\t        delegateType: 'touchend',\n\t        handle: function(event) {\n\t            var ref;\n\n\t            var args = [], len = arguments.length - 1;\n\t            while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\t            var handleObj = event.handleObj;\n\t            var target = event.target;\n\t            var targetData  = $.data(target);\n\t            var now = new Date().getTime();\n\t            var delta = 'lastTouch' in targetData ? now - targetData.lastTouch : 0;\n\t            if (delta < maxDelay && delta > minDelay) {\n\t                targetData.lastTouch = null;\n\t                event.type = handleObj.origType;\n\t                // let jQuery handle the triggering of \"dbltap\" event handlers\n\t                (ref = handleObj.handler).call.apply(ref, [ this, event ].concat( args ));\n\t            } else {\n\t                targetData.lastTouch = now;\n\t            }\n\t        }\n\t    };\n\t}\n\n\tvar index$1 = ({\n\t\tviews: views,\n\t\tView: View\n\t});\n\n\tvar LayersNames = {\n\t    CELLS: 'cells',\n\t    BACK: 'back',\n\t    FRONT: 'front',\n\t    TOOLS: 'tools',\n\t    LABELS: 'labels'\n\t};\n\n\tvar PaperLayer = View.extend({\n\n\t    tagName: 'g',\n\t    svgElement: true,\n\t    pivotNodes: null,\n\t    defaultTheme: null,\n\n\t    options: {\n\t        name: ''\n\t    },\n\n\t    className: function() {\n\t        return addClassNamePrefix(((this.options.name) + \"-layer\"));\n\t    },\n\n\t    init: function() {\n\t        this.pivotNodes = {};\n\t    },\n\n\t    insertSortedNode: function(node, z) {\n\t        this.el.insertBefore(node, this.insertPivot(z));\n\t    },\n\n\t    insertNode: function(node) {\n\t        var ref = this;\n\t        var el = ref.el;\n\t        if (node.parentNode !== el) {\n\t            el.appendChild(node);\n\t        }\n\t    },\n\n\t    insertPivot: function(z) {\n\t        var ref = this;\n\t        var el = ref.el;\n\t        var pivotNodes = ref.pivotNodes;\n\t        z = +z;\n\t        z || (z = 0);\n\t        var pivotNode = pivotNodes[z];\n\t        if (pivotNode) { return pivotNode; }\n\t        pivotNode = pivotNodes[z] = document.createComment('z-index:' + (z + 1));\n\t        var neighborZ = -Infinity;\n\t        for (var currentZ in pivotNodes) {\n\t            currentZ = +currentZ;\n\t            if (currentZ < z && currentZ > neighborZ) {\n\t                neighborZ = currentZ;\n\t                if (neighborZ === z - 1) { continue; }\n\t            }\n\t        }\n\t        if (neighborZ !== -Infinity) {\n\t            var neighborPivot = pivotNodes[neighborZ];\n\t            // Insert After\n\t            el.insertBefore(pivotNode, neighborPivot.nextSibling);\n\t        } else {\n\t            // First Child\n\t            el.insertBefore(pivotNode, el.firstChild);\n\t        }\n\t        return pivotNode;\n\t    },\n\n\t    removePivots: function() {\n\t        var ref = this;\n\t        var el = ref.el;\n\t        var pivotNodes = ref.pivotNodes;\n\t        for (var z in pivotNodes) { el.removeChild(pivotNodes[z]); }\n\t        this.pivotNodes = {};\n\t    }\n\n\t});\n\n\tfunction toArray$1(obj) {\n\t    if (!obj) { return []; }\n\t    if (Array.isArray(obj)) { return obj; }\n\t    return [obj];\n\t}\n\n\tvar HighlighterView = View.extend({\n\n\t    tagName: 'g',\n\t    svgElement: true,\n\t    className: 'highlight',\n\n\t    HIGHLIGHT_FLAG: 1,\n\t    UPDATE_PRIORITY: 3,\n\t    DETACHABLE: false,\n\t    UPDATABLE: true,\n\t    MOUNTABLE: true,\n\n\t    cellView: null,\n\t    nodeSelector: null,\n\t    node: null,\n\t    updateRequested: false,\n\t    transformGroup: null,\n\n\t    requestUpdate: function requestUpdate(cellView, nodeSelector) {\n\t        var paper = cellView.paper;\n\t        this.cellView = cellView;\n\t        this.nodeSelector = nodeSelector;\n\t        if (paper) {\n\t            this.updateRequested = true;\n\t            paper.requestViewUpdate(this, this.HIGHLIGHT_FLAG, this.UPDATE_PRIORITY);\n\t        }\n\t    },\n\n\t    confirmUpdate: function confirmUpdate() {\n\t        // The cellView is now rendered/updated since it has a higher update priority.\n\t        this.updateRequested = false;\n\t        var ref = this;\n\t        var cellView = ref.cellView;\n\t        var nodeSelector = ref.nodeSelector;\n\t        this.update(cellView, nodeSelector);\n\t        this.mount();\n\t        this.transform();\n\t        return 0;\n\t    },\n\n\t    findNode: function findNode(cellView, nodeSelector) {\n\t        var assign, assign$1;\n\n\t        if ( nodeSelector === void 0 ) nodeSelector = null;\n\t        var el;\n\t        if (typeof nodeSelector === 'string') {\n\t            (assign = cellView.findBySelector(nodeSelector), el = assign[0]);\n\t        } else if (isPlainObject(nodeSelector)) {\n\t            var isLink = cellView.model.isLink();\n\t            var label = nodeSelector.label; if ( label === void 0 ) label = null;\n\t            var port = nodeSelector.port;\n\t            var selector = nodeSelector.selector;\n\t            if (isLink && label !== null) {\n\t                // Link Label Selector\n\t                el = cellView.findLabelNode(label, selector);\n\t            } else if (!isLink && port) {\n\t                // Element Port Selector\n\t                el = cellView.findPortNode(port, selector);\n\t            } else {\n\t                // Cell Selector\n\t                (assign$1 = cellView.findBySelector(selector), el = assign$1[0]);\n\t            }\n\t        } else if (nodeSelector) {\n\t            el = V.toNode(nodeSelector);\n\t            if (!(el instanceof SVGElement)) { el = null; }\n\t        }\n\t        return el ? el : null;\n\t    },\n\n\t    mount: function mount() {\n\t        var ref = this;\n\t        var MOUNTABLE = ref.MOUNTABLE;\n\t        var cellView = ref.cellView;\n\t        var el = ref.el;\n\t        var options = ref.options;\n\t        var transformGroup = ref.transformGroup;\n\t        if (!MOUNTABLE || transformGroup) { return; }\n\t        var cellViewRoot = cellView.vel;\n\t        var paper = cellView.paper;\n\t        var layerName = options.layer;\n\t        if (layerName) {\n\t            var vGroup = this.transformGroup = V('g').addClass('highlight-transform').append(el);\n\t            paper.getLayerView(layerName).insertSortedNode(vGroup.node, options.z);\n\t        } else {\n\t            // TODO: prepend vs append\n\t            if (!el.parentNode || el.nextSibling) {\n\t                // Not appended yet or not the last child\n\t                cellViewRoot.append(el);\n\t            }\n\t        }\n\t    },\n\n\t    unmount: function unmount() {\n\t        var ref = this;\n\t        var MOUNTABLE = ref.MOUNTABLE;\n\t        var transformGroup = ref.transformGroup;\n\t        var vel = ref.vel;\n\t        if (!MOUNTABLE) { return; }\n\t        if (transformGroup) {\n\t            this.transformGroup = null;\n\t            transformGroup.remove();\n\t        } else {\n\t            vel.remove();\n\t        }\n\t    },\n\n\t    transform: function transform() {\n\t        var ref = this;\n\t        var transformGroup = ref.transformGroup;\n\t        var cellView = ref.cellView;\n\t        var updateRequested = ref.updateRequested;\n\t        if (!transformGroup || cellView.model.isLink() || updateRequested) { return; }\n\t        var translateMatrix = cellView.getRootTranslateMatrix();\n\t        var rotateMatrix = cellView.getRootRotateMatrix();\n\t        var transformMatrix = translateMatrix.multiply(rotateMatrix);\n\t        transformGroup.attr('transform', V.matrixToTransformString(transformMatrix));\n\t    },\n\n\t    update: function update() {\n\t        var ref = this;\n\t        var prevNode = ref.node;\n\t        var cellView = ref.cellView;\n\t        var nodeSelector = ref.nodeSelector;\n\t        var updateRequested = ref.updateRequested;\n\t        var id = ref.id;\n\t        if (updateRequested) { return; }\n\t        var node = this.node = this.findNode(cellView, nodeSelector);\n\t        if (prevNode) {\n\t            this.unhighlight(cellView, prevNode);\n\t        }\n\t        if (node) {\n\t            this.highlight(cellView, node);\n\t            this.mount();\n\t        } else {\n\t            this.unmount();\n\t            cellView.notify('cell:highlight:invalid', id, this);\n\t        }\n\t    },\n\n\t    onRemove: function onRemove() {\n\t        var ref = this;\n\t        var node = ref.node;\n\t        var cellView = ref.cellView;\n\t        var id = ref.id;\n\t        var constructor = ref.constructor;\n\t        if (node) {\n\t            this.unhighlight(cellView, node);\n\t        }\n\t        this.unmount();\n\t        constructor._removeRef(cellView, id);\n\t    },\n\n\t    highlight: function highlight(_cellView, _node) {\n\t        // to be overridden\n\t    },\n\n\t    unhighlight: function unhighlight(_cellView, _node) {\n\t        // to be overridden\n\t    }\n\n\t}, {\n\n\t    _views: {},\n\n\t    // Used internally by CellView highlight()\n\t    highlight: function(cellView, node, opt) {\n\t        var id = this.uniqueId(node, opt);\n\t        this.add(cellView, node, id, opt);\n\t    },\n\n\t    // Used internally by CellView unhighlight()\n\t    unhighlight: function(cellView, node, opt) {\n\t        var id = this.uniqueId(node, opt);\n\t        this.remove(cellView, id);\n\t    },\n\n\t    get: function get(cellView, id) {\n\t        if ( id === void 0 ) id = null;\n\n\t        var cid = cellView.cid;\n\t        var ref$2 = this;\n\t        var _views = ref$2._views;\n\t        var refs = _views[cid];\n\t        if (id === null) {\n\t            // all highlighters\n\t            var views = [];\n\t            if (!refs) { return views; }\n\t            for (var hid in refs) {\n\t                var ref = refs[hid];\n\t                if (ref instanceof this) {\n\t                    views.push(ref);\n\t                }\n\t            }\n\t            return views;\n\t        } else {\n\t            // single highlighter\n\t            if (!refs) { return null; }\n\t            if (id in refs) {\n\t                var ref$1 = refs[id];\n\t                if (ref$1 instanceof this) { return ref$1; }\n\t            }\n\t            return null;\n\t        }\n\t    },\n\n\t    add: function add(cellView, nodeSelector, id, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        if (!id) { throw new Error('dia.HighlighterView: An ID required.'); }\n\t        // Search the existing view amongst all the highlighters\n\t        var previousView = HighlighterView.get(cellView, id);\n\t        if (previousView) { previousView.remove(); }\n\t        var view = new this(opt);\n\t        view.id = id;\n\t        this._addRef(cellView, id, view);\n\t        view.requestUpdate(cellView, nodeSelector);\n\t        return view;\n\t    },\n\n\t    _addRef: function _addRef(cellView, id, view) {\n\t        var cid = cellView.cid;\n\t        var ref = this;\n\t        var _views = ref._views;\n\t        var refs = _views[cid];\n\t        if (!refs) { refs = _views[cid] = {}; }\n\t        refs[id] = view;\n\t    },\n\n\t    _removeRef: function _removeRef(cellView, id) {\n\t        var cid = cellView.cid;\n\t        var ref = this;\n\t        var _views = ref._views;\n\t        var refs = _views[cid];\n\t        if (!refs) { return; }\n\t        if (id) { delete refs[id]; }\n\t        for (var _ in refs) { return; }\n\t        delete _views[cid];\n\t    },\n\n\t    remove: function remove(cellView, id) {\n\t        if ( id === void 0 ) id = null;\n\n\t        toArray$1(this.get(cellView, id)).forEach(function (view) {\n\t            view.remove();\n\t        });\n\t    },\n\n\t    update: function update(cellView, id, dirty) {\n\t        if ( id === void 0 ) id = null;\n\t        if ( dirty === void 0 ) dirty = false;\n\n\t        toArray$1(this.get(cellView, id)).forEach(function (view) {\n\t            if (dirty || view.UPDATABLE) { view.update(); }\n\t        });\n\t    },\n\n\t    transform: function transform(cellView, id) {\n\t        if ( id === void 0 ) id = null;\n\n\t        toArray$1(this.get(cellView, id)).forEach(function (view) {\n\t            if (view.UPDATABLE) { view.transform(); }\n\t        });\n\t    },\n\n\t    uniqueId: function uniqueId(node, opt) {\n\t        if ( opt === void 0 ) opt = '';\n\n\t        return V.ensureId(node) + JSON.stringify(opt);\n\t    }\n\n\t});\n\n\tvar HighlightingTypes = {\n\t    DEFAULT: 'default',\n\t    EMBEDDING: 'embedding',\n\t    CONNECTING: 'connecting',\n\t    MAGNET_AVAILABILITY: 'magnetAvailability',\n\t    ELEMENT_AVAILABILITY: 'elementAvailability'\n\t};\n\n\t// CellView base view and controller.\n\t// --------------------------------------------\n\n\t// This is the base view and controller for `ElementView` and `LinkView`.\n\tvar CellView = View.extend({\n\n\t    tagName: 'g',\n\n\t    svgElement: true,\n\n\t    selector: 'root',\n\n\t    metrics: null,\n\n\t    className: function() {\n\n\t        var classNames = ['cell'];\n\t        var type = this.model.get('type');\n\n\t        if (type) {\n\n\t            type.toLowerCase().split('.').forEach(function(value, index, list) {\n\t                classNames.push('type-' + list.slice(0, index + 1).join('-'));\n\t            });\n\t        }\n\n\t        return classNames.join(' ');\n\t    },\n\n\t    _presentationAttributes: null,\n\t    _flags: null,\n\n\t    setFlags: function() {\n\t        var flags = {};\n\t        var attributes = {};\n\t        var shift = 0;\n\t        var i, n, label;\n\t        var presentationAttributes = result(this, 'presentationAttributes');\n\t        for (var attribute in presentationAttributes) {\n\t            if (!presentationAttributes.hasOwnProperty(attribute)) { continue; }\n\t            var labels = presentationAttributes[attribute];\n\t            if (!Array.isArray(labels)) { labels = [labels]; }\n\t            for (i = 0, n = labels.length; i < n; i++) {\n\t                label = labels[i];\n\t                var flag = flags[label];\n\t                if (!flag) {\n\t                    flag = flags[label] = 1<<(shift++);\n\t                }\n\t                attributes[attribute] |= flag;\n\t            }\n\t        }\n\t        var initFlag = result(this, 'initFlag');\n\t        if (!Array.isArray(initFlag)) { initFlag = [initFlag]; }\n\t        for (i = 0, n = initFlag.length; i < n; i++) {\n\t            label = initFlag[i];\n\t            if (!flags[label]) { flags[label] = 1<<(shift++); }\n\t        }\n\n\t        // 26 - 30 are reserved for paper flags\n\t        // 31+ overflows maximal number\n\t        if (shift > 25) { throw new Error('dia.CellView: Maximum number of flags exceeded.'); }\n\n\t        this._flags = flags;\n\t        this._presentationAttributes = attributes;\n\t    },\n\n\t    hasFlag: function(flag, label) {\n\t        return flag & this.getFlag(label);\n\t    },\n\n\t    removeFlag: function(flag, label) {\n\t        return flag ^ (flag & this.getFlag(label));\n\t    },\n\n\t    getFlag: function(label) {\n\t        var flags = this._flags;\n\t        if (!flags) { return 0; }\n\t        var flag = 0;\n\t        if (Array.isArray(label)) {\n\t            for (var i = 0, n = label.length; i < n; i++) { flag |= flags[label[i]]; }\n\t        } else {\n\t            flag |= flags[label];\n\t        }\n\t        return flag;\n\t    },\n\n\t    attributes: function() {\n\t        var cell = this.model;\n\t        return {\n\t            'model-id': cell.id,\n\t            'data-type': cell.attributes.type\n\t        };\n\t    },\n\n\t    constructor: function(options) {\n\n\t        // Make sure a global unique id is assigned to this view. Store this id also to the properties object.\n\t        // The global unique id makes sure that the same view can be rendered on e.g. different machines and\n\t        // still be associated to the same object among all those clients. This is necessary for real-time\n\t        // collaboration mechanism.\n\t        options.id = options.id || guid(this);\n\n\t        View.call(this, options);\n\t    },\n\n\t    initialize: function() {\n\n\t        this.setFlags();\n\n\t        View.prototype.initialize.apply(this, arguments);\n\n\t        this.cleanNodesCache();\n\n\t        // Store reference to this to the <g> DOM element so that the view is accessible through the DOM tree.\n\t        this.$el.data('view', this);\n\n\t        this.startListening();\n\t    },\n\n\t    onMount: function onMount() {\n\t        // To be overridden\n\t    },\n\n\t    startListening: function() {\n\t        this.listenTo(this.model, 'change', this.onAttributesChange);\n\t    },\n\n\t    onAttributesChange: function(model, opt) {\n\t        var flag = model.getChangeFlag(this._presentationAttributes);\n\t        if (opt.updateHandled || !flag) { return; }\n\t        if (opt.dirty && this.hasFlag(flag, 'UPDATE')) { flag |= this.getFlag('RENDER'); }\n\t        // TODO: tool changes does not need to be sync\n\t        // Fix Segments tools\n\t        if (opt.tool) { opt.async = false; }\n\t        this.requestUpdate(flag, opt);\n\t    },\n\n\t    requestUpdate: function(flags, opt) {\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        if (paper && flags > 0) {\n\t            paper.requestViewUpdate(this, flags, this.UPDATE_PRIORITY, opt);\n\t        }\n\t    },\n\n\t    parseDOMJSON: function(markup, root) {\n\n\t        var doc = parseDOMJSON(markup);\n\t        var selectors = doc.selectors;\n\t        var groups = doc.groupSelectors;\n\t        for (var group in groups) {\n\t            if (selectors[group]) { throw new Error('dia.CellView: ambiguous group selector'); }\n\t            selectors[group] = groups[group];\n\t        }\n\t        if (root) {\n\t            var rootSelector = this.selector;\n\t            if (selectors[rootSelector]) { throw new Error('dia.CellView: ambiguous root selector.'); }\n\t            selectors[rootSelector] = root;\n\t        }\n\t        return { fragment: doc.fragment, selectors: selectors };\n\t    },\n\n\t    // Return `true` if cell link is allowed to perform a certain UI `feature`.\n\t    // Example: `can('vertexMove')`, `can('labelMove')`.\n\t    can: function(feature) {\n\n\t        var interactive = isFunction(this.options.interactive)\n\t            ? this.options.interactive(this)\n\t            : this.options.interactive;\n\n\t        return (isObject$1(interactive) && interactive[feature] !== false) ||\n\t            (isBoolean(interactive) && interactive !== false);\n\t    },\n\n\t    findBySelector: function(selector, root, selectors) {\n\n\t        root || (root = this.el);\n\t        selectors || (selectors = this.selectors);\n\n\t        // These are either descendants of `this.$el` of `this.$el` itself.\n\t        // `.` is a special selector used to select the wrapping `<g>` element.\n\t        if (!selector || selector === '.') { return [root]; }\n\t        if (selectors) {\n\t            var nodes = selectors[selector];\n\t            if (nodes) {\n\t                if (Array.isArray(nodes)) { return nodes; }\n\t                return [nodes];\n\t            }\n\t        }\n\n\t        // Maintaining backwards compatibility\n\t        // e.g. `circle:first` would fail with querySelector() call\n\t        if (config.useCSSSelectors) { return $(root).find(selector).toArray(); }\n\n\t        return [];\n\t    },\n\n\t    notify: function(eventName) {\n\n\t        if (this.paper) {\n\n\t            var args = Array.prototype.slice.call(arguments, 1);\n\n\t            // Trigger the event on both the element itself and also on the paper.\n\t            this.trigger.apply(this, [eventName].concat(args));\n\n\t            // Paper event handlers receive the view object as the first argument.\n\t            this.paper.trigger.apply(this.paper, [eventName, this].concat(args));\n\t        }\n\t    },\n\n\t    getBBox: function(opt) {\n\n\t        var bbox;\n\t        if (opt && opt.useModelGeometry) {\n\t            var model = this.model;\n\t            bbox = model.getBBox().bbox(model.angle());\n\t        } else {\n\t            bbox = this.getNodeBBox(this.el);\n\t        }\n\n\t        return this.paper.localToPaperRect(bbox);\n\t    },\n\n\t    getNodeBBox: function(magnet) {\n\n\t        var rect = this.getNodeBoundingRect(magnet);\n\t        var magnetMatrix = this.getNodeMatrix(magnet);\n\t        var translateMatrix = this.getRootTranslateMatrix();\n\t        var rotateMatrix = this.getRootRotateMatrix();\n\t        return V.transformRect(rect, translateMatrix.multiply(rotateMatrix).multiply(magnetMatrix));\n\t    },\n\n\t    getNodeUnrotatedBBox: function(magnet) {\n\n\t        var rect = this.getNodeBoundingRect(magnet);\n\t        var magnetMatrix = this.getNodeMatrix(magnet);\n\t        var translateMatrix = this.getRootTranslateMatrix();\n\t        return V.transformRect(rect, translateMatrix.multiply(magnetMatrix));\n\t    },\n\n\t    getRootTranslateMatrix: function() {\n\n\t        var model = this.model;\n\t        var position = model.position();\n\t        var mt = V.createSVGMatrix().translate(position.x, position.y);\n\t        return mt;\n\t    },\n\n\t    getRootRotateMatrix: function() {\n\n\t        var mr = V.createSVGMatrix();\n\t        var model = this.model;\n\t        var angle = model.angle();\n\t        if (angle) {\n\t            var bbox = model.getBBox();\n\t            var cx = bbox.width / 2;\n\t            var cy = bbox.height / 2;\n\t            mr = mr.translate(cx, cy).rotate(angle).translate(-cx, -cy);\n\t        }\n\t        return mr;\n\t    },\n\n\t    _notifyHighlight: function(eventName, el, opt) {\n\t        var assign, assign$1;\n\n\t        if ( opt === void 0 ) opt = {};\n\t        var ref = this;\n\t        var rootNode = ref.el;\n\t        var node;\n\t        if (typeof el === 'string') {\n\t            (assign = this.findBySelector(el), node = assign[0], node = node === void 0 ? rootNode : node);\n\t        } else {\n\t            (assign$1 = this.$(el), node = assign$1[0], node = node === void 0 ? rootNode : node);\n\t        }\n\t        // set partial flag if the highlighted element is not the entire view.\n\t        opt.partial = (node !== rootNode);\n\t        // translate type flag into a type string\n\t        if (opt.type === undefined) {\n\t            var type;\n\t            switch (true) {\n\t                case opt.embedding:\n\t                    type = HighlightingTypes.EMBEDDING;\n\t                    break;\n\t                case opt.connecting:\n\t                    type = HighlightingTypes.CONNECTING;\n\t                    break;\n\t                case opt.magnetAvailability:\n\t                    type = HighlightingTypes.MAGNET_AVAILABILITY;\n\t                    break;\n\t                case opt.elementAvailability:\n\t                    type = HighlightingTypes.ELEMENT_AVAILABILITY;\n\t                    break;\n\t                default:\n\t                    type = HighlightingTypes.DEFAULT;\n\t                    break;\n\t            }\n\t            opt.type = type;\n\t        }\n\t        this.notify(eventName, node, opt);\n\t        return this;\n\t    },\n\n\t    highlight: function(el, opt) {\n\t        return this._notifyHighlight('cell:highlight', el, opt);\n\t    },\n\n\t    unhighlight: function(el, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        return this._notifyHighlight('cell:unhighlight', el, opt);\n\t    },\n\n\t    // Find the closest element that has the `magnet` attribute set to `true`. If there was not such\n\t    // an element found, return the root element of the cell view.\n\t    findMagnet: function(el) {\n\n\t        var root = this.el;\n\t        var magnet = this.$(el)[0];\n\t        if (!magnet) {\n\t            magnet = root;\n\t        }\n\n\t        do {\n\t            var magnetAttribute = magnet.getAttribute('magnet');\n\t            var isMagnetRoot = (magnet === root);\n\t            if ((magnetAttribute || isMagnetRoot) && magnetAttribute !== 'false') {\n\t                return magnet;\n\t            }\n\t            if (isMagnetRoot) {\n\t                // If the overall cell has set `magnet === false`, then return `undefined` to\n\t                // announce there is no magnet found for this cell.\n\t                // This is especially useful to set on cells that have 'ports'. In this case,\n\t                // only the ports have set `magnet === true` and the overall element has `magnet === false`.\n\t                return undefined;\n\t            }\n\t            magnet = magnet.parentNode;\n\t        } while (magnet);\n\n\t        return undefined;\n\t    },\n\n\t    findProxyNode: function(el, type) {\n\t        el || (el = this.el);\n\t        var nodeSelector = el.getAttribute((type + \"-selector\"));\n\t        if (nodeSelector) {\n\t            var ref = this.findBySelector(nodeSelector);\n\t            var proxyNode = ref[0];\n\t            if (proxyNode) { return proxyNode; }\n\t        }\n\t        return el;\n\t    },\n\n\t    // Construct a unique selector for the `el` element within this view.\n\t    // `prevSelector` is being collected through the recursive call.\n\t    // No value for `prevSelector` is expected when using this method.\n\t    getSelector: function(el, prevSelector) {\n\n\t        var selector;\n\n\t        if (el === this.el) {\n\t            if (typeof prevSelector === 'string') { selector = '> ' + prevSelector; }\n\t            return selector;\n\t        }\n\n\t        if (el) {\n\n\t            var nthChild = V(el).index() + 1;\n\t            selector = el.tagName + ':nth-child(' + nthChild + ')';\n\n\t            if (prevSelector) {\n\t                selector += ' > ' + prevSelector;\n\t            }\n\n\t            selector = this.getSelector(el.parentNode, selector);\n\t        }\n\n\t        return selector;\n\t    },\n\n\t    addLinkFromMagnet: function(magnet, x, y) {\n\n\t        var paper = this.paper;\n\t        var graph = paper.model;\n\n\t        var link = paper.getDefaultLink(this, magnet);\n\t        link.set({\n\t            source: this.getLinkEnd(magnet, x, y, link, 'source'),\n\t            target: { x: x, y: y }\n\t        }).addTo(graph, {\n\t            async: false,\n\t            ui: true\n\t        });\n\n\t        return link.findView(paper);\n\t    },\n\n\t    getLinkEnd: function(magnet) {\n\t        var ref;\n\n\t        var args = [], len = arguments.length - 1;\n\t        while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\t        var model = this.model;\n\t        var id = model.id;\n\t        var port = this.findAttribute('port', magnet);\n\t        // Find a unique `selector` of the element under pointer that is a magnet.\n\t        var selector = magnet.getAttribute('joint-selector');\n\n\t        var end = { id: id };\n\t        if (selector != null) { end.magnet = selector; }\n\t        if (port != null) {\n\t            end.port = port;\n\t            if (!model.hasPort(port) && !selector) {\n\t                // port created via the `port` attribute (not API)\n\t                end.selector = this.getSelector(magnet);\n\t            }\n\t        } else if (selector == null && this.el !== magnet) {\n\t            end.selector = this.getSelector(magnet);\n\t        }\n\n\t        return (ref = this).customizeLinkEnd.apply(ref, [ end, magnet ].concat( args ));\n\t    },\n\n\t    customizeLinkEnd: function(end, magnet, x, y, link, endType) {\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var ref$1 = paper.options;\n\t        var connectionStrategy = ref$1.connectionStrategy;\n\t        if (typeof connectionStrategy === 'function') {\n\t            var strategy = connectionStrategy.call(paper, end, this, magnet, new Point(x, y), link, endType, paper);\n\t            if (strategy) { return strategy; }\n\t        }\n\t        return end;\n\t    },\n\n\t    getMagnetFromLinkEnd: function(end) {\n\n\t        var root = this.el;\n\t        var port = end.port;\n\t        var selector = end.magnet;\n\t        var model = this.model;\n\t        var magnet;\n\t        if (port != null && model.isElement() && model.hasPort(port)) {\n\t            magnet = this.findPortNode(port, selector) || root;\n\t        } else {\n\t            if (!selector) { selector = end.selector; }\n\t            if (!selector && port != null) {\n\t                // link end has only `id` and `port` property referencing\n\t                // a port created via the `port` attribute (not API).\n\t                selector = '[port=\"' + port + '\"]';\n\t            }\n\t            magnet = this.findBySelector(selector, root, this.selectors)[0];\n\t        }\n\n\t        return this.findProxyNode(magnet, 'magnet');\n\t    },\n\n\t    dragLinkStart: function(evt, magnet, x, y) {\n\t        this.model.startBatch('add-link');\n\t        var linkView = this.addLinkFromMagnet(magnet, x, y);\n\t        // backwards compatibility events\n\t        linkView.notifyPointerdown(evt, x, y);\n\t        linkView.eventData(evt, linkView.startArrowheadMove('target', { whenNotAllowed: 'remove' }));\n\t        this.eventData(evt, { linkView: linkView });\n\t    },\n\n\t    dragLink: function(evt, x, y) {\n\t        var data = this.eventData(evt);\n\t        var linkView = data.linkView;\n\t        if (linkView) {\n\t            linkView.pointermove(evt, x, y);\n\t        } else {\n\t            var paper = this.paper;\n\t            var magnetThreshold = paper.options.magnetThreshold;\n\t            var currentTarget = this.getEventTarget(evt);\n\t            var targetMagnet = data.targetMagnet;\n\t            if (magnetThreshold === 'onleave') {\n\t                // magnetThreshold when the pointer leaves the magnet\n\t                if (targetMagnet === currentTarget || V(targetMagnet).contains(currentTarget)) { return; }\n\t            } else {\n\t                // magnetThreshold defined as a number of movements\n\t                if (paper.eventData(evt).mousemoved <= magnetThreshold) { return; }\n\t            }\n\t            this.dragLinkStart(evt, targetMagnet, x, y);\n\t        }\n\t    },\n\n\t    dragLinkEnd: function(evt, x, y) {\n\t        var data = this.eventData(evt);\n\t        var linkView = data.linkView;\n\t        if (!linkView) { return; }\n\t        linkView.pointerup(evt, x, y);\n\t        this.model.stopBatch('add-link');\n\t    },\n\n\t    getAttributeDefinition: function(attrName) {\n\n\t        return this.model.constructor.getAttributeDefinition(attrName);\n\t    },\n\n\t    setNodeAttributes: function(node, attrs) {\n\n\t        if (!isEmpty(attrs)) {\n\t            if (node instanceof SVGElement) {\n\t                V(node).attr(attrs);\n\t            } else {\n\t                $(node).attr(attrs);\n\t            }\n\t        }\n\t    },\n\n\t    processNodeAttributes: function(node, attrs) {\n\n\t        var attrName, attrVal, def, i, n;\n\t        var normalAttrs, setAttrs, positionAttrs, offsetAttrs;\n\t        var relatives = [];\n\t        // divide the attributes between normal and special\n\t        for (attrName in attrs) {\n\t            if (!attrs.hasOwnProperty(attrName)) { continue; }\n\t            attrVal = attrs[attrName];\n\t            def = this.getAttributeDefinition(attrName);\n\t            if (def && (!isFunction(def.qualify) || def.qualify.call(this, attrVal, node, attrs))) {\n\t                if (isString(def.set)) {\n\t                    normalAttrs || (normalAttrs = {});\n\t                    normalAttrs[def.set] = attrVal;\n\t                }\n\t                if (attrVal !== null) {\n\t                    relatives.push(attrName, def);\n\t                }\n\t            } else {\n\t                normalAttrs || (normalAttrs = {});\n\t                normalAttrs[toKebabCase(attrName)] = attrVal;\n\t            }\n\t        }\n\n\t        // handle the rest of attributes via related method\n\t        // from the special attributes namespace.\n\t        for (i = 0, n = relatives.length; i < n; i+=2) {\n\t            attrName = relatives[i];\n\t            def = relatives[i+1];\n\t            attrVal = attrs[attrName];\n\t            if (isFunction(def.set)) {\n\t                setAttrs || (setAttrs = {});\n\t                setAttrs[attrName] = attrVal;\n\t            }\n\t            if (isFunction(def.position)) {\n\t                positionAttrs || (positionAttrs = {});\n\t                positionAttrs[attrName] = attrVal;\n\t            }\n\t            if (isFunction(def.offset)) {\n\t                offsetAttrs || (offsetAttrs = {});\n\t                offsetAttrs[attrName] = attrVal;\n\t            }\n\t        }\n\n\t        return {\n\t            raw: attrs,\n\t            normal: normalAttrs,\n\t            set: setAttrs,\n\t            position: positionAttrs,\n\t            offset: offsetAttrs\n\t        };\n\t    },\n\n\t    updateRelativeAttributes: function(node, attrs, refBBox, opt) {\n\n\t        opt || (opt = {});\n\n\t        var attrName, attrVal, def;\n\t        var rawAttrs = attrs.raw || {};\n\t        var nodeAttrs = attrs.normal || {};\n\t        var setAttrs = attrs.set;\n\t        var positionAttrs = attrs.position;\n\t        var offsetAttrs = attrs.offset;\n\n\t        for (attrName in setAttrs) {\n\t            attrVal = setAttrs[attrName];\n\t            def = this.getAttributeDefinition(attrName);\n\t            // SET - set function should return attributes to be set on the node,\n\t            // which will affect the node dimensions based on the reference bounding\n\t            // box. e.g. `width`, `height`, `d`, `rx`, `ry`, `points\n\t            var setResult = def.set.call(this, attrVal, refBBox.clone(), node, rawAttrs);\n\t            if (isObject$1(setResult)) {\n\t                assign(nodeAttrs, setResult);\n\t            } else if (setResult !== undefined) {\n\t                nodeAttrs[attrName] = setResult;\n\t            }\n\t        }\n\n\t        if (node instanceof HTMLElement) {\n\t            // TODO: setting the `transform` attribute on HTMLElements\n\t            // via `node.style.transform = 'matrix(...)';` would introduce\n\t            // a breaking change (e.g. basic.TextBlock).\n\t            this.setNodeAttributes(node, nodeAttrs);\n\t            return;\n\t        }\n\n\t        // The final translation of the subelement.\n\t        var nodeTransform = nodeAttrs.transform;\n\t        var nodeMatrix = V.transformStringToMatrix(nodeTransform);\n\t        var nodePosition = Point(nodeMatrix.e, nodeMatrix.f);\n\t        if (nodeTransform) {\n\t            nodeAttrs = omit(nodeAttrs, 'transform');\n\t            nodeMatrix.e = nodeMatrix.f = 0;\n\t        }\n\n\t        // Calculate node scale determined by the scalable group\n\t        // only if later needed.\n\t        var sx, sy, translation;\n\t        if (positionAttrs || offsetAttrs) {\n\t            var nodeScale = this.getNodeScale(node, opt.scalableNode);\n\t            sx = nodeScale.sx;\n\t            sy = nodeScale.sy;\n\t        }\n\n\t        var positioned = false;\n\t        for (attrName in positionAttrs) {\n\t            attrVal = positionAttrs[attrName];\n\t            def = this.getAttributeDefinition(attrName);\n\t            // POSITION - position function should return a point from the\n\t            // reference bounding box. The default position of the node is x:0, y:0 of\n\t            // the reference bounding box or could be further specify by some\n\t            // SVG attributes e.g. `x`, `y`\n\t            translation = def.position.call(this, attrVal, refBBox.clone(), node, rawAttrs);\n\t            if (translation) {\n\t                nodePosition.offset(Point(translation).scale(sx, sy));\n\t                positioned || (positioned = true);\n\t            }\n\t        }\n\n\t        // The node bounding box could depend on the `size` set from the previous loop.\n\t        // Here we know, that all the size attributes have been already set.\n\t        this.setNodeAttributes(node, nodeAttrs);\n\n\t        var offseted = false;\n\t        if (offsetAttrs) {\n\t            // Check if the node is visible\n\t            var nodeBoundingRect = this.getNodeBoundingRect(node);\n\t            if (nodeBoundingRect.width > 0 && nodeBoundingRect.height > 0) {\n\t                var nodeBBox = V.transformRect(nodeBoundingRect, nodeMatrix).scale(1 / sx, 1 / sy);\n\t                for (attrName in offsetAttrs) {\n\t                    attrVal = offsetAttrs[attrName];\n\t                    def = this.getAttributeDefinition(attrName);\n\t                    // OFFSET - offset function should return a point from the element\n\t                    // bounding box. The default offset point is x:0, y:0 (origin) or could be further\n\t                    // specify with some SVG attributes e.g. `text-anchor`, `cx`, `cy`\n\t                    translation = def.offset.call(this, attrVal, nodeBBox, node, rawAttrs);\n\t                    if (translation) {\n\t                        nodePosition.offset(Point(translation).scale(sx, sy));\n\t                        offseted || (offseted = true);\n\t                    }\n\t                }\n\t            }\n\t        }\n\n\t        // Do not touch node's transform attribute if there is no transformation applied.\n\t        if (nodeTransform !== undefined || positioned || offseted) {\n\t            // Round the coordinates to 1 decimal point.\n\t            nodePosition.round(1);\n\t            nodeMatrix.e = nodePosition.x;\n\t            nodeMatrix.f = nodePosition.y;\n\t            node.setAttribute('transform', V.matrixToTransformString(nodeMatrix));\n\t            // TODO: store nodeMatrix metrics?\n\t        }\n\t    },\n\n\t    getNodeScale: function(node, scalableNode) {\n\n\t        // Check if the node is a descendant of the scalable group.\n\t        var sx, sy;\n\t        if (scalableNode && scalableNode.contains(node)) {\n\t            var scale = scalableNode.scale();\n\t            sx = 1 / scale.sx;\n\t            sy = 1 / scale.sy;\n\t        } else {\n\t            sx = 1;\n\t            sy = 1;\n\t        }\n\n\t        return { sx: sx, sy: sy };\n\t    },\n\n\t    cleanNodesCache: function() {\n\t        this.metrics = {};\n\t    },\n\n\t    nodeCache: function(magnet) {\n\n\t        var metrics = this.metrics;\n\t        // Don't use cache? It most likely a custom view with overridden update.\n\t        if (!metrics) { return {}; }\n\t        var id = V.ensureId(magnet);\n\t        var value = metrics[id];\n\t        if (!value) { value = metrics[id] = {}; }\n\t        return value;\n\t    },\n\n\t    getNodeData: function(magnet) {\n\n\t        var metrics = this.nodeCache(magnet);\n\t        if (!metrics.data) { metrics.data = {}; }\n\t        return metrics.data;\n\t    },\n\n\t    getNodeBoundingRect: function(magnet) {\n\n\t        var metrics = this.nodeCache(magnet);\n\t        if (metrics.boundingRect === undefined) { metrics.boundingRect = V(magnet).getBBox(); }\n\t        return new Rect(metrics.boundingRect);\n\t    },\n\n\t    getNodeMatrix: function(magnet) {\n\n\t        var metrics = this.nodeCache(magnet);\n\t        if (metrics.magnetMatrix === undefined) {\n\t            var target = this.rotatableNode || this.el;\n\t            metrics.magnetMatrix = V(magnet).getTransformToElement(target);\n\t        }\n\t        return V.createSVGMatrix(metrics.magnetMatrix);\n\t    },\n\n\t    getNodeShape: function(magnet) {\n\n\t        var metrics = this.nodeCache(magnet);\n\t        if (metrics.geometryShape === undefined) { metrics.geometryShape = V(magnet).toGeometryShape(); }\n\t        return metrics.geometryShape.clone();\n\t    },\n\n\t    isNodeConnection: function(node) {\n\t        return this.model.isLink() && (!node || node === this.el);\n\t    },\n\n\t    findNodesAttributes: function(attrs, root, selectorCache, selectors) {\n\n\t        var i, n, nodeAttrs, nodeId;\n\t        var nodesAttrs = {};\n\t        var mergeIds = [];\n\t        for (var selector in attrs) {\n\t            if (!attrs.hasOwnProperty(selector)) { continue; }\n\t            nodeAttrs = attrs[selector];\n\t            if (!isPlainObject(nodeAttrs)) { continue; } // Not a valid selector-attributes pair\n\t            var selected = selectorCache[selector] = this.findBySelector(selector, root, selectors);\n\t            for (i = 0, n = selected.length; i < n; i++) {\n\t                var node = selected[i];\n\t                nodeId = V.ensureId(node);\n\t                // \"unique\" selectors are selectors that referencing a single node (defined by `selector`)\n\t                // groupSelector referencing a single node is not \"unique\"\n\t                var unique = (selectors && selectors[selector] === node);\n\t                var prevNodeAttrs = nodesAttrs[nodeId];\n\t                if (prevNodeAttrs) {\n\t                    // Note, that nodes referenced by deprecated `CSS selectors` are not taken into account.\n\t                    // e.g. css:`.circle` and selector:`circle` can be applied in a random order\n\t                    if (!prevNodeAttrs.array) {\n\t                        mergeIds.push(nodeId);\n\t                        prevNodeAttrs.array = true;\n\t                        prevNodeAttrs.attributes = [prevNodeAttrs.attributes];\n\t                        prevNodeAttrs.selectedLength = [prevNodeAttrs.selectedLength];\n\t                    }\n\t                    var attributes = prevNodeAttrs.attributes;\n\t                    var selectedLength = prevNodeAttrs.selectedLength;\n\t                    if (unique) {\n\t                        // node referenced by `selector`\n\t                        attributes.unshift(nodeAttrs);\n\t                        selectedLength.unshift(-1);\n\t                    } else {\n\t                        // node referenced by `groupSelector`\n\t                        var sortIndex = sortedIndex(selectedLength, n);\n\t                        attributes.splice(sortIndex, 0, nodeAttrs);\n\t                        selectedLength.splice(sortIndex, 0, n);\n\t                    }\n\t                } else {\n\t                    nodesAttrs[nodeId] = {\n\t                        attributes: nodeAttrs,\n\t                        selectedLength: unique ? -1 : n,\n\t                        node: node,\n\t                        array: false\n\t                    };\n\t                }\n\t            }\n\t        }\n\n\t        for (i = 0, n = mergeIds.length; i < n; i++) {\n\t            nodeId = mergeIds[i];\n\t            nodeAttrs = nodesAttrs[nodeId];\n\t            nodeAttrs.attributes = merge.apply(void 0, [ {} ].concat( nodeAttrs.attributes.reverse() ));\n\t        }\n\n\t        return nodesAttrs;\n\t    },\n\n\t    getEventTarget: function(evt, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        // Touchmove/Touchend event's target is not reflecting the element under the coordinates as mousemove does.\n\t        // It holds the element when a touchstart triggered.\n\t        var target = evt.target;\n\t        var type = evt.type;\n\t        var clientX = evt.clientX; if ( clientX === void 0 ) clientX = 0;\n\t        var clientY = evt.clientY; if ( clientY === void 0 ) clientY = 0;\n\t        if (opt.fromPoint || type === 'touchmove' || type === 'touchend') {\n\t            return document.elementFromPoint(clientX, clientY);\n\t        }\n\n\t        return target;\n\t    },\n\n\t    // Default is to process the `model.attributes.attrs` object and set attributes on subelements based on the selectors,\n\t    // unless `attrs` parameter was passed.\n\t    updateDOMSubtreeAttributes: function(rootNode, attrs, opt) {\n\n\t        opt || (opt = {});\n\t        opt.rootBBox || (opt.rootBBox = Rect());\n\t        opt.selectors || (opt.selectors = this.selectors); // selector collection to use\n\n\t        // Cache table for query results and bounding box calculation.\n\t        // Note that `selectorCache` needs to be invalidated for all\n\t        // `updateAttributes` calls, as the selectors might pointing\n\t        // to nodes designated by an attribute or elements dynamically\n\t        // created.\n\t        var selectorCache = {};\n\t        var bboxCache = {};\n\t        var relativeItems = [];\n\t        var relativeRefItems = [];\n\t        var item, node, nodeAttrs, nodeData, processedAttrs;\n\n\t        var roAttrs = opt.roAttributes;\n\t        var nodesAttrs = this.findNodesAttributes(roAttrs || attrs, rootNode, selectorCache, opt.selectors);\n\t        // `nodesAttrs` are different from all attributes, when\n\t        // rendering only  attributes sent to this method.\n\t        var nodesAllAttrs = (roAttrs)\n\t            ? this.findNodesAttributes(attrs, rootNode, selectorCache, opt.selectors)\n\t            : nodesAttrs;\n\n\t        for (var nodeId in nodesAttrs) {\n\t            nodeData = nodesAttrs[nodeId];\n\t            nodeAttrs = nodeData.attributes;\n\t            node = nodeData.node;\n\t            processedAttrs = this.processNodeAttributes(node, nodeAttrs);\n\n\t            if (!processedAttrs.set && !processedAttrs.position && !processedAttrs.offset) {\n\t                // Set all the normal attributes right on the SVG/HTML element.\n\t                this.setNodeAttributes(node, processedAttrs.normal);\n\n\t            } else {\n\n\t                var nodeAllAttrs = nodesAllAttrs[nodeId] && nodesAllAttrs[nodeId].attributes;\n\t                var refSelector = (nodeAllAttrs && (nodeAttrs.ref === undefined))\n\t                    ? nodeAllAttrs.ref\n\t                    : nodeAttrs.ref;\n\n\t                var refNode;\n\t                if (refSelector) {\n\t                    refNode = (selectorCache[refSelector] || this.findBySelector(refSelector, rootNode, opt.selectors))[0];\n\t                    if (!refNode) {\n\t                        throw new Error('dia.CellView: \"' + refSelector + '\" reference does not exist.');\n\t                    }\n\t                } else {\n\t                    refNode = null;\n\t                }\n\n\t                item = {\n\t                    node: node,\n\t                    refNode: refNode,\n\t                    processedAttributes: processedAttrs,\n\t                    allAttributes: nodeAllAttrs\n\t                };\n\n\t                if (refNode) {\n\t                    // If an element in the list is positioned relative to this one, then\n\t                    // we want to insert this one before it in the list.\n\t                    var itemIndex = relativeRefItems.findIndex(function(item) {\n\t                        return item.refNode === node;\n\t                    });\n\n\t                    if (itemIndex > -1) {\n\t                        relativeRefItems.splice(itemIndex, 0, item);\n\t                    } else {\n\t                        relativeRefItems.push(item);\n\t                    }\n\t                } else {\n\t                    // A node with no ref attribute. To be updated before the nodes referencing other nodes.\n\t                    // The order of no-ref-items is not specified/important.\n\t                    relativeItems.push(item);\n\t                }\n\t            }\n\t        }\n\n\t        relativeItems.push.apply(relativeItems, relativeRefItems);\n\n\t        var rotatableMatrix;\n\t        for (var i = 0, n = relativeItems.length; i < n; i++) {\n\t            item = relativeItems[i];\n\t            node = item.node;\n\t            refNode = item.refNode;\n\n\t            // Find the reference element bounding box. If no reference was provided, we\n\t            // use the optional bounding box.\n\t            var vRotatable = V(opt.rotatableNode);\n\t            var refNodeId = refNode ? V.ensureId(refNode) : '';\n\t            var isRefNodeRotatable = !!vRotatable && !!refNode && vRotatable.contains(refNode);\n\t            var unrotatedRefBBox = bboxCache[refNodeId];\n\t            if (!unrotatedRefBBox) {\n\t                // Get the bounding box of the reference element relative to the `rotatable` `<g>` (without rotation)\n\t                // or to the root `<g>` element if no rotatable group present if reference node present.\n\t                // Uses the bounding box provided.\n\t                var transformationTarget = (isRefNodeRotatable) ? vRotatable : rootNode;\n\t                unrotatedRefBBox = bboxCache[refNodeId] = (refNode)\n\t                    ? V(refNode).getBBox({ target: transformationTarget })\n\t                    : opt.rootBBox;\n\t            }\n\n\t            if (roAttrs) {\n\t                // if there was a special attribute affecting the position amongst passed-in attributes\n\t                // we have to merge it with the rest of the element's attributes as they are necessary\n\t                // to update the position relatively (i.e `ref-x` && 'ref-dx')\n\t                processedAttrs = this.processNodeAttributes(node, item.allAttributes);\n\t                this.mergeProcessedAttributes(processedAttrs, item.processedAttributes);\n\n\t            } else {\n\t                processedAttrs = item.processedAttributes;\n\t            }\n\n\t            var refBBox = unrotatedRefBBox;\n\t            if (isRefNodeRotatable && !vRotatable.contains(node)) {\n\t                // if the referenced node is inside the rotatable group while the updated node is outside,\n\t                // we need to take the rotatable node transformation into account\n\t                if (!rotatableMatrix) { rotatableMatrix = V.transformStringToMatrix(vRotatable.attr('transform')); }\n\t                refBBox = V.transformRect(unrotatedRefBBox, rotatableMatrix);\n\t            }\n\n\t            this.updateRelativeAttributes(node, processedAttrs, refBBox, opt);\n\t        }\n\t    },\n\n\t    mergeProcessedAttributes: function(processedAttrs, roProcessedAttrs) {\n\n\t        processedAttrs.set || (processedAttrs.set = {});\n\t        processedAttrs.position || (processedAttrs.position = {});\n\t        processedAttrs.offset || (processedAttrs.offset = {});\n\n\t        assign(processedAttrs.set, roProcessedAttrs.set);\n\t        assign(processedAttrs.position, roProcessedAttrs.position);\n\t        assign(processedAttrs.offset, roProcessedAttrs.offset);\n\n\t        // Handle also the special transform property.\n\t        var transform = processedAttrs.normal && processedAttrs.normal.transform;\n\t        if (transform !== undefined && roProcessedAttrs.normal) {\n\t            roProcessedAttrs.normal.transform = transform;\n\t        }\n\t        processedAttrs.normal = roProcessedAttrs.normal;\n\t    },\n\n\t    onRemove: function() {\n\t        this.removeTools();\n\t        this.removeHighlighters();\n\t    },\n\n\t    _toolsView: null,\n\n\t    hasTools: function(name) {\n\t        var toolsView = this._toolsView;\n\t        if (!toolsView) { return false; }\n\t        if (!name) { return true; }\n\t        return (toolsView.getName() === name);\n\t    },\n\n\t    addTools: function(toolsView) {\n\n\t        this.removeTools();\n\n\t        if (toolsView) {\n\t            this._toolsView = toolsView;\n\t            toolsView.configure({ relatedView: this });\n\t            toolsView.listenTo(this.paper, 'tools:event', this.onToolEvent.bind(this));\n\t        }\n\t        return this;\n\t    },\n\n\t    updateTools: function(opt) {\n\n\t        var toolsView = this._toolsView;\n\t        if (toolsView) { toolsView.update(opt); }\n\t        return this;\n\t    },\n\n\t    removeTools: function() {\n\n\t        var toolsView = this._toolsView;\n\t        if (toolsView) {\n\t            toolsView.remove();\n\t            this._toolsView = null;\n\t        }\n\t        return this;\n\t    },\n\n\t    hideTools: function() {\n\n\t        var toolsView = this._toolsView;\n\t        if (toolsView) { toolsView.hide(); }\n\t        return this;\n\t    },\n\n\t    showTools: function() {\n\n\t        var toolsView = this._toolsView;\n\t        if (toolsView) { toolsView.show(); }\n\t        return this;\n\t    },\n\n\t    onToolEvent: function(event) {\n\t        switch (event) {\n\t            case 'remove':\n\t                this.removeTools();\n\t                break;\n\t            case 'hide':\n\t                this.hideTools();\n\t                break;\n\t            case 'show':\n\t                this.showTools();\n\t                break;\n\t        }\n\t    },\n\n\t    removeHighlighters: function() {\n\t        HighlighterView.remove(this);\n\t    },\n\n\t    updateHighlighters: function(dirty) {\n\t        if ( dirty === void 0 ) dirty = false;\n\n\t        HighlighterView.update(this, null, dirty);\n\t    },\n\n\t    transformHighlighters: function() {\n\t        HighlighterView.transform(this);\n\t    },\n\n\t    // Interaction. The controller part.\n\t    // ---------------------------------\n\n\t    // Interaction is handled by the paper and delegated to the view in interest.\n\t    // `x` & `y` parameters passed to these functions represent the coordinates already snapped to the paper grid.\n\t    // If necessary, real coordinates can be obtained from the `evt` event object.\n\n\t    // These functions are supposed to be overriden by the views that inherit from `joint.dia.Cell`,\n\t    // i.e. `joint.dia.Element` and `joint.dia.Link`.\n\n\t    pointerdblclick: function(evt, x, y) {\n\n\t        this.notify('cell:pointerdblclick', evt, x, y);\n\t    },\n\n\t    pointerclick: function(evt, x, y) {\n\n\t        this.notify('cell:pointerclick', evt, x, y);\n\t    },\n\n\t    contextmenu: function(evt, x, y) {\n\n\t        this.notify('cell:contextmenu', evt, x, y);\n\t    },\n\n\t    pointerdown: function(evt, x, y) {\n\n\t        var ref = this;\n\t        var model = ref.model;\n\t        var graph = model.graph;\n\t        if (graph) {\n\t            model.startBatch('pointer');\n\t            this.eventData(evt, { graph: graph });\n\t        }\n\n\t        this.notify('cell:pointerdown', evt, x, y);\n\t    },\n\n\t    pointermove: function(evt, x, y) {\n\n\t        this.notify('cell:pointermove', evt, x, y);\n\t    },\n\n\t    pointerup: function(evt, x, y) {\n\n\t        var ref = this.eventData(evt);\n\t        var graph = ref.graph;\n\n\t        this.notify('cell:pointerup', evt, x, y);\n\n\t        if (graph) {\n\t            // we don't want to trigger event on model as model doesn't\n\t            // need to be member of collection anymore (remove)\n\t            graph.stopBatch('pointer', { cell: this.model });\n\t        }\n\t    },\n\n\t    mouseover: function(evt) {\n\n\t        this.notify('cell:mouseover', evt);\n\t    },\n\n\t    mouseout: function(evt) {\n\n\t        this.notify('cell:mouseout', evt);\n\t    },\n\n\t    mouseenter: function(evt) {\n\n\t        this.notify('cell:mouseenter', evt);\n\t    },\n\n\t    mouseleave: function(evt) {\n\n\t        this.notify('cell:mouseleave', evt);\n\t    },\n\n\t    mousewheel: function(evt, x, y, delta) {\n\n\t        this.notify('cell:mousewheel', evt, x, y, delta);\n\t    },\n\n\t    onevent: function(evt, eventName, x, y) {\n\n\t        this.notify(eventName, evt, x, y);\n\t    },\n\n\t    onmagnet: function() {\n\n\t        // noop\n\t    },\n\n\t    magnetpointerdblclick: function() {\n\n\t        // noop\n\t    },\n\n\t    magnetcontextmenu: function() {\n\n\t        // noop\n\t    },\n\n\t    checkMouseleave: function checkMouseleave(evt) {\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        if (paper.isAsync()) {\n\t            // Do the updates of the current view synchronously now\n\t            paper.dumpView(this);\n\t        }\n\t        var target = this.getEventTarget(evt, { fromPoint: true });\n\t        var view = paper.findView(target);\n\t        if (view === this) { return; }\n\t        // Leaving the current view\n\t        this.mouseleave(evt);\n\t        if (!view) { return; }\n\t        // Entering another view\n\t        view.mouseenter(evt);\n\t    },\n\n\t    setInteractivity: function(value) {\n\n\t        this.options.interactive = value;\n\t    }\n\t}, {\n\n\t    Highlighting: HighlightingTypes,\n\n\t    addPresentationAttributes: function(presentationAttributes) {\n\t        return merge({}, result(this.prototype, 'presentationAttributes'), presentationAttributes, function(a, b) {\n\t            if (!a || !b) { return; }\n\t            if (typeof a === 'string') { a = [a]; }\n\t            if (typeof b === 'string') { b = [b]; }\n\t            if (Array.isArray(a) && Array.isArray(b)) { return uniq(a.concat(b)); }\n\t        });\n\t    }\n\t});\n\n\tvar Flags = {\n\t    UPDATE: 'UPDATE',\n\t    TRANSLATE: 'TRANSLATE',\n\t    TOOLS: 'TOOLS',\n\t    RESIZE: 'RESIZE',\n\t    PORTS: 'PORTS',\n\t    ROTATE: 'ROTATE',\n\t    RENDER: 'RENDER'\n\t};\n\n\t// Element base view and controller.\n\t// -------------------------------------------\n\n\tvar ElementView = CellView.extend({\n\n\t    /**\n\t     * @abstract\n\t     */\n\t    _removePorts: function() {\n\t        // implemented in ports.js\n\t    },\n\n\t    /**\n\t     *\n\t     * @abstract\n\t     */\n\t    _renderPorts: function() {\n\t        // implemented in ports.js\n\t    },\n\n\t    className: function() {\n\n\t        var classNames = CellView.prototype.className.apply(this).split(' ');\n\n\t        classNames.push('element');\n\n\t        return classNames.join(' ');\n\t    },\n\n\t    initialize: function() {\n\n\t        CellView.prototype.initialize.apply(this, arguments);\n\n\t        this._initializePorts();\n\t    },\n\n\t    presentationAttributes: {\n\t        'attrs': [Flags.UPDATE],\n\t        'position': [Flags.TRANSLATE, Flags.TOOLS],\n\t        'size': [Flags.RESIZE, Flags.PORTS, Flags.TOOLS],\n\t        'angle': [Flags.ROTATE, Flags.TOOLS],\n\t        'markup': [Flags.RENDER],\n\t        'ports': [Flags.PORTS],\n\t    },\n\n\t    initFlag: [Flags.RENDER],\n\n\t    UPDATE_PRIORITY: 0,\n\n\t    confirmUpdate: function(flag, opt) {\n\n\t        var useCSSSelectors = config.useCSSSelectors;\n\t        if (this.hasFlag(flag, Flags.PORTS)) {\n\t            this._removePorts();\n\t            this._cleanPortsCache();\n\t        }\n\t        var transformHighlighters = false;\n\t        if (this.hasFlag(flag, Flags.RENDER)) {\n\t            this.render();\n\t            this.updateTools(opt);\n\t            this.updateHighlighters(true);\n\t            transformHighlighters = true;\n\t            flag = this.removeFlag(flag, [Flags.RENDER, Flags.UPDATE, Flags.RESIZE, Flags.TRANSLATE, Flags.ROTATE, Flags.PORTS, Flags.TOOLS]);\n\t        } else {\n\t            var updateHighlighters = false;\n\n\t            // Skip this branch if render is required\n\t            if (this.hasFlag(flag, Flags.RESIZE)) {\n\t                this.resize(opt);\n\t                updateHighlighters = true;\n\t                // Resize method is calling `update()` internally\n\t                flag = this.removeFlag(flag, [Flags.RESIZE, Flags.UPDATE]);\n\t            }\n\t            if (this.hasFlag(flag, Flags.UPDATE)) {\n\t                this.update(this.model, null, opt);\n\t                flag = this.removeFlag(flag, Flags.UPDATE);\n\t                updateHighlighters = true;\n\t                if (useCSSSelectors) {\n\t                    // `update()` will render ports when useCSSSelectors are enabled\n\t                    flag = this.removeFlag(flag, Flags.PORTS);\n\t                }\n\t            }\n\t            if (this.hasFlag(flag, Flags.TRANSLATE)) {\n\t                this.translate();\n\t                flag = this.removeFlag(flag, Flags.TRANSLATE);\n\t                transformHighlighters = true;\n\t            }\n\t            if (this.hasFlag(flag, Flags.ROTATE)) {\n\t                this.rotate();\n\t                flag = this.removeFlag(flag, Flags.ROTATE);\n\t                transformHighlighters = true;\n\t            }\n\t            if (this.hasFlag(flag, Flags.PORTS)) {\n\t                this._renderPorts();\n\t                updateHighlighters = true;\n\t                flag = this.removeFlag(flag, Flags.PORTS);\n\t            }\n\n\t            if (updateHighlighters) {\n\t                this.updateHighlighters(false);\n\t            }\n\t        }\n\n\t        if (transformHighlighters) {\n\t            this.transformHighlighters();\n\t        }\n\n\t        if (this.hasFlag(flag, Flags.TOOLS)) {\n\t            this.updateTools(opt);\n\t            flag = this.removeFlag(flag, Flags.TOOLS);\n\t        }\n\n\t        return flag;\n\t    },\n\n\t    /**\n\t     * @abstract\n\t     */\n\t    _initializePorts: function() {\n\n\t    },\n\n\t    update: function(_, renderingOnlyAttrs) {\n\n\t        this.cleanNodesCache();\n\n\t        // When CSS selector strings are used, make sure no rule matches port nodes.\n\t        var useCSSSelectors = config.useCSSSelectors;\n\t        if (useCSSSelectors) { this._removePorts(); }\n\n\t        var model = this.model;\n\t        var modelAttrs = model.attr();\n\t        this.updateDOMSubtreeAttributes(this.el, modelAttrs, {\n\t            rootBBox: new Rect(model.size()),\n\t            selectors: this.selectors,\n\t            scalableNode: this.scalableNode,\n\t            rotatableNode: this.rotatableNode,\n\t            // Use rendering only attributes if they differs from the model attributes\n\t            roAttributes: (renderingOnlyAttrs === modelAttrs) ? null : renderingOnlyAttrs\n\t        });\n\n\t        if (useCSSSelectors) {\n\t            this._renderPorts();\n\t        }\n\t    },\n\n\t    rotatableSelector: 'rotatable',\n\t    scalableSelector: 'scalable',\n\t    scalableNode: null,\n\t    rotatableNode: null,\n\n\t    // `prototype.markup` is rendered by default. Set the `markup` attribute on the model if the\n\t    // default markup is not desirable.\n\t    renderMarkup: function() {\n\n\t        var element = this.model;\n\t        var markup = element.get('markup') || element.markup;\n\t        if (!markup) { throw new Error('dia.ElementView: markup required'); }\n\t        if (Array.isArray(markup)) { return this.renderJSONMarkup(markup); }\n\t        if (typeof markup === 'string') { return this.renderStringMarkup(markup); }\n\t        throw new Error('dia.ElementView: invalid markup');\n\t    },\n\n\t    renderJSONMarkup: function(markup) {\n\n\t        var doc = this.parseDOMJSON(markup, this.el);\n\t        var selectors = this.selectors = doc.selectors;\n\t        this.rotatableNode = V(selectors[this.rotatableSelector]) || null;\n\t        this.scalableNode = V(selectors[this.scalableSelector]) || null;\n\t        // Fragment\n\t        this.vel.append(doc.fragment);\n\t    },\n\n\t    renderStringMarkup: function(markup) {\n\n\t        var vel = this.vel;\n\t        vel.append(V(markup));\n\t        // Cache transformation groups\n\t        this.rotatableNode = vel.findOne('.rotatable');\n\t        this.scalableNode = vel.findOne('.scalable');\n\n\t        var selectors = this.selectors = {};\n\t        selectors[this.selector] = this.el;\n\t    },\n\n\t    render: function() {\n\n\t        this.vel.empty();\n\t        this.renderMarkup();\n\t        if (this.scalableNode) {\n\t            // Double update is necessary for elements with the scalable group only\n\t            // Note the resize() triggers the other `update`.\n\t            this.update();\n\t        }\n\t        this.resize();\n\t        if (this.rotatableNode) {\n\t            // Translate transformation is applied on `this.el` while the rotation transformation\n\t            // on `this.rotatableNode`\n\t            this.rotate();\n\t            this.translate();\n\t        } else {\n\t            this.updateTransformation();\n\t        }\n\t        if (!config.useCSSSelectors) { this._renderPorts(); }\n\t        return this;\n\t    },\n\n\t    resize: function(opt) {\n\n\t        if (this.scalableNode) { return this.sgResize(opt); }\n\t        if (this.model.attributes.angle) { this.rotate(); }\n\t        this.update();\n\t    },\n\n\t    translate: function() {\n\n\t        if (this.rotatableNode) { return this.rgTranslate(); }\n\t        this.updateTransformation();\n\t    },\n\n\t    rotate: function() {\n\n\t        if (this.rotatableNode) {\n\t            this.rgRotate();\n\t            // It's necessary to call the update for the nodes outside\n\t            // the rotatable group referencing nodes inside the group\n\t            this.update();\n\t            return;\n\t        }\n\t        this.updateTransformation();\n\t    },\n\n\t    updateTransformation: function() {\n\n\t        var transformation = this.getTranslateString();\n\t        var rotateString = this.getRotateString();\n\t        if (rotateString) { transformation += ' ' + rotateString; }\n\t        this.vel.attr('transform', transformation);\n\t    },\n\n\t    getTranslateString: function() {\n\n\t        var position = this.model.attributes.position;\n\t        return 'translate(' + position.x + ',' + position.y + ')';\n\t    },\n\n\t    getRotateString: function() {\n\t        var attributes = this.model.attributes;\n\t        var angle = attributes.angle;\n\t        if (!angle) { return null; }\n\t        var size = attributes.size;\n\t        return 'rotate(' + angle + ',' + (size.width / 2) + ',' + (size.height / 2) + ')';\n\t    },\n\n\t    // Rotatable & Scalable Group\n\t    // always slower, kept mainly for backwards compatibility\n\n\t    rgRotate: function() {\n\n\t        this.rotatableNode.attr('transform', this.getRotateString());\n\t    },\n\n\t    rgTranslate: function() {\n\n\t        this.vel.attr('transform', this.getTranslateString());\n\t    },\n\n\t    sgResize: function(opt) {\n\n\t        var model = this.model;\n\t        var angle = model.angle();\n\t        var size = model.size();\n\t        var scalable = this.scalableNode;\n\n\t        // Getting scalable group's bbox.\n\t        // Due to a bug in webkit's native SVG .getBBox implementation, the bbox of groups with path children includes the paths' control points.\n\t        // To work around the issue, we need to check whether there are any path elements inside the scalable group.\n\t        var recursive = false;\n\t        if (scalable.node.getElementsByTagName('path').length > 0) {\n\t            // If scalable has at least one descendant that is a path, we need to switch to recursive bbox calculation.\n\t            // If there are no path descendants, group bbox calculation works and so we can use the (faster) native function directly.\n\t            recursive = true;\n\t        }\n\t        var scalableBBox = scalable.getBBox({ recursive: recursive });\n\n\t        // Make sure `scalableBbox.width` and `scalableBbox.height` are not zero which can happen if the element does not have any content. By making\n\t        // the width/height 1, we prevent HTML errors of the type `scale(Infinity, Infinity)`.\n\t        var sx = (size.width / (scalableBBox.width || 1));\n\t        var sy = (size.height / (scalableBBox.height || 1));\n\t        scalable.attr('transform', 'scale(' + sx + ',' + sy + ')');\n\n\t        // Now the interesting part. The goal is to be able to store the object geometry via just `x`, `y`, `angle`, `width` and `height`\n\t        // Order of transformations is significant but we want to reconstruct the object always in the order:\n\t        // resize(), rotate(), translate() no matter of how the object was transformed. For that to work,\n\t        // we must adjust the `x` and `y` coordinates of the object whenever we resize it (because the origin of the\n\t        // rotation changes). The new `x` and `y` coordinates are computed by canceling the previous rotation\n\t        // around the center of the resized object (which is a different origin then the origin of the previous rotation)\n\t        // and getting the top-left corner of the resulting object. Then we clean up the rotation back to what it originally was.\n\n\t        // Cancel the rotation but now around a different origin, which is the center of the scaled object.\n\t        var rotatable = this.rotatableNode;\n\t        var rotation = rotatable && rotatable.attr('transform');\n\t        if (rotation) {\n\n\t            rotatable.attr('transform', rotation + ' rotate(' + (-angle) + ',' + (size.width / 2) + ',' + (size.height / 2) + ')');\n\t            var rotatableBBox = scalable.getBBox({ target: this.paper.cells });\n\n\t            // Store new x, y and perform rotate() again against the new rotation origin.\n\t            model.set('position', { x: rotatableBBox.x, y: rotatableBBox.y }, assign({ updateHandled: true }, opt));\n\t            this.translate();\n\t            this.rotate();\n\t        }\n\n\t        // Update must always be called on non-rotated element. Otherwise, relative positioning\n\t        // would work with wrong (rotated) bounding boxes.\n\t        this.update();\n\t    },\n\n\t    // Embedding mode methods.\n\t    // -----------------------\n\n\t    prepareEmbedding: function(data) {\n\t        if ( data === void 0 ) data = {};\n\n\n\t        var element = data.model || this.model;\n\t        var paper = data.paper || this.paper;\n\t        var graph = paper.model;\n\n\t        var initialZIndices = data.initialZIndices = {};\n\t        var embeddedCells = element.getEmbeddedCells({ deep: true });\n\t        var connectedLinks = graph.getConnectedLinks(element, { deep: true, includeEnclosed: true });\n\n\t        // Note: an embedded cell can be a connect link, but it's fine\n\t        // to iterate over the cell twice.\n\t        [\n\t            element ].concat( embeddedCells,\n\t            connectedLinks\n\t        ).forEach(function (cell) { return initialZIndices[cell.id] = cell.attributes.z; });\n\n\t        element.startBatch('to-front');\n\n\t        // Bring the model to the front with all his embeds.\n\t        element.toFront({ deep: true, ui: true });\n\n\t        // Note that at this point cells in the collection are not sorted by z index (it's running in the batch, see\n\t        // the dia.Graph._sortOnChangeZ), so we can't assume that the last cell in the collection has the highest z.\n\t        var maxZ = graph.getElements().reduce(function (max, cell) { return Math.max(max, cell.attributes.z || 0); }, 0);\n\n\t        // Move to front also all the inbound and outbound links that are connected\n\t        // to any of the element descendant. If we bring to front only embedded elements,\n\t        // links connected to them would stay in the background.\n\t        connectedLinks.forEach(function (link) {\n\t            if (link.attributes.z <= maxZ) {\n\t                link.set('z', maxZ + 1, { ui: true });\n\t            }\n\t        });\n\n\t        element.stopBatch('to-front');\n\n\t        // Before we start looking for suitable parent we remove the current one.\n\t        var parentId = element.parent();\n\t        if (parentId) {\n\t            var parent = graph.getCell(parentId);\n\t            parent.unembed(element, { ui: true });\n\t            data.initialParentId = parentId;\n\t        } else {\n\t            data.initialParentId = null;\n\t        }\n\t    },\n\n\t    processEmbedding: function(data, evt, x, y) {\n\t        if ( data === void 0 ) data = {};\n\n\n\t        var model = data.model || this.model;\n\t        var paper = data.paper || this.paper;\n\t        var graph = paper.model;\n\t        var ref = paper.options;\n\t        var findParentBy = ref.findParentBy;\n\t        var frontParentOnly = ref.frontParentOnly;\n\t        var validateEmbedding = ref.validateEmbedding;\n\n\t        var candidates;\n\t        if (isFunction(findParentBy)) {\n\t            candidates = toArray(findParentBy.call(graph, this, evt, x, y));\n\t        } else if (findParentBy === 'pointer') {\n\t            candidates = toArray(graph.findModelsFromPoint({ x: x, y: y }));\n\t        } else {\n\t            candidates = graph.findModelsUnderElement(model, { searchBy: findParentBy });\n\t        }\n\n\t        candidates = candidates.filter(function (el) {\n\t            return (el instanceof Cell) && (model.id !== el.id) && !el.isEmbeddedIn(model);\n\t        });\n\n\t        if (frontParentOnly) {\n\t            // pick the element with the highest `z` index\n\t            candidates = candidates.slice(-1);\n\t        }\n\n\t        var newCandidateView = null;\n\t        var prevCandidateView = data.candidateEmbedView;\n\n\t        // iterate over all candidates starting from the last one (has the highest z-index).\n\t        for (var i = candidates.length - 1; i >= 0; i--) {\n\t            var candidate = candidates[i];\n\t            if (prevCandidateView && prevCandidateView.model.id == candidate.id) {\n\t                // candidate remains the same\n\t                newCandidateView = prevCandidateView;\n\t                break;\n\t            } else {\n\t                var view = candidate.findView(paper);\n\t                if (!isFunction(validateEmbedding) || validateEmbedding.call(paper, this, view)) {\n\t                    // flip to the new candidate\n\t                    newCandidateView = view;\n\t                    break;\n\t                }\n\t            }\n\t        }\n\n\t        if (newCandidateView && newCandidateView != prevCandidateView) {\n\t            // A new candidate view found. Highlight the new one.\n\t            this.clearEmbedding(data);\n\t            data.candidateEmbedView = newCandidateView.highlight(\n\t                newCandidateView.findProxyNode(null, 'container'),\n\t                { embedding: true }\n\t            );\n\t        }\n\n\t        if (!newCandidateView && prevCandidateView) {\n\t            // No candidate view found. Unhighlight the previous candidate.\n\t            this.clearEmbedding(data);\n\t        }\n\t    },\n\n\t    clearEmbedding: function(data) {\n\n\t        data || (data = {});\n\n\t        var candidateView = data.candidateEmbedView;\n\t        if (candidateView) {\n\t            // No candidate view found. Unhighlight the previous candidate.\n\t            candidateView.unhighlight(\n\t                candidateView.findProxyNode(null, 'container'),\n\t                { embedding: true }\n\t            );\n\t            data.candidateEmbedView = null;\n\t        }\n\t    },\n\n\t    finalizeEmbedding: function(data) {\n\t        if ( data === void 0 ) data = {};\n\n\n\t        var candidateView = data.candidateEmbedView;\n\t        var element = data.model || this.model;\n\t        var paper = data.paper || this.paper;\n\n\t        if (candidateView) {\n\n\t            // We finished embedding. Candidate view is chosen to become the parent of the model.\n\t            candidateView.model.embed(element, { ui: true });\n\t            candidateView.unhighlight(candidateView.findProxyNode(null, 'container'), { embedding: true });\n\n\t            data.candidateEmbedView = null;\n\n\t        } else {\n\n\t            var ref = paper.options;\n\t            var validateUnembedding = ref.validateUnembedding;\n\t            var initialParentId = data.initialParentId;\n\t            // The element was originally embedded into another element.\n\t            // The interaction would unembed the element. Let's validate\n\t            // if the element can be unembedded.\n\t            if (\n\t                initialParentId &&\n\t                typeof validateUnembedding === 'function' &&\n\t                !validateUnembedding.call(paper, this)\n\t            ) {\n\t                this._disallowUnembed(data);\n\t                return;\n\t            }\n\t        }\n\n\t        paper.model.getConnectedLinks(element, { deep: true }).forEach(function (link) {\n\t            link.reparent({ ui: true });\n\t        });\n\t    },\n\n\t    _disallowUnembed: function(data) {\n\t        var model = data.model;\n\t        var whenNotAllowed = data.whenNotAllowed; if ( whenNotAllowed === void 0 ) whenNotAllowed = 'revert';\n\t        var element = model || this.model;\n\t        var paper = data.paper || this.paper;\n\t        var graph = paper.model;\n\t        switch (whenNotAllowed) {\n\t            case 'remove': {\n\t                element.remove({ ui: true });\n\t                break;\n\t            }\n\t            case 'revert': {\n\t                var initialParentId = data.initialParentId;\n\t                var initialPosition = data.initialPosition;\n\t                var initialZIndices = data.initialZIndices;\n\t                // Revert the element's position (and the position of its embedded cells if any)\n\t                if (initialPosition) {\n\t                    var x = initialPosition.x;\n\t                    var y = initialPosition.y;\n\t                    element.position(x, y, { deep: true, ui: true });\n\t                }\n\t                // Revert all the z-indices changed during the embedding\n\t                if (initialZIndices) {\n\t                    Object.keys(initialZIndices).forEach(function (id) {\n\t                        var cell = graph.getCell(id);\n\t                        if (cell) {\n\t                            cell.set('z', initialZIndices[id], { ui: true });\n\t                        }\n\t                    });\n\t                }\n\t                // Revert the original parent\n\t                var parent = graph.getCell(initialParentId);\n\t                if (parent) {\n\t                    parent.embed(element, { ui: true });\n\t                }\n\t                break;\n\t            }\n\t        }\n\t    },\n\n\t    getDelegatedView: function() {\n\n\t        var view = this;\n\t        var model = view.model;\n\t        var paper = view.paper;\n\n\t        while (view) {\n\t            if (model.isLink()) { break; }\n\t            if (!model.isEmbedded() || view.can('stopDelegation')) { return view; }\n\t            model = model.getParentCell();\n\t            view = paper.findViewByModel(model);\n\t        }\n\n\t        return null;\n\t    },\n\n\t    findProxyNode: function(el, type) {\n\t        el || (el = this.el);\n\t        var nodeSelector = el.getAttribute((type + \"-selector\"));\n\t        if (nodeSelector) {\n\t            var port = this.findAttribute('port', el);\n\t            if (port) {\n\t                var proxyPortNode = this.findPortNode(port, nodeSelector);\n\t                if (proxyPortNode) { return proxyPortNode; }\n\t            } else {\n\t                var ref = this.findBySelector(nodeSelector);\n\t                var proxyNode = ref[0];\n\t                if (proxyNode) { return proxyNode; }\n\t            }\n\t        }\n\t        return el;\n\t    },\n\n\t    // Interaction. The controller part.\n\t    // ---------------------------------\n\n\t    notifyPointerdown: function notifyPointerdown(evt, x, y) {\n\t        CellView.prototype.pointerdown.call(this, evt, x, y);\n\t        this.notify('element:pointerdown', evt, x, y);\n\t    },\n\n\t    notifyPointermove: function notifyPointermove(evt, x, y) {\n\t        CellView.prototype.pointermove.call(this, evt, x, y);\n\t        this.notify('element:pointermove', evt, x, y);\n\t    },\n\n\t    notifyPointerup: function notifyPointerup(evt, x, y) {\n\t        this.notify('element:pointerup', evt, x, y);\n\t        CellView.prototype.pointerup.call(this, evt, x, y);\n\t    },\n\n\t    pointerdblclick: function(evt, x, y) {\n\n\t        CellView.prototype.pointerdblclick.apply(this, arguments);\n\t        this.notify('element:pointerdblclick', evt, x, y);\n\t    },\n\n\t    pointerclick: function(evt, x, y) {\n\n\t        CellView.prototype.pointerclick.apply(this, arguments);\n\t        this.notify('element:pointerclick', evt, x, y);\n\t    },\n\n\t    contextmenu: function(evt, x, y) {\n\n\t        CellView.prototype.contextmenu.apply(this, arguments);\n\t        this.notify('element:contextmenu', evt, x, y);\n\t    },\n\n\t    pointerdown: function(evt, x, y) {\n\n\t        if (this.isPropagationStopped(evt)) { return; }\n\n\t        this.notifyPointerdown(evt, x, y);\n\t        this.dragStart(evt, x, y);\n\t    },\n\n\t    pointermove: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\n\t        switch (data.action) {\n\t            case 'magnet':\n\t                this.dragMagnet(evt, x, y);\n\t                break;\n\t            case 'move':\n\t                (data.delegatedView || this).drag(evt, x, y);\n\t            // eslint: no-fallthrough=false\n\t            default:\n\t                this.notifyPointermove(evt, x, y);\n\t                break;\n\t        }\n\n\t        // Make sure the element view data is passed along.\n\t        // It could have been wiped out in the handlers above.\n\t        this.eventData(evt, data);\n\t    },\n\n\t    pointerup: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\t        switch (data.action) {\n\t            case 'magnet':\n\t                this.dragMagnetEnd(evt, x, y);\n\t                break;\n\t            case 'move':\n\t                (data.delegatedView || this).dragEnd(evt, x, y);\n\t            // eslint: no-fallthrough=false\n\t            default:\n\t                this.notifyPointerup(evt, x, y);\n\t        }\n\n\t        var magnet = data.targetMagnet;\n\t        if (magnet) { this.magnetpointerclick(evt, magnet, x, y); }\n\n\t        this.checkMouseleave(evt);\n\t    },\n\n\t    mouseover: function(evt) {\n\n\t        CellView.prototype.mouseover.apply(this, arguments);\n\t        this.notify('element:mouseover', evt);\n\t    },\n\n\t    mouseout: function(evt) {\n\n\t        CellView.prototype.mouseout.apply(this, arguments);\n\t        this.notify('element:mouseout', evt);\n\t    },\n\n\t    mouseenter: function(evt) {\n\n\t        CellView.prototype.mouseenter.apply(this, arguments);\n\t        this.notify('element:mouseenter', evt);\n\t    },\n\n\t    mouseleave: function(evt) {\n\n\t        CellView.prototype.mouseleave.apply(this, arguments);\n\t        this.notify('element:mouseleave', evt);\n\t    },\n\n\t    mousewheel: function(evt, x, y, delta) {\n\n\t        CellView.prototype.mousewheel.apply(this, arguments);\n\t        this.notify('element:mousewheel', evt, x, y, delta);\n\t    },\n\n\t    onmagnet: function(evt, x, y) {\n\n\t        this.dragMagnetStart(evt, x, y);\n\t    },\n\n\t    magnetpointerdblclick: function(evt, magnet, x, y) {\n\n\t        this.notify('element:magnet:pointerdblclick', evt, magnet, x, y);\n\t    },\n\n\t    magnetcontextmenu: function(evt, magnet, x, y) {\n\n\t        this.notify('element:magnet:contextmenu', evt, magnet, x, y);\n\t    },\n\n\t    // Drag Start Handlers\n\n\t    dragStart: function(evt, x, y) {\n\n\t        var view = this.getDelegatedView();\n\t        if (!view || !view.can('elementMove')) { return; }\n\n\t        this.eventData(evt, {\n\t            action: 'move',\n\t            delegatedView: view\n\t        });\n\n\t        var position = view.model.position();\n\t        view.eventData(evt, {\n\t            initialPosition: position,\n\t            pointerOffset: position.difference(x, y),\n\t            restrictedArea: this.paper.getRestrictedArea(view, x, y)\n\t        });\n\t    },\n\n\t    dragMagnetStart: function(evt, x, y) {\n\n\t        if (!this.can('addLinkFromMagnet')) { return; }\n\n\t        var magnet = evt.currentTarget;\n\t        var paper = this.paper;\n\t        this.eventData(evt, { targetMagnet: magnet });\n\t        evt.stopPropagation();\n\n\t        if (paper.options.validateMagnet(this, magnet, evt)) {\n\n\t            if (paper.options.magnetThreshold <= 0) {\n\t                this.dragLinkStart(evt, magnet, x, y);\n\t            }\n\n\t            this.eventData(evt, { action: 'magnet' });\n\t            this.stopPropagation(evt);\n\n\t        } else {\n\n\t            this.pointerdown(evt, x, y);\n\t        }\n\n\t        paper.delegateDragEvents(this, evt.data);\n\t    },\n\n\t    // Drag Handlers\n\n\t    drag: function(evt, x, y) {\n\n\t        var paper = this.paper;\n\t        var grid = paper.options.gridSize;\n\t        var element = this.model;\n\t        var data = this.eventData(evt);\n\t        var pointerOffset = data.pointerOffset;\n\t        var restrictedArea = data.restrictedArea;\n\t        var embedding = data.embedding;\n\n\t        // Make sure the new element's position always snaps to the current grid\n\t        var elX = snapToGrid(x + pointerOffset.x, grid);\n\t        var elY = snapToGrid(y + pointerOffset.y, grid);\n\n\t        element.position(elX, elY, { restrictedArea: restrictedArea, deep: true, ui: true });\n\n\t        if (paper.options.embeddingMode) {\n\t            if (!embedding) {\n\t                // Prepare the element for embedding only if the pointer moves.\n\t                // We don't want to do unnecessary action with the element\n\t                // if an user only clicks/dblclicks on it.\n\t                this.prepareEmbedding(data);\n\t                embedding = true;\n\t            }\n\t            this.processEmbedding(data, evt, x, y);\n\t        }\n\n\t        this.eventData(evt, {\n\t            embedding: embedding\n\t        });\n\t    },\n\n\t    dragMagnet: function(evt, x, y) {\n\t        this.dragLink(evt, x, y);\n\t    },\n\n\t    // Drag End Handlers\n\n\t    dragEnd: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\t        if (data.embedding) { this.finalizeEmbedding(data); }\n\t    },\n\n\t    dragMagnetEnd: function(evt, x, y) {\n\t        this.dragLinkEnd(evt, x, y);\n\t    },\n\n\t    magnetpointerclick: function(evt, magnet, x, y) {\n\t        var paper = this.paper;\n\t        if (paper.eventData(evt).mousemoved > paper.options.clickThreshold) { return; }\n\t        this.notify('element:magnet:pointerclick', evt, magnet, x, y);\n\t    }\n\n\t}, {\n\n\t    Flags: Flags,\n\t});\n\n\tassign(ElementView.prototype, elementViewPortPrototype);\n\n\t// Does not make any changes to vertices.\n\t// Returns the arguments that are passed to it, unchanged.\n\tvar normal = function(vertices, opt, linkView) {\n\n\t    return vertices;\n\t};\n\n\t// Routes the link always to/from a certain side\n\t//\n\t// Arguments:\n\t//   padding ... gap between the element and the first vertex. :: Default 40.\n\t//   side ... 'left' | 'right' | 'top' | 'bottom' :: Default 'bottom'.\n\t//\n\tvar oneSide = function(vertices, opt, linkView) {\n\n\t    var side = opt.side || 'bottom';\n\t    var padding = normalizeSides(opt.padding || 40);\n\n\t    // LinkView contains cached source an target bboxes.\n\t    // Note that those are Geometry rectangle objects.\n\t    var sourceBBox = linkView.sourceBBox;\n\t    var targetBBox = linkView.targetBBox;\n\t    var sourcePoint = sourceBBox.center();\n\t    var targetPoint = targetBBox.center();\n\n\t    var coordinate, dimension, direction;\n\n\t    switch (side) {\n\t        case 'bottom':\n\t            direction = 1;\n\t            coordinate = 'y';\n\t            dimension = 'height';\n\t            break;\n\t        case 'top':\n\t            direction = -1;\n\t            coordinate = 'y';\n\t            dimension = 'height';\n\t            break;\n\t        case 'left':\n\t            direction = -1;\n\t            coordinate = 'x';\n\t            dimension = 'width';\n\t            break;\n\t        case 'right':\n\t            direction = 1;\n\t            coordinate = 'x';\n\t            dimension = 'width';\n\t            break;\n\t        default:\n\t            throw new Error('Router: invalid side');\n\t    }\n\n\t    // move the points from the center of the element to outside of it.\n\t    sourcePoint[coordinate] += direction * (sourceBBox[dimension] / 2 + padding[side]);\n\t    targetPoint[coordinate] += direction * (targetBBox[dimension] / 2 + padding[side]);\n\n\t    // make link orthogonal (at least the first and last vertex).\n\t    if ((direction * (sourcePoint[coordinate] - targetPoint[coordinate])) > 0) {\n\t        targetPoint[coordinate] = sourcePoint[coordinate];\n\t    } else {\n\t        sourcePoint[coordinate] = targetPoint[coordinate];\n\t    }\n\n\t    return [sourcePoint].concat(vertices, targetPoint);\n\t};\n\n\t// bearing -> opposite bearing\n\tvar opposites = {\n\t    N: 'S',\n\t    S: 'N',\n\t    E: 'W',\n\t    W: 'E'\n\t};\n\n\t// bearing -> radians\n\tvar radians = {\n\t    N: -Math.PI / 2 * 3,\n\t    S: -Math.PI / 2,\n\t    E: 0,\n\t    W: Math.PI\n\t};\n\n\t// HELPERS //\n\n\t// returns a point `p` where lines p,p1 and p,p2 are perpendicular and p is not contained\n\t// in the given box\n\tfunction freeJoin(p1, p2, bbox) {\n\n\t    var p = new Point(p1.x, p2.y);\n\t    if (bbox.containsPoint(p)) { p = new Point(p2.x, p1.y); }\n\t    // kept for reference\n\t    // if (bbox.containsPoint(p)) p = null;\n\n\t    return p;\n\t}\n\n\t// returns either width or height of a bbox based on the given bearing\n\tfunction getBBoxSize(bbox, bearing) {\n\n\t    return bbox[(bearing === 'W' || bearing === 'E') ? 'width' : 'height'];\n\t}\n\n\t// simple bearing method (calculates only orthogonal cardinals)\n\tfunction getBearing(from, to) {\n\n\t    if (from.x === to.x) { return (from.y > to.y) ? 'N' : 'S'; }\n\t    if (from.y === to.y) { return (from.x > to.x) ? 'W' : 'E'; }\n\t    return null;\n\t}\n\n\t// transform point to a rect\n\tfunction getPointBox(p) {\n\n\t    return new Rect(p.x, p.y, 0, 0);\n\t}\n\n\tfunction getPaddingBox(opt) {\n\n\t    // if both provided, opt.padding wins over opt.elementPadding\n\t    var sides = normalizeSides(opt.padding || opt.elementPadding || 20);\n\n\t    return {\n\t        x: -sides.left,\n\t        y: -sides.top,\n\t        width: sides.left + sides.right,\n\t        height: sides.top + sides.bottom\n\t    };\n\t}\n\n\t// return source bbox\n\tfunction getSourceBBox(linkView, opt) {\n\n\t    return linkView.sourceBBox.clone().moveAndExpand(getPaddingBox(opt));\n\t}\n\n\t// return target bbox\n\tfunction getTargetBBox(linkView, opt) {\n\n\t    return linkView.targetBBox.clone().moveAndExpand(getPaddingBox(opt));\n\t}\n\n\t// return source anchor\n\tfunction getSourceAnchor(linkView, opt) {\n\n\t    if (linkView.sourceAnchor) { return linkView.sourceAnchor; }\n\n\t    // fallback: center of bbox\n\t    var sourceBBox = getSourceBBox(linkView, opt);\n\t    return sourceBBox.center();\n\t}\n\n\t// return target anchor\n\tfunction getTargetAnchor(linkView, opt) {\n\n\t    if (linkView.targetAnchor) { return linkView.targetAnchor; }\n\n\t    // fallback: center of bbox\n\t    var targetBBox = getTargetBBox(linkView, opt);\n\t    return targetBBox.center(); // default\n\t}\n\n\t// PARTIAL ROUTERS //\n\n\tfunction vertexVertex(from, to, bearing) {\n\n\t    var p1 = new Point(from.x, to.y);\n\t    var p2 = new Point(to.x, from.y);\n\t    var d1 = getBearing(from, p1);\n\t    var d2 = getBearing(from, p2);\n\t    var opposite = opposites[bearing];\n\n\t    var p = (d1 === bearing || (d1 !== opposite && (d2 === opposite || d2 !== bearing))) ? p1 : p2;\n\n\t    return { points: [p], direction: getBearing(p, to) };\n\t}\n\n\tfunction elementVertex(from, to, fromBBox) {\n\n\t    var p = freeJoin(from, to, fromBBox);\n\n\t    return { points: [p], direction: getBearing(p, to) };\n\t}\n\n\tfunction vertexElement(from, to, toBBox, bearing) {\n\n\t    var route = {};\n\n\t    var points = [new Point(from.x, to.y), new Point(to.x, from.y)];\n\t    var freePoints = points.filter(function(pt) {\n\t        return !toBBox.containsPoint(pt);\n\t    });\n\t    var freeBearingPoints = freePoints.filter(function(pt) {\n\t        return getBearing(pt, from) !== bearing;\n\t    });\n\n\t    var p;\n\n\t    if (freeBearingPoints.length > 0) {\n\t        // Try to pick a point which bears the same direction as the previous segment.\n\n\t        p = freeBearingPoints.filter(function(pt) {\n\t            return getBearing(from, pt) === bearing;\n\t        }).pop();\n\t        p = p || freeBearingPoints[0];\n\n\t        route.points = [p];\n\t        route.direction = getBearing(p, to);\n\n\t    } else {\n\t        // Here we found only points which are either contained in the element or they would create\n\t        // a link segment going in opposite direction from the previous one.\n\t        // We take the point inside element and move it outside the element in the direction the\n\t        // route is going. Now we can join this point with the current end (using freeJoin).\n\n\t        p = difference(points, freePoints)[0];\n\n\t        var p2 = (new Point(to)).move(p, -getBBoxSize(toBBox, bearing) / 2);\n\t        var p1 = freeJoin(p2, from, toBBox);\n\n\t        route.points = [p1, p2];\n\t        route.direction = getBearing(p2, to);\n\t    }\n\n\t    return route;\n\t}\n\n\tfunction elementElement(from, to, fromBBox, toBBox) {\n\n\t    var route = elementVertex(to, from, toBBox);\n\t    var p1 = route.points[0];\n\n\t    if (fromBBox.containsPoint(p1)) {\n\n\t        route = elementVertex(from, to, fromBBox);\n\t        var p2 = route.points[0];\n\n\t        if (toBBox.containsPoint(p2)) {\n\n\t            var fromBorder = (new Point(from)).move(p2, -getBBoxSize(fromBBox, getBearing(from, p2)) / 2);\n\t            var toBorder = (new Point(to)).move(p1, -getBBoxSize(toBBox, getBearing(to, p1)) / 2);\n\t            var mid = (new Line(fromBorder, toBorder)).midpoint();\n\n\t            var startRoute = elementVertex(from, mid, fromBBox);\n\t            var endRoute = vertexVertex(mid, to, startRoute.direction);\n\n\t            route.points = [startRoute.points[0], endRoute.points[0]];\n\t            route.direction = endRoute.direction;\n\t        }\n\t    }\n\n\t    return route;\n\t}\n\n\t// Finds route for situations where one element is inside the other.\n\t// Typically the route is directed outside the outer element first and\n\t// then back towards the inner element.\n\tfunction insideElement(from, to, fromBBox, toBBox, bearing) {\n\n\t    var route = {};\n\t    var boundary = fromBBox.union(toBBox).inflate(1);\n\n\t    // start from the point which is closer to the boundary\n\t    var reversed = boundary.center().distance(to) > boundary.center().distance(from);\n\t    var start = reversed ? to : from;\n\t    var end = reversed ? from : to;\n\n\t    var p1, p2, p3;\n\n\t    if (bearing) {\n\t        // Points on circle with radius equals 'W + H` are always outside the rectangle\n\t        // with width W and height H if the center of that circle is the center of that rectangle.\n\t        p1 = Point.fromPolar(boundary.width + boundary.height, radians[bearing], start);\n\t        p1 = boundary.pointNearestToPoint(p1).move(p1, -1);\n\n\t    } else {\n\t        p1 = boundary.pointNearestToPoint(start).move(start, 1);\n\t    }\n\n\t    p2 = freeJoin(p1, end, boundary);\n\n\t    if (p1.round().equals(p2.round())) {\n\t        p2 = Point.fromPolar(boundary.width + boundary.height, toRad(p1.theta(start)) + Math.PI / 2, end);\n\t        p2 = boundary.pointNearestToPoint(p2).move(end, 1).round();\n\t        p3 = freeJoin(p1, p2, boundary);\n\t        route.points = reversed ? [p2, p3, p1] : [p1, p3, p2];\n\n\t    } else {\n\t        route.points = reversed ? [p2, p1] : [p1, p2];\n\t    }\n\n\t    route.direction = reversed ? getBearing(p1, to) : getBearing(p2, to);\n\n\t    return route;\n\t}\n\n\t// MAIN ROUTER //\n\n\t// Return points through which a connection needs to be drawn in order to obtain an orthogonal link\n\t// routing from source to target going through `vertices`.\n\tfunction orthogonal(vertices, opt, linkView) {\n\n\t    var sourceBBox = getSourceBBox(linkView, opt);\n\t    var targetBBox = getTargetBBox(linkView, opt);\n\n\t    var sourceAnchor = getSourceAnchor(linkView, opt);\n\t    var targetAnchor = getTargetAnchor(linkView, opt);\n\n\t    // if anchor lies outside of bbox, the bbox expands to include it\n\t    sourceBBox = sourceBBox.union(getPointBox(sourceAnchor));\n\t    targetBBox = targetBBox.union(getPointBox(targetAnchor));\n\n\t    vertices = toArray(vertices).map(Point);\n\t    vertices.unshift(sourceAnchor);\n\t    vertices.push(targetAnchor);\n\n\t    var bearing; // bearing of previous route segment\n\n\t    var orthogonalVertices = []; // the array of found orthogonal vertices to be returned\n\t    for (var i = 0, max = vertices.length - 1; i < max; i++) {\n\n\t        var route = null;\n\n\t        var from = vertices[i];\n\t        var to = vertices[i + 1];\n\n\t        var isOrthogonal = !!getBearing(from, to);\n\n\t        if (i === 0) { // source\n\n\t            if (i + 1 === max) { // route source -> target\n\n\t                // Expand one of the elements by 1px to detect situations when the two\n\t                // elements are positioned next to each other with no gap in between.\n\t                if (sourceBBox.intersect(targetBBox.clone().inflate(1))) {\n\t                    route = insideElement(from, to, sourceBBox, targetBBox);\n\n\t                } else if (!isOrthogonal) {\n\t                    route = elementElement(from, to, sourceBBox, targetBBox);\n\t                }\n\n\t            } else { // route source -> vertex\n\n\t                if (sourceBBox.containsPoint(to)) {\n\t                    route = insideElement(from, to, sourceBBox, getPointBox(to).moveAndExpand(getPaddingBox(opt)));\n\n\t                } else if (!isOrthogonal) {\n\t                    route = elementVertex(from, to, sourceBBox);\n\t                }\n\t            }\n\n\t        } else if (i + 1 === max) { // route vertex -> target\n\n\t            // prevent overlaps with previous line segment\n\t            var isOrthogonalLoop = isOrthogonal && getBearing(to, from) === bearing;\n\n\t            if (targetBBox.containsPoint(from) || isOrthogonalLoop) {\n\t                route = insideElement(from, to, getPointBox(from).moveAndExpand(getPaddingBox(opt)), targetBBox, bearing);\n\n\t            } else if (!isOrthogonal) {\n\t                route = vertexElement(from, to, targetBBox, bearing);\n\t            }\n\n\t        } else if (!isOrthogonal) { // route vertex -> vertex\n\t            route = vertexVertex(from, to, bearing);\n\t        }\n\n\t        // applicable to all routes:\n\n\t        // set bearing for next iteration\n\t        if (route) {\n\t            Array.prototype.push.apply(orthogonalVertices, route.points);\n\t            bearing = route.direction;\n\n\t        } else {\n\t            // orthogonal route and not looped\n\t            bearing = getBearing(from, to);\n\t        }\n\n\t        // push `to` point to identified orthogonal vertices array\n\t        if (i + 1 < max) {\n\t            orthogonalVertices.push(to);\n\t        }\n\t    }\n\n\t    return orthogonalVertices;\n\t}\n\n\tvar config$1 = {\n\n\t    // size of the step to find a route (the grid of the manhattan pathfinder)\n\t    step: 10,\n\n\t    // the number of route finding loops that cause the router to abort\n\t    // returns fallback route instead\n\t    maximumLoops: 2000,\n\n\t    // the number of decimal places to round floating point coordinates\n\t    precision: 1,\n\n\t    // maximum change of direction\n\t    maxAllowedDirectionChange: 90,\n\n\t    // should the router use perpendicular linkView option?\n\t    // does not connect anchor of element but rather a point close-by that is orthogonal\n\t    // this looks much better\n\t    perpendicular: true,\n\n\t    // should the source and/or target not be considered as obstacles?\n\t    excludeEnds: [], // 'source', 'target'\n\n\t    // should certain types of elements not be considered as obstacles?\n\t    excludeTypes: ['basic.Text'],\n\n\t    // possible starting directions from an element\n\t    startDirections: ['top', 'right', 'bottom', 'left'],\n\n\t    // possible ending directions to an element\n\t    endDirections: ['top', 'right', 'bottom', 'left'],\n\n\t    // specify the directions used above and what they mean\n\t    directionMap: {\n\t        top: { x: 0, y: -1 },\n\t        right: { x: 1, y: 0 },\n\t        bottom: { x: 0, y: 1 },\n\t        left: { x: -1, y: 0 }\n\t    },\n\n\t    // cost of an orthogonal step\n\t    cost: function() {\n\n\t        return this.step;\n\t    },\n\n\t    // an array of directions to find next points on the route\n\t    // different from start/end directions\n\t    directions: function() {\n\n\t        var step = this.step;\n\t        var cost = this.cost();\n\n\t        return [\n\t            { offsetX: step, offsetY: 0, cost: cost },\n\t            { offsetX: -step, offsetY: 0, cost: cost },\n\t            { offsetX: 0, offsetY: step, cost: cost },\n\t            { offsetX: 0, offsetY: -step, cost: cost }\n\t        ];\n\t    },\n\n\t    // a penalty received for direction change\n\t    penalties: function() {\n\n\t        return {\n\t            0: 0,\n\t            45: this.step / 2,\n\t            90: this.step / 2\n\t        };\n\t    },\n\n\t    // padding applied on the element bounding boxes\n\t    paddingBox: function() {\n\n\t        var step = this.step;\n\n\t        return {\n\t            x: -step,\n\t            y: -step,\n\t            width: 2 * step,\n\t            height: 2 * step\n\t        };\n\t    },\n\n\t    // A function that determines whether a given point is an obstacle or not.\n\t    // If used, the `padding`, `excludeEnds`and `excludeTypes` options are ignored.\n\t    // (point: dia.Point) => boolean;\n\t    isPointObstacle: null,\n\n\t    // a router to use when the manhattan router fails\n\t    // (one of the partial routes returns null)\n\t    fallbackRouter: function(vertices, opt, linkView) {\n\n\t        if (!isFunction(orthogonal)) {\n\t            throw new Error('Manhattan requires the orthogonal router as default fallback.');\n\t        }\n\n\t        return orthogonal(vertices, assign({}, config$1, opt), linkView);\n\t    },\n\n\t    /* Deprecated */\n\t    // a simple route used in situations when main routing method fails\n\t    // (exceed max number of loop iterations, inaccessible)\n\t    fallbackRoute: function(from, to, opt) {\n\n\t        return null; // null result will trigger the fallbackRouter\n\n\t        // left for reference:\n\t        /*// Find an orthogonal route ignoring obstacles.\n\n\t        var point = ((opt.previousDirAngle || 0) % 180 === 0)\n\t                ? new g.Point(from.x, to.y)\n\t                : new g.Point(to.x, from.y);\n\n\t        return [point];*/\n\t    },\n\n\t    // if a function is provided, it's used to route the link while dragging an end\n\t    // i.e. function(from, to, opt) { return []; }\n\t    draggingRoute: null\n\t};\n\n\t// HELPER CLASSES //\n\n\t// Map of obstacles\n\t// Helper structure to identify whether a point lies inside an obstacle.\n\tfunction ObstacleMap(opt) {\n\n\t    this.map = {};\n\t    this.options = opt;\n\t    // tells how to divide the paper when creating the elements map\n\t    this.mapGridSize = 100;\n\t}\n\n\tObstacleMap.prototype.build = function(graph, link) {\n\n\t    var opt = this.options;\n\n\t    // source or target element could be excluded from set of obstacles\n\t    var excludedEnds = toArray(opt.excludeEnds).reduce(function(res, item) {\n\n\t        var end = link.get(item);\n\t        if (end) {\n\t            var cell = graph.getCell(end.id);\n\t            if (cell) {\n\t                res.push(cell);\n\t            }\n\t        }\n\n\t        return res;\n\t    }, []);\n\n\t    // Exclude any embedded elements from the source and the target element.\n\t    var excludedAncestors = [];\n\n\t    var source = graph.getCell(link.get('source').id);\n\t    if (source) {\n\t        excludedAncestors = union(excludedAncestors, source.getAncestors().map(function(cell) {\n\t            return cell.id;\n\t        }));\n\t    }\n\n\t    var target = graph.getCell(link.get('target').id);\n\t    if (target) {\n\t        excludedAncestors = union(excludedAncestors, target.getAncestors().map(function(cell) {\n\t            return cell.id;\n\t        }));\n\t    }\n\n\t    // Builds a map of all elements for quicker obstacle queries (i.e. is a point contained\n\t    // in any obstacle?) (a simplified grid search).\n\t    // The paper is divided into smaller cells, where each holds information about which\n\t    // elements belong to it. When we query whether a point lies inside an obstacle we\n\t    // don't need to go through all obstacles, we check only those in a particular cell.\n\t    var mapGridSize = this.mapGridSize;\n\n\t    graph.getElements().reduce(function(map, element) {\n\n\t        var isExcludedType = toArray(opt.excludeTypes).includes(element.get('type'));\n\t        var isExcludedEnd = excludedEnds.find(function(excluded) {\n\t            return excluded.id === element.id;\n\t        });\n\t        var isExcludedAncestor = excludedAncestors.includes(element.id);\n\n\t        var isExcluded = isExcludedType || isExcludedEnd || isExcludedAncestor;\n\t        if (!isExcluded) {\n\t            var bbox = element.getBBox().moveAndExpand(opt.paddingBox);\n\n\t            var origin = bbox.origin().snapToGrid(mapGridSize);\n\t            var corner = bbox.corner().snapToGrid(mapGridSize);\n\n\t            for (var x = origin.x; x <= corner.x; x += mapGridSize) {\n\t                for (var y = origin.y; y <= corner.y; y += mapGridSize) {\n\t                    var gridKey = x + '@' + y;\n\t                    map[gridKey] = map[gridKey] || [];\n\t                    map[gridKey].push(bbox);\n\t                }\n\t            }\n\t        }\n\n\t        return map;\n\t    }, this.map);\n\n\t    return this;\n\t};\n\n\tObstacleMap.prototype.isPointAccessible = function(point) {\n\n\t    var mapKey = point.clone().snapToGrid(this.mapGridSize).toString();\n\n\t    return toArray(this.map[mapKey]).every(function(obstacle) {\n\t        return !obstacle.containsPoint(point);\n\t    });\n\t};\n\n\t// Sorted Set\n\t// Set of items sorted by given value.\n\tfunction SortedSet() {\n\t    this.items = [];\n\t    this.hash = {};\n\t    this.values = {};\n\t    this.OPEN = 1;\n\t    this.CLOSE = 2;\n\t}\n\n\tSortedSet.prototype.add = function(item, value) {\n\n\t    if (this.hash[item]) {\n\t        // item removal\n\t        this.items.splice(this.items.indexOf(item), 1);\n\t    } else {\n\t        this.hash[item] = this.OPEN;\n\t    }\n\n\t    this.values[item] = value;\n\n\t    var index$1 = sortedIndex(this.items, item, function(i) {\n\t        return this.values[i];\n\t    }.bind(this));\n\n\t    this.items.splice(index$1, 0, item);\n\t};\n\n\tSortedSet.prototype.remove = function(item) {\n\n\t    this.hash[item] = this.CLOSE;\n\t};\n\n\tSortedSet.prototype.isOpen = function(item) {\n\n\t    return this.hash[item] === this.OPEN;\n\t};\n\n\tSortedSet.prototype.isClose = function(item) {\n\n\t    return this.hash[item] === this.CLOSE;\n\t};\n\n\tSortedSet.prototype.isEmpty = function() {\n\n\t    return this.items.length === 0;\n\t};\n\n\tSortedSet.prototype.pop = function() {\n\n\t    var item = this.items.shift();\n\t    this.remove(item);\n\t    return item;\n\t};\n\n\t// HELPERS //\n\n\t// return source bbox\n\tfunction getSourceBBox$1(linkView, opt) {\n\n\t    // expand by padding box\n\t    if (opt && opt.paddingBox) { return linkView.sourceBBox.clone().moveAndExpand(opt.paddingBox); }\n\n\t    return linkView.sourceBBox.clone();\n\t}\n\n\t// return target bbox\n\tfunction getTargetBBox$1(linkView, opt) {\n\n\t    // expand by padding box\n\t    if (opt && opt.paddingBox) { return linkView.targetBBox.clone().moveAndExpand(opt.paddingBox); }\n\n\t    return linkView.targetBBox.clone();\n\t}\n\n\t// return source anchor\n\tfunction getSourceAnchor$1(linkView, opt) {\n\n\t    if (linkView.sourceAnchor) { return linkView.sourceAnchor; }\n\n\t    // fallback: center of bbox\n\t    var sourceBBox = getSourceBBox$1(linkView, opt);\n\t    return sourceBBox.center();\n\t}\n\n\t// return target anchor\n\tfunction getTargetAnchor$1(linkView, opt) {\n\n\t    if (linkView.targetAnchor) { return linkView.targetAnchor; }\n\n\t    // fallback: center of bbox\n\t    var targetBBox = getTargetBBox$1(linkView, opt);\n\t    return targetBBox.center(); // default\n\t}\n\n\t// returns a direction index from start point to end point\n\t// corrects for grid deformation between start and end\n\tfunction getDirectionAngle(start, end, numDirections, grid, opt) {\n\n\t    var quadrant = 360 / numDirections;\n\t    var angleTheta = start.theta(fixAngleEnd(start, end, grid, opt));\n\t    var normalizedAngle = normalizeAngle(angleTheta + (quadrant / 2));\n\t    return quadrant * Math.floor(normalizedAngle / quadrant);\n\t}\n\n\t// helper function for getDirectionAngle()\n\t// corrects for grid deformation\n\t// (if a point is one grid steps away from another in both dimensions,\n\t// it is considered to be 45 degrees away, even if the real angle is different)\n\t// this causes visible angle discrepancies if `opt.step` is much larger than `paper.gridSize`\n\tfunction fixAngleEnd(start, end, grid, opt) {\n\n\t    var step = opt.step;\n\n\t    var diffX = end.x - start.x;\n\t    var diffY = end.y - start.y;\n\n\t    var gridStepsX = diffX / grid.x;\n\t    var gridStepsY = diffY / grid.y;\n\n\t    var distanceX = gridStepsX * step;\n\t    var distanceY = gridStepsY * step;\n\n\t    return new Point(start.x + distanceX, start.y + distanceY);\n\t}\n\n\t// return the change in direction between two direction angles\n\tfunction getDirectionChange(angle1, angle2) {\n\n\t    var directionChange = Math.abs(angle1 - angle2);\n\t    return (directionChange > 180) ? (360 - directionChange) : directionChange;\n\t}\n\n\t// fix direction offsets according to current grid\n\tfunction getGridOffsets(directions, grid, opt) {\n\n\t    var step = opt.step;\n\n\t    toArray(opt.directions).forEach(function(direction) {\n\n\t        direction.gridOffsetX = (direction.offsetX / step) * grid.x;\n\t        direction.gridOffsetY = (direction.offsetY / step) * grid.y;\n\t    });\n\t}\n\n\t// get grid size in x and y dimensions, adapted to source and target positions\n\tfunction getGrid(step, source, target) {\n\n\t    return {\n\t        source: source.clone(),\n\t        x: getGridDimension(target.x - source.x, step),\n\t        y: getGridDimension(target.y - source.y, step)\n\t    };\n\t}\n\n\t// helper function for getGrid()\n\tfunction getGridDimension(diff, step) {\n\n\t    // return step if diff = 0\n\t    if (!diff) { return step; }\n\n\t    var absDiff = Math.abs(diff);\n\t    var numSteps = Math.round(absDiff / step);\n\n\t    // return absDiff if less than one step apart\n\t    if (!numSteps) { return absDiff; }\n\n\t    // otherwise, return corrected step\n\t    var roundedDiff = numSteps * step;\n\t    var remainder = absDiff - roundedDiff;\n\t    var stepCorrection = remainder / numSteps;\n\n\t    return step + stepCorrection;\n\t}\n\n\t// return a clone of point snapped to grid\n\tfunction snapToGrid$1(point, grid) {\n\n\t    var source = grid.source;\n\n\t    var snappedX = snapToGrid(point.x - source.x, grid.x) + source.x;\n\t    var snappedY = snapToGrid(point.y - source.y, grid.y) + source.y;\n\n\t    return new Point(snappedX, snappedY);\n\t}\n\n\t// round the point to opt.precision\n\tfunction round$4(point, precision) {\n\n\t    return point.round(precision);\n\t}\n\n\t// snap to grid and then round the point\n\tfunction align(point, grid, precision) {\n\n\t    return round$4(snapToGrid$1(point.clone(), grid), precision);\n\t}\n\n\t// return a string representing the point\n\t// string is rounded in both dimensions\n\tfunction getKey(point) {\n\n\t    return point.clone().toString();\n\t}\n\n\t// return a normalized vector from given point\n\t// used to determine the direction of a difference of two points\n\tfunction normalizePoint(point) {\n\n\t    return new Point(\n\t        point.x === 0 ? 0 : Math.abs(point.x) / point.x,\n\t        point.y === 0 ? 0 : Math.abs(point.y) / point.y\n\t    );\n\t}\n\n\t// PATHFINDING //\n\n\t// reconstructs a route by concatenating points with their parents\n\tfunction reconstructRoute(parents, points, tailPoint, from, to, grid, opt) {\n\n\t    var route = [];\n\n\t    var prevDiff = normalizePoint(to.difference(tailPoint));\n\n\t    // tailPoint is assumed to be aligned already\n\t    var currentKey = getKey(tailPoint);\n\t    var parent = parents[currentKey];\n\n\t    var point;\n\t    while (parent) {\n\n\t        // point is assumed to be aligned already\n\t        point = points[currentKey];\n\n\t        var diff = normalizePoint(point.difference(parent));\n\t        if (!diff.equals(prevDiff)) {\n\t            route.unshift(point);\n\t            prevDiff = diff;\n\t        }\n\n\t        // parent is assumed to be aligned already\n\t        currentKey = getKey(parent);\n\t        parent = parents[currentKey];\n\t    }\n\n\t    // leadPoint is assumed to be aligned already\n\t    var leadPoint = points[currentKey];\n\n\t    var fromDiff = normalizePoint(leadPoint.difference(from));\n\t    if (!fromDiff.equals(prevDiff)) {\n\t        route.unshift(leadPoint);\n\t    }\n\n\t    return route;\n\t}\n\n\t// heuristic method to determine the distance between two points\n\tfunction estimateCost(from, endPoints) {\n\n\t    var min = Infinity;\n\n\t    for (var i = 0, len = endPoints.length; i < len; i++) {\n\t        var cost = from.manhattanDistance(endPoints[i]);\n\t        if (cost < min) { min = cost; }\n\t    }\n\n\t    return min;\n\t}\n\n\t// find points around the bbox taking given directions into account\n\t// lines are drawn from anchor in given directions, intersections recorded\n\t// if anchor is outside bbox, only those directions that intersect get a rect point\n\t// the anchor itself is returned as rect point (representing some directions)\n\t// (since those directions are unobstructed by the bbox)\n\tfunction getRectPoints(anchor, bbox, directionList, grid, opt) {\n\n\t    var precision = opt.precision;\n\t    var directionMap = opt.directionMap;\n\n\t    var anchorCenterVector = anchor.difference(bbox.center());\n\n\t    var keys = isObject$1(directionMap) ? Object.keys(directionMap) : [];\n\t    var dirList = toArray(directionList);\n\t    var rectPoints = keys.reduce(function(res, key) {\n\n\t        if (dirList.includes(key)) {\n\t            var direction = directionMap[key];\n\n\t            // create a line that is guaranteed to intersect the bbox if bbox is in the direction\n\t            // even if anchor lies outside of bbox\n\t            var endpoint = new Point(\n\t                anchor.x + direction.x * (Math.abs(anchorCenterVector.x) + bbox.width),\n\t                anchor.y + direction.y * (Math.abs(anchorCenterVector.y) + bbox.height)\n\t            );\n\t            var intersectionLine = new Line(anchor, endpoint);\n\n\t            // get the farther intersection, in case there are two\n\t            // (that happens if anchor lies next to bbox)\n\t            var intersections = intersectionLine.intersect(bbox) || [];\n\t            var numIntersections = intersections.length;\n\t            var farthestIntersectionDistance;\n\t            var farthestIntersection = null;\n\t            for (var i = 0; i < numIntersections; i++) {\n\t                var currentIntersection = intersections[i];\n\t                var distance = anchor.squaredDistance(currentIntersection);\n\t                if ((farthestIntersectionDistance === undefined) || (distance > farthestIntersectionDistance)) {\n\t                    farthestIntersectionDistance = distance;\n\t                    farthestIntersection = currentIntersection;\n\t                }\n\t            }\n\n\t            // if an intersection was found in this direction, it is our rectPoint\n\t            if (farthestIntersection) {\n\t                var point = align(farthestIntersection, grid, precision);\n\n\t                // if the rectPoint lies inside the bbox, offset it by one more step\n\t                if (bbox.containsPoint(point)) {\n\t                    point = align(point.offset(direction.x * grid.x, direction.y * grid.y), grid, precision);\n\t                }\n\n\t                // then add the point to the result array\n\t                // aligned\n\t                res.push(point);\n\t            }\n\t        }\n\n\t        return res;\n\t    }, []);\n\n\t    // if anchor lies outside of bbox, add it to the array of points\n\t    if (!bbox.containsPoint(anchor)) {\n\t        // aligned\n\t        rectPoints.push(align(anchor, grid, precision));\n\t    }\n\n\t    return rectPoints;\n\t}\n\n\t// finds the route between two points/rectangles (`from`, `to`) implementing A* algorithm\n\t// rectangles get rect points assigned by getRectPoints()\n\tfunction findRoute(from, to, isPointObstacle, opt) {\n\n\t    var precision = opt.precision;\n\n\t    // Get grid for this route.\n\n\t    var sourceAnchor, targetAnchor;\n\n\t    if (from instanceof Rect) { // `from` is sourceBBox\n\t        sourceAnchor = round$4(getSourceAnchor$1(this, opt).clone(), precision);\n\t    } else {\n\t        sourceAnchor = round$4(from.clone(), precision);\n\t    }\n\n\t    if (to instanceof Rect) { // `to` is targetBBox\n\t        targetAnchor = round$4(getTargetAnchor$1(this, opt).clone(), precision);\n\t    } else {\n\t        targetAnchor = round$4(to.clone(), precision);\n\t    }\n\n\t    var grid = getGrid(opt.step, sourceAnchor, targetAnchor);\n\n\t    // Get pathfinding points.\n\n\t    var start, end; // aligned with grid by definition\n\t    var startPoints, endPoints; // assumed to be aligned with grid already\n\n\t    // set of points we start pathfinding from\n\t    if (from instanceof Rect) { // `from` is sourceBBox\n\t        start = sourceAnchor;\n\t        startPoints = getRectPoints(start, from, opt.startDirections, grid, opt);\n\n\t    } else {\n\t        start = sourceAnchor;\n\t        startPoints = [start];\n\t    }\n\n\t    // set of points we want the pathfinding to finish at\n\t    if (to instanceof Rect) { // `to` is targetBBox\n\t        end = targetAnchor;\n\t        endPoints = getRectPoints(targetAnchor, to, opt.endDirections, grid, opt);\n\n\t    } else {\n\t        end = targetAnchor;\n\t        endPoints = [end];\n\t    }\n\n\t    // take into account only accessible rect points (those not under obstacles)\n\t    startPoints = startPoints.filter(function (p) { return !isPointObstacle(p); });\n\t    endPoints = endPoints.filter(function (p) { return !isPointObstacle(p); });\n\n\t    // Check that there is an accessible route point on both sides.\n\t    // Otherwise, use fallbackRoute().\n\t    if (startPoints.length > 0 && endPoints.length > 0) {\n\n\t        // The set of tentative points to be evaluated, initially containing the start points.\n\t        // Rounded to nearest integer for simplicity.\n\t        var openSet = new SortedSet();\n\t        // Keeps reference to actual points for given elements of the open set.\n\t        var points = {};\n\t        // Keeps reference to a point that is immediate predecessor of given element.\n\t        var parents = {};\n\t        // Cost from start to a point along best known path.\n\t        var costs = {};\n\n\t        for (var i = 0, n = startPoints.length; i < n; i++) {\n\t            // startPoint is assumed to be aligned already\n\t            var startPoint = startPoints[i];\n\n\t            var key = getKey(startPoint);\n\n\t            openSet.add(key, estimateCost(startPoint, endPoints));\n\t            points[key] = startPoint;\n\t            costs[key] = 0;\n\t        }\n\n\t        var previousRouteDirectionAngle = opt.previousDirectionAngle; // undefined for first route\n\t        var isPathBeginning = (previousRouteDirectionAngle === undefined);\n\n\t        // directions\n\t        var direction, directionChange;\n\t        var directions = opt.directions;\n\t        getGridOffsets(directions, grid, opt);\n\n\t        var numDirections = directions.length;\n\n\t        var endPointsKeys = toArray(endPoints).reduce(function(res, endPoint) {\n\t            // endPoint is assumed to be aligned already\n\n\t            var key = getKey(endPoint);\n\t            res.push(key);\n\t            return res;\n\t        }, []);\n\n\t        // main route finding loop\n\t        var loopsRemaining = opt.maximumLoops;\n\t        while (!openSet.isEmpty() && loopsRemaining > 0) {\n\n\t            // remove current from the open list\n\t            var currentKey = openSet.pop();\n\t            var currentPoint = points[currentKey];\n\t            var currentParent = parents[currentKey];\n\t            var currentCost = costs[currentKey];\n\n\t            var isRouteBeginning = (currentParent === undefined); // undefined for route starts\n\t            var isStart = currentPoint.equals(start); // (is source anchor or `from` point) = can leave in any direction\n\n\t            var previousDirectionAngle;\n\t            if (!isRouteBeginning) { previousDirectionAngle = getDirectionAngle(currentParent, currentPoint, numDirections, grid, opt); } // a vertex on the route\n\t            else if (!isPathBeginning) { previousDirectionAngle = previousRouteDirectionAngle; } // beginning of route on the path\n\t            else if (!isStart) { previousDirectionAngle = getDirectionAngle(start, currentPoint, numDirections, grid, opt); } // beginning of path, start rect point\n\t            else { previousDirectionAngle = null; } // beginning of path, source anchor or `from` point\n\n\t            // check if we reached any endpoint\n\t            var samePoints = startPoints.length === endPoints.length;\n\t            if (samePoints) {\n\t                for (var j = 0; j < startPoints.length; j++) {\n\t                    if (!startPoints[j].equals(endPoints[j])) {\n\t                        samePoints = false;\n\t                        break;\n\t                    }\n\t                }\n\t            }\n\t            var skipEndCheck = (isRouteBeginning && samePoints);\n\t            if (!skipEndCheck && (endPointsKeys.indexOf(currentKey) >= 0)) {\n\t                opt.previousDirectionAngle = previousDirectionAngle;\n\t                return reconstructRoute(parents, points, currentPoint, start, end, grid, opt);\n\t            }\n\n\t            // go over all possible directions and find neighbors\n\t            for (i = 0; i < numDirections; i++) {\n\t                direction = directions[i];\n\n\t                var directionAngle = direction.angle;\n\t                directionChange = getDirectionChange(previousDirectionAngle, directionAngle);\n\n\t                // if the direction changed rapidly, don't use this point\n\t                // any direction is allowed for starting points\n\t                if (!(isPathBeginning && isStart) && directionChange > opt.maxAllowedDirectionChange) { continue; }\n\n\t                var neighborPoint = align(currentPoint.clone().offset(direction.gridOffsetX, direction.gridOffsetY), grid, precision);\n\t                var neighborKey = getKey(neighborPoint);\n\n\t                // Closed points from the openSet were already evaluated.\n\t                if (openSet.isClose(neighborKey) || isPointObstacle(neighborPoint)) { continue; }\n\n\t                // We can only enter end points at an acceptable angle.\n\t                if (endPointsKeys.indexOf(neighborKey) >= 0) { // neighbor is an end point\n\n\t                    var isNeighborEnd = neighborPoint.equals(end); // (is target anchor or `to` point) = can be entered in any direction\n\n\t                    if (!isNeighborEnd) {\n\t                        var endDirectionAngle = getDirectionAngle(neighborPoint, end, numDirections, grid, opt);\n\t                        var endDirectionChange = getDirectionChange(directionAngle, endDirectionAngle);\n\n\t                        if (endDirectionChange > opt.maxAllowedDirectionChange) { continue; }\n\t                    }\n\t                }\n\n\t                // The current direction is ok.\n\n\t                var neighborCost = direction.cost;\n\t                var neighborPenalty = isStart ? 0 : opt.penalties[directionChange]; // no penalties for start point\n\t                var costFromStart = currentCost + neighborCost + neighborPenalty;\n\n\t                if (!openSet.isOpen(neighborKey) || (costFromStart < costs[neighborKey])) {\n\t                    // neighbor point has not been processed yet\n\t                    // or the cost of the path from start is lower than previously calculated\n\n\t                    points[neighborKey] = neighborPoint;\n\t                    parents[neighborKey] = currentPoint;\n\t                    costs[neighborKey] = costFromStart;\n\t                    openSet.add(neighborKey, costFromStart + estimateCost(neighborPoint, endPoints));\n\t                }\n\t            }\n\n\t            loopsRemaining--;\n\t        }\n\t    }\n\n\t    // no route found (`to` point either wasn't accessible or finding route took\n\t    // way too much calculation)\n\t    return opt.fallbackRoute.call(this, start, end, opt);\n\t}\n\n\t// resolve some of the options\n\tfunction resolveOptions(opt) {\n\n\t    opt.directions = result(opt, 'directions');\n\t    opt.penalties = result(opt, 'penalties');\n\t    opt.paddingBox = result(opt, 'paddingBox');\n\t    opt.padding = result(opt, 'padding');\n\n\t    if (opt.padding) {\n\t        // if both provided, opt.padding wins over opt.paddingBox\n\t        var sides = normalizeSides(opt.padding);\n\t        opt.paddingBox = {\n\t            x: -sides.left,\n\t            y: -sides.top,\n\t            width: sides.left + sides.right,\n\t            height: sides.top + sides.bottom\n\t        };\n\t    }\n\n\t    toArray(opt.directions).forEach(function(direction) {\n\n\t        var point1 = new Point(0, 0);\n\t        var point2 = new Point(direction.offsetX, direction.offsetY);\n\n\t        direction.angle = normalizeAngle(point1.theta(point2));\n\t    });\n\t}\n\n\t// initialization of the route finding\n\tfunction router(vertices, opt, linkView) {\n\n\t    resolveOptions(opt);\n\n\t    // enable/disable linkView perpendicular option\n\t    linkView.options.perpendicular = !!opt.perpendicular;\n\n\t    var sourceBBox = getSourceBBox$1(linkView, opt);\n\t    var targetBBox = getTargetBBox$1(linkView, opt);\n\n\t    var sourceAnchor = getSourceAnchor$1(linkView, opt);\n\t    //var targetAnchor = getTargetAnchor(linkView, opt);\n\n\t    // pathfinding\n\t    var isPointObstacle;\n\t    if (typeof opt.isPointObstacle === 'function') {\n\t        isPointObstacle = opt.isPointObstacle;\n\t    } else {\n\t        var map = new ObstacleMap(opt);\n\t        map.build(linkView.paper.model, linkView.model);\n\t        isPointObstacle = function (point) { return !map.isPointAccessible(point); };\n\t    }\n\n\t    var oldVertices = toArray(vertices).map(Point);\n\t    var newVertices = [];\n\t    var tailPoint = sourceAnchor; // the origin of first route's grid, does not need snapping\n\n\t    // find a route by concatenating all partial routes (routes need to pass through vertices)\n\t    // source -> vertex[1] -> ... -> vertex[n] -> target\n\t    var to, from;\n\n\t    for (var i = 0, len = oldVertices.length; i <= len; i++) {\n\n\t        var partialRoute = null;\n\n\t        from = to || sourceBBox;\n\t        to = oldVertices[i];\n\n\t        if (!to) {\n\t            // this is the last iteration\n\t            // we ran through all vertices in oldVertices\n\t            // 'to' is not a vertex.\n\n\t            to = targetBBox;\n\n\t            // If the target is a point (i.e. it's not an element), we\n\t            // should use dragging route instead of main routing method if it has been provided.\n\t            var isEndingAtPoint = !linkView.model.get('source').id || !linkView.model.get('target').id;\n\n\t            if (isEndingAtPoint && isFunction(opt.draggingRoute)) {\n\t                // Make sure we are passing points only (not rects).\n\t                var dragFrom = (from === sourceBBox) ? sourceAnchor : from;\n\t                var dragTo = to.origin();\n\n\t                partialRoute = opt.draggingRoute.call(linkView, dragFrom, dragTo, opt);\n\t            }\n\t        }\n\n\t        // if partial route has not been calculated yet use the main routing method to find one\n\t        partialRoute = partialRoute || findRoute.call(linkView, from, to, isPointObstacle, opt);\n\n\t        if (partialRoute === null) { // the partial route cannot be found\n\t            return opt.fallbackRouter(vertices, opt, linkView);\n\t        }\n\n\t        var leadPoint = partialRoute[0];\n\n\t        // remove the first point if the previous partial route had the same point as last\n\t        if (leadPoint && leadPoint.equals(tailPoint)) { partialRoute.shift(); }\n\n\t        // save tailPoint for next iteration\n\t        tailPoint = partialRoute[partialRoute.length - 1] || tailPoint;\n\n\t        Array.prototype.push.apply(newVertices, partialRoute);\n\t    }\n\n\t    return newVertices;\n\t}\n\n\t// public function\n\tvar manhattan = function(vertices, opt, linkView) {\n\t    return router(vertices, assign({}, config$1, opt), linkView);\n\t};\n\n\tvar config$2 = {\n\n\t    maxAllowedDirectionChange: 45,\n\n\t    // cost of a diagonal step\n\t    diagonalCost: function() {\n\n\t        var step = this.step;\n\t        return Math.ceil(Math.sqrt(step * step << 1));\n\t    },\n\n\t    // an array of directions to find next points on the route\n\t    // different from start/end directions\n\t    directions: function() {\n\n\t        var step = this.step;\n\t        var cost = this.cost();\n\t        var diagonalCost = this.diagonalCost();\n\n\t        return [\n\t            { offsetX: step, offsetY: 0, cost: cost },\n\t            { offsetX: step, offsetY: step, cost: diagonalCost },\n\t            { offsetX: 0, offsetY: step, cost: cost },\n\t            { offsetX: -step, offsetY: step, cost: diagonalCost },\n\t            { offsetX: -step, offsetY: 0, cost: cost },\n\t            { offsetX: -step, offsetY: -step, cost: diagonalCost },\n\t            { offsetX: 0, offsetY: -step, cost: cost },\n\t            { offsetX: step, offsetY: -step, cost: diagonalCost }\n\t        ];\n\t    },\n\n\t    // a simple route used in situations when main routing method fails\n\t    // (exceed max number of loop iterations, inaccessible)\n\t    fallbackRoute: function(from, to, opt) {\n\n\t        // Find a route which breaks by 45 degrees ignoring all obstacles.\n\n\t        var theta = from.theta(to);\n\n\t        var route = [];\n\n\t        var a = { x: to.x, y: from.y };\n\t        var b = { x: from.x, y: to.y };\n\n\t        if (theta % 180 > 90) {\n\t            var t = a;\n\t            a = b;\n\t            b = t;\n\t        }\n\n\t        var p1 = (theta % 90) < 45 ? a : b;\n\t        var l1 = new Line(from, p1);\n\n\t        var alpha = 90 * Math.ceil(theta / 90);\n\n\t        var p2 = Point.fromPolar(l1.squaredLength(), toRad(alpha + 135), p1);\n\t        var l2 = new Line(to, p2);\n\n\t        var intersectionPoint = l1.intersection(l2);\n\t        var point = intersectionPoint ? intersectionPoint : to;\n\n\t        var directionFrom = intersectionPoint ? point : from;\n\n\t        var quadrant = 360 / opt.directions.length;\n\t        var angleTheta = directionFrom.theta(to);\n\t        var normalizedAngle = normalizeAngle(angleTheta + (quadrant / 2));\n\t        var directionAngle = quadrant * Math.floor(normalizedAngle / quadrant);\n\n\t        opt.previousDirectionAngle = directionAngle;\n\n\t        if (point) { route.push(point.round()); }\n\t        route.push(to);\n\n\t        return route;\n\t    }\n\t};\n\n\t// public function\n\tvar metro = function(vertices, opt, linkView) {\n\n\t    if (!isFunction(manhattan)) {\n\t        throw new Error('Metro requires the manhattan router.');\n\t    }\n\n\t    return manhattan(vertices, assign({}, config$2, opt), linkView);\n\t};\n\n\n\n\tvar routers = ({\n\t\tnormal: normal,\n\t\toneSide: oneSide,\n\t\torthogonal: orthogonal,\n\t\tmanhattan: manhattan,\n\t\tmetro: metro\n\t});\n\n\t// default size of jump if not specified in options\n\tvar JUMP_SIZE = 5;\n\n\t// available jump types\n\t// first one taken as default\n\tvar JUMP_TYPES = ['arc', 'gap', 'cubic'];\n\n\t// default radius\n\tvar RADIUS = 0;\n\n\t// takes care of math. error for case when jump is too close to end of line\n\tvar CLOSE_PROXIMITY_PADDING = 1;\n\n\t// list of connector types not to jump over.\n\tvar IGNORED_CONNECTORS = ['smooth'];\n\n\t// internal constants for round segment\n\tvar _13 = 1 / 3;\n\tvar _23 = 2 / 3;\n\n\t/**\n\t * Transform start/end and route into series of lines\n\t * @param {g.point} sourcePoint start point\n\t * @param {g.point} targetPoint end point\n\t * @param {g.point[]} route optional list of route\n\t * @return {g.line[]} [description]\n\t */\n\tfunction createLines(sourcePoint, targetPoint, route) {\n\t    // make a flattened array of all points\n\t    var points = [].concat(sourcePoint, route, targetPoint);\n\t    return points.reduce(function(resultLines, point, idx) {\n\t        // if there is a next point, make a line with it\n\t        var nextPoint = points[idx + 1];\n\t        if (nextPoint != null) {\n\t            resultLines[idx] = line(point, nextPoint);\n\t        }\n\t        return resultLines;\n\t    }, []);\n\t}\n\n\tfunction setupUpdating(jumpOverLinkView) {\n\t    var paper = jumpOverLinkView.paper;\n\t    var updateList = paper._jumpOverUpdateList;\n\n\t    // first time setup for this paper\n\t    if (updateList == null) {\n\t        updateList = paper._jumpOverUpdateList = [];\n\t        var graph = paper.model;\n\t        graph.on('batch:stop', function() {\n\t            if (this.hasActiveBatch()) { return; }\n\t            updateJumpOver(paper);\n\t        });\n\t        graph.on('reset', function() {\n\t            updateList = paper._jumpOverUpdateList = [];\n\t        });\n\t    }\n\n\t    // add this link to a list so it can be updated when some other link is updated\n\t    if (updateList.indexOf(jumpOverLinkView) < 0) {\n\t        updateList.push(jumpOverLinkView);\n\n\t        // watch for change of connector type or removal of link itself\n\t        // to remove the link from a list of jump over connectors\n\t        jumpOverLinkView.listenToOnce(jumpOverLinkView.model, 'change:connector remove', function() {\n\t            updateList.splice(updateList.indexOf(jumpOverLinkView), 1);\n\t        });\n\t    }\n\t}\n\n\t/**\n\t * Handler for a batch:stop event to force\n\t * update of all registered links with jump over connector\n\t * @param {object} batchEvent optional object with info about batch\n\t */\n\tfunction updateJumpOver(paper) {\n\t    var updateList = paper._jumpOverUpdateList;\n\t    for (var i = 0; i < updateList.length; i++) {\n\t        var linkView = updateList[i];\n\t        var updateFlag = linkView.getFlag(linkView.constructor.Flags.CONNECTOR);\n\t        linkView.requestUpdate(updateFlag);\n\t    }\n\t}\n\n\t/**\n\t * Utility function to collect all intersection points of a single\n\t * line against group of other lines.\n\t * @param {g.line} line where to find points\n\t * @param {g.line[]} crossCheckLines lines to cross\n\t * @return {g.point[]} list of intersection points\n\t */\n\tfunction findLineIntersections(line, crossCheckLines) {\n\t    return toArray(crossCheckLines).reduce(function(res, crossCheckLine) {\n\t        var intersection = line.intersection(crossCheckLine);\n\t        if (intersection) {\n\t            res.push(intersection);\n\t        }\n\t        return res;\n\t    }, []);\n\t}\n\n\t/**\n\t * Sorting function for list of points by their distance.\n\t * @param {g.point} p1 first point\n\t * @param {g.point} p2 second point\n\t * @return {number} squared distance between points\n\t */\n\tfunction sortPoints(p1, p2) {\n\t    return line(p1, p2).squaredLength();\n\t}\n\n\t/**\n\t * Split input line into multiple based on intersection points.\n\t * @param {g.line} line input line to split\n\t * @param {g.point[]} intersections points where to split the line\n\t * @param {number} jumpSize the size of jump arc (length empty spot on a line)\n\t * @return {g.line[]} list of lines being split\n\t */\n\tfunction createJumps(line$1, intersections, jumpSize) {\n\t    return intersections.reduce(function(resultLines, point$1, idx) {\n\t        // skipping points that were merged with the previous line\n\t        // to make bigger arc over multiple lines that are close to each other\n\t        if (point$1.skip === true) {\n\t            return resultLines;\n\t        }\n\n\t        // always grab the last line from buffer and modify it\n\t        var lastLine = resultLines.pop() || line$1;\n\n\t        // calculate start and end of jump by moving by a given size of jump\n\t        var jumpStart = point(point$1).move(lastLine.start, -(jumpSize));\n\t        var jumpEnd = point(point$1).move(lastLine.start, +(jumpSize));\n\n\t        // now try to look at the next intersection point\n\t        var nextPoint = intersections[idx + 1];\n\t        if (nextPoint != null) {\n\t            var distance = jumpEnd.distance(nextPoint);\n\t            if (distance <= jumpSize) {\n\t                // next point is close enough, move the jump end by this\n\t                // difference and mark the next point to be skipped\n\t                jumpEnd = nextPoint.move(lastLine.start, distance);\n\t                nextPoint.skip = true;\n\t            }\n\t        } else {\n\t            // this block is inside of `else` as an optimization so the distance is\n\t            // not calculated when we know there are no other intersection points\n\t            var endDistance = jumpStart.distance(lastLine.end);\n\t            // if the end is too close to possible jump, draw remaining line instead of a jump\n\t            if (endDistance < jumpSize * 2 + CLOSE_PROXIMITY_PADDING) {\n\t                resultLines.push(lastLine);\n\t                return resultLines;\n\t            }\n\t        }\n\n\t        var startDistance = jumpEnd.distance(lastLine.start);\n\t        if (startDistance < jumpSize * 2 + CLOSE_PROXIMITY_PADDING) {\n\t            // if the start of line is too close to jump, draw that line instead of a jump\n\t            resultLines.push(lastLine);\n\t            return resultLines;\n\t        }\n\n\t        // finally create a jump line\n\t        var jumpLine = line(jumpStart, jumpEnd);\n\t        // it's just simple line but with a `isJump` property\n\t        jumpLine.isJump = true;\n\n\t        resultLines.push(\n\t            line(lastLine.start, jumpStart),\n\t            jumpLine,\n\t            line(jumpEnd, lastLine.end)\n\t        );\n\t        return resultLines;\n\t    }, []);\n\t}\n\n\t/**\n\t * Assemble `D` attribute of a SVG path by iterating given lines.\n\t * @param {g.line[]} lines source lines to use\n\t * @param {number} jumpSize the size of jump arc (length empty spot on a line)\n\t * @param {number} radius the radius\n\t * @return {string}\n\t */\n\tfunction buildPath(lines, jumpSize, jumpType, radius) {\n\n\t    var path = new Path();\n\t    var segment;\n\n\t    // first move to the start of a first line\n\t    segment = Path.createSegment('M', lines[0].start);\n\t    path.appendSegment(segment);\n\n\t    // make a paths from lines\n\t    toArray(lines).forEach(function(line, index) {\n\n\t        if (line.isJump) {\n\t            var angle, diff;\n\n\t            var control1, control2;\n\n\t            if (jumpType === 'arc') { // approximates semicircle with 2 curves\n\t                angle = -90;\n\t                // determine rotation of arc based on difference between points\n\t                diff = line.start.difference(line.end);\n\t                // make sure the arc always points up (or right)\n\t                var xAxisRotate = Number((diff.x < 0) || (diff.x === 0 && diff.y < 0));\n\t                if (xAxisRotate) { angle += 180; }\n\n\t                var midpoint = line.midpoint();\n\t                var centerLine = new Line(midpoint, line.end).rotate(midpoint, angle);\n\n\t                var halfLine;\n\n\t                // first half\n\t                halfLine = new Line(line.start, midpoint);\n\n\t                control1 = halfLine.pointAt(2 / 3).rotate(line.start, angle);\n\t                control2 = centerLine.pointAt(1 / 3).rotate(centerLine.end, -angle);\n\n\t                segment = Path.createSegment('C', control1, control2, centerLine.end);\n\t                path.appendSegment(segment);\n\n\t                // second half\n\t                halfLine = new Line(midpoint, line.end);\n\n\t                control1 = centerLine.pointAt(1 / 3).rotate(centerLine.end, angle);\n\t                control2 = halfLine.pointAt(1 / 3).rotate(line.end, -angle);\n\n\t                segment = Path.createSegment('C', control1, control2, line.end);\n\t                path.appendSegment(segment);\n\n\t            } else if (jumpType === 'gap') {\n\t                segment = Path.createSegment('M', line.end);\n\t                path.appendSegment(segment);\n\n\t            } else if (jumpType === 'cubic') { // approximates semicircle with 1 curve\n\t                angle = line.start.theta(line.end);\n\n\t                var xOffset = jumpSize * 0.6;\n\t                var yOffset = jumpSize * 1.35;\n\n\t                // determine rotation of arc based on difference between points\n\t                diff = line.start.difference(line.end);\n\t                // make sure the arc always points up (or right)\n\t                xAxisRotate = Number((diff.x < 0) || (diff.x === 0 && diff.y < 0));\n\t                if (xAxisRotate) { yOffset *= -1; }\n\n\t                control1 = Point(line.start.x + xOffset, line.start.y + yOffset).rotate(line.start, angle);\n\t                control2 = Point(line.end.x - xOffset, line.end.y + yOffset).rotate(line.end, angle);\n\n\t                segment = Path.createSegment('C', control1, control2, line.end);\n\t                path.appendSegment(segment);\n\t            }\n\n\t        } else {\n\t            var nextLine = lines[index + 1];\n\t            if (radius == 0 || !nextLine || nextLine.isJump) {\n\t                segment = Path.createSegment('L', line.end);\n\t                path.appendSegment(segment);\n\t            } else {\n\t                buildRoundedSegment(radius, path, line.end, line.start, nextLine.end);\n\t            }\n\t        }\n\t    });\n\n\t    return path;\n\t}\n\n\tfunction buildRoundedSegment(offset, path, curr, prev, next) {\n\t    var prevDistance = curr.distance(prev) / 2;\n\t    var nextDistance = curr.distance(next) / 2;\n\n\t    var startMove = -Math.min(offset, prevDistance);\n\t    var endMove = -Math.min(offset, nextDistance);\n\n\t    var roundedStart = curr.clone().move(prev, startMove).round();\n\t    var roundedEnd = curr.clone().move(next, endMove).round();\n\n\t    var control1 = new Point((_13 * roundedStart.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * roundedStart.y));\n\t    var control2 = new Point((_13 * roundedEnd.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * roundedEnd.y));\n\n\t    var segment;\n\t    segment = Path.createSegment('L', roundedStart);\n\t    path.appendSegment(segment);\n\n\t    segment = Path.createSegment('C', control1, control2, roundedEnd);\n\t    path.appendSegment(segment);\n\t}\n\n\t/**\n\t * Actual connector function that will be run on every update.\n\t * @param {g.point} sourcePoint start point of this link\n\t * @param {g.point} targetPoint end point of this link\n\t * @param {g.point[]} route of this link\n\t * @param {object} opt options\n\t * @property {number} size optional size of a jump arc\n\t * @return {string} created `D` attribute of SVG path\n\t */\n\tvar jumpover = function(sourcePoint, targetPoint, route, opt) { // eslint-disable-line max-params\n\n\t    setupUpdating(this);\n\n\t    var raw = opt.raw;\n\t    var jumpSize = opt.size || JUMP_SIZE;\n\t    var jumpType = opt.jump && ('' + opt.jump).toLowerCase();\n\t    var radius = opt.radius || RADIUS;\n\t    var ignoreConnectors = opt.ignoreConnectors || IGNORED_CONNECTORS;\n\n\t    // grab the first jump type as a default if specified one is invalid\n\t    if (JUMP_TYPES.indexOf(jumpType) === -1) {\n\t        jumpType = JUMP_TYPES[0];\n\t    }\n\n\t    var paper = this.paper;\n\t    var graph = paper.model;\n\t    var allLinks = graph.getLinks();\n\n\t    // there is just one link, draw it directly\n\t    if (allLinks.length === 1) {\n\t        return buildPath(\n\t            createLines(sourcePoint, targetPoint, route),\n\t            jumpSize, jumpType, radius\n\t        );\n\t    }\n\n\t    var thisModel = this.model;\n\t    var thisIndex = allLinks.indexOf(thisModel);\n\t    var defaultConnector = paper.options.defaultConnector || {};\n\n\t    // not all links are meant to be jumped over.\n\t    var links = allLinks.filter(function(link, idx) {\n\n\t        var connector = link.get('connector') || defaultConnector;\n\n\t        // avoid jumping over links with connector type listed in `ignored connectors`.\n\t        if (toArray(ignoreConnectors).includes(connector.name)) {\n\t            return false;\n\t        }\n\t        // filter out links that are above this one and  have the same connector type\n\t        // otherwise there would double hoops for each intersection\n\t        if (idx > thisIndex) {\n\t            return connector.name !== 'jumpover';\n\t        }\n\t        return true;\n\t    });\n\n\t    // find views for all links\n\t    var linkViews = links.map(function(link) {\n\t        return paper.findViewByModel(link);\n\t    });\n\n\t    // create lines for this link\n\t    var thisLines = createLines(\n\t        sourcePoint,\n\t        targetPoint,\n\t        route\n\t    );\n\n\t    // create lines for all other links\n\t    var linkLines = linkViews.map(function(linkView) {\n\t        if (linkView == null) {\n\t            return [];\n\t        }\n\t        if (linkView === this) {\n\t            return thisLines;\n\t        }\n\t        return createLines(\n\t            linkView.sourcePoint,\n\t            linkView.targetPoint,\n\t            linkView.route\n\t        );\n\t    }, this);\n\n\t    // transform lines for this link by splitting with jump lines at\n\t    // points of intersection with other links\n\t    var jumpingLines = thisLines.reduce(function(resultLines, thisLine) {\n\t        // iterate all links and grab the intersections with this line\n\t        // these are then sorted by distance so the line can be split more easily\n\n\t        var intersections = links.reduce(function(res, link, i) {\n\t            // don't intersection with itself\n\t            if (link !== thisModel) {\n\n\t                var lineIntersections = findLineIntersections(thisLine, linkLines[i]);\n\t                res.push.apply(res, lineIntersections);\n\t            }\n\t            return res;\n\t        }, []).sort(function(a, b) {\n\t            return sortPoints(thisLine.start, a) - sortPoints(thisLine.start, b);\n\t        });\n\n\t        if (intersections.length > 0) {\n\t            // split the line based on found intersection points\n\t            resultLines.push.apply(resultLines, createJumps(thisLine, intersections, jumpSize));\n\t        } else {\n\t            // without any intersection the line goes uninterrupted\n\t            resultLines.push(thisLine);\n\t        }\n\t        return resultLines;\n\t    }, []);\n\n\t    var path = buildPath(jumpingLines, jumpSize, jumpType, radius);\n\t    return (raw) ? path : path.serialize();\n\t};\n\n\tvar normal$1 = function(sourcePoint, targetPoint, route, opt) {\n\n\t    var raw = opt && opt.raw;\n\t    var points = [sourcePoint].concat(route).concat([targetPoint]);\n\n\t    var polyline = new Polyline(points);\n\t    var path = new Path(polyline);\n\n\t    return (raw) ? path : path.serialize();\n\t};\n\n\tvar rounded = function(sourcePoint, targetPoint, route, opt) {\n\n\t    opt || (opt = {});\n\n\t    var offset = opt.radius || 10;\n\t    var raw = opt.raw;\n\t    var path = new Path();\n\t    var segment;\n\n\t    segment = Path.createSegment('M', sourcePoint);\n\t    path.appendSegment(segment);\n\n\t    var _13 = 1 / 3;\n\t    var _23 = 2 / 3;\n\n\t    var curr;\n\t    var prev, next;\n\t    var prevDistance, nextDistance;\n\t    var startMove, endMove;\n\t    var roundedStart, roundedEnd;\n\t    var control1, control2;\n\n\t    for (var index = 0, n = route.length; index < n; index++) {\n\n\t        curr = new Point(route[index]);\n\n\t        prev = route[index - 1] || sourcePoint;\n\t        next = route[index + 1] || targetPoint;\n\n\t        prevDistance = nextDistance || (curr.distance(prev) / 2);\n\t        nextDistance = curr.distance(next) / 2;\n\n\t        startMove = -Math.min(offset, prevDistance);\n\t        endMove = -Math.min(offset, nextDistance);\n\n\t        roundedStart = curr.clone().move(prev, startMove).round();\n\t        roundedEnd = curr.clone().move(next, endMove).round();\n\n\t        control1 = new Point((_13 * roundedStart.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * roundedStart.y));\n\t        control2 = new Point((_13 * roundedEnd.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * roundedEnd.y));\n\n\t        segment = Path.createSegment('L', roundedStart);\n\t        path.appendSegment(segment);\n\n\t        segment = Path.createSegment('C', control1, control2, roundedEnd);\n\t        path.appendSegment(segment);\n\t    }\n\n\t    segment = Path.createSegment('L', targetPoint);\n\t    path.appendSegment(segment);\n\n\t    return (raw) ? path : path.serialize();\n\t};\n\n\tvar smooth = function(sourcePoint, targetPoint, route, opt) {\n\n\t    var raw = opt && opt.raw;\n\t    var path;\n\n\t    if (route && route.length !== 0) {\n\n\t        var points = [sourcePoint].concat(route).concat([targetPoint]);\n\t        var curves = Curve.throughPoints(points);\n\n\t        path = new Path(curves);\n\n\t    } else {\n\t        // if we have no route, use a default cubic bezier curve\n\t        // cubic bezier requires two control points\n\t        // the control points have `x` midway between source and target\n\t        // this produces an S-like curve\n\n\t        path = new Path();\n\n\t        var segment;\n\n\t        segment = Path.createSegment('M', sourcePoint);\n\t        path.appendSegment(segment);\n\n\t        if ((Math.abs(sourcePoint.x - targetPoint.x)) >= (Math.abs(sourcePoint.y - targetPoint.y))) {\n\t            var controlPointX = (sourcePoint.x + targetPoint.x) / 2;\n\n\t            segment = Path.createSegment('C', controlPointX, sourcePoint.y, controlPointX, targetPoint.y, targetPoint.x, targetPoint.y);\n\t            path.appendSegment(segment);\n\n\t        } else {\n\t            var controlPointY = (sourcePoint.y + targetPoint.y) / 2;\n\n\t            segment = Path.createSegment('C', sourcePoint.x, controlPointY, targetPoint.x, controlPointY, targetPoint.x, targetPoint.y);\n\t            path.appendSegment(segment);\n\n\t        }\n\t    }\n\n\t    return (raw) ? path : path.serialize();\n\t};\n\n\tvar Directions = {\n\t    AUTO: 'auto',\n\t    HORIZONTAL: 'horizontal',\n\t    VERTICAL: 'vertical',\n\t    CLOSEST_POINT: 'closest-point',\n\t    OUTWARDS: 'outwards'\n\t};\n\n\tvar TangentDirections = {\n\t    UP: 'up',\n\t    DOWN: 'down',\n\t    LEFT: 'left',\n\t    RIGHT: 'right',\n\t    AUTO: 'auto',\n\t    CLOSEST_POINT: 'closest-point',\n\t    OUTWARDS: 'outwards'\n\t};\n\n\tvar curve = function(sourcePoint, targetPoint, route, opt, linkView) {\n\t    if ( route === void 0 ) route = [];\n\t    if ( opt === void 0 ) opt = {};\n\n\t    var raw = Boolean(opt.raw);\n\t    // distanceCoefficient - a coefficient of the tangent vector length relative to the distance between points.\n\t    // angleTangentCoefficient - a coefficient of the end tangents length in the case of angles larger than 45 degrees.\n\t    // tension - a Catmull-Rom curve tension parameter.\n\t    // sourceTangent - a tangent vector along the curve at the sourcePoint.\n\t    // sourceDirection - a unit direction vector along the curve at the sourcePoint.\n\t    // targetTangent - a tangent vector along the curve at the targetPoint.\n\t    // targetDirection - a unit direction vector along the curve at the targetPoint.\n\t    // precision - a rounding precision for path values.\n\t    var direction = opt.direction; if ( direction === void 0 ) direction = Directions.AUTO;\n\t    var precision = opt.precision; if ( precision === void 0 ) precision = 3;\n\t    var options = {\n\t        coeff: opt.distanceCoefficient || 0.6,\n\t        angleTangentCoefficient: opt.angleTangentCoefficient || 80,\n\t        tau: opt.tension || 0.5,\n\t        sourceTangent: opt.sourceTangent ? new Point(opt.sourceTangent) : null,\n\t        targetTangent: opt.targetTangent ? new Point(opt.targetTangent) : null\n\t    };\n\t    if (typeof opt.sourceDirection === 'string')\n\t        { options.sourceDirection = opt.sourceDirection; }\n\t    else if (typeof opt.sourceDirection === 'number')\n\t        { options.sourceDirection = new Point(1, 0).rotate(null, opt.sourceDirection); }\n\t    else\n\t        { options.sourceDirection = opt.sourceDirection ? new Point(opt.sourceDirection).normalize() : null; }\n\n\t    if (typeof opt.targetDirection === 'string')\n\t        { options.targetDirection = opt.targetDirection; }\n\t    else if (typeof opt.targetDirection === 'number')\n\t        { options.targetDirection = new Point(1, 0).rotate(null, opt.targetDirection); }\n\t    else\n\t        { options.targetDirection = opt.targetDirection ? new Point(opt.targetDirection).normalize() : null; }\n\n\t    var completeRoute = [sourcePoint ].concat( route.map(function (p) { return new Point(p); }), [targetPoint]);\n\n\t    // The calculation of a sourceTangent\n\t    var sourceTangent;\n\t    if (options.sourceTangent) {\n\t        sourceTangent = options.sourceTangent;\n\t    } else {\n\t        var sourceDirection = getSourceTangentDirection(linkView, completeRoute, direction, options);\n\t        var tangentLength = completeRoute[0].distance(completeRoute[1]) * options.coeff;\n\t        var pointsVector = completeRoute[1].difference(completeRoute[0]).normalize();\n\t        var angle = angleBetweenVectors(sourceDirection, pointsVector);\n\t        if (angle > Math.PI / 4) {\n\t            var updatedLength = tangentLength + (angle - Math.PI / 4) * options.angleTangentCoefficient;\n\t            sourceTangent = sourceDirection.clone().scale(updatedLength, updatedLength);\n\t        } else {\n\t            sourceTangent = sourceDirection.clone().scale(tangentLength, tangentLength);\n\t        }\n\t    }\n\n\t    // The calculation of a targetTangent\n\t    var targetTangent;\n\t    if (options.targetTangent) {\n\t        targetTangent = options.targetTangent;\n\t    } else {\n\t        var targetDirection = getTargetTangentDirection(linkView, completeRoute, direction, options);\n\t        var last = completeRoute.length - 1;\n\t        var tangentLength$1 = completeRoute[last - 1].distance(completeRoute[last]) * options.coeff;\n\t        var pointsVector$1 = completeRoute[last - 1].difference(completeRoute[last]).normalize();\n\t        var angle$1 = angleBetweenVectors(targetDirection, pointsVector$1);\n\t        if (angle$1 > Math.PI / 4) {\n\t            var updatedLength$1 = tangentLength$1 + (angle$1 - Math.PI / 4) * options.angleTangentCoefficient;\n\t            targetTangent = targetDirection.clone().scale(updatedLength$1, updatedLength$1);\n\t        } else {\n\t            targetTangent = targetDirection.clone().scale(tangentLength$1, tangentLength$1);\n\t        }\n\t    }\n\n\t    var catmullRomCurves = createCatmullRomCurves(completeRoute, sourceTangent, targetTangent, options);\n\t    var bezierCurves = catmullRomCurves.map(function (curve) { return catmullRomToBezier(curve, options); });\n\t    var path = new Path(bezierCurves).round(precision);\n\n\t    return (raw) ? path : path.serialize();\n\t};\n\tcurve.Directions = Directions;\n\tcurve.TangentDirections = TangentDirections;\n\n\tfunction getHorizontalSourceDirection(linkView, route, options) {\n\t    var sourceBBox = linkView.sourceBBox;\n\n\t    var sourceSide;\n\t    if (!sourceBBox.width || !sourceBBox.height) {\n\t        if (sourceBBox.x > route[1].x)\n\t            { sourceSide = 'right'; }\n\t        else\n\t            { sourceSide = 'left'; }\n\t    } else {\n\t        sourceSide = sourceBBox.sideNearestToPoint(route[0]);\n\t    }\n\n\t    switch (sourceSide) {\n\t        case 'left':\n\t            return new Point(-1, 0);\n\t        case 'right':\n\t        default:\n\t            return new Point(1, 0);\n\t    }\n\t}\n\n\tfunction getHorizontalTargetDirection(linkView, route, options) {\n\t    var targetBBox = linkView.targetBBox;\n\n\t    var targetSide;\n\t    if (!targetBBox.width || !targetBBox.height) {\n\t        if (targetBBox.x > route[route.length - 2].x)\n\t            { targetSide = 'left'; }\n\t        else\n\t            { targetSide = 'right'; }\n\t    } else {\n\t        targetSide = targetBBox.sideNearestToPoint(route[route.length - 1]);\n\t    }\n\n\t    switch (targetSide) {\n\t        case 'left':\n\t            return new Point(-1, 0);\n\t        case 'right':\n\t        default:\n\t            return new Point(1, 0);\n\t    }\n\t}\n\n\tfunction getVerticalSourceDirection(linkView, route, options) {\n\t    var sourceBBox = linkView.sourceBBox;\n\n\t    var sourceSide;\n\t    if (!sourceBBox.width || !sourceBBox.height) {\n\t        if (sourceBBox.y > route[1].y)\n\t            { sourceSide = 'bottom'; }\n\t        else\n\t            { sourceSide = 'top'; }\n\t    } else {\n\t        sourceSide = sourceBBox.sideNearestToPoint(route[0]);\n\t    }\n\n\t    switch (sourceSide) {\n\t        case 'top':\n\t            return new Point(0, -1);\n\t        case 'bottom':\n\t        default:\n\t            return new Point(0, 1);\n\t    }\n\t}\n\n\tfunction getVerticalTargetDirection(linkView, route, options) {\n\t    var targetBBox = linkView.targetBBox;\n\n\t    var targetSide;\n\t    if (!targetBBox.width || !targetBBox.height) {\n\t        if (targetBBox.y > route[route.length - 2].y)\n\t            { targetSide = 'top'; }\n\t        else\n\t            { targetSide = 'bottom'; }\n\t    } else {\n\t        targetSide = targetBBox.sideNearestToPoint(route[route.length - 1]);\n\t    }\n\n\t    switch (targetSide) {\n\t        case 'top':\n\t            return new Point(0, -1);\n\t        case 'bottom':\n\t        default:\n\t            return new Point(0, 1);\n\t    }\n\t}\n\n\tfunction getAutoSourceDirection(linkView, route, options) {\n\t    var sourceBBox = linkView.sourceBBox;\n\n\t    var sourceSide;\n\t    if (!sourceBBox.width || !sourceBBox.height) {\n\t        sourceSide = sourceBBox.sideNearestToPoint(route[1]);\n\t    } else {\n\t        sourceSide = sourceBBox.sideNearestToPoint(route[0]);\n\t    }\n\n\t    switch (sourceSide) {\n\t        case 'top':\n\t            return new Point(0, -1);\n\t        case 'bottom':\n\t            return new Point(0, 1);\n\t        case 'right':\n\t            return new Point(1, 0);\n\t        case 'left':\n\t            return new Point(-1, 0);\n\t    }\n\t}\n\n\tfunction getAutoTargetDirection(linkView, route, options) {\n\t    var targetBBox = linkView.targetBBox;\n\n\t    var targetSide;\n\t    if (!targetBBox.width || !targetBBox.height) {\n\t        targetSide = targetBBox.sideNearestToPoint(route[route.length - 2]);\n\t    } else {\n\t        targetSide = targetBBox.sideNearestToPoint(route[route.length - 1]);\n\t    }\n\n\t    switch (targetSide) {\n\t        case 'top':\n\t            return new Point(0, -1);\n\t        case 'bottom':\n\t            return new Point(0, 1);\n\t        case 'right':\n\t            return new Point(1, 0);\n\t        case 'left':\n\t            return new Point(-1, 0);\n\t    }\n\t}\n\n\tfunction getClosestPointSourceDirection(linkView, route, options) {\n\t    return route[1].difference(route[0]).normalize();\n\t}\n\n\tfunction getClosestPointTargetDirection(linkView, route, options) {\n\t    var last = route.length - 1;\n\t    return route[last - 1].difference(route[last]).normalize();\n\t}\n\n\tfunction getOutwardsSourceDirection(linkView, route, options) {\n\t    var sourceBBox = linkView.sourceBBox;\n\t    var sourceCenter = sourceBBox.center();\n\t    return route[0].difference(sourceCenter).normalize();\n\t}\n\n\tfunction getOutwardsTargetDirection(linkView, route, options) {\n\t    var targetBBox = linkView.targetBBox;\n\t    var targetCenter = targetBBox.center();\n\t    return route[route.length - 1].difference(targetCenter).normalize();\n\t}\n\n\tfunction getSourceTangentDirection(linkView, route, direction, options) {\n\t    if (options.sourceDirection) {\n\t        switch (options.sourceDirection) {\n\t            case TangentDirections.UP:\n\t                return new Point(0, -1);\n\t            case TangentDirections.DOWN:\n\t                return new Point(0, 1);\n\t            case TangentDirections.LEFT:\n\t                return new Point(-1, 0);\n\t            case TangentDirections.RIGHT:\n\t                return new Point(1, 0);\n\t            case TangentDirections.AUTO:\n\t                return getAutoSourceDirection(linkView, route, options);\n\t            case TangentDirections.CLOSEST_POINT:\n\t                return getClosestPointSourceDirection(linkView, route, options);\n\t            case TangentDirections.OUTWARDS:\n\t                return getOutwardsSourceDirection(linkView, route, options);\n\t            default:\n\t                return options.sourceDirection;\n\t        }\n\t    }\n\n\t    switch (direction) {\n\t        case Directions.HORIZONTAL:\n\t            return getHorizontalSourceDirection(linkView, route, options);\n\t        case Directions.VERTICAL:\n\t            return getVerticalSourceDirection(linkView, route, options);\n\t        case Directions.CLOSEST_POINT:\n\t            return getClosestPointSourceDirection(linkView, route, options);\n\t        case Directions.OUTWARDS:\n\t            return getOutwardsSourceDirection(linkView, route, options);\n\t        case Directions.AUTO:\n\t        default:\n\t            return getAutoSourceDirection(linkView, route, options);\n\t    }\n\t}\n\n\tfunction getTargetTangentDirection(linkView, route, direction, options) {\n\t    if (options.targetDirection) {\n\t        switch (options.targetDirection) {\n\t            case TangentDirections.UP:\n\t                return new Point(0, -1);\n\t            case TangentDirections.DOWN:\n\t                return new Point(0, 1);\n\t            case TangentDirections.LEFT:\n\t                return new Point(-1, 0);\n\t            case TangentDirections.RIGHT:\n\t                return new Point(0, 1);\n\t            case TangentDirections.AUTO:\n\t                return getAutoTargetDirection(linkView, route, options);\n\t            case TangentDirections.CLOSEST_POINT:\n\t                return getClosestPointTargetDirection(linkView, route, options);\n\t            case TangentDirections.OUTWARDS:\n\t                return getOutwardsTargetDirection(linkView, route, options);\n\t            default:\n\t                return options.targetDirection;\n\t        }\n\t    }\n\n\t    switch (direction) {\n\t        case Directions.HORIZONTAL:\n\t            return getHorizontalTargetDirection(linkView, route, options);\n\t        case Directions.VERTICAL:\n\t            return getVerticalTargetDirection(linkView, route, options);\n\t        case Directions.CLOSEST_POINT:\n\t            return getClosestPointTargetDirection(linkView, route, options);\n\t        case Directions.OUTWARDS:\n\t            return getOutwardsTargetDirection(linkView, route, options);\n\t        case Directions.AUTO:\n\t        default:\n\t            return getAutoTargetDirection(linkView, route, options);\n\t    }\n\t}\n\n\tfunction rotateVector(vector, angle) {\n\t    var cos = Math.cos(angle);\n\t    var sin = Math.sin(angle);\n\t    var x = cos * vector.x - sin * vector.y;\n\t    var y = sin * vector.x + cos * vector.y;\n\t    vector.x = x;\n\t    vector.y = y;\n\t}\n\n\tfunction angleBetweenVectors(v1, v2) {\n\t    var cos = v1.dot(v2) / (v1.magnitude() * v2.magnitude());\n\t    if (cos < -1) { cos = -1; }\n\t    if (cos > 1) { cos = 1; }\n\t    return Math.acos(cos);\n\t}\n\n\tfunction determinant(v1, v2) {\n\t    return v1.x * v2.y - v1.y * v2.x;\n\t}\n\n\tfunction createCatmullRomCurves(points, sourceTangent, targetTangent, options) {\n\t    var tau = options.tau;\n\t    var coeff = options.coeff;\n\t    var distances = [];\n\t    var tangents = [];\n\t    var catmullRomCurves = [];\n\t    var n = points.length - 1;\n\n\t    for (var i = 0; i < n; i++) {\n\t        distances[i] = points[i].distance(points[i + 1]);\n\t    }\n\n\t    tangents[0] = sourceTangent;\n\t    tangents[n] = targetTangent;\n\n\t    // The calculation of tangents of vertices\n\t    for (var i$1 = 1; i$1 < n; i$1++) {\n\t        var tpPrev = (void 0);\n\t        var tpNext = (void 0);\n\t        if (i$1 === 1) {\n\t            tpPrev = points[i$1 - 1].clone().offset(tangents[i$1 - 1].x, tangents[i$1 - 1].y);\n\t        } else {\n\t            tpPrev = points[i$1 - 1].clone();\n\t        }\n\t        if (i$1 === n - 1) {\n\t            tpNext = points[i$1 + 1].clone().offset(tangents[i$1 + 1].x, tangents[i$1 + 1].y);\n\t        } else {\n\t            tpNext = points[i$1 + 1].clone();\n\t        }\n\t        var v1 = tpPrev.difference(points[i$1]).normalize();\n\t        var v2 = tpNext.difference(points[i$1]).normalize();\n\t        var vAngle = angleBetweenVectors(v1, v2);\n\n\t        var rot = (Math.PI - vAngle) / 2;\n\t        var t = (void 0);\n\t        var vectorDeterminant = determinant(v1, v2);\n\t        var pointsDeterminant = (void 0);\n\t        pointsDeterminant = determinant(points[i$1].difference(points[i$1 + 1]), points[i$1].difference(points[i$1 - 1]));\n\t        if (vectorDeterminant < 0) {\n\t            rot = -rot;\n\t        }\n\t        if ((vAngle < Math.PI / 2) && ((rot < 0 && pointsDeterminant < 0) || (rot > 0 && pointsDeterminant > 0))) {\n\t            rot = rot - Math.PI;\n\t        }\n\t        t = v2.clone();\n\t        rotateVector(t, rot);\n\n\t        var t1 = t.clone();\n\t        var t2 = t.clone();\n\t        var scaleFactor1 = distances[i$1 - 1] * coeff;\n\t        var scaleFactor2 = distances[i$1] * coeff;\n\t        t1.scale(scaleFactor1, scaleFactor1);\n\t        t2.scale(scaleFactor2, scaleFactor2);\n\n\t        tangents[i$1] = [t1, t2];\n\t    }\n\n\t    // The building of a Catmull-Rom curve based of tangents of points\n\t    for (var i$2 = 0; i$2 < n; i$2++) {\n\t        var p0 = (void 0);\n\t        var p3 = (void 0);\n\t        if (i$2 === 0) {\n\t            p0 = points[i$2 + 1].difference(tangents[i$2].x / tau, tangents[i$2].y / tau);\n\t        } else {\n\t            p0 = points[i$2 + 1].difference(tangents[i$2][1].x / tau, tangents[i$2][1].y / tau);\n\t        }\n\t        if (i$2 === n - 1) {\n\t            p3 = points[i$2].clone().offset(tangents[i$2 + 1].x / tau, tangents[i$2 + 1].y / tau);\n\t        } else {\n\t            p3 = points[i$2].difference(tangents[i$2 + 1][0].x / tau, tangents[i$2 + 1][0].y / tau);\n\t        }\n\n\t        catmullRomCurves[i$2] = [p0, points[i$2], points[i$2 + 1], p3];\n\t    }\n\t    return catmullRomCurves;\n\t}\n\n\t// The function to convert Catmull-Rom curve to Bezier curve using the tension (tau)\n\tfunction catmullRomToBezier(points, options) {\n\t    var tau = options.tau;\n\n\t    var bcp1 = new Point();\n\t    bcp1.x = points[1].x + (points[2].x - points[0].x) / (6 * tau);\n\t    bcp1.y = points[1].y + (points[2].y - points[0].y) / (6 * tau);\n\n\t    var bcp2 = new Point();\n\t    bcp2.x = points[2].x + (points[3].x - points[1].x) / (6 * tau);\n\t    bcp2.y = points[2].y + (points[3].y - points[1].y) / (6 * tau);\n\t    return new Curve(\n\t        points[1],\n\t        bcp1,\n\t        bcp2,\n\t        points[2]\n\t    );\n\t}\n\n\n\n\tvar connectors = ({\n\t\tjumpover: jumpover,\n\t\tnormal: normal$1,\n\t\trounded: rounded,\n\t\tsmooth: smooth,\n\t\tcurve: curve\n\t});\n\n\tvar Flags$1 = {\n\t    RENDER: 'RENDER',\n\t    UPDATE: 'UPDATE',\n\t    TOOLS: 'TOOLS',\n\t    LEGACY_TOOLS: 'LEGACY_TOOLS',\n\t    LABELS: 'LABELS',\n\t    VERTICES: 'VERTICES',\n\t    SOURCE: 'SOURCE',\n\t    TARGET: 'TARGET',\n\t    CONNECTOR: 'CONNECTOR'\n\t};\n\n\t// Link base view and controller.\n\t// ----------------------------------------\n\n\tvar LinkView = CellView.extend({\n\n\t    className: function() {\n\n\t        var classNames = CellView.prototype.className.apply(this).split(' ');\n\n\t        classNames.push('link');\n\n\t        return classNames.join(' ');\n\t    },\n\n\t    options: {\n\n\t        shortLinkLength: 105,\n\t        doubleLinkTools: false,\n\t        longLinkLength: 155,\n\t        linkToolsOffset: 40,\n\t        doubleLinkToolsOffset: 65,\n\t        sampleInterval: 50,\n\t    },\n\n\t    _labelCache: null,\n\t    _labelSelectors: null,\n\t    _markerCache: null,\n\t    _V: null,\n\t    _dragData: null, // deprecated\n\n\t    metrics: null,\n\t    decimalsRounding: 2,\n\n\t    initialize: function() {\n\n\t        CellView.prototype.initialize.apply(this, arguments);\n\n\t        // `_.labelCache` is a mapping of indexes of labels in the `this.get('labels')` array to\n\t        // `<g class=\"label\">` nodes wrapped by Vectorizer. This allows for quick access to the\n\t        // nodes in `updateLabelPosition()` in order to update the label positions.\n\t        this._labelCache = {};\n\n\t        // a cache of label selectors\n\t        this._labelSelectors = {};\n\n\t        // keeps markers bboxes and positions again for quicker access\n\t        this._markerCache = {};\n\n\t        // cache of default markup nodes\n\t        this._V = {};\n\n\t        // connection path metrics\n\t        this.cleanNodesCache();\n\t    },\n\n\t    presentationAttributes: {\n\t        markup: [Flags$1.RENDER],\n\t        attrs: [Flags$1.UPDATE],\n\t        router: [Flags$1.UPDATE],\n\t        connector: [Flags$1.CONNECTOR],\n\t        smooth: [Flags$1.UPDATE],\n\t        manhattan: [Flags$1.UPDATE],\n\t        toolMarkup: [Flags$1.LEGACY_TOOLS],\n\t        labels: [Flags$1.LABELS],\n\t        labelMarkup: [Flags$1.LABELS],\n\t        vertices: [Flags$1.VERTICES, Flags$1.UPDATE],\n\t        vertexMarkup: [Flags$1.VERTICES],\n\t        source: [Flags$1.SOURCE, Flags$1.UPDATE],\n\t        target: [Flags$1.TARGET, Flags$1.UPDATE]\n\t    },\n\n\t    initFlag: [Flags$1.RENDER, Flags$1.SOURCE, Flags$1.TARGET, Flags$1.TOOLS],\n\n\t    UPDATE_PRIORITY: 1,\n\n\t    confirmUpdate: function(flags, opt) {\n\n\t        opt || (opt = {});\n\n\t        if (this.hasFlag(flags, Flags$1.SOURCE)) {\n\t            if (!this.updateEndProperties('source')) { return flags; }\n\t            flags = this.removeFlag(flags, Flags$1.SOURCE);\n\t        }\n\n\t        if (this.hasFlag(flags, Flags$1.TARGET)) {\n\t            if (!this.updateEndProperties('target')) { return flags; }\n\t            flags = this.removeFlag(flags, Flags$1.TARGET);\n\t        }\n\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var sourceView = ref.sourceView;\n\t        var targetView = ref.targetView;\n\t        if (paper && ((sourceView && !paper.isViewMounted(sourceView)) || (targetView && !paper.isViewMounted(targetView)))) {\n\t            // Wait for the sourceView and targetView to be rendered\n\t            return flags;\n\t        }\n\n\t        if (this.hasFlag(flags, Flags$1.RENDER)) {\n\t            this.render();\n\t            this.updateHighlighters(true);\n\t            this.updateTools(opt);\n\t            flags = this.removeFlag(flags, [Flags$1.RENDER, Flags$1.UPDATE, Flags$1.VERTICES, Flags$1.LABELS, Flags$1.TOOLS, Flags$1.LEGACY_TOOLS, Flags$1.CONNECTOR]);\n\t            return flags;\n\t        }\n\n\t        var updateHighlighters = false;\n\n\t        if (this.hasFlag(flags, Flags$1.VERTICES)) {\n\t            this.renderVertexMarkers();\n\t            flags = this.removeFlag(flags, Flags$1.VERTICES);\n\t        }\n\n\t        var ref$1 = this;\n\t        var model = ref$1.model;\n\t        var attributes = model.attributes;\n\t        var updateLabels = this.hasFlag(flags, Flags$1.LABELS);\n\t        var updateLegacyTools = this.hasFlag(flags, Flags$1.LEGACY_TOOLS);\n\n\t        if (updateLabels) {\n\t            this.onLabelsChange(model, attributes.labels, opt);\n\t            flags = this.removeFlag(flags, Flags$1.LABELS);\n\t            updateHighlighters = true;\n\t        }\n\n\t        if (updateLegacyTools) {\n\t            this.renderTools();\n\t            flags = this.removeFlag(flags, Flags$1.LEGACY_TOOLS);\n\t        }\n\n\t        var updateAll = this.hasFlag(flags, Flags$1.UPDATE);\n\t        var updateConnector = this.hasFlag(flags, Flags$1.CONNECTOR);\n\t        if (updateAll || updateConnector) {\n\t            if (!updateAll) {\n\t                // Keep the current route and update the geometry\n\t                this.updatePath();\n\t                this.updateDOM();\n\t            } else if (opt.translateBy && model.isRelationshipEmbeddedIn(opt.translateBy)) {\n\t                // The link is being translated by an ancestor that will\n\t                // shift source point, target point and all vertices\n\t                // by an equal distance.\n\t                this.translate(opt.tx, opt.ty);\n\t            } else {\n\t                this.update();\n\t            }\n\t            this.updateTools(opt);\n\t            flags = this.removeFlag(flags, [Flags$1.UPDATE, Flags$1.TOOLS, Flags$1.CONNECTOR]);\n\t            updateLabels = false;\n\t            updateLegacyTools = false;\n\t            updateHighlighters = true;\n\t        }\n\n\t        if (updateLabels) {\n\t            this.updateLabelPositions();\n\t        }\n\n\t        if (updateLegacyTools) {\n\t            this.updateToolsPosition();\n\t        }\n\n\t        if (updateHighlighters) {\n\t            this.updateHighlighters();\n\t        }\n\n\t        if (this.hasFlag(flags, Flags$1.TOOLS)) {\n\t            this.updateTools(opt);\n\t            flags = this.removeFlag(flags, Flags$1.TOOLS);\n\t        }\n\n\t        return flags;\n\t    },\n\n\t    requestConnectionUpdate: function(opt) {\n\t        this.requestUpdate(this.getFlag(Flags$1.UPDATE), opt);\n\t    },\n\n\t    isLabelsRenderRequired: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        var previousLabels = this.model.previous('labels');\n\t        if (!previousLabels) { return true; }\n\n\t        // Here is an optimization for cases when we know, that change does\n\t        // not require re-rendering of all labels.\n\t        if (('propertyPathArray' in opt) && ('propertyValue' in opt)) {\n\t            // The label is setting by `prop()` method\n\t            var pathArray = opt.propertyPathArray || [];\n\t            var pathLength = pathArray.length;\n\t            if (pathLength > 1) {\n\t                // We are changing a single label here e.g. 'labels/0/position'\n\t                var labelExists = !!previousLabels[pathArray[1]];\n\t                if (labelExists) {\n\t                    if (pathLength === 2) {\n\t                        // We are changing the entire label. Need to check if the\n\t                        // markup is also being changed.\n\t                        return ('markup' in Object(opt.propertyValue));\n\t                    } else if (pathArray[2] !== 'markup') {\n\t                        // We are changing a label property but not the markup\n\t                        return false;\n\t                    }\n\t                }\n\t            }\n\t        }\n\n\t        return true;\n\t    },\n\n\t    onLabelsChange: function(_link, _labels, opt) {\n\n\t        // Note: this optimization works in async=false mode only\n\t        if (this.isLabelsRenderRequired(opt)) {\n\t            this.renderLabels();\n\t        } else {\n\t            this.updateLabels();\n\t        }\n\t    },\n\n\t    // Rendering.\n\t    // ----------\n\n\t    render: function() {\n\n\t        this.vel.empty();\n\t        this.unmountLabels();\n\t        this._V = {};\n\t        this.renderMarkup();\n\t        // rendering labels has to be run after the link is appended to DOM tree. (otherwise <Text> bbox\n\t        // returns zero values)\n\t        this.renderLabels();\n\t        this.update();\n\n\t        return this;\n\t    },\n\n\t    renderMarkup: function() {\n\n\t        var link = this.model;\n\t        var markup = link.get('markup') || link.markup;\n\t        if (!markup) { throw new Error('dia.LinkView: markup required'); }\n\t        if (Array.isArray(markup)) { return this.renderJSONMarkup(markup); }\n\t        if (typeof markup === 'string') { return this.renderStringMarkup(markup); }\n\t        throw new Error('dia.LinkView: invalid markup');\n\t    },\n\n\t    renderJSONMarkup: function(markup) {\n\n\t        var doc = this.parseDOMJSON(markup, this.el);\n\t        // Selectors\n\t        this.selectors = doc.selectors;\n\t        // Fragment\n\t        this.vel.append(doc.fragment);\n\t    },\n\n\t    renderStringMarkup: function(markup) {\n\n\t        // A special markup can be given in the `properties.markup` property. This might be handy\n\t        // if e.g. arrowhead markers should be `<image>` elements or any other element than `<path>`s.\n\t        // `.connection`, `.connection-wrap`, `.marker-source` and `.marker-target` selectors\n\t        // of elements with special meaning though. Therefore, those classes should be preserved in any\n\t        // special markup passed in `properties.markup`.\n\t        var children = V(markup);\n\t        // custom markup may contain only one children\n\t        if (!Array.isArray(children)) { children = [children]; }\n\t        // Cache all children elements for quicker access.\n\t        var cache = this._V; // vectorized markup;\n\t        for (var i = 0, n = children.length; i < n; i++) {\n\t            var child = children[i];\n\t            var className = child.attr('class');\n\t            if (className) {\n\t                // Strip the joint class name prefix, if there is one.\n\t                className = removeClassNamePrefix(className);\n\t                cache[$.camelCase(className)] = child;\n\t            }\n\t        }\n\t        // partial rendering\n\t        this.renderTools();\n\t        this.renderVertexMarkers();\n\t        this.renderArrowheadMarkers();\n\t        this.vel.append(children);\n\t    },\n\n\t    _getLabelMarkup: function(labelMarkup) {\n\n\t        if (!labelMarkup) { return undefined; }\n\n\t        if (Array.isArray(labelMarkup)) { return this.parseDOMJSON(labelMarkup, null); }\n\t        if (typeof labelMarkup === 'string') { return this._getLabelStringMarkup(labelMarkup); }\n\t        throw new Error('dia.linkView: invalid label markup');\n\t    },\n\n\t    _getLabelStringMarkup: function(labelMarkup) {\n\n\t        var children = V(labelMarkup);\n\t        var fragment = document.createDocumentFragment();\n\n\t        if (!Array.isArray(children)) {\n\t            fragment.appendChild(children.node);\n\n\t        } else {\n\t            for (var i = 0, n = children.length; i < n; i++) {\n\t                var currentChild = children[i].node;\n\t                fragment.appendChild(currentChild);\n\t            }\n\t        }\n\n\t        return { fragment: fragment, selectors: {}}; // no selectors\n\t    },\n\n\t    // Label markup fragment may come wrapped in <g class=\"label\" />, or not.\n\t    // If it doesn't, add the <g /> container here.\n\t    _normalizeLabelMarkup: function(markup) {\n\n\t        if (!markup) { return undefined; }\n\n\t        var fragment = markup.fragment;\n\t        if (!(markup.fragment instanceof DocumentFragment) || !markup.fragment.hasChildNodes()) { throw new Error('dia.LinkView: invalid label markup.'); }\n\n\t        var vNode;\n\t        var childNodes = fragment.childNodes;\n\n\t        if ((childNodes.length > 1) || childNodes[0].nodeName.toUpperCase() !== 'G') {\n\t            // default markup fragment is not wrapped in <g />\n\t            // add a <g /> container\n\t            vNode = V('g').append(fragment);\n\t        } else {\n\t            vNode = V(childNodes[0]);\n\t        }\n\n\t        vNode.addClass('label');\n\n\t        return { node: vNode.node, selectors: markup.selectors };\n\t    },\n\n\t    renderLabels: function() {\n\n\t        var cache = this._V;\n\t        var vLabels = cache.labels;\n\t        var labelCache = this._labelCache = {};\n\t        var labelSelectors = this._labelSelectors = {};\n\t        var model = this.model;\n\t        var labels = model.attributes.labels || [];\n\t        var labelsCount = labels.length;\n\n\t        if (labelsCount === 0) {\n\t            if (vLabels) { vLabels.remove(); }\n\t            return this;\n\t        }\n\n\t        if (vLabels) {\n\t            vLabels.empty();\n\t        }  else {\n\t            // there is no label container in the markup but some labels are defined\n\t            // add a <g class=\"labels\" /> container\n\t            vLabels = cache.labels = V('g').addClass('labels');\n\t            if (this.options.labelsLayer) {\n\t                vLabels.addClass(addClassNamePrefix(result(this, 'className')));\n\t                vLabels.attr('model-id', model.id);\n\t            }\n\t        }\n\n\t        for (var i = 0; i < labelsCount; i++) {\n\n\t            var label = labels[i];\n\t            var labelMarkup = this._normalizeLabelMarkup(this._getLabelMarkup(label.markup));\n\t            var labelNode;\n\t            var selectors;\n\t            if (labelMarkup) {\n\n\t                labelNode = labelMarkup.node;\n\t                selectors = labelMarkup.selectors;\n\n\t            } else {\n\n\t                var builtinDefaultLabel =  model._builtins.defaultLabel;\n\t                var builtinDefaultLabelMarkup = this._normalizeLabelMarkup(this._getLabelMarkup(builtinDefaultLabel.markup));\n\t                var defaultLabel = model._getDefaultLabel();\n\t                var defaultLabelMarkup = this._normalizeLabelMarkup(this._getLabelMarkup(defaultLabel.markup));\n\t                var defaultMarkup = defaultLabelMarkup || builtinDefaultLabelMarkup;\n\n\t                labelNode = defaultMarkup.node;\n\t                selectors = defaultMarkup.selectors;\n\t            }\n\n\t            labelNode.setAttribute('label-idx', i); // assign label-idx\n\t            vLabels.append(labelNode);\n\t            labelCache[i] = labelNode; // cache node for `updateLabels()` so it can just update label node positions\n\n\t            var rootSelector = this.selector;\n\t            if (selectors[rootSelector]) { throw new Error('dia.LinkView: ambiguous label root selector.'); }\n\t            selectors[rootSelector] = labelNode;\n\n\t            labelSelectors[i] = selectors; // cache label selectors for `updateLabels()`\n\t        }\n\t        if (!vLabels.parent()) {\n\t            this.mountLabels();\n\t        }\n\n\t        this.updateLabels();\n\n\t        return this;\n\t    },\n\n\t    mountLabels: function() {\n\t        var ref = this;\n\t        var el = ref.el;\n\t        var paper = ref.paper;\n\t        var model = ref.model;\n\t        var _V = ref._V;\n\t        var options = ref.options;\n\t        var vLabels = _V.labels;\n\t        if (!vLabels || !model.hasLabels()) { return; }\n\t        var node = vLabels.node;\n\t        if (options.labelsLayer) {\n\t            paper.getLayerView(options.labelsLayer).insertSortedNode(node, model.get('z'));\n\t        } else {\n\t            if (node.parentNode !== el) {\n\t                el.appendChild(node);\n\t            }\n\t        }\n\t    },\n\n\t    unmountLabels: function() {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var _V = ref._V;\n\t        if (!_V) { return; }\n\t        var vLabels = _V.labels;\n\t        if (vLabels && options.labelsLayer) {\n\t            vLabels.remove();\n\t        }\n\t    },\n\n\t    onMount: function() {\n\t        this.mountLabels();\n\t    },\n\n\t    unmount: function() {\n\t        CellView.prototype.unmount.apply(this, arguments);\n\t        this.unmountLabels();\n\t    },\n\n\t    findLabelNode: function(labelIndex, selector) {\n\t        var labelRoot = this._labelCache[labelIndex];\n\t        if (!labelRoot) { return null; }\n\t        var labelSelectors = this._labelSelectors[labelIndex];\n\t        var ref = this.findBySelector(selector, labelRoot, labelSelectors);\n\t        var node = ref[0]; if ( node === void 0 ) node = null;\n\t        return node;\n\t    },\n\n\n\t    // merge default label attrs into label attrs\n\t    // keep `undefined` or `null` because `{}` means something else\n\t    _mergeLabelAttrs: function(hasCustomMarkup, labelAttrs, defaultLabelAttrs, builtinDefaultLabelAttrs) {\n\n\t        if (labelAttrs === null) { return null; }\n\t        if (labelAttrs === undefined) {\n\n\t            if (defaultLabelAttrs === null) { return null; }\n\t            if (defaultLabelAttrs === undefined) {\n\n\t                if (hasCustomMarkup) { return undefined; }\n\t                return builtinDefaultLabelAttrs;\n\t            }\n\n\t            if (hasCustomMarkup) { return defaultLabelAttrs; }\n\t            return merge({}, builtinDefaultLabelAttrs, defaultLabelAttrs);\n\t        }\n\n\t        if (hasCustomMarkup) { return merge({}, defaultLabelAttrs, labelAttrs); }\n\t        return merge({}, builtinDefaultLabelAttrs, defaultLabelAttrs, labelAttrs);\n\t    },\n\n\t    updateLabels: function() {\n\n\t        if (!this._V.labels) { return this; }\n\n\t        var model = this.model;\n\t        var labels = model.get('labels') || [];\n\t        var canLabelMove = this.can('labelMove');\n\n\t        var builtinDefaultLabel = model._builtins.defaultLabel;\n\t        var builtinDefaultLabelAttrs = builtinDefaultLabel.attrs;\n\n\t        var defaultLabel = model._getDefaultLabel();\n\t        var defaultLabelMarkup = defaultLabel.markup;\n\t        var defaultLabelAttrs = defaultLabel.attrs;\n\n\t        for (var i = 0, n = labels.length; i < n; i++) {\n\n\t            var labelNode = this._labelCache[i];\n\t            labelNode.setAttribute('cursor', (canLabelMove ? 'move' : 'default'));\n\n\t            var selectors = this._labelSelectors[i];\n\n\t            var label = labels[i];\n\t            var labelMarkup = label.markup;\n\t            var labelAttrs = label.attrs;\n\n\t            var attrs = this._mergeLabelAttrs(\n\t                (labelMarkup || defaultLabelMarkup),\n\t                labelAttrs,\n\t                defaultLabelAttrs,\n\t                builtinDefaultLabelAttrs\n\t            );\n\n\t            this.updateDOMSubtreeAttributes(labelNode, attrs, {\n\t                rootBBox: new Rect(label.size),\n\t                selectors: selectors\n\t            });\n\t        }\n\n\t        return this;\n\t    },\n\n\t    renderTools: function() {\n\n\t        if (!this._V.linkTools) { return this; }\n\n\t        // Tools are a group of clickable elements that manipulate the whole link.\n\t        // A good example of this is the remove tool that removes the whole link.\n\t        // Tools appear after hovering the link close to the `source` element/point of the link\n\t        // but are offset a bit so that they don't cover the `marker-arrowhead`.\n\n\t        var $tools = $(this._V.linkTools.node).empty();\n\t        var toolTemplate = template(this.model.get('toolMarkup') || this.model.toolMarkup);\n\t        var tool = V(toolTemplate());\n\n\t        $tools.append(tool.node);\n\n\t        // Cache the tool node so that the `updateToolsPosition()` can update the tool position quickly.\n\t        this._toolCache = tool;\n\n\t        // If `doubleLinkTools` is enabled, we render copy of the tools on the other side of the\n\t        // link as well but only if the link is longer than `longLinkLength`.\n\t        if (this.options.doubleLinkTools) {\n\n\t            var tool2;\n\t            if (this.model.get('doubleToolMarkup') || this.model.doubleToolMarkup) {\n\t                toolTemplate = template(this.model.get('doubleToolMarkup') || this.model.doubleToolMarkup);\n\t                tool2 = V(toolTemplate());\n\t            } else {\n\t                tool2 = tool.clone();\n\t            }\n\n\t            $tools.append(tool2.node);\n\t            this._tool2Cache = tool2;\n\t        }\n\n\t        return this;\n\t    },\n\n\t    renderVertexMarkers: function() {\n\n\t        if (!this._V.markerVertices) { return this; }\n\n\t        var $markerVertices = $(this._V.markerVertices.node).empty();\n\n\t        // A special markup can be given in the `properties.vertexMarkup` property. This might be handy\n\t        // if default styling (elements) are not desired. This makes it possible to use any\n\t        // SVG elements for .marker-vertex and .marker-vertex-remove tools.\n\t        var markupTemplate = template(this.model.get('vertexMarkup') || this.model.vertexMarkup);\n\n\t        this.model.vertices().forEach(function(vertex, idx) {\n\t            $markerVertices.append(V(markupTemplate(assign({ idx: idx }, vertex))).node);\n\t        });\n\n\t        return this;\n\t    },\n\n\t    renderArrowheadMarkers: function() {\n\n\t        // Custom markups might not have arrowhead markers. Therefore, jump of this function immediately if that's the case.\n\t        if (!this._V.markerArrowheads) { return this; }\n\n\t        var $markerArrowheads = $(this._V.markerArrowheads.node);\n\n\t        $markerArrowheads.empty();\n\n\t        // A special markup can be given in the `properties.vertexMarkup` property. This might be handy\n\t        // if default styling (elements) are not desired. This makes it possible to use any\n\t        // SVG elements for .marker-vertex and .marker-vertex-remove tools.\n\t        var markupTemplate = template(this.model.get('arrowheadMarkup') || this.model.arrowheadMarkup);\n\n\t        this._V.sourceArrowhead = V(markupTemplate({ end: 'source' }));\n\t        this._V.targetArrowhead = V(markupTemplate({ end: 'target' }));\n\n\t        $markerArrowheads.append(this._V.sourceArrowhead.node, this._V.targetArrowhead.node);\n\n\t        return this;\n\t    },\n\n\t    // remove vertices that lie on (or nearly on) straight lines within the link\n\t    // return the number of removed points\n\t    removeRedundantLinearVertices: function(opt) {\n\n\t        var SIMPLIFY_THRESHOLD = 0.001;\n\n\t        var link = this.model;\n\t        var vertices = link.vertices();\n\t        var routePoints = [this.sourceAnchor ].concat( vertices, [this.targetAnchor]);\n\t        var numRoutePoints = routePoints.length;\n\n\t        // put routePoints into a polyline and try to simplify\n\t        var polyline = new Polyline(routePoints);\n\t        polyline.simplify({ threshold: SIMPLIFY_THRESHOLD });\n\t        var polylinePoints = polyline.points.map(function (point) { return (point.toJSON()); }); // JSON of points after simplification\n\t        var numPolylinePoints = polylinePoints.length; // number of points after simplification\n\n\t        // shortcut if simplification did not remove any redundant vertices:\n\t        if (numRoutePoints === numPolylinePoints) { return 0; }\n\n\t        // else: set simplified polyline points as link vertices\n\t        // remove first and last polyline points again (= source/target anchors)\n\t        link.vertices(polylinePoints.slice(1, numPolylinePoints - 1), opt);\n\t        return (numRoutePoints - numPolylinePoints);\n\t    },\n\n\t    updateDefaultConnectionPath: function() {\n\n\t        var cache = this._V;\n\n\t        if (cache.connection) {\n\t            cache.connection.attr('d', this.getSerializedConnection());\n\t        }\n\n\t        if (cache.connectionWrap) {\n\t            cache.connectionWrap.attr('d', this.getSerializedConnection());\n\t        }\n\n\t        if (cache.markerSource && cache.markerTarget) {\n\t            this._translateAndAutoOrientArrows(cache.markerSource, cache.markerTarget);\n\t        }\n\t    },\n\n\t    getEndView: function(type) {\n\t        switch (type) {\n\t            case 'source':\n\t                return this.sourceView || null;\n\t            case 'target':\n\t                return this.targetView || null;\n\t            default:\n\t                throw new Error('dia.LinkView: type parameter required.');\n\t        }\n\t    },\n\n\t    getEndAnchor: function(type) {\n\t        switch (type) {\n\t            case 'source':\n\t                return new Point(this.sourceAnchor);\n\t            case 'target':\n\t                return new Point(this.targetAnchor);\n\t            default:\n\t                throw new Error('dia.LinkView: type parameter required.');\n\t        }\n\t    },\n\n\t    getEndConnectionPoint: function(type) {\n\t        switch (type) {\n\t            case 'source':\n\t                return new Point(this.sourcePoint);\n\t            case 'target':\n\t                return new Point(this.targetPoint);\n\t            default:\n\t                throw new Error('dia.LinkView: type parameter required.');\n\t        }\n\t    },\n\n\t    getEndMagnet: function(type) {\n\t        switch (type) {\n\t            case 'source':\n\t                var sourceView = this.sourceView;\n\t                if (!sourceView) { break; }\n\t                return this.sourceMagnet || sourceView.el;\n\t            case 'target':\n\t                var targetView = this.targetView;\n\t                if (!targetView) { break; }\n\t                return this.targetMagnet || targetView.el;\n\t            default:\n\t                throw new Error('dia.LinkView: type parameter required.');\n\t        }\n\t        return null;\n\t    },\n\n\n\t    // Updating.\n\t    // ---------\n\n\t    update: function() {\n\t        this.updateRoute();\n\t        this.updatePath();\n\t        this.updateDOM();\n\t        return this;\n\t    },\n\n\t    translate: function(tx, ty) {\n\t        if ( tx === void 0 ) tx = 0;\n\t        if ( ty === void 0 ) ty = 0;\n\n\t        var ref = this;\n\t        var route = ref.route;\n\t        var path = ref.path;\n\t        if (!route || !path) { return; }\n\t        // translate the route\n\t        var polyline = new Polyline(route);\n\t        polyline.translate(tx, ty);\n\t        this.route = polyline.points;\n\t        // translate source and target connection and marker points.\n\t        this._translateConnectionPoints(tx, ty);\n\t        // translate the geometry path\n\t        path.translate(tx, ty);\n\t        this.updateDOM();\n\t    },\n\n\t    updateDOM: function updateDOM() {\n\t        var ref = this;\n\t        var el = ref.el;\n\t        var model = ref.model;\n\t        var selectors = ref.selectors;\n\t        this.cleanNodesCache();\n\t        // update SVG attributes defined by 'attrs/'.\n\t        this.updateDOMSubtreeAttributes(el, model.attr(), { selectors: selectors });\n\t        // legacy link path update\n\t        this.updateDefaultConnectionPath();\n\t        // update the label position etc.\n\t        this.updateLabelPositions();\n\t        this.updateToolsPosition();\n\t        this.updateArrowheadMarkers();\n\t        // *Deprecated*\n\t        // Local perpendicular flag (as opposed to one defined on paper).\n\t        // Could be enabled inside a connector/router. It's valid only\n\t        // during the update execution.\n\t        this.options.perpendicular = null;\n\t    },\n\n\t    updateRoute: function() {\n\t        var ref = this;\n\t        var model = ref.model;\n\t        var vertices = model.vertices();\n\t        // 1. Find Anchors\n\t        var anchors = this.findAnchors(vertices);\n\t        var sourceAnchor = this.sourceAnchor = anchors.source;\n\t        var targetAnchor = this.targetAnchor = anchors.target;\n\t        // 2. Find Route\n\t        var route = this.findRoute(vertices);\n\t        this.route = route;\n\t        // 3. Find Connection Points\n\t        var connectionPoints = this.findConnectionPoints(route, sourceAnchor, targetAnchor);\n\t        this.sourcePoint = connectionPoints.source;\n\t        this.targetPoint = connectionPoints.target;\n\t    },\n\n\t    updatePath: function() {\n\t        var ref = this;\n\t        var route = ref.route;\n\t        var sourcePoint = ref.sourcePoint;\n\t        var targetPoint = ref.targetPoint;\n\t        // 3b. Find Marker Connection Point - Backwards Compatibility\n\t        var markerPoints = this.findMarkerPoints(route, sourcePoint, targetPoint);\n\t        // 4. Find Connection\n\t        var path = this.findPath(route, markerPoints.source || sourcePoint, markerPoints.target || targetPoint);\n\t        this.path = path;\n\t    },\n\n\t    findMarkerPoints: function(route, sourcePoint, targetPoint) {\n\n\t        var firstWaypoint = route[0];\n\t        var lastWaypoint = route[route.length - 1];\n\n\t        // Move the source point by the width of the marker taking into account\n\t        // its scale around x-axis. Note that scale is the only transform that\n\t        // makes sense to be set in `.marker-source` attributes object\n\t        // as all other transforms (translate/rotate) will be replaced\n\t        // by the `translateAndAutoOrient()` function.\n\t        var cache = this._markerCache;\n\t        // cache source and target points\n\t        var sourceMarkerPoint, targetMarkerPoint;\n\n\t        if (this._V.markerSource) {\n\n\t            cache.sourceBBox = cache.sourceBBox || this._V.markerSource.getBBox();\n\t            sourceMarkerPoint = Point(sourcePoint).move(\n\t                firstWaypoint || targetPoint,\n\t                cache.sourceBBox.width * this._V.markerSource.scale().sx * -1\n\t            ).round();\n\t        }\n\n\t        if (this._V.markerTarget) {\n\n\t            cache.targetBBox = cache.targetBBox || this._V.markerTarget.getBBox();\n\t            targetMarkerPoint = Point(targetPoint).move(\n\t                lastWaypoint || sourcePoint,\n\t                cache.targetBBox.width * this._V.markerTarget.scale().sx * -1\n\t            ).round();\n\t        }\n\n\t        // if there was no markup for the marker, use the connection point.\n\t        cache.sourcePoint = sourceMarkerPoint || sourcePoint.clone();\n\t        cache.targetPoint = targetMarkerPoint || targetPoint.clone();\n\n\t        return {\n\t            source: sourceMarkerPoint,\n\t            target: targetMarkerPoint\n\t        };\n\t    },\n\n\t    findAnchorsOrdered: function(firstEndType, firstRef, secondEndType, secondRef) {\n\n\t        var firstAnchor, secondAnchor;\n\t        var firstAnchorRef, secondAnchorRef;\n\t        var model = this.model;\n\t        var firstDef = model.get(firstEndType);\n\t        var secondDef = model.get(secondEndType);\n\t        var firstView = this.getEndView(firstEndType);\n\t        var secondView = this.getEndView(secondEndType);\n\t        var firstMagnet = this.getEndMagnet(firstEndType);\n\t        var secondMagnet = this.getEndMagnet(secondEndType);\n\n\t        // Anchor first\n\t        if (firstView) {\n\t            if (firstRef) {\n\t                firstAnchorRef = new Point(firstRef);\n\t            } else if (secondView) {\n\t                firstAnchorRef = secondMagnet;\n\t            } else {\n\t                firstAnchorRef = new Point(secondDef);\n\t            }\n\t            firstAnchor = this.getAnchor(firstDef.anchor, firstView, firstMagnet, firstAnchorRef, firstEndType);\n\t        } else {\n\t            firstAnchor = new Point(firstDef);\n\t        }\n\n\t        // Anchor second\n\t        if (secondView) {\n\t            secondAnchorRef = new Point(secondRef || firstAnchor);\n\t            secondAnchor = this.getAnchor(secondDef.anchor, secondView, secondMagnet, secondAnchorRef, secondEndType);\n\t        } else {\n\t            secondAnchor = new Point(secondDef);\n\t        }\n\n\t        var res = {};\n\t        res[firstEndType] = firstAnchor;\n\t        res[secondEndType] = secondAnchor;\n\t        return res;\n\t    },\n\n\t    findAnchors: function(vertices) {\n\n\t        var model = this.model;\n\t        var firstVertex = vertices[0];\n\t        var lastVertex = vertices[vertices.length - 1];\n\n\t        if (model.target().priority && !model.source().priority) {\n\t            // Reversed order\n\t            return this.findAnchorsOrdered('target', lastVertex, 'source', firstVertex);\n\t        }\n\n\t        // Usual order\n\t        return this.findAnchorsOrdered('source', firstVertex, 'target', lastVertex);\n\t    },\n\n\t    findConnectionPoints: function(route, sourceAnchor, targetAnchor) {\n\n\t        var firstWaypoint = route[0];\n\t        var lastWaypoint = route[route.length - 1];\n\t        var model = this.model;\n\t        var sourceDef = model.get('source');\n\t        var targetDef = model.get('target');\n\t        var sourceView = this.sourceView;\n\t        var targetView = this.targetView;\n\t        var paperOptions = this.paper.options;\n\t        var sourceMagnet, targetMagnet;\n\n\t        // Connection Point Source\n\t        var sourcePoint;\n\t        if (sourceView && !sourceView.isNodeConnection(this.sourceMagnet)) {\n\t            sourceMagnet = (this.sourceMagnet || sourceView.el);\n\t            var sourceConnectionPointDef = sourceDef.connectionPoint || paperOptions.defaultConnectionPoint;\n\t            var sourcePointRef = firstWaypoint || targetAnchor;\n\t            var sourceLine = new Line(sourcePointRef, sourceAnchor);\n\t            sourcePoint = this.getConnectionPoint(\n\t                sourceConnectionPointDef,\n\t                sourceView,\n\t                sourceMagnet,\n\t                sourceLine,\n\t                'source'\n\t            );\n\t        } else {\n\t            sourcePoint = sourceAnchor;\n\t        }\n\t        // Connection Point Target\n\t        var targetPoint;\n\t        if (targetView && !targetView.isNodeConnection(this.targetMagnet)) {\n\t            targetMagnet = (this.targetMagnet || targetView.el);\n\t            var targetConnectionPointDef = targetDef.connectionPoint || paperOptions.defaultConnectionPoint;\n\t            var targetPointRef = lastWaypoint || sourceAnchor;\n\t            var targetLine = new Line(targetPointRef, targetAnchor);\n\t            targetPoint = this.getConnectionPoint(\n\t                targetConnectionPointDef,\n\t                targetView,\n\t                targetMagnet,\n\t                targetLine,\n\t                'target'\n\t            );\n\t        } else {\n\t            targetPoint = targetAnchor;\n\t        }\n\n\t        return {\n\t            source: sourcePoint,\n\t            target: targetPoint\n\t        };\n\t    },\n\n\t    getAnchor: function(anchorDef, cellView, magnet, ref, endType) {\n\n\t        var isConnection = cellView.isNodeConnection(magnet);\n\t        var paperOptions = this.paper.options;\n\t        if (!anchorDef) {\n\t            if (isConnection) {\n\t                anchorDef = paperOptions.defaultLinkAnchor;\n\t            } else {\n\t                if (paperOptions.perpendicularLinks || this.options.perpendicular) {\n\t                    // Backwards compatibility\n\t                    // If `perpendicularLinks` flag is set on the paper and there are vertices\n\t                    // on the link, then try to find a connection point that makes the link perpendicular\n\t                    // even though the link won't point to the center of the targeted object.\n\t                    anchorDef = { name: 'perpendicular' };\n\t                } else {\n\t                    anchorDef = paperOptions.defaultAnchor;\n\t                }\n\t            }\n\t        }\n\n\t        if (!anchorDef) { throw new Error('Anchor required.'); }\n\t        var anchorFn;\n\t        if (typeof anchorDef === 'function') {\n\t            anchorFn = anchorDef;\n\t        } else {\n\t            var anchorName = anchorDef.name;\n\t            var anchorNamespace = isConnection ? 'linkAnchorNamespace' : 'anchorNamespace';\n\t            anchorFn = paperOptions[anchorNamespace][anchorName];\n\t            if (typeof anchorFn !== 'function') { throw new Error('Unknown anchor: ' + anchorName); }\n\t        }\n\t        var anchor = anchorFn.call(\n\t            this,\n\t            cellView,\n\t            magnet,\n\t            ref,\n\t            anchorDef.args || {},\n\t            endType,\n\t            this\n\t        );\n\t        if (!anchor) { return new Point(); }\n\t        return anchor.round(this.decimalsRounding);\n\t    },\n\n\n\t    getConnectionPoint: function(connectionPointDef, view, magnet, line, endType) {\n\n\t        var connectionPoint;\n\t        var anchor = line.end;\n\t        var paperOptions = this.paper.options;\n\n\t        // Backwards compatibility\n\t        if (typeof paperOptions.linkConnectionPoint === 'function') {\n\t            var linkConnectionMagnet = (magnet === view.el) ? undefined : magnet;\n\t            connectionPoint = paperOptions.linkConnectionPoint(this, view, linkConnectionMagnet, line.start, endType);\n\t            if (connectionPoint) { return connectionPoint; }\n\t        }\n\n\t        if (!connectionPointDef) { return anchor; }\n\t        var connectionPointFn;\n\t        if (typeof connectionPointDef === 'function') {\n\t            connectionPointFn = connectionPointDef;\n\t        } else {\n\t            var connectionPointName = connectionPointDef.name;\n\t            connectionPointFn = paperOptions.connectionPointNamespace[connectionPointName];\n\t            if (typeof connectionPointFn !== 'function') { throw new Error('Unknown connection point: ' + connectionPointName); }\n\t        }\n\t        connectionPoint = connectionPointFn.call(this, line, view, magnet, connectionPointDef.args || {}, endType, this);\n\t        if (!connectionPoint) { return anchor; }\n\t        return connectionPoint.round(this.decimalsRounding);\n\t    },\n\n\t    _translateConnectionPoints: function(tx, ty) {\n\n\t        var cache = this._markerCache;\n\n\t        cache.sourcePoint.offset(tx, ty);\n\t        cache.targetPoint.offset(tx, ty);\n\t        this.sourcePoint.offset(tx, ty);\n\t        this.targetPoint.offset(tx, ty);\n\t        this.sourceAnchor.offset(tx, ty);\n\t        this.targetAnchor.offset(tx, ty);\n\t    },\n\n\t    // if label position is a number, normalize it to a position object\n\t    // this makes sure that label positions can be merged properly\n\t    _normalizeLabelPosition: function(labelPosition) {\n\n\t        if (typeof labelPosition === 'number') { return { distance: labelPosition, offset: null, angle: 0, args: null }; }\n\t        return labelPosition;\n\t    },\n\n\t    updateLabelPositions: function() {\n\n\t        if (!this._V.labels) { return this; }\n\n\t        var path = this.path;\n\t        if (!path) { return this; }\n\n\t        // This method assumes all the label nodes are stored in the `this._labelCache` hash table\n\t        // by their indices in the `this.get('labels')` array. This is done in the `renderLabels()` method.\n\n\t        var model = this.model;\n\t        var labels = model.get('labels') || [];\n\t        if (!labels.length) { return this; }\n\n\t        var builtinDefaultLabel = model._builtins.defaultLabel;\n\t        var builtinDefaultLabelPosition = builtinDefaultLabel.position;\n\n\t        var defaultLabel = model._getDefaultLabel();\n\t        var defaultLabelPosition = this._normalizeLabelPosition(defaultLabel.position);\n\n\t        var defaultPosition = merge({}, builtinDefaultLabelPosition, defaultLabelPosition);\n\n\t        for (var idx = 0, n = labels.length; idx < n; idx++) {\n\t            var labelNode = this._labelCache[idx];\n\t            if (!labelNode) { continue; }\n\t            var label = labels[idx];\n\t            var labelPosition = this._normalizeLabelPosition(label.position);\n\t            var position = merge({}, defaultPosition, labelPosition);\n\t            var transformationMatrix = this._getLabelTransformationMatrix(position);\n\t            labelNode.setAttribute('transform', V.matrixToTransformString(transformationMatrix));\n\t            this._cleanLabelMatrices(idx);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    _cleanLabelMatrices: function(index) {\n\t        // Clean magnetMatrix for all nodes of the label.\n\t        // Cached BoundingRect does not need to updated when the position changes\n\t        // TODO: this doesn't work for labels with XML String markups.\n\t        var ref = this;\n\t        var metrics = ref.metrics;\n\t        var _labelSelectors = ref._labelSelectors;\n\t        var selectors = _labelSelectors[index];\n\t        if (!selectors) { return; }\n\t        for (var selector in selectors) {\n\t            var ref$1 = selectors[selector];\n\t            var id = ref$1.id;\n\t            if (id && (id in metrics)) { delete metrics[id].magnetMatrix; }\n\t        }\n\t    },\n\n\t    updateToolsPosition: function() {\n\n\t        if (!this._V.linkTools) { return this; }\n\n\t        // Move the tools a bit to the target position but don't cover the `sourceArrowhead` marker.\n\t        // Note that the offset is hardcoded here. The offset should be always\n\t        // more than the `this.$('.marker-arrowhead[end=\"source\"]')[0].bbox().width` but looking\n\t        // this up all the time would be slow.\n\n\t        var scale = '';\n\t        var offset = this.options.linkToolsOffset;\n\t        var connectionLength = this.getConnectionLength();\n\n\t        // Firefox returns connectionLength=NaN in odd cases (for bezier curves).\n\t        // In that case we won't update tools position at all.\n\t        if (!Number.isNaN(connectionLength)) {\n\n\t            // If the link is too short, make the tools half the size and the offset twice as low.\n\t            if (connectionLength < this.options.shortLinkLength) {\n\t                scale = 'scale(.5)';\n\t                offset /= 2;\n\t            }\n\n\t            var toolPosition = this.getPointAtLength(offset);\n\n\t            this._toolCache.attr('transform', 'translate(' + toolPosition.x + ', ' + toolPosition.y + ') ' + scale);\n\n\t            if (this.options.doubleLinkTools && connectionLength >= this.options.longLinkLength) {\n\n\t                var doubleLinkToolsOffset = this.options.doubleLinkToolsOffset || offset;\n\n\t                toolPosition = this.getPointAtLength(connectionLength - doubleLinkToolsOffset);\n\t                this._tool2Cache.attr('transform', 'translate(' + toolPosition.x + ', ' + toolPosition.y + ') ' + scale);\n\t                this._tool2Cache.attr('visibility', 'visible');\n\n\t            } else if (this.options.doubleLinkTools) {\n\n\t                this._tool2Cache.attr('visibility', 'hidden');\n\t            }\n\t        }\n\n\t        return this;\n\t    },\n\n\t    updateArrowheadMarkers: function() {\n\n\t        if (!this._V.markerArrowheads) { return this; }\n\n\t        // getting bbox of an element with `display=\"none\"` in IE9 ends up with access violation\n\t        if ($.css(this._V.markerArrowheads.node, 'display') === 'none') { return this; }\n\n\t        var sx = this.getConnectionLength() < this.options.shortLinkLength ? .5 : 1;\n\t        this._V.sourceArrowhead.scale(sx);\n\t        this._V.targetArrowhead.scale(sx);\n\n\t        this._translateAndAutoOrientArrows(this._V.sourceArrowhead, this._V.targetArrowhead);\n\n\t        return this;\n\t    },\n\n\t    updateEndProperties: function(endType) {\n\n\t        var ref = this;\n\t        var model = ref.model;\n\t        var paper = ref.paper;\n\t        var endViewProperty = endType + \"View\";\n\t        var endDef = model.get(endType);\n\t        var endId = endDef && endDef.id;\n\n\t        if (!endId) {\n\t            // the link end is a point ~ rect 0x0\n\t            this[endViewProperty] = null;\n\t            this.updateEndMagnet(endType);\n\t            return true;\n\t        }\n\n\t        var endModel = paper.getModelById(endId);\n\t        if (!endModel) { throw new Error('LinkView: invalid ' + endType + ' cell.'); }\n\n\t        var endView = endModel.findView(paper);\n\t        if (!endView) {\n\t            // A view for a model should always exist\n\t            return false;\n\t        }\n\n\t        this[endViewProperty] = endView;\n\t        this.updateEndMagnet(endType);\n\t        return true;\n\t    },\n\n\t    updateEndMagnet: function(endType) {\n\n\t        var endMagnetProperty = endType + \"Magnet\";\n\t        var endView = this.getEndView(endType);\n\t        if (endView) {\n\t            var connectedMagnet = endView.getMagnetFromLinkEnd(this.model.get(endType));\n\t            if (connectedMagnet === endView.el) { connectedMagnet = null; }\n\t            this[endMagnetProperty] = connectedMagnet;\n\t        } else {\n\t            this[endMagnetProperty] = null;\n\t        }\n\t    },\n\n\t    _translateAndAutoOrientArrows: function(sourceArrow, targetArrow) {\n\n\t        // Make the markers \"point\" to their sticky points being auto-oriented towards\n\t        // `targetPosition`/`sourcePosition`. And do so only if there is a markup for them.\n\t        var route = toArray(this.route);\n\t        if (sourceArrow) {\n\t            sourceArrow.translateAndAutoOrient(\n\t                this.sourcePoint,\n\t                route[0] || this.targetPoint,\n\t                this.paper.cells\n\t            );\n\t        }\n\n\t        if (targetArrow) {\n\t            targetArrow.translateAndAutoOrient(\n\t                this.targetPoint,\n\t                route[route.length - 1] || this.sourcePoint,\n\t                this.paper.cells\n\t            );\n\t        }\n\t    },\n\n\t    _getLabelPositionAngle: function(idx) {\n\n\t        var labelPosition = this.model.label(idx).position || {};\n\t        return (labelPosition.angle || 0);\n\t    },\n\n\t    _getLabelPositionArgs: function(idx) {\n\n\t        var labelPosition = this.model.label(idx).position || {};\n\t        return labelPosition.args;\n\t    },\n\n\t    _getDefaultLabelPositionArgs: function() {\n\n\t        var defaultLabel = this.model._getDefaultLabel();\n\t        var defaultLabelPosition = defaultLabel.position || {};\n\t        return defaultLabelPosition.args;\n\t    },\n\n\t    // merge default label position args into label position args\n\t    // keep `undefined` or `null` because `{}` means something else\n\t    _mergeLabelPositionArgs: function(labelPositionArgs, defaultLabelPositionArgs) {\n\n\t        if (labelPositionArgs === null) { return null; }\n\t        if (labelPositionArgs === undefined) {\n\n\t            if (defaultLabelPositionArgs === null) { return null; }\n\t            return defaultLabelPositionArgs;\n\t        }\n\n\t        return merge({}, defaultLabelPositionArgs, labelPositionArgs);\n\t    },\n\n\t    // Add default label at given position at end of `labels` array.\n\t    // Four signatures:\n\t    // - obj, obj = point, opt\n\t    // - obj, num, obj = point, angle, opt\n\t    // - num, num, obj = x, y, opt\n\t    // - num, num, num, obj = x, y, angle, opt\n\t    // Assigns relative coordinates by default:\n\t    // `opt.absoluteDistance` forces absolute coordinates.\n\t    // `opt.reverseDistance` forces reverse absolute coordinates (if absoluteDistance = true).\n\t    // `opt.absoluteOffset` forces absolute coordinates for offset.\n\t    // Additional args:\n\t    // `opt.keepGradient` auto-adjusts the angle of the label to match path gradient at position.\n\t    // `opt.ensureLegibility` rotates labels so they are never upside-down.\n\t    addLabel: function(p1, p2, p3, p4) {\n\n\t        // normalize data from the four possible signatures\n\t        var localX;\n\t        var localY;\n\t        var localAngle = 0;\n\t        var localOpt;\n\t        if (typeof p1 !== 'number') {\n\t            // {x, y} object provided as first parameter\n\t            localX = p1.x;\n\t            localY = p1.y;\n\t            if (typeof p2 === 'number') {\n\t                // angle and opt provided as second and third parameters\n\t                localAngle = p2;\n\t                localOpt = p3;\n\t            } else {\n\t                // opt provided as second parameter\n\t                localOpt = p2;\n\t            }\n\t        } else {\n\t            // x and y provided as first and second parameters\n\t            localX = p1;\n\t            localY = p2;\n\t            if (typeof p3 === 'number') {\n\t                // angle and opt provided as third and fourth parameters\n\t                localAngle = p3;\n\t                localOpt = p4;\n\t            } else {\n\t                // opt provided as third parameter\n\t                localOpt = p3;\n\t            }\n\t        }\n\n\t        // merge label position arguments\n\t        var defaultLabelPositionArgs = this._getDefaultLabelPositionArgs();\n\t        var labelPositionArgs = localOpt;\n\t        var positionArgs = this._mergeLabelPositionArgs(labelPositionArgs, defaultLabelPositionArgs);\n\n\t        // append label to labels array\n\t        var label = { position: this.getLabelPosition(localX, localY, localAngle, positionArgs) };\n\t        var idx = -1;\n\t        this.model.insertLabel(idx, label, localOpt);\n\t        return idx;\n\t    },\n\n\t    // Add a new vertex at calculated index to the `vertices` array.\n\t    addVertex: function(x, y, opt) {\n\n\t        // accept input in form `{ x, y }, opt` or `x, y, opt`\n\t        var isPointProvided = (typeof x !== 'number');\n\t        var localX = isPointProvided ? x.x : x;\n\t        var localY = isPointProvided ? x.y : y;\n\t        var localOpt = isPointProvided ? y : opt;\n\n\t        var vertex = { x: localX, y: localY };\n\t        var idx = this.getVertexIndex(localX, localY);\n\t        this.model.insertVertex(idx, vertex, localOpt);\n\t        return idx;\n\t    },\n\n\t    // Send a token (an SVG element, usually a circle) along the connection path.\n\t    // Example: `link.findView(paper).sendToken(V('circle', { r: 7, fill: 'green' }).node)`\n\t    // `opt.duration` is optional and is a time in milliseconds that the token travels from the source to the target of the link. Default is `1000`.\n\t    // `opt.directon` is optional and it determines whether the token goes from source to target or other way round (`reverse`)\n\t    // `opt.connection` is an optional selector to the connection path.\n\t    // `callback` is optional and is a function to be called once the token reaches the target.\n\t    sendToken: function(token, opt, callback) {\n\n\t        function onAnimationEnd(vToken, callback) {\n\t            return function() {\n\t                vToken.remove();\n\t                if (typeof callback === 'function') {\n\t                    callback();\n\t                }\n\t            };\n\t        }\n\n\t        var duration, isReversed, selector;\n\t        if (isObject$1(opt)) {\n\t            duration = opt.duration;\n\t            isReversed = (opt.direction === 'reverse');\n\t            selector = opt.connection;\n\t        } else {\n\t            // Backwards compatibility\n\t            duration = opt;\n\t            isReversed = false;\n\t            selector = null;\n\t        }\n\n\t        duration = duration || 1000;\n\n\t        var animationAttributes = {\n\t            dur: duration + 'ms',\n\t            repeatCount: 1,\n\t            calcMode: 'linear',\n\t            fill: 'freeze'\n\t        };\n\n\t        if (isReversed) {\n\t            animationAttributes.keyPoints = '1;0';\n\t            animationAttributes.keyTimes = '0;1';\n\t        }\n\n\t        var vToken = V(token);\n\t        var connection;\n\t        if (typeof selector === 'string') {\n\t            // Use custom connection path.\n\t            connection = this.findBySelector(selector, this.el, this.selectors)[0];\n\t        } else {\n\t            // Select connection path automatically.\n\t            var cache = this._V;\n\t            connection = (cache.connection) ? cache.connection.node : this.el.querySelector('path');\n\t        }\n\n\t        if (!(connection instanceof SVGPathElement)) {\n\t            throw new Error('dia.LinkView: token animation requires a valid connection path.');\n\t        }\n\n\t        vToken\n\t            .appendTo(this.paper.cells)\n\t            .animateAlongPath(animationAttributes, connection);\n\n\t        setTimeout(onAnimationEnd(vToken, callback), duration);\n\t    },\n\n\t    findRoute: function(vertices) {\n\n\t        vertices || (vertices = []);\n\n\t        var namespace = this.paper.options.routerNamespace || routers;\n\t        var router = this.model.router();\n\t        var defaultRouter = this.paper.options.defaultRouter;\n\n\t        if (!router) {\n\t            if (defaultRouter) { router = defaultRouter; }\n\t            else { return vertices.map(Point); } // no router specified\n\t        }\n\n\t        var routerFn = isFunction(router) ? router : namespace[router.name];\n\t        if (!isFunction(routerFn)) {\n\t            throw new Error('dia.LinkView: unknown router: \"' + router.name + '\".');\n\t        }\n\n\t        var args = router.args || {};\n\n\t        var route = routerFn.call(\n\t            this, // context\n\t            vertices, // vertices\n\t            args, // options\n\t            this // linkView\n\t        );\n\n\t        if (!route) { return vertices.map(Point); }\n\t        return route;\n\t    },\n\n\t    // Return the `d` attribute value of the `<path>` element representing the link\n\t    // between `source` and `target`.\n\t    findPath: function(route, sourcePoint, targetPoint) {\n\n\t        var namespace = this.paper.options.connectorNamespace || connectors;\n\t        var connector = this.model.connector();\n\t        var defaultConnector = this.paper.options.defaultConnector;\n\n\t        if (!connector) {\n\t            connector = defaultConnector || {};\n\t        }\n\n\t        var connectorFn = isFunction(connector) ? connector : namespace[connector.name];\n\t        if (!isFunction(connectorFn)) {\n\t            throw new Error('dia.LinkView: unknown connector: \"' + connector.name + '\".');\n\t        }\n\n\t        var args = clone(connector.args || {});\n\t        args.raw = true; // Request raw g.Path as the result.\n\n\t        var path = connectorFn.call(\n\t            this, // context\n\t            sourcePoint, // start point\n\t            targetPoint, // end point\n\t            route, // vertices\n\t            args, // options\n\t            this // linkView\n\t        );\n\n\t        if (typeof path === 'string') {\n\t            // Backwards compatibility for connectors not supporting `raw` option.\n\t            path = new Path(V.normalizePathData(path));\n\t        }\n\n\t        return path;\n\t    },\n\n\t    // Public API.\n\t    // -----------\n\n\t    getConnection: function() {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.clone();\n\t    },\n\n\t    getSerializedConnection: function() {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        var metrics = this.metrics;\n\t        if (metrics.hasOwnProperty('data')) { return metrics.data; }\n\t        var data = path.serialize();\n\t        metrics.data = data;\n\t        return data;\n\t    },\n\n\t    getConnectionSubdivisions: function() {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        var metrics = this.metrics;\n\t        if (metrics.hasOwnProperty('segmentSubdivisions')) { return metrics.segmentSubdivisions; }\n\t        var subdivisions = path.getSegmentSubdivisions();\n\t        metrics.segmentSubdivisions = subdivisions;\n\t        return subdivisions;\n\t    },\n\n\t    getConnectionLength: function() {\n\n\t        var path = this.path;\n\t        if (!path) { return 0; }\n\n\t        var metrics = this.metrics;\n\t        if (metrics.hasOwnProperty('length')) { return metrics.length; }\n\t        var length = path.length({ segmentSubdivisions: this.getConnectionSubdivisions() });\n\t        metrics.length = length;\n\t        return length;\n\t    },\n\n\t    getPointAtLength: function(length) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.pointAtLength(length, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    getPointAtRatio: function(ratio) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\t        if (isPercentage(ratio)) { ratio = parseFloat(ratio) / 100; }\n\t        return path.pointAt(ratio, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    getTangentAtLength: function(length) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.tangentAtLength(length, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    getTangentAtRatio: function(ratio) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.tangentAt(ratio, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    getClosestPoint: function(point) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.closestPoint(point, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    getClosestPointLength: function(point) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.closestPointLength(point, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    getClosestPointRatio: function(point) {\n\n\t        var path = this.path;\n\t        if (!path) { return null; }\n\n\t        return path.closestPointNormalizedLength(point, { segmentSubdivisions: this.getConnectionSubdivisions() });\n\t    },\n\n\t    // Get label position object based on two provided coordinates, x and y.\n\t    // (Used behind the scenes when user moves labels around.)\n\t    // Two signatures:\n\t    // - num, num, obj = x, y, options\n\t    // - num, num, num, obj = x, y, angle, options\n\t    // Accepts distance/offset options = `absoluteDistance: boolean`, `reverseDistance: boolean`, `absoluteOffset: boolean`\n\t    // - `absoluteOffset` is necessary in order to move beyond connection endpoints\n\t    // Additional options = `keepGradient: boolean`, `ensureLegibility: boolean`\n\t    getLabelPosition: function(x, y, p3, p4) {\n\n\t        var position = {};\n\n\t        // normalize data from the two possible signatures\n\t        var localAngle = 0;\n\t        var localOpt;\n\t        if (typeof p3 === 'number') {\n\t            // angle and opt provided as third and fourth argument\n\t            localAngle = p3;\n\t            localOpt = p4;\n\t        } else {\n\t            // opt provided as third argument\n\t            localOpt = p3;\n\t        }\n\n\t        // save localOpt as `args` of the position object that is passed along\n\t        if (localOpt) { position.args = localOpt; }\n\n\t        // identify distance/offset settings\n\t        var isDistanceRelative = !(localOpt && localOpt.absoluteDistance); // relative by default\n\t        var isDistanceAbsoluteReverse = (localOpt && localOpt.absoluteDistance && localOpt.reverseDistance); // non-reverse by default\n\t        var isOffsetAbsolute = localOpt && localOpt.absoluteOffset; // offset is non-absolute by default\n\n\t        // find closest point t\n\t        var path = this.path;\n\t        var pathOpt = { segmentSubdivisions: this.getConnectionSubdivisions() };\n\t        var labelPoint = new Point(x, y);\n\t        var t = path.closestPointT(labelPoint, pathOpt);\n\n\t        // DISTANCE:\n\t        var labelDistance = path.lengthAtT(t, pathOpt);\n\t        if (isDistanceRelative) { labelDistance = (labelDistance / this.getConnectionLength()) || 0; } // fix to prevent NaN for 0 length\n\t        if (isDistanceAbsoluteReverse) { labelDistance = (-1 * (this.getConnectionLength() - labelDistance)) || 1; } // fix for end point (-0 => 1)\n\t        position.distance = labelDistance;\n\n\t        // OFFSET:\n\t        // use absolute offset if:\n\t        // - opt.absoluteOffset is true,\n\t        // - opt.absoluteOffset is not true but there is no tangent\n\t        var tangent;\n\t        if (!isOffsetAbsolute) { tangent = path.tangentAtT(t); }\n\t        var labelOffset;\n\t        if (tangent) {\n\t            labelOffset = tangent.pointOffset(labelPoint);\n\t        } else {\n\t            var closestPoint = path.pointAtT(t);\n\t            var labelOffsetDiff = labelPoint.difference(closestPoint);\n\t            labelOffset = { x: labelOffsetDiff.x, y: labelOffsetDiff.y };\n\t        }\n\t        position.offset = labelOffset;\n\n\t        // ANGLE:\n\t        position.angle = localAngle;\n\n\t        return position;\n\t    },\n\n\t    _getLabelTransformationMatrix: function(labelPosition) {\n\n\t        var labelDistance;\n\t        var labelAngle = 0;\n\t        var args = {};\n\t        if (typeof labelPosition === 'number') {\n\t            labelDistance = labelPosition;\n\t        } else if (typeof labelPosition.distance === 'number') {\n\t            args = labelPosition.args || {};\n\t            labelDistance = labelPosition.distance;\n\t            labelAngle = labelPosition.angle || 0;\n\t        } else {\n\t            throw new Error('dia.LinkView: invalid label position distance.');\n\t        }\n\n\t        var isDistanceRelative = ((labelDistance > 0) && (labelDistance <= 1));\n\n\t        var labelOffset = 0;\n\t        var labelOffsetCoordinates = { x: 0, y: 0 };\n\t        if (labelPosition.offset) {\n\t            var positionOffset = labelPosition.offset;\n\t            if (typeof positionOffset === 'number') { labelOffset = positionOffset; }\n\t            if (positionOffset.x) { labelOffsetCoordinates.x = positionOffset.x; }\n\t            if (positionOffset.y) { labelOffsetCoordinates.y = positionOffset.y; }\n\t        }\n\n\t        var isOffsetAbsolute = ((labelOffsetCoordinates.x !== 0) || (labelOffsetCoordinates.y !== 0) || labelOffset === 0);\n\n\t        var isKeepGradient = args.keepGradient;\n\t        var isEnsureLegibility = args.ensureLegibility;\n\n\t        var path = this.path;\n\t        var pathOpt = { segmentSubdivisions: this.getConnectionSubdivisions() };\n\n\t        var distance = isDistanceRelative ? (labelDistance * this.getConnectionLength()) : labelDistance;\n\t        var tangent = path.tangentAtLength(distance, pathOpt);\n\n\t        var translation;\n\t        var angle = labelAngle;\n\t        if (tangent) {\n\t            if (isOffsetAbsolute) {\n\t                translation = tangent.start;\n\t                translation.offset(labelOffsetCoordinates);\n\t            } else {\n\t                var normal = tangent.clone();\n\t                normal.rotate(tangent.start, -90);\n\t                normal.setLength(labelOffset);\n\t                translation = normal.end;\n\t            }\n\t            if (isKeepGradient) {\n\t                angle = (tangent.angle() + labelAngle);\n\t                if (isEnsureLegibility) {\n\t                    angle = normalizeAngle(((angle + 90) % 180) - 90);\n\t                }\n\t            }\n\t        } else {\n\t            // fallback - the connection has zero length\n\t            translation = path.start;\n\t            if (isOffsetAbsolute) { translation.offset(labelOffsetCoordinates); }\n\t        }\n\n\t        return V.createSVGMatrix()\n\t            .translate(translation.x, translation.y)\n\t            .rotate(angle);\n\t    },\n\n\t    getLabelCoordinates: function(labelPosition) {\n\n\t        var transformationMatrix = this._getLabelTransformationMatrix(labelPosition);\n\t        return new Point(transformationMatrix.e, transformationMatrix.f);\n\t    },\n\n\t    getVertexIndex: function(x, y) {\n\n\t        var model = this.model;\n\t        var vertices = model.vertices();\n\n\t        var vertexLength = this.getClosestPointLength(new Point(x, y));\n\n\t        var idx = 0;\n\t        for (var n = vertices.length; idx < n; idx++) {\n\t            var currentVertex = vertices[idx];\n\t            var currentVertexLength = this.getClosestPointLength(currentVertex);\n\t            if (vertexLength < currentVertexLength) { break; }\n\t        }\n\n\t        return idx;\n\t    },\n\n\t    // Interaction. The controller part.\n\t    // ---------------------------------\n\n\t    notifyPointerdown: function notifyPointerdown(evt, x, y) {\n\t        CellView.prototype.pointerdown.call(this, evt, x, y);\n\t        this.notify('link:pointerdown', evt, x, y);\n\t    },\n\n\t    notifyPointermove: function notifyPointermove(evt, x, y) {\n\t        CellView.prototype.pointermove.call(this, evt, x, y);\n\t        this.notify('link:pointermove', evt, x, y);\n\t    },\n\n\t    notifyPointerup: function notifyPointerup(evt, x, y) {\n\t        this.notify('link:pointerup', evt, x, y);\n\t        CellView.prototype.pointerup.call(this, evt, x, y);\n\t    },\n\n\t    pointerdblclick: function(evt, x, y) {\n\n\t        CellView.prototype.pointerdblclick.apply(this, arguments);\n\t        this.notify('link:pointerdblclick', evt, x, y);\n\t    },\n\n\t    pointerclick: function(evt, x, y) {\n\n\t        CellView.prototype.pointerclick.apply(this, arguments);\n\t        this.notify('link:pointerclick', evt, x, y);\n\t    },\n\n\t    contextmenu: function(evt, x, y) {\n\n\t        CellView.prototype.contextmenu.apply(this, arguments);\n\t        this.notify('link:contextmenu', evt, x, y);\n\t    },\n\n\t    pointerdown: function(evt, x, y) {\n\n\t        this.notifyPointerdown(evt, x, y);\n\n\t        // Backwards compatibility for the default markup\n\t        var className = evt.target.getAttribute('class');\n\t        switch (className) {\n\n\t            case 'marker-vertex':\n\t                this.dragVertexStart(evt, x, y);\n\t                return;\n\n\t            case 'marker-vertex-remove':\n\t            case 'marker-vertex-remove-area':\n\t                this.dragVertexRemoveStart(evt, x, y);\n\t                return;\n\n\t            case 'marker-arrowhead':\n\t                this.dragArrowheadStart(evt, x, y);\n\t                return;\n\n\t            case 'connection':\n\t            case 'connection-wrap':\n\t                this.dragConnectionStart(evt, x, y);\n\t                return;\n\n\t            case 'marker-source':\n\t            case 'marker-target':\n\t                return;\n\t        }\n\n\t        this.dragStart(evt, x, y);\n\t    },\n\n\t    pointermove: function(evt, x, y) {\n\n\t        // Backwards compatibility\n\t        var dragData = this._dragData;\n\t        if (dragData) { this.eventData(evt, dragData); }\n\n\t        var data = this.eventData(evt);\n\t        switch (data.action) {\n\n\t            case 'vertex-move':\n\t                this.dragVertex(evt, x, y);\n\t                break;\n\n\t            case 'label-move':\n\t                this.dragLabel(evt, x, y);\n\t                break;\n\n\t            case 'arrowhead-move':\n\t                this.dragArrowhead(evt, x, y);\n\t                break;\n\n\t            case 'move':\n\t                this.drag(evt, x, y);\n\t                break;\n\t        }\n\n\t        // Backwards compatibility\n\t        if (dragData) { assign(dragData, this.eventData(evt)); }\n\n\t        this.notifyPointermove(evt, x, y);\n\t    },\n\n\t    pointerup: function(evt, x, y) {\n\n\t        // Backwards compatibility\n\t        var dragData = this._dragData;\n\t        if (dragData) {\n\t            this.eventData(evt, dragData);\n\t            this._dragData = null;\n\t        }\n\n\t        var data = this.eventData(evt);\n\t        switch (data.action) {\n\n\t            case 'vertex-move':\n\t                this.dragVertexEnd(evt, x, y);\n\t                break;\n\n\t            case 'label-move':\n\t                this.dragLabelEnd(evt, x, y);\n\t                break;\n\n\t            case 'arrowhead-move':\n\t                this.dragArrowheadEnd(evt, x, y);\n\t                break;\n\n\t            case 'move':\n\t                this.dragEnd(evt, x, y);\n\t        }\n\n\t        this.notifyPointerup(evt, x, y);\n\t        this.checkMouseleave(evt);\n\t    },\n\n\t    mouseover: function(evt) {\n\n\t        CellView.prototype.mouseover.apply(this, arguments);\n\t        this.notify('link:mouseover', evt);\n\t    },\n\n\t    mouseout: function(evt) {\n\n\t        CellView.prototype.mouseout.apply(this, arguments);\n\t        this.notify('link:mouseout', evt);\n\t    },\n\n\t    mouseenter: function(evt) {\n\n\t        CellView.prototype.mouseenter.apply(this, arguments);\n\t        this.notify('link:mouseenter', evt);\n\t    },\n\n\t    mouseleave: function(evt) {\n\n\t        CellView.prototype.mouseleave.apply(this, arguments);\n\t        this.notify('link:mouseleave', evt);\n\t    },\n\n\t    mousewheel: function(evt, x, y, delta) {\n\n\t        CellView.prototype.mousewheel.apply(this, arguments);\n\t        this.notify('link:mousewheel', evt, x, y, delta);\n\t    },\n\n\t    onevent: function(evt, eventName, x, y) {\n\n\t        // Backwards compatibility\n\t        var linkTool = V(evt.target).findParentByClass('link-tool', this.el);\n\t        if (linkTool) {\n\t            // No further action to be executed\n\t            evt.stopPropagation();\n\n\t            // Allow `interactive.useLinkTools=false`\n\t            if (this.can('useLinkTools')) {\n\t                if (eventName === 'remove') {\n\t                    // Built-in remove event\n\t                    this.model.remove({ ui: true });\n\t                    // Do not trigger link pointerdown\n\t                    return;\n\n\t                } else {\n\t                    // link:options and other custom events inside the link tools\n\t                    this.notify(eventName, evt, x, y);\n\t                }\n\t            }\n\n\t            this.notifyPointerdown(evt, x, y);\n\t            this.paper.delegateDragEvents(this, evt.data);\n\n\t        } else {\n\t            CellView.prototype.onevent.apply(this, arguments);\n\t        }\n\t    },\n\n\t    onlabel: function(evt, x, y) {\n\n\t        this.notifyPointerdown(evt, x, y);\n\n\t        this.dragLabelStart(evt, x, y);\n\n\t        var stopPropagation = this.eventData(evt).stopPropagation;\n\t        if (stopPropagation) { evt.stopPropagation(); }\n\t    },\n\n\t    // Drag Start Handlers\n\n\t    dragConnectionStart: function(evt, x, y) {\n\n\t        if (!this.can('vertexAdd')) { return; }\n\n\t        // Store the index at which the new vertex has just been placed.\n\t        // We'll be update the very same vertex position in `pointermove()`.\n\t        var vertexIdx = this.addVertex({ x: x, y: y }, { ui: true });\n\t        this.eventData(evt, {\n\t            action: 'vertex-move',\n\t            vertexIdx: vertexIdx\n\t        });\n\t    },\n\n\t    dragLabelStart: function(evt, _x, _y) {\n\n\t        if (this.can('labelMove')) {\n\n\t            var labelNode = evt.currentTarget;\n\t            var labelIdx = parseInt(labelNode.getAttribute('label-idx'), 10);\n\n\t            var positionAngle = this._getLabelPositionAngle(labelIdx);\n\t            var labelPositionArgs = this._getLabelPositionArgs(labelIdx);\n\t            var defaultLabelPositionArgs = this._getDefaultLabelPositionArgs();\n\t            var positionArgs = this._mergeLabelPositionArgs(labelPositionArgs, defaultLabelPositionArgs);\n\n\t            this.eventData(evt, {\n\t                action: 'label-move',\n\t                labelIdx: labelIdx,\n\t                positionAngle: positionAngle,\n\t                positionArgs: positionArgs,\n\t                stopPropagation: true\n\t            });\n\n\t        } else {\n\n\t            // Backwards compatibility:\n\t            // If labels can't be dragged no default action is triggered.\n\t            this.eventData(evt, { stopPropagation: true });\n\t        }\n\n\t        this.paper.delegateDragEvents(this, evt.data);\n\t    },\n\n\t    dragVertexStart: function(evt, x, y) {\n\n\t        if (!this.can('vertexMove')) { return; }\n\n\t        var vertexNode = evt.target;\n\t        var vertexIdx = parseInt(vertexNode.getAttribute('idx'), 10);\n\t        this.eventData(evt, {\n\t            action: 'vertex-move',\n\t            vertexIdx: vertexIdx\n\t        });\n\t    },\n\n\t    dragVertexRemoveStart: function(evt, x, y) {\n\n\t        if (!this.can('vertexRemove')) { return; }\n\n\t        var removeNode = evt.target;\n\t        var vertexIdx = parseInt(removeNode.getAttribute('idx'), 10);\n\t        this.model.removeVertex(vertexIdx);\n\t    },\n\n\t    dragArrowheadStart: function(evt, x, y) {\n\n\t        if (!this.can('arrowheadMove')) { return; }\n\n\t        var arrowheadNode = evt.target;\n\t        var arrowheadType = arrowheadNode.getAttribute('end');\n\t        var data = this.startArrowheadMove(arrowheadType, { ignoreBackwardsCompatibility: true });\n\n\t        this.eventData(evt, data);\n\t    },\n\n\t    dragStart: function(evt, x, y) {\n\n\t        if (!this.can('linkMove')) { return; }\n\n\t        this.eventData(evt, {\n\t            action: 'move',\n\t            dx: x,\n\t            dy: y\n\t        });\n\t    },\n\n\t    // Drag Handlers\n\t    dragLabel: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\t        var label = { position: this.getLabelPosition(x, y, data.positionAngle, data.positionArgs) };\n\t        if (this.paper.options.snapLabels) { delete label.position.offset; }\n\t        this.model.label(data.labelIdx, label);\n\t    },\n\n\t    dragVertex: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\t        this.model.vertex(data.vertexIdx, { x: x, y: y }, { ui: true });\n\t    },\n\n\t    dragArrowhead: function(evt, x, y) {\n\n\t        if (this.paper.options.snapLinks) {\n\n\t            this._snapArrowhead(evt, x, y);\n\n\t        } else {\n\n\t            this._connectArrowhead(this.getEventTarget(evt), x, y, this.eventData(evt));\n\t        }\n\t    },\n\n\t    drag: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\t        this.model.translate(x - data.dx, y - data.dy, { ui: true });\n\t        this.eventData(evt, {\n\t            dx: x,\n\t            dy: y\n\t        });\n\t    },\n\n\t    // Drag End Handlers\n\n\t    dragLabelEnd: function() {\n\t        // noop\n\t    },\n\n\t    dragVertexEnd: function() {\n\t        // noop\n\t    },\n\n\t    dragArrowheadEnd: function(evt, x, y) {\n\n\t        var data = this.eventData(evt);\n\t        var paper = this.paper;\n\n\t        if (paper.options.snapLinks) {\n\t            this._snapArrowheadEnd(data);\n\t        } else {\n\t            this._connectArrowheadEnd(data, x, y);\n\t        }\n\n\t        if (!paper.linkAllowed(this)) {\n\t            // If the changed link is not allowed, revert to its previous state.\n\t            this._disallow(data);\n\t        } else {\n\t            this._finishEmbedding(data);\n\t            this._notifyConnectEvent(data, evt);\n\t        }\n\n\t        this._afterArrowheadMove(data);\n\t    },\n\n\t    dragEnd: function() {\n\t        // noop\n\t    },\n\n\t    _disallow: function(data) {\n\n\t        switch (data.whenNotAllowed) {\n\n\t            case 'remove':\n\t                this.model.remove({ ui: true });\n\t                break;\n\n\t            case 'revert':\n\t            default:\n\t                this.model.set(data.arrowhead, data.initialEnd, { ui: true });\n\t                break;\n\t        }\n\t    },\n\n\t    _finishEmbedding: function(data) {\n\n\t        // Reparent the link if embedding is enabled\n\t        if (this.paper.options.embeddingMode && this.model.reparent()) {\n\t            // Make sure we don't reverse to the original 'z' index (see afterArrowheadMove()).\n\t            data.z = null;\n\t        }\n\t    },\n\n\t    _notifyConnectEvent: function(data, evt) {\n\n\t        var arrowhead = data.arrowhead;\n\t        var initialEnd = data.initialEnd;\n\t        var currentEnd = this.model.prop(arrowhead);\n\t        var endChanged = currentEnd && !Link.endsEqual(initialEnd, currentEnd);\n\t        if (endChanged) {\n\t            var paper = this.paper;\n\t            if (initialEnd.id) {\n\t                this.notify('link:disconnect', evt, paper.findViewByModel(initialEnd.id), data.initialMagnet, arrowhead);\n\t            }\n\t            if (currentEnd.id) {\n\t                this.notify('link:connect', evt, paper.findViewByModel(currentEnd.id), data.magnetUnderPointer, arrowhead);\n\t            }\n\t        }\n\t    },\n\n\t    _snapArrowhead: function(evt, x, y) {\n\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var ref$1 = paper.options;\n\t        var snapLinks = ref$1.snapLinks;\n\t        var connectionStrategy = ref$1.connectionStrategy;\n\t        var data = this.eventData(evt);\n\t        // checking view in close area of the pointer\n\n\t        var r = snapLinks.radius || 50;\n\t        var viewsInArea = paper.findViewsInArea({ x: x - r, y: y - r, width: 2 * r, height: 2 * r });\n\n\t        var prevClosestView = data.closestView || null;\n\t        var prevClosestMagnet = data.closestMagnet || null;\n\t        var prevMagnetProxy = data.magnetProxy || null;\n\n\t        data.closestView = data.closestMagnet = data.magnetProxy = null;\n\n\t        var minDistance = Number.MAX_VALUE;\n\t        var pointer = new Point(x, y);\n\n\t        viewsInArea.forEach(function(view) {\n\t            var candidates = [];\n\t            // skip connecting to the element in case '.': { magnet: false } attribute present\n\t            if (view.el.getAttribute('magnet') !== 'false') {\n\t                candidates.push({\n\t                    bbox: view.model.getBBox(),\n\t                    magnet: view.el\n\t                });\n\t            }\n\n\t            view.$('[magnet]').toArray().forEach(function (magnet) {\n\t                candidates.push({\n\t                    bbox: view.getNodeBBox(magnet),\n\t                    magnet: magnet\n\t                });\n\t            });\n\n\t            candidates.forEach(function (candidate) {\n\t                var magnet = candidate.magnet;\n\t                var bbox = candidate.bbox;\n\t                // find distance from the center of the model to pointer coordinates\n\t                var distance = bbox.center().squaredDistance(pointer);\n\t                // the connection is looked up in a circle area by `distance < r`\n\t                if (distance < minDistance) {\n\t                    var isAlreadyValidated = prevClosestMagnet === magnet;\n\t                    if (isAlreadyValidated || paper.options.validateConnection.apply(\n\t                        paper, data.validateConnectionArgs(view, (view.el === magnet) ? null : magnet)\n\t                    )) {\n\t                        minDistance = distance;\n\t                        data.closestView = view;\n\t                        data.closestMagnet = magnet;\n\t                    }\n\t                }\n\t            });\n\n\t        }, this);\n\n\t        var end;\n\t        var magnetProxy = null;\n\t        var closestView = data.closestView;\n\t        var closestMagnet = data.closestMagnet;\n\t        if (closestMagnet) {\n\t            magnetProxy = data.magnetProxy = closestView.findProxyNode(closestMagnet, 'highlighter');\n\t        }\n\t        var endType = data.arrowhead;\n\t        var newClosestMagnet = (prevClosestMagnet !== closestMagnet);\n\t        if (prevClosestView && newClosestMagnet) {\n\t            prevClosestView.unhighlight(prevMagnetProxy, {\n\t                connecting: true,\n\t                snapping: true\n\t            });\n\t        }\n\n\t        if (closestView) {\n\t            var prevEnd = data.prevEnd;\n\t            var prevX = data.prevX;\n\t            var prevY = data.prevY;\n\t            data.prevX = x;\n\t            data.prevY = y;\n\n\t            if (!newClosestMagnet)  {\n\t                if (typeof connectionStrategy !== 'function' || (prevX === x && prevY === y)) {\n\t                    // the magnet has not changed and the link's end does not depend on the x and y\n\t                    return;\n\t                }\n\t            }\n\n\t            end = closestView.getLinkEnd(closestMagnet, x, y, this.model, endType);\n\t            if (!newClosestMagnet && isEqual(prevEnd, end)) {\n\t                // the source/target json has not changed\n\t                return;\n\t            }\n\n\t            data.prevEnd = end;\n\n\t            if (newClosestMagnet) {\n\t                closestView.highlight(magnetProxy, {\n\t                    connecting: true,\n\t                    snapping: true\n\t                });\n\t            }\n\n\t        } else {\n\n\t            end = { x: x, y: y };\n\t        }\n\n\t        this.model.set(endType, end || { x: x, y: y }, { ui: true });\n\n\t        if (prevClosestView) {\n\t            this.notify('link:snap:disconnect', evt, prevClosestView, prevClosestMagnet, endType);\n\t        }\n\t        if (closestView) {\n\t            this.notify('link:snap:connect', evt, closestView, closestMagnet, endType);\n\t        }\n\t    },\n\n\t    _snapArrowheadEnd: function(data) {\n\n\t        // Finish off link snapping.\n\t        // Everything except view unhighlighting was already done on pointermove.\n\t        var closestView = data.closestView;\n\t        var closestMagnet = data.closestMagnet;\n\t        if (closestView && closestMagnet) {\n\n\t            closestView.unhighlight(data.magnetProxy, { connecting: true, snapping: true });\n\t            data.magnetUnderPointer = closestView.findMagnet(closestMagnet);\n\t        }\n\n\t        data.closestView = data.closestMagnet = null;\n\t    },\n\n\t    _connectArrowhead: function(target, x, y, data) {\n\n\t        // checking views right under the pointer\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var model = ref.model;\n\n\t        if (data.eventTarget !== target) {\n\t            // Unhighlight the previous view under pointer if there was one.\n\t            if (data.magnetProxy) {\n\t                data.viewUnderPointer.unhighlight(data.magnetProxy, {\n\t                    connecting: true\n\t                });\n\t            }\n\n\t            var viewUnderPointer = data.viewUnderPointer = paper.findView(target);\n\t            if (viewUnderPointer) {\n\t                // If we found a view that is under the pointer, we need to find the closest\n\t                // magnet based on the real target element of the event.\n\t                var magnetUnderPointer = data.magnetUnderPointer = viewUnderPointer.findMagnet(target);\n\t                var magnetProxy = data.magnetProxy = viewUnderPointer.findProxyNode(magnetUnderPointer, 'highlighter');\n\n\t                if (magnetUnderPointer && this.paper.options.validateConnection.apply(\n\t                    paper,\n\t                    data.validateConnectionArgs(viewUnderPointer, magnetUnderPointer)\n\t                )) {\n\t                    // If there was no magnet found, do not highlight anything and assume there\n\t                    // is no view under pointer we're interested in reconnecting to.\n\t                    // This can only happen if the overall element has the attribute `'.': { magnet: false }`.\n\t                    if (magnetProxy) {\n\t                        viewUnderPointer.highlight(magnetProxy, {\n\t                            connecting: true\n\t                        });\n\t                    }\n\t                } else {\n\t                    // This type of connection is not valid. Disregard this magnet.\n\t                    data.magnetUnderPointer = null;\n\t                    data.magnetProxy = null;\n\t                }\n\t            } else {\n\t                // Make sure we'll unset previous magnet.\n\t                data.magnetUnderPointer = null;\n\t                data.magnetProxy = null;\n\t            }\n\t        }\n\n\t        data.eventTarget = target;\n\n\t        model.set(data.arrowhead, { x: x, y: y }, { ui: true });\n\t    },\n\n\t    _connectArrowheadEnd: function(data, x, y) {\n\t        if ( data === void 0 ) data = {};\n\n\n\t        var ref = this;\n\t        var model = ref.model;\n\t        var viewUnderPointer = data.viewUnderPointer;\n\t        var magnetUnderPointer = data.magnetUnderPointer;\n\t        var magnetProxy = data.magnetProxy;\n\t        var arrowhead = data.arrowhead;\n\n\t        if (!magnetUnderPointer || !magnetProxy || !viewUnderPointer) { return; }\n\n\t        viewUnderPointer.unhighlight(magnetProxy, { connecting: true });\n\n\t        // The link end is taken from the magnet under the pointer, not the proxy.\n\t        var end = viewUnderPointer.getLinkEnd(magnetUnderPointer, x, y, model, arrowhead);\n\t        model.set(arrowhead, end, { ui: true });\n\t    },\n\n\t    _beforeArrowheadMove: function(data) {\n\n\t        data.z = this.model.get('z');\n\t        this.model.toFront();\n\n\t        // Let the pointer propagate through the link view elements so that\n\t        // the `evt.target` is another element under the pointer, not the link itself.\n\t        var style = this.el.style;\n\t        data.pointerEvents = style.pointerEvents;\n\t        style.pointerEvents = 'none';\n\n\t        if (this.paper.options.markAvailable) {\n\t            this._markAvailableMagnets(data);\n\t        }\n\t    },\n\n\t    _afterArrowheadMove: function(data) {\n\n\t        if (data.z !== null) {\n\t            this.model.set('z', data.z, { ui: true });\n\t            data.z = null;\n\t        }\n\n\t        // Put `pointer-events` back to its original value. See `_beforeArrowheadMove()` for explanation.\n\t        this.el.style.pointerEvents = data.pointerEvents;\n\n\t        if (this.paper.options.markAvailable) {\n\t            this._unmarkAvailableMagnets(data);\n\t        }\n\t    },\n\n\t    _createValidateConnectionArgs: function(arrowhead) {\n\t        // It makes sure the arguments for validateConnection have the following form:\n\t        // (source view, source magnet, target view, target magnet and link view)\n\t        var args = [];\n\n\t        args[4] = arrowhead;\n\t        args[5] = this;\n\n\t        var oppositeArrowhead;\n\t        var i = 0;\n\t        var j = 0;\n\n\t        if (arrowhead === 'source') {\n\t            i = 2;\n\t            oppositeArrowhead = 'target';\n\t        } else {\n\t            j = 2;\n\t            oppositeArrowhead = 'source';\n\t        }\n\n\t        var end = this.model.get(oppositeArrowhead);\n\n\t        if (end.id) {\n\t            var view = args[i] = this.paper.findViewByModel(end.id);\n\t            var magnet = view.getMagnetFromLinkEnd(end);\n\t            if (magnet === view.el) { magnet = undefined; }\n\t            args[i + 1] = magnet;\n\t        }\n\n\t        function validateConnectionArgs(cellView, magnet) {\n\t            args[j] = cellView;\n\t            args[j + 1] = cellView.el === magnet ? undefined : magnet;\n\t            return args;\n\t        }\n\n\t        return validateConnectionArgs;\n\t    },\n\n\t    _markAvailableMagnets: function(data) {\n\n\t        function isMagnetAvailable(view, magnet) {\n\t            var paper = view.paper;\n\t            var validate = paper.options.validateConnection;\n\t            return validate.apply(paper, this.validateConnectionArgs(view, magnet));\n\t        }\n\n\t        var paper = this.paper;\n\t        var elements = paper.model.getCells();\n\t        data.marked = {};\n\n\t        for (var i = 0, n = elements.length; i < n; i++) {\n\t            var view = elements[i].findView(paper);\n\n\t            if (!view) {\n\t                continue;\n\t            }\n\n\t            var magnets = Array.prototype.slice.call(view.el.querySelectorAll('[magnet]'));\n\t            if (view.el.getAttribute('magnet') !== 'false') {\n\t                // Element wrapping group is also a magnet\n\t                magnets.push(view.el);\n\t            }\n\n\t            var availableMagnets = magnets.filter(isMagnetAvailable.bind(data, view));\n\n\t            if (availableMagnets.length > 0) {\n\t                // highlight all available magnets\n\t                for (var j = 0, m = availableMagnets.length; j < m; j++) {\n\t                    view.highlight(availableMagnets[j], { magnetAvailability: true });\n\t                }\n\t                // highlight the entire view\n\t                view.highlight(null, { elementAvailability: true });\n\n\t                data.marked[view.model.id] = availableMagnets;\n\t            }\n\t        }\n\t    },\n\n\t    _unmarkAvailableMagnets: function(data) {\n\n\t        var markedKeys = Object.keys(data.marked);\n\t        var id;\n\t        var markedMagnets;\n\n\t        for (var i = 0, n = markedKeys.length; i < n; i++) {\n\t            id = markedKeys[i];\n\t            markedMagnets = data.marked[id];\n\n\t            var view = this.paper.findViewByModel(id);\n\t            if (view) {\n\t                for (var j = 0, m = markedMagnets.length; j < m; j++) {\n\t                    view.unhighlight(markedMagnets[j], { magnetAvailability: true });\n\t                }\n\t                view.unhighlight(null, { elementAvailability: true });\n\t            }\n\t        }\n\n\t        data.marked = null;\n\t    },\n\n\t    startArrowheadMove: function(end, opt) {\n\n\t        opt || (opt = {});\n\n\t        // Allow to delegate events from an another view to this linkView in order to trigger arrowhead\n\t        // move without need to click on the actual arrowhead dom element.\n\t        var data = {\n\t            action: 'arrowhead-move',\n\t            arrowhead: end,\n\t            whenNotAllowed: opt.whenNotAllowed || 'revert',\n\t            initialMagnet: this[end + 'Magnet'] || (this[end + 'View'] ? this[end + 'View'].el : null),\n\t            initialEnd: clone(this.model.get(end)),\n\t            validateConnectionArgs: this._createValidateConnectionArgs(end)\n\t        };\n\n\t        this._beforeArrowheadMove(data);\n\n\t        if (opt.ignoreBackwardsCompatibility !== true) {\n\t            this._dragData = data;\n\t        }\n\n\t        return data;\n\t    },\n\n\t    onRemove: function() {\n\t        CellView.prototype.onRemove.apply(this, arguments);\n\t        this.unmountLabels();\n\t    }\n\n\t}, {\n\n\t    Flags: Flags$1,\n\t});\n\n\tObject.defineProperty(LinkView.prototype, 'sourceBBox', {\n\n\t    enumerable: true,\n\n\t    get: function() {\n\t        var sourceView = this.sourceView;\n\t        if (!sourceView) {\n\t            var sourceDef = this.model.source();\n\t            return new Rect(sourceDef.x, sourceDef.y);\n\t        }\n\t        var sourceMagnet = this.sourceMagnet;\n\t        if (sourceView.isNodeConnection(sourceMagnet)) {\n\t            return new Rect(this.sourceAnchor);\n\t        }\n\t        return sourceView.getNodeBBox(sourceMagnet || sourceView.el);\n\t    }\n\n\t});\n\n\tObject.defineProperty(LinkView.prototype, 'targetBBox', {\n\n\t    enumerable: true,\n\n\t    get: function() {\n\t        var targetView = this.targetView;\n\t        if (!targetView) {\n\t            var targetDef = this.model.target();\n\t            return new Rect(targetDef.x, targetDef.y);\n\t        }\n\t        var targetMagnet = this.targetMagnet;\n\t        if (targetView.isNodeConnection(targetMagnet)) {\n\t            return new Rect(this.targetAnchor);\n\t        }\n\t        return targetView.getNodeBBox(targetMagnet || targetView.el);\n\t    }\n\t});\n\n\tvar stroke = HighlighterView.extend({\n\n\t    tagName: 'path',\n\t    className: 'highlight-stroke',\n\t    attributes: {\n\t        'pointer-events': 'none',\n\t        'vector-effect': 'non-scaling-stroke',\n\t        'fill': 'none'\n\t    },\n\n\t    options: {\n\t        padding: 3,\n\t        rx: 0,\n\t        ry: 0,\n\t        useFirstSubpath: false,\n\t        attrs: {\n\t            'stroke-width': 3,\n\t            'stroke': '#FEB663'\n\t        }\n\t    },\n\n\t    getPathData: function getPathData(cellView, node) {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var useFirstSubpath = options.useFirstSubpath;\n\t        var d;\n\t        try {\n\t            var vNode = V(node);\n\t            d = vNode.convertToPathData().trim();\n\t            if (vNode.tagName() === 'PATH' && useFirstSubpath) {\n\t                var secondSubpathIndex = d.search(/.M/i) + 1;\n\t                if (secondSubpathIndex > 0) {\n\t                    d = d.substr(0, secondSubpathIndex);\n\t                }\n\t            }\n\t        } catch (error) {\n\t            // Failed to get path data from magnet element.\n\t            // Draw a rectangle around the node instead.\n\t            var nodeBBox = cellView.getNodeBoundingRect(node);\n\t            d = V.rectToPath(assign({}, options, nodeBBox.toJSON()));\n\t        }\n\t        return d;\n\t    },\n\n\t    highlightConnection: function highlightConnection(cellView) {\n\t        this.vel.attr('d', cellView.getSerializedConnection());\n\t    },\n\n\t    highlightNode: function highlightNode(cellView, node) {\n\t        var ref = this;\n\t        var vel = ref.vel;\n\t        var options = ref.options;\n\t        var padding = options.padding;\n\t        var layer = options.layer;\n\t        var highlightMatrix = cellView.getNodeMatrix(node);\n\t        // Add padding to the highlight element.\n\t        if (padding) {\n\t            if (!layer && node === cellView.el) {\n\t                // If the highlighter is appended to the cellView\n\t                // and we measure the size of the cellView wrapping group\n\t                // it's necessary to remove the highlighter first\n\t                vel.remove();\n\t            }\n\t            var nodeBBox = cellView.getNodeBoundingRect(node);\n\t            var cx = nodeBBox.x + (nodeBBox.width / 2);\n\t            var cy = nodeBBox.y + (nodeBBox.height / 2);\n\t            nodeBBox = V.transformRect(nodeBBox, highlightMatrix);\n\t            var width = Math.max(nodeBBox.width, 1);\n\t            var height = Math.max(nodeBBox.height, 1);\n\t            var sx = (width + padding) / width;\n\t            var sy = (height + padding) / height;\n\t            var paddingMatrix = V.createSVGMatrix({\n\t                a: sx,\n\t                b: 0,\n\t                c: 0,\n\t                d: sy,\n\t                e: cx - sx * cx,\n\t                f: cy - sy * cy\n\t            });\n\t            highlightMatrix = highlightMatrix.multiply(paddingMatrix);\n\t        }\n\t        vel.attr({\n\t            'd': this.getPathData(cellView, node),\n\t            'transform': V.matrixToTransformString(highlightMatrix)\n\t        });\n\t    },\n\n\t    highlight: function highlight(cellView, node) {\n\t        var ref = this;\n\t        var vel = ref.vel;\n\t        var options = ref.options;\n\t        vel.attr(options.attrs);\n\t        if (cellView.isNodeConnection(node)) {\n\t            this.highlightConnection(cellView);\n\t        } else {\n\t            this.highlightNode(cellView, node);\n\t        }\n\t    }\n\n\t});\n\n\tvar MASK_CLIP = 20;\n\n\tfunction forEachDescendant(vel, fn) {\n\t    var descendants = vel.children();\n\t    while (descendants.length > 0) {\n\t        var descendant = descendants.shift();\n\t        if (fn(descendant)) {\n\t            descendants.push.apply(descendants, descendant.children());\n\t        }\n\t    }\n\t}\n\n\tvar mask = HighlighterView.extend({\n\n\t    tagName: 'rect',\n\t    className: 'highlight-mask',\n\t    attributes: {\n\t        'pointer-events': 'none'\n\t    },\n\n\t    options: {\n\t        padding: 3,\n\t        maskClip: MASK_CLIP,\n\t        deep: false,\n\t        attrs: {\n\t            'stroke': '#FEB663',\n\t            'stroke-width': 3,\n\t            'stroke-linecap': 'butt',\n\t            'stroke-linejoin': 'miter',\n\t        }\n\t    },\n\n\t    VISIBLE: 'white',\n\t    INVISIBLE: 'black',\n\n\t    MASK_ROOT_ATTRIBUTE_BLACKLIST: [\n\t        'marker-start',\n\t        'marker-end',\n\t        'marker-mid',\n\t        'transform',\n\t        'stroke-dasharray'\n\t    ],\n\n\t    MASK_CHILD_ATTRIBUTE_BLACKLIST: [\n\t        'stroke',\n\t        'fill',\n\t        'stroke-width',\n\t        'stroke-opacity',\n\t        'stroke-dasharray',\n\t        'fill-opacity',\n\t        'marker-start',\n\t        'marker-end',\n\t        'marker-mid'\n\t    ],\n\n\t    // TODO: change the list to a function callback\n\t    MASK_REPLACE_TAGS: [\n\t        'FOREIGNOBJECT',\n\t        'IMAGE',\n\t        'USE',\n\t        'TEXT',\n\t        'TSPAN',\n\t        'TEXTPATH'\n\t    ],\n\n\t    // TODO: change the list to a function callback\n\t    MASK_REMOVE_TAGS: [\n\t        'TEXT',\n\t        'TSPAN',\n\t        'TEXTPATH'\n\t    ],\n\n\t    transformMaskChild: function transformMaskChild(cellView, childEl) {\n\t        var ref = this;\n\t        var MASK_CHILD_ATTRIBUTE_BLACKLIST = ref.MASK_CHILD_ATTRIBUTE_BLACKLIST;\n\t        var MASK_REPLACE_TAGS = ref.MASK_REPLACE_TAGS;\n\t        var MASK_REMOVE_TAGS = ref.MASK_REMOVE_TAGS;\n\t        var childTagName = childEl.tagName();\n\t        // Do not include the element in the mask's image\n\t        if (!V.isSVGGraphicsElement(childEl) || MASK_REMOVE_TAGS.includes(childTagName)) {\n\t            childEl.remove();\n\t            return false;\n\t        }\n\t        // Replace the element with a rectangle\n\t        if (MASK_REPLACE_TAGS.includes(childTagName)) {\n\t            // Note: clone() method does not change the children ids\n\t            var originalChild = cellView.vel.findOne((\"#\" + (childEl.id)));\n\t            if (originalChild) {\n\t                var originalNode = originalChild.node;\n\t                var childBBox = cellView.getNodeBoundingRect(originalNode);\n\t                if (cellView.model.isElement()) {\n\t                    childBBox = V.transformRect(childBBox, cellView.getNodeMatrix(originalNode));\n\t                }\n\t                var replacement = V('rect', childBBox.toJSON());\n\t                var ref$1 = childBBox.center();\n\t                var ox = ref$1.x;\n\t                var oy = ref$1.y;\n\t                var ref$2 = originalChild.rotate();\n\t                var angle = ref$2.angle;\n\t                var cx = ref$2.cx; if ( cx === void 0 ) cx = ox;\n\t                var cy = ref$2.cy; if ( cy === void 0 ) cy = oy;\n\t                if (angle) { replacement.rotate(angle, cx, cy); }\n\t                // Note: it's not important to keep the same sibling index since all subnodes are filled\n\t                childEl.parent().append(replacement);\n\t            }\n\t            childEl.remove();\n\t            return false;\n\t        }\n\t        // Keep the element, but clean it from certain attributes\n\t        MASK_CHILD_ATTRIBUTE_BLACKLIST.forEach(function (attrName) {\n\t            if (attrName === 'fill' && childEl.attr('fill') === 'none') { return; }\n\t            childEl.removeAttr(attrName);\n\t        });\n\t        return true;\n\t    },\n\n\t    transformMaskRoot: function transformMaskRoot(_cellView, rootEl) {\n\t        var ref = this;\n\t        var MASK_ROOT_ATTRIBUTE_BLACKLIST = ref.MASK_ROOT_ATTRIBUTE_BLACKLIST;\n\t        MASK_ROOT_ATTRIBUTE_BLACKLIST.forEach(function (attrName) {\n\t            rootEl.removeAttr(attrName);\n\t        });\n\t    },\n\n\t    getMaskShape: function getMaskShape(cellView, vel) {\n\t        var this$1 = this;\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var MASK_REPLACE_TAGS = ref.MASK_REPLACE_TAGS;\n\t        var deep = options.deep;\n\t        var tagName = vel.tagName();\n\t        var maskRoot;\n\t        if (tagName === 'G') {\n\t            if (!deep) { return null; }\n\t            maskRoot = vel.clone();\n\t            forEachDescendant(maskRoot, function (maskChild) { return this$1.transformMaskChild(cellView, maskChild); });\n\t        } else {\n\t            if (MASK_REPLACE_TAGS.includes(tagName)) { return null; }\n\t            maskRoot = vel.clone();\n\t        }\n\t        this.transformMaskRoot(cellView, maskRoot);\n\t        return maskRoot;\n\t    },\n\n\t    getMaskId: function getMaskId() {\n\t        return (\"highlight-mask-\" + (this.cid));\n\t    },\n\n\t    getMask: function getMask(cellView, vNode) {\n\n\t        var ref = this;\n\t        var VISIBLE = ref.VISIBLE;\n\t        var INVISIBLE = ref.INVISIBLE;\n\t        var options = ref.options;\n\t        var padding = options.padding;\n\t        var attrs = options.attrs;\n\n\t        var strokeWidth = ('stroke-width' in attrs) ? attrs['stroke-width'] : 1;\n\t        var hasNodeFill = vNode.attr('fill') !== 'none';\n\t        var magnetStrokeWidth = parseFloat(vNode.attr('stroke-width'));\n\t        if (isNaN(magnetStrokeWidth)) { magnetStrokeWidth = 1; }\n\t        // stroke of the invisible shape\n\t        var minStrokeWidth = magnetStrokeWidth + padding * 2;\n\t        // stroke of the visible shape\n\t        var maxStrokeWidth = minStrokeWidth + strokeWidth * 2;\n\t        var maskEl = this.getMaskShape(cellView, vNode);\n\t        if (!maskEl) {\n\t            var nodeBBox = cellView.getNodeBoundingRect(vNode.node);\n\t            // Make sure the rect is visible\n\t            nodeBBox.inflate(nodeBBox.width ? 0 : 0.5, nodeBBox.height ? 0 : 0.5);\n\t            maskEl =  V('rect', nodeBBox.toJSON());\n\t        }\n\t        maskEl.attr(attrs);\n\t        return V('mask', {\n\t            'id': this.getMaskId()\n\t        }).append([\n\t            maskEl.clone().attr({\n\t                'fill': hasNodeFill ? VISIBLE : 'none',\n\t                'stroke': VISIBLE,\n\t                'stroke-width': maxStrokeWidth\n\t            }),\n\t            maskEl.clone().attr({\n\t                'fill': hasNodeFill ? INVISIBLE : 'none',\n\t                'stroke': INVISIBLE,\n\t                'stroke-width': minStrokeWidth\n\t            })\n\t        ]);\n\t    },\n\n\t    removeMask: function removeMask(paper) {\n\t        var maskNode = paper.svg.getElementById(this.getMaskId());\n\t        if (maskNode) {\n\t            paper.defs.removeChild(maskNode);\n\t        }\n\t    },\n\n\t    addMask: function addMask(paper, maskEl) {\n\t        paper.defs.appendChild(maskEl.node);\n\t    },\n\n\t    highlight: function highlight(cellView, node) {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var vel = ref.vel;\n\t        var padding = options.padding;\n\t        var attrs = options.attrs;\n\t        var maskClip = options.maskClip; if ( maskClip === void 0 ) maskClip = MASK_CLIP;\n\t        var layer = options.layer;\n\t        var color = ('stroke' in attrs) ? attrs['stroke'] : '#000000';\n\t        if (!layer && node === cellView.el) {\n\t            // If the highlighter is appended to the cellView\n\t            // and we measure the size of the cellView wrapping group\n\t            // it's necessary to remove the highlighter first\n\t            vel.remove();\n\t        }\n\t        var highlighterBBox = cellView.getNodeBoundingRect(node).inflate(padding + maskClip);\n\t        var maskEl = this.getMask(cellView, V(node));\n\t        this.addMask(cellView.paper, maskEl);\n\t        vel.attr(highlighterBBox.toJSON());\n\t        vel.attr({\n\t            'transform': V.matrixToTransformString(cellView.getNodeMatrix(node)),\n\t            'mask': (\"url(#\" + (maskEl.id) + \")\"),\n\t            'fill': color\n\t        });\n\t    },\n\n\t    unhighlight: function unhighlight(cellView) {\n\t        this.removeMask(cellView.paper);\n\t    }\n\n\t});\n\n\tvar opacity = HighlighterView.extend({\n\n\t    UPDATABLE: false,\n\t    MOUNTABLE: false,\n\n\t    opacityClassName: addClassNamePrefix('highlight-opacity'),\n\n\t    highlight: function(_cellView, node) {\n\t        V(node).addClass(this.opacityClassName);\n\t    },\n\n\t    unhighlight: function(_cellView, node) {\n\t        V(node).removeClass(this.opacityClassName);\n\t    }\n\n\t});\n\n\tvar className = addClassNamePrefix('highlighted');\n\n\tvar addClass = HighlighterView.extend({\n\n\t    UPDATABLE: false,\n\t    MOUNTABLE: false,\n\n\t    options: {\n\t        className: className\n\t    },\n\n\t    highlight: function(_cellView, node) {\n\t        V(node).addClass(this.options.className);\n\t    },\n\n\t    unhighlight: function(_cellView, node) {\n\t        V(node).removeClass(this.options.className);\n\t    }\n\n\t}, {\n\t    // Backwards Compatibility\n\t    className: className\n\t});\n\n\n\n\tvar highlighters = ({\n\t\tstroke: stroke,\n\t\tmask: mask,\n\t\topacity: opacity,\n\t\taddClass: addClass\n\t});\n\n\tfunction connectionRatio(view, _magnet, _refPoint, opt) {\n\n\t    var ratio = ('ratio' in opt) ? opt.ratio : 0.5;\n\t    return view.getPointAtRatio(ratio);\n\t}\n\n\tfunction connectionLength(view, _magnet, _refPoint, opt) {\n\n\t    var length = ('length' in opt) ? opt.length : 20;\n\t    return view.getPointAtLength(length);\n\t}\n\n\tfunction _connectionPerpendicular(view, _magnet, refPoint, opt) {\n\n\t    var OFFSET = 1e6;\n\t    var path = view.getConnection();\n\t    var segmentSubdivisions = view.getConnectionSubdivisions();\n\t    var verticalLine = new Line(refPoint.clone().offset(0, OFFSET), refPoint.clone().offset(0, -OFFSET));\n\t    var horizontalLine = new Line(refPoint.clone().offset(OFFSET, 0), refPoint.clone().offset(-OFFSET, 0));\n\t    var verticalIntersections = verticalLine.intersect(path, { segmentSubdivisions: segmentSubdivisions });\n\t    var horizontalIntersections = horizontalLine.intersect(path, { segmentSubdivisions: segmentSubdivisions });\n\t    var intersections = [];\n\t    if (verticalIntersections) { Array.prototype.push.apply(intersections, verticalIntersections); }\n\t    if (horizontalIntersections) { Array.prototype.push.apply(intersections, horizontalIntersections); }\n\t    if (intersections.length > 0) { return refPoint.chooseClosest(intersections); }\n\t    if ('fallbackAt' in opt) {\n\t        return getPointAtLink(view, opt.fallbackAt);\n\t    }\n\t    return connectionClosest(view, _magnet, refPoint, opt);\n\t}\n\n\tfunction _connectionClosest(view, _magnet, refPoint, _opt) {\n\n\t    var closestPoint = view.getClosestPoint(refPoint);\n\t    if (!closestPoint) { return new Point(); }\n\t    return closestPoint;\n\t}\n\n\tfunction resolveRef(fn) {\n\t    return function(view, magnet, ref, opt) {\n\t        if (ref instanceof Element) {\n\t            var refView = this.paper.findView(ref);\n\t            var refPoint;\n\t            if (refView) {\n\t                if (refView.isNodeConnection(ref)) {\n\t                    var distance = ('fixedAt' in opt) ? opt.fixedAt : '50%';\n\t                    refPoint = getPointAtLink(refView, distance);\n\t                } else {\n\t                    refPoint = refView.getNodeBBox(ref).center();\n\t                }\n\t            } else {\n\t                // Something went wrong\n\t                refPoint = new Point();\n\t            }\n\t            return fn.call(this, view, magnet, refPoint, opt);\n\t        }\n\t        return fn.apply(this, arguments);\n\t    };\n\t}\n\n\tfunction getPointAtLink(view, value) {\n\t    var parsedValue = parseFloat(value);\n\t    if (isPercentage(value)) {\n\t        return view.getPointAtRatio(parsedValue / 100);\n\t    } else {\n\t        return view.getPointAtLength(parsedValue);\n\t    }\n\t}\n\tvar connectionPerpendicular = resolveRef(_connectionPerpendicular);\n\tvar connectionClosest = resolveRef(_connectionClosest);\n\n\tvar linkAnchors = ({\n\t\tresolveRef: resolveRef,\n\t\tconnectionRatio: connectionRatio,\n\t\tconnectionLength: connectionLength,\n\t\tconnectionPerpendicular: connectionPerpendicular,\n\t\tconnectionClosest: connectionClosest\n\t});\n\n\tfunction offsetPoint(p1, p2, offset) {\n\t    if (isPlainObject(offset)) {\n\t        var x = offset.x;\n\t        var y = offset.y;\n\t        if (isFinite(y)) {\n\t            var line =  new Line(p2, p1);\n\t            var ref = line.parallel(y);\n\t            var start = ref.start;\n\t            var end = ref.end;\n\t            p2 = start;\n\t            p1 = end;\n\t        }\n\t        offset = x;\n\t    }\n\t    if (!isFinite(offset)) { return p1; }\n\t    var length = p1.distance(p2);\n\t    if (offset === 0 && length > 0) { return p1; }\n\t    return p1.move(p2, -Math.min(offset, length - 1));\n\t}\n\n\tfunction stroke$1(magnet) {\n\n\t    var stroke = magnet.getAttribute('stroke-width');\n\t    if (stroke === null) { return 0; }\n\t    return parseFloat(stroke) || 0;\n\t}\n\n\tfunction alignLine(line, type, offset) {\n\t    if ( offset === void 0 ) offset = 0;\n\n\t    var coordinate, a, b, direction;\n\t    var start = line.start;\n\t    var end = line.end;\n\t    switch (type) {\n\t        case 'left':\n\t            coordinate = 'x';\n\t            a = end;\n\t            b = start;\n\t            direction = -1;\n\t            break;\n\t        case 'right':\n\t            coordinate = 'x';\n\t            a = start;\n\t            b = end;\n\t            direction = 1;\n\t            break;\n\t        case 'top':\n\t            coordinate = 'y';\n\t            a = end;\n\t            b = start;\n\t            direction = -1;\n\t            break;\n\t        case 'bottom':\n\t            coordinate = 'y';\n\t            a = start;\n\t            b = end;\n\t            direction = 1;\n\t            break;\n\t        default:\n\t            return;\n\t    }\n\t    if (start[coordinate] < end[coordinate]) {\n\t        a[coordinate] = b[coordinate];\n\t    } else {\n\t        b[coordinate] = a[coordinate];\n\t    }\n\t    if (isFinite(offset)) {\n\t        a[coordinate] += direction * offset;\n\t        b[coordinate] += direction * offset;\n\t    }\n\t}\n\n\t// Connection Points\n\n\tfunction anchorConnectionPoint(line, _view, _magnet, opt) {\n\t    var offset = opt.offset;\n\t    var alignOffset = opt.alignOffset;\n\t    var align = opt.align;\n\t    if (align) { alignLine(line, align, alignOffset); }\n\t    return offsetPoint(line.end, line.start, offset);\n\t}\n\n\tfunction bboxIntersection(line, view, magnet, opt) {\n\n\t    var bbox = view.getNodeBBox(magnet);\n\t    if (opt.stroke) { bbox.inflate(stroke$1(magnet) / 2); }\n\t    var intersections = line.intersect(bbox);\n\t    var cp = (intersections)\n\t        ? line.start.chooseClosest(intersections)\n\t        : line.end;\n\t    return offsetPoint(cp, line.start, opt.offset);\n\t}\n\n\tfunction rectangleIntersection(line, view, magnet, opt) {\n\n\t    var angle = view.model.angle();\n\t    if (angle === 0) {\n\t        return bboxIntersection(line, view, magnet, opt);\n\t    }\n\n\t    var bboxWORotation = view.getNodeUnrotatedBBox(magnet);\n\t    if (opt.stroke) { bboxWORotation.inflate(stroke$1(magnet) / 2); }\n\t    var center = bboxWORotation.center();\n\t    var lineWORotation = line.clone().rotate(center, angle);\n\t    var intersections = lineWORotation.setLength(1e6).intersect(bboxWORotation);\n\t    var cp = (intersections)\n\t        ? lineWORotation.start.chooseClosest(intersections).rotate(center, -angle)\n\t        : line.end;\n\t    return offsetPoint(cp, line.start, opt.offset);\n\t}\n\n\tfunction findShapeNode(magnet) {\n\t    if (!magnet) { return null; }\n\t    var node = magnet;\n\t    do {\n\t        var tagName = node.tagName;\n\t        if (typeof tagName !== 'string') { return null; }\n\t        tagName = tagName.toUpperCase();\n\t        if (tagName === 'G') {\n\t            node = node.firstElementChild;\n\t        } else if (tagName === 'TITLE') {\n\t            node = node.nextElementSibling;\n\t        } else { break; }\n\t    } while (node);\n\t    return node;\n\t}\n\n\tvar BNDR_SUBDIVISIONS = 'segmentSubdivisons';\n\tvar BNDR_SHAPE_BBOX = 'shapeBBox';\n\n\tfunction boundaryIntersection(line, view, magnet, opt) {\n\n\t    var node, intersection;\n\t    var selector = opt.selector;\n\t    var anchor = line.end;\n\n\t    if (typeof selector === 'string') {\n\t        node = view.findBySelector(selector)[0];\n\t    } else if (Array.isArray(selector)) {\n\t        node = getByPath(magnet, selector);\n\t    } else {\n\t        node = findShapeNode(magnet);\n\t    }\n\n\t    if (!V.isSVGGraphicsElement(node)) {\n\t        if (node === magnet || !V.isSVGGraphicsElement(magnet)) { return anchor; }\n\t        node = magnet;\n\t    }\n\n\t    var localShape = view.getNodeShape(node);\n\t    var magnetMatrix = view.getNodeMatrix(node);\n\t    var translateMatrix = view.getRootTranslateMatrix();\n\t    var rotateMatrix = view.getRootRotateMatrix();\n\t    var targetMatrix = translateMatrix.multiply(rotateMatrix).multiply(magnetMatrix);\n\t    var localMatrix = targetMatrix.inverse();\n\t    var localLine = V.transformLine(line, localMatrix);\n\t    var localRef = localLine.start.clone();\n\t    var data = view.getNodeData(node);\n\n\t    if (opt.insideout === false) {\n\t        if (!data[BNDR_SHAPE_BBOX]) { data[BNDR_SHAPE_BBOX] = localShape.bbox(); }\n\t        var localBBox = data[BNDR_SHAPE_BBOX];\n\t        if (localBBox.containsPoint(localRef)) { return anchor; }\n\t    }\n\n\t    // Caching segment subdivisions for paths\n\t    var pathOpt;\n\t    if (localShape instanceof Path) {\n\t        var precision = opt.precision || 2;\n\t        if (!data[BNDR_SUBDIVISIONS]) { data[BNDR_SUBDIVISIONS] = localShape.getSegmentSubdivisions({ precision: precision }); }\n\t        pathOpt = {\n\t            precision: precision,\n\t            segmentSubdivisions: data[BNDR_SUBDIVISIONS]\n\t        };\n\t    }\n\n\t    if (opt.extrapolate === true) { localLine.setLength(1e6); }\n\n\t    intersection = localLine.intersect(localShape, pathOpt);\n\t    if (intersection) {\n\t        // More than one intersection\n\t        if (V.isArray(intersection)) { intersection = localRef.chooseClosest(intersection); }\n\t    } else if (opt.sticky === true) {\n\t        // No intersection, find the closest point instead\n\t        if (localShape instanceof Rect) {\n\t            intersection = localShape.pointNearestToPoint(localRef);\n\t        } else if (localShape instanceof Ellipse) {\n\t            intersection = localShape.intersectionWithLineFromCenterToPoint(localRef);\n\t        } else {\n\t            intersection = localShape.closestPoint(localRef, pathOpt);\n\t        }\n\t    }\n\n\t    var cp = (intersection) ? V.transformPoint(intersection, targetMatrix) : anchor;\n\t    var cpOffset = opt.offset || 0;\n\t    if (opt.stroke) { cpOffset += stroke$1(node) / 2; }\n\n\t    return offsetPoint(cp, line.start, cpOffset);\n\t}\n\n\tvar anchor = anchorConnectionPoint;\n\tvar bbox = bboxIntersection;\n\tvar rectangle = rectangleIntersection;\n\tvar boundary = boundaryIntersection;\n\n\tvar connectionPoints = ({\n\t\tanchor: anchor,\n\t\tbbox: bbox,\n\t\trectangle: rectangle,\n\t\tboundary: boundary\n\t});\n\n\tfunction bboxWrapper(method) {\n\n\t    return function(view, magnet, ref, opt) {\n\n\t        var rotate = !!opt.rotate;\n\t        var bbox = (rotate) ? view.getNodeUnrotatedBBox(magnet) : view.getNodeBBox(magnet);\n\t        var anchor = bbox[method]();\n\n\t        var dx = opt.dx;\n\t        if (dx) {\n\t            var dxPercentage = isPercentage(dx);\n\t            dx = parseFloat(dx);\n\t            if (isFinite(dx)) {\n\t                if (dxPercentage) {\n\t                    dx /= 100;\n\t                    dx *= bbox.width;\n\t                }\n\t                anchor.x += dx;\n\t            }\n\t        }\n\n\t        var dy = opt.dy;\n\t        if (dy) {\n\t            var dyPercentage = isPercentage(dy);\n\t            dy = parseFloat(dy);\n\t            if (isFinite(dy)) {\n\t                if (dyPercentage) {\n\t                    dy /= 100;\n\t                    dy *= bbox.height;\n\t                }\n\t                anchor.y += dy;\n\t            }\n\t        }\n\n\t        return (rotate) ? anchor.rotate(view.model.getBBox().center(), -view.model.angle()) : anchor;\n\t    };\n\t}\n\n\tfunction _perpendicular(view, magnet, refPoint, opt) {\n\n\t    var angle = view.model.angle();\n\t    var bbox = view.getNodeBBox(magnet);\n\t    var anchor = bbox.center();\n\t    var topLeft = bbox.origin();\n\t    var bottomRight = bbox.corner();\n\n\t    var padding = opt.padding;\n\t    if (!isFinite(padding)) { padding = 0; }\n\n\t    if ((topLeft.y + padding) <= refPoint.y && refPoint.y <= (bottomRight.y - padding)) {\n\t        var dy = (refPoint.y - anchor.y);\n\t        anchor.x += (angle === 0 || angle === 180) ? 0 : dy * 1 / Math.tan(toRad(angle));\n\t        anchor.y += dy;\n\t    } else if ((topLeft.x + padding) <= refPoint.x && refPoint.x <= (bottomRight.x - padding)) {\n\t        var dx = (refPoint.x - anchor.x);\n\t        anchor.y += (angle === 90 || angle === 270) ? 0 : dx * Math.tan(toRad(angle));\n\t        anchor.x += dx;\n\t    }\n\n\t    return anchor;\n\t}\n\n\tfunction _midSide(view, magnet, refPoint, opt) {\n\n\t    var rotate = !!opt.rotate;\n\t    var bbox, angle, center;\n\t    if (rotate) {\n\t        bbox = view.getNodeUnrotatedBBox(magnet);\n\t        center = view.model.getBBox().center();\n\t        angle = view.model.angle();\n\t    } else {\n\t        bbox = view.getNodeBBox(magnet);\n\t    }\n\n\t    var padding = opt.padding;\n\t    if (isFinite(padding)) { bbox.inflate(padding); }\n\n\t    if (rotate) { refPoint.rotate(center, angle); }\n\n\t    var side = bbox.sideNearestToPoint(refPoint);\n\t    var anchor;\n\t    switch (side) {\n\t        case 'left':\n\t            anchor = bbox.leftMiddle();\n\t            break;\n\t        case 'right':\n\t            anchor = bbox.rightMiddle();\n\t            break;\n\t        case 'top':\n\t            anchor = bbox.topMiddle();\n\t            break;\n\t        case 'bottom':\n\t            anchor = bbox.bottomMiddle();\n\t            break;\n\t    }\n\n\t    return (rotate) ? anchor.rotate(center, -angle) : anchor;\n\t}\n\n\t// Can find anchor from model, when there is no selector or the link end\n\t// is connected to a port\n\tfunction _modelCenter(view, _magnet, _refPoint, opt, endType) {\n\t    return view.model.getPointFromConnectedLink(this.model, endType).offset(opt.dx, opt.dy);\n\t}\n\n\t//joint.anchors\n\tvar center = bboxWrapper('center');\n\tvar top$2 = bboxWrapper('topMiddle');\n\tvar bottom$2 = bboxWrapper('bottomMiddle');\n\tvar left$2 = bboxWrapper('leftMiddle');\n\tvar right$2 = bboxWrapper('rightMiddle');\n\tvar topLeft = bboxWrapper('origin');\n\tvar topRight = bboxWrapper('topRight');\n\tvar bottomLeft = bboxWrapper('bottomLeft');\n\tvar bottomRight = bboxWrapper('corner');\n\tvar perpendicular = resolveRef(_perpendicular);\n\tvar midSide = resolveRef(_midSide);\n\tvar modelCenter = _modelCenter;\n\n\tvar anchors = ({\n\t\tcenter: center,\n\t\ttop: top$2,\n\t\tbottom: bottom$2,\n\t\tleft: left$2,\n\t\tright: right$2,\n\t\ttopLeft: topLeft,\n\t\ttopRight: topRight,\n\t\tbottomLeft: bottomLeft,\n\t\tbottomRight: bottomRight,\n\t\tperpendicular: perpendicular,\n\t\tmidSide: midSide,\n\t\tmodelCenter: modelCenter\n\t});\n\n\tvar sortingTypes = {\n\t    NONE: 'sorting-none',\n\t    APPROX: 'sorting-approximate',\n\t    EXACT: 'sorting-exact'\n\t};\n\n\tvar MOUNT_BATCH_SIZE = 1000;\n\tvar UPDATE_BATCH_SIZE = Infinity;\n\tvar MIN_PRIORITY = 9007199254740991; // Number.MAX_SAFE_INTEGER\n\n\tvar HighlightingTypes$1 = CellView.Highlighting;\n\n\tvar defaultHighlighting = {};\n\tdefaultHighlighting[HighlightingTypes$1.DEFAULT] = {\n\t        name: 'stroke',\n\t        options: {\n\t            padding: 3\n\t        }\n\t    };\n\tdefaultHighlighting[HighlightingTypes$1.MAGNET_AVAILABILITY] = {\n\t        name: 'addClass',\n\t        options: {\n\t            className: 'available-magnet'\n\t        }\n\t    };\n\tdefaultHighlighting[HighlightingTypes$1.ELEMENT_AVAILABILITY] = {\n\t        name: 'addClass',\n\t        options: {\n\t            className: 'available-cell'\n\t        }\n\t    };\n\n\tvar defaultLayers = [{\n\t    name: LayersNames.BACK,\n\t}, {\n\t    name: LayersNames.CELLS,\n\t}, {\n\t    name: LayersNames.LABELS,\n\t}, {\n\t    name: LayersNames.FRONT\n\t}, {\n\t    name: LayersNames.TOOLS\n\t}];\n\n\tvar Paper = View.extend({\n\n\t    className: 'paper',\n\n\t    options: {\n\n\t        width: 800,\n\t        height: 600,\n\t        origin: { x: 0, y: 0 }, // x,y coordinates in top-left corner\n\t        gridSize: 1,\n\n\t        // Whether or not to draw the grid lines on the paper's DOM element.\n\t        // e.g drawGrid: true, drawGrid: { color: 'red', thickness: 2 }\n\t        drawGrid: false,\n\n\t        // Whether or not to draw the background on the paper's DOM element.\n\t        // e.g. background: { color: 'lightblue', image: '/paper-background.png', repeat: 'flip-xy' }\n\t        background: false,\n\n\t        perpendicularLinks: false,\n\t        elementView: ElementView,\n\t        linkView: LinkView,\n\t        snapLabels: false, // false, true\n\t        snapLinks: false, // false, true, { radius: value }\n\n\t        // Should the link labels be rendered into its own layer?\n\t        // `false` - the labels are part of the links\n\t        // `true` - the labels are appended to LayersName.LABELS\n\t        // [LayersName] - the labels are appended to the layer specified\n\t        labelsLayer: false,\n\n\t        // When set to FALSE, an element may not have more than 1 link with the same source and target element.\n\t        multiLinks: true,\n\n\t        // For adding custom guard logic.\n\t        guard: function(evt, view) {\n\n\t            // FALSE means the event isn't guarded.\n\t            return false;\n\t        },\n\n\t        highlighting: defaultHighlighting,\n\n\t        // Prevent the default context menu from being displayed.\n\t        preventContextMenu: true,\n\n\t        // Prevent the default action for blank:pointer<action>.\n\t        preventDefaultBlankAction: true,\n\n\t        // Restrict the translation of elements by given bounding box.\n\t        // Option accepts a boolean:\n\t        //  true - the translation is restricted to the paper area\n\t        //  false - no restrictions\n\t        // A method:\n\t        // restrictTranslate: function(elementView) {\n\t        //     var parentId = elementView.model.get('parent');\n\t        //     return parentId && this.model.getCell(parentId).getBBox();\n\t        // },\n\t        // Or a bounding box:\n\t        // restrictTranslate: { x: 10, y: 10, width: 790, height: 590 }\n\t        restrictTranslate: false,\n\n\t        // Marks all available magnets with 'available-magnet' class name and all available cells with\n\t        // 'available-cell' class name. Marks them when dragging a link is started and unmark\n\t        // when the dragging is stopped.\n\t        markAvailable: false,\n\n\t        // Defines what link model is added to the graph after an user clicks on an active magnet.\n\t        // Value could be the Backbone.model or a function returning the Backbone.model\n\t        // defaultLink: function(elementView, magnet) { return condition ? new customLink1() : new customLink2() }\n\t        defaultLink: new Link,\n\n\t        // A connector that is used by links with no connector defined on the model.\n\t        // e.g. { name: 'rounded', args: { radius: 5 }} or a function\n\t        defaultConnector: { name: 'normal' },\n\n\t        // A router that is used by links with no router defined on the model.\n\t        // e.g. { name: 'oneSide', args: { padding: 10 }} or a function\n\t        defaultRouter: { name: 'normal' },\n\n\t        defaultAnchor: { name: 'center' },\n\n\t        defaultLinkAnchor: { name: 'connectionRatio' },\n\n\t        defaultConnectionPoint: { name: 'bbox' },\n\n\t        /* CONNECTING */\n\n\t        connectionStrategy: null,\n\n\t        // Check whether to add a new link to the graph when user clicks on an a magnet.\n\t        validateMagnet: function(_cellView, magnet, _evt) {\n\t            return magnet.getAttribute('magnet') !== 'passive';\n\t        },\n\n\t        // Check whether to allow or disallow the link connection while an arrowhead end (source/target)\n\t        // being changed.\n\t        validateConnection: function(cellViewS, _magnetS, cellViewT, _magnetT, end, _linkView) {\n\t            return (end === 'target' ? cellViewT : cellViewS) instanceof ElementView;\n\t        },\n\n\t        /* EMBEDDING */\n\n\t        // Enables embedding. Re-parent the dragged element with elements under it and makes sure that\n\t        // all links and elements are visible taken the level of embedding into account.\n\t        embeddingMode: false,\n\n\t        // Check whether to allow or disallow the element embedding while an element being translated.\n\t        validateEmbedding: function(childView, parentView) {\n\t            // by default all elements can be in relation child-parent\n\t            return true;\n\t        },\n\n\t        // Check whether to allow or disallow an embedded element to be unembedded / to become a root.\n\t        validateUnembedding: function(childView) {\n\t            // by default all elements can become roots\n\t            return true;\n\t        },\n\n\t        // Determines the way how a cell finds a suitable parent when it's dragged over the paper.\n\t        // The cell with the highest z-index (visually on the top) will be chosen.\n\t        findParentBy: 'bbox', // 'bbox'|'center'|'origin'|'corner'|'topRight'|'bottomLeft'\n\n\t        // If enabled only the element on the very front is taken into account for the embedding.\n\t        // If disabled the elements under the dragged view are tested one by one\n\t        // (from front to back) until a valid parent found.\n\t        frontParentOnly: true,\n\n\t        // Interactive flags. See online docs for the complete list of interactive flags.\n\t        interactive: {\n\t            labelMove: false\n\t        },\n\n\t        // When set to true the links can be pinned to the paper.\n\t        // i.e. link source/target can be a point e.g. link.get('source') ==> { x: 100, y: 100 };\n\t        linkPinning: true,\n\n\t        // Custom validation after an interaction with a link ends.\n\t        // Recognizes a function. If `false` is returned, the link is disallowed (removed or reverted)\n\t        // (linkView, paper) => boolean\n\t        allowLink: null,\n\n\t        // Allowed number of mousemove events after which the pointerclick event will be still triggered.\n\t        clickThreshold: 0,\n\n\t        // Number of required mousemove events before the first pointermove event will be triggered.\n\t        moveThreshold: 0,\n\n\t        // Number of required mousemove events before the a link is created out of the magnet.\n\t        // Or string `onleave` so the link is created when the pointer leaves the magnet\n\t        magnetThreshold: 0,\n\n\t        // Rendering Options\n\n\t        sorting: sortingTypes.EXACT,\n\n\t        frozen: false,\n\n\t        // no docs yet\n\t        onViewUpdate: function(view, flag, priority, opt, paper) {\n\t            // Do not update connected links when:\n\t            // 1. the view was just inserted (added to the graph and rendered)\n\t            // 2. the view was just mounted (added back to the paper by viewport function)\n\t            // 3. the change was marked as `isolate`.\n\t            // 4. the view model was just removed from the graph\n\t            if ((flag & (view.FLAG_INSERT | view.FLAG_REMOVE)) || opt.mounting || opt.isolate) { return; }\n\t            paper.requestConnectedLinksUpdate(view, priority, opt);\n\t        },\n\n\t        // no docs yet\n\t        onViewPostponed: function(view, flag, paper) {\n\t            return paper.forcePostponedViewUpdate(view, flag);\n\t        },\n\n\t        beforeRender: null, // function(opt, paper) { },\n\n\t        afterRender: null, // function(stats, opt, paper) {\n\n\t        viewport: null,\n\n\t        // Default namespaces\n\n\t        cellViewNamespace: null,\n\n\t        routerNamespace: null,\n\n\t        connectorNamespace: null,\n\n\t        highlighterNamespace: highlighters,\n\n\t        anchorNamespace: anchors,\n\n\t        linkAnchorNamespace: linkAnchors,\n\n\t        connectionPointNamespace: connectionPoints\n\t    },\n\n\t    events: {\n\t        'dblclick': 'pointerdblclick',\n\t        'contextmenu': 'contextmenu',\n\t        'mousedown': 'pointerdown',\n\t        'touchstart': 'pointerdown',\n\t        'mouseover': 'mouseover',\n\t        'mouseout': 'mouseout',\n\t        'mouseenter': 'mouseenter',\n\t        'mouseleave': 'mouseleave',\n\t        'wheel': 'mousewheel',\n\t        'mouseenter .joint-cell': 'mouseenter',\n\t        'mouseleave .joint-cell': 'mouseleave',\n\t        'mouseenter .joint-tools': 'mouseenter',\n\t        'mouseleave .joint-tools': 'mouseleave',\n\t        'mousedown .joint-cell [event]': 'onevent', // interaction with cell with `event` attribute set\n\t        'touchstart .joint-cell [event]': 'onevent',\n\t        'mousedown .joint-cell [magnet]': 'onmagnet', // interaction with cell with `magnet` attribute set\n\t        'touchstart .joint-cell [magnet]': 'onmagnet',\n\t        'dblclick .joint-cell [magnet]': 'magnetpointerdblclick',\n\t        'contextmenu .joint-cell [magnet]': 'magnetcontextmenu',\n\t        'mousedown .joint-link .label': 'onlabel', // interaction with link label\n\t        'touchstart .joint-link .label': 'onlabel',\n\t        'dragstart .joint-cell image': 'onImageDragStart' // firefox fix\n\t    },\n\n\t    documentEvents: {\n\t        'mousemove': 'pointermove',\n\t        'touchmove': 'pointermove',\n\t        'mouseup': 'pointerup',\n\t        'touchend': 'pointerup',\n\t        'touchcancel': 'pointerup'\n\t    },\n\n\t    svg: null,\n\t    viewport: null,\n\t    defs: null,\n\t    tools: null,\n\t    $background: null,\n\t    layers: null,\n\t    $grid: null,\n\t    $document: null,\n\n\t    // For storing the current transformation matrix (CTM) of the paper's viewport.\n\t    _viewportMatrix: null,\n\t    // For verifying whether the CTM is up-to-date. The viewport transform attribute\n\t    // could have been manipulated directly.\n\t    _viewportTransformString: null,\n\t    // Updates data (priorities, unmounted views etc.)\n\t    _updates: null,\n\t    // Paper Layers\n\t    _layers: null,\n\n\t    SORT_DELAYING_BATCHES: ['add', 'to-front', 'to-back'],\n\t    UPDATE_DELAYING_BATCHES: ['translate'],\n\t    MIN_SCALE: 1e-6,\n\n\t    init: function() {\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var el = ref.el;\n\t        if (!options.cellViewNamespace) {\n\t            /* eslint-disable no-undef */\n\t            options.cellViewNamespace = typeof joint !== 'undefined' && has$2(joint, 'shapes') ? joint.shapes : null;\n\t            /* eslint-enable no-undef */\n\t        }\n\n\t        var model = this.model = options.model || new Graph;\n\n\t        // Layers (SVGGroups)\n\t        this._layers = {};\n\n\t        this.setGrid(options.drawGrid);\n\t        this.cloneOptions();\n\t        this.render();\n\t        this._setDimensions();\n\t        this.startListening();\n\n\t        // Hash of all cell views.\n\t        this._views = {};\n\n\t        // Reference to the paper owner document\n\t        this.$document = $(el.ownerDocument);\n\t        // Render existing cells in the graph\n\t        this.resetViews(model.attributes.cells.models);\n\t        // Start the Rendering Loop\n\t        if (!this.isFrozen() && this.isAsync()) { this.updateViewsAsync(); }\n\t    },\n\n\t    _resetUpdates: function() {\n\t        return this._updates = {\n\t            id: null,\n\t            priorities: [{}, {}, {}],\n\t            unmountedCids: [],\n\t            mountedCids: [],\n\t            unmounted: {},\n\t            mounted: {},\n\t            count: 0,\n\t            keyFrozen: false,\n\t            freezeKey: null,\n\t            sort: false\n\t        };\n\t    },\n\n\t    startListening: function() {\n\t        var model = this.model;\n\t        this.listenTo(model, 'add', this.onCellAdded)\n\t            .listenTo(model, 'remove', this.onCellRemoved)\n\t            .listenTo(model, 'change', this.onCellChange)\n\t            .listenTo(model, 'reset', this.onGraphReset)\n\t            .listenTo(model, 'sort', this.onGraphSort)\n\t            .listenTo(model, 'batch:stop', this.onGraphBatchStop);\n\t        this.on('cell:highlight', this.onCellHighlight)\n\t            .on('cell:unhighlight', this.onCellUnhighlight)\n\t            .on('scale translate', this.update);\n\t    },\n\n\t    onCellAdded: function(cell, _, opt) {\n\t        var position = opt.position;\n\t        if (this.isAsync() || !isNumber(position)) {\n\t            this.renderView(cell, opt);\n\t        } else {\n\t            if (opt.maxPosition === position) { this.freeze({ key: 'addCells' }); }\n\t            this.renderView(cell, opt);\n\t            if (position === 0) { this.unfreeze({ key: 'addCells' }); }\n\t        }\n\t    },\n\n\t    onCellRemoved: function(cell, _, opt) {\n\t        var view = this.findViewByModel(cell);\n\t        if (view) { this.requestViewUpdate(view, view.FLAG_REMOVE, view.UPDATE_PRIORITY, opt); }\n\t    },\n\n\t    onCellChange: function(cell, opt) {\n\t        if (cell === this.model.attributes.cells) { return; }\n\t        if (cell.hasChanged('z') && this.options.sorting === sortingTypes.APPROX) {\n\t            var view = this.findViewByModel(cell);\n\t            if (view) { this.requestViewUpdate(view, view.FLAG_INSERT, view.UPDATE_PRIORITY, opt); }\n\t        }\n\t    },\n\n\t    onGraphReset: function(collection, opt) {\n\t        this.resetLayers();\n\t        this.resetViews(collection.models, opt);\n\t    },\n\n\t    onGraphSort: function() {\n\t        if (this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)) { return; }\n\t        this.sortViews();\n\t    },\n\n\t    onGraphBatchStop: function(data) {\n\t        if (this.isFrozen()) { return; }\n\t        var name = data && data.batchName;\n\t        var graph = this.model;\n\t        if (!this.isAsync()) {\n\t            var updateDelayingBatches = this.UPDATE_DELAYING_BATCHES;\n\t            if (updateDelayingBatches.includes(name) && !graph.hasActiveBatch(updateDelayingBatches)) {\n\t                this.updateViews(data);\n\t            }\n\t        }\n\t        var sortDelayingBatches = this.SORT_DELAYING_BATCHES;\n\t        if (sortDelayingBatches.includes(name) && !graph.hasActiveBatch(sortDelayingBatches)) {\n\t            this.sortViews();\n\t        }\n\t    },\n\n\t    cloneOptions: function() {\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var defaultConnector = options.defaultConnector;\n\t        var defaultRouter = options.defaultRouter;\n\t        var defaultConnectionPoint = options.defaultConnectionPoint;\n\t        var defaultAnchor = options.defaultAnchor;\n\t        var defaultLinkAnchor = options.defaultLinkAnchor;\n\t        var origin = options.origin;\n\t        var highlighting = options.highlighting;\n\t        var cellViewNamespace = options.cellViewNamespace;\n\t        var interactive = options.interactive;\n\n\t        // Default cellView namespace for ES5\n\t        /* eslint-disable no-undef */\n\t        if (!cellViewNamespace && typeof joint !== 'undefined' && has$2(joint, 'shapes')) {\n\t            options.cellViewNamespace = joint.shapes;\n\t        }\n\t        /* eslint-enable no-undef */\n\n\t        // Here if a function was provided, we can not clone it, as this would result in loosing the function.\n\t        // If the default is used, the cloning is necessary in order to prevent modifying the options on prototype.\n\t        if (!isFunction(defaultConnector)) {\n\t            options.defaultConnector = cloneDeep(defaultConnector);\n\t        }\n\t        if (!isFunction(defaultRouter)) {\n\t            options.defaultRouter = cloneDeep(defaultRouter);\n\t        }\n\t        if (!isFunction(defaultConnectionPoint)) {\n\t            options.defaultConnectionPoint = cloneDeep(defaultConnectionPoint);\n\t        }\n\t        if (!isFunction(defaultAnchor)) {\n\t            options.defaultAnchor = cloneDeep(defaultAnchor);\n\t        }\n\t        if (!isFunction(defaultLinkAnchor)) {\n\t            options.defaultLinkAnchor = cloneDeep(defaultLinkAnchor);\n\t        }\n\t        if (isPlainObject(interactive)) {\n\t            options.interactive = assign({}, interactive);\n\t        }\n\t        if (isPlainObject(highlighting)) {\n\t            // Return the default highlighting options into the user specified options.\n\t            options.highlighting = defaultsDeep({}, highlighting, defaultHighlighting);\n\t        }\n\t        options.origin = assign({}, origin);\n\t    },\n\n\t    children: function() {\n\t        var ns = V.namespace;\n\t        return [{\n\t            namespaceURI: ns.xhtml,\n\t            tagName: 'div',\n\t            className: addClassNamePrefix('paper-background'),\n\t            selector: 'background'\n\t        }, {\n\t            namespaceURI: ns.xhtml,\n\t            tagName: 'div',\n\t            className: addClassNamePrefix('paper-grid'),\n\t            selector: 'grid'\n\t        }, {\n\t            namespaceURI: ns.svg,\n\t            tagName: 'svg',\n\t            attributes: {\n\t                'width': '100%',\n\t                'height': '100%',\n\t                'xmlns:xlink': ns.xlink\n\t            },\n\t            selector: 'svg',\n\t            children: [{\n\t                // Append `<defs>` element to the SVG document. This is useful for filters and gradients.\n\t                // It's desired to have the defs defined before the viewport (e.g. to make a PDF document pick up defs properly).\n\t                tagName: 'defs',\n\t                selector: 'defs'\n\t            }, {\n\t                tagName: 'g',\n\t                className: addClassNamePrefix('layers'),\n\t                selector: 'layers'\n\t            }]\n\t        }];\n\t    },\n\n\t    hasLayerView: function hasLayerView(layerName) {\n\t        return  (layerName in this._layers);\n\t    },\n\n\t    getLayerView: function getLayerView(layerName) {\n\t        var ref = this;\n\t        var _layers = ref._layers;\n\t        if (layerName in _layers) { return _layers[layerName]; }\n\t        throw new Error((\"dia.Paper: Unknown layer \\\"\" + layerName + \"\\\"\"));\n\t    },\n\n\t    getLayerNode: function getLayerNode(layerName) {\n\t        return this.getLayerView(layerName).el;\n\t    },\n\n\t    render: function() {\n\n\t        this.renderChildren();\n\t        var ref = this;\n\t        var childNodes = ref.childNodes;\n\t        var options = ref.options;\n\t        var svg = childNodes.svg;\n\t        var defs = childNodes.defs;\n\t        var layers = childNodes.layers;\n\t        var background = childNodes.background;\n\t        var grid = childNodes.grid;\n\n\t        this.svg = svg;\n\t        this.defs = defs;\n\t        this.layers = layers;\n\t        this.$background = $(background);\n\t        this.$grid = $(grid);\n\n\t        this.renderLayers();\n\n\t        V.ensureId(svg);\n\n\t        if (options.background) {\n\t            this.drawBackground(options.background);\n\t        }\n\n\t        if (options.drawGrid) {\n\t            this.drawGrid();\n\t        }\n\n\t        return this;\n\t    },\n\n\t    renderLayers: function(layers) {\n\t        var this$1 = this;\n\t        if ( layers === void 0 ) layers = defaultLayers;\n\n\t        this.removeLayers();\n\t        // TODO: Layers to be read from the graph `layers` attribute\n\t        layers.forEach(function (ref) {\n\t            var name = ref.name;\n\t            var sorted = ref.sorted;\n\n\t            var layerView = new PaperLayer({ name: name });\n\t            this$1.layers.appendChild(layerView.el);\n\t            this$1._layers[name] = layerView;\n\t        });\n\t        // Throws an exception if doesn't exist\n\t        var cellsLayerView = this.getLayerView(LayersNames.CELLS);\n\t        var toolsLayerView = this.getLayerView(LayersNames.TOOLS);\n\t        var labelsLayerView = this.getLayerView(LayersNames.LABELS);\n\t        // backwards compatibility\n\t        this.tools = toolsLayerView.el;\n\t        this.cells = this.viewport = cellsLayerView.el;\n\t        // user-select: none;\n\t        cellsLayerView.vel.addClass(addClassNamePrefix('viewport'));\n\t        labelsLayerView.vel.addClass(addClassNamePrefix('viewport'));\n\t    },\n\n\t    removeLayers: function() {\n\t        var ref = this;\n\t        var _layers = ref._layers;\n\t        Object.keys(_layers, function (name) {\n\t            _layers[name].remove();\n\t            delete _layers[name];\n\t        });\n\t    },\n\n\t    resetLayers: function() {\n\t        var ref = this;\n\t        var _layers = ref._layers;\n\t        Object.keys(_layers, function (name) {\n\t            _layers[name].removePivots();\n\t        });\n\t    },\n\n\t    update: function() {\n\n\t        if (this.options.drawGrid) {\n\t            this.drawGrid();\n\t        }\n\n\t        if (this._background) {\n\t            this.updateBackgroundImage(this._background);\n\t        }\n\n\t        return this;\n\t    },\n\n\t    matrix: function(ctm) {\n\n\t        var viewport = this.layers;\n\n\t        // Getter:\n\t        if (ctm === undefined) {\n\n\t            var transformString = viewport.getAttribute('transform');\n\n\t            if ((this._viewportTransformString || null) === transformString) {\n\t                // It's ok to return the cached matrix. The transform attribute has not changed since\n\t                // the matrix was stored.\n\t                ctm = this._viewportMatrix;\n\t            } else {\n\t                // The viewport transform attribute has changed. Measure the matrix and cache again.\n\t                ctm = viewport.getCTM();\n\t                this._viewportMatrix = ctm;\n\t                this._viewportTransformString = transformString;\n\t            }\n\n\t            // Clone the cached current transformation matrix.\n\t            // If no matrix previously stored the identity matrix is returned.\n\t            return V.createSVGMatrix(ctm);\n\t        }\n\n\t        // Setter:\n\t        ctm = V.createSVGMatrix(ctm);\n\t        var ctmString = V.matrixToTransformString(ctm);\n\t        viewport.setAttribute('transform', ctmString);\n\n\t        this._viewportMatrix = ctm;\n\t        this._viewportTransformString = viewport.getAttribute('transform');\n\n\t        return this;\n\t    },\n\n\t    clientMatrix: function() {\n\n\t        return V.createSVGMatrix(this.cells.getScreenCTM());\n\t    },\n\n\t    requestConnectedLinksUpdate: function(view, priority, opt) {\n\t        if (view instanceof CellView) {\n\t            var model = view.model;\n\t            var links = this.model.getConnectedLinks(model);\n\t            for (var j = 0, n = links.length; j < n; j++) {\n\t                var link = links[j];\n\t                var linkView = this.findViewByModel(link);\n\t                if (!linkView) { continue; }\n\t                var flagLabels = ['UPDATE'];\n\t                if (link.getTargetCell() === model) { flagLabels.push('TARGET'); }\n\t                if (link.getSourceCell() === model) { flagLabels.push('SOURCE'); }\n\t                var nextPriority = Math.max(priority + 1, linkView.UPDATE_PRIORITY);\n\t                this.scheduleViewUpdate(linkView, linkView.getFlag(flagLabels), nextPriority, opt);\n\t            }\n\t        }\n\t    },\n\n\t    forcePostponedViewUpdate: function(view, flag) {\n\t        if (!view || !(view instanceof CellView)) { return false; }\n\t        var model = view.model;\n\t        if (model.isElement()) { return false; }\n\t        if ((flag & view.getFlag(['SOURCE', 'TARGET'])) === 0) {\n\t            // LinkView is waiting for the target or the source cellView to be rendered\n\t            // This can happen when the cells are not in the viewport.\n\t            var sourceFlag = 0;\n\t            var sourceView = this.findViewByModel(model.getSourceCell());\n\t            if (sourceView && !this.isViewMounted(sourceView)) {\n\t                sourceFlag = this.dumpView(sourceView);\n\t                view.updateEndMagnet('source');\n\t            }\n\t            var targetFlag = 0;\n\t            var targetView = this.findViewByModel(model.getTargetCell());\n\t            if (targetView && !this.isViewMounted(targetView)) {\n\t                targetFlag = this.dumpView(targetView);\n\t                view.updateEndMagnet('target');\n\t            }\n\t            if (sourceFlag === 0 && targetFlag === 0) {\n\t                // If leftover flag is 0, all view updates were done.\n\t                return !this.dumpView(view);\n\t            }\n\t        }\n\t        return false;\n\t    },\n\n\t    requestViewUpdate: function(view, flag, priority, opt) {\n\t        opt || (opt = {});\n\t        this.scheduleViewUpdate(view, flag, priority, opt);\n\t        var isAsync = this.isAsync();\n\t        if (this.isFrozen() || (isAsync && opt.async !== false)) { return; }\n\t        if (this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)) { return; }\n\t        var stats = this.updateViews(opt);\n\t        if (isAsync) { this.notifyAfterRender(stats, opt); }\n\t    },\n\n\t    scheduleViewUpdate: function(view, type, priority, opt) {\n\t        var ref = this;\n\t        var updates = ref._updates;\n\t        var options = ref.options;\n\t        var FLAG_REMOVE = view.FLAG_REMOVE;\n\t        var FLAG_INSERT = view.FLAG_INSERT;\n\t        var UPDATE_PRIORITY = view.UPDATE_PRIORITY;\n\t        var cid = view.cid;\n\t        var priorityUpdates = updates.priorities[priority];\n\t        if (!priorityUpdates) { priorityUpdates = updates.priorities[priority] = {}; }\n\t        // Move higher priority updates to this priority\n\t        if (priority > UPDATE_PRIORITY) {\n\t            // Not the default priority for this view. It's most likely a link view\n\t            // connected to another link view, which triggered the update.\n\t            // TODO: If there is an update scheduled with a lower priority already, we should\n\t            // change the requested priority to the lowest one. Does not seem to be critical\n\t            // right now, as it \"only\" results in multiple updates on the same view.\n\t            for (var i = priority - 1; i >= UPDATE_PRIORITY; i--) {\n\t                var prevPriorityUpdates = updates.priorities[i];\n\t                if (!prevPriorityUpdates || !(cid in prevPriorityUpdates)) { continue; }\n\t                priorityUpdates[cid] |= prevPriorityUpdates[cid];\n\t                delete prevPriorityUpdates[cid];\n\t            }\n\t        }\n\t        var currentType = priorityUpdates[cid] || 0;\n\t        // Prevent cycling\n\t        if ((currentType & type) === type) { return; }\n\t        if (!currentType) { updates.count++; }\n\t        if (type & FLAG_REMOVE && currentType & FLAG_INSERT) {\n\t            // When a view is removed we need to remove the insert flag as this is a reinsert\n\t            priorityUpdates[cid] ^= FLAG_INSERT;\n\t        } else if (type & FLAG_INSERT && currentType & FLAG_REMOVE) {\n\t            // When a view is added we need to remove the remove flag as this is view was previously removed\n\t            priorityUpdates[cid] ^= FLAG_REMOVE;\n\t        }\n\t        priorityUpdates[cid] |= type;\n\t        var viewUpdateFn = options.onViewUpdate;\n\t        if (typeof viewUpdateFn === 'function') { viewUpdateFn.call(this, view, type, priority, opt || {}, this); }\n\t    },\n\n\t    dumpViewUpdate: function(view) {\n\t        if (!view) { return 0; }\n\t        var updates = this._updates;\n\t        var cid = view.cid;\n\t        var priorityUpdates = updates.priorities[view.UPDATE_PRIORITY];\n\t        var flag = this.registerMountedView(view) | priorityUpdates[cid];\n\t        delete priorityUpdates[cid];\n\t        return flag;\n\t    },\n\n\t    dumpView: function(view, opt) {\n\t        var flag = this.dumpViewUpdate(view);\n\t        if (!flag) { return 0; }\n\t        return this.updateView(view, flag, opt);\n\t    },\n\n\t    updateView: function(view, flag, opt) {\n\t        if (!view) { return 0; }\n\t        var FLAG_REMOVE = view.FLAG_REMOVE;\n\t        var FLAG_INSERT = view.FLAG_INSERT;\n\t        var model = view.model;\n\t        if (view instanceof CellView) {\n\t            if (flag & FLAG_REMOVE) {\n\t                this.removeView(model);\n\t                return 0;\n\t            }\n\t            if (flag & FLAG_INSERT) {\n\t                this.insertView(view);\n\t                flag ^= FLAG_INSERT;\n\t            }\n\t        }\n\t        if (!flag) { return 0; }\n\t        return view.confirmUpdate(flag, opt || {});\n\t    },\n\n\t    requireView: function(model, opt) {\n\t        var view = this.findViewByModel(model);\n\t        if (!view) { return null; }\n\t        this.dumpView(view, opt);\n\t        return view;\n\t    },\n\n\t    registerUnmountedView: function(view) {\n\t        var cid = view.cid;\n\t        var updates = this._updates;\n\t        if (cid in updates.unmounted) { return 0; }\n\t        var flag = updates.unmounted[cid] |= view.FLAG_INSERT;\n\t        updates.unmountedCids.push(cid);\n\t        delete updates.mounted[cid];\n\t        return flag;\n\t    },\n\n\t    registerMountedView: function(view) {\n\t        var cid = view.cid;\n\t        var updates = this._updates;\n\t        if (cid in updates.mounted) { return 0; }\n\t        updates.mounted[cid] = true;\n\t        updates.mountedCids.push(cid);\n\t        var flag = updates.unmounted[cid] || 0;\n\t        delete updates.unmounted[cid];\n\t        return flag;\n\t    },\n\n\t    isViewMounted: function(view) {\n\t        if (!view) { return false; }\n\t        var cid = view.cid;\n\t        var updates = this._updates;\n\t        return (cid in updates.mounted);\n\t    },\n\n\t    dumpViews: function(opt) {\n\t        var passingOpt = defaults({}, opt, { viewport: null });\n\t        this.checkViewport(passingOpt);\n\t        this.updateViews(passingOpt);\n\t    },\n\n\t    // Synchronous views update\n\t    updateViews: function(opt) {\n\t        this.notifyBeforeRender(opt);\n\t        var batchStats;\n\t        var updateCount = 0;\n\t        var batchCount = 0;\n\t        var priority = MIN_PRIORITY;\n\t        do {\n\t            batchCount++;\n\t            batchStats = this.updateViewsBatch(opt);\n\t            updateCount += batchStats.updated;\n\t            priority = Math.min(batchStats.priority, priority);\n\t        } while (!batchStats.empty);\n\t        var stats = { updated: updateCount, batches: batchCount, priority: priority };\n\t        this.notifyAfterRender(stats, opt);\n\t        return stats;\n\t    },\n\n\t    hasScheduledUpdates: function() {\n\t        var priorities = this._updates.priorities;\n\t        var priorityIndexes = Object.keys(priorities); // convert priorities to a dense array\n\t        var i = priorityIndexes.length;\n\t        while (i > 0 && i--) {\n\t            // a faster way how to check if an object is empty\n\t            for (var _key in priorities[priorityIndexes[i]]) { return true; }\n\t        }\n\t        return false;\n\t    },\n\n\t    updateViewsAsync: function(opt, data) {\n\t        opt || (opt = {});\n\t        data || (data = { processed: 0, priority: MIN_PRIORITY });\n\t        var updates = this._updates;\n\t        var id = updates.id;\n\t        if (id) {\n\t            cancelFrame(id);\n\t            if (data.processed === 0 && this.hasScheduledUpdates()) {\n\t                this.notifyBeforeRender(opt);\n\t            }\n\t            var stats = this.updateViewsBatch(opt);\n\t            var passingOpt = defaults({}, opt, {\n\t                mountBatchSize: MOUNT_BATCH_SIZE - stats.mounted,\n\t                unmountBatchSize: MOUNT_BATCH_SIZE - stats.unmounted\n\t            });\n\t            var checkStats = this.checkViewport(passingOpt);\n\t            var unmountCount = checkStats.unmounted;\n\t            var mountCount = checkStats.mounted;\n\t            var processed = data.processed;\n\t            var total = updates.count;\n\t            if (stats.updated > 0) {\n\t                // Some updates have been just processed\n\t                processed += stats.updated + stats.unmounted;\n\t                stats.processed = processed;\n\t                data.priority = Math.min(stats.priority, data.priority);\n\t                if (stats.empty && mountCount === 0) {\n\t                    stats.unmounted += unmountCount;\n\t                    stats.mounted += mountCount;\n\t                    stats.priority = data.priority;\n\t                    this.notifyAfterRender(stats, opt);\n\t                    data.processed = 0;\n\t                    data.priority = MIN_PRIORITY;\n\t                    updates.count = 0;\n\t                } else {\n\t                    data.processed = processed;\n\t                }\n\t            }\n\t            // Progress callback\n\t            var progressFn = opt.progress;\n\t            if (total && typeof progressFn === 'function') {\n\t                progressFn.call(this, stats.empty, processed, total, stats, this);\n\t            }\n\t            // The current frame could have been canceled in a callback\n\t            if (updates.id !== id) { return; }\n\t        }\n\t        updates.id = nextFrame(this.updateViewsAsync, this, opt, data);\n\t    },\n\n\t    notifyBeforeRender: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        var beforeFn = opt.beforeRender;\n\t        if (typeof beforeFn !== 'function') {\n\t            beforeFn = this.options.beforeRender;\n\t            if (typeof beforeFn !== 'function') { return; }\n\t        }\n\t        beforeFn.call(this, opt, this);\n\t    },\n\n\t    notifyAfterRender: function(stats, opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\t        var afterFn = opt.afterRender;\n\t        if (typeof afterFn !== 'function') {\n\t            afterFn = this.options.afterRender;\n\t        }\n\t        if (typeof afterFn === 'function') {\n\t            afterFn.call(this, stats, opt, this);\n\t        }\n\t        this.trigger('render:done', stats, opt);\n\t    },\n\n\t    updateViewsBatch: function(opt) {\n\t        opt || (opt = {});\n\t        var batchSize = opt.batchSize || UPDATE_BATCH_SIZE;\n\t        var updates = this._updates;\n\t        var updateCount = 0;\n\t        var postponeCount = 0;\n\t        var unmountCount = 0;\n\t        var mountCount = 0;\n\t        var maxPriority = MIN_PRIORITY;\n\t        var empty = true;\n\t        var options = this.options;\n\t        var priorities = updates.priorities;\n\t        var viewportFn = 'viewport' in opt ? opt.viewport : options.viewport;\n\t        if (typeof viewportFn !== 'function') { viewportFn = null; }\n\t        var postponeViewFn = options.onViewPostponed;\n\t        if (typeof postponeViewFn !== 'function') { postponeViewFn = null; }\n\t        var priorityIndexes = Object.keys(priorities); // convert priorities to a dense array\n\t        main: for (var i = 0, n = priorityIndexes.length; i < n; i++) {\n\t            var priority = +priorityIndexes[i];\n\t            var priorityUpdates = priorities[priority];\n\t            for (var cid in priorityUpdates) {\n\t                if (updateCount >= batchSize) {\n\t                    empty = false;\n\t                    break main;\n\t                }\n\t                var view = views[cid];\n\t                if (!view) {\n\t                    // This should not occur\n\t                    delete priorityUpdates[cid];\n\t                    continue;\n\t                }\n\t                var currentFlag = priorityUpdates[cid];\n\t                if ((currentFlag & view.FLAG_REMOVE) === 0) {\n\t                    // We should never check a view for viewport if we are about to remove the view\n\t                    var isDetached = cid in updates.unmounted;\n\t                    if (view.DETACHABLE && viewportFn && !viewportFn.call(this, view, !isDetached, this)) {\n\t                        // Unmount View\n\t                        if (!isDetached) {\n\t                            this.registerUnmountedView(view);\n\t                            view.unmount();\n\t                        }\n\t                        updates.unmounted[cid] |= currentFlag;\n\t                        delete priorityUpdates[cid];\n\t                        unmountCount++;\n\t                        continue;\n\t                    }\n\t                    // Mount View\n\t                    if (isDetached) {\n\t                        currentFlag |= view.FLAG_INSERT;\n\t                        mountCount++;\n\t                    }\n\t                    currentFlag |= this.registerMountedView(view);\n\t                }\n\t                var leftoverFlag = this.updateView(view, currentFlag, opt);\n\t                if (leftoverFlag > 0) {\n\t                    // View update has not finished completely\n\t                    priorityUpdates[cid] = leftoverFlag;\n\t                    if (!postponeViewFn || !postponeViewFn.call(this, view, leftoverFlag, this) || priorityUpdates[cid]) {\n\t                        postponeCount++;\n\t                        empty = false;\n\t                        continue;\n\t                    }\n\t                }\n\t                if (maxPriority > priority) { maxPriority = priority; }\n\t                updateCount++;\n\t                delete priorityUpdates[cid];\n\t            }\n\t        }\n\t        return {\n\t            priority: maxPriority,\n\t            updated: updateCount,\n\t            postponed: postponeCount,\n\t            unmounted: unmountCount,\n\t            mounted: mountCount,\n\t            empty: empty\n\t        };\n\t    },\n\n\t    getUnmountedViews: function() {\n\t        var updates = this._updates;\n\t        var unmountedCids = Object.keys(updates.unmounted);\n\t        var n = unmountedCids.length;\n\t        var unmountedViews = new Array(n);\n\t        for (var i = 0; i < n; i++) {\n\t            unmountedViews[i] = views[unmountedCids[i]];\n\t        }\n\t        return unmountedViews;\n\t    },\n\n\t    getMountedViews: function() {\n\t        var updates = this._updates;\n\t        var mountedCids = Object.keys(updates.mounted);\n\t        var n = mountedCids.length;\n\t        var mountedViews = new Array(n);\n\t        for (var i = 0; i < n; i++) {\n\t            mountedViews[i] = views[mountedCids[i]];\n\t        }\n\t        return mountedViews;\n\t    },\n\n\t    checkUnmountedViews: function(viewportFn, opt) {\n\t        opt || (opt  = {});\n\t        var mountCount = 0;\n\t        if (typeof viewportFn !== 'function') { viewportFn = null; }\n\t        var batchSize = 'mountBatchSize' in opt ? opt.mountBatchSize : Infinity;\n\t        var updates = this._updates;\n\t        var unmountedCids = updates.unmountedCids;\n\t        var unmounted = updates.unmounted;\n\t        for (var i = 0, n = Math.min(unmountedCids.length, batchSize); i < n; i++) {\n\t            var cid = unmountedCids[i];\n\t            if (!(cid in unmounted)) { continue; }\n\t            var view = views[cid];\n\t            if (!view) { continue; }\n\t            if (view.DETACHABLE && viewportFn && !viewportFn.call(this, view, false, this)) {\n\t                // Push at the end of all unmounted ids, so this can be check later again\n\t                unmountedCids.push(cid);\n\t                continue;\n\t            }\n\t            mountCount++;\n\t            var flag = this.registerMountedView(view);\n\t            if (flag) { this.scheduleViewUpdate(view, flag, view.UPDATE_PRIORITY, { mounting: true }); }\n\t        }\n\t        // Get rid of views, that have been mounted\n\t        unmountedCids.splice(0, i);\n\t        return mountCount;\n\t    },\n\n\t    checkMountedViews: function(viewportFn, opt) {\n\t        opt || (opt = {});\n\t        var unmountCount = 0;\n\t        if (typeof viewportFn !== 'function') { return unmountCount; }\n\t        var batchSize = 'unmountBatchSize' in opt ? opt.unmountBatchSize : Infinity;\n\t        var updates = this._updates;\n\t        var mountedCids = updates.mountedCids;\n\t        var mounted = updates.mounted;\n\t        for (var i = 0, n = Math.min(mountedCids.length, batchSize); i < n; i++) {\n\t            var cid = mountedCids[i];\n\t            if (!(cid in mounted)) { continue; }\n\t            var view = views[cid];\n\t            if (!view) { continue; }\n\t            if (!view.DETACHABLE || viewportFn.call(this, view, true, this)) {\n\t                // Push at the end of all mounted ids, so this can be check later again\n\t                mountedCids.push(cid);\n\t                continue;\n\t            }\n\t            unmountCount++;\n\t            var flag = this.registerUnmountedView(view);\n\t            if (flag) { view.unmount(); }\n\t        }\n\t        // Get rid of views, that have been unmounted\n\t        mountedCids.splice(0, i);\n\t        return unmountCount;\n\t    },\n\n\t    checkViewport: function(opt) {\n\t        var passingOpt = defaults({}, opt, {\n\t            mountBatchSize: Infinity,\n\t            unmountBatchSize: Infinity\n\t        });\n\t        var viewportFn = 'viewport' in passingOpt ? passingOpt.viewport : this.options.viewport;\n\t        var unmountedCount = this.checkMountedViews(viewportFn, passingOpt);\n\t        if (unmountedCount > 0) {\n\t            // Do not check views, that have been just unmounted and pushed at the end of the cids array\n\t            var unmountedCids = this._updates.unmountedCids;\n\t            passingOpt.mountBatchSize = Math.min(unmountedCids.length - unmountedCount, passingOpt.mountBatchSize);\n\t        }\n\t        var mountedCount = this.checkUnmountedViews(viewportFn, passingOpt);\n\t        return {\n\t            mounted: mountedCount,\n\t            unmounted: unmountedCount\n\t        };\n\t    },\n\n\t    freeze: function(opt) {\n\t        opt || (opt = {});\n\t        var updates = this._updates;\n\t        var key = opt.key;\n\t        var isFrozen = this.options.frozen;\n\t        var freezeKey = updates.freezeKey;\n\t        if (key && key !== freezeKey)  {\n\t            // key passed, but the paper is already freezed with another key\n\t            if (isFrozen && freezeKey) { return; }\n\t            updates.freezeKey = key;\n\t            updates.keyFrozen = isFrozen;\n\t        }\n\t        this.options.frozen = true;\n\t        var id = updates.id;\n\t        updates.id = null;\n\t        if (this.isAsync() && id) { cancelFrame(id); }\n\t    },\n\n\t    unfreeze: function(opt) {\n\t        opt || (opt = {});\n\t        var updates = this._updates;\n\t        var key = opt.key;\n\t        var freezeKey = updates.freezeKey;\n\t        // key passed, but the paper is already freezed with another key\n\t        if (key && freezeKey && key !== freezeKey) { return; }\n\t        updates.freezeKey = null;\n\t        // key passed, but the paper is already freezed\n\t        if (key && key === freezeKey && updates.keyFrozen) { return; }\n\t        if (this.isAsync()) {\n\t            this.freeze();\n\t            this.updateViewsAsync(opt);\n\t        } else {\n\t            this.updateViews(opt);\n\t        }\n\t        this.options.frozen = updates.keyFrozen = false;\n\t        if (updates.sort) {\n\t            this.sortViews();\n\t            updates.sort = false;\n\t        }\n\t    },\n\n\t    isAsync: function() {\n\t        return !!this.options.async;\n\t    },\n\n\t    isFrozen: function() {\n\t        return !!this.options.frozen;\n\t    },\n\n\t    isExactSorting: function() {\n\t        return this.options.sorting === sortingTypes.EXACT;\n\t    },\n\n\t    onRemove: function() {\n\n\t        this.freeze();\n\t        //clean up all DOM elements/views to prevent memory leaks\n\t        this.removeLayers();\n\t        this.removeViews();\n\t    },\n\n\t    getComputedSize: function() {\n\n\t        var options = this.options;\n\t        var w = options.width;\n\t        var h = options.height;\n\t        if (!isNumber(w)) { w = this.el.clientWidth; }\n\t        if (!isNumber(h)) { h = this.el.clientHeight; }\n\t        return { width: w, height: h };\n\t    },\n\n\t    setDimensions: function(width, height) {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var currentWidth = options.width;\n\t        var currentHeight = options.height;\n\t        var w = (width === undefined) ? currentWidth : width;\n\t        var h = (height === undefined) ? currentHeight : height;\n\t        if (currentWidth === w && currentHeight === h) { return; }\n\t        options.width = w;\n\t        options.height = h;\n\t        this._setDimensions();\n\t        var computedSize = this.getComputedSize();\n\t        this.trigger('resize', computedSize.width, computedSize.height);\n\t    },\n\n\t    _setDimensions: function() {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var w = options.width;\n\t        var h = options.height;\n\t        if (isNumber(w)) { w = Math.round(w); }\n\t        if (isNumber(h)) { h = Math.round(h); }\n\t        this.$el.css({\n\t            width: (w === null) ? '' : w,\n\t            height: (h === null) ? '' : h\n\t        });\n\t    },\n\n\t    setOrigin: function(ox, oy) {\n\t        return this.translate(ox || 0, oy || 0);\n\t    },\n\n\t    // Expand/shrink the paper to fit the content.\n\t    // Alternatively signature function(opt)\n\t    fitToContent: function(gridWidth, gridHeight, padding, opt) {\n\n\t        if (isObject$1(gridWidth)) {\n\t            // first parameter is an option object\n\t            opt = gridWidth;\n\t        } else {\n\t            // Support for a deprecated signature\n\t            opt = assign({ gridWidth: gridWidth, gridHeight: gridHeight, padding: padding }, opt);\n\t        }\n\n\t        var ref = this.getFitToContentArea(opt);\n\t        var x = ref.x;\n\t        var y = ref.y;\n\t        var width = ref.width;\n\t        var height = ref.height;\n\t        var ref$1 = this.scale();\n\t        var sx = ref$1.sx;\n\t        var sy = ref$1.sy;\n\n\t        this.setOrigin(-x * sx, -y * sy);\n\t        this.setDimensions(width * sx, height * sy);\n\n\t        return new Rect(x, y, width, height);\n\t    },\n\n\t    getFitToContentArea: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        // Calculate the paper size to accommodate all the graph's elements.\n\n\t        var gridWidth = opt.gridWidth || 1;\n\t        var gridHeight = opt.gridHeight || 1;\n\t        var padding = normalizeSides(opt.padding || 0);\n\n\t        var minWidth = Math.max(opt.minWidth || 0, gridWidth);\n\t        var minHeight = Math.max(opt.minHeight || 0, gridHeight);\n\t        var maxWidth = opt.maxWidth || Number.MAX_VALUE;\n\t        var maxHeight = opt.maxHeight || Number.MAX_VALUE;\n\t        var newOrigin = opt.allowNewOrigin;\n\n\t        var area = ('contentArea' in opt) ? new Rect(opt.contentArea) : this.getContentArea(opt);\n\t        var ref = this.scale();\n\t        var sx = ref.sx;\n\t        var sy = ref.sy;\n\t        area.x *= sx;\n\t        area.y *= sy;\n\t        area.width *= sx;\n\t        area.height *= sy;\n\n\t        var calcWidth = Math.ceil((area.width + area.x) / gridWidth);\n\t        var calcHeight = Math.ceil((area.height + area.y) / gridHeight);\n\t        if (!opt.allowNegativeBottomRight) {\n\t            calcWidth = Math.max(calcWidth, 1);\n\t            calcHeight = Math.max(calcHeight, 1);\n\t        }\n\t        calcWidth *= gridWidth;\n\t        calcHeight *= gridHeight;\n\n\t        var tx = 0;\n\t        if ((newOrigin === 'negative' && area.x < 0) || (newOrigin === 'positive' && area.x >= 0) || newOrigin === 'any') {\n\t            tx = Math.ceil(-area.x / gridWidth) * gridWidth;\n\t            tx += padding.left;\n\t            calcWidth += tx;\n\t        }\n\n\t        var ty = 0;\n\t        if ((newOrigin === 'negative' && area.y < 0) || (newOrigin === 'positive' && area.y >= 0) || newOrigin === 'any') {\n\t            ty = Math.ceil(-area.y / gridHeight) * gridHeight;\n\t            ty += padding.top;\n\t            calcHeight += ty;\n\t        }\n\n\t        calcWidth += padding.right;\n\t        calcHeight += padding.bottom;\n\n\t        // Make sure the resulting width and height are greater than minimum.\n\t        calcWidth = Math.max(calcWidth, minWidth);\n\t        calcHeight = Math.max(calcHeight, minHeight);\n\n\t        // Make sure the resulting width and height are lesser than maximum.\n\t        calcWidth = Math.min(calcWidth, maxWidth);\n\t        calcHeight = Math.min(calcHeight, maxHeight);\n\n\t        return new Rect(-tx / sx, -ty / sy, calcWidth / sx, calcHeight / sy);\n\t    },\n\n\t    scaleContentToFit: function(opt) {\n\n\t        opt || (opt = {});\n\n\t        var contentBBox, contentLocalOrigin;\n\t        if ('contentArea' in opt) {\n\t            var contentArea = opt.contentArea;\n\t            contentBBox = this.localToPaperRect(contentArea);\n\t            contentLocalOrigin = new Point(contentArea);\n\t        } else {\n\t            contentBBox = this.getContentBBox(opt);\n\t            contentLocalOrigin = this.paperToLocalPoint(contentBBox);\n\t        }\n\n\t        if (!contentBBox.width || !contentBBox.height) { return; }\n\n\t        defaults(opt, {\n\t            padding: 0,\n\t            preserveAspectRatio: true,\n\t            scaleGrid: null,\n\t            minScale: 0,\n\t            maxScale: Number.MAX_VALUE\n\t            //minScaleX\n\t            //minScaleY\n\t            //maxScaleX\n\t            //maxScaleY\n\t            //fittingBBox\n\t        });\n\n\t        var padding = normalizeSides(opt.padding);\n\n\t        var minScaleX = opt.minScaleX || opt.minScale;\n\t        var maxScaleX = opt.maxScaleX || opt.maxScale;\n\t        var minScaleY = opt.minScaleY || opt.minScale;\n\t        var maxScaleY = opt.maxScaleY || opt.maxScale;\n\n\t        var fittingBBox;\n\t        if (opt.fittingBBox) {\n\t            fittingBBox = opt.fittingBBox;\n\t        } else {\n\t            var currentTranslate = this.translate();\n\t            var computedSize = this.getComputedSize();\n\t            fittingBBox = {\n\t                x: currentTranslate.tx,\n\t                y: currentTranslate.ty,\n\t                width: computedSize.width,\n\t                height: computedSize.height\n\t            };\n\t        }\n\n\t        fittingBBox = new Rect(fittingBBox).moveAndExpand({\n\t            x: padding.left,\n\t            y: padding.top,\n\t            width: -padding.left - padding.right,\n\t            height: -padding.top - padding.bottom\n\t        });\n\n\t        var currentScale = this.scale();\n\n\t        var newSx = fittingBBox.width / contentBBox.width * currentScale.sx;\n\t        var newSy = fittingBBox.height / contentBBox.height * currentScale.sy;\n\n\t        if (opt.preserveAspectRatio) {\n\t            newSx = newSy = Math.min(newSx, newSy);\n\t        }\n\n\t        // snap scale to a grid\n\t        if (opt.scaleGrid) {\n\n\t            var gridSize = opt.scaleGrid;\n\n\t            newSx = gridSize * Math.floor(newSx / gridSize);\n\t            newSy = gridSize * Math.floor(newSy / gridSize);\n\t        }\n\n\t        // scale min/max boundaries\n\t        newSx = Math.min(maxScaleX, Math.max(minScaleX, newSx));\n\t        newSy = Math.min(maxScaleY, Math.max(minScaleY, newSy));\n\n\t        var origin = this.options.origin;\n\t        var newOx = fittingBBox.x - contentLocalOrigin.x * newSx - origin.x;\n\t        var newOy = fittingBBox.y - contentLocalOrigin.y * newSy - origin.y;\n\n\t        this.scale(newSx, newSy);\n\t        this.translate(newOx, newOy);\n\t    },\n\n\t    // Return the dimensions of the content area in local units (without transformations).\n\t    getContentArea: function(opt) {\n\n\t        if (opt && opt.useModelGeometry) {\n\t            return this.model.getBBox() || new Rect();\n\t        }\n\n\t        return V(this.cells).getBBox();\n\t    },\n\n\t    // Return the dimensions of the content bbox in the paper units (as it appears on screen).\n\t    getContentBBox: function(opt) {\n\n\t        return this.localToPaperRect(this.getContentArea(opt));\n\t    },\n\n\t    // Returns a geometry rectangle representing the entire\n\t    // paper area (coordinates from the left paper border to the right one\n\t    // and the top border to the bottom one).\n\t    getArea: function() {\n\n\t        return this.paperToLocalRect(this.getComputedSize());\n\t    },\n\n\t    getRestrictedArea: function() {\n\t        var args = [], len = arguments.length;\n\t        while ( len-- ) args[ len ] = arguments[ len ];\n\n\n\t        var ref = this.options;\n\t        var restrictTranslate = ref.restrictTranslate;\n\n\t        var restrictedArea;\n\t        if (isFunction(restrictTranslate)) {\n\t            // A method returning a bounding box\n\t            restrictedArea = restrictTranslate.apply(this, args);\n\t        } else if (restrictTranslate === true) {\n\t            // The paper area\n\t            restrictedArea = this.getArea();\n\t        } else if (!restrictTranslate) {\n\t            // falsy value\n\t            restrictedArea = null;\n\t        } else {\n\t            // any other value\n\t            restrictedArea = new Rect(restrictTranslate);\n\t        }\n\n\t        return restrictedArea;\n\t    },\n\n\t    createViewForModel: function(cell) {\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        // A class taken from the paper options.\n\t        var optionalViewClass;\n\n\t        // A default basic class (either dia.ElementView or dia.LinkView)\n\t        var defaultViewClass;\n\n\t        // A special class defined for this model in the corresponding namespace.\n\t        // e.g. joint.shapes.basic.Rect searches for joint.shapes.basic.RectView\n\t        var namespace = options.cellViewNamespace;\n\t        var type = cell.get('type') + 'View';\n\t        var namespaceViewClass = getByPath(namespace, type, '.');\n\n\t        if (cell.isLink()) {\n\t            optionalViewClass = options.linkView;\n\t            defaultViewClass = LinkView;\n\t        } else {\n\t            optionalViewClass = options.elementView;\n\t            defaultViewClass = ElementView;\n\t        }\n\n\t        // a) the paper options view is a class (deprecated)\n\t        //  1. search the namespace for a view\n\t        //  2. if no view was found, use view from the paper options\n\t        // b) the paper options view is a function\n\t        //  1. call the function from the paper options\n\t        //  2. if no view was return, search the namespace for a view\n\t        //  3. if no view was found, use the default\n\t        var ViewClass = (optionalViewClass.prototype instanceof Backbone.View)\n\t            ? namespaceViewClass || optionalViewClass\n\t            : optionalViewClass.call(this, cell) || namespaceViewClass || defaultViewClass;\n\n\t        return new ViewClass({\n\t            model: cell,\n\t            interactive: options.interactive,\n\t            labelsLayer: options.labelsLayer === true ? LayersNames.LABELS : options.labelsLayer\n\t        });\n\t    },\n\n\t    removeView: function(cell) {\n\n\t        var id = cell.id;\n\t        var ref = this;\n\t        var _views = ref._views;\n\t        var _updates = ref._updates;\n\t        var view = _views[id];\n\t        if (view) {\n\t            var cid = view.cid;\n\t            var mounted = _updates.mounted;\n\t            var unmounted = _updates.unmounted;\n\t            view.remove();\n\t            delete _views[id];\n\t            delete mounted[cid];\n\t            delete unmounted[cid];\n\t        }\n\t        return view;\n\t    },\n\n\t    renderView: function(cell, opt) {\n\n\t        var id = cell.id;\n\t        var views = this._views;\n\t        var view, flag;\n\t        var create = true;\n\t        if (id in views) {\n\t            view = views[id];\n\t            if (view.model === cell) {\n\t                flag = view.FLAG_INSERT;\n\t                create = false;\n\t            } else {\n\t                // The view for this `id` already exist.\n\t                // The cell is a new instance of the model with identical id\n\t                // We simply remove the existing view and create a new one\n\t                this.removeView(cell);\n\t            }\n\t        }\n\t        if (create) {\n\t            view = views[id] = this.createViewForModel(cell);\n\t            view.paper = this;\n\t            flag = this.registerUnmountedView(view) | view.getFlag(result(view, 'initFlag'));\n\t        }\n\t        this.requestViewUpdate(view, flag, view.UPDATE_PRIORITY, opt);\n\t        return view;\n\t    },\n\n\t    onImageDragStart: function() {\n\t        // This is the only way to prevent image dragging in Firefox that works.\n\t        // Setting -moz-user-select: none, draggable=\"false\" attribute or user-drag: none didn't help.\n\n\t        return false;\n\t    },\n\n\t    resetViews: function(cells, opt) {\n\t        opt || (opt = {});\n\t        cells || (cells = []);\n\t        this._resetUpdates();\n\t        // clearing views removes any event listeners\n\t        this.removeViews();\n\t        this.freeze({ key: 'reset' });\n\t        for (var i = 0, n = cells.length; i < n; i++) {\n\t            this.renderView(cells[i], opt);\n\t        }\n\t        this.unfreeze({ key: 'reset' });\n\t        this.sortViews();\n\t    },\n\n\t    removeViews: function() {\n\n\t        invoke(this._views, 'remove');\n\n\t        this._views = {};\n\t    },\n\n\t    sortViews: function() {\n\n\t        if (!this.isExactSorting()) {\n\t            // noop\n\t            return;\n\t        }\n\t        if (this.isFrozen()) {\n\t            // sort views once unfrozen\n\t            this._updates.sort = true;\n\t            return;\n\t        }\n\t        this.sortViewsExact();\n\t    },\n\n\t    sortViewsExact: function() {\n\n\t        // Run insertion sort algorithm in order to efficiently sort DOM elements according to their\n\t        // associated model `z` attribute.\n\n\t        var $cells = $(this.cells).children('[model-id]');\n\t        var cells = this.model.get('cells');\n\n\t        sortElements($cells, function(a, b) {\n\t            var cellA = cells.get(a.getAttribute('model-id'));\n\t            var cellB = cells.get(b.getAttribute('model-id'));\n\t            var zA = cellA.attributes.z || 0;\n\t            var zB = cellB.attributes.z || 0;\n\t            return (zA === zB) ? 0 : (zA < zB) ? -1 : 1;\n\t        });\n\t    },\n\n\t    insertView: function(view) {\n\t        var layerView = this.getLayerView(LayersNames.CELLS);\n\t        var el = view.el;\n\t        var model = view.model;\n\t        switch (this.options.sorting) {\n\t            case sortingTypes.APPROX:\n\t                layerView.insertSortedNode(el, model.get('z'));\n\t                break;\n\t            case sortingTypes.EXACT:\n\t            default:\n\t                layerView.insertNode(el);\n\t                break;\n\t        }\n\t        view.onMount();\n\t    },\n\n\t    scale: function(sx, sy, ox, oy) {\n\n\t        // getter\n\t        if (sx === undefined) {\n\t            return V.matrixToScale(this.matrix());\n\t        }\n\n\t        // setter\n\t        if (sy === undefined) {\n\t            sy = sx;\n\t        }\n\t        if (ox === undefined) {\n\t            ox = 0;\n\t            oy = 0;\n\t        }\n\n\t        var translate = this.translate();\n\n\t        if (ox || oy || translate.tx || translate.ty) {\n\t            var newTx = translate.tx - ox * (sx - 1);\n\t            var newTy = translate.ty - oy * (sy - 1);\n\t            this.translate(newTx, newTy);\n\t        }\n\n\t        sx = Math.max(sx || 0, this.MIN_SCALE);\n\t        sy = Math.max(sy || 0, this.MIN_SCALE);\n\n\t        var ctm = this.matrix();\n\t        ctm.a = sx;\n\t        ctm.d = sy;\n\n\t        this.matrix(ctm);\n\n\t        this.trigger('scale', sx, sy, ox, oy);\n\n\t        return this;\n\t    },\n\n\t    // Experimental - do not use in production.\n\t    rotate: function(angle, cx, cy) {\n\n\t        // getter\n\t        if (angle === undefined) {\n\t            return V.matrixToRotate(this.matrix());\n\t        }\n\n\t        // setter\n\n\t        // If the origin is not set explicitely, rotate around the center. Note that\n\t        // we must use the plain bounding box (`this.el.getBBox()` instead of the one that gives us\n\t        // the real bounding box (`bbox()`) including transformations).\n\t        if (cx === undefined) {\n\t            var bbox = this.cells.getBBox();\n\t            cx = bbox.width / 2;\n\t            cy = bbox.height / 2;\n\t        }\n\n\t        var ctm = this.matrix().translate(cx, cy).rotate(angle).translate(-cx, -cy);\n\t        this.matrix(ctm);\n\n\t        return this;\n\t    },\n\n\t    translate: function(tx, ty) {\n\n\t        // getter\n\t        if (tx === undefined) {\n\t            return V.matrixToTranslate(this.matrix());\n\t        }\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var origin = options.origin;\n\t        var drawGrid = options.drawGrid;\n\n\t        // setter\n\t        tx || (tx = 0);\n\t        ty || (ty = 0);\n\n\t        var ctm = this.matrix();\n\t        if (ctm.e === tx && ctm.f === ty) { return this; }\n\t        ctm.e = tx;\n\t        ctm.f = ty;\n\n\t        this.matrix(ctm);\n\n\t        var ref$1 = this.translate();\n\t        var ox = ref$1.tx;\n\t        var oy = ref$1.ty;\n\t        origin.x = ox;\n\t        origin.y = oy;\n\n\t        this.trigger('translate', ox, oy);\n\n\t        if (drawGrid) {\n\t            this.drawGrid();\n\t        }\n\n\t        return this;\n\t    },\n\n\t    // Find the first view climbing up the DOM tree starting at element `el`. Note that `el` can also\n\t    // be a selector or a jQuery object.\n\t    findView: function($el) {\n\n\t        var el = isString($el)\n\t            ? this.cells.querySelector($el)\n\t            : $el instanceof $ ? $el[0] : $el;\n\n\t        var id = this.findAttribute('model-id', el);\n\t        if (id) { return this._views[id]; }\n\n\t        return undefined;\n\t    },\n\n\t    // Find a view for a model `cell`. `cell` can also be a string or number representing a model `id`.\n\t    findViewByModel: function(cell) {\n\n\t        var id = (isString(cell) || isNumber(cell)) ? cell : (cell && cell.id);\n\n\t        return this._views[id];\n\t    },\n\n\t    // Find all views at given point\n\t    findViewsFromPoint: function(p) {\n\n\t        p = new Point(p);\n\n\t        var views = this.model.getElements().map(this.findViewByModel, this);\n\n\t        return views.filter(function(view) {\n\t            return view && view.vel.getBBox({ target: this.cells }).containsPoint(p);\n\t        }, this);\n\t    },\n\n\t    // Find all views in given area\n\t    findViewsInArea: function(rect, opt) {\n\n\t        opt = defaults(opt || {}, { strict: false });\n\t        rect = new Rect(rect);\n\n\t        var views = this.model.getElements().map(this.findViewByModel, this);\n\t        var method = opt.strict ? 'containsRect' : 'intersect';\n\n\t        return views.filter(function(view) {\n\t            return view && rect[method](view.vel.getBBox({ target: this.cells }));\n\t        }, this);\n\t    },\n\n\t    removeTools: function() {\n\t        this.dispatchToolsEvent('remove');\n\t        return this;\n\t    },\n\n\t    hideTools: function() {\n\t        this.dispatchToolsEvent('hide');\n\t        return this;\n\t    },\n\n\t    showTools: function() {\n\t        this.dispatchToolsEvent('show');\n\t        return this;\n\t    },\n\n\t    dispatchToolsEvent: function(event) {\n\t        var ref;\n\n\t        var args = [], len = arguments.length - 1;\n\t        while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\t        if (typeof event !== 'string') { return; }\n\t        (ref = this).trigger.apply(ref, [ 'tools:event', event ].concat( args ));\n\t    },\n\n\n\t    getModelById: function(id) {\n\n\t        return this.model.getCell(id);\n\t    },\n\n\t    snapToGrid: function(x, y) {\n\n\t        // Convert global coordinates to the local ones of the `viewport`. Otherwise,\n\t        // improper transformation would be applied when the viewport gets transformed (scaled/rotated).\n\t        return this.clientToLocalPoint(x, y).snapToGrid(this.options.gridSize);\n\t    },\n\n\t    localToPaperPoint: function(x, y) {\n\t        // allow `x` to be a point and `y` undefined\n\t        var localPoint = new Point(x, y);\n\t        var paperPoint = V.transformPoint(localPoint, this.matrix());\n\t        return paperPoint;\n\t    },\n\n\t    localToPaperRect: function(x, y, width, height) {\n\t        // allow `x` to be a rectangle and rest arguments undefined\n\t        var localRect = new Rect(x, y, width, height);\n\t        var paperRect = V.transformRect(localRect, this.matrix());\n\t        return paperRect;\n\t    },\n\n\t    paperToLocalPoint: function(x, y) {\n\t        // allow `x` to be a point and `y` undefined\n\t        var paperPoint = new Point(x, y);\n\t        var localPoint = V.transformPoint(paperPoint, this.matrix().inverse());\n\t        return localPoint;\n\t    },\n\n\t    paperToLocalRect: function(x, y, width, height) {\n\t        // allow `x` to be a rectangle and rest arguments undefined\n\t        var paperRect = new Rect(x, y, width, height);\n\t        var localRect = V.transformRect(paperRect, this.matrix().inverse());\n\t        return localRect;\n\t    },\n\n\t    localToClientPoint: function(x, y) {\n\t        // allow `x` to be a point and `y` undefined\n\t        var localPoint = new Point(x, y);\n\t        var clientPoint = V.transformPoint(localPoint, this.clientMatrix());\n\t        return clientPoint;\n\t    },\n\n\t    localToClientRect: function(x, y, width, height) {\n\t        // allow `x` to be a point and `y` undefined\n\t        var localRect = new Rect(x, y, width, height);\n\t        var clientRect = V.transformRect(localRect, this.clientMatrix());\n\t        return clientRect;\n\t    },\n\n\t    // Transform client coordinates to the paper local coordinates.\n\t    // Useful when you have a mouse event object and you'd like to get coordinates\n\t    // inside the paper that correspond to `evt.clientX` and `evt.clientY` point.\n\t    // Example: var localPoint = paper.clientToLocalPoint({ x: evt.clientX, y: evt.clientY });\n\t    clientToLocalPoint: function(x, y) {\n\t        // allow `x` to be a point and `y` undefined\n\t        var clientPoint = new Point(x, y);\n\t        var localPoint = V.transformPoint(clientPoint, this.clientMatrix().inverse());\n\t        return localPoint;\n\t    },\n\n\t    clientToLocalRect: function(x, y, width, height) {\n\t        // allow `x` to be a point and `y` undefined\n\t        var clientRect = new Rect(x, y, width, height);\n\t        var localRect = V.transformRect(clientRect, this.clientMatrix().inverse());\n\t        return localRect;\n\t    },\n\n\t    localToPagePoint: function(x, y) {\n\n\t        return this.localToPaperPoint(x, y).offset(this.pageOffset());\n\t    },\n\n\t    localToPageRect: function(x, y, width, height) {\n\n\t        return this.localToPaperRect(x, y, width, height).offset(this.pageOffset());\n\t    },\n\n\t    pageToLocalPoint: function(x, y) {\n\n\t        var pagePoint = new Point(x, y);\n\t        var paperPoint = pagePoint.difference(this.pageOffset());\n\t        return this.paperToLocalPoint(paperPoint);\n\t    },\n\n\t    pageToLocalRect: function(x, y, width, height) {\n\n\t        var pageOffset = this.pageOffset();\n\t        var paperRect = new Rect(x, y, width, height);\n\t        paperRect.x -= pageOffset.x;\n\t        paperRect.y -= pageOffset.y;\n\t        return this.paperToLocalRect(paperRect);\n\t    },\n\n\t    clientOffset: function() {\n\n\t        var clientRect = this.svg.getBoundingClientRect();\n\t        return new Point(clientRect.left, clientRect.top);\n\t    },\n\n\t    pageOffset: function() {\n\n\t        return this.clientOffset().offset(window.scrollX, window.scrollY);\n\t    },\n\n\t    linkAllowed: function(linkView) {\n\n\t        if (!(linkView instanceof LinkView)) {\n\t            throw new Error('Must provide a linkView.');\n\t        }\n\n\t        var link = linkView.model;\n\t        var paperOptions = this.options;\n\t        var graph = this.model;\n\t        var ns = graph.constructor.validations;\n\n\t        if (!paperOptions.multiLinks) {\n\t            if (!ns.multiLinks.call(this, graph, link)) { return false; }\n\t        }\n\n\t        if (!paperOptions.linkPinning) {\n\t            // Link pinning is not allowed and the link is not connected to the target.\n\t            if (!ns.linkPinning.call(this, graph, link)) { return false; }\n\t        }\n\n\t        if (typeof paperOptions.allowLink === 'function') {\n\t            if (!paperOptions.allowLink.call(this, linkView, this)) { return false; }\n\t        }\n\n\t        return true;\n\t    },\n\n\t    getDefaultLink: function(cellView, magnet) {\n\n\t        return isFunction(this.options.defaultLink)\n\t        // default link is a function producing link model\n\t            ? this.options.defaultLink.call(this, cellView, magnet)\n\t        // default link is the Backbone model\n\t            : this.options.defaultLink.clone();\n\t    },\n\n\t    // Cell highlighting.\n\t    // ------------------\n\n\t    resolveHighlighter: function(opt) {\n\t        if ( opt === void 0 ) opt = {};\n\n\n\t        var highlighterDef = opt.highlighter;\n\t        var type = opt.type;\n\t        var ref = this.options;\n\t        var highlighting = ref.highlighting;\n\t        var highlighterNamespace = ref.highlighterNamespace;\n\n\t        /*\n\t            Expecting opt.highlighter to have the following structure:\n\t            {\n\t                name: 'highlighter-name',\n\t                options: {\n\t                    some: 'value'\n\t                }\n\t            }\n\t        */\n\t        if (highlighterDef === undefined) {\n\n\t            // Is highlighting disabled?\n\t            if (!highlighting) { return false; }\n\t            // check for built-in types\n\t            if (type) {\n\t                highlighterDef = highlighting[type];\n\t                // Is a specific type highlight disabled?\n\t                if (highlighterDef === false) { return false; }\n\t            }\n\t            if (!highlighterDef) {\n\t                // Type not defined use default highlight\n\t                highlighterDef = highlighting['default'];\n\t            }\n\t        }\n\n\t        // Do nothing if opt.highlighter is falsy.\n\t        // This allows the case to not highlight cell(s) in certain cases.\n\t        // For example, if you want to NOT highlight when embedding elements\n\t        // or use a custom highlighter.\n\t        if (!highlighterDef) { return false; }\n\n\t        // Allow specifying a highlighter by name.\n\t        if (isString(highlighterDef)) {\n\t            highlighterDef = {\n\t                name: highlighterDef\n\t            };\n\t        }\n\n\t        var name = highlighterDef.name;\n\t        var highlighter = highlighterNamespace[name];\n\n\t        // Highlighter validation\n\t        if (!highlighter) {\n\t            throw new Error('Unknown highlighter (\"' + name + '\")');\n\t        }\n\t        if (typeof highlighter.highlight !== 'function') {\n\t            throw new Error('Highlighter (\"' + name + '\") is missing required highlight() method');\n\t        }\n\t        if (typeof highlighter.unhighlight !== 'function') {\n\t            throw new Error('Highlighter (\"' + name + '\") is missing required unhighlight() method');\n\t        }\n\n\t        return {\n\t            highlighter: highlighter,\n\t            options: highlighterDef.options || {},\n\t            name: name\n\t        };\n\t    },\n\n\t    onCellHighlight: function(cellView, magnetEl, opt) {\n\t        var highlighterDescriptor = this.resolveHighlighter(opt);\n\t        if (!highlighterDescriptor) { return; }\n\t        var highlighter = highlighterDescriptor.highlighter;\n\t        var options = highlighterDescriptor.options;\n\t        highlighter.highlight(cellView, magnetEl, options);\n\t    },\n\n\t    onCellUnhighlight: function(cellView, magnetEl, opt) {\n\t        var highlighterDescriptor = this.resolveHighlighter(opt);\n\t        if (!highlighterDescriptor) { return; }\n\t        var highlighter = highlighterDescriptor.highlighter;\n\t        var options = highlighterDescriptor.options;\n\t        highlighter.unhighlight(cellView, magnetEl, options);\n\t    },\n\n\t    // Interaction.\n\t    // ------------\n\n\t    pointerdblclick: function(evt) {\n\n\t        evt.preventDefault();\n\n\t        // magnetpointerdblclick can stop propagation\n\n\t        evt = normalizeEvent(evt);\n\n\t        var view = this.findView(evt.target);\n\t        if (this.guard(evt, view)) { return; }\n\n\t        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n\t        if (view) {\n\t            view.pointerdblclick(evt, localPoint.x, localPoint.y);\n\n\t        } else {\n\t            this.trigger('blank:pointerdblclick', evt, localPoint.x, localPoint.y);\n\t        }\n\t    },\n\n\t    pointerclick: function(evt) {\n\n\t        // magnetpointerclick can stop propagation\n\n\t        var data = this.eventData(evt);\n\t        // Trigger event only if mouse has not moved.\n\t        if (data.mousemoved <= this.options.clickThreshold) {\n\n\t            evt = normalizeEvent(evt);\n\n\t            var view = this.findView(evt.target);\n\t            if (this.guard(evt, view)) { return; }\n\n\t            var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n\t            if (view) {\n\t                view.pointerclick(evt, localPoint.x, localPoint.y);\n\n\t            } else {\n\t                this.trigger('blank:pointerclick', evt, localPoint.x, localPoint.y);\n\t            }\n\t        }\n\t    },\n\n\t    contextmenu: function(evt) {\n\n\t        if (this.options.preventContextMenu) { evt.preventDefault(); }\n\n\t        evt = normalizeEvent(evt);\n\n\t        var view = this.findView(evt.target);\n\t        if (this.guard(evt, view)) { return; }\n\n\t        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n\t        if (view) {\n\t            view.contextmenu(evt, localPoint.x, localPoint.y);\n\n\t        } else {\n\t            this.trigger('blank:contextmenu', evt, localPoint.x, localPoint.y);\n\t        }\n\t    },\n\n\t    pointerdown: function(evt) {\n\n\t        // onmagnet stops propagation when `addLinkFromMagnet` is allowed\n\t        // onevent can stop propagation\n\n\t        evt = normalizeEvent(evt);\n\n\t        var view = this.findView(evt.target);\n\t        if (this.guard(evt, view)) { return; }\n\n\t        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n\t        if (view) {\n\n\t            evt.preventDefault();\n\t            view.pointerdown(evt, localPoint.x, localPoint.y);\n\n\t        } else {\n\n\t            if (this.options.preventDefaultBlankAction) { evt.preventDefault(); }\n\n\t            this.trigger('blank:pointerdown', evt, localPoint.x, localPoint.y);\n\t        }\n\n\t        this.delegateDragEvents(view, evt.data);\n\t    },\n\n\t    pointermove: function(evt) {\n\n\t        // mouse moved counter\n\t        var data = this.eventData(evt);\n\t        data.mousemoved || (data.mousemoved = 0);\n\t        var mousemoved = ++data.mousemoved;\n\n\t        if (mousemoved <= this.options.moveThreshold) { return; }\n\n\t        evt = normalizeEvent(evt);\n\n\t        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n\t        var view = data.sourceView;\n\t        if (view) {\n\t            view.pointermove(evt, localPoint.x, localPoint.y);\n\t        } else {\n\t            this.trigger('blank:pointermove', evt, localPoint.x, localPoint.y);\n\t        }\n\n\t        this.eventData(evt, data);\n\t    },\n\n\t    pointerup: function(evt) {\n\n\t        this.undelegateDocumentEvents();\n\n\t        var normalizedEvt = normalizeEvent(evt);\n\n\t        var localPoint = this.snapToGrid(normalizedEvt.clientX, normalizedEvt.clientY);\n\n\t        var view = this.eventData(evt).sourceView;\n\t        if (view) {\n\t            view.pointerup(normalizedEvt, localPoint.x, localPoint.y);\n\t        } else {\n\t            this.trigger('blank:pointerup', normalizedEvt, localPoint.x, localPoint.y);\n\t        }\n\n\t        if (!normalizedEvt.isPropagationStopped()) {\n\t            this.pointerclick($.Event(evt, { type: 'click', data: evt.data }));\n\t        }\n\n\t        evt.stopImmediatePropagation();\n\t        this.delegateEvents();\n\t    },\n\n\t    mouseover: function(evt) {\n\n\t        evt = normalizeEvent(evt);\n\n\t        var view = this.findView(evt.target);\n\t        if (this.guard(evt, view)) { return; }\n\n\t        if (view) {\n\t            view.mouseover(evt);\n\n\t        } else {\n\t            if (this.el === evt.target) { return; } // prevent border of paper from triggering this\n\t            this.trigger('blank:mouseover', evt);\n\t        }\n\t    },\n\n\t    mouseout: function(evt) {\n\n\t        evt = normalizeEvent(evt);\n\n\t        var view = this.findView(evt.target);\n\t        if (this.guard(evt, view)) { return; }\n\n\t        if (view) {\n\t            view.mouseout(evt);\n\n\t        } else {\n\t            if (this.el === evt.target) { return; } // prevent border of paper from triggering this\n\t            this.trigger('blank:mouseout', evt);\n\t        }\n\t    },\n\n\t    mouseenter: function(evt) {\n\n\t        evt = normalizeEvent(evt);\n\n\t        var target = evt.target;\n\t        var relatedTarget = evt.relatedTarget;\n\t        var currentTarget = evt.currentTarget;\n\t        var view = this.findView(target);\n\t        if (this.guard(evt, view)) { return; }\n\t        var relatedView = this.findView(relatedTarget);\n\t        if (view) {\n\t            if (relatedView === view) {\n\t                // Mouse left a cell tool\n\t                return;\n\t            }\n\t            view.mouseenter(evt);\n\t            if (this.el.contains(relatedTarget)) {\n\t                // The pointer remains inside the paper.\n\t                return;\n\t            }\n\t        }\n\t        if (relatedView) {\n\t            return;\n\t        }\n\t        // prevent double `mouseenter` event if the `relatedTarget` is outside the paper\n\t        // (mouseenter method would be fired twice)\n\t        if (currentTarget === this.el) {\n\t            // `paper` (more descriptive), not `blank`\n\t            this.trigger('paper:mouseenter', evt);\n\t        }\n\t    },\n\n\t    mouseleave: function(evt) {\n\n\t        evt = normalizeEvent(evt);\n\n\t        var target = evt.target;\n\t        var relatedTarget = evt.relatedTarget;\n\t        var currentTarget = evt.currentTarget;\n\t        var view = this.findView(target);\n\t        if (this.guard(evt, view)) { return; }\n\t        var relatedView = this.findView(relatedTarget);\n\t        if (view) {\n\t            if (relatedView === view) {\n\t                // Mouse entered a cell tool\n\t                return;\n\t            }\n\t            view.mouseleave(evt);\n\t            if (this.el.contains(relatedTarget)) {\n\t                // The pointer has exited a cellView. The pointer is still inside of the paper.\n\t                return;\n\t            }\n\t        }\n\t        if (relatedView) {\n\t            // The pointer has entered a new cellView\n\t            return;\n\t        }\n\t        // prevent double `mouseleave` event if the `relatedTarget` is outside the paper\n\t        // (mouseleave method would be fired twice)\n\t        if (currentTarget === this.el) {\n\t            // There is no cellView under the pointer, nor the blank area of the paper\n\t            this.trigger('paper:mouseleave', evt);\n\t        }\n\t    },\n\n\t    mousewheel: function(evt) {\n\n\t        evt = normalizeEvent(evt);\n\n\t        var view = this.findView(evt.target);\n\t        if (this.guard(evt, view)) { return; }\n\n\t        var originalEvent = evt.originalEvent;\n\t        var localPoint = this.snapToGrid(originalEvent.clientX, originalEvent.clientY);\n\t        var delta = Math.max(-1, Math.min(1, originalEvent.wheelDelta));\n\n\t        if (view) {\n\t            view.mousewheel(evt, localPoint.x, localPoint.y, delta);\n\n\t        } else {\n\t            this.trigger('blank:mousewheel', evt, localPoint.x, localPoint.y, delta);\n\t        }\n\t    },\n\n\t    onevent: function(evt) {\n\n\t        var eventNode = evt.currentTarget;\n\t        var eventName = eventNode.getAttribute('event');\n\t        if (eventName) {\n\t            var view = this.findView(eventNode);\n\t            if (view) {\n\n\t                evt = normalizeEvent(evt);\n\t                if (this.guard(evt, view)) { return; }\n\n\t                var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\t                view.onevent(evt, eventName, localPoint.x, localPoint.y);\n\t            }\n\t        }\n\t    },\n\n\t    magnetEvent: function(evt, handler) {\n\n\t        var magnetNode = evt.currentTarget;\n\t        var magnetValue = magnetNode.getAttribute('magnet');\n\t        if (magnetValue) {\n\t            var view = this.findView(magnetNode);\n\t            if (view) {\n\t                evt = normalizeEvent(evt);\n\t                if (this.guard(evt, view)) { return; }\n\t                var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\t                handler.call(this, view, evt, magnetNode, localPoint.x, localPoint.y);\n\t            }\n\t        }\n\t    },\n\n\t    onmagnet: function(evt) {\n\n\t        this.magnetEvent(evt, function(view, evt, _, x, y) {\n\t            view.onmagnet(evt, x, y);\n\t        });\n\t    },\n\n\n\t    magnetpointerdblclick: function(evt) {\n\n\t        this.magnetEvent(evt, function(view, evt, magnet, x, y) {\n\t            view.magnetpointerdblclick(evt, magnet, x, y);\n\t        });\n\t    },\n\n\t    magnetcontextmenu: function(evt) {\n\n\t        if (this.options.preventContextMenu) { evt.preventDefault(); }\n\t        this.magnetEvent(evt, function(view, evt, magnet, x, y) {\n\t            view.magnetcontextmenu(evt, magnet, x, y);\n\t        });\n\t    },\n\n\t    onlabel: function(evt) {\n\n\t        var labelNode = evt.currentTarget;\n\t        var view = this.findView(labelNode);\n\t        if (view) {\n\n\t            evt = normalizeEvent(evt);\n\t            if (this.guard(evt, view)) { return; }\n\n\t            var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\t            view.onlabel(evt, localPoint.x, localPoint.y);\n\t        }\n\t    },\n\n\t    getPointerArgs: function getPointerArgs(evt) {\n\t        var normalizedEvt = normalizeEvent(evt);\n\t        var ref = this.snapToGrid(normalizedEvt.clientX, normalizedEvt.clientY);\n\t        var x = ref.x;\n\t        var y = ref.y;\n\t        return [normalizedEvt, x, y];\n\t    },\n\n\t    delegateDragEvents: function(view, data) {\n\n\t        data || (data = {});\n\t        this.eventData({ data: data }, { sourceView: view || null, mousemoved: 0 });\n\t        this.delegateDocumentEvents(null, data);\n\t        this.undelegateEvents();\n\t    },\n\n\t    // Guard the specified event. If the event is not interesting, guard returns `true`.\n\t    // Otherwise, it returns `false`.\n\t    guard: function(evt, view) {\n\n\t        if (evt.type === 'mousedown' && evt.button === 2) {\n\t            // handled as `contextmenu` type\n\t            return true;\n\t        }\n\n\t        if (this.options.guard && this.options.guard(evt, view)) {\n\t            return true;\n\t        }\n\n\t        if (evt.data && evt.data.guarded !== undefined) {\n\t            return evt.data.guarded;\n\t        }\n\n\t        if (view && view.model && (view.model instanceof Cell)) {\n\t            return false;\n\t        }\n\n\t        if (this.svg === evt.target || this.el === evt.target || $.contains(this.svg, evt.target)) {\n\t            return false;\n\t        }\n\n\t        return true;    // Event guarded. Paper should not react on it in any way.\n\t    },\n\n\t    setGridSize: function(gridSize) {\n\n\t        this.options.gridSize = gridSize;\n\n\t        if (this.options.drawGrid) {\n\t            this.drawGrid();\n\t        }\n\n\t        return this;\n\t    },\n\n\t    clearGrid: function() {\n\n\t        if (this.$grid) {\n\t            this.$grid.css('backgroundImage', 'none');\n\t        }\n\t        return this;\n\t    },\n\n\t    _getGridRefs: function() {\n\n\t        if (!this._gridCache) {\n\n\t            this._gridCache = {\n\t                root: V('svg', { width: '100%', height: '100%' }, V('defs')),\n\t                patterns: {},\n\t                add: function(id, vel) {\n\t                    V(this.root.node.childNodes[0]).append(vel);\n\t                    this.patterns[id] = vel;\n\t                    this.root.append(V('rect', { width: '100%', height: '100%', fill: 'url(#' + id + ')' }));\n\t                },\n\t                get: function(id) {\n\t                    return this.patterns[id];\n\t                },\n\t                exist: function(id) {\n\t                    return this.patterns[id] !== undefined;\n\t                }\n\t            };\n\t        }\n\n\t        return this._gridCache;\n\t    },\n\n\t    setGrid: function(drawGrid) {\n\n\t        this.clearGrid();\n\n\t        this._gridCache = null;\n\t        this._gridSettings = [];\n\n\t        var optionsList = Array.isArray(drawGrid) ? drawGrid : [drawGrid || {}];\n\t        optionsList.forEach(function(item) {\n\t            this._gridSettings.push.apply(this._gridSettings, this._resolveDrawGridOption(item));\n\t        }, this);\n\t        return this;\n\t    },\n\n\t    _resolveDrawGridOption: function(opt) {\n\n\t        var namespace = this.constructor.gridPatterns;\n\t        if (isString(opt) && Array.isArray(namespace[opt])) {\n\t            return namespace[opt].map(function(item) {\n\t                return assign({}, item);\n\t            });\n\t        }\n\n\t        var options = opt || { args: [{}] };\n\t        var isArray = Array.isArray(options);\n\t        var name = options.name;\n\n\t        if (!isArray && !name && !options.markup) {\n\t            name = 'dot';\n\t        }\n\n\t        if (name && Array.isArray(namespace[name])) {\n\t            var pattern = namespace[name].map(function(item) {\n\t                return assign({}, item);\n\t            });\n\n\t            var args = Array.isArray(options.args) ? options.args : [options.args || {}];\n\n\t            defaults(args[0], omit(opt, 'args'));\n\t            for (var i = 0; i < args.length; i++) {\n\t                if (pattern[i]) {\n\t                    assign(pattern[i], args[i]);\n\t                }\n\t            }\n\t            return pattern;\n\t        }\n\n\t        return isArray ? options : [options];\n\t    },\n\n\t    drawGrid: function(opt) {\n\n\t        var gridSize = this.options.gridSize;\n\t        if (gridSize <= 1) {\n\t            return this.clearGrid();\n\t        }\n\n\t        var localOptions = Array.isArray(opt) ? opt : [opt];\n\n\t        var ctm = this.matrix();\n\t        var refs = this._getGridRefs();\n\n\t        this._gridSettings.forEach(function(gridLayerSetting, index) {\n\n\t            var id = 'pattern_' + index;\n\t            var options = merge(gridLayerSetting, localOptions[index], {\n\t                sx: ctm.a || 1,\n\t                sy: ctm.d || 1,\n\t                ox: ctm.e || 0,\n\t                oy: ctm.f || 0\n\t            });\n\n\t            options.width = gridSize * (ctm.a || 1) * (options.scaleFactor || 1);\n\t            options.height = gridSize * (ctm.d || 1) * (options.scaleFactor || 1);\n\n\t            if (!refs.exist(id)) {\n\t                refs.add(id, V('pattern', { id: id, patternUnits: 'userSpaceOnUse' }, V(options.markup)));\n\t            }\n\n\t            var patternDefVel = refs.get(id);\n\n\t            if (isFunction(options.update)) {\n\t                options.update(patternDefVel.node.childNodes[0], options);\n\t            }\n\n\t            var x = options.ox % options.width;\n\t            if (x < 0) { x += options.width; }\n\n\t            var y = options.oy % options.height;\n\t            if (y < 0) { y += options.height; }\n\n\t            patternDefVel.attr({\n\t                x: x,\n\t                y: y,\n\t                width: options.width,\n\t                height: options.height\n\t            });\n\t        });\n\n\t        var patternUri = new XMLSerializer().serializeToString(refs.root.node);\n\t        patternUri = 'url(data:image/svg+xml;base64,' + btoa(patternUri) + ')';\n\n\t        this.$grid.css('backgroundImage', patternUri);\n\n\t        return this;\n\t    },\n\n\t    updateBackgroundImage: function(opt) {\n\n\t        opt = opt || {};\n\n\t        var backgroundPosition = opt.position || 'center';\n\t        var backgroundSize = opt.size || 'auto auto';\n\n\t        var currentScale = this.scale();\n\t        var currentTranslate = this.translate();\n\n\t        // backgroundPosition\n\t        if (isObject$1(backgroundPosition)) {\n\t            var x = currentTranslate.tx + (currentScale.sx * (backgroundPosition.x || 0));\n\t            var y = currentTranslate.ty + (currentScale.sy * (backgroundPosition.y || 0));\n\t            backgroundPosition = x + 'px ' + y + 'px';\n\t        }\n\n\t        // backgroundSize\n\t        if (isObject$1(backgroundSize)) {\n\t            backgroundSize = new Rect(backgroundSize).scale(currentScale.sx, currentScale.sy);\n\t            backgroundSize = backgroundSize.width + 'px ' + backgroundSize.height + 'px';\n\t        }\n\n\t        this.$background.css({\n\t            backgroundSize: backgroundSize,\n\t            backgroundPosition: backgroundPosition\n\t        });\n\t    },\n\n\t    drawBackgroundImage: function(img, opt) {\n\n\t        // Clear the background image if no image provided\n\t        if (!(img instanceof HTMLImageElement)) {\n\t            this.$background.css('backgroundImage', '');\n\t            return;\n\t        }\n\n\t        if (!this._background || this._background.id !== opt.id) {\n\t            // Draw only the last image requested (see drawBackground())\n\t            return;\n\t        }\n\n\t        opt = opt || {};\n\n\t        var backgroundImage;\n\t        var backgroundSize = opt.size;\n\t        var backgroundRepeat = opt.repeat || 'no-repeat';\n\t        var backgroundOpacity = opt.opacity || 1;\n\t        var backgroundQuality = Math.abs(opt.quality) || 1;\n\t        var backgroundPattern = this.constructor.backgroundPatterns[camelCase(backgroundRepeat)];\n\n\t        if (isFunction(backgroundPattern)) {\n\t            // 'flip-x', 'flip-y', 'flip-xy', 'watermark' and custom\n\t            img.width *= backgroundQuality;\n\t            img.height *= backgroundQuality;\n\t            var canvas = backgroundPattern(img, opt);\n\t            if (!(canvas instanceof HTMLCanvasElement)) {\n\t                throw new Error('dia.Paper: background pattern must return an HTML Canvas instance');\n\t            }\n\n\t            backgroundImage = canvas.toDataURL('image/png');\n\t            backgroundRepeat = 'repeat';\n\t            if (isObject$1(backgroundSize)) {\n\t                // recalculate the tile size if an object passed in\n\t                backgroundSize.width *= canvas.width / img.width;\n\t                backgroundSize.height *= canvas.height / img.height;\n\t            } else if (backgroundSize === undefined) {\n\t                // calculate the tile size if no provided\n\t                opt.size = {\n\t                    width: canvas.width / backgroundQuality,\n\t                    height: canvas.height / backgroundQuality\n\t                };\n\t            }\n\t        } else {\n\t            // backgroundRepeat:\n\t            // no-repeat', 'round', 'space', 'repeat', 'repeat-x', 'repeat-y'\n\t            backgroundImage = img.src;\n\t            if (backgroundSize === undefined) {\n\t                // pass the image size for  the backgroundSize if no size provided\n\t                opt.size = {\n\t                    width: img.width,\n\t                    height: img.height\n\t                };\n\t            }\n\t        }\n\n\t        this.$background.css({\n\t            opacity: backgroundOpacity,\n\t            backgroundRepeat: backgroundRepeat,\n\t            backgroundImage: 'url(' + backgroundImage + ')'\n\t        });\n\n\t        this.updateBackgroundImage(opt);\n\t    },\n\n\t    updateBackgroundColor: function(color) {\n\n\t        this.$el.css('backgroundColor', color || '');\n\t    },\n\n\t    drawBackground: function(opt) {\n\n\t        opt = opt || {};\n\n\t        this.updateBackgroundColor(opt.color);\n\n\t        if (opt.image) {\n\t            opt = this._background = cloneDeep(opt);\n\t            guid(opt);\n\t            var img = document.createElement('img');\n\t            img.onload = this.drawBackgroundImage.bind(this, img, opt);\n\t            img.src = opt.image;\n\t        } else {\n\t            this.drawBackgroundImage(null);\n\t            this._background = null;\n\t        }\n\n\t        return this;\n\t    },\n\n\t    setInteractivity: function(value) {\n\n\t        this.options.interactive = value;\n\n\t        invoke(this._views, 'setInteractivity', value);\n\t    },\n\n\t    // Paper definitions.\n\t    // ------------------\n\n\t    isDefined: function(defId) {\n\n\t        return !!this.svg.getElementById(defId);\n\t    },\n\n\t    defineFilter: function(filter$1) {\n\n\t        if (!isObject$1(filter$1)) {\n\t            throw new TypeError('dia.Paper: defineFilter() requires 1. argument to be an object.');\n\t        }\n\n\t        var filterId = filter$1.id;\n\t        var name = filter$1.name;\n\t        // Generate a hash code from the stringified filter definition. This gives us\n\t        // a unique filter ID for different definitions.\n\t        if (!filterId) {\n\t            filterId = name + this.svg.id + hashCode(JSON.stringify(filter$1));\n\t        }\n\t        // If the filter already exists in the document,\n\t        // we're done and we can just use it (reference it using `url()`).\n\t        // If not, create one.\n\t        if (!this.isDefined(filterId)) {\n\n\t            var namespace = filter;\n\t            var filterSVGString = namespace[name] && namespace[name](filter$1.args || {});\n\t            if (!filterSVGString) {\n\t                throw new Error('Non-existing filter ' + name);\n\t            }\n\n\t            // Set the filter area to be 3x the bounding box of the cell\n\t            // and center the filter around the cell.\n\t            var filterAttrs = assign({\n\t                filterUnits: 'objectBoundingBox',\n\t                x: -1,\n\t                y: -1,\n\t                width: 3,\n\t                height: 3\n\t            }, filter$1.attrs, {\n\t                id: filterId\n\t            });\n\n\t            V(filterSVGString, filterAttrs).appendTo(this.defs);\n\t        }\n\n\t        return filterId;\n\t    },\n\n\t    defineGradient: function(gradient) {\n\t        if (!isObject$1(gradient)) {\n\t            throw new TypeError('dia.Paper: defineGradient() requires 1. argument to be an object.');\n\t        }\n\t        var ref = this;\n\t        var svg = ref.svg;\n\t        var defs = ref.defs;\n\t        var type = gradient.type;\n\t        var id = gradient.id; if ( id === void 0 ) id = type + svg.id + hashCode(JSON.stringify(gradient));\n\t        var stops = gradient.stops;\n\t        var attrs = gradient.attrs; if ( attrs === void 0 ) attrs = {};\n\t        // If the gradient already exists in the document,\n\t        // we're done and we can just use it (reference it using `url()`).\n\t        if (this.isDefined(id)) { return id; }\n\t        // If not, create one.\n\t        var stopVEls = toArray(stops).map(function (ref) {\n\t            var offset = ref.offset;\n\t            var color = ref.color;\n\t            var opacity = ref.opacity;\n\n\t            return V('stop').attr({\n\t                'offset': offset,\n\t                'stop-color': color,\n\t                'stop-opacity': Number.isFinite(opacity) ? opacity : 1\n\t            });\n\t        });\n\t        var gradientVEl = V(type, attrs, stopVEls);\n\t        gradientVEl.id = id;\n\t        gradientVEl.appendTo(defs);\n\t        return id;\n\t    },\n\n\t    definePattern: function(pattern) {\n\t        if (!isObject$1(pattern)) {\n\t            throw new TypeError('dia.Paper: definePattern() requires 1. argument to be an object.');\n\t        }\n\t        var ref = this;\n\t        var svg = ref.svg;\n\t        var defs = ref.defs;\n\t        var id = pattern.id; if ( id === void 0 ) id = svg.id + hashCode(JSON.stringify(pattern));\n\t        var markup = pattern.markup;\n\t        var attrs = pattern.attrs; if ( attrs === void 0 ) attrs = {};\n\t        if (!markup) {\n\t            throw new TypeError('dia.Paper: definePattern() requires markup.');\n\t        }\n\t        // If the gradient already exists in the document,\n\t        // we're done and we can just use it (reference it using `url()`).\n\t        if (this.isDefined(id)) { return id; }\n\t        // If not, create one.\n\t        var patternVEl = V('pattern', {\n\t            patternUnits: 'userSpaceOnUse'\n\t        });\n\t        patternVEl.id = id;\n\t        patternVEl.attr(attrs);\n\t        if (typeof markup === 'string') {\n\t            patternVEl.append(V(markup));\n\t        } else {\n\t            var ref$1 = parseDOMJSON(markup);\n\t            var fragment = ref$1.fragment;\n\t            patternVEl.append(fragment);\n\t        }\n\t        patternVEl.appendTo(defs);\n\t        return id;\n\t    },\n\n\t    defineMarker: function(marker) {\n\t        if (!isObject$1(marker)) {\n\t            throw new TypeError('dia.Paper: defineMarker() requires 1. argument to be an object.');\n\t        }\n\t        var ref = this;\n\t        var svg = ref.svg;\n\t        var defs = ref.defs;\n\t        var id = marker.id; if ( id === void 0 ) id = svg.id + hashCode(JSON.stringify(marker));\n\t        var markup = marker.markup;\n\t        var attrs = marker.attrs; if ( attrs === void 0 ) attrs = {};\n\t        var markerUnits = marker.markerUnits; if ( markerUnits === void 0 ) markerUnits = 'userSpaceOnUse';\n\t        // If the marker already exists in the document,\n\t        // we're done and we can just use it (reference it using `url()`).\n\t        if (this.isDefined(id)) { return id; }\n\t        // If not, create one.\n\t        var markerVEl = V('marker', {\n\t            orient: 'auto',\n\t            overflow: 'visible',\n\t            markerUnits: markerUnits\n\t        });\n\t        markerVEl.id = id;\n\t        markerVEl.attr(attrs);\n\t        if (markup) {\n\t            if (typeof markup === 'string') {\n\t                markerVEl.append(V(markup));\n\t            } else {\n\t                var ref$1 = parseDOMJSON(markup);\n\t                var fragment = ref$1.fragment;\n\t                markerVEl.append(fragment);\n\t            }\n\t        } else {\n\t            // marker object is a flat structure\n\t            var type = marker.type; if ( type === void 0 ) type = 'path';\n\t            var markerContentVEl = V(type, omit(marker, 'type', 'id', 'markup', 'attrs', 'markerUnits'));\n\t            markerVEl.append(markerContentVEl);\n\t        }\n\t        markerVEl.appendTo(defs);\n\t        return id;\n\t    }\n\n\t}, {\n\n\t    sorting: sortingTypes,\n\n\t    Layers: LayersNames,\n\n\t    backgroundPatterns: {\n\n\t        flipXy: function(img) {\n\t            // d b\n\t            // q p\n\n\t            var canvas = document.createElement('canvas');\n\t            var imgWidth = img.width;\n\t            var imgHeight = img.height;\n\n\t            canvas.width = 2 * imgWidth;\n\t            canvas.height = 2 * imgHeight;\n\n\t            var ctx = canvas.getContext('2d');\n\t            // top-left image\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\t            // xy-flipped bottom-right image\n\t            ctx.setTransform(-1, 0, 0, -1, canvas.width, canvas.height);\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\t            // x-flipped top-right image\n\t            ctx.setTransform(-1, 0, 0, 1, canvas.width, 0);\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\t            // y-flipped bottom-left image\n\t            ctx.setTransform(1, 0, 0, -1, 0, canvas.height);\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\n\t            return canvas;\n\t        },\n\n\t        flipX: function(img) {\n\t            // d b\n\t            // d b\n\n\t            var canvas = document.createElement('canvas');\n\t            var imgWidth = img.width;\n\t            var imgHeight = img.height;\n\n\t            canvas.width = imgWidth * 2;\n\t            canvas.height = imgHeight;\n\n\t            var ctx = canvas.getContext('2d');\n\t            // left image\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\t            // flipped right image\n\t            ctx.translate(2 * imgWidth, 0);\n\t            ctx.scale(-1, 1);\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\n\t            return canvas;\n\t        },\n\n\t        flipY: function(img) {\n\t            // d d\n\t            // q q\n\n\t            var canvas = document.createElement('canvas');\n\t            var imgWidth = img.width;\n\t            var imgHeight = img.height;\n\n\t            canvas.width = imgWidth;\n\t            canvas.height = imgHeight * 2;\n\n\t            var ctx = canvas.getContext('2d');\n\t            // top image\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\t            // flipped bottom image\n\t            ctx.translate(0, 2 * imgHeight);\n\t            ctx.scale(1, -1);\n\t            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\n\t            return canvas;\n\t        },\n\n\t        watermark: function(img, opt) {\n\t            //   d\n\t            // d\n\n\t            opt = opt || {};\n\n\t            var imgWidth = img.width;\n\t            var imgHeight = img.height;\n\n\t            var canvas = document.createElement('canvas');\n\t            canvas.width = imgWidth * 3;\n\t            canvas.height = imgHeight * 3;\n\n\t            var ctx = canvas.getContext('2d');\n\t            var angle = isNumber(opt.watermarkAngle) ? -opt.watermarkAngle : -20;\n\t            var radians = toRad(angle);\n\t            var stepX = canvas.width / 4;\n\t            var stepY = canvas.height / 4;\n\n\t            for (var i = 0; i < 4; i++) {\n\t                for (var j = 0; j < 4; j++) {\n\t                    if ((i + j) % 2 > 0) {\n\t                        // reset the current transformations\n\t                        ctx.setTransform(1, 0, 0, 1, (2 * i - 1) * stepX, (2 * j - 1) * stepY);\n\t                        ctx.rotate(radians);\n\t                        ctx.drawImage(img, -imgWidth / 2, -imgHeight / 2, imgWidth, imgHeight);\n\t                    }\n\t                }\n\t            }\n\n\t            return canvas;\n\t        }\n\t    },\n\n\t    gridPatterns: {\n\t        dot: [{\n\t            color: '#AAAAAA',\n\t            thickness: 1,\n\t            markup: 'rect',\n\t            update: function(el, opt) {\n\t                V(el).attr({\n\t                    width: opt.thickness * opt.sx,\n\t                    height: opt.thickness * opt.sy,\n\t                    fill: opt.color\n\t                });\n\t            }\n\t        }],\n\t        fixedDot: [{\n\t            color: '#AAAAAA',\n\t            thickness: 1,\n\t            markup: 'rect',\n\t            update: function(el, opt) {\n\t                var size = opt.sx <= 1 ? opt.thickness * opt.sx : opt.thickness;\n\t                V(el).attr({ width: size, height: size, fill: opt.color });\n\t            }\n\t        }],\n\t        mesh: [{\n\t            color: '#AAAAAA',\n\t            thickness: 1,\n\t            markup: 'path',\n\t            update: function(el, opt) {\n\n\t                var d;\n\t                var width = opt.width;\n\t                var height = opt.height;\n\t                var thickness = opt.thickness;\n\n\t                if (width - thickness >= 0 && height - thickness >= 0) {\n\t                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');\n\t                } else {\n\t                    d = 'M 0 0 0 0';\n\t                }\n\n\t                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });\n\t            }\n\t        }],\n\t        doubleMesh: [{\n\t            color: '#AAAAAA',\n\t            thickness: 1,\n\t            markup: 'path',\n\t            update: function(el, opt) {\n\n\t                var d;\n\t                var width = opt.width;\n\t                var height = opt.height;\n\t                var thickness = opt.thickness;\n\n\t                if (width - thickness >= 0 && height - thickness >= 0) {\n\t                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');\n\t                } else {\n\t                    d = 'M 0 0 0 0';\n\t                }\n\n\t                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });\n\t            }\n\t        }, {\n\t            color: '#000000',\n\t            thickness: 3,\n\t            scaleFactor: 4,\n\t            markup: 'path',\n\t            update: function(el, opt) {\n\n\t                var d;\n\t                var width = opt.width;\n\t                var height = opt.height;\n\t                var thickness = opt.thickness;\n\n\t                if (width - thickness >= 0 && height - thickness >= 0) {\n\t                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');\n\t                } else {\n\t                    d = 'M 0 0 0 0';\n\t                }\n\n\t                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });\n\t            }\n\t        }]\n\t    }\n\t});\n\n\tvar ToolView = View.extend({\n\t    name: null,\n\t    tagName: 'g',\n\t    className: 'tool',\n\t    svgElement: true,\n\t    _visible: true,\n\n\t    init: function() {\n\t        var name = this.name;\n\t        if (name) { this.vel.attr('data-tool-name', name); }\n\t    },\n\n\t    configure: function(view, toolsView) {\n\t        this.relatedView = view;\n\t        this.paper = view.paper;\n\t        this.parentView = toolsView;\n\t        this.simulateRelatedView(this.el);\n\t        // Delegate events in case the ToolView was removed from the DOM and reused.\n\t        this.delegateEvents();\n\t        return this;\n\t    },\n\n\t    simulateRelatedView: function(el) {\n\t        if (el) { el.setAttribute('model-id', this.relatedView.model.id); }\n\t    },\n\n\t    getName: function() {\n\t        return this.name;\n\t    },\n\n\t    show: function() {\n\t        this.el.style.display = '';\n\t        this._visible = true;\n\t    },\n\n\t    hide: function() {\n\t        this.el.style.display = 'none';\n\t        this._visible = false;\n\t    },\n\n\t    isVisible: function() {\n\t        return !!this._visible;\n\t    },\n\n\t    focus: function() {\n\t        var opacity = this.options.focusOpacity;\n\t        if (isFinite(opacity)) { this.el.style.opacity = opacity; }\n\t        this.parentView.focusTool(this);\n\t    },\n\n\t    blur: function() {\n\t        this.el.style.opacity = '';\n\t        this.parentView.blurTool(this);\n\t    },\n\n\t    update: function() {\n\t        // to be overridden\n\t    },\n\n\t    guard: function(evt) {\n\t        // Let the context-menu event bubble up to the relatedView\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var relatedView = ref.relatedView;\n\t        if (!paper || !relatedView) { return true; }\n\t        return paper.guard(evt, relatedView);\n\t    }\n\t});\n\n\tvar ToolsView = View.extend({\n\t    tagName: 'g',\n\t    className: 'tools',\n\t    svgElement: true,\n\t    tools: null,\n\t    isRendered: false,\n\t    options: {\n\t        tools: null,\n\t        relatedView: null,\n\t        name: null,\n\t        // layer?: LayersNames.TOOLS\n\t        // z?: number\n\t    },\n\n\t    configure: function(options) {\n\t        options = assign(this.options, options);\n\t        var tools = options.tools;\n\t        if (!Array.isArray(tools)) { return this; }\n\t        var relatedView = options.relatedView;\n\t        if (!(relatedView instanceof CellView)) { return this; }\n\t        var views = this.tools = [];\n\t        for (var i = 0, n = tools.length; i < n; i++) {\n\t            var tool = tools[i];\n\t            if (!(tool instanceof ToolView)) { continue; }\n\t            tool.configure(relatedView, this);\n\t            this.vel.append(tool.el);\n\t            views.push(tool);\n\t        }\n\t        this.isRendered = false;\n\t        relatedView.requestUpdate(relatedView.getFlag('TOOLS'));\n\t        return this;\n\t    },\n\n\t    getName: function() {\n\t        return this.options.name;\n\t    },\n\n\t    update: function(opt) {\n\n\t        opt || (opt = {});\n\t        var tools = this.tools;\n\t        if (!tools) { return this; }\n\t        var isRendered = this.isRendered;\n\t        for (var i = 0, n = tools.length; i < n; i++) {\n\t            var tool = tools[i];\n\t            if (!isRendered) {\n\t                // First update executes render()\n\t                tool.render();\n\t            } else if (opt.tool !== tool.cid && tool.isVisible()) {\n\t                tool.update();\n\t            }\n\t        }\n\t        if (!isRendered) {\n\t            this.mount();\n\t            // Make sure tools are visible (if they were hidden and the tool removed)\n\t            this.blurTool();\n\t            this.isRendered = true;\n\t        }\n\t        return this;\n\t    },\n\n\t    focusTool: function(focusedTool) {\n\n\t        var tools = this.tools;\n\t        if (!tools) { return this; }\n\t        for (var i = 0, n = tools.length; i < n; i++) {\n\t            var tool = tools[i];\n\t            if (focusedTool === tool) {\n\t                tool.show();\n\t            } else {\n\t                tool.hide();\n\t            }\n\t        }\n\t        return this;\n\t    },\n\n\t    blurTool: function(blurredTool) {\n\t        var tools = this.tools;\n\t        if (!tools) { return this; }\n\t        for (var i = 0, n = tools.length; i < n; i++) {\n\t            var tool = tools[i];\n\t            if (tool !== blurredTool && !tool.isVisible()) {\n\t                tool.show();\n\t                tool.update();\n\t            }\n\t        }\n\t        return this;\n\t    },\n\n\t    hide: function() {\n\t        return this.focusTool(null);\n\t    },\n\n\t    show: function() {\n\t        return this.blurTool(null);\n\t    },\n\n\t    onRemove: function() {\n\t        var tools = this.tools;\n\t        if (!tools) { return this; }\n\t        for (var i = 0, n = tools.length; i < n; i++) {\n\t            tools[i].remove();\n\t        }\n\t        this.tools = null;\n\t    },\n\n\t    mount: function() {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var el = ref.el;\n\t        var relatedView = options.relatedView;\n\t        var layer = options.layer; if ( layer === void 0 ) layer = LayersNames.TOOLS;\n\t        var z = options.z;\n\t        if (relatedView) {\n\t            if (layer) {\n\t                relatedView.paper.getLayerView(layer).insertSortedNode(el, z);\n\t            } else {\n\t                relatedView.el.appendChild(el);\n\t            }\n\t        }\n\t        return this;\n\t    }\n\n\t});\n\n\n\n\tvar index$2 = ({\n\t\tGraph: Graph,\n\t\tattributes: attributes,\n\t\tLayersNames: LayersNames,\n\t\tPaperLayer: PaperLayer,\n\t\tCell: Cell,\n\t\tCellView: CellView,\n\t\tElement: Element$1,\n\t\tElementView: ElementView,\n\t\tLink: Link,\n\t\tLinkView: LinkView,\n\t\tPaper: Paper,\n\t\tToolView: ToolView,\n\t\tToolsView: ToolsView,\n\t\tHighlighterView: HighlighterView\n\t});\n\n\tvar DirectedGraph = {\n\n\t    exportElement: function(element) {\n\n\t        // The width and height of the element.\n\t        return element.size();\n\t    },\n\n\t    exportLink: function(link) {\n\n\t        var labelSize = link.get('labelSize') || {};\n\t        var edge = {\n\t            // The number of ranks to keep between the source and target of the edge.\n\t            minLen: link.get('minLen') || 1,\n\t            // The weight to assign edges. Higher weight edges are generally\n\t            // made shorter and straighter than lower weight edges.\n\t            weight: link.get('weight') || 1,\n\t            // Where to place the label relative to the edge.\n\t            // l = left, c = center r = right.\n\t            labelpos: link.get('labelPosition') || 'c',\n\t            // How many pixels to move the label away from the edge.\n\t            // Applies only when labelpos is l or r.\n\t            labeloffset: link.get('labelOffset') || 0,\n\t            // The width of the edge label in pixels.\n\t            width: labelSize.width || 0,\n\t            // The height of the edge label in pixels.\n\t            height: labelSize.height || 0\n\t        };\n\n\t        return edge;\n\t    },\n\n\t    importElement: function(opt, v, gl) {\n\n\t        var element = this.getCell(v);\n\t        var glNode = gl.node(v);\n\n\t        if (opt.setPosition) {\n\t            opt.setPosition(element, glNode);\n\t        } else {\n\t            element.set('position', {\n\t                x: glNode.x - glNode.width / 2,\n\t                y: glNode.y - glNode.height / 2\n\t            });\n\t        }\n\t    },\n\n\t    importLink: function(opt, edgeObj, gl) {\n\n\t        var SIMPLIFY_THRESHOLD = 0.001;\n\n\t        var link = this.getCell(edgeObj.name);\n\t        var glEdge = gl.edge(edgeObj);\n\t        var points = glEdge.points || [];\n\t        var polyline = new Polyline(points);\n\n\t        // check the `setLinkVertices` here for backwards compatibility\n\t        if (opt.setVertices || opt.setLinkVertices) {\n\t            if (isFunction(opt.setVertices)) {\n\t                opt.setVertices(link, points);\n\t            } else {\n\t                // simplify the `points` polyline\n\t                polyline.simplify({ threshold: SIMPLIFY_THRESHOLD });\n\t                var polylinePoints = polyline.points.map(function (point) { return (point.toJSON()); }); // JSON of points after simplification\n\t                var numPolylinePoints = polylinePoints.length; // number of points after simplification\n\t                // set simplified polyline points as link vertices\n\t                // remove first and last polyline points (= source/target sonnectionPoints)\n\t                link.set('vertices', polylinePoints.slice(1, numPolylinePoints - 1));\n\t            }\n\t        }\n\n\t        if (opt.setLabels && ('x' in glEdge) && ('y' in glEdge)) {\n\t            var labelPosition = { x: glEdge.x, y: glEdge.y };\n\t            if (isFunction(opt.setLabels)) {\n\t                opt.setLabels(link, labelPosition, points);\n\t            } else {\n\t                // convert the absolute label position to a relative position\n\t                // towards the closest point on the edge\n\t                var length = polyline.closestPointLength(labelPosition);\n\t                var closestPoint = polyline.pointAtLength(length);\n\t                var distance = (length / polyline.length());\n\t                var offset = new Point(labelPosition).difference(closestPoint).toJSON();\n\t                link.label(0, {\n\t                    position: {\n\t                        distance: distance,\n\t                        offset: offset\n\t                    }\n\t                });\n\t            }\n\t        }\n\t    },\n\n\t    layout: function(graphOrCells, opt) {\n\n\t        var graph;\n\n\t        if (graphOrCells instanceof Graph) {\n\t            graph = graphOrCells;\n\t        } else {\n\t            // Reset cells in dry mode so the graph reference is not stored on the cells.\n\t            // `sort: false` to prevent elements to change their order based on the z-index\n\t            graph = (new Graph()).resetCells(graphOrCells, { dry: true, sort: false });\n\t        }\n\n\t        // This is not needed anymore.\n\t        graphOrCells = null;\n\n\t        opt = defaults(opt || {}, {\n\t            resizeClusters: true,\n\t            clusterPadding: 10,\n\t            exportElement: this.exportElement,\n\t            exportLink: this.exportLink\n\t        });\n\n\t        /* eslint-disable no-undef */\n\t        var dagreUtil = opt.dagre || (typeof dagre !== 'undefined' ? dagre : undefined);\n\t        /* eslint-enable no-undef */\n\n\t        if (dagreUtil === undefined) { throw new Error('The the \"dagre\" utility is a mandatory dependency.'); }\n\n\t        // create a graphlib.Graph that represents the joint.dia.Graph\n\t        // var glGraph = graph.toGraphLib({\n\t        var glGraph = DirectedGraph.toGraphLib(graph, {\n\t            graphlib: opt.graphlib,\n\t            directed: true,\n\t            // We are about to use edge naming feature.\n\t            multigraph: true,\n\t            // We are able to layout graphs with embeds.\n\t            compound: true,\n\t            setNodeLabel: opt.exportElement,\n\t            setEdgeLabel: opt.exportLink,\n\t            setEdgeName: function(link) {\n\t                // Graphlib edges have no ids. We use edge name property\n\t                // to store and retrieve ids instead.\n\t                return link.id;\n\t            }\n\t        });\n\n\t        var glLabel = {};\n\t        var marginX = opt.marginX || 0;\n\t        var marginY = opt.marginY || 0;\n\n\t        // Dagre layout accepts options as lower case.\n\t        // Direction for rank nodes. Can be TB, BT, LR, or RL\n\t        if (opt.rankDir) { glLabel.rankdir = opt.rankDir; }\n\t        // Alignment for rank nodes. Can be UL, UR, DL, or DR\n\t        if (opt.align) { glLabel.align = opt.align; }\n\t        // Number of pixels that separate nodes horizontally in the layout.\n\t        if (opt.nodeSep) { glLabel.nodesep = opt.nodeSep; }\n\t        // Number of pixels that separate edges horizontally in the layout.\n\t        if (opt.edgeSep) { glLabel.edgesep = opt.edgeSep; }\n\t        // Number of pixels between each rank in the layout.\n\t        if (opt.rankSep) { glLabel.ranksep = opt.rankSep; }\n\t        // Type of algorithm to assign a rank to each node in the input graph.\n\t        // Possible values: network-simplex, tight-tree or longest-path\n\t        if (opt.ranker) { glLabel.ranker = opt.ranker; }\n\t        // Number of pixels to use as a margin around the left and right of the graph.\n\t        if (marginX) { glLabel.marginx = marginX; }\n\t        // Number of pixels to use as a margin around the top and bottom of the graph.\n\t        if (marginY) { glLabel.marginy = marginY; }\n\n\t        // Set the option object for the graph label.\n\t        glGraph.setGraph(glLabel);\n\n\t        // Executes the layout.\n\t        dagreUtil.layout(glGraph, { debugTiming: !!opt.debugTiming });\n\n\t        // Wrap all graph changes into a batch.\n\t        graph.startBatch('layout');\n\n\t        DirectedGraph.fromGraphLib(glGraph, {\n\t            importNode: this.importElement.bind(graph, opt),\n\t            importEdge: this.importLink.bind(graph, opt)\n\t        });\n\n\t        // // Update the graph.\n\t        // graph.fromGraphLib(glGraph, {\n\t        //     importNode: this.importElement.bind(graph, opt),\n\t        //     importEdge: this.importLink.bind(graph, opt)\n\t        // });\n\n\t        if (opt.resizeClusters) {\n\t            // Resize and reposition cluster elements (parents of other elements)\n\t            // to fit their children.\n\t            // 1. filter clusters only\n\t            // 2. map id on cells\n\t            // 3. sort cells by their depth (the deepest first)\n\t            // 4. resize cell to fit their direct children only.\n\t            var clusters = glGraph.nodes()\n\t                .filter(function(v) { return glGraph.children(v).length > 0; })\n\t                .map(graph.getCell.bind(graph))\n\t                .sort(function(aCluster, bCluster) {\n\t                    return bCluster.getAncestors().length - aCluster.getAncestors().length;\n\t                });\n\n\t            invoke(clusters, 'fitEmbeds', { padding: opt.clusterPadding });\n\t        }\n\n\t        graph.stopBatch('layout');\n\n\t        // Width and height of the graph extended by margins.\n\t        var glSize = glGraph.graph();\n\t        // Return the bounding box of the graph after the layout.\n\t        return new Rect(\n\t            marginX,\n\t            marginY,\n\t            Math.abs(glSize.width - 2 * marginX),\n\t            Math.abs(glSize.height - 2 * marginY)\n\t        );\n\t    },\n\n\t    fromGraphLib: function(glGraph, opt) {\n\n\t        opt = opt || {};\n\n\t        var importNode = opt.importNode || noop;\n\t        var importEdge = opt.importEdge || noop;\n\t        var graph = (this instanceof Graph) ? this : new Graph;\n\n\t        // Import all nodes.\n\t        glGraph.nodes().forEach(function(node) {\n\t            importNode.call(graph, node, glGraph, graph, opt);\n\t        });\n\n\t        // Import all edges.\n\t        glGraph.edges().forEach(function(edge) {\n\t            importEdge.call(graph, edge, glGraph, graph, opt);\n\t        });\n\n\t        return graph;\n\t    },\n\n\t    // Create new graphlib graph from existing JointJS graph.\n\t    toGraphLib: function(graph, opt) {\n\n\t        opt = opt || {};\n\n\t        /* eslint-disable no-undef */\n\t        var graphlibUtil = opt.graphlib || (typeof graphlib !== 'undefined' ? graphlib : undefined);\n\t        /* eslint-enable no-undef */\n\n\t        if (graphlibUtil === undefined) { throw new Error('The the \"graphlib\" utility is a mandatory dependency.'); }\n\n\t        var glGraphType = pick(opt, 'directed', 'compound', 'multigraph');\n\t        var glGraph = new graphlibUtil.Graph(glGraphType);\n\t        var setNodeLabel = opt.setNodeLabel || noop;\n\t        var setEdgeLabel = opt.setEdgeLabel || noop;\n\t        var setEdgeName = opt.setEdgeName || noop;\n\t        var collection = graph.get('cells');\n\n\t        for (var i = 0, n = collection.length; i < n; i++) {\n\n\t            var cell = collection.at(i);\n\t            if (cell.isLink()) {\n\n\t                var source = cell.get('source');\n\t                var target = cell.get('target');\n\n\t                // Links that end at a point are ignored.\n\t                if (!source.id || !target.id) { break; }\n\n\t                // Note that if we are creating a multigraph we can name the edges. If\n\t                // we try to name edges on a non-multigraph an exception is thrown.\n\t                glGraph.setEdge(source.id, target.id, setEdgeLabel(cell), setEdgeName(cell));\n\n\t            } else {\n\n\t                glGraph.setNode(cell.id, setNodeLabel(cell));\n\n\t                // For the compound graphs we have to take embeds into account.\n\t                if (glGraph.isCompound() && cell.has('parent')) {\n\t                    var parentId = cell.get('parent');\n\t                    if (collection.has(parentId)) {\n\t                        // Make sure the parent cell is included in the graph (this can\n\t                        // happen when the layout is run on part of the graph only).\n\t                        glGraph.setParent(cell.id, parentId);\n\t                    }\n\t                }\n\t            }\n\t        }\n\n\t        return glGraph;\n\t    }\n\t};\n\n\tGraph.prototype.toGraphLib = function(opt) {\n\n\t    return DirectedGraph.toGraphLib(this, opt);\n\t};\n\n\tGraph.prototype.fromGraphLib = function(glGraph, opt) {\n\n\t    return DirectedGraph.fromGraphLib.call(this, glGraph, opt);\n\t};\n\n\tvar env = {\n\n\t    _results: {},\n\n\t    _tests: {\n\n\t        svgforeignobject: function() {\n\t            return !!document.createElementNS &&\n\t                /SVGForeignObject/.test(({}).toString.call(document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject')));\n\t        }\n\t    },\n\n\t    addTest: function(name, fn) {\n\n\t        return this._tests[name] = fn;\n\t    },\n\n\t    test: function(name) {\n\n\t        var fn = this._tests[name];\n\n\t        if (!fn) {\n\t            throw new Error('Test not defined (\"' + name + '\"). Use `joint.env.addTest(name, fn) to add a new test.`');\n\t        }\n\n\t        var result = this._results[name];\n\n\t        if (typeof result !== 'undefined') {\n\t            return result;\n\t        }\n\n\t        try {\n\t            result = fn();\n\t        } catch (error) {\n\t            result = false;\n\t        }\n\n\t        // Cache the test result.\n\t        this._results[name] = result;\n\n\t        return result;\n\t    }\n\t};\n\n\tvar Generic = Element$1.define('basic.Generic', {\n\t    attrs: {\n\t        '.': { fill: '#ffffff', stroke: 'none' }\n\t    }\n\t});\n\n\tvar Rect$1 = Generic.define('basic.Rect', {\n\t    attrs: {\n\t        'rect': {\n\t            fill: '#ffffff',\n\t            stroke: '#000000',\n\t            width: 100,\n\t            height: 60\n\t        },\n\t        'text': {\n\t            fill: '#000000',\n\t            text: '',\n\t            'font-size': 14,\n\t            'ref-x': .5,\n\t            'ref-y': .5,\n\t            'text-anchor': 'middle',\n\t            'y-alignment': 'middle',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect/></g><text/></g>'\n\t});\n\n\tvar TextView = ElementView.extend({\n\n\t    presentationAttributes: ElementView.addPresentationAttributes({\n\t        // The element view is not automatically re-scaled to fit the model size\n\t        // when the attribute 'attrs' is changed.\n\t        attrs: ['SCALE']\n\t    }),\n\n\t    confirmUpdate: function() {\n\t        var flags = ElementView.prototype.confirmUpdate.apply(this, arguments);\n\t        if (this.hasFlag(flags, 'SCALE')) {\n\t            this.resize();\n\t            flags = this.removeFlag(flags, 'SCALE');\n\t        }\n\t        return flags;\n\t    }\n\t});\n\n\tvar Text = Generic.define('basic.Text', {\n\t    attrs: {\n\t        'text': {\n\t            'font-size': 18,\n\t            fill: '#000000'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><text/></g></g>',\n\t});\n\n\tvar Circle = Generic.define('basic.Circle', {\n\t    size: { width: 60, height: 60 },\n\t    attrs: {\n\t        'circle': {\n\t            fill: '#ffffff',\n\t            stroke: '#000000',\n\t            r: 30,\n\t            cx: 30,\n\t            cy: 30\n\t        },\n\t        'text': {\n\t            'font-size': 14,\n\t            text: '',\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-y': .5,\n\t            'y-alignment': 'middle',\n\t            fill: '#000000',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle/></g><text/></g>',\n\t});\n\n\tvar Ellipse$1 = Generic.define('basic.Ellipse', {\n\t    size: { width: 60, height: 40 },\n\t    attrs: {\n\t        'ellipse': {\n\t            fill: '#ffffff',\n\t            stroke: '#000000',\n\t            rx: 30,\n\t            ry: 20,\n\t            cx: 30,\n\t            cy: 20\n\t        },\n\t        'text': {\n\t            'font-size': 14,\n\t            text: '',\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-y': .5,\n\t            'y-alignment': 'middle',\n\t            fill: '#000000',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><ellipse/></g><text/></g>',\n\t});\n\n\tvar Polygon$1 = Generic.define('basic.Polygon', {\n\t    size: { width: 60, height: 40 },\n\t    attrs: {\n\t        'polygon': {\n\t            fill: '#ffffff',\n\t            stroke: '#000000'\n\t        },\n\t        'text': {\n\t            'font-size': 14,\n\t            text: '',\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-dy': 20,\n\t            'y-alignment': 'middle',\n\t            fill: '#000000',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon/></g><text/></g>',\n\t});\n\n\tvar Polyline$1 = Generic.define('basic.Polyline', {\n\t    size: { width: 60, height: 40 },\n\t    attrs: {\n\t        'polyline': {\n\t            fill: '#ffffff',\n\t            stroke: '#000000'\n\t        },\n\t        'text': {\n\t            'font-size': 14,\n\t            text: '',\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-dy': 20,\n\t            'y-alignment': 'middle',\n\t            fill: '#000000',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polyline/></g><text/></g>',\n\t});\n\n\tvar Image = Generic.define('basic.Image', {\n\t    attrs: {\n\t        'text': {\n\t            'font-size': 14,\n\t            text: '',\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-dy': 20,\n\t            'y-alignment': 'middle',\n\t            fill: '#000000',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><image/></g><text/></g>',\n\t});\n\n\tvar Path$1 = Generic.define('basic.Path', {\n\t    size: { width: 60, height: 60 },\n\t    attrs: {\n\t        'path': {\n\t            fill: '#ffffff',\n\t            stroke: '#000000'\n\t        },\n\t        'text': {\n\t            'font-size': 14,\n\t            text: '',\n\t            'text-anchor': 'middle',\n\t            'ref': 'path',\n\t            'ref-x': .5,\n\t            'ref-dy': 10,\n\t            fill: '#000000',\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        }\n\t    }\n\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><path/></g><text/></g>',\n\t});\n\n\tvar Rhombus = Path$1.define('basic.Rhombus', {\n\t    attrs: {\n\t        'path': {\n\t            d: 'M 30 0 L 60 30 30 60 0 30 z'\n\t        },\n\t        'text': {\n\t            'ref-y': .5,\n\t            'ref-dy': null,\n\t            'y-alignment': 'middle'\n\t        }\n\t    }\n\t});\n\n\tvar svgForeignObjectSupported = env.test('svgforeignobject');\n\n\tvar TextBlock = Generic.define('basic.TextBlock', {\n\t    // see joint.css for more element styles\n\t    attrs: {\n\t        rect: {\n\t            fill: '#ffffff',\n\t            stroke: '#000000',\n\t            width: 80,\n\t            height: 100\n\t        },\n\t        text: {\n\t            fill: '#000000',\n\t            'font-size': 14,\n\t            'font-family': 'Arial, helvetica, sans-serif'\n\t        },\n\t        '.content': {\n\t            text: '',\n\t            'ref-x': .5,\n\t            'ref-y': .5,\n\t            'y-alignment': 'middle',\n\t            'x-alignment': 'middle'\n\t        }\n\t    },\n\n\t    content: ''\n\t}, {\n\t    markup: [\n\t        '<g class=\"rotatable\">',\n\t        '<g class=\"scalable\"><rect/></g>',\n\t        svgForeignObjectSupported\n\t            ? '<foreignObject class=\"fobj\"><body xmlns=\"http://www.w3.org/1999/xhtml\"><div class=\"content\"/></body></foreignObject>'\n\t            : '<text class=\"content\"/>',\n\t        '</g>'\n\t    ].join(''),\n\n\t    initialize: function() {\n\n\t        this.listenTo(this, 'change:size', this.updateSize);\n\t        this.listenTo(this, 'change:content', this.updateContent);\n\t        this.updateSize(this, this.get('size'));\n\t        this.updateContent(this, this.get('content'));\n\t        Generic.prototype.initialize.apply(this, arguments);\n\t    },\n\n\t    updateSize: function(cell, size) {\n\n\t        // Selector `foreignObject' doesn't work across all browsers, we're using class selector instead.\n\t        // We have to clone size as we don't want attributes.div.style to be same object as attributes.size.\n\t        this.attr({\n\t            '.fobj': assign({}, size),\n\t            div: {\n\t                style: assign({}, size)\n\t            }\n\t        });\n\t    },\n\n\t    updateContent: function(cell, content) {\n\n\t        if (svgForeignObjectSupported) {\n\n\t            // Content element is a <div> element.\n\t            this.attr({\n\t                '.content': {\n\t                    html: sanitizeHTML(content)\n\t                }\n\t            });\n\n\t        } else {\n\n\t            // Content element is a <text> element.\n\t            // SVG elements don't have innerHTML attribute.\n\t            this.attr({\n\t                '.content': {\n\t                    text: content\n\t                }\n\t            });\n\t        }\n\t    },\n\n\t    // Here for backwards compatibility:\n\t    setForeignObjectSize: function() {\n\n\t        this.updateSize.apply(this, arguments);\n\t    },\n\n\t    // Here for backwards compatibility:\n\t    setDivContent: function() {\n\n\t        this.updateContent.apply(this, arguments);\n\t    }\n\t});\n\n\t// TextBlockView implements the fallback for IE when no foreignObject exists and\n\t// the text needs to be manually broken.\n\tvar TextBlockView = ElementView.extend({\n\n\t    presentationAttributes: svgForeignObjectSupported\n\t        ? ElementView.prototype.presentationAttributes\n\t        : ElementView.addPresentationAttributes({\n\t            content: ['CONTENT'],\n\t            size: ['CONTENT']\n\t        }),\n\n\t    initFlag: ['RENDER', 'CONTENT'],\n\n\t    confirmUpdate: function() {\n\t        var flags = ElementView.prototype.confirmUpdate.apply(this, arguments);\n\t        if (this.hasFlag(flags, 'CONTENT')) {\n\t            this.updateContent(this.model);\n\t            flags = this.removeFlag(flags, 'CONTENT');\n\t        }\n\t        return flags;\n\t    },\n\n\t    update: function(_, renderingOnlyAttrs) {\n\n\t        var model = this.model;\n\n\t        if (!svgForeignObjectSupported) {\n\n\t            // Update everything but the content first.\n\t            var noTextAttrs = omit(renderingOnlyAttrs || model.get('attrs'), '.content');\n\t            ElementView.prototype.update.call(this, model, noTextAttrs);\n\n\t            if (!renderingOnlyAttrs || has$2(renderingOnlyAttrs, '.content')) {\n\t                // Update the content itself.\n\t                this.updateContent(model, renderingOnlyAttrs);\n\t            }\n\n\t        } else {\n\n\t            ElementView.prototype.update.call(this, model, renderingOnlyAttrs);\n\t        }\n\t    },\n\n\t    updateContent: function(cell, renderingOnlyAttrs) {\n\n\t        // Create copy of the text attributes\n\t        var textAttrs = merge({}, (renderingOnlyAttrs || cell.get('attrs'))['.content']);\n\n\t        textAttrs = omit(textAttrs, 'text');\n\n\t        // Break the content to fit the element size taking into account the attributes\n\t        // set on the model.\n\t        var text = breakText(cell.get('content'), cell.get('size'), textAttrs, {\n\t            // measuring sandbox svg document\n\t            svgDocument: this.paper.svg\n\t        });\n\n\t        // Create a new attrs with same structure as the model attrs { text: { *textAttributes* }}\n\t        var attrs = setByPath({}, '.content', textAttrs, '/');\n\n\t        // Replace text attribute with the one we just processed.\n\t        attrs['.content'].text = text;\n\n\t        // Update the view using renderingOnlyAttributes parameter.\n\t        ElementView.prototype.update.call(this, cell, attrs);\n\t    }\n\t});\n\n\tvar basic = ({\n\t\tGeneric: Generic,\n\t\tRect: Rect$1,\n\t\tTextView: TextView,\n\t\tText: Text,\n\t\tCircle: Circle,\n\t\tEllipse: Ellipse$1,\n\t\tPolygon: Polygon$1,\n\t\tPolyline: Polyline$1,\n\t\tImage: Image,\n\t\tPath: Path$1,\n\t\tRhombus: Rhombus,\n\t\tTextBlock: TextBlock,\n\t\tTextBlockView: TextBlockView\n\t});\n\n\t// ELEMENTS\n\n\tvar Rectangle = Element$1.define('standard.Rectangle', {\n\t    attrs: {\n\t        body: {\n\t            refWidth: '100%',\n\t            refHeight: '100%',\n\t            strokeWidth: 2,\n\t            stroke: '#000000',\n\t            fill: '#FFFFFF'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'rect',\n\t        selector: 'body',\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar Circle$1 = Element$1.define('standard.Circle', {\n\t    attrs: {\n\t        body: {\n\t            refCx: '50%',\n\t            refCy: '50%',\n\t            refR: '50%',\n\t            strokeWidth: 2,\n\t            stroke: '#333333',\n\t            fill: '#FFFFFF'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'circle',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar Ellipse$2 = Element$1.define('standard.Ellipse', {\n\t    attrs: {\n\t        body: {\n\t            refCx: '50%',\n\t            refCy: '50%',\n\t            refRx: '50%',\n\t            refRy: '50%',\n\t            strokeWidth: 2,\n\t            stroke: '#333333',\n\t            fill: '#FFFFFF'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'ellipse',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar Path$2 = Element$1.define('standard.Path', {\n\t    attrs: {\n\t        body: {\n\t            refD: 'M 0 0 L 10 0 10 10 0 10 Z',\n\t            strokeWidth: 2,\n\t            stroke: '#333333',\n\t            fill: '#FFFFFF'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'path',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar Polygon$2 = Element$1.define('standard.Polygon', {\n\t    attrs: {\n\t        body: {\n\t            refPoints: '0 0 10 0 10 10 0 10',\n\t            strokeWidth: 2,\n\t            stroke: '#333333',\n\t            fill: '#FFFFFF'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'polygon',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar Polyline$2 = Element$1.define('standard.Polyline', {\n\t    attrs: {\n\t        body: {\n\t            refPoints: '0 0 10 0 10 10 0 10 0 0',\n\t            strokeWidth: 2,\n\t            stroke: '#333333',\n\t            fill: '#FFFFFF'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'polyline',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar Image$1 = Element$1.define('standard.Image', {\n\t    attrs: {\n\t        image: {\n\t            refWidth: '100%',\n\t            refHeight: '100%',\n\t            // xlinkHref: '[URL]'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'top',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '100%',\n\t            refY2: 10,\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'image',\n\t        selector: 'image'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar BorderedImage = Element$1.define('standard.BorderedImage', {\n\t    attrs: {\n\t        border: {\n\t            refWidth: '100%',\n\t            refHeight: '100%',\n\t            stroke: '#333333',\n\t            strokeWidth: 2\n\t        },\n\t        background: {\n\t            refWidth: -1,\n\t            refHeight: -1,\n\t            x: 0.5,\n\t            y: 0.5,\n\t            fill: '#FFFFFF'\n\t        },\n\t        image: {\n\t            // xlinkHref: '[URL]'\n\t            refWidth: -1,\n\t            refHeight: -1,\n\t            x: 0.5,\n\t            y: 0.5\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'top',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '100%',\n\t            refY2: 10,\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'rect',\n\t        selector: 'background',\n\t        attributes: {\n\t            'stroke': 'none'\n\t        }\n\t    }, {\n\t        tagName: 'image',\n\t        selector: 'image'\n\t    }, {\n\t        tagName: 'rect',\n\t        selector: 'border',\n\t        attributes: {\n\t            'fill': 'none'\n\t        }\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar EmbeddedImage = Element$1.define('standard.EmbeddedImage', {\n\t    attrs: {\n\t        body: {\n\t            refWidth: '100%',\n\t            refHeight: '100%',\n\t            stroke: '#333333',\n\t            fill: '#FFFFFF',\n\t            strokeWidth: 2\n\t        },\n\t        image: {\n\t            // xlinkHref: '[URL]'\n\t            refWidth: '30%',\n\t            refHeight: -20,\n\t            x: 10,\n\t            y: 10,\n\t            preserveAspectRatio: 'xMidYMin'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'top',\n\t            textAnchor: 'left',\n\t            refX: '30%',\n\t            refX2: 20, // 10 + 10\n\t            refY: 10,\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'rect',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'image',\n\t        selector: 'image'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar InscribedImage = Element$1.define('standard.InscribedImage', {\n\t    attrs: {\n\t        border: {\n\t            refRx: '50%',\n\t            refRy: '50%',\n\t            refCx: '50%',\n\t            refCy: '50%',\n\t            stroke: '#333333',\n\t            strokeWidth: 2\n\t        },\n\t        background: {\n\t            refRx: '50%',\n\t            refRy: '50%',\n\t            refCx: '50%',\n\t            refCy: '50%',\n\t            fill: '#FFFFFF'\n\t        },\n\t        image: {\n\t            // The image corners touch the border when its size is Math.sqrt(2) / 2 = 0.707.. ~= 70%\n\t            refWidth: '68%',\n\t            refHeight: '68%',\n\t            // The image offset is calculated as (100% - 68%) / 2\n\t            refX: '16%',\n\t            refY: '16%',\n\t            preserveAspectRatio: 'xMidYMid'\n\t            // xlinkHref: '[URL]'\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'top',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '100%',\n\t            refY2: 10,\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'ellipse',\n\t        selector: 'background'\n\t    }, {\n\t        tagName: 'image',\n\t        selector: 'image'\n\t    }, {\n\t        tagName: 'ellipse',\n\t        selector: 'border',\n\t        attributes: {\n\t            'fill': 'none'\n\t        }\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }]\n\t});\n\n\tvar HeaderedRectangle = Element$1.define('standard.HeaderedRectangle', {\n\t    attrs: {\n\t        body: {\n\t            refWidth: '100%',\n\t            refHeight: '100%',\n\t            strokeWidth: 2,\n\t            stroke: '#000000',\n\t            fill: '#FFFFFF'\n\t        },\n\t        header: {\n\t            refWidth: '100%',\n\t            height: 30,\n\t            strokeWidth: 2,\n\t            stroke: '#000000',\n\t            fill: '#FFFFFF'\n\t        },\n\t        headerText: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: 15,\n\t            fontSize: 16,\n\t            fill: '#333333'\n\t        },\n\t        bodyText: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '50%',\n\t            refY2: 15,\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'rect',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'rect',\n\t        selector: 'header'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'headerText'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'bodyText'\n\t    }]\n\t});\n\n\tvar CYLINDER_TILT = 10;\n\n\tvar Cylinder = Element$1.define('standard.Cylinder', {\n\t    attrs: {\n\t        body: {\n\t            lateralArea: CYLINDER_TILT,\n\t            fill: '#FFFFFF',\n\t            stroke: '#333333',\n\t            strokeWidth: 2\n\t        },\n\t        top: {\n\t            refCx: '50%',\n\t            cy: CYLINDER_TILT,\n\t            refRx: '50%',\n\t            ry: CYLINDER_TILT,\n\t            fill: '#FFFFFF',\n\t            stroke: '#333333',\n\t            strokeWidth: 2\n\t        },\n\t        label: {\n\t            textVerticalAnchor: 'middle',\n\t            textAnchor: 'middle',\n\t            refX: '50%',\n\t            refY: '100%',\n\t            refY2: 15,\n\t            fontSize: 14,\n\t            fill: '#333333'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'path',\n\t        selector: 'body'\n\t    }, {\n\t        tagName: 'ellipse',\n\t        selector: 'top'\n\t    }, {\n\t        tagName: 'text',\n\t        selector: 'label'\n\t    }],\n\n\t    topRy: function(t, opt) {\n\t        // getter\n\t        if (t === undefined) { return this.attr('body/lateralArea'); }\n\n\t        // setter\n\t        var isPercentageSetter = isPercentage(t);\n\n\t        var bodyAttrs = { lateralArea: t };\n\t        var topAttrs = isPercentageSetter\n\t            ? { refCy: t, refRy: t, cy: null, ry: null }\n\t            : { refCy: null, refRy: null, cy: t, ry: t };\n\n\t        return this.attr({ body: bodyAttrs, top: topAttrs }, opt);\n\t    }\n\n\t}, {\n\t    attributes: {\n\t        lateralArea: {\n\t            set: function(t, refBBox) {\n\t                var isPercentageSetter = isPercentage(t);\n\t                if (isPercentageSetter) { t = parseFloat(t) / 100; }\n\n\t                var x = refBBox.x;\n\t                var y = refBBox.y;\n\t                var w = refBBox.width;\n\t                var h = refBBox.height;\n\n\t                // curve control point variables\n\t                var rx = w / 2;\n\t                var ry = isPercentageSetter ? (h * t) : t;\n\n\t                var kappa = V.KAPPA;\n\t                var cx = kappa * rx;\n\t                var cy = kappa * (isPercentageSetter ? (h * t) : t);\n\n\t                // shape variables\n\t                var xLeft = x;\n\t                var xCenter = x + (w / 2);\n\t                var xRight = x + w;\n\n\t                var ySideTop = y + ry;\n\t                var yCurveTop = ySideTop - ry;\n\t                var ySideBottom = y + h - ry;\n\t                var yCurveBottom = y + h;\n\n\t                // return calculated shape\n\t                var data = [\n\t                    'M', xLeft, ySideTop,\n\t                    'L', xLeft, ySideBottom,\n\t                    'C', x, (ySideBottom + cy), (xCenter - cx), yCurveBottom, xCenter, yCurveBottom,\n\t                    'C', (xCenter + cx), yCurveBottom, xRight, (ySideBottom + cy), xRight, ySideBottom,\n\t                    'L', xRight, ySideTop,\n\t                    'C', xRight, (ySideTop - cy), (xCenter + cx), yCurveTop, xCenter, yCurveTop,\n\t                    'C', (xCenter - cx), yCurveTop, xLeft, (ySideTop - cy), xLeft, ySideTop,\n\t                    'Z'\n\t                ];\n\t                return { d: data.join(' ') };\n\t            }\n\t        }\n\t    }\n\t});\n\n\tvar foLabelMarkup = {\n\t    tagName: 'foreignObject',\n\t    selector: 'foreignObject',\n\t    attributes: {\n\t        'overflow': 'hidden'\n\t    },\n\t    children: [{\n\t        tagName: 'div',\n\t        namespaceURI: 'http://www.w3.org/1999/xhtml',\n\t        selector: 'label',\n\t        style: {\n\t            width: '100%',\n\t            height: '100%',\n\t            position: 'static',\n\t            backgroundColor: 'transparent',\n\t            textAlign: 'center',\n\t            margin: 0,\n\t            padding: '0px 5px',\n\t            boxSizing: 'border-box',\n\t            display: 'flex',\n\t            alignItems: 'center',\n\t            justifyContent: 'center'\n\t        }\n\t    }]\n\t};\n\n\tvar svgLabelMarkup = {\n\t    tagName: 'text',\n\t    selector: 'label',\n\t    attributes: {\n\t        'text-anchor': 'middle'\n\t    }\n\t};\n\n\tvar labelMarkup = (env.test('svgforeignobject')) ? foLabelMarkup : svgLabelMarkup;\n\n\tvar TextBlock$1 = Element$1.define('standard.TextBlock', {\n\t    attrs: {\n\t        body: {\n\t            refWidth: '100%',\n\t            refHeight: '100%',\n\t            stroke: '#333333',\n\t            fill: '#ffffff',\n\t            strokeWidth: 2\n\t        },\n\t        foreignObject: {\n\t            refWidth: '100%',\n\t            refHeight: '100%'\n\t        },\n\t        label: {\n\t            style: {\n\t                fontSize: 14\n\t            }\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'rect',\n\t        selector: 'body'\n\t    }, labelMarkup]\n\t}, {\n\t    attributes: {\n\t        text: {\n\t            set: function(text, refBBox, node, attrs) {\n\t                if (node instanceof HTMLElement) {\n\t                    node.textContent = text;\n\t                } else {\n\t                    // No foreign object\n\t                    var style = attrs.style || {};\n\t                    var wrapValue = { text: text, width: -5, height: '100%' };\n\t                    var wrapAttrs = assign({ textVerticalAnchor: 'middle' }, style);\n\t                    attributes.textWrap.set.call(this, wrapValue, refBBox, node, wrapAttrs);\n\t                    return { fill: style.color || null };\n\t                }\n\t            },\n\t            position: function(text, refBBox, node) {\n\t                // No foreign object\n\t                if (node instanceof SVGElement) { return refBBox.center(); }\n\t            }\n\t        }\n\t    }\n\t});\n\n\t// LINKS\n\n\tvar Link$1 = Link.define('standard.Link', {\n\t    attrs: {\n\t        line: {\n\t            connection: true,\n\t            stroke: '#333333',\n\t            strokeWidth: 2,\n\t            strokeLinejoin: 'round',\n\t            targetMarker: {\n\t                'type': 'path',\n\t                'd': 'M 10 -5 0 0 10 5 z'\n\t            }\n\t        },\n\t        wrapper: {\n\t            connection: true,\n\t            strokeWidth: 10,\n\t            strokeLinejoin: 'round'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'path',\n\t        selector: 'wrapper',\n\t        attributes: {\n\t            'fill': 'none',\n\t            'cursor': 'pointer',\n\t            'stroke': 'transparent',\n\t            'stroke-linecap': 'round'\n\t        }\n\t    }, {\n\t        tagName: 'path',\n\t        selector: 'line',\n\t        attributes: {\n\t            'fill': 'none',\n\t            'pointer-events': 'none'\n\t        }\n\t    }]\n\t});\n\n\tvar DoubleLink = Link.define('standard.DoubleLink', {\n\t    attrs: {\n\t        line: {\n\t            connection: true,\n\t            stroke: '#DDDDDD',\n\t            strokeWidth: 4,\n\t            strokeLinejoin: 'round',\n\t            targetMarker: {\n\t                type: 'path',\n\t                stroke: '#000000',\n\t                d: 'M 10 -3 10 -10 -2 0 10 10 10 3'\n\t            }\n\t        },\n\t        outline: {\n\t            connection: true,\n\t            stroke: '#000000',\n\t            strokeWidth: 6,\n\t            strokeLinejoin: 'round'\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'path',\n\t        selector: 'outline',\n\t        attributes: {\n\t            'fill': 'none'\n\t        }\n\t    }, {\n\t        tagName: 'path',\n\t        selector: 'line',\n\t        attributes: {\n\t            'fill': 'none'\n\t        }\n\t    }]\n\t});\n\n\tvar ShadowLink = Link.define('standard.ShadowLink', {\n\t    attrs: {\n\t        line: {\n\t            connection: true,\n\t            stroke: '#FF0000',\n\t            strokeWidth: 20,\n\t            strokeLinejoin: 'round',\n\t            targetMarker: {\n\t                'type': 'path',\n\t                'stroke': 'none',\n\t                'd': 'M 0 -10 -10 0 0 10 z'\n\t            },\n\t            sourceMarker: {\n\t                'type': 'path',\n\t                'stroke': 'none',\n\t                'd': 'M -10 -10 0 0 -10 10 0 10 0 -10 z'\n\t            }\n\t        },\n\t        shadow: {\n\t            connection: true,\n\t            refX: 3,\n\t            refY: 6,\n\t            stroke: '#000000',\n\t            strokeOpacity: 0.2,\n\t            strokeWidth: 20,\n\t            strokeLinejoin: 'round',\n\t            targetMarker: {\n\t                'type': 'path',\n\t                'd': 'M 0 -10 -10 0 0 10 z',\n\t                'stroke': 'none'\n\t            },\n\t            sourceMarker: {\n\t                'type': 'path',\n\t                'stroke': 'none',\n\t                'd': 'M -10 -10 0 0 -10 10 0 10 0 -10 z'\n\t            }\n\t        }\n\t    }\n\t}, {\n\t    markup: [{\n\t        tagName: 'path',\n\t        selector: 'shadow',\n\t        attributes: {\n\t            'fill': 'none'\n\t        }\n\t    }, {\n\t        tagName: 'path',\n\t        selector: 'line',\n\t        attributes: {\n\t            'fill': 'none'\n\t        }\n\t    }]\n\t});\n\n\tvar standard = ({\n\t\tRectangle: Rectangle,\n\t\tCircle: Circle$1,\n\t\tEllipse: Ellipse$2,\n\t\tPath: Path$2,\n\t\tPolygon: Polygon$2,\n\t\tPolyline: Polyline$2,\n\t\tImage: Image$1,\n\t\tBorderedImage: BorderedImage,\n\t\tEmbeddedImage: EmbeddedImage,\n\t\tInscribedImage: InscribedImage,\n\t\tHeaderedRectangle: HeaderedRectangle,\n\t\tCylinder: Cylinder,\n\t\tTextBlock: TextBlock$1,\n\t\tLink: Link$1,\n\t\tDoubleLink: DoubleLink,\n\t\tShadowLink: ShadowLink\n\t});\n\n\t/**\n\t * @deprecated use the port api instead\n\t */\n\tvar Model = Generic.define('devs.Model', {\n\t    inPorts: [],\n\t    outPorts: [],\n\t    size: {\n\t        width: 80,\n\t        height: 80\n\t    },\n\t    attrs: {\n\t        '.': {\n\t            magnet: false\n\t        },\n\t        '.label': {\n\t            text: 'Model',\n\t            'ref-x': .5,\n\t            'ref-y': 10,\n\t            'font-size': 18,\n\t            'text-anchor': 'middle',\n\t            fill: '#000'\n\t        },\n\t        '.body': {\n\t            'ref-width': '100%',\n\t            'ref-height': '100%',\n\t            stroke: '#000'\n\t        }\n\t    },\n\t    ports: {\n\t        groups: {\n\t            'in': {\n\t                position: {\n\t                    name: 'left'\n\t                },\n\t                attrs: {\n\t                    '.port-label': {\n\t                        fill: '#000'\n\t                    },\n\t                    '.port-body': {\n\t                        fill: '#fff',\n\t                        stroke: '#000',\n\t                        r: 10,\n\t                        magnet: true\n\t                    }\n\t                },\n\t                label: {\n\t                    position: {\n\t                        name: 'left',\n\t                        args: {\n\t                            y: 10\n\t                        }\n\t                    }\n\t                }\n\t            },\n\t            'out': {\n\t                position: {\n\t                    name: 'right'\n\t                },\n\t                attrs: {\n\t                    '.port-label': {\n\t                        fill: '#000'\n\t                    },\n\t                    '.port-body': {\n\t                        fill: '#fff',\n\t                        stroke: '#000',\n\t                        r: 10,\n\t                        magnet: true\n\t                    }\n\t                },\n\t                label: {\n\t                    position: {\n\t                        name: 'right',\n\t                        args: {\n\t                            y: 10\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><rect class=\"body\"/><text class=\"label\"/></g>',\n\t    portMarkup: '<circle class=\"port-body\"/>',\n\t    portLabelMarkup: '<text class=\"port-label\"/>',\n\n\t    initialize: function() {\n\n\t        Generic.prototype.initialize.apply(this, arguments);\n\n\t        this.on('change:inPorts change:outPorts', this.updatePortItems, this);\n\t        this.updatePortItems();\n\t    },\n\n\t    updatePortItems: function(model, changed, opt) {\n\n\t        // Make sure all ports are unique.\n\t        var inPorts = uniq(this.get('inPorts'));\n\t        var outPorts = difference(uniq(this.get('outPorts')), inPorts);\n\n\t        var inPortItems = this.createPortItems('in', inPorts);\n\t        var outPortItems = this.createPortItems('out', outPorts);\n\n\t        this.prop('ports/items', inPortItems.concat(outPortItems), assign({ rewrite: true }, opt));\n\t    },\n\n\t    createPortItem: function(group, port) {\n\n\t        return {\n\t            id: port,\n\t            group: group,\n\t            attrs: {\n\t                '.port-label': {\n\t                    text: port\n\t                }\n\t            }\n\t        };\n\t    },\n\n\t    createPortItems: function(group, ports) {\n\n\t        return toArray(ports).map(this.createPortItem.bind(this, group));\n\t    },\n\n\t    _addGroupPort: function(port, group, opt) {\n\n\t        var ports = this.get(group);\n\t        return this.set(group, Array.isArray(ports) ? ports.concat(port) : [port], opt);\n\t    },\n\n\t    addOutPort: function(port, opt) {\n\n\t        return this._addGroupPort(port, 'outPorts', opt);\n\t    },\n\n\t    addInPort: function(port, opt) {\n\n\t        return this._addGroupPort(port, 'inPorts', opt);\n\t    },\n\n\t    _removeGroupPort: function(port, group, opt) {\n\n\t        return this.set(group, without(this.get(group), port), opt);\n\t    },\n\n\t    removeOutPort: function(port, opt) {\n\n\t        return this._removeGroupPort(port, 'outPorts', opt);\n\t    },\n\n\t    removeInPort: function(port, opt) {\n\n\t        return this._removeGroupPort(port, 'inPorts', opt);\n\t    },\n\n\t    _changeGroup: function(group, properties, opt) {\n\n\t        return this.prop('ports/groups/' + group, isObject$1(properties) ? properties : {}, opt);\n\t    },\n\n\t    changeInGroup: function(properties, opt) {\n\n\t        return this._changeGroup('in', properties, opt);\n\t    },\n\n\t    changeOutGroup: function(properties, opt) {\n\n\t        return this._changeGroup('out', properties, opt);\n\t    }\n\t});\n\n\tvar Atomic = Model.define('devs.Atomic', {\n\t    size: {\n\t        width: 80,\n\t        height: 80\n\t    },\n\t    attrs: {\n\t        '.label': {\n\t            text: 'Atomic'\n\t        }\n\t    }\n\t});\n\n\tvar Coupled = Model.define('devs.Coupled', {\n\t    size: {\n\t        width: 200,\n\t        height: 300\n\t    },\n\t    attrs: {\n\t        '.label': {\n\t            text: 'Coupled'\n\t        }\n\t    }\n\t});\n\n\tvar Link$2 = Link.define('devs.Link', {\n\t    attrs: {\n\t        '.connection': {\n\t            'stroke-width': 2\n\t        }\n\t    }\n\t});\n\n\tvar devs = ({\n\t\tModel: Model,\n\t\tAtomic: Atomic,\n\t\tCoupled: Coupled,\n\t\tLink: Link$2\n\t});\n\n\tvar Gate = Generic.define('logic.Gate', {\n\t    size: { width: 80, height: 40 },\n\t    attrs: {\n\t        '.': { magnet: false },\n\t        '.body': { width: 100, height: 50 },\n\t        circle: { r: 7, stroke: 'black', fill: 'transparent', 'stroke-width': 2 }\n\t    }\n\t}, {\n\t    operation: function() {\n\t        return true;\n\t    }\n\t});\n\n\tvar IO = Gate.define('logic.IO', {\n\t    size: { width: 60, height: 30 },\n\t    attrs: {\n\t        '.body': { fill: 'white', stroke: 'black', 'stroke-width': 2 },\n\t        '.wire': { ref: '.body', 'ref-y': .5, stroke: 'black' },\n\t        text: {\n\t            fill: 'black',\n\t            ref: '.body', 'ref-x': .5, 'ref-y': .5, 'y-alignment': 'middle',\n\t            'text-anchor': 'middle',\n\t            'font-weight': 'bold',\n\t            'font-variant': 'small-caps',\n\t            'text-transform': 'capitalize',\n\t            'font-size': '14px'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"body\"/></g><path class=\"wire\"/><circle/><text/></g>',\n\t});\n\n\tvar Input = IO.define('logic.Input', {\n\t    attrs: {\n\t        '.wire': { 'ref-dx': 0, d: 'M 0 0 L 23 0' },\n\t        circle: { ref: '.body', 'ref-dx': 30, 'ref-y': 0.5, magnet: true, 'class': 'output', port: 'out' },\n\t        text: { text: 'input' }\n\t    }\n\t});\n\n\tvar Output = IO.define('logic.Output', {\n\t    attrs: {\n\t        '.wire': { 'ref-x': 0, d: 'M 0 0 L -23 0' },\n\t        circle: { ref: '.body', 'ref-x': -30, 'ref-y': 0.5, magnet: 'passive', 'class': 'input', port: 'in' },\n\t        text: { text: 'output' }\n\t    }\n\t});\n\n\tvar Gate11 = Gate.define('logic.Gate11', {\n\t    attrs: {\n\t        '.input': { ref: '.body', 'ref-x': -2, 'ref-y': 0.5, magnet: 'passive', port: 'in' },\n\t        '.output': { ref: '.body', 'ref-dx': 2, 'ref-y': 0.5, magnet: true, port: 'out' }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><image class=\"body\"/></g><circle class=\"input\"/><circle class=\"output\"/></g>',\n\t});\n\n\tvar Gate21 = Gate.define('logic.Gate21', {\n\t    attrs: {\n\t        '.input1': { ref: '.body', 'ref-x': -2, 'ref-y': 0.3, magnet: 'passive', port: 'in1' },\n\t        '.input2': { ref: '.body', 'ref-x': -2, 'ref-y': 0.7, magnet: 'passive', port: 'in2' },\n\t        '.output': { ref: '.body', 'ref-dx': 2, 'ref-y': 0.5, magnet: true, port: 'out' }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><image class=\"body\"/></g><circle class=\"input input1\"/><circle  class=\"input input2\"/><circle class=\"output\"/></g>',\n\t});\n\n\tvar Repeater = Gate11.define('logic.Repeater', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo=' }}\n\t}, {\n\t    operation: function(input) {\n\t        return input;\n\t    }\n\t});\n\n\tvar Not = Gate11.define('logic.Not', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K' }}\n\t}, {\n\t    operation: function(input) {\n\t        return !input;\n\t    }\n\t});\n\n\tvar Or = Gate21.define('logic.Or', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo=' }}\n\t}, {\n\t    operation: function(input1, input2) {\n\t        return input1 || input2;\n\t    }\n\t});\n\n\tvar And = Gate21.define('logic.And', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg==' }}\n\n\t}, {\n\t    operation: function(input1, input2) {\n\t        return input1 && input2;\n\t    }\n\t});\n\n\tvar Nor = Gate21.define('logic.Nor', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K' }}\n\t}, {\n\t    operation: function(input1, input2) {\n\t        return !(input1 || input2);\n\t    }\n\t});\n\n\tvar Nand = Gate21.define('logic.Nand', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==' }}\n\t}, {\n\t    operation: function(input1, input2) {\n\t        return !(input1 && input2);\n\t    }\n\t});\n\n\tvar Xor = Gate21.define('logic.Xor', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K' }}\n\t}, {\n\t    operation: function(input1, input2) {\n\t        return (!input1 || input2) && (input1 || !input2);\n\t    }\n\t});\n\n\tvar Xnor = Gate21.define('logic.Xnor', {\n\t    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==' }}\n\t}, {\n\t    operation: function(input1, input2) {\n\t        return (!input1 || !input2) && (input1 || input2);\n\t    }\n\t});\n\n\tvar Wire = Link.define('logic.Wire', {\n\t    attrs: {\n\t        '.connection': { 'stroke-width': 2 },\n\t        '.marker-vertex': { r: 7 }\n\t    },\n\n\t    router: { name: 'orthogonal' },\n\t    connector: { name: 'rounded', args: { radius: 10 }}\n\t}, {\n\t    arrowheadMarkup: [\n\t        '<g class=\"marker-arrowhead-group marker-arrowhead-group-<%= end %>\">',\n\t        '<circle class=\"marker-arrowhead\" end=\"<%= end %>\" r=\"7\"/>',\n\t        '</g>'\n\t    ].join(''),\n\n\t    vertexMarkup: [\n\t        '<g class=\"marker-vertex-group\" transform=\"translate(<%= x %>, <%= y %>)\">',\n\t        '<circle class=\"marker-vertex\" idx=\"<%= idx %>\" r=\"10\" />',\n\t        '<g class=\"marker-vertex-remove-group\">',\n\t        '<path class=\"marker-vertex-remove-area\" idx=\"<%= idx %>\" d=\"M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z\" transform=\"translate(5, -33)\"/>',\n\t        '<path class=\"marker-vertex-remove\" idx=\"<%= idx %>\" transform=\"scale(.8) translate(9.5, -37)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\">',\n\t        '<title>Remove vertex.</title>',\n\t        '</path>',\n\t        '</g>',\n\t        '</g>'\n\t    ].join('')\n\t});\n\n\tvar logic = ({\n\t\tGate: Gate,\n\t\tIO: IO,\n\t\tInput: Input,\n\t\tOutput: Output,\n\t\tGate11: Gate11,\n\t\tGate21: Gate21,\n\t\tRepeater: Repeater,\n\t\tNot: Not,\n\t\tOr: Or,\n\t\tAnd: And,\n\t\tNor: Nor,\n\t\tNand: Nand,\n\t\tXor: Xor,\n\t\tXnor: Xnor,\n\t\tWire: Wire\n\t});\n\n\tvar KingWhite = Generic.define('chess.KingWhite', {\n\t    size: { width: 42, height: 38 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\"><path      d=\"M 22.5,11.63 L 22.5,6\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path      d=\"M 20,8 L 25,8\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path      d=\"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\"      style=\"fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;\" />    <path      d=\"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z \"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 11.5,30 C 17,27 27,27 32.5,30\"      style=\"fill:none; stroke:#000000;\" />    <path      d=\"M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5\"      style=\"fill:none; stroke:#000000;\" />    <path      d=\"M 11.5,37 C 17,34 27,34 32.5,37\"      style=\"fill:none; stroke:#000000;\" />  </g></g></g>'\n\t});\n\n\tvar KingBlack = Generic.define('chess.KingBlack', {\n\t    size: { width: 42, height: 38 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path       d=\"M 22.5,11.63 L 22.5,6\"       style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\"       id=\"path6570\" />    <path       d=\"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\"       style=\"fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;\" />    <path       d=\"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z \"       style=\"fill:#000000; stroke:#000000;\" />    <path       d=\"M 20,8 L 25,8\"       style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path       d=\"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37\"       style=\"fill:none; stroke:#ffffff;\" />  </g></g></g>'\n\t});\n\n\tvar QueenWhite = Generic.define('chess.QueenWhite', {\n\t    size: { width: 42, height: 38 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(-1,-1)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(15.5,-5.5)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(32,-1)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(7,-4.5)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(24,-4)\" />    <path      d=\"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11.5,30 C 15,29 30,29 33.5,30\"      style=\"fill:none;\" />    <path      d=\"M 12,33.5 C 18,32.5 27,32.5 33,33.5\"      style=\"fill:none;\" />  </g></g></g>'\n\t});\n\n\tvar QueenBlack = Generic.define('chess.QueenBlack', {\n\t    size: { width: 42, height: 38 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#000000; stroke:none;\">      <circle cx=\"6\"    cy=\"12\" r=\"2.75\" />      <circle cx=\"14\"   cy=\"9\"  r=\"2.75\" />      <circle cx=\"22.5\" cy=\"8\"  r=\"2.75\" />      <circle cx=\"31\"   cy=\"9\"  r=\"2.75\" />      <circle cx=\"39\"   cy=\"12\" r=\"2.75\" />    </g>    <path       d=\"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"       style=\"stroke-linecap:butt; stroke:#000000;\" />    <path       d=\"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"       style=\"stroke-linecap:butt;\" />    <path       d=\"M 11,38.5 A 35,35 1 0 0 34,38.5\"       style=\"fill:none; stroke:#000000; stroke-linecap:butt;\" />    <path       d=\"M 11,29 A 35,35 1 0 1 34,29\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 12.5,31.5 L 32.5,31.5\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"       style=\"fill:none; stroke:#ffffff;\" />  </g></g></g>'\n\t});\n\n\tvar RookWhite = Generic.define('chess.RookWhite', {\n\t    size: { width: 32, height: 34 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 34,14 L 31,17 L 14,17 L 11,14\" />    <path      d=\"M 31,17 L 31,29.5 L 14,29.5 L 14,17\"      style=\"stroke-linecap:butt; stroke-linejoin:miter;\" />    <path      d=\"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\" />    <path      d=\"M 11,14 L 34,14\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />  </g></g></g>'\n\t});\n\n\tvar RookBlack = Generic.define('chess.RookBlack', {\n\t    size: { width: 32, height: 34 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \"      style=\"stroke-linecap:butt;stroke-linejoin:miter;\" />    <path      d=\"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,35.5 L 33,35.5 L 33,35.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 13,31.5 L 32,31.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 14,29.5 L 31,29.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 14,16.5 L 31,16.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 11,14 L 34,14\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />  </g></g></g>'\n\t});\n\n\tvar BishopWhite = Generic.define('chess.BishopWhite', {\n\t    size: { width: 38, height: 38 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#ffffff; stroke:#000000; stroke-linecap:butt;\">       <path        d=\"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z\" />      <path        d=\"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\" />      <path        d=\"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\" />    </g>    <path      d=\"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />  </g></g></g>'\n\t});\n\n\tvar BishopBlack = Generic.define('chess.BishopBlack', {\n\t    size: { width: 38, height: 38 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#000000; stroke:#000000; stroke-linecap:butt;\">       <path        d=\"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z\" />      <path        d=\"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\" />      <path        d=\"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\" />    </g>    <path       d=\"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\"       style=\"fill:none; stroke:#ffffff; stroke-linejoin:miter;\" />  </g></g></g>'\n\t});\n\n\tvar KnightWhite = Generic.define('chess.KnightWhite', {\n\t    size: { width: 38, height: 37 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\"      transform=\"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\"      style=\"fill:#000000; stroke:#000000;\" />  </g></g></g>'\n\t});\n\n\tvar KnightBlack = Generic.define('chess.KnightBlack', {\n\t    size: { width: 38, height: 37 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\"      style=\"fill:#ffffff; stroke:#ffffff;\" />    <path      d=\"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\"      transform=\"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\"      style=\"fill:#ffffff; stroke:#ffffff;\" />    <path      d=\"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \"      style=\"fill:#ffffff; stroke:none;\" />  </g></g></g>'\n\t});\n\n\tvar PawnWhite = Generic.define('chess.PawnWhite', {\n\t    size: { width: 28, height: 33 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><path d=\"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z \"  style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\" /></g></g>'\n\t});\n\n\tvar PawnBlack = Generic.define('chess.PawnBlack', {\n\t    size: { width: 28, height: 33 }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><path d=\"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z \"  style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\" /></g></g>'\n\t});\n\n\tvar chess = ({\n\t\tKingWhite: KingWhite,\n\t\tKingBlack: KingBlack,\n\t\tQueenWhite: QueenWhite,\n\t\tQueenBlack: QueenBlack,\n\t\tRookWhite: RookWhite,\n\t\tRookBlack: RookBlack,\n\t\tBishopWhite: BishopWhite,\n\t\tBishopBlack: BishopBlack,\n\t\tKnightWhite: KnightWhite,\n\t\tKnightBlack: KnightBlack,\n\t\tPawnWhite: PawnWhite,\n\t\tPawnBlack: PawnBlack\n\t});\n\n\tvar Entity = Element$1.define('erd.Entity', {\n\t    size: { width: 150, height: 60 },\n\t    attrs: {\n\t        '.outer': {\n\t            fill: '#2ECC71', stroke: '#27AE60', 'stroke-width': 2,\n\t            points: '100,0 100,60 0,60 0,0'\n\t        },\n\t        '.inner': {\n\t            fill: '#2ECC71', stroke: '#27AE60', 'stroke-width': 2,\n\t            points: '95,5 95,55 5,55 5,5',\n\t            display: 'none'\n\t        },\n\t        text: {\n\t            text: 'Entity',\n\t            'font-family': 'Arial', 'font-size': 14,\n\t            'ref-x': .5, 'ref-y': .5,\n\t            'y-alignment': 'middle', 'text-anchor': 'middle'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon class=\"outer\"/><polygon class=\"inner\"/></g><text/></g>',\n\t});\n\n\tvar WeakEntity = Entity.define('erd.WeakEntity', {\n\t    attrs: {\n\t        '.inner': { display: 'auto' },\n\t        text: { text: 'Weak Entity' }\n\t    }\n\t});\n\n\tvar Relationship = Element$1.define('erd.Relationship', {\n\t    size: { width: 80, height: 80 },\n\t    attrs: {\n\t        '.outer': {\n\t            fill: '#3498DB', stroke: '#2980B9', 'stroke-width': 2,\n\t            points: '40,0 80,40 40,80 0,40'\n\t        },\n\t        '.inner': {\n\t            fill: '#3498DB', stroke: '#2980B9', 'stroke-width': 2,\n\t            points: '40,5 75,40 40,75 5,40',\n\t            display: 'none'\n\t        },\n\t        text: {\n\t            text: 'Relationship',\n\t            'font-family': 'Arial', 'font-size': 12,\n\t            'ref-x': .5, 'ref-y': .5,\n\t            'y-alignment': 'middle', 'text-anchor': 'middle'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon class=\"outer\"/><polygon class=\"inner\"/></g><text/></g>',\n\t});\n\n\tvar IdentifyingRelationship = Relationship.define('erd.IdentifyingRelationship', {\n\t    attrs: {\n\t        '.inner': { display: 'auto' },\n\t        text: { text: 'Identifying' }\n\t    }\n\t});\n\n\tvar Attribute = Element$1.define('erd.Attribute', {\n\t    size: { width: 100, height: 50 },\n\t    attrs: {\n\t        'ellipse': {\n\t            transform: 'translate(50, 25)'\n\t        },\n\t        '.outer': {\n\t            stroke: '#D35400', 'stroke-width': 2,\n\t            cx: 0, cy: 0, rx: 50, ry: 25,\n\t            fill: '#E67E22'\n\t        },\n\t        '.inner': {\n\t            stroke: '#D35400', 'stroke-width': 2,\n\t            cx: 0, cy: 0, rx: 45, ry: 20,\n\t            fill: '#E67E22', display: 'none'\n\t        },\n\t        text: {\n\t            'font-family': 'Arial', 'font-size': 14,\n\t            'ref-x': .5, 'ref-y': .5,\n\t            'y-alignment': 'middle', 'text-anchor': 'middle'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><ellipse class=\"outer\"/><ellipse class=\"inner\"/></g><text/></g>',\n\t});\n\n\tvar Multivalued = Attribute.define('erd.Multivalued', {\n\t    attrs: {\n\t        '.inner': { display: 'block' },\n\t        text: { text: 'multivalued' }\n\t    }\n\t});\n\n\tvar Derived = Attribute.define('erd.Derived', {\n\t    attrs: {\n\t        '.outer': { 'stroke-dasharray': '3,5' },\n\t        text: { text: 'derived' }\n\t    }\n\t});\n\n\tvar Key = Attribute.define('erd.Key', {\n\t    attrs: {\n\t        ellipse: { 'stroke-width': 4 },\n\t        text: { text: 'key', 'font-weight': '800', 'text-decoration': 'underline' }\n\t    }\n\t});\n\n\tvar Normal = Attribute.define('erd.Normal', {\n\t    attrs: { text: { text: 'Normal' }}\n\t});\n\n\tvar ISA = Element$1.define('erd.ISA', {\n\t    type: 'erd.ISA',\n\t    size: { width: 100, height: 50 },\n\t    attrs: {\n\t        polygon: {\n\t            points: '0,0 50,50 100,0',\n\t            fill: '#F1C40F', stroke: '#F39C12', 'stroke-width': 2\n\t        },\n\t        text: {\n\t            text: 'ISA', 'font-size': 18,\n\t            'ref-x': .5, 'ref-y': .3,\n\t            'y-alignment': 'middle', 'text-anchor': 'middle'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon/></g><text/></g>',\n\t});\n\n\tvar Line$1 = Link.define('erd.Line', {}, {\n\t    cardinality: function(value) {\n\t        this.set('labels', [{ position: -20, attrs: { text: { dy: -8, text: value }}}]);\n\t    }\n\t});\n\n\tvar erd = ({\n\t\tEntity: Entity,\n\t\tWeakEntity: WeakEntity,\n\t\tRelationship: Relationship,\n\t\tIdentifyingRelationship: IdentifyingRelationship,\n\t\tAttribute: Attribute,\n\t\tMultivalued: Multivalued,\n\t\tDerived: Derived,\n\t\tKey: Key,\n\t\tNormal: Normal,\n\t\tISA: ISA,\n\t\tLine: Line$1\n\t});\n\n\tvar State = Circle.define('fsa.State', {\n\t    attrs: {\n\t        circle: { 'stroke-width': 3 },\n\t        text: { 'font-weight': '800' }\n\t    }\n\t});\n\n\tvar StartState = Element$1.define('fsa.StartState', {\n\t    size: { width: 20, height: 20 },\n\t    attrs: {\n\t        circle: {\n\t            transform: 'translate(10, 10)',\n\t            r: 10,\n\t            fill: '#000000'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle/></g></g>',\n\t});\n\n\tvar EndState = Element$1.define('fsa.EndState', {\n\t    size: { width: 20, height: 20 },\n\t    attrs: {\n\t        '.outer': {\n\t            transform: 'translate(10, 10)',\n\t            r: 10,\n\t            fill: '#ffffff',\n\t            stroke: '#000000'\n\t        },\n\n\t        '.inner': {\n\t            transform: 'translate(10, 10)',\n\t            r: 6,\n\t            fill: '#000000'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"outer\"/><circle class=\"inner\"/></g></g>',\n\t});\n\n\tvar Arrow = Link.define('fsa.Arrow', {\n\t    attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' }},\n\t    smooth: true\n\t});\n\n\tvar fsa = ({\n\t\tState: State,\n\t\tStartState: StartState,\n\t\tEndState: EndState,\n\t\tArrow: Arrow\n\t});\n\n\tvar Member = Element$1.define('org.Member', {\n\t    size: { width: 180, height: 70 },\n\t    attrs: {\n\t        rect: { width: 170, height: 60 },\n\n\t        '.card': {\n\t            fill: '#FFFFFF', stroke: '#000000', 'stroke-width': 2,\n\t            'pointer-events': 'visiblePainted', rx: 10, ry: 10\n\t        },\n\n\t        image: {\n\t            width: 48, height: 48,\n\t            ref: '.card', 'ref-x': 10, 'ref-y': 5\n\t        },\n\n\t        '.rank': {\n\t            'text-decoration': 'underline',\n\t            ref: '.card', 'ref-x': 0.9, 'ref-y': 0.2,\n\t            'font-family': 'Courier New', 'font-size': 14,\n\t            'text-anchor': 'end'\n\t        },\n\n\t        '.name': {\n\t            'font-weight': '800',\n\t            ref: '.card', 'ref-x': 0.9, 'ref-y': 0.6,\n\t            'font-family': 'Courier New', 'font-size': 14,\n\t            'text-anchor': 'end'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"card\"/><image/></g><text class=\"rank\"/><text class=\"name\"/></g>',\n\t});\n\n\tvar Arrow$1 = Link.define('org.Arrow', {\n\t    source: { selector: '.card' }, target: { selector: '.card' },\n\t    attrs: { '.connection': { stroke: '#585858', 'stroke-width': 3 }},\n\t    z: -1\n\t});\n\n\tvar org = ({\n\t\tMember: Member,\n\t\tArrow: Arrow$1\n\t});\n\n\tvar Place = Generic.define('pn.Place', {\n\t    size: { width: 50, height: 50 },\n\t    attrs: {\n\t        '.root': {\n\t            r: 25,\n\t            fill: '#ffffff',\n\t            stroke: '#000000',\n\t            transform: 'translate(25, 25)'\n\t        },\n\t        '.label': {\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-y': -20,\n\t            ref: '.root',\n\t            fill: '#000000',\n\t            'font-size': 12\n\t        },\n\t        '.tokens > circle': {\n\t            fill: '#000000',\n\t            r: 5\n\t        },\n\t        '.tokens.one > circle': { transform: 'translate(25, 25)' },\n\n\t        '.tokens.two > circle:nth-child(1)': { transform: 'translate(19, 25)' },\n\t        '.tokens.two > circle:nth-child(2)': { transform: 'translate(31, 25)' },\n\n\t        '.tokens.three > circle:nth-child(1)': { transform: 'translate(18, 29)' },\n\t        '.tokens.three > circle:nth-child(2)': { transform: 'translate(25, 19)' },\n\t        '.tokens.three > circle:nth-child(3)': { transform: 'translate(32, 29)' },\n\n\t        '.tokens.alot > text': {\n\t            transform: 'translate(25, 18)',\n\t            'text-anchor': 'middle',\n\t            fill: '#000000'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"root\"/><g class=\"tokens\" /></g><text class=\"label\"/></g>',\n\t});\n\n\tvar PlaceView = ElementView.extend({\n\n\t    presentationAttributes: ElementView.addPresentationAttributes({\n\t        tokens: ['TOKENS']\n\t    }),\n\n\t    initFlag: ElementView.prototype.initFlag.concat(['TOKENS']),\n\n\t    confirmUpdate: function() {\n\t        var ref;\n\n\t        var args = [], len = arguments.length;\n\t        while ( len-- ) args[ len ] = arguments[ len ];\n\t        var flags = (ref = ElementView.prototype.confirmUpdate).call.apply(ref, [ this ].concat( args ));\n\t        if (this.hasFlag(flags, 'TOKENS')) {\n\t            this.renderTokens();\n\t            this.update();\n\t            flags = this.removeFlag(flags, 'TOKENS');\n\t        }\n\t        return flags;\n\t    },\n\n\t    renderTokens: function() {\n\n\t        var vTokens = this.vel.findOne('.tokens').empty();\n\t        ['one', 'two', 'three', 'alot'].forEach(function(className) {\n\t            vTokens.removeClass(className);\n\t        });\n\n\t        var tokens = this.model.get('tokens');\n\t        if (!tokens) { return; }\n\n\t        switch (tokens) {\n\n\t            case 1:\n\t                vTokens.addClass('one');\n\t                vTokens.append(V('circle'));\n\t                break;\n\n\t            case 2:\n\t                vTokens.addClass('two');\n\t                vTokens.append([V('circle'), V('circle')]);\n\t                break;\n\n\t            case 3:\n\t                vTokens.addClass('three');\n\t                vTokens.append([V('circle'), V('circle'), V('circle')]);\n\t                break;\n\n\t            default:\n\t                vTokens.addClass('alot');\n\t                vTokens.append(V('text').text(tokens + ''));\n\t                break;\n\t        }\n\t    }\n\t});\n\n\tvar Transition = Generic.define('pn.Transition', {\n\t    size: { width: 12, height: 50 },\n\t    attrs: {\n\t        'rect': {\n\t            width: 12,\n\t            height: 50,\n\t            fill: '#000000',\n\t            stroke: '#000000'\n\t        },\n\t        '.label': {\n\t            'text-anchor': 'middle',\n\t            'ref-x': .5,\n\t            'ref-y': -20,\n\t            ref: 'rect',\n\t            fill: '#000000',\n\t            'font-size': 12\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"root\"/></g></g><text class=\"label\"/>',\n\t});\n\n\tvar Link$3 = Link.define('pn.Link', {\n\t    attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' }}\n\t});\n\n\tvar pn = ({\n\t\tPlace: Place,\n\t\tPlaceView: PlaceView,\n\t\tTransition: Transition,\n\t\tLink: Link$3\n\t});\n\n\tvar Class = Generic.define('uml.Class', {\n\t    attrs: {\n\t        rect: { 'width': 200 },\n\n\t        '.uml-class-name-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#3498db' },\n\t        '.uml-class-attrs-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#2980b9' },\n\t        '.uml-class-methods-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#2980b9' },\n\n\t        '.uml-class-name-text': {\n\t            'ref': '.uml-class-name-rect',\n\t            'ref-y': .5,\n\t            'ref-x': .5,\n\t            'text-anchor': 'middle',\n\t            'y-alignment': 'middle',\n\t            'font-weight': 'bold',\n\t            'fill': 'black',\n\t            'font-size': 12,\n\t            'font-family': 'Times New Roman'\n\t        },\n\t        '.uml-class-attrs-text': {\n\t            'ref': '.uml-class-attrs-rect', 'ref-y': 5, 'ref-x': 5,\n\t            'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'\n\t        },\n\t        '.uml-class-methods-text': {\n\t            'ref': '.uml-class-methods-rect', 'ref-y': 5, 'ref-x': 5,\n\t            'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'\n\t        }\n\t    },\n\n\t    name: [],\n\t    attributes: [],\n\t    methods: []\n\t}, {\n\t    markup: [\n\t        '<g class=\"rotatable\">',\n\t        '<g class=\"scalable\">',\n\t        '<rect class=\"uml-class-name-rect\"/><rect class=\"uml-class-attrs-rect\"/><rect class=\"uml-class-methods-rect\"/>',\n\t        '</g>',\n\t        '<text class=\"uml-class-name-text\"/><text class=\"uml-class-attrs-text\"/><text class=\"uml-class-methods-text\"/>',\n\t        '</g>'\n\t    ].join(''),\n\n\t    initialize: function() {\n\n\t        this.on('change:name change:attributes change:methods', function() {\n\t            this.updateRectangles();\n\t            this.trigger('uml-update');\n\t        }, this);\n\n\t        this.updateRectangles();\n\n\t        Generic.prototype.initialize.apply(this, arguments);\n\t    },\n\n\t    getClassName: function() {\n\t        return this.get('name');\n\t    },\n\n\t    updateRectangles: function() {\n\n\t        var attrs = this.get('attrs');\n\n\t        var rects = [\n\t            { type: 'name', text: this.getClassName() },\n\t            { type: 'attrs', text: this.get('attributes') },\n\t            { type: 'methods', text: this.get('methods') }\n\t        ];\n\n\t        var offsetY = 0;\n\n\t        rects.forEach(function(rect) {\n\n\t            var lines = Array.isArray(rect.text) ? rect.text : [rect.text];\n\t            var rectHeight = lines.length * 20 + 20;\n\n\t            attrs['.uml-class-' + rect.type + '-text'].text = lines.join('\\n');\n\t            attrs['.uml-class-' + rect.type + '-rect'].height = rectHeight;\n\t            attrs['.uml-class-' + rect.type + '-rect'].transform = 'translate(0,' + offsetY + ')';\n\n\t            offsetY += rectHeight;\n\t        });\n\t    }\n\n\t});\n\n\tvar ClassView = ElementView.extend({\n\n\t    initialize: function() {\n\n\t        ElementView.prototype.initialize.apply(this, arguments);\n\n\t        this.listenTo(this.model, 'uml-update', function() {\n\t            this.update();\n\t            this.resize();\n\t        });\n\t    }\n\t});\n\n\tvar Abstract = Class.define('uml.Abstract', {\n\t    attrs: {\n\t        '.uml-class-name-rect': { fill: '#e74c3c' },\n\t        '.uml-class-attrs-rect': { fill: '#c0392b' },\n\t        '.uml-class-methods-rect': { fill: '#c0392b' }\n\t    }\n\t}, {\n\n\t    getClassName: function() {\n\t        return ['<<Abstract>>', this.get('name')];\n\t    }\n\n\t});\n\tvar AbstractView = ClassView;\n\n\tvar Interface = Class.define('uml.Interface', {\n\t    attrs: {\n\t        '.uml-class-name-rect': { fill: '#f1c40f' },\n\t        '.uml-class-attrs-rect': { fill: '#f39c12' },\n\t        '.uml-class-methods-rect': { fill: '#f39c12' }\n\t    }\n\t}, {\n\t    getClassName: function() {\n\t        return ['<<Interface>>', this.get('name')];\n\t    }\n\t});\n\tvar InterfaceView = ClassView;\n\n\tvar Generalization = Link.define('uml.Generalization', {\n\t    attrs: { '.marker-target': { d: 'M 20 0 L 0 10 L 20 20 z', fill: 'white' }}\n\t});\n\n\tvar Implementation = Link.define('uml.Implementation', {\n\t    attrs: {\n\t        '.marker-target': { d: 'M 20 0 L 0 10 L 20 20 z', fill: 'white' },\n\t        '.connection': { 'stroke-dasharray': '3,3' }\n\t    }\n\t});\n\n\tvar Aggregation = Link.define('uml.Aggregation', {\n\t    attrs: { '.marker-target': { d: 'M 40 10 L 20 20 L 0 10 L 20 0 z', fill: 'white' }}\n\t});\n\n\tvar Composition = Link.define('uml.Composition', {\n\t    attrs: { '.marker-target': { d: 'M 40 10 L 20 20 L 0 10 L 20 0 z', fill: 'black' }}\n\t});\n\n\tvar Association = Link.define('uml.Association');\n\n\t// Statechart\n\n\tvar State$1 = Generic.define('uml.State', {\n\t    attrs: {\n\t        '.uml-state-body': {\n\t            'width': 200, 'height': 200, 'rx': 10, 'ry': 10,\n\t            'fill': '#ecf0f1', 'stroke': '#bdc3c7', 'stroke-width': 3\n\t        },\n\t        '.uml-state-separator': {\n\t            'stroke': '#bdc3c7', 'stroke-width': 2\n\t        },\n\t        '.uml-state-name': {\n\t            'ref': '.uml-state-body', 'ref-x': .5, 'ref-y': 5, 'text-anchor': 'middle',\n\t            'fill': '#000000', 'font-family': 'Courier New', 'font-size': 14\n\t        },\n\t        '.uml-state-events': {\n\t            'ref': '.uml-state-separator', 'ref-x': 5, 'ref-y': 5,\n\t            'fill': '#000000', 'font-family': 'Courier New', 'font-size': 14\n\t        }\n\t    },\n\n\t    name: 'State',\n\t    events: []\n\n\t}, {\n\t    markup: [\n\t        '<g class=\"rotatable\">',\n\t        '<g class=\"scalable\">',\n\t        '<rect class=\"uml-state-body\"/>',\n\t        '</g>',\n\t        '<path class=\"uml-state-separator\"/>',\n\t        '<text class=\"uml-state-name\"/>',\n\t        '<text class=\"uml-state-events\"/>',\n\t        '</g>'\n\t    ].join(''),\n\n\t    initialize: function() {\n\n\t        this.on({\n\t            'change:name': this.updateName,\n\t            'change:events': this.updateEvents,\n\t            'change:size': this.updatePath\n\t        }, this);\n\n\t        this.updateName();\n\t        this.updateEvents();\n\t        this.updatePath();\n\n\t        Generic.prototype.initialize.apply(this, arguments);\n\t    },\n\n\t    updateName: function() {\n\n\t        this.attr('.uml-state-name/text', this.get('name'));\n\t    },\n\n\t    updateEvents: function() {\n\n\t        this.attr('.uml-state-events/text', this.get('events').join('\\n'));\n\t    },\n\n\t    updatePath: function() {\n\n\t        var d = 'M 0 20 L ' + this.get('size').width + ' 20';\n\n\t        // We are using `silent: true` here because updatePath() is meant to be called\n\t        // on resize and there's no need to to update the element twice (`change:size`\n\t        // triggers also an update).\n\t        this.attr('.uml-state-separator/d', d, { silent: true });\n\t    }\n\t});\n\n\tvar StartState$1 = Circle.define('uml.StartState', {\n\t    type: 'uml.StartState',\n\t    attrs: { circle: { 'fill': '#34495e', 'stroke': '#2c3e50', 'stroke-width': 2, 'rx': 1 }}\n\t});\n\n\tvar EndState$1 = Generic.define('uml.EndState', {\n\t    size: { width: 20, height: 20 },\n\t    attrs: {\n\t        'circle.outer': {\n\t            transform: 'translate(10, 10)',\n\t            r: 10,\n\t            fill: '#ffffff',\n\t            stroke: '#2c3e50'\n\t        },\n\n\t        'circle.inner': {\n\t            transform: 'translate(10, 10)',\n\t            r: 6,\n\t            fill: '#34495e'\n\t        }\n\t    }\n\t}, {\n\t    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"outer\"/><circle class=\"inner\"/></g></g>',\n\t});\n\n\tvar Transition$1 = Link.define('uml.Transition', {\n\t    attrs: {\n\t        '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z', fill: '#34495e', stroke: '#2c3e50' },\n\t        '.connection': { stroke: '#2c3e50' }\n\t    }\n\t});\n\n\tvar uml = ({\n\t\tClass: Class,\n\t\tClassView: ClassView,\n\t\tAbstract: Abstract,\n\t\tAbstractView: AbstractView,\n\t\tInterface: Interface,\n\t\tInterfaceView: InterfaceView,\n\t\tGeneralization: Generalization,\n\t\tImplementation: Implementation,\n\t\tAggregation: Aggregation,\n\t\tComposition: Composition,\n\t\tAssociation: Association,\n\t\tState: State$1,\n\t\tStartState: StartState$1,\n\t\tEndState: EndState$1,\n\t\tTransition: Transition$1\n\t});\n\n\n\n\tvar index$3 = ({\n\t\tbasic: basic,\n\t\tstandard: standard,\n\t\tdevs: devs,\n\t\tlogic: logic,\n\t\tchess: chess,\n\t\terd: erd,\n\t\tfsa: fsa,\n\t\torg: org,\n\t\tpn: pn,\n\t\tuml: uml\n\t});\n\n\tfunction abs2rel(absolute, max) {\n\n\t    if (max === 0) { return '0%'; }\n\t    // round to 3 decimal places\n\t    var dp = 1000;\n\t    var relative = Math.round(absolute / max * 100 * dp) / dp;\n\t    return (relative + \"%\");\n\t}\n\n\tfunction pin(relative) {\n\n\t    return function(end, view, magnet, coords) {\n\t        var fn = (view.isNodeConnection(magnet)) ? pinnedLinkEnd : pinnedElementEnd;\n\t        return fn(relative, end, view, magnet, coords);\n\t    };\n\t}\n\n\tfunction pinnedElementEnd(relative, end, view, magnet, coords) {\n\n\t    var angle = view.model.angle();\n\t    var bbox = view.getNodeUnrotatedBBox(magnet);\n\t    var origin = view.model.getBBox().center();\n\t    coords.rotate(origin, angle);\n\t    var dx = coords.x - bbox.x;\n\t    var dy = coords.y - bbox.y;\n\n\t    if (relative) {\n\t        dx = abs2rel(dx, bbox.width);\n\t        dy = abs2rel(dy, bbox.height);\n\t    }\n\n\t    end.anchor = {\n\t        name: 'topLeft',\n\t        args: {\n\t            dx: dx,\n\t            dy: dy,\n\t            rotate: true\n\t        }\n\t    };\n\n\t    return end;\n\t}\n\n\tfunction pinnedLinkEnd(relative, end, view, _magnet, coords) {\n\n\t    var connection = view.getConnection();\n\t    if (!connection) { return end; }\n\t    var length = connection.closestPointLength(coords);\n\t    if (relative) {\n\t        var totalLength = connection.length();\n\t        end.anchor = {\n\t            name: 'connectionRatio',\n\t            args: {\n\t                ratio: length / totalLength\n\t            }\n\t        };\n\t    } else {\n\t        end.anchor = {\n\t            name: 'connectionLength',\n\t            args: {\n\t                length: length\n\t            }\n\t        };\n\t    }\n\t    return end;\n\t}\n\n\tvar useDefaults = noop;\n\tvar pinAbsolute = pin(false);\n\tvar pinRelative = pin(true);\n\n\tvar index$4 = ({\n\t\tuseDefaults: useDefaults,\n\t\tpinAbsolute: pinAbsolute,\n\t\tpinRelative: pinRelative\n\t});\n\n\tfunction getAnchor(coords, view, magnet) {\n\t    // take advantage of an existing logic inside of the\n\t    // pin relative connection strategy\n\t    var end = pinRelative.call(\n\t        this.paper,\n\t        {},\n\t        view,\n\t        magnet,\n\t        coords,\n\t        this.model\n\t    );\n\t    return end.anchor;\n\t}\n\n\tfunction snapAnchor(coords, view, magnet, type, relatedView, toolView) {\n\t    var snapRadius = toolView.options.snapRadius;\n\t    var isSource = (type === 'source');\n\t    var refIndex = (isSource ? 0 : -1);\n\t    var ref = this.model.vertex(refIndex) || this.getEndAnchor(isSource ? 'target' : 'source');\n\t    if (ref) {\n\t        if (Math.abs(ref.x - coords.x) < snapRadius) { coords.x = ref.x; }\n\t        if (Math.abs(ref.y - coords.y) < snapRadius) { coords.y = ref.y; }\n\t    }\n\t    return coords;\n\t}\n\n\tfunction getViewBBox(view, useModelGeometry) {\n\t    var model = view.model;\n\t    if (useModelGeometry) { return model.getBBox(); }\n\t    return (model.isLink()) ? view.getConnection().bbox() : view.getNodeUnrotatedBBox(view.el);\n\t}\n\n\t// Vertex Handles\n\tvar VertexHandle = View.extend({\n\t    tagName: 'circle',\n\t    svgElement: true,\n\t    className: 'marker-vertex',\n\t    events: {\n\t        mousedown: 'onPointerDown',\n\t        touchstart: 'onPointerDown',\n\t        dblclick: 'onDoubleClick',\n\t        dbltap: 'onDoubleClick'\n\t    },\n\t    documentEvents: {\n\t        mousemove: 'onPointerMove',\n\t        touchmove: 'onPointerMove',\n\t        mouseup: 'onPointerUp',\n\t        touchend: 'onPointerUp',\n\t        touchcancel: 'onPointerUp'\n\t    },\n\t    attributes: {\n\t        'r': 6,\n\t        'fill': '#33334F',\n\t        'stroke': '#FFFFFF',\n\t        'stroke-width': 2,\n\t        'cursor': 'move'\n\t    },\n\t    position: function(x, y) {\n\t        this.vel.attr({ cx: x, cy: y });\n\t    },\n\t    onPointerDown: function(evt) {\n\t        if (this.options.guard(evt)) { return; }\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        this.options.paper.undelegateEvents();\n\t        this.delegateDocumentEvents(null, evt.data);\n\t        this.trigger('will-change', this, evt);\n\t    },\n\t    onPointerMove: function(evt) {\n\t        this.trigger('changing', this, evt);\n\t    },\n\t    onDoubleClick: function(evt) {\n\t        this.trigger('remove', this, evt);\n\t    },\n\t    onPointerUp: function(evt) {\n\t        this.trigger('changed', this, evt);\n\t        this.undelegateDocumentEvents();\n\t        this.options.paper.delegateEvents();\n\t    }\n\t});\n\n\tvar Vertices = ToolView.extend({\n\t    name: 'vertices',\n\t    options: {\n\t        handleClass: VertexHandle,\n\t        snapRadius: 20,\n\t        redundancyRemoval: true,\n\t        vertexAdding: true,\n\t        stopPropagation: true\n\t    },\n\t    children: [{\n\t        tagName: 'path',\n\t        selector: 'connection',\n\t        className: 'joint-vertices-path',\n\t        attributes: {\n\t            'fill': 'none',\n\t            'stroke': 'transparent',\n\t            'stroke-width': 10,\n\t            'cursor': 'cell'\n\t        }\n\t    }],\n\t    handles: null,\n\t    events: {\n\t        'mousedown .joint-vertices-path': 'onPathPointerDown',\n\t        'touchstart .joint-vertices-path': 'onPathPointerDown'\n\t    },\n\t    onRender: function() {\n\t        if (this.options.vertexAdding) {\n\t            this.renderChildren();\n\t            this.updatePath();\n\t        }\n\t        this.resetHandles();\n\t        this.renderHandles();\n\t        return this;\n\t    },\n\t    update: function() {\n\t        var relatedView = this.relatedView;\n\t        var vertices = relatedView.model.vertices();\n\t        if (vertices.length === this.handles.length) {\n\t            this.updateHandles();\n\t        } else {\n\t            this.resetHandles();\n\t            this.renderHandles();\n\t        }\n\t        if (this.options.vertexAdding) {\n\t            this.updatePath();\n\t        }\n\t        return this;\n\t    },\n\t    resetHandles: function() {\n\t        var handles = this.handles;\n\t        this.handles = [];\n\t        this.stopListening();\n\t        if (!Array.isArray(handles)) { return; }\n\t        for (var i = 0, n = handles.length; i < n; i++) {\n\t            handles[i].remove();\n\t        }\n\t    },\n\t    renderHandles: function() {\n\t        var this$1 = this;\n\n\t        var relatedView = this.relatedView;\n\t        var vertices = relatedView.model.vertices();\n\t        for (var i = 0, n = vertices.length; i < n; i++) {\n\t            var vertex = vertices[i];\n\t            var handle = new (this.options.handleClass)({\n\t                index: i,\n\t                paper: this.paper,\n\t                guard: function (evt) { return this$1.guard(evt); }\n\t            });\n\t            handle.render();\n\t            handle.position(vertex.x, vertex.y);\n\t            this.simulateRelatedView(handle.el);\n\t            handle.vel.appendTo(this.el);\n\t            this.handles.push(handle);\n\t            this.startHandleListening(handle);\n\t        }\n\t    },\n\t    updateHandles: function() {\n\t        var relatedView = this.relatedView;\n\t        var vertices = relatedView.model.vertices();\n\t        for (var i = 0, n = vertices.length; i < n; i++) {\n\t            var vertex = vertices[i];\n\t            var handle = this.handles[i];\n\t            if (!handle) { return; }\n\t            handle.position(vertex.x, vertex.y);\n\t        }\n\t    },\n\t    updatePath: function() {\n\t        var connection = this.childNodes.connection;\n\t        if (connection) { connection.setAttribute('d', this.relatedView.getSerializedConnection()); }\n\t    },\n\t    startHandleListening: function(handle) {\n\t        var relatedView = this.relatedView;\n\t        if (relatedView.can('vertexMove')) {\n\t            this.listenTo(handle, 'will-change', this.onHandleWillChange);\n\t            this.listenTo(handle, 'changing', this.onHandleChanging);\n\t            this.listenTo(handle, 'changed', this.onHandleChanged);\n\t        }\n\t        if (relatedView.can('vertexRemove')) {\n\t            this.listenTo(handle, 'remove', this.onHandleRemove);\n\t        }\n\t    },\n\t    getNeighborPoints: function(index) {\n\t        var linkView = this.relatedView;\n\t        var vertices = linkView.model.vertices();\n\t        var prev = (index > 0) ? vertices[index - 1] : linkView.sourceAnchor;\n\t        var next = (index < vertices.length - 1) ? vertices[index + 1] : linkView.targetAnchor;\n\t        return {\n\t            prev: new Point(prev),\n\t            next: new Point(next)\n\t        };\n\t    },\n\t    onHandleWillChange: function(_handle, evt) {\n\t        this.focus();\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        var options = ref.options;\n\t        relatedView.model.startBatch('vertex-move', { ui: true, tool: this.cid });\n\t        if (!options.stopPropagation) { relatedView.notifyPointerdown.apply(relatedView, relatedView.paper.getPointerArgs(evt)); }\n\t    },\n\t    onHandleChanging: function(handle, evt) {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var linkView = ref.relatedView;\n\t        var index = handle.options.index;\n\t        var ref$1 = linkView.paper.getPointerArgs(evt);\n\t        var normalizedEvent = ref$1[0];\n\t        var x = ref$1[1];\n\t        var y = ref$1[2];\n\t        var vertex = { x: x, y: y };\n\t        this.snapVertex(vertex, index);\n\t        linkView.model.vertex(index, vertex, { ui: true, tool: this.cid });\n\t        handle.position(vertex.x, vertex.y);\n\t        if (!options.stopPropagation) { linkView.notifyPointermove(normalizedEvent, x, y); }\n\t    },\n\t    onHandleChanged: function(_handle, evt) {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var linkView = ref.relatedView;\n\t        if (options.vertexAdding) { this.updatePath(); }\n\t        if (!options.redundancyRemoval) { return; }\n\t        var verticesRemoved = linkView.removeRedundantLinearVertices({ ui: true, tool: this.cid });\n\t        if (verticesRemoved) { this.render(); }\n\t        this.blur();\n\t        linkView.model.stopBatch('vertex-move', { ui: true, tool: this.cid });\n\t        if (this.eventData(evt).vertexAdded) {\n\t            linkView.model.stopBatch('vertex-add', { ui: true, tool: this.cid });\n\t        }\n\t        var ref$1 = linkView.paper.getPointerArgs(evt);\n\t        var normalizedEvt = ref$1[0];\n\t        var x = ref$1[1];\n\t        var y = ref$1[2];\n\t        if (!options.stopPropagation) { linkView.notifyPointerup(normalizedEvt, x, y); }\n\t        linkView.checkMouseleave(normalizedEvt);\n\t    },\n\t    snapVertex: function(vertex, index) {\n\t        var snapRadius = this.options.snapRadius;\n\t        if (snapRadius > 0) {\n\t            var neighbors = this.getNeighborPoints(index);\n\t            var prev = neighbors.prev;\n\t            var next = neighbors.next;\n\t            if (Math.abs(vertex.x - prev.x) < snapRadius) {\n\t                vertex.x = prev.x;\n\t            } else if (Math.abs(vertex.x - next.x) < snapRadius) {\n\t                vertex.x = next.x;\n\t            }\n\t            if (Math.abs(vertex.y - prev.y) < snapRadius) {\n\t                vertex.y = neighbors.prev.y;\n\t            } else if (Math.abs(vertex.y - next.y) < snapRadius) {\n\t                vertex.y = next.y;\n\t            }\n\t        }\n\t    },\n\t    onHandleRemove: function(handle, evt) {\n\t        var index$1 = handle.options.index;\n\t        var linkView = this.relatedView;\n\t        linkView.model.removeVertex(index$1, { ui: true });\n\t        if (this.options.vertexAdding) { this.updatePath(); }\n\t        linkView.checkMouseleave(normalizeEvent(evt));\n\t    },\n\t    onPathPointerDown: function(evt) {\n\t        if (this.guard(evt)) { return; }\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var vertex = this.paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY).toJSON();\n\t        var relatedView = this.relatedView;\n\t        relatedView.model.startBatch('vertex-add', { ui: true, tool: this.cid });\n\t        var index$1 = relatedView.getVertexIndex(vertex.x, vertex.y);\n\t        this.snapVertex(vertex, index$1);\n\t        relatedView.model.insertVertex(index$1, vertex, { ui: true, tool: this.cid });\n\t        this.update();\n\t        var handle = this.handles[index$1];\n\t        this.eventData(normalizedEvent, { vertexAdded: true });\n\t        handle.onPointerDown(normalizedEvent);\n\t    },\n\t    onRemove: function() {\n\t        this.resetHandles();\n\t    }\n\t}, {\n\t    VertexHandle: VertexHandle // keep as class property\n\t});\n\n\tvar SegmentHandle = View.extend({\n\t    tagName: 'g',\n\t    svgElement: true,\n\t    className: 'marker-segment',\n\t    events: {\n\t        mousedown: 'onPointerDown',\n\t        touchstart: 'onPointerDown'\n\t    },\n\t    documentEvents: {\n\t        mousemove: 'onPointerMove',\n\t        touchmove: 'onPointerMove',\n\t        mouseup: 'onPointerUp',\n\t        touchend: 'onPointerUp',\n\t        touchcancel: 'onPointerUp'\n\t    },\n\t    children: [{\n\t        tagName: 'line',\n\t        selector: 'line',\n\t        attributes: {\n\t            'stroke': '#33334F',\n\t            'stroke-width': 2,\n\t            'fill': 'none',\n\t            'pointer-events': 'none'\n\t        }\n\t    }, {\n\t        tagName: 'rect',\n\t        selector: 'handle',\n\t        attributes: {\n\t            'width': 20,\n\t            'height': 8,\n\t            'x': -10,\n\t            'y': -4,\n\t            'rx': 4,\n\t            'ry': 4,\n\t            'fill': '#33334F',\n\t            'stroke': '#FFFFFF',\n\t            'stroke-width': 2\n\t        }\n\t    }],\n\t    onRender: function() {\n\t        this.renderChildren();\n\t    },\n\t    position: function(x, y, angle, view) {\n\n\t        var matrix = V.createSVGMatrix().translate(x, y).rotate(angle);\n\t        var handle = this.childNodes.handle;\n\t        handle.setAttribute('transform', V.matrixToTransformString(matrix));\n\t        handle.setAttribute('cursor', (angle % 180 === 0) ? 'row-resize' : 'col-resize');\n\n\t        var viewPoint = view.getClosestPoint(new Point(x, y));\n\t        var line = this.childNodes.line;\n\t        line.setAttribute('x1', x);\n\t        line.setAttribute('y1', y);\n\t        line.setAttribute('x2', viewPoint.x);\n\t        line.setAttribute('y2', viewPoint.y);\n\t    },\n\t    onPointerDown: function(evt) {\n\t        if (this.options.guard(evt)) { return; }\n\t        this.trigger('change:start', this, evt);\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        this.options.paper.undelegateEvents();\n\t        this.delegateDocumentEvents(null, evt.data);\n\t    },\n\t    onPointerMove: function(evt) {\n\t        this.trigger('changing', this, evt);\n\t    },\n\t    onPointerUp: function(evt) {\n\t        this.undelegateDocumentEvents();\n\t        this.options.paper.delegateEvents();\n\t        this.trigger('change:end', this, evt);\n\t    },\n\t    show: function() {\n\t        this.el.style.display = '';\n\t    },\n\t    hide: function() {\n\t        this.el.style.display = 'none';\n\t    }\n\t});\n\n\tvar Segments = ToolView.extend({\n\t    name: 'segments',\n\t    precision: .5,\n\t    options: {\n\t        handleClass: SegmentHandle,\n\t        segmentLengthThreshold: 40,\n\t        redundancyRemoval: true,\n\t        anchor: getAnchor,\n\t        snapRadius: 10,\n\t        snapHandle: true,\n\t        stopPropagation: true\n\t    },\n\t    handles: null,\n\t    onRender: function() {\n\t        this.resetHandles();\n\t        var relatedView = this.relatedView;\n\t        var vertices = relatedView.model.vertices();\n\t        vertices.unshift(relatedView.sourcePoint);\n\t        vertices.push(relatedView.targetPoint);\n\t        for (var i = 0, n = vertices.length; i < n - 1; i++) {\n\t            var vertex = vertices[i];\n\t            var nextVertex = vertices[i + 1];\n\t            var handle = this.renderHandle(vertex, nextVertex);\n\t            this.simulateRelatedView(handle.el);\n\t            this.handles.push(handle);\n\t            handle.options.index = i;\n\t        }\n\t        return this;\n\t    },\n\t    renderHandle: function(vertex, nextVertex) {\n\t        var this$1 = this;\n\n\t        var handle = new (this.options.handleClass)({\n\t            paper: this.paper,\n\t            guard: function (evt) { return this$1.guard(evt); }\n\t        });\n\t        handle.render();\n\t        this.updateHandle(handle, vertex, nextVertex);\n\t        handle.vel.appendTo(this.el);\n\t        this.startHandleListening(handle);\n\t        return handle;\n\t    },\n\t    update: function() {\n\t        this.render();\n\t        return this;\n\t    },\n\t    startHandleListening: function(handle) {\n\t        this.listenTo(handle, 'change:start', this.onHandleChangeStart);\n\t        this.listenTo(handle, 'changing', this.onHandleChanging);\n\t        this.listenTo(handle, 'change:end', this.onHandleChangeEnd);\n\t    },\n\t    resetHandles: function() {\n\t        var handles = this.handles;\n\t        this.handles = [];\n\t        this.stopListening();\n\t        if (!Array.isArray(handles)) { return; }\n\t        for (var i = 0, n = handles.length; i < n; i++) {\n\t            handles[i].remove();\n\t        }\n\t    },\n\t    shiftHandleIndexes: function(value) {\n\t        var handles = this.handles;\n\t        for (var i = 0, n = handles.length; i < n; i++) { handles[i].options.index += value; }\n\t    },\n\t    resetAnchor: function(type, anchor) {\n\t        var relatedModel = this.relatedView.model;\n\t        if (anchor) {\n\t            relatedModel.prop([type, 'anchor'], anchor, {\n\t                rewrite: true,\n\t                ui: true,\n\t                tool: this.cid\n\t            });\n\t        } else {\n\t            relatedModel.removeProp([type, 'anchor'], {\n\t                ui: true,\n\t                tool: this.cid\n\t            });\n\t        }\n\t    },\n\t    snapHandle: function(handle, position, data) {\n\n\t        var index = handle.options.index;\n\t        var linkView = this.relatedView;\n\t        var link = linkView.model;\n\t        var vertices = link.vertices();\n\t        var axis = handle.options.axis;\n\t        var prev = vertices[index - 2] || data.sourceAnchor;\n\t        var next = vertices[index + 1] || data.targetAnchor;\n\t        var snapRadius = this.options.snapRadius;\n\t        if (Math.abs(position[axis] - prev[axis]) < snapRadius) {\n\t            position[axis] = prev[axis];\n\t        } else if (Math.abs(position[axis] - next[axis]) < snapRadius) {\n\t            position[axis] = next[axis];\n\t        }\n\t        return position;\n\t    },\n\n\t    onHandleChanging: function(handle, evt) {\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var data = this.eventData(evt);\n\t        var relatedView = this.relatedView;\n\t        var paper = relatedView.paper;\n\t        var index$1 = handle.options.index - 1;\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var coords = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        var position = this.snapHandle(handle, coords.clone(), data);\n\t        var axis = handle.options.axis;\n\t        var offset = (this.options.snapHandle) ? 0 : (coords[axis] - position[axis]);\n\t        var link = relatedView.model;\n\t        var vertices = cloneDeep(link.vertices());\n\t        var vertex = vertices[index$1];\n\t        var nextVertex = vertices[index$1 + 1];\n\t        var anchorFn = this.options.anchor;\n\t        if (typeof anchorFn !== 'function') { anchorFn = null; }\n\n\t        // First Segment\n\t        var sourceView = relatedView.sourceView;\n\t        var sourceBBox = relatedView.sourceBBox;\n\t        var changeSourceAnchor = false;\n\t        var deleteSourceAnchor = false;\n\t        if (!vertex) {\n\t            vertex = relatedView.sourceAnchor.toJSON();\n\t            vertex[axis] = position[axis];\n\t            if (sourceBBox.containsPoint(vertex)) {\n\t                vertex[axis] = position[axis];\n\t                changeSourceAnchor = true;\n\t            } else {\n\t                // we left the area of the source magnet for the first time\n\t                vertices.unshift(vertex);\n\t                this.shiftHandleIndexes(1);\n\t                deleteSourceAnchor = true;\n\t            }\n\t        } else if (index$1 === 0) {\n\t            if (sourceBBox.containsPoint(vertex)) {\n\t                vertices.shift();\n\t                this.shiftHandleIndexes(-1);\n\t                changeSourceAnchor = true;\n\t            } else {\n\t                vertex[axis] = position[axis];\n\t                deleteSourceAnchor = true;\n\t            }\n\t        } else {\n\t            vertex[axis] = position[axis];\n\t        }\n\n\t        if (anchorFn && sourceView) {\n\t            if (changeSourceAnchor) {\n\t                var sourceAnchorPosition = data.sourceAnchor.clone();\n\t                sourceAnchorPosition[axis] = position[axis];\n\t                var sourceAnchor = anchorFn.call(relatedView, sourceAnchorPosition, sourceView, relatedView.sourceMagnet || sourceView.el, 'source', relatedView);\n\t                this.resetAnchor('source', sourceAnchor);\n\t            }\n\t            if (deleteSourceAnchor) {\n\t                this.resetAnchor('source', data.sourceAnchorDef);\n\t            }\n\t        }\n\n\t        // Last segment\n\t        var targetView = relatedView.targetView;\n\t        var targetBBox = relatedView.targetBBox;\n\t        var changeTargetAnchor = false;\n\t        var deleteTargetAnchor = false;\n\t        if (!nextVertex) {\n\t            nextVertex = relatedView.targetAnchor.toJSON();\n\t            nextVertex[axis] = position[axis];\n\t            if (targetBBox.containsPoint(nextVertex)) {\n\t                changeTargetAnchor = true;\n\t            } else {\n\t                // we left the area of the target magnet for the first time\n\t                vertices.push(nextVertex);\n\t                deleteTargetAnchor = true;\n\t            }\n\t        } else if (index$1 === vertices.length - 2) {\n\t            if (targetBBox.containsPoint(nextVertex)) {\n\t                vertices.pop();\n\t                changeTargetAnchor = true;\n\t            } else {\n\t                nextVertex[axis] = position[axis];\n\t                deleteTargetAnchor = true;\n\t            }\n\t        } else {\n\t            nextVertex[axis] = position[axis];\n\t        }\n\n\t        if (anchorFn && targetView) {\n\t            if (changeTargetAnchor) {\n\t                var targetAnchorPosition = data.targetAnchor.clone();\n\t                targetAnchorPosition[axis] = position[axis];\n\t                var targetAnchor = anchorFn.call(relatedView, targetAnchorPosition, targetView, relatedView.targetMagnet || targetView.el, 'target', relatedView);\n\t                this.resetAnchor('target', targetAnchor);\n\t            }\n\t            if (deleteTargetAnchor) {\n\t                this.resetAnchor('target', data.targetAnchorDef);\n\t            }\n\t        }\n\n\t        link.vertices(vertices, { ui: true, tool: this.cid });\n\t        this.updateHandle(handle, vertex, nextVertex, offset);\n\t        if (!options.stopPropagation) { relatedView.notifyPointermove(normalizedEvent, coords.x, coords.y); }\n\t    },\n\t    onHandleChangeStart: function(handle, evt) {\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var handles = ref.handles;\n\t        var linkView = ref.relatedView;\n\t        var model = linkView.model;\n\t        var paper = linkView.paper;\n\t        var index$1 = handle.options.index;\n\t        if (!Array.isArray(handles)) { return; }\n\t        for (var i = 0, n = handles.length; i < n; i++) {\n\t            if (i !== index$1) { handles[i].hide(); }\n\t        }\n\t        this.focus();\n\t        this.eventData(evt, {\n\t            sourceAnchor: linkView.sourceAnchor.clone(),\n\t            targetAnchor: linkView.targetAnchor.clone(),\n\t            sourceAnchorDef: clone(model.prop(['source', 'anchor'])),\n\t            targetAnchorDef: clone(model.prop(['target', 'anchor']))\n\t        });\n\t        model.startBatch('segment-move', { ui: true, tool: this.cid });\n\t        if (!options.stopPropagation) { linkView.notifyPointerdown.apply(linkView, paper.getPointerArgs(evt)); }\n\t    },\n\t    onHandleChangeEnd: function(_handle, evt) {\n\t        var ref= this;\n\t        var options = ref.options;\n\t        var linkView = ref.relatedView;\n\t        var paper = linkView.paper;\n\t        var model = linkView.model;\n\t        if (options.redundancyRemoval) {\n\t            linkView.removeRedundantLinearVertices({ ui: true, tool: this.cid });\n\t        }\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var coords = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        this.render();\n\t        this.blur();\n\t        model.stopBatch('segment-move', { ui: true, tool: this.cid });\n\t        if (!options.stopPropagation) { linkView.notifyPointerup(normalizedEvent, coords.x, coords.y); }\n\t        linkView.checkMouseleave(normalizedEvent);\n\t    },\n\t    updateHandle: function(handle, vertex, nextVertex, offset) {\n\t        var vertical = Math.abs(vertex.x - nextVertex.x) < this.precision;\n\t        var horizontal = Math.abs(vertex.y - nextVertex.y) < this.precision;\n\t        if (vertical || horizontal) {\n\t            var segmentLine = new Line(vertex, nextVertex);\n\t            var length = segmentLine.length();\n\t            if (length < this.options.segmentLengthThreshold) {\n\t                handle.hide();\n\t            } else {\n\t                var position = segmentLine.midpoint();\n\t                var axis = (vertical) ? 'x' : 'y';\n\t                position[axis] += offset || 0;\n\t                var angle = segmentLine.vector().vectorAngle(new Point(1, 0));\n\t                handle.position(position.x, position.y, angle, this.relatedView);\n\t                handle.show();\n\t                handle.options.axis = axis;\n\t            }\n\t        } else {\n\t            handle.hide();\n\t        }\n\t    },\n\t    onRemove: function() {\n\t        this.resetHandles();\n\t    }\n\t}, {\n\t    SegmentHandle: SegmentHandle // keep as class property\n\t});\n\n\t// End Markers\n\tvar Arrowhead = ToolView.extend({\n\t    tagName: 'path',\n\t    xAxisVector: new Point(1, 0),\n\t    events: {\n\t        mousedown: 'onPointerDown',\n\t        touchstart: 'onPointerDown'\n\t    },\n\t    documentEvents: {\n\t        mousemove: 'onPointerMove',\n\t        touchmove: 'onPointerMove',\n\t        mouseup: 'onPointerUp',\n\t        touchend: 'onPointerUp',\n\t        touchcancel: 'onPointerUp'\n\t    },\n\t    onRender: function() {\n\t        this.update();\n\t    },\n\t    update: function() {\n\t        var ratio = this.ratio;\n\t        var view = this.relatedView;\n\t        var tangent = view.getTangentAtRatio(ratio);\n\t        var position, angle;\n\t        if (tangent) {\n\t            position = tangent.start;\n\t            angle = tangent.vector().vectorAngle(this.xAxisVector) || 0;\n\t        } else {\n\t            position = view.getPointAtRatio(ratio);\n\t            angle = 0;\n\t        }\n\t        if (!position) { return this; }\n\t        var matrix = V.createSVGMatrix().translate(position.x, position.y).rotate(angle);\n\t        this.vel.transform(matrix, { absolute: true });\n\t        return this;\n\t    },\n\t    onPointerDown: function(evt) {\n\t        if (this.guard(evt)) { return; }\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        var relatedView = this.relatedView;\n\t        relatedView.model.startBatch('arrowhead-move', { ui: true, tool: this.cid });\n\t        if (relatedView.can('arrowheadMove')) {\n\t            relatedView.startArrowheadMove(this.arrowheadType);\n\t            this.delegateDocumentEvents();\n\t            relatedView.paper.undelegateEvents();\n\t        }\n\t        this.focus();\n\t        this.el.style.pointerEvents = 'none';\n\t    },\n\t    onPointerMove: function(evt) {\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var coords = this.paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        this.relatedView.pointermove(normalizedEvent, coords.x, coords.y);\n\t    },\n\t    onPointerUp: function(evt) {\n\t        this.undelegateDocumentEvents();\n\t        var relatedView = this.relatedView;\n\t        var paper = relatedView.paper;\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var coords = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        relatedView.pointerup(normalizedEvent, coords.x, coords.y);\n\t        paper.delegateEvents();\n\t        this.blur();\n\t        this.el.style.pointerEvents = '';\n\t        relatedView.model.stopBatch('arrowhead-move', { ui: true, tool: this.cid });\n\t    }\n\t});\n\n\tvar TargetArrowhead = Arrowhead.extend({\n\t    name: 'target-arrowhead',\n\t    ratio: 1,\n\t    arrowheadType: 'target',\n\t    attributes: {\n\t        'd': 'M -10 -8 10 0 -10 8 Z',\n\t        'fill': '#33334F',\n\t        'stroke': '#FFFFFF',\n\t        'stroke-width': 2,\n\t        'cursor': 'move',\n\t        'class': 'target-arrowhead'\n\t    }\n\t});\n\n\tvar SourceArrowhead = Arrowhead.extend({\n\t    name: 'source-arrowhead',\n\t    ratio: 0,\n\t    arrowheadType: 'source',\n\t    attributes: {\n\t        'd': 'M 10 -8 -10 0 10 8 Z',\n\t        'fill': '#33334F',\n\t        'stroke': '#FFFFFF',\n\t        'stroke-width': 2,\n\t        'cursor': 'move',\n\t        'class': 'source-arrowhead'\n\t    }\n\t});\n\n\tvar Button = ToolView.extend({\n\t    name: 'button',\n\t    events: {\n\t        'mousedown': 'onPointerDown',\n\t        'touchstart': 'onPointerDown'\n\t    },\n\t    options: {\n\t        distance: 0,\n\t        offset: 0,\n\t        rotate: false\n\t    },\n\t    onRender: function() {\n\t        this.renderChildren(this.options.markup);\n\t        this.update();\n\t    },\n\t    update: function() {\n\t        this.position();\n\t        return this;\n\t    },\n\t    position: function() {\n\t        var ref = this;\n\t        var view = ref.relatedView;\n\t        var vel = ref.vel;\n\t        var matrix = view.model.isLink() ? this.getLinkMatrix() : this.getElementMatrix();\n\t        vel.transform(matrix, { absolute: true });\n\t    },\n\t    getElementMatrix: function getElementMatrix() {\n\t        var ref = this;\n\t        var view = ref.relatedView;\n\t        var options = ref.options;\n\t        var x = options.x; if ( x === void 0 ) x = 0;\n\t        var y = options.y; if ( y === void 0 ) y = 0;\n\t        var offset = options.offset; if ( offset === void 0 ) offset = {};\n\t        var useModelGeometry = options.useModelGeometry;\n\t        var rotate = options.rotate;\n\t        var bbox = getViewBBox(view, useModelGeometry);\n\t        var angle = view.model.angle();\n\t        if (!rotate) { bbox = bbox.bbox(angle); }\n\t        var offsetX = offset.x; if ( offsetX === void 0 ) offsetX = 0;\n\t        var offsetY = offset.y; if ( offsetY === void 0 ) offsetY = 0;\n\t        if (isPercentage(x)) {\n\t            x = parseFloat(x) / 100 * bbox.width;\n\t        }\n\t        if (isPercentage(y)) {\n\t            y = parseFloat(y) / 100 * bbox.height;\n\t        }\n\t        var matrix = V.createSVGMatrix().translate(bbox.x + bbox.width / 2, bbox.y + bbox.height / 2);\n\t        if (rotate) { matrix = matrix.rotate(angle); }\n\t        matrix = matrix.translate(x + offsetX - bbox.width / 2, y + offsetY - bbox.height / 2);\n\t        return matrix;\n\t    },\n\t    getLinkMatrix: function getLinkMatrix() {\n\t        var ref = this;\n\t        var view = ref.relatedView;\n\t        var options = ref.options;\n\t        var offset = options.offset; if ( offset === void 0 ) offset = 0;\n\t        var distance = options.distance; if ( distance === void 0 ) distance = 0;\n\t        var rotate = options.rotate;\n\t        var tangent, position, angle;\n\t        if (isPercentage(distance)) {\n\t            tangent = view.getTangentAtRatio(parseFloat(distance) / 100);\n\t        } else {\n\t            tangent = view.getTangentAtLength(distance);\n\t        }\n\t        if (tangent) {\n\t            position = tangent.start;\n\t            angle = tangent.vector().vectorAngle(new Point(1, 0)) || 0;\n\t        } else {\n\t            position = view.getConnection().start;\n\t            angle = 0;\n\t        }\n\t        var matrix = V.createSVGMatrix()\n\t            .translate(position.x, position.y)\n\t            .rotate(angle)\n\t            .translate(0, offset);\n\t        if (!rotate) { matrix = matrix.rotate(-angle); }\n\t        return matrix;\n\t    },\n\t    onPointerDown: function(evt) {\n\t        if (this.guard(evt)) { return; }\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        var actionFn = this.options.action;\n\t        if (typeof actionFn === 'function') {\n\t            actionFn.call(this.relatedView, evt, this.relatedView, this);\n\t        }\n\t    }\n\t});\n\n\n\tvar Remove = Button.extend({\n\t    children: [{\n\t        tagName: 'circle',\n\t        selector: 'button',\n\t        attributes: {\n\t            'r': 7,\n\t            'fill': '#FF1D00',\n\t            'cursor': 'pointer'\n\t        }\n\t    }, {\n\t        tagName: 'path',\n\t        selector: 'icon',\n\t        attributes: {\n\t            'd': 'M -3 -3 3 3 M -3 3 3 -3',\n\t            'fill': 'none',\n\t            'stroke': '#FFFFFF',\n\t            'stroke-width': 2,\n\t            'pointer-events': 'none'\n\t        }\n\t    }],\n\t    options: {\n\t        distance: 60,\n\t        offset: 0,\n\t        action: function(evt, view, tool) {\n\t            view.model.remove({ ui: true, tool: tool.cid });\n\t        }\n\t    }\n\t});\n\n\tvar Connect = Button.extend({\n\t    name: 'connect',\n\t    documentEvents: {\n\t        mousemove: 'drag',\n\t        touchmove: 'drag',\n\t        mouseup: 'dragend',\n\t        touchend: 'dragend',\n\t        touchcancel: 'dragend'\n\t    },\n\t    children: [{\n\t        tagName: 'circle',\n\t        selector: 'button',\n\t        attributes: {\n\t            'r': 7,\n\t            'fill': '#333333',\n\t            'cursor': 'pointer'\n\t        }\n\t    }, {\n\t        tagName: 'path',\n\t        selector: 'icon',\n\t        attributes: {\n\t            'd': 'M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z',\n\t            'fill': '#FFFFFF',\n\t            'stroke': 'none',\n\t            'stroke-width': 2,\n\t            'pointer-events': 'none'\n\t        }\n\t    }],\n\t    options: {\n\t        distance: 80,\n\t        offset: 0,\n\t        magnet: function (view) { return view.el; },\n\t        action: function (evt, _view, tool) { return tool.dragstart(evt); },\n\t    },\n\t    getMagnetNode: function() {\n\t        var assign;\n\n\t        var ref = this;\n\t        var options = ref.options;\n\t        var relatedView = ref.relatedView;\n\t        var magnet = options.magnet;\n\t        var magnetNode;\n\t        switch (typeof magnet) {\n\t            case 'function': {\n\t                magnetNode = magnet.call(this, relatedView, this);\n\t                break;\n\t            }\n\t            case 'string': {\n\t                (assign = relatedView.findBySelector(magnet), magnetNode = assign[0]);\n\t                break;\n\t            }\n\t            default: {\n\t                magnetNode = magnet;\n\t                break;\n\t            }\n\t        }\n\t        if (!magnetNode) { magnetNode = relatedView.el; }\n\t        if (magnetNode instanceof SVGElement) { return magnetNode; }\n\t        throw new Error('Connect: magnet must be an SVGElement');\n\t    },\n\t    dragstart: function(evt) {\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var relatedView = ref.relatedView;\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var ref$1 = paper.clientToLocalPoint(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        var x = ref$1.x;\n\t        var y = ref$1.y;\n\t        relatedView.dragLinkStart(normalizedEvent, this.getMagnetNode(), x, y);\n\t        paper.undelegateEvents();\n\t        this.delegateDocumentEvents(null, evt.data);\n\t        this.focus();\n\t    },\n\t    drag: function(evt) {\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var relatedView = ref.relatedView;\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var ref$1 = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        var x = ref$1.x;\n\t        var y = ref$1.y;\n\t        relatedView.dragLink(normalizedEvent, x, y);\n\t    },\n\t    dragend: function(evt) {\n\t        var ref = this;\n\t        var paper = ref.paper;\n\t        var relatedView = ref.relatedView;\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var ref$1 = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        var x = ref$1.x;\n\t        var y = ref$1.y;\n\t        relatedView.dragLinkEnd(normalizedEvent, x, y);\n\t        this.undelegateDocumentEvents();\n\t        paper.delegateEvents();\n\t        this.blur();\n\t        relatedView.checkMouseleave(normalizedEvent);\n\t    }\n\t});\n\n\n\tvar Boundary = ToolView.extend({\n\t    name: 'boundary',\n\t    tagName: 'rect',\n\t    options: {\n\t        padding: 10,\n\t        useModelGeometry: false,\n\t    },\n\t    attributes: {\n\t        'fill': 'none',\n\t        'stroke': '#33334F',\n\t        'stroke-width': .5,\n\t        'stroke-dasharray': '5, 5',\n\t        'pointer-events': 'none'\n\t    },\n\t    onRender: function() {\n\t        this.update();\n\t    },\n\t    update: function() {\n\t        var ref = this;\n\t        var view = ref.relatedView;\n\t        var options = ref.options;\n\t        var vel = ref.vel;\n\t        var useModelGeometry = options.useModelGeometry;\n\t        var rotate = options.rotate;\n\t        var padding = normalizeSides(options.padding);\n\t        var bbox = getViewBBox(view, useModelGeometry).moveAndExpand({\n\t            x: -padding.left,\n\t            y: -padding.top,\n\t            width: padding.left + padding.right,\n\t            height: padding.top + padding.bottom\n\t        });\n\t        var model = view.model;\n\t        if (model.isElement()) {\n\t            var angle = model.angle();\n\t            if (angle) {\n\t                if (rotate) {\n\t                    var origin = model.getBBox().center();\n\t                    vel.rotate(angle, origin.x, origin.y, { absolute: true });\n\t                } else {\n\t                    bbox = bbox.bbox(angle);\n\t                }\n\t            }\n\t        }\n\t        vel.attr(bbox.toJSON());\n\t        return this;\n\t    }\n\t});\n\n\tvar Anchor = ToolView.extend({\n\t    tagName: 'g',\n\t    type: null,\n\t    children: [{\n\t        tagName: 'circle',\n\t        selector: 'anchor',\n\t        attributes: {\n\t            'cursor': 'pointer'\n\t        }\n\t    }, {\n\t        tagName: 'rect',\n\t        selector: 'area',\n\t        attributes: {\n\t            'pointer-events': 'none',\n\t            'fill': 'none',\n\t            'stroke': '#33334F',\n\t            'stroke-dasharray': '2,4',\n\t            'rx': 5,\n\t            'ry': 5\n\t        }\n\t    }],\n\t    events: {\n\t        mousedown: 'onPointerDown',\n\t        touchstart: 'onPointerDown',\n\t        dblclick: 'onPointerDblClick',\n\t        dbltap: 'onPointerDblClick'\n\t    },\n\t    documentEvents: {\n\t        mousemove: 'onPointerMove',\n\t        touchmove: 'onPointerMove',\n\t        mouseup: 'onPointerUp',\n\t        touchend: 'onPointerUp',\n\t        touchcancel: 'onPointerUp'\n\t    },\n\t    options: {\n\t        snap: snapAnchor,\n\t        anchor: getAnchor,\n\t        resetAnchor: true,\n\t        customAnchorAttributes: {\n\t            'stroke-width': 4,\n\t            'stroke': '#33334F',\n\t            'fill': '#FFFFFF',\n\t            'r': 5\n\t        },\n\t        defaultAnchorAttributes: {\n\t            'stroke-width': 2,\n\t            'stroke': '#FFFFFF',\n\t            'fill': '#33334F',\n\t            'r': 6\n\t        },\n\t        areaPadding: 6,\n\t        snapRadius: 10,\n\t        restrictArea: true,\n\t        redundancyRemoval: true\n\t    },\n\t    onRender: function() {\n\t        this.renderChildren();\n\t        this.toggleArea(false);\n\t        this.update();\n\t    },\n\t    update: function() {\n\t        var type = this.type;\n\t        var relatedView = this.relatedView;\n\t        var view = relatedView.getEndView(type);\n\t        if (view) {\n\t            this.updateAnchor();\n\t            this.updateArea();\n\t            this.el.style.display = '';\n\t        } else {\n\t            this.el.style.display = 'none';\n\t        }\n\t        return this;\n\t    },\n\t    updateAnchor: function() {\n\t        var childNodes = this.childNodes;\n\t        if (!childNodes) { return; }\n\t        var anchorNode = childNodes.anchor;\n\t        if (!anchorNode) { return; }\n\t        var relatedView = this.relatedView;\n\t        var type = this.type;\n\t        var position = relatedView.getEndAnchor(type);\n\t        var options = this.options;\n\t        var customAnchor = relatedView.model.prop([type, 'anchor']);\n\t        anchorNode.setAttribute('transform', 'translate(' + position.x + ',' + position.y + ')');\n\t        var anchorAttributes = (customAnchor) ? options.customAnchorAttributes : options.defaultAnchorAttributes;\n\t        for (var attrName in anchorAttributes) {\n\t            anchorNode.setAttribute(attrName, anchorAttributes[attrName]);\n\t        }\n\t    },\n\t    updateArea: function() {\n\t        var childNodes = this.childNodes;\n\t        if (!childNodes) { return; }\n\t        var areaNode = childNodes.area;\n\t        if (!areaNode) { return; }\n\t        var relatedView = this.relatedView;\n\t        var type = this.type;\n\t        var view = relatedView.getEndView(type);\n\t        var model = view.model;\n\t        var magnet = relatedView.getEndMagnet(type);\n\t        var padding = this.options.areaPadding;\n\t        if (!isFinite(padding)) { padding = 0; }\n\t        var bbox, angle, center;\n\t        if (view.isNodeConnection(magnet)) {\n\t            bbox = view.getBBox();\n\t            angle = 0;\n\t            center = bbox.center();\n\t        } else {\n\t            bbox = view.getNodeUnrotatedBBox(magnet);\n\t            angle = model.angle();\n\t            center = bbox.center();\n\t            if (angle) { center.rotate(model.getBBox().center(), -angle); }\n\t            // TODO: get the link's magnet rotation into account\n\t        }\n\t        bbox.inflate(padding);\n\t        areaNode.setAttribute('x', -bbox.width / 2);\n\t        areaNode.setAttribute('y', -bbox.height / 2);\n\t        areaNode.setAttribute('width', bbox.width);\n\t        areaNode.setAttribute('height', bbox.height);\n\t        areaNode.setAttribute('transform', 'translate(' + center.x + ',' + center.y + ') rotate(' + angle + ')');\n\t    },\n\t    toggleArea: function(visible) {\n\t        this.childNodes.area.style.display = (visible) ? '' : 'none';\n\t    },\n\t    onPointerDown: function(evt) {\n\t        if (this.guard(evt)) { return; }\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        this.paper.undelegateEvents();\n\t        this.delegateDocumentEvents();\n\t        this.focus();\n\t        this.toggleArea(this.options.restrictArea);\n\t        this.relatedView.model.startBatch('anchor-move', { ui: true, tool: this.cid });\n\t    },\n\t    resetAnchor: function(anchor) {\n\t        var type = this.type;\n\t        var relatedModel = this.relatedView.model;\n\t        if (anchor) {\n\t            relatedModel.prop([type, 'anchor'], anchor, {\n\t                rewrite: true,\n\t                ui: true,\n\t                tool: this.cid\n\t            });\n\t        } else {\n\t            relatedModel.removeProp([type, 'anchor'], {\n\t                ui: true,\n\t                tool: this.cid\n\t            });\n\t        }\n\t    },\n\t    onPointerMove: function(evt) {\n\n\t        var relatedView = this.relatedView;\n\t        var type = this.type;\n\t        var view = relatedView.getEndView(type);\n\t        var model = view.model;\n\t        var magnet = relatedView.getEndMagnet(type);\n\t        var normalizedEvent = normalizeEvent(evt);\n\t        var coords = this.paper.clientToLocalPoint(normalizedEvent.clientX, normalizedEvent.clientY);\n\t        var snapFn = this.options.snap;\n\t        if (typeof snapFn === 'function') {\n\t            coords = snapFn.call(relatedView, coords, view, magnet, type, relatedView, this);\n\t            coords = new Point(coords);\n\t        }\n\n\t        if (this.options.restrictArea) {\n\t            if (view.isNodeConnection(magnet)) {\n\t                // snap coords to the link's connection\n\t                var pointAtConnection = view.getClosestPoint(coords);\n\t                if (pointAtConnection) { coords = pointAtConnection; }\n\t            } else {\n\t                // snap coords within node bbox\n\t                var bbox = view.getNodeUnrotatedBBox(magnet);\n\t                var angle = model.angle();\n\t                var origin = model.getBBox().center();\n\t                var rotatedCoords = coords.clone().rotate(origin, angle);\n\t                if (!bbox.containsPoint(rotatedCoords)) {\n\t                    coords = bbox.pointNearestToPoint(rotatedCoords).rotate(origin, -angle);\n\t                }\n\t            }\n\t        }\n\n\t        var anchor;\n\t        var anchorFn = this.options.anchor;\n\t        if (typeof anchorFn === 'function') {\n\t            anchor = anchorFn.call(relatedView, coords, view, magnet, type, relatedView);\n\t        }\n\n\t        this.resetAnchor(anchor);\n\t        this.update();\n\t    },\n\n\t    onPointerUp: function(evt) {\n\t        this.paper.delegateEvents();\n\t        this.undelegateDocumentEvents();\n\t        this.blur();\n\t        this.toggleArea(false);\n\t        var linkView = this.relatedView;\n\t        if (this.options.redundancyRemoval) { linkView.removeRedundantLinearVertices({ ui: true, tool: this.cid }); }\n\t        linkView.model.stopBatch('anchor-move', { ui: true, tool: this.cid });\n\t    },\n\n\t    onPointerDblClick: function() {\n\t        var anchor = this.options.resetAnchor;\n\t        if (anchor === false) { return; } // reset anchor disabled\n\t        if (anchor === true) { anchor = null; } // remove the current anchor\n\t        this.resetAnchor(cloneDeep(anchor));\n\t        this.update();\n\t    }\n\t});\n\n\tvar SourceAnchor = Anchor.extend({\n\t    name: 'source-anchor',\n\t    type: 'source'\n\t});\n\n\tvar TargetAnchor = Anchor.extend({\n\t    name: 'target-anchor',\n\t    type: 'target'\n\t});\n\n\tvar index$5 = ({\n\t\tVertices: Vertices,\n\t\tSegments: Segments,\n\t\tSourceArrowhead: SourceArrowhead,\n\t\tTargetArrowhead: TargetArrowhead,\n\t\tSourceAnchor: SourceAnchor,\n\t\tTargetAnchor: TargetAnchor,\n\t\tButton: Button,\n\t\tRemove: Remove,\n\t\tConnect: Connect,\n\t\tBoundary: Boundary\n\t});\n\n\tvar Control = ToolView.extend({\n\t    tagName: 'g',\n\t    children: [{\n\t        tagName: 'circle',\n\t        selector: 'handle',\n\t        attributes: {\n\t            'cursor': 'pointer',\n\t            'stroke-width': 2,\n\t            'stroke': '#FFFFFF',\n\t            'fill': '#33334F',\n\t            'r': 6\n\t        }\n\t    }, {\n\t        tagName: 'rect',\n\t        selector: 'extras',\n\t        attributes: {\n\t            'pointer-events': 'none',\n\t            'fill': 'none',\n\t            'stroke': '#33334F',\n\t            'stroke-dasharray': '2,4',\n\t            'rx': 5,\n\t            'ry': 5\n\t        }\n\t    }],\n\t    events: {\n\t        mousedown: 'onPointerDown',\n\t        touchstart: 'onPointerDown',\n\t        dblclick: 'onPointerDblClick',\n\t        dbltap: 'onPointerDblClick'\n\t    },\n\t    documentEvents: {\n\t        mousemove: 'onPointerMove',\n\t        touchmove: 'onPointerMove',\n\t        mouseup: 'onPointerUp',\n\t        touchend: 'onPointerUp',\n\t        touchcancel: 'onPointerUp'\n\t    },\n\t    options: {\n\t        handleAttributes: null,\n\t        selector: 'root',\n\t        padding: 6,\n\t    },\n\n\t    getPosition: function() {\n\t        // To be overridden\n\t    },\n\t    setPosition: function() {\n\t        // To be overridden\n\t    },\n\t    resetPosition: function() {\n\t        // To be overridden\n\t    },\n\t    onRender: function() {\n\t        this.renderChildren();\n\t        this.toggleExtras(false);\n\t        this.update();\n\t    },\n\t    update: function() {\n\t        var ref = this.childNodes;\n\t        var handle = ref.handle;\n\t        var extras = ref.extras;\n\t        if (handle) {\n\t            this.updateHandle(handle);\n\t        } else {\n\t            throw new Error('Control: markup selector `handle` is required');\n\t        }\n\t        if (extras) {\n\t            this.updateExtras(extras);\n\t        }\n\t        return this;\n\t    },\n\t    updateHandle: function(handleNode) {\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        var options = ref.options;\n\t        var model = relatedView.model;\n\t        var relativePos = this.getPosition(relatedView, this);\n\t        var absolutePos = model.getAbsolutePointFromRelative(relativePos);\n\t        handleNode.setAttribute('transform', (\"translate(\" + (absolutePos.x) + \",\" + (absolutePos.y) + \")\"));\n\t        var handleAttributes = options.handleAttributes;\n\t        if (handleAttributes) {\n\t            for (var attrName in handleAttributes) {\n\t                handleNode.setAttribute(attrName, handleAttributes[attrName]);\n\t            }\n\t        }\n\t    },\n\t    updateExtras: function(extrasNode) {\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        var options = ref.options;\n\t        var ref$1 = this.options;\n\t        var selector = ref$1.selector;\n\t        if (!selector) {\n\t            this.toggleExtras(false);\n\t            return;\n\t        }\n\t        var ref$2 = relatedView.findBySelector(selector);\n\t        var magnet = ref$2[0];\n\t        if (!magnet) { throw new Error('Control: invalid selector.'); }\n\t        var padding = options.padding;\n\t        if (!isFinite(padding)) { padding = 0; }\n\t        var bbox = relatedView.getNodeUnrotatedBBox(magnet);\n\t        var model = relatedView.model;\n\t        var angle = model.angle();\n\t        var center = bbox.center();\n\t        if (angle) { center.rotate(model.getBBox().center(), -angle); }\n\t        bbox.inflate(padding);\n\t        extrasNode.setAttribute('x', -bbox.width / 2);\n\t        extrasNode.setAttribute('y', -bbox.height / 2);\n\t        extrasNode.setAttribute('width', bbox.width);\n\t        extrasNode.setAttribute('height', bbox.height);\n\t        extrasNode.setAttribute('transform', (\"translate(\" + (center.x) + \",\" + (center.y) + \") rotate(\" + angle + \")\"));\n\t    },\n\t    toggleExtras: function(visible) {\n\t        var ref = this.childNodes;\n\t        var extras = ref.extras;\n\t        if (!extras) { return; }\n\t        extras.style.display = (visible) ? '' : 'none';\n\t    },\n\t    onPointerDown: function(evt) {\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        var paper = ref.paper;\n\t        if (this.guard(evt)) { return; }\n\t        evt.stopPropagation();\n\t        evt.preventDefault();\n\t        paper.undelegateEvents();\n\t        this.delegateDocumentEvents();\n\t        this.focus();\n\t        this.toggleExtras(true);\n\t        relatedView.model.startBatch('control-move', { ui: true, tool: this.cid });\n\t    },\n\t    onPointerMove: function(evt) {\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        var paper = ref.paper;\n\t        var model = relatedView.model;\n\t        var ref$1 = normalizeEvent(evt);\n\t        var clientX = ref$1.clientX;\n\t        var clientY = ref$1.clientY;\n\t        var coords = paper.clientToLocalPoint(clientX, clientY);\n\t        var relativeCoords = model.getRelativePointFromAbsolute(coords);\n\t        this.setPosition(relatedView, relativeCoords, this);\n\t        this.update();\n\t    },\n\t    onPointerUp: function(_evt) {\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        var paper = ref.paper;\n\t        paper.delegateEvents();\n\t        this.undelegateDocumentEvents();\n\t        this.blur();\n\t        this.toggleExtras(false);\n\t        relatedView.model.stopBatch('control-move', { ui: true, tool: this.cid });\n\t    },\n\t    onPointerDblClick: function() {\n\t        var ref = this;\n\t        var relatedView = ref.relatedView;\n\t        this.resetPosition(relatedView, this);\n\t        this.update();\n\t    }\n\n\t});\n\n\n\n\tvar index$6 = ({\n\t\tButton: Button,\n\t\tRemove: Remove,\n\t\tConnect: Connect,\n\t\tBoundary: Boundary,\n\t\tControl: Control\n\t});\n\n\tvar version = \"3.5.5\";\n\n\tvar Vectorizer = V;\n\tvar layout = { PortLabel: PortLabel, Port: Port };\n\tvar setTheme = function(theme, opt) {\n\n\t    opt = opt || {};\n\n\t    invoke(views, 'setTheme', theme, opt);\n\n\t    // Update the default theme on the view prototype.\n\t    View.prototype.defaultTheme = theme;\n\t};\n\n\tvar layout$1 = { DirectedGraph: DirectedGraph, PortLabel: PortLabel, Port: Port };\n\n\t// export empty namespaces - backward compatibility\n\tvar format$1 = {};\n\tvar ui = {};\n\n\texports.V = V;\n\texports.Vectorizer = Vectorizer;\n\texports.anchors = anchors;\n\texports.config = config;\n\texports.connectionPoints = connectionPoints;\n\texports.connectionStrategies = index$4;\n\texports.connectors = connectors;\n\texports.dia = index$2;\n\texports.elementTools = index$6;\n\texports.env = env;\n\texports.format = format$1;\n\texports.g = g;\n\texports.highlighters = highlighters;\n\texports.layout = layout$1;\n\texports.linkAnchors = linkAnchors;\n\texports.linkTools = index$5;\n\texports.mvc = index$1;\n\texports.routers = routers;\n\texports.setTheme = setTheme;\n\texports.shapes = index$3;\n\texports.ui = ui;\n\texports.util = index;\n\texports.version = version;\n\n\tObject.defineProperty(exports, '__esModule', { value: true });\n\n}));\nif (typeof joint !== 'undefined') { var g = joint.g, V = joint.V, Vectorizer = joint.V; }\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}