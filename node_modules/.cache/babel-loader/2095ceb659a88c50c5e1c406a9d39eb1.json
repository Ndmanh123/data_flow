{"ast":null,"code":"import '@/../public/vendor/node_modules/jquery/dist/jquery.js';\nimport '@/../public/vendor/js/lib/jquery.min.js';\nimport '@/../public/vendor/js/lib/lodash.min.js';\nimport '@/../public/vendor/js/lib/backbone.min.js';\nimport '@/../public/vendor/js/lib/rappid.min.js';\nimport '@/../public/vendor/node_modules/lodash/lodash.js';\nimport '@/../public/vendor/node_modules/backbone/backbone.js';\nimport '@/../public/vendor/build/package/rappid.js'; // import { Options, Vue } from 'vue-class-component';\n\nexport default {\n  mounted() {\n    var highlighters = joint.highlighters;\n    let selectionNode = null;\n    let selectedElement = null;\n    let selectedLink = null; //check ctrl shift\n\n    var ctrlDown = false;\n    var shiftDown = false;\n    const color = \"rgb(255 136 0)\";\n    var customEl = joint.dia.Element.define('standard.Rectangle', {\n      z: 1,\n      size: {\n        width: 44,\n        height: 35\n      },\n      removable: false,\n      attrs: {\n        image: {\n          x: 5,\n          y: 5,\n          width: 'calc(w-10)',\n          height: 'calc(h-10 )'\n        },\n        root: {\n          magnet: false\n        },\n        body: {\n          fill: '#FFFFFF',\n          stroke: '#A0A0A0',\n          width: 'calc(w)',\n          height: 'calc(h)',\n          strokeWidth: 2,\n          rx: 5,\n          ry: 5\n        }\n      },\n      ports: {\n        items: [{\n          id: 'out-port',\n          group: 'out'\n        }, {\n          id: 'in-port',\n          group: 'in'\n        }],\n        groups: {\n          out: {\n            markup: [{\n              tagName: 'circle',\n              selector: 'portBody'\n            }],\n            position: {\n              name: 'right'\n            },\n            attrs: {\n              portBody: {\n                r: 5,\n                magnet: 'active',\n                fill: '#187BD3',\n                stroke: '#187BD3'\n              }\n            }\n          },\n          in: {\n            markup: [{\n              tagName: 'circle',\n              selector: 'portBody'\n            }],\n            position: {\n              name: 'left'\n            },\n            attrs: {\n              portBody: {\n                r: 5,\n                magnet: 'passive',\n                fill: '#FFFFFF',\n                stroke: '#187BD3'\n              }\n            }\n          }\n        }\n      },\n      markup: [{\n        tagName: 'rect',\n        selector: 'body'\n      }, {\n        tagName: 'image',\n        selector: 'image'\n      }, {\n        tagName: 'ports',\n        selector: 'ports'\n      }]\n    });\n    var customElNoInPorts = joint.dia.Element.define('standard.Rectangle', {\n      z: 1,\n      theme: 'material',\n      size: {\n        width: 44,\n        height: 35\n      },\n      removable: false,\n      attrs: {\n        image: {\n          x: 5,\n          y: 5,\n          width: 'calc(w-10)',\n          height: 'calc(h-10 )'\n        },\n        root: {\n          magnet: false\n        },\n        body: {\n          fill: '#FFFFFF',\n          stroke: '#A0A0A0',\n          width: 'calc(w)',\n          height: 'calc(h)',\n          strokeWidth: 2\n        },\n        line: {\n          connection: true,\n          stroke: '#333333',\n          strokeWidth: 2,\n          strokeLinejoin: 'round',\n          targetMarker: {\n            'type': 'path',\n            'd': 'M 10 -5 0 0 10 5 z'\n          }\n        }\n      },\n      ports: {\n        items: [{\n          id: 'out-port',\n          group: 'out'\n        }],\n        groups: {\n          out: {\n            markup: [{\n              tagName: 'circle',\n              selector: 'portBody'\n            }],\n            position: {\n              name: 'right'\n            },\n            attrs: {\n              portBody: {\n                r: 5,\n                magnet: 'active',\n                fill: '#187BD3',\n                stroke: '#187BD3'\n              }\n            }\n          }\n        }\n      },\n      markup: [{\n        tagName: 'rect',\n        selector: 'body'\n      }, {\n        tagName: 'image',\n        selector: 'image'\n      }, {\n        tagName: 'ports',\n        selector: 'ports'\n      }]\n    });\n    var targetArrowheadTool = new joint.linkTools.TargetArrowhead();\n    var toolsView = new joint.dia.ToolsView({\n      tools: [targetArrowheadTool]\n    });\n    var CustomLinkView = joint.dia.LinkView.extend({\n      // custom interactions:\n      pointerdblclick: function (evt, x, y) {\n        this.addVertex(x, y);\n      },\n      contextmenu: function (evt, x, y) {\n        this.addLabel(x, y);\n      },\n      // custom options:\n      options: joint.util.defaults({\n        doubleLinkTools: true\n      }, joint.dia.LinkView.prototype.options)\n    });\n    var graph = new joint.dia.Graph(); //ctrl+z\n\n    var commandManager = new joint.dia.CommandManager({\n      graph: graph\n    }); //cấu hình paper\n\n    var paper = new joint.dia.Paper({\n      el: $('#paper'),\n      width: 800,\n      height: 600,\n      model: graph,\n      async: true,\n      sorting: joint.dia.Paper.sorting.APPROX,\n      gridSize: 10,\n      drawGrid: true,\n      restrictTranslate: true,\n      stopDelegation: false,\n      linkView: CustomLinkView,\n      interactive: {\n        vertexAdd: false\n      },\n      // background: { color: '#F3F7F6' },\n      // defaultConnectionPoint: { name: 'boundary' },\n      // defaultConnector: {\n      //     name: \"rounded\"\n      //   },\n      //   defaultRouter: {\n      //     name: \"manhattan\",\n      //     args: {\n      //       step: 10,\n      //       endDirections: [\"bottom\"],\n      //       startDirections: [\"top\"],\n      //       padding: { bottom: 20 }\n      //     }\n      //   },\n      snapLinks: {\n        radius: 75\n      },\n      linkPinning: false,\n      multiLinks: false,\n      defaultRouter: {\n        name: 'manhattan',\n        args: {\n          padding: 10\n        }\n      },\n      defaultConnector: {\n        name: 'rounded'\n      },\n      validateConnection: function (cellViewS, magnetS, cellViewT, magnetT, end, linkView) {\n        // Prevent linking from input ports.\n        if (magnetS && magnetS.getAttribute('port-group') === 'in') return false; // Prevent linking from output ports to input ports within one element.\n\n        if (cellViewS === cellViewT) return false; // Prevent linking to input ports.\n\n        return magnetT && magnetT.getAttribute('port-group') === 'in' || cellViewS.model.get('type') === 'qad.Question' && cellViewT.model.get('type') === 'qad.Answer';\n      },\n      // validateConnection: function (view1, _magnet1, view2, _magnet2) {\n      //     // Do not allow loop links (Element to Link, Element A to Element B is valid).\n      //     return view1 !== view2;\n      // },\n      interactive: {\n        linkMove: true,\n        labelMove: true,\n        arrowheadMove: true,\n        vertexMove: false,\n        vertexAdd: false,\n        vertexRemove: false,\n        useLinkTools: false\n      },\n      defaultLink: function () {\n        return new joint.shapes.standard.Link({\n          attrs: {\n            line: {\n              connection: true,\n              stroke: '#707070',\n              strokeLinejoin: 'round'\n            },\n            wrapper: {\n              connection: true,\n              strokeWidth: 10,\n              strokeLinejoin: 'round'\n            }\n          },\n          markup: [{\n            tagName: 'path',\n            selector: 'wrapper',\n            attributes: {\n              'fill': 'none',\n              'stroke': 'transparent'\n            }\n          }, {\n            tagName: 'path',\n            selector: 'line',\n            attributes: {\n              'fill': 'none'\n            }\n          }]\n        });\n      }\n    }); //paperScroller\n\n    var paperScroller = new joint.ui.PaperScroller({\n      paper: paper,\n      autoResizePaper: true,\n      scrollWhileDragging: true,\n      cursor: 'grab'\n    }); // cấu hình snaplines\n\n    var snaplines = new joint.ui.Snaplines({\n      paper: paper\n    });\n    snaplines.startListening(); // cấu hình Stencil \n\n    var stencil = new joint.ui.Stencil({\n      paper: paperScroller,\n      width: 900,\n      height: 60,\n      dropAnimation: {\n        duration: 200,\n        easing: 'swing'\n      }\n    }); // cấu hình Selection\n\n    var selection = new joint.ui.Selection({\n      theme: 'material',\n      paper: paper,\n      useModelGeometry: true,\n      allowTranslate: true\n    }); //hàm viết hoa chữ đầu\n\n    function jsUcfirst(string) {\n      return string.charAt(0).toUpperCase() + string.slice(1);\n    } //hàm render stencil\n\n\n    function stencilRenderHandler(positionX, positionY, arr, elNoInPorts = \"\", spaceBetweenElToX = 0, spaceBetweenElToY = 0) {\n      arr.forEach(element => {\n        //chuyển thành hoa chữ đầu cho đúng định dạng file ảnh lưu\n        let elementName = jsUcfirst(element);\n\n        if (elementName === jsUcfirst(elNoInPorts)) {\n          element = new customElNoInPorts();\n        } else {\n          element = new customEl();\n        }\n\n        element.prop('attrs/image/xlinkHref', `./assets/${elementName}.svg`);\n        stencilShapes.push(element.position(positionX, positionY));\n\n        if (spaceBetweenElToX > 0) {\n          positionX += element.attributes.size.width + spaceBetweenElToX;\n        }\n\n        if (spaceBetweenElToY > 0) {\n          positionY += element.attributes.size.height + spaceBetweenElToY;\n        }\n      });\n    }\n\n    var arr = ['filter', 'formula', 'join', 'load', 'pivot', 'sample', 'script', 'select', 'sort', 'summarize', 'transposeTable', 'union', 'weightAvg']; //mảng chứa các vị trí của stencil Shape để sau đó render\n\n    var stencilShapes = [];\n    stencilRenderHandler(20, 20, arr, \"load\", 16);\n    paper.svg.prepend(V.createSVGStyle(`\n            .joint-element .selection {\n                stroke: ${color};\n            }\n            .joint-link .selection {\n                stroke: ${color}; \n                'fill': ${color},\n            }\n            \n        `)); //lấy tất cả link ở trc node\n\n    function getElementPredecessorLinks(el) {\n      return graph.getSubgraph([el, ...graph.getPredecessors(el)]).filter(cell => cell.isLink());\n    } //đổi màu cell\n\n\n    function highlightCell(cell) {\n      if (cell) {\n        highlighters.addClass.add(cell.findView(paper), cell.isElement() ? \"body\" : \"line\", \"selection\", {\n          className: \"selection\"\n        });\n      } else {\n        return;\n      }\n    } //chuyển màu cell lại như cũ\n\n\n    function unhighlightCell(cell) {\n      if (cell) {\n        highlighters.addClass.remove(cell.findView(paper), \"selection\");\n      } else {\n        return;\n      }\n    } //function xử lý hành dộng chọn el\n\n\n    function selectElement(el) {\n      if (selectionNode === el) return;\n\n      if (selectionNode) {\n        unhighlightCell(selectionNode);\n        graph.getLinks().forEach(link => unhighlightCell(link));\n      }\n\n      if (el) {\n        highlightCell(el);\n        getElementPredecessorLinks(el).forEach(link => {\n          highlightCell(link);\n          link.toFront();\n        });\n        selectionNode = el;\n      } else {\n        selectionNode = null;\n      }\n    } //halo cấu hình\n\n\n    paper.on('cell:pointerup', function (cellView) {\n      var halo = new joint.ui.Halo({\n        cellView: cellView,\n        type: 'toolbar',\n        boxContent: false // bang phia duoi cell cho biet tọa độ height width và angle\n\n      });\n      halo.removeHandle('resize');\n      halo.removeHandle('rotate');\n      halo.removeHandle('direction');\n      halo.render(); //cho cell đang chọn lên trc và gán cho selectedEl để chạy những chức năng tiếp theo\n\n      selectedElement = cellView.model;\n      selectedElement.toFront(); // console.log(graph.getLinks())\n    }); //xử lý khi các sự kiện với paper\n\n    paper.on({\n      //xử lý khi các sự kiện \n      \"cell:mouseenter\": cellView => {\n        cellView.model.toFront();\n      },\n      \"cell:mouseleave\": cellView => {\n        cellView.model.toBack();\n\n        if (selectionNode) {\n          getElementPredecessorLinks(selectionNode).forEach(link => {\n            link.toFront();\n          });\n        }\n      },\n      \"element:pointerclick\": cellView => {\n        //chỉ đổi màu khi ko bấm ctrl\n        if (ctrlDown === false) {\n          selectElement(cellView.model);\n        }\n      },\n      \"link:pointerclick\": cellView => {\n        selectElement(cellView.model); //chon vao link thi mo cho phep doi node\n\n        cellView.addTools(toolsView);\n      },\n      //chuyển lại màu cũ khi bấm ra ngoài\n      \"blank:pointerclick\": () => {\n        selectElement(null);\n        paper.removeTools();\n      },\n      'element:pointerup': function (cellView, evt) {\n        if (evt.ctrlKey || evt.metaKey) {\n          selection.collection.add(cellView.model); //loop to all the element in selection and set it to front\n\n          selection.collection.models.forEach(element => {\n            element.toFront();\n          });\n        }\n      },\n      //chuyển màu khi bấm vào link và cho nó lên trc\n      'link:pointerup': function (cellView) {\n        selectedLink = cellView.model;\n        selectedLink.toFront();\n      },\n      // lắng nghe sự kiện bấm ở ngoài khoange trống check shift để active select\n      'blank:pointerdown': function (evt, x, y) {\n        if (shiftDown === true) {\n          selectElement(null);\n          paperScroller.setCursor('crosshair');\n          selection.startSelecting(evt);\n          console.log(selection);\n        } else {\n          selection.collection.reset([]);\n          paperScroller.startPanning(evt, x, y);\n          paper.removeTools();\n          paperScroller.setCursor('grab');\n        }\n      }\n    }); //xóa el nếu chọn lại lần 2 khi bấm ctrl\n\n    selection.on('selection-box:pointerdown', function (cellView, evt) {\n      if (evt.ctrlKey || evt.metaKey) {\n        selection.collection.remove(cellView.model);\n      }\n    }); //xóa bằng nút delete\n\n    document.addEventListener('keyup', function (evt) {\n      if (!selectedElement && !selection) return;\n\n      if (evt.code === 'Backspace' || evt.code === 'Delete') {\n        //xóa 1 el\n        if (selectedElement) {\n          selectedElement.remove();\n          selectedElement = null;\n          selectionNode = null;\n        } //xóa toàn bộ  el đã chọn\n\n\n        if (selection) {\n          // chuyeent selection.collection thành mảng hảm remove cell nhận vào 1 mảng và xóa khỏi graph\n          evt.preventDefault();\n          graph.removeCells(selection.collection.toArray());\n          selectionNode = null;\n        }\n      }\n    }); //nếu bấm thì =true\n\n    document.addEventListener('keydown', function (evt) {\n      if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\n        ctrlDown = true;\n      }\n\n      if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\n        shiftDown = true;\n      }\n    }); //nếu thả nút thì =false\n\n    document.addEventListener('keyup', function (evt) {\n      if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\n        shiftDown = false;\n      }\n\n      if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\n        ctrlDown = false;\n      }\n    }); //kết hợp bấm ctrl để check các tổ hợp phím ctrl + C,V,Z,Y,A...\n\n    document.addEventListener('keydown', function (evt) {\n      var clipboard = new joint.ui.Clipboard();\n\n      if (evt.code === \"NumpadAdd\" && shiftDown === true) {\n        console.log(evt.code);\n        paperScroller.zoom(0.2, {\n          max: 4\n        });\n      }\n\n      if (evt.code === \"NumpadSubtract\" && shiftDown === true) {\n        paperScroller.zoom(-0.2, {\n          min: 0.2\n        });\n        console.log(evt.code);\n      } //check+ A\n\n\n      if (evt.code === \"KeyA\" && ctrlDown === true) {\n        selection.collection.reset(graph.getElements());\n        evt.preventDefault();\n      } //check ctrl + Z\n\n\n      if (evt.code === \"KeyZ\" && ctrlDown === true) {\n        commandManager.undo();\n        unhighlightCell(selectionNode);\n        graph.getLinks().forEach(link => unhighlightCell(link));\n        console.log(selectionNode);\n        selectionNode = null;\n      } //check ctrl + Y\n\n\n      if (evt.code === \"KeyY\" && ctrlDown === true) {\n        commandManager.redo();\n        selectElement(null);\n      } //check ctrl + V ,ctrl + C, ctrl+X\n\n\n      if (evt.code === \"KeyX\" && ctrlDown === true) {\n        clipboard.cutElements(selection.collection, paper.model);\n      }\n\n      if (evt.code === \"KeyC\" && ctrlDown === true) {\n        clipboard.copyElements(selection.collection, graph);\n      }\n\n      if (evt.code === \"KeyV\" && ctrlDown === true) {\n        var pastedCells = clipboard.pasteCells(graph, {\n          translate: {\n            dx: 40,\n            dy: 40\n          },\n          useLocalStorage: true\n        });\n\n        var elements = _.filter(pastedCells, function (cell) {\n          return cell.isElement();\n        }); // Make sure pasted elements get selected immediately. This makes the UX better as\n        // the user can immediately manipulate the pasted elements.\n\n\n        selection.collection.reset(elements);\n      }\n    }); // nut zoomin zoom out can chuyen ve scroll\n\n    $('#btn-zoomin').on('click', function () {\n      paperScroller.zoom(0.2, {\n        max: 4\n      });\n    });\n    $('#btn-zoomout').on('click', function () {\n      paperScroller.zoom(-0.2, {\n        min: 0.2\n      });\n    });\n    $('#btn-center').on('click', _.bind(paperScroller.center, paperScroller));\n    $('#btn-center-content').on('click', _.bind(paperScroller.centerContent, paperScroller)); //render paper\n\n    document.getElementById('paper').appendChild(paperScroller.render().el); //render paperScroller\n\n    paperScroller.$el.css({\n      width: 900,\n      height: 600\n    }).appendTo('#paper');\n    paperScroller.center(); //render stencil ra màn hình\n\n    document.getElementById('stencil').appendChild(stencil.render().el);\n    stencil.load(stencilShapes);\n    selection.collection.reset(graph.getElements()); //  var linkView = paper.findViewByModel(link);\n  }\n\n};","map":{"version":3,"mappings":"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","names":["mounted","highlighters","joint","selectionNode","selectedElement","selectedLink","ctrlDown","shiftDown","color","customEl","dia","Element","define","z","size","width","height","removable","attrs","image","x","y","root","magnet","body","fill","stroke","strokeWidth","rx","ry","ports","items","id","group","groups","out","markup","tagName","selector","position","name","portBody","r","in","customElNoInPorts","theme","line","connection","strokeLinejoin","targetMarker","targetArrowheadTool","linkTools","TargetArrowhead","toolsView","ToolsView","tools","CustomLinkView","LinkView","extend","pointerdblclick","evt","addVertex","contextmenu","addLabel","options","util","defaults","doubleLinkTools","prototype","graph","Graph","commandManager","CommandManager","paper","Paper","el","$","model","async","sorting","APPROX","gridSize","drawGrid","restrictTranslate","stopDelegation","linkView","interactive","vertexAdd","snapLinks","radius","linkPinning","multiLinks","defaultRouter","args","padding","defaultConnector","validateConnection","cellViewS","magnetS","cellViewT","magnetT","end","getAttribute","get","linkMove","labelMove","arrowheadMove","vertexMove","vertexRemove","useLinkTools","defaultLink","shapes","standard","Link","wrapper","attributes","paperScroller","ui","PaperScroller","autoResizePaper","scrollWhileDragging","cursor","snaplines","Snaplines","startListening","stencil","Stencil","dropAnimation","duration","easing","selection","Selection","useModelGeometry","allowTranslate","jsUcfirst","string","charAt","toUpperCase","slice","stencilRenderHandler","positionX","positionY","arr","elNoInPorts","spaceBetweenElToX","spaceBetweenElToY","forEach","element","elementName","prop","stencilShapes","push","svg","prepend","V","createSVGStyle","getElementPredecessorLinks","getSubgraph","getPredecessors","filter","cell","isLink","highlightCell","addClass","add","findView","isElement","className","unhighlightCell","remove","selectElement","getLinks","link","toFront","on","cellView","halo","Halo","type","boxContent","removeHandle","render","toBack","addTools","removeTools","ctrlKey","metaKey","collection","models","setCursor","startSelecting","console","log","reset","startPanning","document","addEventListener","code","preventDefault","removeCells","toArray","clipboard","Clipboard","zoom","max","min","getElements","undo","redo","cutElements","copyElements","pastedCells","pasteCells","translate","dx","dy","useLocalStorage","elements","_","bind","center","centerContent","getElementById","appendChild","$el","css","appendTo","load"],"sourceRoot":"","sources":["C:\\Users\\Admin\\dataflow-test\\src\\App.vue"],"sourcesContent":["<template>\n  <div class=\"canvas\" ref=\"canvas\"></div>\n  <div id=\"app\">\n    <div class=\"btn_contain\">\n        <button id=\"btn-zoomout\" class=\"btn\">zoom out</button>\n        <button id=\"btn-zoomin\" class=\"btn\">zoom in</button>\n        <button id=\"btn-center\" class=\"btn\">center</button>\n        <button id=\"btn-center-content\" class=\"btn\">center content</button>\n    </div>\n    <div id=\"stencil\"></div>\n    \n    <div id=\"paper\"></div>\n    <div id=\"navigator\"></div>\n    \n    \n        </div>\n</template>\n\n<script>\nimport '@/../public/vendor/node_modules/jquery/dist/jquery.js'\nimport '@/../public/vendor/js/lib/jquery.min.js'\nimport '@/../public/vendor/js/lib/lodash.min.js'\nimport '@/../public/vendor/js/lib/backbone.min.js'\nimport '@/../public/vendor/js/lib/rappid.min.js'\nimport '@/../public/vendor/node_modules/lodash/lodash.js'\nimport '@/../public/vendor/node_modules/backbone/backbone.js'\nimport '@/../public/vendor/build/package/rappid.js'\n// import { Options, Vue } from 'vue-class-component';\nexport default {\n  mounted() {\n    var highlighters=joint.highlighters;\n    \n    let selectionNode = null;\n    let selectedElement = null;\n    let selectedLink = null\n    //check ctrl shift\n    var ctrlDown = false;\n    var shiftDown = false;\n    const color = \"rgb(255 136 0)\";\n    var customEl = joint.dia.Element.define('standard.Rectangle', {\n        z: 1,\n        size: {\n            width: 44,\n            height: 35\n        },\n        removable: false,\n        attrs: {\n            image: {\n                x: 5,\n                y: 5,\n                width: 'calc(w-10)',\n                height: 'calc(h-10 )'\n            },\n            root: {\n                magnet: false\n            },\n            body: {\n                fill: '#FFFFFF',\n                stroke: '#A0A0A0',\n                width: 'calc(w)',\n                height: 'calc(h)',\n                strokeWidth: 2,\n                rx: 5,\n                ry: 5,\n\n            }\n        },\n        ports: {\n            items: [{\n                id: 'out-port',\n                group: 'out',\n\n            },\n            {\n                id: 'in-port',\n                group: 'in'\n            }\n            ],\n            groups: {\n                out: {\n                    markup: [{\n                        tagName: 'circle',\n                        selector: 'portBody'\n                    }],\n                    position: {\n                        name: 'right'\n                    },\n                    attrs: {\n                        portBody: {\n                            r: 5,\n                            magnet: 'active',\n                            fill: '#187BD3',\n                            stroke: '#187BD3'\n\n                        }\n                    }\n                },\n                in: {\n                    markup: [{\n                        tagName: 'circle',\n                        selector: 'portBody'\n                    }],\n                    position: {\n                        name: 'left'\n                    },\n                    attrs: {\n                        portBody: {\n                            r: 5,\n                            magnet: 'passive',\n                            fill: '#FFFFFF',\n                            stroke: '#187BD3',\n\n                        }\n                    }\n                }\n            }\n        },\n        markup: [\n            {\n                tagName: 'rect',\n                selector: 'body',\n            },\n            {\n                tagName: 'image',\n                selector: 'image'\n            }, {\n                tagName: 'ports',\n                selector: 'ports'\n            }]\n    })\n    var customElNoInPorts = joint.dia.Element.define('standard.Rectangle', {\n        z: 1,\n        theme: 'material',\n        size: {\n            width: 44,\n            height: 35\n        },\n        removable: false,\n        attrs: {\n            image: {\n                x: 5,\n                y: 5,\n                width: 'calc(w-10)',\n                height: 'calc(h-10 )'\n            },\n            root: {\n                magnet: false\n            },\n            body: {\n                fill: '#FFFFFF',\n                stroke: '#A0A0A0',\n                width: 'calc(w)',\n                height: 'calc(h)',\n                strokeWidth: 2,\n            },\n            line: {\n                connection: true,\n                stroke: '#333333',\n                strokeWidth: 2,\n                strokeLinejoin: 'round',\n                targetMarker: {\n                    'type': 'path',\n                    'd': 'M 10 -5 0 0 10 5 z'\n                }\n            },\n        },\n        ports: {\n            items: [\n                {\n                    id: 'out-port',\n                    group: 'out'\n                }\n            ],\n            groups: {\n                out: {\n                    markup: [{\n                        tagName: 'circle',\n                        selector: 'portBody'\n                    }],\n                    position: {\n                        name: 'right'\n                    },\n                    attrs: {\n                        portBody: {\n                            r: 5,\n                            magnet: 'active',\n                            fill: '#187BD3',\n                            stroke: '#187BD3'\n                        }\n                    }\n                },\n\n            }\n        },\n        markup: [\n            {\n                tagName: 'rect',\n                selector: 'body',\n            }, {\n                tagName: 'image',\n                selector: 'image'\n            }, {\n                tagName: 'ports',\n                selector: 'ports'\n            }]\n    })\n    var targetArrowheadTool = new joint.linkTools.TargetArrowhead();\n    var toolsView = new joint.dia.ToolsView({\n    tools: [\n        targetArrowheadTool,\n    ]\n    });\n    var CustomLinkView = joint.dia.LinkView.extend({\n        // custom interactions:\n        pointerdblclick: function(evt, x, y) {\n            this.addVertex(x, y);\n        },\n        contextmenu: function(evt, x, y) {\n            this.addLabel(x, y);\n        },\n    \n        // custom options:\n        options: joint.util.defaults({\n            doubleLinkTools: true,\n        }, joint.dia.LinkView.prototype.options)\n    });\n    var graph = new joint.dia.Graph;\n    //ctrl+z\n    var commandManager = new joint.dia.CommandManager({ graph: graph });\n    \n    //cấu hình paper\n    var paper = new joint.dia.Paper({  \n        el:$('#paper'),\n        width: 800,\n        height: 600,\n        model: graph,\n        async: true,\n        sorting: joint.dia.Paper.sorting.APPROX,\n        gridSize: 10,\n        drawGrid: true,\n        restrictTranslate: true,\n        stopDelegation: false,\n        linkView: CustomLinkView,\n        interactive: { vertexAdd: false } ,\n        // background: { color: '#F3F7F6' },\n        // defaultConnectionPoint: { name: 'boundary' },\n        // defaultConnector: {\n        //     name: \"rounded\"\n        //   },\n        //   defaultRouter: {\n        //     name: \"manhattan\",\n        //     args: {\n        //       step: 10,\n        //       endDirections: [\"bottom\"],\n        //       startDirections: [\"top\"],\n        //       padding: { bottom: 20 }\n        //     }\n        //   },\n        snapLinks: {\n            radius: 75\n        },\n        linkPinning: false,\n        multiLinks: false,\n        defaultRouter: { name: 'manhattan', args: { padding: 10 }},\n        defaultConnector: { name: 'rounded' },\n        validateConnection: function(cellViewS, magnetS, cellViewT, magnetT, end, linkView) {\n            // Prevent linking from input ports.\n            if (magnetS && magnetS.getAttribute('port-group') === 'in') return false;\n            // Prevent linking from output ports to input ports within one element.\n            if (cellViewS === cellViewT) return false;\n            // Prevent linking to input ports.\n            return (magnetT && magnetT.getAttribute('port-group') === 'in') || (cellViewS.model.get('type') === 'qad.Question' && cellViewT.model.get('type') === 'qad.Answer');\n        },\n        // validateConnection: function (view1, _magnet1, view2, _magnet2) {\n        //     // Do not allow loop links (Element to Link, Element A to Element B is valid).\n        //     return view1 !== view2;\n        // },\n        interactive: {\n            linkMove: true,\n            labelMove: true,\n            arrowheadMove: true,\n            vertexMove: false,\n            vertexAdd: false,\n            vertexRemove: false,\n            useLinkTools: false,\n        },\n        defaultLink: function () {\n            return new joint.shapes.standard.Link({\n                attrs: {\n                    line: {\n                        connection: true,\n                        stroke: '#707070',\n                        strokeLinejoin: 'round',\n                    },\n                    wrapper: {\n                        connection: true,\n                        strokeWidth: 10,\n                        strokeLinejoin: 'round'\n                    },\n                    \n                },\n                \n                markup: [{\n                    tagName: 'path',\n                    selector: 'wrapper',\n                    attributes: {\n                        'fill': 'none',\n                        \n                        'stroke': 'transparent'\n                    }\n                }, {\n                    tagName: 'path',\n                    selector: 'line',\n                    attributes: {\n                        'fill': 'none',\n                        \n                    }\n                }]\n            });\n        }\n    });\n    //paperScroller\n    var paperScroller = new joint.ui.PaperScroller({\n        paper: paper,\n        autoResizePaper: true,\n        scrollWhileDragging: true,\n        cursor: 'grab'\n        \n    });\n    // cấu hình snaplines\n    var snaplines = new joint.ui.Snaplines({ paper: paper })\n    snaplines.startListening()\n    // cấu hình Stencil \n    var stencil = new joint.ui.Stencil({\n        paper: paperScroller,\n        width: 900,\n        height: 60,\n        dropAnimation: { duration: 200, easing: 'swing' },\n        \n    });\n    // cấu hình Selection\n    var selection = new joint.ui.Selection({\n        theme: 'material',\n        paper: paper,\n        useModelGeometry: true,\n        allowTranslate: true,\n    });\n    //hàm viết hoa chữ đầu\n    function jsUcfirst(string) {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    }\n    //hàm render stencil\n    function stencilRenderHandler(positionX,positionY,arr,elNoInPorts =\"\",spaceBetweenElToX=0,spaceBetweenElToY=0){\n        arr.forEach(element => {\n            //chuyển thành hoa chữ đầu cho đúng định dạng file ảnh lưu\n            let elementName = jsUcfirst(element)\n            if (elementName === jsUcfirst(elNoInPorts)) {\n                element = new customElNoInPorts();\n            }\n            else {\n                element = new customEl();\n            }\n            element.prop('attrs/image/xlinkHref', `./assets/${elementName}.svg`)\n            stencilShapes.push(element.position(positionX, positionY))\n            if(spaceBetweenElToX>0){\n                positionX += element.attributes.size.width+spaceBetweenElToX;\n            }\n            if(spaceBetweenElToY>0){\n                positionY += element.attributes.size.height+spaceBetweenElToY;\n            }\n        });\n    }\n    var arr = ['filter', 'formula', 'join', 'load', 'pivot', 'sample', 'script', 'select', 'sort', 'summarize', 'transposeTable', 'union', 'weightAvg'];\n    //mảng chứa các vị trí của stencil Shape để sau đó render\n    var stencilShapes = []\n    stencilRenderHandler(20,20,arr,\"load\",16)\n    paper.svg.prepend(\n    V.createSVGStyle(`\n            .joint-element .selection {\n                stroke: ${color};\n            }\n            .joint-link .selection {\n                stroke: ${color}; \n                'fill': ${color},\n            }\n            \n        `)\n    );\n    //lấy tất cả link ở trc node\n    function getElementPredecessorLinks(el) {\n        return graph\n          .getSubgraph([el, ...graph.getPredecessors(el)])\n          .filter((cell) => cell.isLink());\n      }\n      //đổi màu cell\n      function highlightCell(cell) {\n        if(cell){\n        highlighters.addClass.add(\n          cell.findView(paper),\n          cell.isElement() ? \"body\" : \"line\",\n          \"selection\",\n          { className: \"selection\" }\n        );\n        }else{return}\n      }\n      //chuyển màu cell lại như cũ\n      function unhighlightCell(cell) {\n        if(cell){\n        highlighters.addClass.remove(cell.findView(paper), \"selection\");\n        }\n        else{return}\n      }\n      //function xử lý hành dộng chọn el\n      function selectElement(el) {     \n        if (selectionNode === el) return;\n        if (selectionNode) {\n            \n          unhighlightCell(selectionNode);\n          graph.getLinks().forEach((link) => unhighlightCell(link));\n        }\n        if (el) {\n            \n          highlightCell(el);\n          getElementPredecessorLinks(el).forEach((link) => {\n              highlightCell(link)\n              link.toFront()\n            });\n          selectionNode = el;\n        } else {\n            selectionNode = null;\n        }\n      }\n      //halo cấu hình\n       paper.on('cell:pointerup',function (cellView) {\n        var halo = new joint.ui.Halo({\n            cellView: cellView,\n            type: 'toolbar',\n            boxContent:false // bang phia duoi cell cho biet tọa độ height width và angle\n        });\n        halo.removeHandle('resize');\n        halo.removeHandle('rotate');\n        halo.removeHandle('direction');\n        halo.render();\n        //cho cell đang chọn lên trc và gán cho selectedEl để chạy những chức năng tiếp theo\n        selectedElement = cellView.model;\n        selectedElement.toFront()\n        // console.log(graph.getLinks())\n    })\n   \n      //xử lý khi các sự kiện với paper\n      paper.on({\n          //xử lý khi các sự kiện \n        \"cell:mouseenter\":(cellView)=>{\n                cellView.model.toFront()\n        },\n        \"cell:mouseleave\":(cellView)=>{\n            cellView.model.toBack()\n            if(selectionNode){\n                getElementPredecessorLinks(selectionNode).forEach((link) => {\n                   \n                    link.toFront()\n                  });\n            }\n        },\n    \n        \"element:pointerclick\":(cellView) =>{\n            //chỉ đổi màu khi ko bấm ctrl\n            if(ctrlDown ===false )\n                { \n                    selectElement(cellView.model)\n                }\n            },\n            \"link:pointerclick\":(cellView) =>\n                {selectElement(cellView.model)\n                    //chon vao link thi mo cho phep doi node\n                    cellView.addTools(toolsView);\n                \n                },\n                \n                //chuyển lại màu cũ khi bấm ra ngoài\n            \"blank:pointerclick\":() => {selectElement(null)\n                paper.removeTools();\n                },\n            \n            'element:pointerup': function (cellView, evt) {\n                \n                if (evt.ctrlKey || evt.metaKey) {\n                    selection.collection.add(cellView.model);\n                    //loop to all the element in selection and set it to front\n                    selection.collection.models.forEach(element => {\n                        element.toFront()\n                    })               \n                }\n            },\n            //chuyển màu khi bấm vào link và cho nó lên trc\n            'link:pointerup': function (cellView) {\n                selectedLink = cellView.model;\n                selectedLink.toFront()\n            },\n            \n            // lắng nghe sự kiện bấm ở ngoài khoange trống check shift để active select\n            'blank:pointerdown':function(evt, x, y) {\n                if (shiftDown===true) {\n                    selectElement(null)\n                    paperScroller.setCursor('crosshair')\n                    selection.startSelecting(evt);\n                    console.log(selection)\n                } else {\n                    selection.collection.reset([]);\n                    paperScroller.startPanning(evt, x, y);\n                    paper.removeTools();\n                    paperScroller.setCursor('grab');\n                }\n        \n            },\n      })\n      //xóa el nếu chọn lại lần 2 khi bấm ctrl\n      selection.on('selection-box:pointerdown', function (cellView, evt) {\n        if (evt.ctrlKey || evt.metaKey) {\n            selection.collection.remove(cellView.model);\n        }\n    });\n    //xóa bằng nút delete\n    document.addEventListener('keyup', function (evt) {\n        \n        if (!selectedElement && !selection) return;\n        if (evt.code === 'Backspace' || evt.code === 'Delete') {\n            //xóa 1 el\n            if (selectedElement) {\n                selectedElement.remove();\n                selectedElement = null;\n                selectionNode=null;\n            }\n            //xóa toàn bộ  el đã chọn\n            if (selection) {\n                // chuyeent selection.collection thành mảng hảm remove cell nhận vào 1 mảng và xóa khỏi graph\n                evt.preventDefault();\n                graph.removeCells(selection.collection.toArray())\n                selectionNode=null;\n            }\n        }\n    }\n    );\n    //nếu bấm thì =true\n    document.addEventListener('keydown', function (evt) {\n        if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\n            ctrlDown = true;\n        }\n        if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\n            shiftDown = true;\n        }\n    })\n    //nếu thả nút thì =false\n    document.addEventListener('keyup', function (evt) {\n        if (evt.code === \"ShiftLeft\" || evt.code === \"ShiftRight\") {\n            shiftDown = false;\n\n        }\n        if (evt.code === \"ControlLeft\" || evt.code === \"ControlRight\") {\n            ctrlDown = false;\n        }\n    })\n    //kết hợp bấm ctrl để check các tổ hợp phím ctrl + C,V,Z,Y,A...\n    document.addEventListener('keydown', function (evt) {\n        var clipboard = new joint.ui.Clipboard();\n        \n        \n        if (evt.code === \"NumpadAdd\" && shiftDown === true) {\n            console.log(evt.code)\n            paperScroller.zoom(0.2, { max: 4 });\n        }\n        if (evt.code === \"NumpadSubtract\" && shiftDown === true) {\n            paperScroller.zoom(-0.2, { min: 0.2 });\n            console.log(evt.code)\n        }\n        //check+ A\n        if (evt.code === \"KeyA\" && ctrlDown === true) {\n            selection.collection.reset(graph.getElements())\n            evt.preventDefault();\n        }//check ctrl + Z\n        if (evt.code === \"KeyZ\" && ctrlDown === true) {\n            commandManager.undo();\n            \n            unhighlightCell(selectionNode);\n            graph.getLinks().forEach((link) => unhighlightCell(link));\n            console.log(selectionNode)\n            selectionNode=null\n        }\n        //check ctrl + Y\n        if (evt.code === \"KeyY\" && ctrlDown === true) {\n            commandManager.redo();\n            selectElement(null)\n        }\n        //check ctrl + V ,ctrl + C, ctrl+X\n        if (evt.code === \"KeyX\" && ctrlDown === true) {\n\n            clipboard.cutElements(selection.collection, paper.model)\n        }\n        if (evt.code === \"KeyC\" && ctrlDown === true) {\n            clipboard.copyElements(selection.collection, graph);\n        }\n        if (evt.code === \"KeyV\" && ctrlDown === true) {\n            var pastedCells = clipboard.pasteCells(graph, {\n                translate: { dx: 40, dy: 40 },\n                useLocalStorage: true\n            });\n\n            var elements = _.filter(pastedCells, function (cell) {\n                return cell.isElement();\n            });\n            // Make sure pasted elements get selected immediately. This makes the UX better as\n            // the user can immediately manipulate the pasted elements.\n            selection.collection.reset(elements);\n\n        }\n    })\n   \n    // nut zoomin zoom out can chuyen ve scroll\n    $('#btn-zoomin').on('click', function() {\n        paperScroller.zoom(0.2, { max: 4 });\n    });\n    $('#btn-zoomout').on('click', function() {\n        paperScroller.zoom(-0.2, { min: 0.2 });\n    });\n    $('#btn-center').on('click', _.bind(paperScroller.center, paperScroller));\n    $('#btn-center-content').on('click', _.bind(paperScroller.centerContent, paperScroller));\n\n    //render paper\n    document.getElementById('paper').appendChild(paperScroller.render().el);\n    //render paperScroller\n    paperScroller.$el.css({ width: 900, height: 600 }).appendTo('#paper');\n    paperScroller.center();\n     //render stencil ra màn hình\n     document.getElementById('stencil').appendChild(stencil.render().el);\n     stencil.load(stencilShapes);\n     selection.collection.reset(graph.getElements());\n    //  var linkView = paper.findViewByModel(link);\n     \n  }\n\n  \n}\n</script>\n\n<style >\n@import \"@/../public/vendor/build/package/rappid.css\";\n@import \"@/css/data_flow.css\";\n@import \"@/css/lib/rappid.min.css\";\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}