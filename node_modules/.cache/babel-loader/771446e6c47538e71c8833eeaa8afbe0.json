{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { ToolView } from '../dia/ToolView.mjs';\nimport * as util from '../util/index.mjs';\nexport const Control = ToolView.extend({\n  tagName: 'g',\n  children: [{\n    tagName: 'circle',\n    selector: 'handle',\n    attributes: {\n      'cursor': 'pointer',\n      'stroke-width': 2,\n      'stroke': '#FFFFFF',\n      'fill': '#33334F',\n      'r': 6\n    }\n  }, {\n    tagName: 'rect',\n    selector: 'extras',\n    attributes: {\n      'pointer-events': 'none',\n      'fill': 'none',\n      'stroke': '#33334F',\n      'stroke-dasharray': '2,4',\n      'rx': 5,\n      'ry': 5\n    }\n  }],\n  events: {\n    mousedown: 'onPointerDown',\n    touchstart: 'onPointerDown',\n    dblclick: 'onPointerDblClick',\n    dbltap: 'onPointerDblClick'\n  },\n  documentEvents: {\n    mousemove: 'onPointerMove',\n    touchmove: 'onPointerMove',\n    mouseup: 'onPointerUp',\n    touchend: 'onPointerUp',\n    touchcancel: 'onPointerUp'\n  },\n  options: {\n    handleAttributes: null,\n    selector: 'root',\n    padding: 6\n  },\n  getPosition: function () {// To be overridden\n  },\n  setPosition: function () {// To be overridden\n  },\n  resetPosition: function () {// To be overridden\n  },\n  onRender: function () {\n    this.renderChildren();\n    this.toggleExtras(false);\n    this.update();\n  },\n  update: function () {\n    const {\n      handle,\n      extras\n    } = this.childNodes;\n\n    if (handle) {\n      this.updateHandle(handle);\n    } else {\n      throw new Error('Control: markup selector `handle` is required');\n    }\n\n    if (extras) {\n      this.updateExtras(extras);\n    }\n\n    return this;\n  },\n  updateHandle: function (handleNode) {\n    const {\n      relatedView,\n      options\n    } = this;\n    const {\n      model\n    } = relatedView;\n    const relativePos = this.getPosition(relatedView, this);\n    const absolutePos = model.getAbsolutePointFromRelative(relativePos);\n    handleNode.setAttribute('transform', `translate(${absolutePos.x},${absolutePos.y})`);\n    const {\n      handleAttributes\n    } = options;\n\n    if (handleAttributes) {\n      for (let attrName in handleAttributes) {\n        handleNode.setAttribute(attrName, handleAttributes[attrName]);\n      }\n    }\n  },\n  updateExtras: function (extrasNode) {\n    const {\n      relatedView,\n      options\n    } = this;\n    const {\n      selector\n    } = this.options;\n\n    if (!selector) {\n      this.toggleExtras(false);\n      return;\n    }\n\n    const [magnet] = relatedView.findBySelector(selector);\n    if (!magnet) throw new Error('Control: invalid selector.');\n    let padding = options.padding;\n    if (!isFinite(padding)) padding = 0;\n    const bbox = relatedView.getNodeUnrotatedBBox(magnet);\n    const model = relatedView.model;\n    const angle = model.angle();\n    const center = bbox.center();\n    if (angle) center.rotate(model.getBBox().center(), -angle);\n    bbox.inflate(padding);\n    extrasNode.setAttribute('x', -bbox.width / 2);\n    extrasNode.setAttribute('y', -bbox.height / 2);\n    extrasNode.setAttribute('width', bbox.width);\n    extrasNode.setAttribute('height', bbox.height);\n    extrasNode.setAttribute('transform', `translate(${center.x},${center.y}) rotate(${angle})`);\n  },\n  toggleExtras: function (visible) {\n    const {\n      extras\n    } = this.childNodes;\n    if (!extras) return;\n    extras.style.display = visible ? '' : 'none';\n  },\n  onPointerDown: function (evt) {\n    const {\n      relatedView,\n      paper\n    } = this;\n    if (this.guard(evt)) return;\n    evt.stopPropagation();\n    evt.preventDefault();\n    paper.undelegateEvents();\n    this.delegateDocumentEvents();\n    this.focus();\n    this.toggleExtras(true);\n    relatedView.model.startBatch('control-move', {\n      ui: true,\n      tool: this.cid\n    });\n  },\n  onPointerMove: function (evt) {\n    const {\n      relatedView,\n      paper\n    } = this;\n    const {\n      model\n    } = relatedView;\n    const {\n      clientX,\n      clientY\n    } = util.normalizeEvent(evt);\n    const coords = paper.clientToLocalPoint(clientX, clientY);\n    const relativeCoords = model.getRelativePointFromAbsolute(coords);\n    this.setPosition(relatedView, relativeCoords, this);\n    this.update();\n  },\n  onPointerUp: function (_evt) {\n    const {\n      relatedView,\n      paper\n    } = this;\n    paper.delegateEvents();\n    this.undelegateDocumentEvents();\n    this.blur();\n    this.toggleExtras(false);\n    relatedView.model.stopBatch('control-move', {\n      ui: true,\n      tool: this.cid\n    });\n  },\n  onPointerDblClick: function () {\n    const {\n      relatedView\n    } = this;\n    this.resetPosition(relatedView, this);\n    this.update();\n  }\n});","map":{"version":3,"names":["ToolView","util","Control","extend","tagName","children","selector","attributes","events","mousedown","touchstart","dblclick","dbltap","documentEvents","mousemove","touchmove","mouseup","touchend","touchcancel","options","handleAttributes","padding","getPosition","setPosition","resetPosition","onRender","renderChildren","toggleExtras","update","handle","extras","childNodes","updateHandle","Error","updateExtras","handleNode","relatedView","model","relativePos","absolutePos","getAbsolutePointFromRelative","setAttribute","x","y","attrName","extrasNode","magnet","findBySelector","isFinite","bbox","getNodeUnrotatedBBox","angle","center","rotate","getBBox","inflate","width","height","visible","style","display","onPointerDown","evt","paper","guard","stopPropagation","preventDefault","undelegateEvents","delegateDocumentEvents","focus","startBatch","ui","tool","cid","onPointerMove","clientX","clientY","normalizeEvent","coords","clientToLocalPoint","relativeCoords","getRelativePointFromAbsolute","onPointerUp","_evt","delegateEvents","undelegateDocumentEvents","blur","stopBatch","onPointerDblClick"],"sources":["C:/Users/Admin/dataflow-test/node_modules/jointjs/src/elementTools/control.mjs"],"sourcesContent":["import { ToolView } from '../dia/ToolView.mjs';\nimport * as util from '../util/index.mjs';\n\nexport const Control = ToolView.extend({\n    tagName: 'g',\n    children: [{\n        tagName: 'circle',\n        selector: 'handle',\n        attributes: {\n            'cursor': 'pointer',\n            'stroke-width': 2,\n            'stroke': '#FFFFFF',\n            'fill': '#33334F',\n            'r': 6\n        }\n    }, {\n        tagName: 'rect',\n        selector: 'extras',\n        attributes: {\n            'pointer-events': 'none',\n            'fill': 'none',\n            'stroke': '#33334F',\n            'stroke-dasharray': '2,4',\n            'rx': 5,\n            'ry': 5\n        }\n    }],\n    events: {\n        mousedown: 'onPointerDown',\n        touchstart: 'onPointerDown',\n        dblclick: 'onPointerDblClick',\n        dbltap: 'onPointerDblClick'\n    },\n    documentEvents: {\n        mousemove: 'onPointerMove',\n        touchmove: 'onPointerMove',\n        mouseup: 'onPointerUp',\n        touchend: 'onPointerUp',\n        touchcancel: 'onPointerUp'\n    },\n    options: {\n        handleAttributes: null,\n        selector: 'root',\n        padding: 6,\n    },\n\n    getPosition: function() {\n        // To be overridden\n    },\n    setPosition: function() {\n        // To be overridden\n    },\n    resetPosition: function() {\n        // To be overridden\n    },\n    onRender: function() {\n        this.renderChildren();\n        this.toggleExtras(false);\n        this.update();\n    },\n    update: function() {\n        const { handle, extras } = this.childNodes;\n        if (handle) {\n            this.updateHandle(handle);\n        } else {\n            throw new Error('Control: markup selector `handle` is required');\n        }\n        if (extras) {\n            this.updateExtras(extras);\n        }\n        return this;\n    },\n    updateHandle: function(handleNode) {\n        const { relatedView, options } = this;\n        const { model } = relatedView;\n        const relativePos = this.getPosition(relatedView, this);\n        const absolutePos = model.getAbsolutePointFromRelative(relativePos);\n        handleNode.setAttribute('transform', `translate(${absolutePos.x},${absolutePos.y})`);\n        const { handleAttributes } = options;\n        if (handleAttributes) {\n            for (let attrName in handleAttributes) {\n                handleNode.setAttribute(attrName, handleAttributes[attrName]);\n            }\n        }\n    },\n    updateExtras: function(extrasNode) {\n        const { relatedView, options } = this;\n        const { selector } = this.options;\n        if (!selector) {\n            this.toggleExtras(false);\n            return;\n        }\n        const [magnet] = relatedView.findBySelector(selector);\n        if (!magnet) throw new Error('Control: invalid selector.');\n        let padding = options.padding;\n        if (!isFinite(padding)) padding = 0;\n        const bbox = relatedView.getNodeUnrotatedBBox(magnet);\n        const model = relatedView.model;\n        const angle = model.angle();\n        const center = bbox.center();\n        if (angle) center.rotate(model.getBBox().center(), -angle);\n        bbox.inflate(padding);\n        extrasNode.setAttribute('x', -bbox.width / 2);\n        extrasNode.setAttribute('y', -bbox.height / 2);\n        extrasNode.setAttribute('width', bbox.width);\n        extrasNode.setAttribute('height', bbox.height);\n        extrasNode.setAttribute('transform', `translate(${center.x},${center.y}) rotate(${angle})`);\n    },\n    toggleExtras: function(visible) {\n        const { extras } = this.childNodes;\n        if (!extras) return;\n        extras.style.display = (visible) ? '' : 'none';\n    },\n    onPointerDown: function(evt) {\n        const { relatedView, paper } = this;\n        if (this.guard(evt)) return;\n        evt.stopPropagation();\n        evt.preventDefault();\n        paper.undelegateEvents();\n        this.delegateDocumentEvents();\n        this.focus();\n        this.toggleExtras(true);\n        relatedView.model.startBatch('control-move', { ui: true, tool: this.cid });\n    },\n    onPointerMove: function(evt) {\n        const { relatedView, paper } = this;\n        const { model } = relatedView;\n        const { clientX, clientY } = util.normalizeEvent(evt);\n        const coords = paper.clientToLocalPoint(clientX, clientY);\n        const relativeCoords = model.getRelativePointFromAbsolute(coords);\n        this.setPosition(relatedView, relativeCoords, this);\n        this.update();\n    },\n    onPointerUp: function(_evt) {\n        const { relatedView, paper } = this;\n        paper.delegateEvents();\n        this.undelegateDocumentEvents();\n        this.blur();\n        this.toggleExtras(false);\n        relatedView.model.stopBatch('control-move', { ui: true, tool: this.cid });\n    },\n    onPointerDblClick: function() {\n        const { relatedView } = this;\n        this.resetPosition(relatedView, this);\n        this.update();\n    }\n\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}